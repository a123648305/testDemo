(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[6566],{6566:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>pe});var a=n(37316),i=n.n(a),r=n(67154),d=n.n(r),t=n(85354),o=n.n(t),a=n(67294),O=n.n(a),N=n(26198),k=n(27310),u=n(70715),l=n(39432),r=function(a){function e(){for(var s,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(s=a.call.apply(a,[this].concat(t))||this).chartRef=void 0,s.source=void 0,s.dimensions=["业务视角","指标声量","指标好评率","指标差评率"],s.mColor=u.Fq,s.aspects=void 0,s.getChartRef=function(e){return s.chartRef=e},s.setValue=function(e){s.aspects=[],s.source=e.reduce(function(e,t){var n=0,a=0;t.aspects.forEach(function(e){n+=e.positive,a+=e.negative});var i=n+a;return i&&(e.push([t.view,i,n/i,a/i]),s.aspects.push(t.view)),e},[s.dimensions])},s.getOption=function(e,a,i){var t=s.chartRef.getWidth(),n=.8*t/(70*s.aspects.length),r=1<(0,l.jD)(s.aspects.join(""),12)/(.6*t),o="positive"===a?2:3;return{title:{text:e},dataset:[{source:s.source}],grid:{top:80,left:36,right:36,bottom:r?60:n<1?50:30,containLabel:!0},legend:{left:20,top:40,itemWidth:12,itemHeight:12,data:[{name:s.dimensions[o],icon:u.W4.lineRing},{name:s.dimensions[1],icon:u.W4.squareRing,color:"#000"}]},dataZoom:[{show:n<1,bottom:20,xAxisIndex:[0,1],height:16,handleSize:"100%",showDetail:!1}],tooltip:{trigger:"axis",formatter:function(e){return e.reduce(function(e,t,n){var a=t.marker,i=t.value,t=t.seriesName;return e.push(a+" "+t+"："+(n?(100*i).toFixed(2)+"%":i)),e},[(0,u.Zi)(e[0].name)]).join("</br>")}},xAxis:[0,1].map(function(e){return{type:"category",show:!e,position:"bottom",axisLabel:{interval:0,rotate:r?45:0,margin:r?15:8,formatter:function(e){return 6<e.length?e.substring(0,5)+"...":e}},data:e?[]:s.source.reduce(function(e,t,n){return 0!==n&&e.push(t[0]),e},[])}}),yAxis:[0,1].map(function(t){return{type:"value",position:t?"left":"right",minInterval:t?void 0:1,axisLabel:{formatter:function(e){return t?(100*e).toFixed(0)+"%":e}}}}),series:[{type:"bar",name:s.dimensions[1],yAxisIndex:0,barMaxWidth:24,data:s.source.reduce(function(e,t,n){return 0!==n&&e.push({value:t[1],itemStyle:{color:-1===i||i===n-1?u.Fq[n-1]:"#d8d8d8"}}),e},[])},{type:"line",name:s.dimensions[o],yAxisIndex:1,itemStyle:{color:u.gi["positive"===a?0:1]},data:s.source.reduce(function(e,t,n){return 0!==n&&e.push({value:t[o],itemStyle:{color:u.gi["positive"===a?0:1]}}),e},[])}]}},s}return o()(e,a),e.prototype.renderChart=function(e,t,n,a){this.setValue(e,n),this.chartRef.clear(),this.chartRef.setOption(this.getOption(t,n,a))},e}(O().PureComponent),p=n(8201),h=n(98191),m=n(50976),f=n(60496),s=n(94644),t=n(45697),a=n.n(t),g=n(61193),v=n(43036),y=n(92360),C=[{title:"指标好评率",value:"positive"},{title:"指标差评率",value:"negative"}],t=function(i){function e(e){var o=i.call(this,e)||this;return o.handleOnMoreClick=function(e){var t=o.props,n=t.title,t=t.data;"image"===e&&o.chartRef?(0,s._v)(o.chartRef,n):"data"===e&&(0,p.P)(t)&&(0,s.aT)([o.source.map(function(e){return e.map(function(e){return e%1?(100*e).toFixed(2)+"%":e})})],n)},o.handleOnChartClick=function(e){var t=e.componentSubType,n=e.componentType,a=e.dataIndex,i=e.name,r=o.props.onClick;"series"===n&&"bar"===t&&o.setState({clickedDataIndex:o.state.clickedDataIndex===a?-1:a},function(){r&&r(-1===o.state.clickedDataIndex?"":i)})},o.state={clickedDataIndex:-1},o}o()(e,i);var t=e.prototype;return t.componentDidMount=function(){this.renderChart()},t.componentDidUpdate=function(e,t){var a=this,n=e.data,i=e.emotionType,r=this.props,o=r.data,e=r.emotionType,s=r.onClick,t=t.clickedDataIndex,l=this.state.clickedDataIndex;((0,p.P)(o)&&JSON.stringify(n)!==JSON.stringify(o)||e!==i)&&(this.renderChart(),-1!==t&&this.setState({clickedDataIndex:-1},function(){return s&&s("")})),!(0,p.P)(o)&&this.chartRef&&(this.chartRef=void 0),t!==l&&this.chartRef&&(t=this.chartRef.getOption().series.map(function(e,n){return{data:e.data.map(function(e,t){return 0===n?d()({},e,{itemStyle:{color:-1===l||l===t?a.mColor[t%a.mColor.length]:"#d8d8d8"}}):e})}}),this.chartRef.setOption({series:t}))},t.renderChart=function(){var e=this.props,t=e.data,n=e.title,a=e.emotionType,e=this.state.clickedDataIndex;(0,p.P)(t)&&this.chartRef&&i.prototype.renderChart.call(this,t,n,a,e)},t.render=function(){var e=this.props,t=e.data,n=e.loading,a=e.title,i=e.titleOverlay,r=e.emotionType,o=e.emotionTypeFlavor,s=e.onFlavorChange,l=e.onChange,c=e.onConfigClick,e=e.isDataEmpty,u=g.Z.hasAuthority("BUSINESS_POINT_SETTING");return O().createElement(p.Z,{className:"yt_product_self_analysis_bar_line_chart",data:t,loading:n,emptyHint:e||"empty"!==t?"暂无数据":O().createElement("div",null,"你没有配置「业务视角」",u&&O().createElement("div",{style:{textAlign:"center",marginTop:22}},O().createElement(y.Button,{type:"primary",onClick:c},"立即配置"))),renderTitle:O().createElement(h.Z,{title:a,titleOverlay:i,data:t,onMoreClick:this.handleOnMoreClick},O().createElement(f.Z,{options:C,activeObj:r,flavor:o,onFlavorChange:s,onChange:l,objName:"rateEmotionType"}),O().createElement("span",{className:"view_config "+(u?"hoverable":""),onClick:function(){return u?c():null}},O().createElement(v.Z,{overlay:u?"设置业务视角":"无权限",placement:"top"},O().createElement("i",{className:"icon-cem_visual-angle"}))))},O().createElement(m.Z,{onChartReady:this.getChartRef,theme:"yunting_multi_color",option:{},style:{height:"100%"},onEvents:{click:this.handleOnChartClick}}))},e}(r);t.propTypes={data:a().any,emotionType:a().string,onConfigClick:a().func,titleOverlay:a().oneOf([a().string,a().node]),title:a().string,loading:a().bool,onChange:a().func,onClick:a().func,isDataEmpty:a().bool};const S=t;var _="CHART_MESSAGE",c="CHART_MESSAGE_RANGE",E=["positive","negative","total"],b="*flag*",r=function(a){function e(){for(var c,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(c=a.call.apply(a,[this].concat(t))||this).chartRef=void 0,c.dataset=void 0,c.color=void 0,c.aspects=void 0,c.datasetIndex=-1,c.getChartRef=function(e){return c.chartRef=e},c.getEmotionSourceData=function(e,t,o,s,l){return e.reduce(function(n,e,a){var i=e.view,r=e.aspects;return(l instanceof Array?l.reduce(function(e,t){var n=r.find(function(e){return e.aspect===t});return n&&e.push(n),e},[]):r.sort(function(e,t){return t[o]-e[o]})).forEach(function(e){var t;s===i&&(c.color=[u.Fq[a]]),s&&s!==i||(t=parseInt(i)?b+i:i,n.push([t,e.aspect,e[o],e.menRate]),c.aspects.push(e.aspect))}),n},[t])},c.setValue=function(e,t,n){c.color=void 0,c.aspects=[];var a=c.getEmotionSourceData(e,["业务视角","指标","指标声量","指标提及率"],"total",t,n),i=c.getEmotionSourceData(e,["业务视角","指标","指标正面声量","指标提及率"],"positive",t,n),t=c.getEmotionSourceData(e,["业务视角","指标","指标负面声量","指标提及率"],"negative",t,n);c.dataset=[i,t,a].map(function(e){return{source:e}}),n instanceof Function&&n()},c.getOption=function(e){var t=c.chartRef.getWidth(),n=.8*t/(70*c.aspects.length),a=1<(0,l.jD)(c.aspects.join(""),12)/(.6*t),t=E.indexOf(e);c.datasetIndex=t;e=c.dataset[t].source.reduce(function(e,t,n){return 0<n&&!e.includes(t[0])&&e.push(t[0]),e},[]);return{title:{text:c.dataset[t].source[0][2]},dataset:c.dataset,grid:{top:80,left:36,right:36,bottom:a?60:n<1?50:30,containLabel:!0},legend:{left:20,top:40,itemWidth:12,itemHeight:12,data:[c.dataset[t].source[0][3]],icon:u.W4.lineRing},visualMap:[{type:"piecewise",top:40,left:108,seriesIndex:1,itemWidth:12,itemHeight:12,textGap:4,orient:"horizontal",dimension:0,categories:e.map(function(e){return String(e)}),inRange:{symbol:"rect",color:c.color||u.Fq},outOfRange:{color:"#bfbfbf"},formatter:function(e){return e.startsWith(b)?e.substring(b.length):e}}],dataZoom:[{show:n<1,bottom:20,xAxisIndex:0,height:15,handleSize:"100%",showDetail:!1}],tooltip:{trigger:"axis",formatter:function(e){window.postMessage({type:_,from:"BarLineCountChart",name:e[0].name},"*");var t=e.find(function(e){return"line"===e.componentSubType}),n=e.find(function(e){return"bar"===e.componentSubType});return[(0,u.Zi)(e[0].name),n.dimensionNames[0]+"："+(n.data[0].startsWith(b)?n.data[0].substring(b.length):n.data[0]),n.marker+" "+n.dimensionNames[2]+"："+n.data[2],t?t.marker+" "+t.dimensionNames[3]+"："+(100*t.data[3]).toFixed(2)+"%":""].join("</br>")}},xAxis:[0,1].map(function(e){return{type:"category",show:!e,axisLabel:e?void 0:{rotate:a?45:0,margin:a?15:8,formatter:function(e){return 6<e.length?e.substring(0,5)+"...":e}}}}),yAxis:[0,1].map(function(t){return{type:"value",splitNumber:3,position:t?"right":"left",minInterval:t?1:void 0,axisLabel:{formatter:function(e){return t?e:(100*e).toFixed(0)+"%"}}}}),series:[{type:"line",datasetIndex:t,yAxisIndex:0,xAxisIndex:0,markLine:{symbol:"none",slient:!0,data:[{type:"average",lineStyle:{color:"#BFBFBF"},label:{formatter:function(e){return"{a|"+(100*e.value).toFixed(2)+"%}"},rich:{a:{backgroundColor:"#BFBFBF",color:"#fff",padding:[4,4]}}}}]},itemStyle:{color:"#D96969"},encode:{x:1,y:3,seriesName:3}},{type:"bar",datasetIndex:t,xAxisIndex:0,yAxisIndex:1,barMaxWidth:24,encode:{x:1,y:2}}]}},c}return o()(e,a),e.prototype.renderChart=function(e,t,n,a){this.setValue(e,n,a),this.chartRef.clear(),this.chartRef.setOption(this.getOption(t))},e}(O().PureComponent),t=function(e){var t=e.onChange,n=e.check,e=e.enable,a=void 0===e||e,e=O().useState(n),i=e[0],r=e[1];return O().useEffect(function(){r(n)},[n]),O().createElement("div",{className:"yt_range_button_wrapper"},O().createElement(v.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:i?"各图独立排序":O().createElement("div",null,O().createElement("div",null,"此图作为其他图"),O().createElement("div",null,"表的排序依据"))},O().createElement("span",{onClick:function(){var e;a&&(e=!i,t&&t(e),r(e))},style:{color:i?"#0847a6":"#8c8c8c"},className:"button_trigger "+(a?"enable":"disable")},O().createElement("i",{className:"icon-cem_independent"}))))};t.propTypes={check:a().bool,onChange:a().func,enable:a().bool};const w=t;var P=[{title:"指标声量",value:"total"},{title:"指标正面声量",value:"positive"},{title:"指标负面声量",value:"negative"}],R={positive:"指标正面声量",negative:"指标负面声量",total:"指标声量"},t=function(a){function e(e){var i=a.call(this,e)||this;return i.rangeParam=void 0,i.handleOnMoreClick=function(e){var t=i.props,n=t.data,t=t.emotionType;"image"===e&&i.chartRef?(0,s._v)(i.chartRef,R[t]):"data"===e&&(0,p.P)(n)&&(0,s.aT)([i.dataset.reduce(function(t,e){return e.source.forEach(function(e){t.push(e.map(function(e,t){return e%1||(1===e||0===e)&&3===t?(100*e).toFixed(2)+"%":e}))}),t.push(""),t},[])],R[t])},i.handleOnReceiveMessage=function(e){var t=e.data;i.chartRef&&"BarLineRateChart"===t.from&&(t.type===_?(e=i.dataset[i.datasetIndex].source.findIndex(function(e){return e[1]===t.name})-1,i.chartRef.dispatchAction({type:"showTip",seriesIndex:1,dataIndex:e})):t.type===c&&(i.rangeParam=t.rangedNames,i.renderChart(),i.setState({rangeChecked:!1})))},i.handleOnChartClick=function(e){var t=e.componentType,n=i.props,a=n.emotionType,n=n.onClick;"series"===t&&("positive"!==a&&"negative"!==a||n(e,a))},i.handleOnRangeClick=function(e){i.rangeParam instanceof Array&&e?(i.rangeParam=function(){i.postUpdateMessage(e)},i.renderChart()):(i.rangeParam=void 0,i.postUpdateMessage(e)),i.setState({rangeChecked:e})},i.postUpdateMessage=function(e){var t=i.props.emotionType;window.postMessage({type:c,from:"BarLineCountChart",rangedNames:e?i.dataset["positive"===t?0:"negative"===t?1:2].source.reduce(function(e,t,n){return n&&e.push(t[1]),e},[]):void 0})},i.state={rangeChecked:!1},i}o()(e,a);var t=e.prototype;return t.componentDidMount=function(){this.renderChart(),window.addEventListener("message",this.handleOnReceiveMessage)},t.componentWillUnmount=function(){window.removeEventListener("message",this.handleOnReceiveMessage)},t.componentDidUpdate=function(e){var t=this,n=e.data,a=e.emotionType,i=e.filterName,r=this.props,o=r.data,e=r.emotionType,r=r.filterName;((0,p.P)(o)&&JSON.stringify(n)!==JSON.stringify(o)||e!==a||i!==r)&&(this.state.rangeChecked&&(this.rangeParam=function(){t.postUpdateMessage(!0)}),this.renderChart()),!(0,p.P)(o)&&this.chartRef&&(this.chartRef=void 0)},t.renderChart=function(){var e=this.props,t=e.data,n=e.emotionType,e=e.filterName;(0,p.P)(t)&&this.chartRef&&a.prototype.renderChart.call(this,t,n,e,this.rangeParam)},t.render=function(){var e=this.props,t=e.data,n=e.loading,a=e.emotionType,i=e.emotionTypeFlavor,r=e.titleOverlay,o=e.onFlavorChange,s=e.onChange,e=this.state.rangeChecked;return O().createElement(p.Z,{className:"yt_product_self_analysis_bar_line_chart",data:t,loading:n,renderTitle:O().createElement(h.Z,{title:R[a],titleOverlay:r,data:t,onMoreClick:this.handleOnMoreClick},O().createElement(w,{check:e,onChange:this.handleOnRangeClick}),O().createElement(f.Z,{options:P,activeObj:a,flavor:i,onFlavorChange:o,onChange:s,objName:"countEmotionType"}))},O().createElement(m.Z,{onChartReady:this.getChartRef,theme:"yunting_multi_color",option:{},style:{height:"100%"},onEvents:{click:this.handleOnChartClick}}))},e}(r);t.propTypes={data:a().any,emotionType:a().string,titleOverlay:a().oneOf([a().node,a().string]),loading:a().bool,onChange:a().func,filterName:a().string};const x=t;var F=["positive","negative","total"],I="*flag*",r=function(a){function e(){for(var c,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(c=a.call.apply(a,[this].concat(t))||this).chartRef=void 0,c.dataset=void 0,c.color=void 0,c.aspects=void 0,c.datasetIndex=-1,c.oriPosRangeNames=void 0,c.oriNegRangeNames=void 0,c.getChartRef=function(e){return c.chartRef=e},c.getEmotionSourceData=function(e,t,o,s,l){return c.aspects=[],c.color=void 0,e.reduce(function(n,e,a){var i=e.view,r=e.aspects;return(l instanceof Array?l.reduce(function(e,t){var n=r.find(function(e){return e.aspect===t});return n&&e.push(n),e},[]):r.sort(function(e,t){return t[o]-e[o]})).forEach(function(e){var t;s===i&&(c.color=[u.Fq[a]]),s&&s!==i||(t=parseInt(i)?I+i:i,n.push([t,e.aspect,e[o]]),c.aspects.push(e.aspect))}),n},[t])},c.setValue=function(e,t,n){var a=c.getEmotionSourceData(e,["业务视角","指标","指标好评率"],"posRate",t,n,c.oriPosRangeNames),t=c.getEmotionSourceData(e,["业务视角","指标","指标差评率"],"negRate",t,n,c.oriNegRangeNames);c.dataset=[a,t].map(function(e){return{source:e}}),n instanceof Function&&n(),console.log(c.dataset)},c.getOption=function(e){var t=c.chartRef.getWidth(),n=.8*t/(70*c.aspects.length),a=1<(0,l.jD)(c.aspects.join(""),12)/(.6*t),t=F.indexOf(e);c.datasetIndex=t;e=c.dataset[t].source.reduce(function(e,t,n){return 0<n&&!e.includes(t[0])&&e.push(t[0]),e},[]);return{title:{text:c.dataset[t].source[0][2]},dataset:c.dataset,grid:{top:80,left:36,right:72,bottom:a?60:n<1?50:30,containLabel:!0},visualMap:[{type:"piecewise",top:40,left:20,itemWidth:12,itemHeight:12,textGap:4,orient:"horizontal",dimension:0,categories:e.map(function(e){return e}),inRange:{symbol:"rect",color:c.color||u.Fq},outOfRange:{color:"#bfbfbf"},formatter:function(e){return e.startsWith(I)?e.substring(I.length):e}}],dataZoom:[{show:n<1,bottom:20,xAxisIndex:0,height:15,handleSize:"100%",showDetail:!1}],tooltip:{trigger:"axis",formatter:function(e){var t=e[0],n=t.marker,e=t.data,t=t.dimensionNames;return[(0,u.Zi)(e[1]),t[0]+"："+(e[0].startsWith(I)?e[0].substring(I.length):e[0]),n+" "+t[2]+"："+(100*e[2]).toFixed(2)+"%"].join("</br>")}},xAxis:{type:"category",axisLabel:{rotate:a?45:0,margin:a?15:8,formatter:function(e){return 6<e.length?e.substring(0,5)+"...":e}}},yAxis:{type:"value",axisLabel:{formatter:function(e){return 100*e+"%"}}},series:[{type:"bar",datasetIndex:t,barMaxWidth:24,markLine:{symbol:"none",silent:!0,data:[{type:"average",lineStyle:{color:"#BFBFBF"},label:{formatter:function(e){return"{a|"+(100*e.value).toFixed(2)+"%}"},rich:{a:{backgroundColor:"#BFBFBF",color:"#fff",padding:[4,4]}}}}]},encode:{x:1,y:2}}]}},c}return o()(e,a),e.prototype.renderChart=function(e,t,n,a){this.setValue(e,n,a),this.chartRef.clear(),this.chartRef.setOption(this.getOption(t))},e}(O().PureComponent),T={positive:"指标好评率",negative:"指标差评率"},t=function(a){function e(e){var i=a.call(this,e)||this;return i.rangeParam=void 0,i.handleOnMoreClick=function(e){var t=i.props,n=t.emotionType,t=t.data;"image"===e&&i.chartRef?(0,s._v)(i.chartRef,T[n]):"data"===e&&(0,p.P)(t)&&(0,s.aT)([i.dataset.reduce(function(t,e){return e.source.forEach(function(e){t.push(e.map(function(e){return e%1||1===e||0===e?(100*e).toFixed(2)+"%":e}))}),t.push(""),t},[])],T[n])},i.handleOnReceiveMessage=function(e){var t=e.data;i.chartRef&&"BarLineCountChart"===t.from&&(t.type===_?(e=i.dataset[i.datasetIndex].source.findIndex(function(e){return e[1]===t.name})-1,i.chartRef.dispatchAction({type:"showTip",seriesIndex:0,dataIndex:e})):t.type===c&&(i.rangeParam=t.rangedNames,i.renderChart(),i.setState({rangeChecked:!1})))},i.handleOnChartClick=function(e){var t=e.componentType,n=i.props,a=n.emotionType,n=n.onClick;"series"===t&&n(e,a)},i.handleOnMouseOver=function(e){var t=e.componentSubType,e=e.name;"bar"===t&&window.postMessage({type:_,from:"BarLineRateChart",name:e},"*")},i.handleOnRangeClick=function(e){i.rangeParam instanceof Array&&e?(i.rangeParam=function(){i.postUpdateMessage(e)},i.renderChart()):(i.rangeParam=void 0,i.postUpdateMessage(e)),i.setState({rangeChecked:e})},i.postUpdateMessage=function(e){var t=i.props.emotionType;window.postMessage({type:c,from:"BarLineRateChart",rangedNames:e?i.dataset["positive"===t?0:1].source.reduce(function(e,t,n){return n&&e.push(t[1]),e},[]):void 0})},i.state={rangeChecked:!1},i}o()(e,a);var t=e.prototype;return t.componentDidMount=function(){this.renderChart(),window.addEventListener("message",this.handleOnReceiveMessage)},t.componentWillUnmount=function(){window.removeEventListener("message",this.handleOnReceiveMessage)},t.componentDidUpdate=function(e){var t=this,n=e.data,a=e.emotionType,i=e.filterName,r=this.props,o=r.data,e=r.emotionType,r=r.filterName;((0,p.P)(o)&&JSON.stringify(n)!==JSON.stringify(o)||e!==a||i!==r)&&(this.state.rangeChecked&&(this.rangeParam=function(){t.postUpdateMessage(!0)}),this.renderChart()),!(0,p.P)(o)&&this.chartRef&&(this.chartRef=void 0)},t.renderChart=function(){var e=this.props,t=e.data,n=e.emotionType,e=e.filterName;(0,p.P)(t)&&this.chartRef&&a.prototype.renderChart.call(this,t,n,e,this.rangeParam)},t.render=function(){var e=this.props,t=e.data,n=e.titleOverlay,a=e.loading,i=e.emotionType,e=this.state.rangeChecked;return O().createElement(p.Z,{className:"yt_product_self_analysis_bar_line_chart",data:t,loading:a,renderTitle:O().createElement(h.Z,{title:T[i],titleOverlay:n,data:t,onMoreClick:this.handleOnMoreClick},O().createElement(w,{check:e,onChange:this.handleOnRangeClick}))},O().createElement(m.Z,{onChartReady:this.getChartRef,theme:"yunting_multi_color",option:{},style:{height:"100%"},onEvents:{click:this.handleOnChartClick,mouseover:this.handleOnMouseOver}}))},e}(r);t.propTypes={data:a().any,emotionType:a().string,titleOverlay:a().oneOf([a().node,a().string]),loading:a().bool,filterName:a().string};const A=t;var L=n(60222),D=n(61409),B=n(19335),M=n(23570),V={visible:!1,name:"",id:void 0,callback:void 0,type:"",errorHint:"",testing:!0};const Z=function(t){function e(e){var o=t.call(this,e)||this;return o._handleInputChange=function(e){var t=e.target.value.trim(),e={name:t};t?8<=t.length?(e.errorHint="最多只能输入8个字符",e.testing=!1):(e.errorHint="",e.testing=!0):(e.errorHint="输入框不能为空",e.testing=!1),o.setState(e)},o._handleOnInputBlur=function(e){var t=e.target.value.trim(),e={};t?8===t.length&&(e.errorHint="",e.testing=!0):(e.errorHint="业务视角名称不能为空",e.testing=!1),o.setState(e)},o._renderTitle=function(){var e=o.state.type;return"delete"===e?O().createElement("span",null,O().createElement("i",{className:"icon-cem_invalid-save"}),"确定删除此业务视角？"):"add"===e?"新建业务视角":"rename"===e?"重命名业务视角":""},o._renderBody=function(){var e=o.state,t=e.type,n=e.name,a=e.errorHint,e=e.testing;return"delete"===t?"删除对于整个项目生效":"add"===t||"rename"===t?O().createElement("div",{className:"edit_body"},O().createElement("div",{className:e?"":"input_error"},O().createElement("span",null,"视角名称"),O().createElement(M.Z,{placeholder:"请输入视角名称",defaultValue:n,onChange:o._handleInputChange,maxLength:8,onBlur:o._handleOnInputBlur})),O().createElement("span",{className:"error_hint"},a)):void 0},o._hancleOnCancel=function(){o.setState(Object.assign({},V))},o._handleOnConfirm=function(){var e=o.state,t=e.callback,n=e.type,a=e.id,i=e.name,r=e.testing,e={};"add"===n?e.name=i:"delete"===n?e.id=a:"rename"===n&&(e.id=a,e.name=i),r&&(t&&t(e),o._hancleOnCancel())},o.state=Object.assign({},V),o}o()(e,t);var n=e.prototype;return n.show=function(e){this.setState(d()({visible:!0},e))},n.render=function(){var e=this.state,t=e.visible,e=e.type;return O().createElement(y.Dialog,{visible:t,closeOnClickModal:!1,closeOnPressEscape:!1,title:this._renderTitle(),onCancel:this._hancleOnCancel,className:"yt_business_point_edit_dialog "+(e?"yt_business_point_"+e:"")},O().createElement(y.Dialog.Body,null,this._renderBody()),O().createElement(y.Dialog.Footer,null,O().createElement(y.Button,{onClick:this._hancleOnCancel},"取消"),O().createElement(y.Button,{type:"primary",onClick:this._handleOnConfirm},"确定")))},e}(O().PureComponent);var J=n(51474),r=function(e){function t(e,t){var n={type:e};"add"===e?(n.callback=a,n.name=""):"delete"===e?(n.callback=r,n.id=t):"rename"===e&&(n.callback=i,n.name=t.name,n.id=t.id),c.current.show(n)}var n=e.onConfigClick,a=e.onAdd,i=e.onRename,r=e.onDelete,o=e.data,s=e.loading,l=e.onEnd,c=O().useRef();return O().useEffect(function(){setTimeout(function(){var e;!o||(e=document.getElementById("business_point"+o.length))&&(0,p.P)(o)&&J.ZP.create(e,{group:"businessPoint",animation:150,filter:".undraggable",draggable:".draggable",onEnd:function(e){var t=e.newIndex,e=e.oldIndex;t!==e&&l(t,e)}})},0)},[o]),O().createElement(O().Fragment,null,O().createElement("div",{className:"yt_business_point_wrapper"},O().createElement("div",{className:"header_wrapper"},O().createElement("span",null,"业务视角"),O().createElement("span",null,"操作")),O().createElement(p.Z,{data:o,loading:s},(0,p.P)(o)&&O().createElement("div",{id:"business_point"+o.length},o.map(function(e){return O().createElement("div",{key:e.id,className:"item_wrapper draggable"},O().createElement("span",null,O().createElement("i",{className:"icon-cem_move my-handler"}),O().createElement("span",null,e.name)),O().createElement("span",null,O().createElement("span",{className:"control_btn",onClick:function(){return n(e)}},"配置指标"),O().createElement("span",{className:"control_btn",onClick:function(){return t("rename",e)}},"重命名"),O().createElement("span",{className:"control_btn",onClick:function(){return t("delete",e.id)}},"删除")))}))),O().createElement("div",{className:"add_btn",onClick:function(){return t("add")}},O().createElement("i",{className:"icon-cem_add-to"}),"新建视角")),O().createElement(Z,{ref:c}))};r.propTypes={onConfigClick:a().func,onAdd:a().func,onEnd:a().func,onRename:a().func,onDelete:a().func,onRange:a().func,data:a().any,loading:a().bool};const U=r;var t=n(91966),j=n.n(t),r=function(i){function e(){for(var n,e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(n=i.call.apply(i,[this].concat(t))||this).isCompositionHandling=!1,n.inputRef=O().createRef(),n._handlingOnComposition=function(){n.isCompositionHandling=!0},n._handleOnComposition=function(e){n.isCompositionHandling=!1,n._handleOnChange(e.target.value)},n._handleOnChange=function(e){var t;n.isCompositionHandling||(t=n.props.onChange)&&t(e)},n}return o()(e,i),e.prototype.render=function(){var e=this.props.className,e=void 0===e?"":e;return O().createElement(y.Input,d()({},this.props,{ref:this.inputRef,className:"yt_filter_lazy_input_wrapper "+e,onChange:this._handleOnChange,onCompositionStart:this._handlingOnComposition,onCompositionUpdate:this._handlingOnComposition,onCompositionEnd:this._handleOnComposition}))},e}(O().PureComponent);const W=r;r.propTypes={className:a().string};t=function(t){function e(e){var n=t.call(this,e)||this;return n._handleOnSeachIconClick=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),n.setState({isSearching:!0})},n._handleOnSearchCloseClick=function(e){var t=n.props.onSearchClose;e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),n.setState({isSearching:!1},function(){t&&t()})},n.state={isSearching:!1},n}return o()(e,t),e.prototype.render=function(){var e=this.props,t=e.label,n=e.className,a=e.onSearchChange,i=e.draggable,e=this.state.isSearching;return O().createElement("div",{className:"yt_fs_filter_label_wrapper "+n},O().createElement("div",{className:"label_view"},O().createElement("div",{className:"filter_normal"},e?O().createElement("div",{className:"search"},O().createElement("i",{className:"icon-cem_move my-handler  "+(i?"hover_item":"invisible_item")}),O().createElement(W,{className:"filter_search",onChange:a,size:"small",placeholder:"请输入"}),O().createElement("i",{className:"icon-cem_cancel",onClick:this._handleOnSearchCloseClick})):O().createElement("div",{className:"label"},O().createElement("i",{className:"icon-cem_move my-handler "+(i?"hover_item":"invisible_item")}),O().createElement("span",null,t),O().createElement("i",{className:"icon-cem_small-search hover_item",onClick:this._handleOnSeachIconClick})))))},e}(O().PureComponent);const H=t;function z(e,t){for(var n=new RegExp(t.toLocaleLowerCase()),a=[],i=0;i<e.length;i++)n.test(e[i].label.toLocaleLowerCase())&&a.push(e[i]);return a}function q(e,t){var a=e?e.slice():[];return t.forEach(function(t,e){var n=a.findIndex(function(e){return e.id===t});-1<n&&(n=a.splice(n,1)[0],a.splice(e,0,n))}),a}t.propTypes={label:a().string,className:a().string,onSearchChange:a().func,onSearchClose:a().func,draggable:a().bool};r=function(t){function e(e){var s=t.call(this,e)||this;return s.checkMoreVisable=function(){var e=s.props.id,t=document.getElementById("checkbotx_group_"+e),n=document.getElementById("more_"+e),e=document.getElementById("cbf_"+e);t&&n&&e&&(n.style.display=120<t.clientHeight?"inline-block":"none",e.style.height=n.classList.value.includes("show_more")?"120px":"unset")},s.handleOnAllChange=function(e){var t,n=s.props,a=n.onChange,i=n.options,r=n.id,n=n.values,o=s.state.filterOptions;o?(t=e?n.slice().concat(o.map(function(e){return e.id})):n.filter(function(t){return!o.find(function(e){return e.id===t})}),s.filterValues=e?o.map(function(e){return e.id}):[]):t=e?i.map(function(e){return e.id}):[],a&&a({id:r,valid:!0,values:t})},s.handleOnChange=function(e,t){var n=s.props,a=n.values,i=n.onChange,n=n.id,a=a.slice();e?(a.push(t),s.filterValues&&s.filterValues.push(t)):(a=a.filter(function(e){return e!==t}),s.filterValues&&(s.filterValues=s.filterValues.filter(function(e){return e!==t}))),i&&i({id:n,values:a})},s.handleSearchChange=function(e){var t=s.props,n=t.options,t=t.values,a=z(n,e);s.filterValues=t.filter(function(t){return a.find(function(e){return e.id===t})}),s.setState({filterOptions:a})},s.handleOnSearchClose=function(){s.filterValues=void 0,s.setState({filterOptions:void 0})},s.handleOnMoreShow=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();var t=s.props.id,e=document.getElementById("more_"+t),t=document.getElementById("cbf_"+t);e&&t&&(e.className.includes("show_more")?(e.classList.replace("show_more","show_less"),t.style.height="unset"):(e.classList.replace("show_less","show_more"),t.style.height="120px"))},s.handleOnFilterItemClose=function(e){var t=s.props,n=t.onFilterItemClose,t=t.id;e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),n&&n(t)},s._warpPopover=function(e,t){t=s.props.checkedPointDict[t];return t?O().createElement(v.Z,{overlay:"已被「"+t+"」业务视角选中",placement:"top"},O().createElement("span",null,e)):e},s.filterValues=void 0,s.state={options:e.options,filterOptions:void 0,mOptions:void 0},s}o()(e,t);var n=e.prototype;return n.componentDidMount=function(){window.addEventListener("resize",this.checkMoreVisable),this.checkMoreVisable()},n.componentWillUnmount=function(){window.removeEventListener("resize",this.checkMoreVisable)},e.getDerivedStateFromProps=function(e,t){var n=t.options,a=t.mOptions,t=e.options,e=e.values;return JSON.stringify(t)===JSON.stringify(n)&&a?null:{options:t,mOptions:q(t,e)}},n.shouldComponentUpdate=function(e,t){var n=e.values,a=e.options,i=e.closeable,r=e.indeterminates,o=this.props,s=o.values,l=o.options,e=o.closeable,o=o.indeterminates;return JSON.stringify(t)!==JSON.stringify(this.state)||JSON.stringify(n)!==JSON.stringify(s)||JSON.stringify(l)!==JSON.stringify(a)||JSON.stringify(r)!==JSON.stringify(o)||i!==e},n.componentDidUpdate=function(e,t){var n=e.options,a=this.props,i=a.options,e=a.id,a=t.filterOptions,t=this.state.filterOptions;JSON.stringify(n)!==JSON.stringify(i)&&this.checkMoreVisable(),JSON.stringify(a)!==JSON.stringify(t)&&(a&&!t?this.checkMoreVisable():(t=document.getElementById("cbf_"+e),e=document.getElementById("more_"+e),t&&e&&(t.style.height="unset",e.style.display="none")))},n.render=function(){var n=this,e=this.props,t=e.className,a=e.label,i=e.closeable,r=e.limit,o=e.values,s=e.indeterminates,l=e.checkedPointDict,c=e.id,u=this.state,d=u.filterOptions,p=u.mOptions,e=d||p,h=this.filterValues||o,u=h.length+s.length===e.length,d=!u&&(0<h.length||0<s.length),p=r||[0,1e3],m=p[0],f=p[1];return O().createElement("div",{id:"cbf_"+c,className:"yt_checkbox_filter_wrapper "+t,style:{height:120}},O().createElement(H,{label:a,className:"filter_label",draggable:"draggable"===t,allCheckable:e.length<f,onSearchChange:this.handleSearchChange,onSearchClose:this.handleOnSearchClose}),O().createElement("div",{className:"filter_list"},O().createElement("div",{className:"filter_control"},O().createElement("span",{style:{display:"none"},id:"more_"+c,className:"show_more hover_item",onClick:this.handleOnMoreShow}),i&&O().createElement("span",{className:"close hover_item",onClick:this.handleOnFilterItemClose},O().createElement("i",{className:"icon-cem_cancel"}))),0===e.length?O().createElement("div",{className:"filter_empty"}):O().createElement("div",{className:"filter_content"},O().createElement(y.Checkbox,{size:"small",className:"all",checked:u,indeterminate:d,disabled:r||Object.keys(l).length===e.length,onChange:this.handleOnAllChange},"全选"),O().createElement("div",{id:"checkbotx_group_"+c},e.slice(0,100).map(function(t){return O().createElement("span",{key:t.id},n._warpPopover(O().createElement(y.Checkbox,{label:t.id,checked:h.includes(t.id)||l[t.id],indeterminate:s.includes(t.id),disabled:!o.includes(t.id)&&o.length===f||o.includes(t.id)&&o.length===m||l[t.id],onChange:function(e){return n.handleOnChange(e,t.id)}},t.label),t.id))}),100<e.length&&O().createElement("span",{className:"hide_hint"},"— 该数值展示不会超过100条,需要查看更多请搜索")))))},e}(O().Component);const G=r;r.propTypes={id:a().string,className:a().string,label:a().string,values:a().arrayOf(a().oneOfType([a().string,a().number])),indeterminates:a().arrayOf(a().oneOfType([a().string,a().number])),checkedPointDict:a().object,limit:a().arrayOf(a().number),options:a().arrayOf(a().shape({id:a().string,label:a().string})),onChange:a().func,closeable:a().bool,onFilterItemClose:a().func};t=function(t){function e(e){var n=t.call(this,e)||this;return n._handleOnSeachIconClick=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),n.setState({isSearching:!0})},n._handleOnSearchCloseClick=function(e){var t=n.props.onSearchClose;e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),n.setState({isSearching:!1},function(){t&&t()})},n.state={isSearching:!1},n}return o()(e,t),e.prototype.render=function(){var e=this.props,t=e.label,n=e.className,a=e.onSearchChange,i=e.draggable,e=this.state.isSearching;return O().createElement("div",{className:"yt_rd_filter_label_wrapper "+n},O().createElement("div",{className:"label_view"},O().createElement("div",{className:"filter_normal"},e?O().createElement("div",{className:"search"},O().createElement("i",{className:"icon-cem_move my-handler  "+(i?"hover_item":"invisible_item")}),O().createElement(W,{className:"filter_search",onChange:a,size:"small",placeholder:"请输入"}),O().createElement("i",{className:"icon-cem_cancel",onClick:this._handleOnSearchCloseClick})):O().createElement("div",{className:"label"},O().createElement("i",{className:"icon-cem_move my-handler "+(i?"hover_item":"invisible_item")}),O().createElement("span",null,t),O().createElement("i",{className:"icon-cem_small-search hover_item",onClick:this._handleOnSeachIconClick})))))},e}(O().PureComponent);const K=t;t.propTypes={label:a().string,className:a().string,onSearchChange:a().func,onSearchClose:a().func,draggable:a().bool};r=function(t){function e(e){var i=t.call(this,e)||this;return i.checkMoreVisable=function(){var e=i.props.id,t=document.getElementById("radio_group_"+e),n=document.getElementById("more_"+e),e=document.getElementById("rf_"+e);t&&n&&(n.style.display=30<t.clientHeight?"inline-block":"none",e.style.height=n.classList.value.includes("show_more")?"30px":"unset")},i.handleOnSearchChange=function(e){var t=i.props.options;i.setState({filterOptions:z(t,e)})},i.handleOnSearchClose=function(e){i.setState({filterOptions:void 0})},i.handleOnMoreShow=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();var t=i.props.id,e=document.getElementById("more_"+t),t=document.getElementById("rf_"+t);e&&t&&(e.className.includes("show_more")?(e.classList.replace("show_more","show_less"),t.style.height="unset"):(e.classList.replace("show_less","show_more"),t.style.height="30px"))},i.handleOnFilterItemClose=function(){var e=i.props,t=e.onFilterItemClose,e=e.id;t&&t(e)},i.handleOnChange=function(e){var t=i.props,n=t.onChange,a=t.values,t=t.id;e!==a[0]&&n&&n({id:t,values:[e]})},i.state={options:e.options,filterOptions:void 0,mOptions:void 0},i}o()(e,t);var n=e.prototype;return n.componentDidMount=function(){window.addEventListener("resize",this.checkMoreVisable),this.checkMoreVisable()},n.componentWillUnmount=function(){window.removeEventListener("resize",this.checkMoreVisable)},e.getDerivedStateFromProps=function(e,t){var n=t.options,a=t.mOptions,t=e.options,e=e.values;return JSON.stringify(t)===JSON.stringify(n)&&a?null:{options:t,mOptions:q(t,e)}},n.shouldComponentUpdate=function(e,t){var n=e.values,a=e.options,i=e.closeable,r=this.props,o=r.values,e=r.options,r=r.closeable;return JSON.stringify(t)!==JSON.stringify(this.state)||JSON.stringify(n)!==JSON.stringify(o)||JSON.stringify(e)!==JSON.stringify(a)||i!==r},n.componentDidUpdate=function(e,t){var n=e.options,a=this.props,i=a.options,e=a.id,a=t.filterOptions,t=this.state.filterOptions;JSON.stringify(n)!==JSON.stringify(i)&&this.checkMoreVisable(),JSON.stringify(a)!==JSON.stringify(t)&&(a&&!t?this.checkMoreVisable():(t=document.getElementById("cbf_"+e),e=document.getElementById("more_"+e),t&&e&&(t.style.height="unset",e.style.display="none")))},n.render=function(){var n=this,e=this.state,t=e.filterOptions,a=e.mOptions,i=this.props,r=i.className,o=i.label,s=i.closeable,e=i.id,l=i.values[0],a=t||a;return O().createElement("div",{id:"rf_"+e,className:"yt_radio_filter_wrapper "+r,style:{height:30}},O().createElement(K,{label:o,className:"filter_label",draggable:"draggable"===r,onSearchChange:this.handleOnSearchChange,onSearchClose:this.handleOnSearchClose}),O().createElement("div",{className:"filter_list"},O().createElement("div",{className:"filter_control"},O().createElement("span",{style:{display:"none"},id:"more_"+e,className:"show_more hover_item",onClick:this.handleOnMoreShow}),s&&O().createElement("span",{className:"close hover_item",onClick:this.handleOnFilterItemClose},O().createElement("i",{className:"icon-cem_cancel"}))),0===a.length?O().createElement("div",{className:"filter_empty"}):O().createElement("div",{id:"radio_group_"+e,className:"filter_content"},a.map(function(e,t){return 100<t?"":O().createElement(y.Radio,{key:e.id,value:e.id,checked:l===e.id,onChange:n.handleOnChange},e.label)}),100<a.length&&O().createElement("span",{className:"hide_hint"},"— 该数值展示不会超过100条,需要查看更多请搜索"))))},e}(O().Component);const Q=r;r.propTypes={id:a().string,className:a().string,label:a().string,values:a().arrayOf(a().oneOf(a().string|a().number)),options:a().arrayOf(a().shape({id:a().string,label:a().string})),onChange:a().func,closeable:a().bool,onFilterItemClose:a().func};var Y=n(87219),t=function(t){function e(e){var s=t.call(this,e)||this;s._hidePannel=function(){s.state.show&&s.setState({show:!1,filterOptions:void 0}),s.inputRef.current.inputRef.current.refs.input.value=""},s._handleParentClick=function(e){s.state.show&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},s._handleTriggerClick=function(){setTimeout(function(){s.setState({show:!s.state.show})},0)},s._handleOnInputChange=function(t){var e=s.props.options;s.setState({filterOptions:""!==t?(void 0===e?[]:e).filter(function(e){return e.label.includes(t)}):void 0})},s._renderFilterOptions=function(){var e=s.state,t=e.filterOptions,n=e.values;return 0===t.length?O().createElement("div",{className:"filter_empty"}):O().createElement(O().Fragment,null,t.map(function(t){return O().createElement("div",{key:t.value,className:"check_item"},O().createElement(y.Checkbox,{disabled:1===n.length&&n.includes(t.value),checked:n.includes(t.value),onChange:function(e){return s._handleOnChange(e,t.value)}},t.label))}))},s._handleOnAllChange=function(e){var t=s.props.options,t=void 0===t?[]:t;s.setState({values:e?t.map(function(e){return e.value}):[t[0].value]})},s._handleOnChange=function(e,t){var n=s.state.values,a=void 0;e?(a=n.slice()).push(t):a=n.filter(function(e){return e!==t}),s.setState({values:a})},s._handleOnRangeClick=function(e,t){var n=s.state.values.slice(),a=n.splice(e,1)[0];"top"===t?n.splice(0,0,a):"up"===t?n.splice(e-1,0,a):"down"===t&&n.splice(e+1,0,a),s.setState({values:n})},s._renderOptions=function(){function n(t,e,n,a){return O().createElement("div",{key:t.value,className:"check_item"},O().createElement(y.Checkbox,{disabled:a,checked:e,onChange:function(e){return s._handleOnChange(e,t.value)}},t.label),e&&i&&1<o.length&&O().createElement("div",{className:"range_buttons"},0!==n&&O().createElement("i",{className:"icon-cem_roof-placement",onClick:function(){return s._handleOnRangeClick(n,"top")}}),0!==n&&O().createElement("i",{className:"icon-cem_upper",onClick:function(){return s._handleOnRangeClick(n,"up")}}),n!==o.length-1&&O().createElement("i",{className:"icon-cem_lower",onClick:function(){return s._handleOnRangeClick(n,"down")}})))}var e=s.props,t=e.options,a=void 0===t?[]:t,i=e.sortable,r=s.state.values,t=r.length===a.length,e=a.reduce(function(e,t){var n=r.indexOf(t.value);return-1<n?e.selOpts[n]=t:e.unSelOpts.push(t),e},{selOpts:[],unSelOpts:[]}),o=e.selOpts,e=e.unSelOpts;return 0===a.length?O().createElement("div",{className:"filter_empty"}):O().createElement(O().Fragment,null,O().createElement(y.Checkbox,{style:{margin:"12px 0"},checked:t,indeterminate:!t&&0<r.length,onChange:s._handleOnAllChange},"全选"),0<o.length&&O().createElement("div",{className:"divider"}),o.map(function(e,t){return n(e,!0,t,1===o.length)}),0<e.length&&O().createElement("div",{className:"divider"}),e.map(function(e){return n(e,!1)}))},s._handleOnInputClearClick=function(e){s.inputRef.current.inputRef.current.refs.input.value="",s._handleOnInputChange("")},s._handleOnConfirm=function(){var e=s.props.onChange,t=s.state.values;s._hidePannel(),e&&e(t)},s._handleOnCancel=function(e){var t=s.props.onCancel;s._hidePannel(),t&&t()};e=e.values;return s.state={values:e,preValues:e,show:!1},s.inputRef=O().createRef(),s}o()(e,t);var n=e.prototype;return n.componentDidMount=function(){window.addEventListener("click",this._hidePannel)},n.componentWillUnmount=function(){window.removeEventListener("click",this._hidePannel)},n.shouldComponentUpdate=function(e,t){var n=this.props.values,e=e.values;return JSON.stringify(n)!==JSON.stringify(e)||JSON.stringify(t)!==JSON.stringify(this.state)},e.getDerivedStateFromProps=function(e,t){t=t.preValues,e=e.values;return JSON.stringify(t)!==JSON.stringify(e)?{preValues:e,values:e}:null},n.render=function(){var e=this.props.className,t=this.state,n=t.show,t=t.filterOptions;return O().createElement("div",{className:"yt_filter_section_setting_button_wrapper "+e,onClick:this._handleParentClick},O().createElement("span",{className:"button_trigger",onClick:this._handleTriggerClick},O().createElement("i",{className:"icon-cem_top-setting"})),O().createElement("div",{className:"pannel",style:{display:n?"block":"none"}},O().createElement("div",{className:"pannel_content"},O().createElement(W,{ref:this.inputRef,placeholder:"请输入关键字",size:"small",icon:t?"close":"search",onIconClick:t?this._handleOnInputClearClick:null,onChange:this._handleOnInputChange}),t?this._renderFilterOptions():this._renderOptions()),O().createElement("div",{className:"pannel_buttons"},O().createElement(y.Button,{size:"small",onClick:this._handleOnCancel},"取消"),O().createElement(y.Button,{size:"small",type:"primary",onClick:this._handleOnConfirm},"确定"))))},e}(O().Component);const X=t;t.propTypes={className:a().string,sortable:a().bool,values:a().arrayOf(a().string),options:a().arrayOf(a().shape({value:a().string,label:a().string})),onChange:a().func,onCancel:a().func};r=function(n){function e(e){var t=n.call(this,e)||this;return t._hideSetting=function(){t.setState({settingBtnShow:!1})},t._handleOnSettingClick=function(e){setTimeout(function(){t.setState({settingBtnShow:!t.state.settingBtnShow})},0)},t._handleParentClick=function(e){t.state.show&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},t._handlOnSettingCancel=function(){t.setState({settingBtnShow:!1})},t.state={settingBtnShow:!1},t}o()(e,n);var t=e.prototype;return t.componentDidMount=function(){window.addEventListener("click",this._hideSetting)},t.componentWillUnmount=function(){window.removeEventListener("click",this._hideSetting)},t.render=function(){var e=this.props,t=e.className,n=e.label,a=e.activeFilters,i=void 0===a?[]:a,r=e.filterOptions,o=void 0===r?[]:r,s=e.onActiveFilterChange,a=e.configurable,r=e.sortable,e=this.state.settingBtnShow;return O().createElement("div",{className:"yt_filter_section_label_wrapper "+t,onClick:this._handleParentClick},O().createElement("div",null,O().createElement("span",{className:"label_text"},n),O().createElement("span",{onClick:this._handleOnSettingClick,className:"setting_button "+(a?"hover_item_setting":"invisable_item")+" "+(e?"setting_button_visible":"")},O().createElement(X,{sortable:r,values:i,options:o,onChange:s,onCancel:this._handlOnSettingCancel}))))},e}(O().PureComponent);const $=r;r.propTypes={label:a().string,className:a().string,configurable:a().bool,sortable:a().bool,activeFilters:a().arrayOf(a().string),filterOptions:a().arrayOf(a().shape({value:a().string,label:a().string})),onActiveFilterChange:a().func};t=function(a){function e(){for(var r,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(r=a.call.apply(a,[this].concat(t))||this).handleOnFilterValueChange=function(n){var e=r.props,t=e.onFilterValueChange,e=e.values,e=(0,Y.ZP)(e,function(e){var t=e.findIndex(function(e){return e.id===n.id});-1<t?e[t].values=n.values:e.push(n)});t&&t(e)},r.handleOnFilterItemClose=function(t){var e=r.props,n=e.onActiveFilterChange,a=e.onFilterValueChange,i=e.activeFilters,e=e.values;e.some(function(e){return e.id===t})&&a&&a(e.filter(function(e){return e.id!==t})),n&&n(i.filter(function(e){return e!==t}))},r.handleOnActiveFilterChange=function(e){var t=r.props.onActiveFilterChange;t&&t(e)},r}o()(e,a);var t=e.prototype;return t.shouldComponentUpdate=function(e){var t=e.values,n=e.data,a=e.activeFilters,i=this.props,r=i.values,e=i.data,i=i.activeFilters;return JSON.stringify(t)!==JSON.stringify(r)||JSON.stringify(n)!==JSON.stringify(e)||JSON.stringify(a)!==JSON.stringify(i)},t.componentDidMount=function(){var i=this,e=this.props,t=e.id,n=e.draggable,e=document.getElementById("section_"+t);e&&n&&(this.sortableJs=J.ZP.create(e,{group:t,animation:150,filter:".undraggable",draggable:".draggable",onEnd:function(e){var t=i.props,n=t.onActiveFilterChange,a=t.activeFilters,t=e.newIndex,e=e.oldIndex;t!==e&&(e=(a=a.slice()).splice(e,1)[0],a.splice(t,0,e),n&&n(a))}}))},t.render=function(){var a=this,e=this.props,t=e.label,i=e.data,r=e.values,n=e.activeFilters,o=e.id,s=e.draggable,l=e.configurable,e=n.filter(function(t){var e=i.find(function(e){e=e.id;return t===e});return!!e&&e.options instanceof Array&&0<e.options.length}),n=i.reduce(function(e,t){return t.options instanceof Array&&0<t.options.length&&e.push({value:t.id,label:t.label}),e},[]),c=e.reduce(function(e,t){var n=i.find(function(e){e=e.id;return t===e});return n&&n.options instanceof Array&&0<n.options.length&&e.push(n),e},[]);return O().createElement("div",{className:"yt_aspect_filter_section_wrapper"},t&&O().createElement($,{label:t,className:"section_label",filterOptions:n,configurable:l,sortable:s,activeFilters:e,onActiveFilterChange:this.handleOnActiveFilterChange}),O().createElement("div",{className:"section_comps",id:"section_"+o},c.map(function(t){var e=r.find(function(e){return e.id===t.id}),n=void 0===t.closeable||t.closeable;switch(t.filterType){case"radio":return O().createElement(Q,d()({className:s?"draggable":"undraggable"},t,{key:t.id,closeable:l&&n&&1<c.length,values:e?e.values:[],onChange:a.handleOnFilterValueChange,onFilterItemClose:a.handleOnFilterItemClose}));case"checkbox":default:return O().createElement(G,d()({className:s?"draggable":"undraggable"},t,{key:t.id,closeable:l&&n&&1<c.length,values:e?e.values:[],onChange:a.handleOnFilterValueChange,onFilterItemClose:a.handleOnFilterItemClose,indeterminates:e?e.indeterminates:[],checkedPointDict:e?e.checkedPointDict:{}}))}})))},e}(O().Component);const ee=t;t.propTypes={label:a().string,id:a().string,onFilterValueChange:a().func,onActiveFilterChange:a().func,draggable:a().bool,configurable:a().bool,values:a().arrayOf(a().shape({id:a().string,values:a().arrayOf(a().string)})),activeFilters:a().arrayOf(a().string),data:a().arrayOf(a().shape({id:a().string,label:a().string,filterType:a().string,allCheckable:a().bool,limit:a().arrayOf(a().number),closeable:a().bool,options:a().arrayOf(a().shape({id:a().string,label:a().string}))}))};var te=["aspect1","aspect2"],ne={aspect1:"一级指标",aspect2:"二级指标"},ae={count:0,name:"",values:te.map(function(e){return{id:e,values:[],indeterminates:[],parentCount:{},checkedPointDict:{}}}),data:te.map(function(e){return{id:e,label:ne[e],closeable:!1,options:[]}}),asp2ParentDict:{}},r=function(t){function e(e){var n=t.call(this,e)||this;return n._handleOnFilterValueChange=function(r){var e=n.state,o=e.values,t=e.data,s=e.asp2ParentDict,e=n.props.data,l=void 0===e?[]:e,a=(0,Y.ZP)(r,function(n){var e,t,a,i;r[0].values.length!==o[0].values.length?(i=r[0].values,0===r[0].values.length?i=l.map(function(e){return e.aspectName}):r[0].values.length!==l.length&&(t=r[0].values.length>o[0].values.length?(e=n[0].values,o[0].values):(e=o[0].values,n[0].values),i=j()(e,t)),i.forEach(function(t){var e=l.find(function(e){return e.aspectName===t});e&&(n[0].parentCount[t]||(n[0].parentCount[t]=0),e.aspect2List.forEach(function(e){r[0].values.length>o[0].values.length?n[1].values.includes(e.aspectName)||n[1].checkedPointDict[e.aspectName]||(n[0].parentCount[t]+=1,n[1].values.push(e.aspectName)):-1<(e=n[1].values.indexOf(e.aspectName))&&(n[1].values.splice(e,1),--n[0].parentCount[t])}),n[0].parentCount[t]===e.aspect2List.length?n[0].indeterminates=n[0].indeterminates.filter(function(e){return e!==t}):(-1<(e=n[0].indeterminates.indexOf(t))?n[0].indeterminates.splice(e,1):n[0].values.includes(t)&&n[0].indeterminates.push(t),n[0].values=n[0].values.filter(function(e){return e!==t})))})):r[1].values.length!==o[1].values.length&&(i=r[1].values.length>o[1].values.length?(a=n[1].values,o[1].values):(a=o[1].values,n[1].values),j()(a,i).forEach(function(e){var t=s[e],e=l.find(function(e){return e.aspectName===t});e&&(r[1].values.length>o[1].values.length?(n[0].parentCount[t]+=1,e.aspect2List.length>n[0].parentCount[t]?(n[0].values=n[0].values.filter(function(e){return e!==t}),n[0].indeterminates.includes(t)||n[0].indeterminates.push(t)):e.aspect2List.length===n[0].parentCount[t]&&(n[0].values.includes(t)||n[0].values.push(t),n[0].indeterminates=n[0].indeterminates.filter(function(e){return e!==t}))):(--n[0].parentCount[t],e.aspect2List.length>n[0].parentCount[t]&&(n[0].values=n[0].values.filter(function(e){return e!==t}),n[0].indeterminates.includes(t)||n[0].indeterminates.push(t)),0===n[0].parentCount[t]&&(n[0].indeterminates=n[0].indeterminates.filter(function(e){return e!==t}))))}))}),t=(0,Y.ZP)(t,function(e){var n=[];a[0].values.length||a[0].indeterminates.length?(a[0].values.forEach(function(t){var e=l.find(function(e){return e.aspectName===t});e&&e.aspect2List.forEach(function(e){n.push({id:e.aspectName,label:e.aspectName})})}),a[0].indeterminates.forEach(function(t){var e=l.find(function(e){return e.aspectName===t});e&&e.aspect2List.forEach(function(e){n.push({id:e.aspectName,label:e.aspectName})})})):l.forEach(function(e){e.aspect2List.forEach(function(e){n.push({id:e.aspectName,label:e.aspectName})})}),e[1].options=n});n.setState({values:a,data:t})},n._handleOnClean=function(){var e=(0,Y.ZP)(n.state.values,function(e){e[0].values=[],e[1].values=[]});n._handleOnFilterValueChange(e)},n.state=JSON.parse(JSON.stringify(ae)),n}o()(e,t),e.getDerivedStateFromProps=function(e,t){var i=e.pointData,r=e.data;if(!i)return JSON.parse(JSON.stringify(ae));if(i&&r&&r instanceof Array&&!t.name){var n=(0,Y.ZP)(t.values,function(a){i.businessPointFilterList.forEach(function(e,t,n){a[e.aspectLevel-1].values.push(e.aspectName),2===e.aspectLevel&&(a[0].parentCount[e.parentName]||(a[0].parentCount[e.parentName]=0),a[0].parentCount[e.parentName]+=1),t===n.length-1&&Object.keys(a[0].parentCount).forEach(function(t){var e=r.find(function(e){return e.aspectName===t});e&&e.aspect2List.length>a[0].parentCount[t]&&(a[0].indeterminates.includes(t)||a[0].indeterminates.push(t),a[0].values=a[0].values.filter(function(e){return e!==t}))})})}),e=(0,Y.ZP)(t.data,function(t){r.forEach(function(e){t[0].options.push({id:e.aspectName,label:e.aspectName}),(!n[0].values.length&&!n[0].indeterminates.length||n[0].values.includes(e.aspectName)||n[0].indeterminates.includes(e.aspectName))&&e.aspect2List.forEach(function(e){t[1].options.push({id:e.aspectName,label:e.aspectName})})})}),a={},o={},t=r.reduce(function(t,n){return n.status&&i.name!==n.businessPointName&&(a[n.aspectName]=n.businessPointName),n.aspect2List.forEach(function(e){t[e.aspectName]=n.aspectName,e.status&&i.name!==e.businessPointName&&(o[e.aspectName]=e.businessPointName)}),t},{}),n=(0,Y.ZP)(n,function(e){e[0].checkedPointDict=a,e[1].checkedPointDict=o});return{count:i.businessPointFilterList.reduce(function(e,t){return 2===t.aspectLevel?e+1:e},0),name:i.name,values:n,data:e,asp2ParentDict:t}}return null};var n=e.prototype;return n.getValues=function(){return this.state.values.reduce(function(t,e,n){return e.values.forEach(function(e){t.push({aspectLevel:n+1,aspectName:e})}),t},[])},n.render=function(){var e=this.state,t=e.name,n=e.count,a=e.values,i=e.data,r=this.props,e=r.data,r=r.loading;return O().createElement(p.Z,{data:e,loading:r,className:"yt_config_drawer_aspect_config_wrapper"},(0,p.P)(e)&&O().createElement(O().Fragment,null,O().createElement("div",{className:"title"},"已为",O().createElement("span",null,"「"+t+"」"),"这个业务视角配置了",O().createElement("span",null," "+n+" "),"个叶子级指标"),O().createElement(ee,{data:i,values:a,draggable:!1,configurable:!1,activeFilters:te,onFilterValueChange:this._handleOnFilterValueChange}),O().createElement("div",{className:"clean"},O().createElement("span",{onClick:this._handleOnClean},"清空选项"))))},e}(O().PureComponent);r.propTypes={data:a().any,pointData:a().any,loading:a().bool};const ie=r;var t=n(55609),a=n(64396),re=a.Z.product.selfAnalysis,r=function(t){function e(e){var a=t.call(this,e)||this;return a._handleOnConfigClick=function(e){a.setState({levelTwoVisible:!0,pointData:e},function(){a.props.fetchAspectList({id:e.id,valueList:e.businessPointFilterList})})},a._handleOnLevelOneClose=function(){a.setState({levelOneVisible:!1})},a._handleOnLevelTwoClose=function(){a.setState({levelTwoVisible:!1,pointData:void 0},function(){return a.props.save({configListData:void 0})})},a._handleOnPointAdd=function(e){a.props.addBusinessPoint(e)},a._handleOnPointRename=function(e){a.props.renameBusinessPoint(e)},a._handleOnPointDelete=function(e){a.props.deleteBusinessPoint(e)},a._handleOnPointRange=function(e,t){a.props.rangeAspect({rangedIds:e,rangedNames:t})},a._handleOnConfigConfirm=function(){var e=a.state.pointData,t=a.configRef.current,t=t&&t.getValues();a.props.setAspect({filterList:t,id:e.id,name:e.name}).then(a._handleOnLevelTwoClose)},a._handleOnPointEnd=function(e,t){var n=a.props.businessPointList.slice(),t=n.splice(t,1)[0];n.splice(e,0,t);e=n.reduce(function(e,t){return e[0].push(t.name),e[1].push(t.id),e},[[],[]]),t=e[0],e=e[1];a.props.rangeBusinessPoint({rangedNames:t,rangedIds:e,businessPointList:n})},a.state={levelOneVisible:!1,levelTwoVisible:!1,pointData:void 0},a.configRef=O().createRef(),a}o()(e,t);var n=e.prototype;return n.componentDidMount=function(){},n.show=function(){this.setState({levelOneVisible:!0})},n.render=function(){var e=this.state,t=e.levelTwoVisible,n=e.levelOneVisible,a=e.pointData,i=this.props,r=i.businessPointList,o=i.loading,e=i.configListData,i=i.loadingConfig;return O().createElement(B.Z,{className:"yt_drawer_wrapper",visible:n,onClose:this._handleOnLevelOneClose,keyboard:!1,maskClosable:!0,closeable:!0,width:520,placement:"right",push:{distance:580},title:O().createElement(O().Fragment,null,O().createElement("span",{className:"drawer_title"},"设置业务视角"),O().createElement(D.rU,{to:"https://www.yuque.com/docs/share/c665baf3-2e5a-40eb-943e-17c3205d6a7d?# 《业务视角功能说明》",className:"yt-feedback-read-more",target:"_blank"},"查看更多")),bodyStyle:{paddingBottom:80}},O().createElement(U,{onConfigClick:this._handleOnConfigClick,data:r,loading:o,onAdd:this._handleOnPointAdd,onRename:this._handleOnPointRename,onDelete:this._handleOnPointDelete,onRange:this._handleOnPointRange,onEnd:this._handleOnPointEnd}),O().createElement(B.Z,{className:"yt_drawer_wrapper",keyboard:!1,visible:t,onClose:this._handleOnLevelTwoClose,maskClosable:!0,closeable:!0,width:714,placement:"right",title:O().createElement("span",{className:"drawer_title"},"配置标签"),bodyStyle:{paddingBottom:80},footerStyle:{textAlign:"right"},footer:O().createElement(O().Fragment,null,O().createElement(y.Button,{onClick:this._handleOnLevelTwoClose},"取消"),O().createElement(y.Button,{type:"primary",onClick:this._handleOnConfigConfirm},"确定"))},O().createElement(ie,{data:e,pointData:a,ref:this.configRef,loading:i})))},e}(O().PureComponent);r.propTypes={};const oe=(0,t.connect)(function(e){var t=e.loading,e=i()(e,["loading"]);return{businessPointList:e[re].businessPointList,configListData:e[re].configListData,loading:t.effects[re+"/fetchBusinessPointList"]||t.effects[re+"/rangeBusinessPoint"]||!1,loadingConfig:t.effects[re+"/fetchAspectList"]||!1}},function(t){return{fetchBusinessPointList:function(e){return t({type:re+"/fetchBusinessPointList",payload:e})},addBusinessPoint:function(e){return t({type:re+"/addBusinessPoint",payload:e})},renameBusinessPoint:function(e){return t({type:re+"/renameBusinessPoint",payload:e})},deleteBusinessPoint:function(e){return t({type:re+"/deleteBusinessPoint",payload:e})},rangeBusinessPoint:function(e){return t({type:re+"/rangeBusinessPoint",payload:e})},fetchAspectList:function(e){return t({type:re+"/fetchAspectList",payload:e})},setAspect:function(e){return t({type:re+"/setAspect",payload:e})},save:function(e){return t({type:re+"/save",payload:e})}}},null,{withRef:!0})(r);const se=function(e){var t=e.aspectCountData,n=e.fetchingAspectCount,a=e.onAspectCountSetting,i=e.posAspectRateData,r=e.fetchingPositiveAspectRate,o=e.onPosAspectRateSetting,s=e.negAspectRateData,l=e.fetchingNegativeAspectRate,c=e.onNegAspectRateSetting,u=e.chartData,d=e.isDataEmpty,p=e.fetchingChartData,h=e.rateEmotionType,m=e.rateEmotionTypeFlavor,f=e.countEmotionType,g=e.countEmotionTypeFlavor,v=e.onChartClick,y=e.onFilterChange,C=e.onFlavorChange,_=e.onFilterReady,E=O().useRef(),b=O().useState(""),e=b[0],b=b[1];return O().createElement("div",{className:"yt_slef_analysis_wrapper"},O().createElement(N.Z,{pageType:"PRODUCT_SELF",onReady:_,onChange:y}),O().createElement("div",{className:"content"},O().createElement(k.Z,{orientation:"horizontal",colNumber:4,showList:["card_0","card_1","card_2"]},O().createElement(L.Z,{key:"card_0",loading:n,style:{width:"100%",height:"160px"},data:t,compare:t&&t[0].compare,onSetting:a,tip:O().createElement(O().Fragment,null,O().createElement("div",null,"「指标声量」选定的有效消息中，可以提取出来的指标声量。注：这里的指标声量是按叶子级别指标（一般指二级指标）的作为计算，对于一级指标不去重。"),O().createElement("div",null,"「有效消息」获得的评论中，除去被标记为“无效数据”的的评论数，剩下的均被标记为“有效数据”。"),O().createElement("div",null,"「指标提及率」是指选中的消息中，指标声量÷有效评论数量。"))}),O().createElement(L.Z,{key:"card_1",loading:r,style:{width:"100%",height:"160px"},data:i,compare:i&&i[0].compare,onSetting:o,tip:O().createElement(O().Fragment,null,O().createElement("div",null,"「指标声量」选定的有效消息中，可以提取出来的指标声量。注：这里的指标声量是按叶子级别指标（一般指二级指标）的作为计算，对于一级指标不去重。"),O().createElement("div",null,"「正面声量」即指标正面声量，只统计指标情感为正面的指标的声量。"),O().createElement("div",null,"「指标好评率」 = 指标正面声量 ÷ 指标声量。"))}),O().createElement(L.Z,{key:"card_2",loading:l,style:{width:"100%",height:"160px"},data:s,compare:s&&s[0].compare,onSetting:c,tip:O().createElement(O().Fragment,null,O().createElement("div",null,"「指标声量」选定的有效消息中，可以提取出来的指标声量。注：这里的指标声量是按叶子级别指标（一般指二级指标）的作为计算，对于一级指标不去重。"),O().createElement("div",null,"「负面声量」即指标负面声量，只统计指标情感为负面的指标的声量。"),O().createElement("div",null,"「指标差评率」 = 指标负面声量 ÷ 指标声量。"))})),O().createElement(k.Z,{orientation:"vertical",showList:["chart_0","chart_1","chart_2"]},O().createElement(S,{key:"chart_0",data:u,emotionType:h,emotionTypeFlavor:m,title:"自主分析",isDataEmpty:d,titleOverlay:O().createElement(O().Fragment,null,O().createElement("div",null,"「指标声量」选定的有效消息中，可以提取出来的指标声量。注：这里的指标声量是按叶子级别指标（一般指二级指标）的作为计算，对于一级指标不去重"),O().createElement("div",null,"「正面声量」即指标正面声量，只统计指标情感为正面的指标的声量"),O().createElement("div",null,"「指标好评率」 = 指标正面声量 ÷ 指标声量")),loading:p,rateEmotionType:h,onChange:y,onFlavorChange:C,onConfigClick:function(){E.current.wrappedInstance.show()},onClick:b}),O().createElement(A,{key:"chart_1",titleOverlay:O().createElement(O().Fragment,null,O().createElement("div",null,"「指标好评率」指标正面声量÷（指标正面声量 + 指标负面声量）。"),O().createElement("div",null,"「指标差评率」指标负面声量÷（指标正面声量 + 指标负面声量）。")),onClick:v,data:u,emotionType:h,loading:p,filterName:e}),O().createElement(x,{key:"chart_2",onClick:v,data:u,emotionType:f,emotionTypeFlavor:g,loading:p,onFlavorChange:C,onChange:y,filterName:e}))),O().createElement(oe,{ref:E}))};var le=n(35239),ce=n(2329),ue=a.Z.product.selfAnalysis,de=a.Z.screening,a=function(t){function e(e){var u=t.call(this,e)||this;return u._handleOnFilterReady=function(e){u.props.fetchParams(d()({},e,{filterModel:e.filterValue,projectId:le.t.get(le.V.curProject).id,shouldRefreshChart:!0}))},u._handleOnFilterChange=function(e){e.dateFilter?u.props.fetchDatas(d()({},e,{filterModel:e.filterValue,shouldRefreshChart:!0,projectId:le.t.get(le.V.curProject).id})):(e.rateEmotionType||e.countEmotionType)&&u.props.save(e)},u._handleOnChartClick=function(e,t){var n=e.data,a=e.name,i=u.props,r=i.filterModel,o=i.analysisModel,s=i.curScreeningMap,l=i.projectId,e=i.dateFilter,c=o[0].values[0],i=s.find(function(e){return"CONFIG"===e.id}).data.find(function(e){return e.id===c.id}).options.filter(function(e){return e.id!==c.values[0]}).map(function(e){return e.id}),t={projectId:l,leftName:"自主分析",analyseName:(null==(s=s.find(function(e){return"CONFIG"===e.id}).data.find(function(e){return e.id===c.id}).options.find(function(e){return e.id===c.values[0]}))?void 0:s.label)||"",type:"EMOTION_ASPECT_LEVEL_BAR",seriesName:"positive"===t?"正面":"负面",aspect:a,aspectTotal:"positive"===t?n[2]:-n[2],dateFilter:e,analysisObjs:i,filterModel:d()({},(0,ce.bF)(r),{analysis:{id:o[0].values[0].id,name:o[0].values[0].label||"",type:"CONFIG"===o[0].id?"CONN_CONFIG":o[0].id,values:o[0].values[0].values},aspect:{aspect1:[],aspect2:[a],emotion:[t]}})};window.open("/tab/detail?"+encodeURIComponent(JSON.stringify(t)))},u._handleOnFlavorChange=function(e){u.props.updateFlavors(e)},u._handleOnAspectCountSetting=function(e){u.props.fetchAspectCount(e)},u._handleOnPosAspectRateSetting=function(e){u.props.fetchPositiveAspectRate(e)},u._handleOnNegAspectRateSetting=function(e){u.props.fetchNegativeAspectRate(e)},u.state={},u.event={onFilterReady:u._handleOnFilterReady,onFilterChange:u._handleOnFilterChange,onFlavorChange:u._handleOnFlavorChange,onChartClick:u._handleOnChartClick,onAspectCountSetting:u._handleOnAspectCountSetting,onPosAspectRateSetting:u._handleOnPosAspectRateSetting,onNegAspectRateSetting:u._handleOnNegAspectRateSetting},u}o()(e,t);var n=e.prototype;return n.componentWillUnmount=function(){},n.render=function(){return O().createElement(se,d()({},this.props,this.state,this.event))},e}(O().PureComponent);const pe=(0,t.connect)(function(e){var t=e.loading,e=i()(e,["loading"]);return d()({},e[ue],{curScreeningMap:e[de].curScreeningMap,fetchingChartData:t.effects[ue+"/fetchChartData"]||!1,fetchingAspectCount:t.effects[ue+"/fetchAspectCount"]||!1,fetchingPositiveAspectRate:t.effects[ue+"/fetchPositiveAspectRate"]||!1,fetchingNegativeAspectRate:t.effects[ue+"/fetchNegativeAspectRate"]||!1})},function(t){return{fetchParams:function(e){return t({type:ue+"/fetchParams",payload:e})},updateFlavors:function(e){return t({type:ue+"/updateFlavors",payload:e})},fetchDatas:function(e){return t({type:ue+"/fetchDatas",payload:e})},save:function(e){return t({type:ue+"/save",payload:e})},fetchAspectCount:function(e){return t({type:ue+"/fetchAspectCount",payload:e})},fetchPositiveAspectRate:function(e){return t({type:ue+"/fetchPositiveAspectRate",payload:e})},fetchNegativeAspectRate:function(e){return t({type:ue+"/fetchNegativeAspectRate",payload:e})}}})(a)},27310:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});function c(e){return e=e.height,u().createElement("div",{style:{background:"#fff",height:e,display:"flex",alignItems:"center",justifyContent:"center"}},"Template")}var t=n(85354),i=n.n(t),t=n(67294),u=n.n(t),t=n(45697),t=n.n(t),o=n(92360),n=function(a){function e(){for(var r,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(r=a.call.apply(a,[this].concat(t))||this).clientHeight=160,r.notShowList=[],r._handleOnCheckBoxChange=function(e,t){var n,a=r.props,i=a.onChange,a=a.showList;e?(n=a.slice()).push(t):n=a.filter(function(e){return e!==t}),i&&i(n)},r._renderEditableFrame=function(t,e){var n=r.props,a=n.editable,n=n.colNumber,n=void 0===n?1:n;return u().createElement("div",{id:t.key,key:t.key,style:{width:"calc("+100/n+"% - 12px)"},className:a?"child_editable":""},t,a&&u().createElement(o.Checkbox,{checked:e,className:"checkbox_style",onChange:function(e){return r._handleOnCheckBoxChange(e,t.key)}}))},r}i()(e,a);var t=e.prototype;return t.componentDidMount=function(){var e=this.props.children,e=e instanceof Array?e[0]:e,e=document.getElementById(e.key);e&&(this.childHeight=e.clientHeight)},t.render=function(){var r=this,e=this.props,t=e.className,n=void 0===t?"":t,a=e.editable,o=void 0!==a&&a,t=e.orientation,a=void 0===t?"horiziontal":t,t=e.children,e=e.showList,s=void 0===e?[]:e,l=t instanceof Array?t:[t];return this.notShowList=[],u().createElement("div",{className:"yt_drag_layout_wrapper yt_drag_layout_"+a+" "+n},l.reduce(function(e,t,n){var a=s.indexOf(t.key);if(-1<a?e[a]=r._renderEditableFrame(t,!0):r.notShowList.push(t.key),n!==l.length-1)return e;var i=e.filter(function(e){return e});return o&&0<r.notShowList.length&&r.notShowList.forEach(function(e){i.push(r._renderEditableFrame(u().createElement(c,{key:e,height:r.childHeight}),!1))}),i},[]))},e}(u().PureComponent);const a=n;n.propTypes={orientation:t().oneOf(["horizontal","vertical"]),colNumber:t().number,className:t().oneOfType([t().string,t().object]),editable:t().bool,showList:t().arrayOf(t().string),onChange:t().func}},60222:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});function r(e){var t=e.value,n=e.getValue,a=(t=m().useState(t))[0],i=t[1];return m().createElement("div",{className:"yt_modal_dashboard_edit_wrapper"},m().createElement("div",{className:"content_item"},m().createElement("span",null,"同比类型"),m().createElement("span",null,m().createElement(o(),{className:"content_item_select",value:(l.find(function(e){return e.value===a})||{}).label,onChange:function(e){var t;i(t=e),setTimeout(function(){return n&&n(t)},0)},inputIcon:m().createElement("i",{className:"icon-cem_arrow-launches",style:{color:"#8C8C8C"}})},l.map(function(e){return m().createElement(o().Option,{value:e.value,key:e.value},e.label)})))))}var a=n(67154),p=n.n(a),t=n(37316),h=n.n(t),a=n(67294),m=n.n(a),t=n(45697),a=n.n(t),f=n(25713),g=n(43036),t=n(2258),o=n.n(t),s=n(57522),l=[{value:"WEEK",label:"周"},{value:"MONTH",label:"月"},{value:"QUATER",label:"季"},{value:"YEAR",label:"年"}],t=function(i){return new Promise(function(e,t){var n=i.value,a=p()({},i,{titleText:m().createElement("div",{className:"indicator_card_comfirm"},m().createElement("span",null,"同比设置"),m().createElement("span",{onClick:function(){return window.open("https://www.yuque.com/docs/share/5615d490-0056-4bb9-b208-bf747c9048c0")}},"查看更多")),content:m().createElement(r,p()({},i,{getValue:function(e){n=e}}))});a.onOk=function(){return e(n)},a.onCancel=t,(0,s.Z)(a)})};const v=t;t.propTypes={getValue:a().func,value:a().string};function y(e){return!["",null,void 0].includes(e)}function C(e){return e&&(5<e.length?String(e).substring(0,5)+"...":e)}function _(e,t,n){var i,r;"image"===e?(i=t,r=(0,c.UO)(n[0]&&n[0].name),new Promise(function(e){var t=i.offsetWidth,n=i.cloneNode(!0),a=document.createElement("canvas");a.width=12*t,a.height=1920,a.style.width=t+"px",a.style.height="160px",a.className="yt_trend_list_canvas",a.getContext("2d").scale(12,12),n.style.width=t+"px",n.style.height="160px",n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.zIndex=-1,n.style.opacity=0,document.body.appendChild(n),u()(n,{allowTaint:!0,taintTest:!1,canvas:a,useCORS:!0,width:t,height:160,onrendered:function(e){document.body.appendChild(e);e=e.toDataURL("png");(0,d.saveAs)(e,r,"image/png"),setTimeout(function(){document.body.removeChild(n),document.body.removeChild(document.querySelector(".yt_trend_list_canvas"))},0)}})})):"data"===e&&(e=[n.reduce(function(e,t){return[].concat(e,[[t.name,t.count]])},[])],(0,c.aT)(e,n[0]&&n[0].name))}var E=n(8201),b=n(39432),c=n(94644),t=n(29531),u=n.n(t),d=n(93162),O=[{title:"导出图片",type:"image"},{title:"导出数据",type:"data"}],N=[{title:"设置同比",type:"compare"}];n=function(e){function a(e){return n&&n[e]?n[e]:{}}function t(e){if(a(e).name){if(y(a(e).count)){var t=a(e).count;switch(a(e).format){case"myriad":t=(0,b.hE)(t);break;case"percent":n=t,t=y(null)?null:0===n?"0.00%":Math.abs(100*n).toFixed(2)+"%"}return t}return"--"}var n;return""}var n=e.data,i=e.tip,r=e.compare,o=e.onSetting,s=e.loading,l=e.paragraph,c=h()(e,["data","tip","compare","onSetting","loading","paragraph"]),e=m().useState(),u=e[0],d=e[1],e=function(e){return"myriad"!==a(e).format?t(e):a(e).count.toLocaleString()};return m().createElement("div",p()({className:"indicator_card"},c,{ref:function(e){return d(e)}}),m().createElement(E.Z,{data:n,className:"section_com",loading:s,paragraph:l},m().createElement("div",{className:"title_wrap"},m().createElement("span",{className:"chart_title"},m().createElement("span",{className:"chart_title_name"},a(0).name,i&&m().createElement(g.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:i},m().createElement("i",{className:"icon-cem_file1","data-html2canvas-ignore":!0})))),m().createElement("span",{className:"chart_title_buttons","data-html2canvas-ignore":!0},m().createElement(f.Z,{onClick:function(e){"compare"===e?v({value:r}).then(function(e){o({compareValue:e})}):_(e,u,n)},options:O.concat(o?N:[])}))),m().createElement("div",{className:"section_mid"},m().createElement("p",null,m().createElement(g.Z,{placement:"top",overlay:e(0)},m().createElement("section",null,t(0)))),a(1).name||a(2).name?m().createElement("p",null,m().createElement("span",null,m().createElement("span",null,m().createElement(g.Z,{placement:"top",overlay:a(1).name},m().createElement("section",{className:"name"},a(1).name))),m().createElement("span",null,m().createElement(g.Z,{placement:"top",overlay:e(1)},m().createElement("section",null,t(1))),"boolean"==typeof a(1).rise&&m().createElement("i",{className:a(1).rise?"icon-cem_three-states-up":"icon-cem_three-states-down"}))),m().createElement("span",null,m().createElement("span",null,m().createElement(g.Z,{placement:"top",overlay:a(2).name},m().createElement("section",{className:"name"},a(2).name))),m().createElement("span",null,m().createElement(g.Z,{placement:"top",overlay:e(2)},m().createElement("section",null,t(2))),"boolean"==typeof a(2).rise&&m().createElement("i",{className:a(2).rise?"icon-cem_three-states-up":"icon-cem_three-states-down"})))):null),(a(3).name||a(4).name)&&m().createElement("div",{className:"section_bottom"},m().createElement("span",null,m().createElement("span",null,m().createElement(g.Z,{placement:"top",overlay:a(3).name},m().createElement("section",{className:"name"},C(a(3).name)))),m().createElement("span",null,m().createElement(g.Z,{placement:"top",overlay:e(3)},m().createElement("section",null,t(3))))),a(4).name?m().createElement("span",null,m().createElement("span",null,m().createElement(g.Z,{placement:"top",overlay:a(4).name},m().createElement("section",{className:"name"},C(a(4).name)))),m().createElement("span",null,m().createElement(g.Z,{placement:"top",overlay:e(4)},m().createElement("section",null,t(4))))):null)))};const i=n;n.propTypes={data:a().arrayOf(a().shape({name:a().string,count:a().oneOfType([a().string,a().number]),rise:a().bool,format:a().oneOfType(["myriad","percent",void 0])})),tip:a().oneOfType([a().string,a().node]),compare:a().string,onSetting:a().func,loading:a().bool,paragraph:a().arrayOf(a().string)}}}]);