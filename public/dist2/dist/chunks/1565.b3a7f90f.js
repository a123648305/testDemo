(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[1565],{33795:(e,t,n)=>{var a={"./af":43429,"./af.js":43429,"./ar":35883,"./ar-dz":25534,"./ar-dz.js":25534,"./ar-kw":81055,"./ar-kw.js":81055,"./ar-ly":11253,"./ar-ly.js":11253,"./ar-ma":94073,"./ar-ma.js":94073,"./ar-sa":53797,"./ar-sa.js":53797,"./ar-tn":86338,"./ar-tn.js":86338,"./ar.js":35883,"./az":55908,"./az.js":55908,"./be":80887,"./be.js":80887,"./bg":57116,"./bg.js":57116,"./bm":18346,"./bm.js":18346,"./bn":98593,"./bn-bd":12267,"./bn-bd.js":12267,"./bn.js":98593,"./bo":88070,"./bo.js":88070,"./br":87699,"./br.js":87699,"./bs":17946,"./bs.js":17946,"./ca":47555,"./ca.js":47555,"./cs":95167,"./cs.js":95167,"./cv":93267,"./cv.js":93267,"./cy":83801,"./cy.js":83801,"./da":8322,"./da.js":8322,"./de":12846,"./de-at":71186,"./de-at.js":71186,"./de-ch":15119,"./de-ch.js":15119,"./de.js":12846,"./dv":25027,"./dv.js":25027,"./el":70999,"./el.js":70999,"./en-au":53070,"./en-au.js":53070,"./en-ca":38791,"./en-ca.js":38791,"./en-gb":44852,"./en-gb.js":44852,"./en-ie":12379,"./en-ie.js":12379,"./en-il":41282,"./en-il.js":41282,"./en-in":44932,"./en-in.js":44932,"./en-nz":66842,"./en-nz.js":66842,"./en-sg":74548,"./en-sg.js":74548,"./eo":6454,"./eo.js":6454,"./es":10821,"./es-do":60525,"./es-do.js":60525,"./es-mx":68276,"./es-mx.js":68276,"./es-us":37155,"./es-us.js":37155,"./es.js":10821,"./et":79073,"./et.js":79073,"./eu":45334,"./eu.js":45334,"./fa":78557,"./fa.js":78557,"./fi":18257,"./fi.js":18257,"./fil":5345,"./fil.js":5345,"./fo":37758,"./fo.js":37758,"./fr":46980,"./fr-ca":88970,"./fr-ca.js":88970,"./fr-ch":81703,"./fr-ch.js":81703,"./fr.js":46980,"./fy":31005,"./fy.js":31005,"./ga":19977,"./ga.js":19977,"./gd":5135,"./gd.js":5135,"./gl":96095,"./gl.js":96095,"./gom-deva":68584,"./gom-deva.js":68584,"./gom-latn":78454,"./gom-latn.js":78454,"./gu":15567,"./gu.js":15567,"./he":92519,"./he.js":92519,"./hi":51767,"./hi.js":51767,"./hr":47644,"./hr.js":47644,"./hu":35169,"./hu.js":35169,"./hy-am":35676,"./hy-am.js":35676,"./id":28564,"./id.js":28564,"./is":30593,"./is.js":30593,"./it":27292,"./it-ch":9502,"./it-ch.js":9502,"./it.js":27292,"./ja":86890,"./ja.js":86890,"./jv":11293,"./jv.js":11293,"./ka":39616,"./ka.js":39616,"./kk":72086,"./kk.js":72086,"./km":28191,"./km.js":28191,"./kn":77751,"./kn.js":77751,"./ko":7919,"./ko.js":7919,"./ku":57107,"./ku.js":57107,"./ky":69400,"./ky.js":69400,"./lb":92178,"./lb.js":92178,"./lo":84342,"./lo.js":84342,"./lt":92697,"./lt.js":92697,"./lv":85340,"./lv.js":85340,"./me":4971,"./me.js":4971,"./mi":6745,"./mi.js":6745,"./mk":2620,"./mk.js":2620,"./ml":7452,"./ml.js":7452,"./mn":26635,"./mn.js":26635,"./mr":72473,"./mr.js":72473,"./ms":27473,"./ms-my":71299,"./ms-my.js":71299,"./ms.js":27473,"./mt":57379,"./mt.js":57379,"./my":29755,"./my.js":29755,"./nb":94051,"./nb.js":94051,"./ne":79868,"./ne.js":79868,"./nl":17700,"./nl-be":86423,"./nl-be.js":86423,"./nl.js":17700,"./nn":50140,"./nn.js":50140,"./oc-lnc":56242,"./oc-lnc.js":56242,"./pa-in":49993,"./pa-in.js":49993,"./pl":33277,"./pl.js":33277,"./pt":91179,"./pt-br":83021,"./pt-br.js":83021,"./pt.js":91179,"./ro":12775,"./ro.js":12775,"./ru":98652,"./ru.js":98652,"./sd":797,"./sd.js":797,"./se":54106,"./se.js":54106,"./si":12942,"./si.js":12942,"./sk":83673,"./sk.js":83673,"./sl":5828,"./sl.js":5828,"./sq":2782,"./sq.js":2782,"./sr":1249,"./sr-cyrl":758,"./sr-cyrl.js":758,"./sr.js":1249,"./ss":92529,"./ss.js":92529,"./sv":80623,"./sv.js":80623,"./sw":19024,"./sw.js":19024,"./ta":31034,"./ta.js":31034,"./te":94619,"./te.js":94619,"./tet":75031,"./tet.js":75031,"./tg":73869,"./tg.js":73869,"./th":15849,"./th.js":15849,"./tk":35316,"./tk.js":35316,"./tl-ph":59149,"./tl-ph.js":59149,"./tlh":26842,"./tlh.js":26842,"./tr":84012,"./tr.js":84012,"./tzl":40925,"./tzl.js":40925,"./tzm":47920,"./tzm-latn":78732,"./tzm-latn.js":78732,"./tzm.js":47920,"./ug-cn":23252,"./ug-cn.js":23252,"./uk":79687,"./uk.js":79687,"./ur":54951,"./ur.js":54951,"./uz":74893,"./uz-latn":4174,"./uz-latn.js":4174,"./uz.js":74893,"./vi":92770,"./vi.js":92770,"./x-pseudo":77542,"./x-pseudo.js":77542,"./yo":74894,"./yo.js":74894,"./zh-cn":87579,"./zh-cn.js":87579,"./zh-hk":1244,"./zh-hk.js":1244,"./zh-mo":48640,"./zh-mo.js":48640,"./zh-tw":25537,"./zh-tw.js":25537};function r(e){e=s(e);return n(e)}function s(e){if(n.o(a,e))return a[e];e=new Error("Cannot find module '"+e+"'");throw e.code="MODULE_NOT_FOUND",e}r.keys=function(){return Object.keys(a)},r.resolve=s,(e.exports=r).id=33795},81483:(e,t,n)=>{var a={"./af":49273,"./af.js":49273,"./ar":5158,"./ar-dz":93262,"./ar-dz.js":93262,"./ar-kw":81562,"./ar-kw.js":81562,"./ar-ly":71154,"./ar-ly.js":71154,"./ar-ma":46608,"./ar-ma.js":46608,"./ar-sa":49278,"./ar-sa.js":49278,"./ar-tn":97920,"./ar-tn.js":97920,"./ar.js":5158,"./az":83439,"./az.js":83439,"./be":63393,"./be.js":63393,"./bg":29557,"./bg.js":29557,"./bm":43555,"./bm.js":43555,"./bn":11415,"./bn-bd":214,"./bn-bd.js":214,"./bn.js":11415,"./bo":6485,"./bo.js":6485,"./br":97073,"./br.js":97073,"./bs":70402,"./bs.js":70402,"./ca":60839,"./ca.js":60839,"./cs":54736,"./cs.js":54736,"./cv":99820,"./cv.js":99820,"./cy":5286,"./cy.js":5286,"./da":23164,"./da.js":23164,"./de":84318,"./de-at":19535,"./de-at.js":19535,"./de-ch":49961,"./de-ch.js":49961,"./de.js":84318,"./dv":87055,"./dv.js":87055,"./el":79855,"./el.js":79855,"./en-au":51090,"./en-au.js":51090,"./en-ca":21916,"./en-ca.js":21916,"./en-gb":97919,"./en-gb.js":97919,"./en-ie":54469,"./en-ie.js":54469,"./en-il":60491,"./en-il.js":60491,"./en-in":97532,"./en-in.js":97532,"./en-nz":34392,"./en-nz.js":34392,"./en-sg":12668,"./en-sg.js":12668,"./eo":4077,"./eo.js":4077,"./es":34126,"./es-do":71098,"./es-do.js":71098,"./es-mx":39636,"./es-mx.js":39636,"./es-us":95269,"./es-us.js":95269,"./es.js":34126,"./et":25710,"./et.js":25710,"./eu":56102,"./eu.js":56102,"./fa":68495,"./fa.js":68495,"./fi":17895,"./fi.js":17895,"./fil":56494,"./fil.js":56494,"./fo":89803,"./fo.js":89803,"./fr":889,"./fr-ca":80124,"./fr-ca.js":80124,"./fr-ch":74504,"./fr-ch.js":74504,"./fr.js":889,"./fy":35202,"./fy.js":35202,"./ga":20979,"./ga.js":20979,"./gd":89117,"./gd.js":89117,"./gl":43675,"./gl.js":43675,"./gom-deva":53080,"./gom-deva.js":53080,"./gom-latn":44723,"./gom-latn.js":44723,"./gu":7247,"./gu.js":7247,"./he":55098,"./he.js":55098,"./hi":34374,"./hi.js":34374,"./hr":37358,"./hr.js":37358,"./hu":3535,"./hu.js":3535,"./hy-am":99615,"./hy-am.js":99615,"./id":43480,"./id.js":43480,"./is":36894,"./is.js":36894,"./it":53881,"./it-ch":40192,"./it-ch.js":40192,"./it.js":53881,"./ja":81370,"./ja.js":81370,"./jv":27631,"./jv.js":27631,"./ka":30816,"./ka.js":30816,"./kk":39638,"./kk.js":39638,"./km":90097,"./km.js":90097,"./kn":83865,"./kn.js":83865,"./ko":62729,"./ko.js":62729,"./ku":20610,"./ku.js":20610,"./ky":56691,"./ky.js":56691,"./lb":19484,"./lb.js":19484,"./lo":39602,"./lo.js":39602,"./lt":84874,"./lt.js":84874,"./lv":48902,"./lv.js":48902,"./me":51738,"./me.js":51738,"./mi":20717,"./mi.js":20717,"./mk":64320,"./mk.js":64320,"./ml":62802,"./ml.js":62802,"./mn":99374,"./mn.js":99374,"./mr":5485,"./mr.js":5485,"./ms":52961,"./ms-my":89867,"./ms-my.js":89867,"./ms.js":52961,"./mt":46368,"./mt.js":46368,"./my":95469,"./my.js":95469,"./nb":75286,"./nb.js":75286,"./ne":70965,"./ne.js":70965,"./nl":8350,"./nl-be":39493,"./nl-be.js":39493,"./nl.js":8350,"./nn":13643,"./nn.js":13643,"./oc-lnc":86112,"./oc-lnc.js":86112,"./pa-in":41166,"./pa-in.js":41166,"./pl":31231,"./pl.js":31231,"./pt":15178,"./pt-br":37134,"./pt-br.js":37134,"./pt.js":15178,"./ro":10214,"./ro.js":10214,"./ru":68566,"./ru.js":68566,"./sd":16740,"./sd.js":16740,"./se":43127,"./se.js":43127,"./si":23710,"./si.js":23710,"./sk":10717,"./sk.js":10717,"./sl":66035,"./sl.js":66035,"./sq":17842,"./sq.js":17842,"./sr":26687,"./sr-cyrl":96931,"./sr-cyrl.js":96931,"./sr.js":26687,"./ss":61254,"./ss.js":61254,"./sv":46994,"./sv.js":46994,"./sw":79762,"./sw.js":79762,"./ta":35771,"./ta.js":35771,"./te":94612,"./te.js":94612,"./tet":73322,"./tet.js":73322,"./tg":80057,"./tg.js":80057,"./th":88395,"./th.js":88395,"./tk":83975,"./tk.js":83975,"./tl-ph":63188,"./tl-ph.js":63188,"./tlh":3656,"./tlh.js":3656,"./tr":82541,"./tr.js":82541,"./tzl":30571,"./tzl.js":30571,"./tzm":29441,"./tzm-latn":22536,"./tzm-latn.js":22536,"./tzm.js":29441,"./ug-cn":51049,"./ug-cn.js":51049,"./uk":44518,"./uk.js":44518,"./ur":12354,"./ur.js":12354,"./uz":94029,"./uz-latn":48181,"./uz-latn.js":48181,"./uz.js":94029,"./vi":58834,"./vi.js":58834,"./x-pseudo":99151,"./x-pseudo.js":99151,"./yo":74290,"./yo.js":74290,"./zh-cn":87444,"./zh-cn.js":87444,"./zh-hk":62399,"./zh-hk.js":62399,"./zh-mo":68058,"./zh-mo.js":68058,"./zh-tw":17284,"./zh-tw.js":17284};function r(e){e=s(e);return n(e)}function s(e){if(n.o(a,e))return a[e];e=new Error("Cannot find module '"+e+"'");throw e.code="MODULE_NOT_FOUND",e}r.keys=function(){return Object.keys(a)},r.resolve=s,(e.exports=r).id=81483},34757:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>J});var a=n(37316),r=n.n(a),s=n(67154),c=n.n(s),i=n(85354),o=n.n(i),l=n(67294),S=n.n(l),t=n(55609),D=(n(53294),n(56697)),E=(n(9405),n(89552)),T=(n(29809),n(97538)),_=(n(1025),n(65400)),b=(n(62642),n(94704)),N=n(96518),w=n(5966),V=n(86615),F=n(31199),M=n(22664),Y=n(5133),a=n(30381),O=n.n(a),u=n(43036),m=n(92360),p=n(35239),d=(n(7940),n(31059)),s=(n(62713),n(14321)),q=n(72156),h=s.default.RangePicker;const f=function(t){function e(e){var a=t.call(this,e)||this;return a.formatStr=function(){return a.state.isShowTime?"YYYY/MM/DD HH:mm:ss":"YYYY/MM/DD"},a.formatStrVal=function(){return a.state.isShowTime?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD"},a.disabledDate=function(e){return e&&e>O()().endOf("day")},a.onDateChange=function(e,t){a.setState({date:t.every(function(e){return""!==e})?t:void 0})},a.handleCheckboxChange=function(e){var t=a.state.date,n=e.target.checked&&t&&t[0]&&!q.Sz.test(t[0])?t[0]+" 00:00:00":void 0,t=e.target.checked&&t&&t[1]&&!q.Sz.test(t[1])?t[1]+" 23:59:59":void 0;a.setState({isShowTime:e.target.checked}),n&&t&&a.setState({date:[n,t]})},a.state={isShowTime:e.isShowTime||!1,date:e.defaultDate||void 0},a}o()(e,t);var n=e.prototype;return n.componentDidUpdate=function(e){var t=e.defaultDate,e=this.props.defaultDate;JSON.stringify(t)!==JSON.stringify(e)&&e&&this.setState({date:e,isShowTime:q.Sz.test(e[0])&&q.Sz.test(e[1])})},n.getCurrDate=function(){var e=this.state.date;if(e&&e.length){var t=[O()(e[0]).format(this.formatStrVal()),O()(e[1]).format(this.formatStrVal())],n=(0,q.p6)(2,t,this.formatStrVal()),e=(0,q.vv)(t,this.formatStrVal());return{from:this.state.isShowTime?t[0]:t[0]+" 00:00:00",to:this.state.isShowTime?t[1]:t[1]+" 23:59:59",quickChoice:n,dateGroupType:"DAY",numOfDays:e,remoteName:"cTime",currSelector:1}}},n.render=function(){var t=this,e=this.state,n=e.date,a=e.isShowTime,e=this.props.className;return S().createElement("div",{className:"time_range_picker_wrapper "+e,style:{width:a?450:562}},S().createElement(h,{getPopupContainer:function(e){return e.parentNode},className:"filter_time_picker",disabledDate:this.disabledDate,format:this.formatStr(),showTime:a,onChange:this.onDateChange,value:n&&n[0]&&n[1]&&n&&n.length?[O()(n[0],this.formatStr()),O()(n[1],this.formatStr())]:null,dropdownClassName:"filter_time_picker_content_wrap",open:!0}),S().createElement("div",{className:"detail-time-select"},S().createElement(d.default,{checked:a,onChange:function(e){return t.handleCheckboxChange(e)}},"选择时间")))},e}(S().PureComponent);var j=n(97189),i=n(45697),a=n.n(i),s=n(64396),g=s.Z.opinion.timeScreening,i=function(t){function e(e){var i=t.call(this,e)||this;return i._resetStyle=function(){setTimeout(function(){i.dateContentRef&&(i.dateContentRef.style.display="date"!==i.state.show?"none":"block",i.dateContentRef.style.right="-1px",i.dateContentRef.style.top="30px")},0)},i.handleClickQuickTime=function(e){i.setState({quickTime:q.A$[e]});var t=i.props,n=t.staredQuickTimeChoice,a=t.type,r=t.changeFilter,t=i.state.formatStr,t=(0,q.B9)(e,t);i.props.save({selectedQuickTimeChoice:e,selectedDateRange:t});n={module:a,currSelector:0,selectedQuickTimeChoice:e,staredQuickTimeChoice:n,value:[]};i.props.setDefaultValue({key:"default-time-"+a,projectId:p.t.get(p.V.curProject).id,value:JSON.stringify(n)}),0<t.length?i.setState({params:null,show:null},function(){setTimeout(function(){i.props.onChange(i.getCurrDate())},0);var e=p.t.getWidthProject(p.V.messageDateFilter);p.t.setWidthProject(p.V.messageDateFilter,c()({},e,((e={})[i.props.type]=i.getCurrDate(),e))),r("date"),i._resetStyle(),i.props.save({dateFilter:i.getCurrDate()})}):Y.Z.error("请选择时间范围")},i.getCurrDate=function(){var e=i.state,t=e.params,n=e.formatStr,a=i.props,e=a.selectedDateRange,a=a.selectedQuickTimeChoice,n=(0,q.vv)(e,n);return{from:e[0],to:e[1],quickChoice:t&&-1<t.quickChoice.indexOf("-")?t.quickChoice:q.A$[a],dateGroupType:"DAY",numOfDays:n,remoteName:"cTime",currSelector:0}},i.clickRangeConfirmBtn=function(){var e=i.props,t=e.staredQuickTimeChoice,e=e.dateFilter,t=-1<t?e:p.t.getWidthProject(p.V.messageDateFilter)&&p.t.getWidthProject(p.V.messageDateFilter)[i.props.type]?p.t.getWidthProject(p.V.messageDateFilter)[i.props.type]:void 0;t&&(-1===t.quickChoice.indexOf("-")?i.setState({quickTime:t.quickChoice}):i.setState({quickTime:""})),i.rangeDatePicker.getCurrDate()?(e=[i.rangeDatePicker.getCurrDate().from,i.rangeDatePicker.getCurrDate().to],i.props.save({selectedDateRange:e,selectedQuickTimeChoice:i.rangeDatePicker.getCurrDate().quickChoice}),0<e.length&&i.setState({params:null,show:null,quickTime:!t||i.rangeDatePicker.state.isShowTime||!i.rangeDatePicker.state.isShowTime&&i.rangeDatePicker.getCurrDate().from.split(" ")[0]!==t.from||!i.rangeDatePicker.state.isShowTime&&i.rangeDatePicker.getCurrDate().to.split(" ")[0]!==t.to?"":t.quickChoice},function(){i.props.save({dateFilter:i.rangeDatePicker.getCurrDate()}),setTimeout(function(){i.props.onChange(i.rangeDatePicker.getCurrDate())},0);var e=p.t.getWidthProject(p.V.messageDateFilter);p.t.setWidthProject(p.V.messageDateFilter,c()({},e,((e={})[i.props.type]=i.rangeDatePicker.getCurrDate(),e))),i.props.changeFilter("date"),i._resetStyle()})):Y.Z.error("请选择时间范围")},i.clickStarIcon=function(e,t){e.stopPropagation();var n=i.props.staredQuickTimeChoice,a=i.props,r=a.selectedQuickTimeChoice,s=a.type;n!==t?(-1!==n&&(a=document.querySelectorAll(".left_time ul li")[n].children[1],(0,j.removeClass)(a,"star"),a.style.display="none"),n=t,(0,j.addClass)(e.target.parentNode,"star")):(n=-1,(0,j.removeClass)(e.target.parentNode,"star")),i.setState({staredQuickTimeChoice:n}),i.props.save({staredQuickTimeChoice:n});n={module:s,currSelector:0,selectedQuickTimeChoice:r,staredQuickTimeChoice:n,value:[]};i.props.setDefaultValue({key:"default-time-"+s,projectId:p.t.get(p.V.curProject).id,value:JSON.stringify(n)})},i.state={show:e.show,currSelector:0,params:e.params,formatStr:e.useHourSelect?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD",quickTime:e.quickTime},i}o()(e,t);var n=e.prototype;return n.componentDidMount=function(){this.dateContentRef&&(this.dateContentRef.style.display="block",this.dateContentRef.style.right="9999px",this.dateContentRef.style.top="-9999px")},n.componentDidUpdate=function(e,t){var n=e.quickTime,a=e.show,r=this.props,e=r.quickTime,r=r.show;JSON.stringify(n)!==JSON.stringify(e)&&this.setState({quickTime:e}),JSON.stringify(a)!==JSON.stringify(r)&&this._resetStyle()},n.componentWillUnmount=function(){},e.getDerivedStateFromProps=function(e,t){return e.show!==t.show?{show:e.show}:JSON.stringify(e.params)!==JSON.stringify(t.params)?{params:e.params}:null},n.fetchDefaultValue=function(){var e=this.props.type,t=this.state,n=t.params,t=t.formatStr;this.props.getDefaultValue({key:"default-time-"+e,params:n,formatStr:t,defaultValue:p.t.getWidthProject(p.V.messageDateFilter)&&p.t.getWidthProject(p.V.messageDateFilter)[e]||void 0,projectId:p.t.get(p.V.curProject).id})},n.render=function(){var n=this,e=this.state,t=e.show,a=e.quickTime,r=this.props,s=r.selectedQuickTimeChoice,i=r.staredQuickTimeChoice,e=r.save,o=r.changeFilter,r=r.dateFilter;return S().createElement("div",{className:"filter_date_picker_wrapper "+("date"!==t?"":"active"),onClick:function(e){e.stopPropagation()}},S().createElement("div",{className:"filter_date_trigger",onClick:function(){o("date"),n._resetStyle()}},S().createElement("span",{className:"filter_date_time"},S().createElement("i",{className:"icon-cem_time-controller"}),S().createElement("span",{style:{marginLeft:8,verticalAlign:"top"}},a||(r?-1<r.quickChoice.indexOf("-")?O()(r.quickChoice.split("-")[0]).format(q.Sz.test(r.quickChoice.split("-")[0].replace(/\./,"-").trim())?"YYYY/MM/DD HH:mm:ss":"YYYY/MM/DD")+"~"+O()(r.quickChoice.split("-")[1]).format(q.Sz.test(r.quickChoice.split("-")[1].replace(/\./,"-").trim())?"YYYY/MM/DD HH:mm:ss":"YYYY/MM/DD"):r.quickChoice:"")))),S().createElement("div",{style:{marginTop:8,color:"#8C8C8C",fontSize:12}},r?r.currSelector?S().createElement("div",null,O()(r.from).format("YYYY/MM/DD  HH:mm:ss")," ~"," ",O()(r.to).format("YYYY/MM/DD  HH:mm:ss")):S().createElement("div",null,O()(r.from).format("YYYY/MM/DD HH:mm:ss")," ~"," ",O()(r.to).endOf("day").format("YYYY/MM/DD HH:mm:ss")):""),S().createElement("div",{className:"time_picker_wrap",ref:function(e){return n.dateContentRef=e}},S().createElement("div",{className:"time_picker_content"},S().createElement("div",{className:"right_picker"},r?S().createElement(f,{ref:function(e){return n.rangeDatePicker=e},defaultDate:-1<r.quickChoice.indexOf("-")?[r.quickChoice.split("-")[0].replace(/\./,"-").trim(),r.quickChoice.split("-")[1].replace(/\./,"-").trim()]:[r.from,r.to],currSelector:1,save:e,isShowTime:-1<r.quickChoice.indexOf("-")&&q.Sz.test(r.quickChoice.split("-")[0].replace(/\./,"-").trim())&&q.Sz.test(r.quickChoice.split("-")[1].replace(/\./,"-").trim())}):null),S().createElement("div",{className:"left_time"},S().createElement("ul",{className:"quick_date_wrap"},q.A$.map(function(e,t){return S().createElement(S().Fragment,null,S().createElement("li",{key:t,onClick:function(){return n.handleClickQuickTime(t)},className:q.ld.includes(e)?"left_li":"right_li"},S().createElement("span",{className:s===t?"active":""},e),S().createElement(u.Z,{className:"time_picker_star_tooltip",placement:"top",overlay:i===t?"取消默认":"设为默认",mouseEnterDelay:.6},S().createElement("span",{className:i===t?"star":"",onClick:function(e){return n.clickStarIcon(e,t)}},S().createElement("i",{className:"icon-cem icon-cem_star"})))))})))),S().createElement("div",{className:"time_picker_footer"},S().createElement("div",null),S().createElement("div",{style:{display:"flex"}},S().createElement(m.Button,{type:"default",onClick:function(){o("date"),n._resetStyle()}},"取消"),S().createElement(m.Button,{type:"primary",onClick:this.clickRangeConfirmBtn},"确定")))))},e}(S().PureComponent);const P=(0,t.connect)(function(e){e.loading;e=r()(e,["loading"]);return c()({},e[g])},function(t){return{save:function(e){return t({type:g+"/save",payload:e})},getDefaultValue:function(e){return t({type:g+"/getDefaultValue",payload:e})},setDefaultValue:function(e){return t({type:g+"/setDefaultValue",payload:e})},clean:function(e){return t({type:g+"/clean",payload:e})},cleanQuickTime:function(e){return t({type:g+"/cleanQuickTime",payload:e})}}},null,{withRef:!0})(i);i.propTypes={show:a().bool,changeFilter:a().func,onChange:a().func,params:a().object};var y=n(60496),k=[{title:"模糊搜索",value:"FUZZY_SEARCH"},{title:"精确搜索",value:"PRECISE_SEARCH"}],i=function(t){function e(e){var r=t.call(this,e)||this;return r.inputChange=function(e){r.setState({inputVal:e.target.value})},r.keywordChange=function(e){var t=r.state,n=t.inputVal,a=t.inputValMap,t=t.searchVal;"keydown"===e.type&&32===e.keyCode&&n.trim()&&(a.length<5?a.find(function(e){return e.trim()===n.trim()})||(a.push(n.trim()),r.setState(c()({},t,{inputValMap:a,inputVal:""}),function(e){return r.onChange(!1)})):Y.Z.warning("最多搜索5个关键词，超过的关键词不搜索")),"keydown"===e.type&&13===e.keyCode&&n.trim()&&(a.length<5?a.find(function(e){return e.trim()===n.trim()})||(a.push(n.trim()),r.setState(c()({},t,{inputValMap:a,inputVal:""}),function(e){return r.onChange(!0)})):Y.Z.warning("最多搜索5个关键词，超过的关键词不搜索"))},r.delKeyWords=function(e){var t=r.state,n=t.inputValMap,t=t.searchVal;n.splice(e,1),r.setState({inputValMap:n,searchVal:t},function(e){return r.onChange(!0)})},r.onChange=function(e){r.props.onChange&&r.props.onChange(r.state.inputValMap,r.state.searchVal,e)},r.onSearchChange=function(e){r.setState({searchVal:e},function(){r.state.inputValMap&&r.state.inputValMap.length&&r.onChange(!0)})},r.handleOnClose=function(){var e=r.state.searchVal;r.setState({inputValMap:[],searchVal:e},function(e){return r.onChange(!0)})},r.state={inputValMap:e.values||[],inputVal:"",searchVal:e.queryType||"FUZZY_SEARCH",contentWidth:0},r}o()(e,t);var n=e.prototype;return n.UNSAFE_componentWillReceiveProps=function(e,t){var n;e.queryType&&this.setState({searchVal:e.queryType}),e.values&&0<e.values.length&&(n=e.values,e.isExplore&&1<n.length&&n.pop(),this.setState({inputValMap:n}))},n.render=function(){var n=this,e=this.state,t=e.inputValMap,a=e.inputVal,r=e.searchVal,s=e.contentWidth,i=this.props,e=(i.style,i.close);i.onChange;return S().createElement("div",{className:"multi_word_input_wrap",style:{width:""+s}},e&&S().createElement("i",{className:"close",onClick:e},"×"),S().createElement(y.Z,{options:k,activeObj:r,onChange:this.onSearchChange,divider:"none",sufIcon:"icon-cem_pull-down-or-take-up",className:"keyword_select"}),S().createElement("div",{className:"input-wrap"},S().createElement("input",{type:"text",className:"keyword-setting",value:a,placeholder:"多个关键词请用空格分隔，按回车搜索",onChange:this.inputChange,onBlur:this.keywordChange,onKeyDown:this.keywordChange}),0<t.length&&S().createElement("i",{className:"icon-cem_log-off",onClick:this.handleOnClose})),S().createElement("div",{style:{display:"flex",alignItems:"center"}},t.map(function(e,t){return S().createElement("span",{className:"word "+(0!==t?"FUZZY_SEARCH"===r?"word_blur":"word_exact":""),key:e+t},S().createElement("span",{title:e},e),S().createElement("i",{onClick:function(){return n.delKeyWords(t)}},"×"))})))},e}(l.Component);const v=i;i.propTypes={values:a().array,queryType:a().string,onChange:a().func};function C(e){return e&&e.contain?{values:e.contain?JSON.parse(JSON.stringify(e.contain)):void 0,queryType:e.queryType}:{}}var z=n(48577);const R=function(e){var t=e.loading,n=e.queryTypeList,a=e.defaultFilter,r=e.content,s=e.handleFilterValueChange,i=e.handleQueryTypeChange;return S().createElement("div",{className:"opinion"},n&&0<n.length&&S().createElement("div",{className:"queryType-list"},n.map(function(e,t){return S().createElement("span",{key:"queryType_"+t,className:"nomal_type",onClick:function(){return i(e.type)}},S().createElement("i",{className:"icon-shujuyuan"}),e.name)}),S().createElement(v,{values:C(r).values||[],queryType:C(r).queryType||"FUZZY_SEARCH",onChange:function(e,t){return s("content",{contain:e,queryType:t})}})),a&&S().createElement("div",{style:{display:t?"none":"block"}},S().createElement(z.Z,{pageType:"OPINION_MSG_COMMENT",expandInfo:{type:"OPINION_MSG_COMMENT"},screenValue:a,advanceAuthority:!1,mainContentSearch:!0,showList:["screening"]})))};var A=b.Z.Step;const x=function(t){function e(e){var s=t.call(this,e)||this;return s.tip=function(e){return S().createElement("span",{className:"tip"},S().createElement(u.Z,{overlay:e,placement:"top",mouseEnterDelay:.5},S().createElement("i",{className:"icon-cem_file1",style:{marginLeft:4,fontSize:14,color:"#979797",verticalAlign:"unset"}})))},s.onRadioChange=function(e){s.setState({many:"REPEATEDLY"===e.target.value})},s._handleRadioEffect=function(e,t){var n=s.state,a=n.many,r=n.resultType,n=s.props.loadingAdd,r=[S().createElement(_.default,{key:"gotoPre",onClick:function(){s.setState({currentStep:0}),e.onPre()}},"上一步"),S().createElement(_.default,{type:"primary",key:"goToTree",loading:n&&"NOT_IMMEDIATELY"===r,onClick:function(){s.setState({resultType:"NOT_IMMEDIATELY"},function(){return e.onSubmit()})}},"生成离线结果"),S().createElement(_.default,{type:"primary",key:"gotoTwo",loading:n&&"IMMEDIATELY"===r,onClick:function(){s.setState({resultType:"IMMEDIATELY"},function(){return e.onSubmit()})}},"立即查询")];return(t||a)&&r.splice(2),r},s._handleModalShow=function(e){s.setState({isAddModalVisible:e})},s._handleOnHide=function(e){var t=s.props,n=t.showKind,t=t.changeShow;n&&"screening"!==n&&t(null)},s.state={many:!1,isStepClick:!1,isAddModalVisible:!1,resultType:void 0,currentStep:0},s.formRef=S().createRef(),s}o()(e,t);var n=e.prototype;return n.componentDidUpdate=function(e){var t,n,a,r;this.props.filterParams!==e.filterParams&&(t=(a=(r=this.props).filterParams).name,n=a.dateFilter,a.headerFilterParamsNew,e=a.calculationType,a=a.calculationFrequency,r=r.init,this.formRef.current.setFieldsValue({name:t,dateFilter:n,calculationType:e,calculationFrequency:a}),r({dateValue:n}),this.setState({many:"REPEATEDLY"===e}))},n.componentDidMount=function(){window.addEventListener("click",this._handleOnHide)},n.componentWillUnmount=function(){window.removeEventListener("click",this._handleOnHide)},n.render=function(){var n=this,e=this.props,t=e.filterParams,a=e.changeShow,r=e.showKind,s=e.queryTypeList,i=e.dateFilter,o=e.handleFilterValueChange,l=e.handleQueryTypeChange,c=e.handleFormSubmit,u=e.checkDateFormat,m=e.clearAllValues,p=e.loading,d=e.content,h=e.setDefault,f=e.screeningValues,j=e.initDefultFilter,g=e.curScreeningMap,y=e.saveFilter,k=this.state,v=k.many,e=k.isAddModalVisible,k=k.currentStep,C=i&&-1<i.quickChoice.indexOf("-");return S().createElement("div",{className:"screen_wrapper"},S().createElement("div",{className:"screen_box",style:{height:k?"100%":"unset",minHeight:k?"unset":"860px"}},S().createElement("div",{className:"screen_form"},S().createElement(E.default,{spinning:p,style:{height:"100%"}},S().createElement(M.ZP,{style:{height:"100%"}},S().createElement(N.Z,{style:{height:"100%"},onFinish:function(e){var t=n.state.resultType;t&&c(e,t,n._handleModalShow)},stepsRender:function(e,t){t=t.props.children;return S().createElement(b.Z,{current:t.props.current,labelPlacement:"vertical"},e.map(function(e,t){return S().createElement(A,{key:e.key,title:0===t?"条件筛选":"选择计算方式",icon:0===t?S().createElement("span",{className:"ant-steps-icon-1"},"1"):""})}))},submitter:{render:function(t){return 0===t.step?[S().createElement("span",{key:"gotoClear",className:"clearBtn",style:{display:f&&0<f.length?"block":"none"},onClick:function(){return m()}},"清空选项"),S().createElement(_.default,{key:"gotoCancle",onClick:function(){return history.back()}},"取消"),S().createElement(_.default,{key:"gotoNext",type:"primary",onClick:function(){n.setState({isStepClick:!0,currentStep:1});var e=g&&0<g.length?f.filter(function(t){return g.find(function(e){return e.id===t.id})}):f;0<e.length&&e.map(function(n){return n.values=n.values.filter(function(t){return g.find(function(e){return e.id===n.id}).data.find(function(e){return e.id===t.id})}),n}),h({key:"OPINION_FILTER_OBJ",value:JSON.stringify({content:d,filter:e})}),y({screeningValues:e}),t.onSubmit()}},"下一步")]:n._handleRadioEffect(t)}}},S().createElement(N.Z.StepForm,{name:"base",onFinish:function(){var e=n.state.isStepClick;return e&&n.setState({isStepClick:!1}),e}},S().createElement(R,{loading:p,defaultFilter:j,content:d,queryTypeList:s,handleFilterValueChange:o,handleQueryTypeChange:l})),S().createElement(N.Z.StepForm,{formRef:this.formRef,name:"checkbox",layout:"horizontal",className:"steps-form",initialValues:{name:"任务"+this.props.getNameDate()},onValuesChange:function(e,t){t.dateFilter&&C&&(n.formRef.current.setFieldsValue({calculationType:"SINGLE"}),n.setState({many:!1}))}},S().createElement(w.Z,{name:"name",label:"任务名称",width:"md",placeholder:"请输入名称",fieldProps:{maxLength:40}}),S().createElement(T.Z.Item,{label:S().createElement("span",null,"时间范围",this.tip("时间范围的时间只能选择历史时间")),name:"dateFilter"},S().createElement(P,{changeFilter:function(e){return a(r===e?null:"date")},show:r})),S().createElement(V.Z.Group,{name:"calculationType",label:"计算方式",initialValue:"SINGLE",options:[{label:S().createElement("span",null,"单次",this.tip("单次仅生成一个结果")),value:"SINGLE"},{label:S().createElement("span",null,"多次",this.tip("根据重复频率，每隔一段时间生成满足筛选条件的新结果")),value:"REPEATEDLY",disabled:C}],onChange:function(e){return n.onRadioChange(e)}}),v&&!C&&S().createElement("div",{className:"repetition_rate"},S().createElement(F.Z,{extra:"天生成一次结果",label:"重复频率",name:"calculationFrequency",width:"sm",min:1,max:1e3,initialValue:7}),S().createElement("div",{style:{marginBottom:8},className:"tip"},S().createElement("div",{style:{marginBottom:8}},"首次结果会在",O()().add(1,"days").format("YYYY/MM/DD"),"生成，仅分析",O()(i.from).format("YYYY/MM/DD")," ~",O()(i.to).format("YYYY/MM/DD"),"的数据。"),S().createElement("div",null,"第二次结果会在",O()().add((this.formRef.current.getFieldsValue("name").calculationFrequency||7)+1,"days").format("YYYY/MM/DD"),"生成，仅分析",(0,q.Dl)(i.quickChoice,this.formRef.current.getFieldsValue("name").calculationFrequency||7).from," ","~",(0,q.Dl)(i.quickChoice,this.formRef.current.getFieldsValue("name").calculationFrequency||7).to,"的数据。")),S().createElement("div",{className:"tip"},"任务生成后，需删除任务才能停止。")))))))),S().createElement(D.Z,{visible:e,title:S().createElement("span",{className:"confirm_title"},S().createElement("i",{className:"icon-cem_ordinary"}),"结果生成时间"),closable:!1,width:424,onCancel:function(){return n._handleModalShow(!1)},onOk:function(){t&&Y.Z.success("操作成功，系统已生成新的计算任务"),history.back()},className:"opinion-modal"},S().createElement("p",{className:"confirm_body_content"},this.formRef.current&&this.formRef.current.getFieldsValue("name").name,"结果将在",u((new Date).getMonth()+1)+"/"+u((new Date).getDate()+1)," ","01:00后生成")))},e}(l.Component);var I=s.Z.opinion.opinionScreen,Z=s.Z.opinion.timeScreening,H=s.Z.IDBHeaderScreening.headerScreening,L=s.Z.IDBHeaderScreening.screening,Q={SERVICE:"客服会话",COMMENT:"电商评论"},l=function(t){function e(e){var l=t.call(this,e)||this;return l._handleFilterValueChange=function(e,t){(0,l.props.save)({content:l.state.advancedFilter[e]=t})},l._getNameDate=function(){var e=new Date,t=l._checkDateFormat(e.getMonth()+1),n=l._checkDateFormat(e.getDate()),a=l._checkDateFormat(e.getHours()),r=l._checkDateFormat(e.getMinutes());return""+e.getFullYear()+t+n+a+r},l._checkDateFormat=function(e){return""+(e<10?0:"")+e},l._handleQueryTypeChange=function(e){console.log(e)},l._handleFormSubmit=function(e,t,n){var a=l.state.filterParams,r=l.props,s=r.dateFilter,i=r.addOpinionTask,o=r.screeningValues,r=r.content,s=-1<s.quickChoice.indexOf("-")?s:c()({},s,{from:s.from+" 00:00:00",to:s.to+" 23:59:59"}),t=c()({},e,{content:Array.isArray(r)&&r[0].contain?r[0]:r.contain?r:null,headerFilterParamsNew:o,dateFilter:s,resultType:t,queryType:"COMMENT",filterType:"OPINION_TASK"});i(a?Object.assign(a,t):t).then(function(e){e?(window.open("/opinionDetail?"+encodeURIComponent(JSON.stringify({id:e.id}))),history.back()):n(!0)})},l.state={queryTypeList:[],advancedFilter:{},filterParams:void 0,initDefultFilter:void 0},l._event={getSaveRef:function(e){return l.saveRef=e},handleFilterValueChange:l._handleFilterValueChange,getNameDate:l._getNameDate,checkDateFormat:l._checkDateFormat,handleQueryTypeChange:l._handleQueryTypeChange,handleFormSubmit:l._handleFormSubmit,handleDefaultFilter:l._handleDefaultFilter},l}o()(e,t);var n=e.prototype;return n.componentDidMount=function(){var s=this;this.props.screenValue&&Array.isArray(this.props.screenValue)&&(r=this.props.screenValue),this.props.init({type:"opinion",screening:{value:r,noSavingFilterList:this.props.noSavingFilterList},dateValue:this.props.dateValue,contentValue:this.props.contentValue}).then(function(){s.props.onReady&&s.props.onReady(s.getValue())}),this.props.fetchOpinionTouchSpot().then(function(e){e&&s.setState({queryTypeList:e.slice(0,1).map(function(e){return{type:e.split("_")[2],name:Q[e.split("_")[2]],isCheck:-1<e.indexOf("COMMENT")}})})});var e=this.props.location,t=e.query,n=e.search,a=this.props,r=a.getDefault,e=a.findOpinionTask,i=a.save;t&&n?e(t).then(function(e){var t,n,a,r;e&&(e.id,t=e.name,r=e.filterParam,n=e.messageTotal,a=e.opinionTotal,e=e.status,delete(r=JSON.parse(r)).id,s.setState({filterParams:c()({name:t,messageTotal:n,opinionTotal:a,status:e},r),initDefultFilter:r.headerFilterParamsNew}),r.content&&r.content.contain&&i({content:r.content}))}):r({key:"OPINION_FILTER_OBJ"}).then(function(e){var t,n;e?(t=JSON.parse(e),(e=(n=Array.isArray(t)?t:Array.isArray(t.filter)?t.filter:[]).find(function(e){return"ASPECT_MODEL"===e.id})&&n.find(function(e){return"ASPECT_MODEL"===e.id}).values)&&e.find(function(e){return"ASPECT2"===e.id})&&(e.find(function(e){return"ASPECT2"===e.id}).values=e.find(function(e){return"ASPECT2"===e.id}).values.map(function(e){return/_/.exec(e)?e.split("_")[1]:e})),s.setState({initDefultFilter:n}),t.content&&i({content:t.content})):s.setState({initDefultFilter:[]})})},n.componentWillUnmount=function(){this.props.clear()},n.render=function(){return S().createElement(x,c()({},this.state,this._event,this.props,{saveRef:this.saveRef}))},e}(l.Component);const J=(0,t.connect)(function(e){var t=e.loading,e=r()(e,["loading"]);return c()({},e[I],{dateFilter:e[Z].dateFilter,screeningValues:e[L].screeningValues,curScreeningMap:e[L].curScreeningMap,loading:t.effects[I+"/getDefault"]||t.effects[H+"/init"]||t.effects[L+"/fetchDefaultConfig"]||!1,loadingAdd:t.effects[I+"/addOpinionTask"]||!1})},function(t){return{clear:function(){return t({type:I+"/clear"})},save:function(e){return t({type:I+"/save",payload:e})},saveFilter:function(e){return t({type:L+"/save",payload:e})},clearAllValues:function(e){return t({type:H+"/clearAllValues",payload:e})},changeShow:function(e){return t({type:I+"/changeShow",payload:e})},init:function(e){return t({type:I+"/init",payload:e})},fetchOpinionTouchSpot:function(e){return t({type:I+"/fetchOpinionTouchSpot",payload:e})},addOpinionTask:function(e){return t({type:I+"/addOpinionTask",payload:e})},findOpinionTask:function(e){return t({type:I+"/findOpinionTask",payload:e})},setDefault:function(e){return t({type:I+"/setDefault",payload:e})},getDefault:function(e){return t({type:I+"/getDefault",payload:e})}}})(l)}}]);