(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[6198],{26198:(e,t,n)=>{"use strict";n.d(t,{Z:()=>J});var a=n(37316),l=n.n(a),r=n(67154),v=n.n(r),t=n(85354),i=n.n(t),a=n(67294),g=n.n(a),r=n(45697),t=n.n(r),r=n(93913),o=n.n(r),C=n(92360);const s=function(e){function t(){return e.apply(this,arguments)||this}return i()(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.onConfirm,a=t.onCancel,t=t.style;return g().createElement("div",{className:"bottom_bar",style:t||{}},g().createElement("ul",{className:"handle"},0<this.props.screeningValues.length&&g().createElement("li",null,g().createElement("span",{className:"clear",onClick:function(){return e.props.clearAllValues()}},"清空选项"))),g().createElement(C.Button,{type:"primary",onClick:function(){n&&n()}},"查询"),g().createElement(C.Button,{onClick:function(){a&&a()}},"取消"))},t}(g().PureComponent);var c=n(83330);const S=function(n){function e(e){var t=n.call(this,e)||this;return t.onConfirm=function(){t.props.handelChangeShow(!1),t.props.onSearchButtonClick()},t.onCancel=function(){t.props.handelChangeShow(!1)},t.clearAllValues=function(){t.props.clearAllValues()},t.state={},t}return i()(e,n),e.prototype.render=function(){var e=this.props,t=(e.handelChangeShow,e.screeningValues),n=e.show,a=e.onFilterReady,e=e.type;return g().createElement("div",{className:"screening_wrap_view"},g().createElement(c.Z,v()({},this.props,{onReady:a,type:e,onChange:void 0})),n&&g().createElement(s,{onConfirm:this.onConfirm,onCancel:this.onCancel,clearAllValues:this.clearAllValues,screeningValues:t}))},e}(g().Component),k=function(e){function t(){return e.apply(this,arguments)||this}return i()(t,e),t.prototype.render=function(){var e=this.props,t=e._handelClick,n=e.select,a=e.name,l=e.style,e=e.icon;return g().createElement("div",{className:"HeaderButton",style:l||{}},g().createElement("div",{className:n?"sel wrap":"wrap",onClick:function(){return t()}},g().createElement("i",{className:"icon-cem_"+e}),g().createElement("span",null,a),g().createElement("i",{className:"icon-cem_pull-down-or-take-up",style:{transform:n?"rotate(180deg) translateY(-1px)":""}})))},t}(g().PureComponent);function f(e){return 16<(e=void 0===e?"":e).length?e.substring(0,15)+"...":e}var y=n(77131),r=n(18446),u=n.n(r),E=n(30133),r=n(81506),d=n.n(r),h=n(5133),p=function(t){function e(e){var r=t.call(this,e)||this;return r.sortList=function(e,t,n){n.stopPropagation(),n.nativeEvent.stopImmediatePropagation();var a=JSON.parse(JSON.stringify(r.state.value)),l=a.splice(e,1)[0];switch(t){case"top":a.unshift(l);break;case"up":a.splice(e-1,0,l);break;case"down":a.splice(e+1,0,l)}r.setState({value:a},function(e){return r.props.onChange&&r.props.onChange(r.getValue())})},r.state={value:e.defaultChecks||[],searchWord:""},r}i()(e,t);var n=e.prototype;return n.onSel=function(e,t){var n=this.state.value;(n=JSON.parse(JSON.stringify(n))).map(function(e){return e.id}).includes(t.id)?n.splice(n.findIndex(function(e){return e.id===t.id}),1):n.push(t),this.props.maxSelect&&n.length>this.props.maxSelect?h.Z.warning("最多选择"+this.props.maxSelect+"个对象！"):this.setState({value:n})},n.getValue=function(){return this.state.value},n.render=function(){var n=this,e=this.props,t=e.options,a=e.defaultChecks,l=e.maxSelect,r=e.onCancel,i=e.onChange,o=e.disabledValue,e=this.state,s=e.value,c=e.searchWord,u=a.map(function(e){return e.id}),d=s.map(function(e){return e.id}),t=t.filter(function(e){return!u.includes(e.id)}),a=a.filter(function(e){return!c||-1!==(e.label||"").toLocaleLowerCase().indexOf(c.trim().toLocaleLowerCase())}),t=t.filter(function(e){return!c||-1!==(e.label||"").toLocaleLowerCase().indexOf(c.trim().toLocaleLowerCase())});return g().createElement("div",{className:"filter-sort-select"},g().createElement("div",{className:"selItem "+(this.props.triangle?"triangle":""),onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},g().createElement("div",{className:"wrap"},g().createElement("div",{className:"title_name"},"添加展示",g().createElement("span",null,"（最多"+l+"个，已添加"+s.length+"个）")),g().createElement("div",null,g().createElement(C.Input,{value:c,placeholder:"请输入关键词",className:"search",size:"small",icon:c?"close":"search",onChange:function(e){return n.setState({searchWord:e})},onIconClick:function(){return n.setState({searchWord:""})}})),g().createElement("ul",null,a.map(function(t,e){return g().createElement("li",{className:(d.includes(t.id)?"sel":"")+(t.disable?" disable":""),key:e,onClick:function(e){o.includes(t.id)||n.onSel(e,t)}},g().createElement(C.Checkbox,{className:"check-all",checked:d.includes(t.id),disabled:o.includes(t.id),onChange:function(e){return o.includes(t.id)?"":n.onSel(e,t)}},g().createElement("span",null,f(t.label))))}),t.slice(0,100-a.length).map(function(t,e){return g().createElement("li",{className:(d.includes(t.id)?"sel":"")+(t.disable?" disable":""),key:e,onClick:function(e){return n.onSel(e,t)}},g().createElement(C.Checkbox,{className:"check-all",checked:d.includes(t.id),onChange:function(e){return n.onSel(e,t)},disabled:!d.includes(t.id)&&s.length>=l},g().createElement("span",{className:"dark"},f(t.label))))}),100<a.length+t.length?g().createElement("li",{style:{color:"#d96969"}},"数值展示不超过100条，查看更多请搜索"):null,0===a.length&&0===t.length&&g().createElement("div",{className:"noData"},"没有相关选项"))),g().createElement("div",{className:"line"}),g().createElement("div",{className:"control"},g().createElement("div",null,g().createElement(C.Button,{type:"",onClick:r},"取消"),g().createElement(C.Button,{type:"primary",onClick:function(){return i(s)}},"确定")))))},e}(a.Component);p.propTypes={options:t().array,value:t().array,onChange:t().func,show:t().bool,onCancel:t().func,maxSelect:t().number};var m=n(51474),N=n(39432),w=n(43036),a=function(t){function e(e){var n=t.call(this,e)||this;return n.getPanelWidth=function(){var e=n.props,t=e.showFlavor,t=void 0!==t&&t,e=e.options,e=Math.max.apply(null,e.map(function(e){return(0,N.jD)(e.title,14)}))+2+24+25;return 100<(e+=t?24:0)?e:100},n.setHoverDisable=function(){n.setState({disableHover:!0}),setTimeout(function(){return n.setState({disableHover:!1})},100)},n.state={disableHover:!1,firstLiHover:!1,panelWidth:n.getPanelWidth()},n}i()(e,t);var n=e.prototype;return n.componentDidMount=function(){window.addEventListener("click",this._setPadShowFalse)},n.componentWillUnmount=function(){window.removeEventListener("click",this._setPadShowFalse)},n.componentDidUpdate=function(e){var t=e.options,e=this.props.options;JSON.stringify(t)!==JSON.stringify(e)&&this.setState({panelWidth:this.getPanelWidth()})},n.render=function(){var n=this,e=this.state,t=e.panelWidth,a=e.disableHover,l=this.props,r=l.activeObj,i=void 0===r?"":r,o=l.onChange,s=l.options,c=l.objName,u=l.preTitle,d=l.sufTitle,f=void 0===d?"":d,e=l.showTitle,r=void 0===e||e,d=l.overlay,l=(l.flavor,l.onFlavorChange,l.showFlavor,l.collectValue,l.updateCollectValue,s.find(function(e){return e.value===i})),l=""===i?f:l&&l.title;return g().createElement("div",{className:"fast-single-select-button-wrapper",onClick:this._handleParentClick,style:{pointerEvents:a?"none":""}},g().createElement("div",{className:"button_content"},g().createElement("span",{onClick:this._handleTriggerOnClick},g().createElement("span",{className:"button-trigger"},r&&g().createElement(g().Fragment,null,u&&g().createElement("span",{className:"pre-title"},u,"："),g().createElement("span",{className:"button-title"},l)),g().createElement("i",{className:"icon-cem_arrow-launches"})),d&&g().createElement("span",{style:{marginLeft:4}},g().createElement(w.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:d},g().createElement("i",{className:"icon-cem_file1"})))),g().createElement("div",{className:"button-panel",style:{minWidth:t,top:a?"-1000px":""}},s.map(function(t,e){return g().createElement("div",{className:"panel-item "+(t.value===i?"sel":"")+" "+(t.disabled?"disabled":""),key:t.value,onClick:function(){var e;n.setHoverDisable(),t.disabled||t.value===i||o(c?((e={})[c]=t.value,e):t.value)}},t.title)}))))},e}(g().PureComponent);a.propTypes={activeObj:t().any,onChange:t().func.isRequired,options:t().array.isRequired,objName:t().any,preTitle:t().string,sufTitle:t().string,showTitle:t().bool,overlay:t().string,showFlavor:t().bool,flavor:t().string,onFlavorChange:t().func};const b=a;function F(e){return document.querySelector(e)}const V=function(t){function e(e){var s=t.call(this,e)||this;return s.defaultIsSelectAllChange=function(){var e=JSON.parse(JSON.stringify(s.props)).defaultConfig,t=d()(s).curFast;e.defaultChecked.forEach(function(e){e.id===t.id&&(e.isSelectAll=!e.isSelectAll)}),s.props.defaultValueChange({value:{defaultChecked:e.defaultChecked}}).then(function(){s.props.onSearch()})},s.defaultChecksNameChange=function(e){s.props.defaultValueChange({value:{defaultChecksName:[e]}}).then(function(){s.props.onSearch()})},s.defaultCheckedChange=function(e,t){var n=JSON.parse(JSON.stringify(s.props)).defaultConfig,a=n.defaultNumberChecked,l=d()(s),r=l.curFast,l=l.curFastShowList,i=JSON.parse(JSON.stringify(r.values));if("add"===e)var o,i=1===a?[t]:(o=[],i.push(t),l.forEach(function(t){return i.forEach(function(e){return e===t.id&&o.push(e)})}),o);else if("del"===e){if(1===i.length)return void h.Z.warning("至少保留一个选项");i.splice(i.indexOf(t),1)}n.defaultChecked.forEach(function(e){e.id===r.id&&(e.values=i)}),s.props.defaultValueChange({value:{defaultChecked:n.defaultChecked}}).then(function(){s.props.onSearch()})},s.defaultChecksChange=function(e,t){var n=JSON.parse(JSON.stringify(s.curFastShowList)),a=JSON.parse(JSON.stringify(s.props)).defaultConfig;"add"===e?n.push(t):"del"===e?n.splice(n.findIndex(function(e){return e.id===t.id}),1):"replace"===e&&(n=t),a.defaultChecks.forEach(function(e){e.id===s.curFast.id&&(e.values=n)}),s.props.defaultValueChange({value:{defaultChecks:a.defaultChecks}})},s.clickListener=function(e){s.setState({showSelector:!1})},s.getWidth=function(){var e=F(".header_Filter_bar").offsetWidth,t=Array.from(F(".header_Filter_bar").children).filter(function(e){return"fast_filter"!==e.className}).reduce(function(e,t){return e+t.offsetWidth},0),n=F(".header_Filter_bar .fast_filter .name").offsetWidth;s.setState({maxWidth:e-t-n-40-28-32})},s.state={showSelector:!1,maxWidth:500},s}i()(e,t);var n=e.prototype;return n.componentDidMount=function(){var o=this;window.addEventListener("click",this.clickListener),window.addEventListener("resize",this.getWidth),this.getWidth(),new m.ZP(document.querySelector(".fast_wrap"),{sort:!0,animation:150,draggable:".fast_block",handel:".handel",onEnd:function(e){var t=e.oldIndex,n=e.newIndex,a=JSON.parse(JSON.stringify(o.props)).defaultConfig,l=o.curFast,e=o.curFastShowList,r=JSON.parse(JSON.stringify(e)),t=r.splice(t,1)[0];r.splice(n,0,t),a.defaultChecks.forEach(function(e){e.id===l.id&&(e.values=r)});var i={defaultChecks:a.defaultChecks};u()(l.values,r.filter(function(e){return l.values.includes(e.id)}).map(function(e){return e.id}))||(a.defaultChecked.forEach(function(n){n.id===l.id&&(n.values=[],r.forEach(function(t){l.values.forEach(function(e){t.id===e&&n.values.push(e)})}))}),i.defaultChecked=a.defaultChecked),o.props.defaultValueChange({value:i}).then(function(){return i.defaultChecked&&o.props.onSearch()})}})},n.componentWillUnmount=function(){window.removeEventListener("click",this.clickListener),window.removeEventListener("resize",this.getWidth)},n.render=function(){var n=this,e=this.props,t=e.defaultConfig,a=e.screeningList,l=this.state,r=l.showSelector,i=l.maxWidth,o=this.curFast,s=this.curFastShowList,c=o.isSelectAll,e=t.defaultChecked,l=void 0===e?[]:e,e=t.defaultChecksName,u=void 0===e?[]:e,d=t.defaultNumberChecked,t=t.defaultNumberConfig,a=a.map(function(e){return e.data}).flat(1).filter(function(e){return e.id===u[0]}).length?a.map(function(e){return e.data}).flat(1).filter(function(e){return e.id===u[0]})[0]:{};return g().createElement("div",{className:"fast_filter"},g().createElement("div",{className:"name"},1===l.length?a.label:g().createElement(b,{options:l.map(function(e){return{title:e.label,value:e.id}}),activeObj:u[0],onChange:function(e){return n.defaultChecksNameChange(e)}}),"boolean"==typeof c&&g().createElement("div",{className:"select_all "+(c?"select":""),onClick:this.defaultIsSelectAllChange},g().createElement("span",null,"全选"))),g().createElement("div",{className:"fast_wrap",style:{maxWidth:i}},c&&g().createElement("div",{className:"cover",onClick:this.defaultIsSelectAllChange}),s.map(function(t){return g().createElement("span",{key:t.id,className:"fast_block "+(o.values.includes(t.id)?"select":"")+" "+(o.values.length>=d&&1!==d?"disabled":"")+" "+(c?"disabled_all":""),onClick:function(){return c?"":(o.values.length<d||o.values.includes(t.id)||1===d)&&n.defaultCheckedChange(o.values.includes(t.id)?"del":"add",t.id)}},g().createElement("span",{title:t.label},t.label),g().createElement("i",{className:"icon-cem_cancel",onClick:function(e){e.stopPropagation(),n.defaultChecksChange("del",t)}}))})),g().createElement("div",{className:"add",onClick:function(e){e.stopPropagation(),n.setState({showSelector:!r})}},g().createElement("span",null,"+"),r&&g().createElement(p,{options:a.options,defaultChecks:s,onChange:function(e){n.setState({showSelector:!1}),n.defaultChecksChange("replace",e)},disabledValue:o.values,maxSelect:t,onCancel:function(){return n.setState({showSelector:!1})}})))},o()(e,[{key:"curFast",get:function(){var t=this.props.defaultConfig;return t.defaultChecked.find(function(e){return e.id===t.defaultChecksName[0]})||{}}},{key:"curFastShowList",get:function(){var t=this.props.defaultConfig;return(t.defaultChecks.find(function(e){return e.id===t.defaultChecksName[0]})||{}).values||[]}}]),e}(g().Component),_=function(n){function e(e){var t=n.call(this,e)||this;return t.handelChangeShow=function(e){return t.setState({show:e===t.state.show?null:e})},t.handelTimeChange=function(e){t.props.dateValueChange({value:e}).then(function(){t.fastRef&&t.fastRef.getWidth(),t.handelChangeShow(null),t.props.onSearch()})},t.state={show:e.defaultShow||null},t}return i()(e,n),e.prototype.render=function(){var t=this,e=this.state.show,n=this.props,a=n.title,l=n.dateFilter,r=n.onSearchButtonClick,i=n.screeningList,o=n.curScreeningMap,s=n.children,c=n.getTimeRef,u=n.defaultConfig,d=n.defaultValueChange,f=n.onSearch,h=n.onFilterReady,p=n.expandInfo,m=n.noSavingFilterList,n=n.transferValue;return g().createElement("div",{className:"header_Filter_view",style:{height:s?"100%":""}},g().createElement(C.Loading,{loading:void 0===o||void 0===u},g().createElement("div",{className:"header_Filter_bar"},a?"string"==typeof a?g().createElement("div",{className:"filter_title"},a):g().createElement("div",{style:{float:"left"}},a):u&&u.defaultChecksName&&0<u.defaultChecksName.length&&g().createElement(V,{ref:function(e){return t.fastRef=e},defaultConfig:u,screeningList:i,defaultValueChange:d,onSearch:f,disabled:"screening"===e}),g().createElement(k,{name:this.time,_handelClick:function(){return t.handelChangeShow("time")},select:"time"===e,icon:"time-controller"}),g().createElement(k,{name:"筛选",_handelClick:function(){return t.handelChangeShow("screening")},select:"screening"===e,icon:"screen"})),g().createElement("div",null,g().createElement(S,v()({},this.props,{show:"screening"===e,handelChangeShow:this.handelChangeShow,onSearchButtonClick:r,onFilterReady:h,expandInfo:p,noSavingFilterList:m,transferValue:n})),g().createElement(y.Z,{ref:c,onChange:function(e){return t.handelTimeChange(e)},show:"time"===e,onCancel:function(){return t.handelChangeShow("time")},params:l}))),s&&g().createElement("div",{className:"contentWrap"},void 0===o?g().createElement(E.Z,null):s))},o()(e,[{key:"time",get:function(){var e="时间";return e=this.props.dateFilter&&this.props.dateFilter.from?this.props.dateFilter.quickChoice||this.props.dateFilter.from.replace(/-/g,"/")+"-"+this.props.dateFilter.to.replace(/-/g,"/"):e}},{key:"isScreeningChanged",get:function(){var e=this.props,t=e.selSaveInfo,e=e.screeningValues;return!u()(t.screeningValues,e)}}]),e}(g().Component);var a=n(55609),n=n(64396),O=n.Z.headerScreening,L=n.Z.screening;Array.prototype.deepcopy=function(){return JSON.parse(JSON.stringify(this))};n=function(t){function e(e){var i=t.call(this,e)||this;return i.getValue=function(){var e=i.props,t=e.screeningValues,n=e.defaultConfig,a=e.dateFilter,e=e.curScreeningMap,t=t.deepcopy().filter(function(e){return 0<e.values.length}),l=JSON.parse(JSON.stringify(n)),e=e.filter(function(e){return e.data.some(function(e){return e.id===l.defaultChecksName[0]})})[0],r=l.defaultChecked.find(function(e){return e.id===l.defaultChecksName[0]})||{};return r.isSelectAll&&t.forEach(function(e){e.values.some(function(e){return e.id===l.defaultChecksName[0]})&&e.values.forEach(function(e){e.id===l.defaultChecksName[0]&&(e.values=[])})}),{filterValue:t,analysisModel:e?[{id:e.id,values:l.defaultChecked.filter(function(e){return e.id===l.defaultChecksName[0]&&(e.values=r.isSelectAll?[]:e.values,!0)})}]:void 0,dateFilter:a}},i.getTransferValue=function(){var e=i.props,t=e.screeningList,n=e.curScreeningMap,a=e.screeningValues;return{defaultConfig:e.defaultConfig,screeningList:t,curScreeningMap:n,screeningValues:a,dateFilter:e.dateFilter}},i.getFullValue=function(){var e=JSON.parse(JSON.stringify(i.props));return function(e,t,n){e.forEach(function(t){n.forEach(function(e){t.id===e.id&&(t.label=e.label,t.values.forEach(function(t){e.data.forEach(function(e){t.id===e.id&&(t.label=e.label,t.values=t.values.map(function(t){var n={id:t};return e.options.forEach(function(e){t===e.id&&(n.label=e.label)}),n}))})}))})});var a=t.defaultChecked.find(function(e){return e.id===t.defaultChecksName[0]})||{};return{filterValue:e,analysisModel:JSON.parse(JSON.stringify(e)).filter(function(e){return!!e.values.some(function(e){return e.id===t.defaultChecksName[0]})&&(e.values=e.values.filter(function(e){return e.id===t.defaultChecksName[0]}),e.values=a.isSelectAll?[{label:"全部"}]:e.values,!0)})}}(e.screeningValues,e.defaultConfig,e.curScreeningMap)},i._handelOnFilterReady=function(){var e=i.props.valueConf,a=void 0===e?[]:e;i.timeRef?i.timeRef.fetchDefaultValue().then(function(n){i.props.dateValueChange({value:n}).then(function(){var e=i.getValue(),t={};a.includes("fullInfo")&&(t.fullInfo=i.getFullValue()),setTimeout(function(){return i.props.onReady&&i.props.onReady(v()({},e,{dateFilter:n}),t)},0)})}):setTimeout(function(){return i._handelOnFilterReady()},100)},i._handelSearch=function(){var e=i.props.valueConf,t=void 0===e?[]:e,n=i.getValue(),e={};t.includes("fullInfo")&&(e.fullInfo=i.getFullValue()),i.props.onChange&&i.props.onChange(n,e)},i._handelSearchButtonClick=function(){return i.props.freshFastFilter().then(function(){return i._handelSearch()})},e.transferValue&&e.transferValue.dateFilter&&e.save({dateFilter:e.transferValue.dateFilter}),i.state={},i._event={onFilterReady:i._handelOnFilterReady,onSearchButtonClick:i._handelSearchButtonClick,onSearch:i._handelSearch,getTimeRef:function(e){return i.timeRef=e}},i}i()(e,t);var n=e.prototype;return n.componentDidMount=function(){},n.componentWillUnmount=function(){this.props.clear()},n.render=function(){return g().createElement(_,v()({},this.state,this._event,this.props))},e}(g().Component);n.propTypes={title:t().oneOfType([t().string,t().node]),onChange:t().func,pageType:t().string,onReady:t().func,valueConf:t().array,expandInfo:t().object,noSavingFilterList:t().bool,transferValue:t().object};const J=(0,a.connect)(function(e){e.loading;e=l()(e,["loading"]);return v()({},e[O],e[L])},function(t){return{freshFastFilter:function(e){return t({type:O+"/freshFastFilter",payload:e})},defaultValueChange:function(e){return t({type:O+"/defaultValueChange",payload:e})},dateValueChange:function(e){return t({type:O+"/dateValueChange",payload:e})},clearAllValues:function(e){return t({type:O+"/clearAllValues",payload:e})},clear:function(){return t({type:O+"/clear"})},save:function(e){return t({type:O+"/save",payload:e})}}},null,{withRef:!0})(n)}}]);