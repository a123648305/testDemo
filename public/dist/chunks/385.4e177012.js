(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[385],{1486:(e,t,n)=>{"use strict";n.d(t,{u:()=>r});var a=n(35239),r=function(e){var t=e.title,e=e.url;return[{title:"所有项目",url:"/account/project"},{title:a.t.get(a.V.backProjectConfig).name,url:"/account/project/preview"},{title:t,url:e}]}},20385:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>v});var t=n(67154),a=n.n(t),t=n(37316),r=n.n(t),t=n(85354),l=n.n(t),s=n(67294),C=n.n(s),y=n(92360),k=n(55815),E=n(53754),u=n(43036),b=n(84267),S=n(29383),c=n(52727),o=n(61409),w=n(1486),t=n(30381),d=n.n(t),p=n(39432),m="YYYY-MM-DD HH:mm:ss",N={QUE_ANS:"问答",BBS:"论坛",SOCIAL:"社交媒体",SELF:"自媒体",NEWS:"新闻媒体",COMPLAINT:"投诉平台",VIDEO:"视频"},h={is:"其中一个",in:"其中一个",notin:"不为其中任一个",like:"包含",notlike:"不包含"},i=function(e){function t(){var i=e.call(this)||this;return i.init=function(){var e=i.state.columns.filter(function(e){return e.checked});i.setState({selectedColumns:e})},i.getContentWidth=function(){i.timer&&clearTimeout(i.timer),i.timer=setTimeout(function(){var e=document.querySelector("#right-wrap")?document.querySelector("#right-wrap").clientWidth-162:0;i.setState({tableWidth:e})},500)},i.handleOnBtnClick=function(e,t){var n=i.props,a=n.messageCategory,r=n.save;switch(e){case"add":case"edit":o.mW.push({pathname:location.pathname+"/edit",state:{messageType:a,id:"edit"===e?t.id:"",name:"edit"===e?t.name:"",sourceId:"edit"!==e||"QUE_ANS"===a&&"NEWS"===a?"":t.sourceId,syncKey:"edit"===e?t.syncKey:""}});break;case"delete":r({modalShow:!0,targetUrl:t})}},i.handleOnInputChange=function(e){i.props.save({searchText:e})},i.handleOnKeyDown=function(e){var t=i.props,n=t.save,t=t.fetchUrlList;e.stopPropagation(),13===e.nativeEvent.keyCode&&(n({pageIndex:1}),t())},i.handleUrlChange=function(t){var e=i.props,n=e.save,a=e.avaUrls,e=e.fetchUrlList;n({selectedUrls:a.filter(function(e){return t.includes(e.id)}),pageIndex:1}),e()},i.handlePlatformChange=function(e){var t=i.props,n=t.save,t=t.fetchUrlList;n({selectedPlatforms:e,pageIndex:1}),t()},i.handleSiwtchPage=function(e){var t=i.props,n=t.save,t=t.fetchUrlList;n({pageIndex:e}),t()},i.handleSiwtchPageSize=function(e){var t=i.props,n=t.save,t=t.fetchUrlList;n({pageIndex:1,pageSize:e}),t()},i.hanldeSort=function(e){var t=e.prop,n=e.order,a=i.props,e=a.save,a=a.fetchUrlList;e({sortName:t&&"updatedAt"===t?"UPDATED_AT":"CREATED_AT",sortType:n&&"ascending"===n?"ASC":"DESC",pageIndex:1}),a()},i.getRuleType=function(e){for(var t="",n=Object.keys(h),a=0;a<n.length;a++)if(Object.prototype.hasOwnProperty.call(e,n[a])){t=n[a];break}return t},i.getPopupContent=function(e){var a=!1;return e.forEach(function(e){"notin"===i.getRuleType(e)&&(a=!0)}),C().createElement("div",{className:"url-rule-popup-wrapper"},C().createElement("div",{className:"url-rule-popup-title"},"链接规则"),e.map(function(e,t){var n=i.getRuleType(e);return C().createElement("div",{className:"url-rule-popup-item",key:t},C().createElement("span",{style:{width:a?"120px":"80px"}},e.name+" "+h[n]),C().createElement("span",{style:{width:a?"calc(100% - 120px)":"calc(100% - 80px)"}},("in"===n&&Object.prototype.hasOwnProperty.call(e,"inValue")?e.inValue:"notin"===n&&Object.prototype.hasOwnProperty.call(e,"notinValue")?e.notinValue:e[n]).join("，")))}))},i.getRulesView=function(e,a){try{var r=i.state.tableWidth;if("string"==typeof a||Array.isArray(a)&&Object.prototype.hasOwnProperty.call(a[0],"contain")){var t=[];if("string"==typeof a)t=[a];else for(var n=0;n<a.length;n++)var l=a[n],c=l.contain,o=l.notContain,t=t.concat(c).concat(o);return C().createElement("div",{className:"rule-item ellipsis",style:{maxWidth:+r/6+"px"}},C().createElement("span",null,{"知乎":"关键词","新浪微博":"搜索词","百度贴吧":"贴吧名"}[e]||"专栏"),C().createElement("span",null,"|"),C().createElement("span",{title:t.join("，")},t.join("，")))}return a&&a.slice(0,2).map(function(e,t){var n=i.getRuleType(e);return C().createElement(s.Fragment,{key:t},C().createElement("div",{className:"rule-item ellipsis",style:{maxWidth:+r/6+"px"}},C().createElement("span",null,e.name+" "+h[n]),C().createElement("span",null,"|"),C().createElement("span",{title:("平台"===e.name?e[n+"Value"]:e[n]).join("，")},("平台"===e.name?e[n+"Value"]:e[n]).join("，"))),0<a.length&&1===t&&C().createElement(u.Z,{overlay:function(){return i.getPopupContent(a)},placement:"top",overlayClassName:"url-rule-popup"},C().createElement("span",{className:"detail"},"详情")))})}catch(e){console.error(e)}},i.getSelectedColumns=function(e){var t=e.filter(function(e){return e.checked}),t=[{label:"",width:45}].concat(t,[{label:"",width:45}]);i.setState({columns:e,selectedColumns:t})},i.state={tableWidth:0,columns:[{label:"",width:16,checked:!0},{label:"链接名称",checked:!0,render:function(e){e=e.name;return C().createElement("span",{className:"ellipsis",title:e},e)}},{label:"链接规则",checked:!0,render:function(e){var t=e.sourceName,e=e.syncKey;return i.getRulesView(t,e)}},{label:"平台",prop:"sourceName",checked:!0,render:function(e){e=e.sourceName;return C().createElement("span",{className:"ellipsis"},e)}},{label:"总数据量",checked:!0,render:function(e){e=e.total;return e?p.ZP.getApproximateNum(e):C().createElement("i",{className:"icon-cem_line",style:{color:"rgb(191, 191, 191)",fontSize:20}})}},{label:"30天数据趋势",checked:!0,render:function(e){e=e.dateList;return e&&0<e.length?C().createElement(c.Z,{loading:!1,chartData:e}):C().createElement("i",{className:"icon-cem_line",style:{color:"rgb(191, 191, 191)",fontSize:20}})}},{label:"创建时间",minWidth:145,prop:"createdAt",sortable:"custom",checked:!1,render:function(e){e=e.createdAt;return C().createElement("span",null,d()(e).format(m))}},{label:"修改时间",minWidth:145,prop:"updatedAt",sortable:"custom",checked:!0,render:function(e){e=e.updateAt;return C().createElement("span",null,d()(e).format(m))}},{label:"操作",checked:!0,render:function(e){return C().createElement("div",{className:"operation"},C().createElement("span",{onClick:function(){return i.handleOnBtnClick("edit",e)}},"编辑"),C().createElement("span",{onClick:function(){return i.handleOnBtnClick("delete",e)}},"删除"))}},{label:"",width:16,checked:!0}]},i}l()(t,e);var n=t.prototype;return n.componentDidMount=function(){this.getContentWidth(),this.init(),window.addEventListener("resize",this.getContentWidth)},n.componentWillUnmount=function(){window.addEventListener("resize",this.getContentWidth)},n.render=function(){var t=this,e=this.props,n=e.type,a=e.loading,r=e.modalShow,l=e.data,c=e.total,o=e.pageIndex,i=e.pageSize,s=e.avaUrls,u=e.selectedUrls,d=e.avaPlatforms,p=e.selectedPlatforms,m=e.fetchUrlList,h=e.deleteUrl,f=e.save,g=this.state,v=g.columns,e=g.selectedColumns,g=(0,w.u)({title:N[n],url:""});return C().createElement("div",{className:"data_url_wrapper"},C().createElement(k.Z,{title:g}),C().createElement("div",{className:"data_url_body"},C().createElement("div",null,C().createElement("div",{className:"data_url_filter"},C().createElement(y.Input,{placeholder:"请输入规则关键词",icon:"search",onChange:this.handleOnInputChange,onKeyDown:this.handleOnKeyDown,onIconClick:m}),C().createElement(E.Z,{title:"链接名称",options:s,value:0<u.length?u.map(function(e){return e.id}):[],onChange:this.handleUrlChange}),"NEWS"!==n&&C().createElement(E.Z,{title:"平台",options:d,value:p,onChange:this.handlePlatformChange}),C().createElement(y.Button,{type:"primary",onClick:function(){return t.handleOnBtnClick("add")}},"新增关键词链接")),C().createElement(y.Loading,{loading:a},C().createElement("div",{className:"table-zone"},C().createElement(b.Z,{ref:function(e){return t.selectableColumns=e},multiSave:{name:"connection_list"},columns:v.filter(function(e){return e.label}),getShowColumns:this.getSelectedColumns}),C().createElement(S.Z,{columns:e,data:l,total:c,pagePosition:"down",pageSize:i,currentPage:o,onPage:this.handleSiwtchPage,pageSizeSelectorShow:!0,onPageSizeChange:this.handleSiwtchPageSize,onSortChange:this.hanldeSort,notLimit:!0}))))),C().createElement(y.Dialog,{className:"data_url_delete_dialog",title:"确定删除此「数据链接」？",size:"tiny",visible:r,onCancel:function(){return f({modalShow:!1})},lockScroll:!1},C().createElement(y.Dialog.Body,null,C().createElement("div",{className:"dialog-content"},"删除后，与之关联的消息也将从项目中删除，请谨慎操作。")),C().createElement(y.Dialog.Footer,{className:"dialog-footer"},C().createElement(y.Button,{onClick:function(){return f({modalShow:!1})}},"取消"),C().createElement(y.Button,{type:"primary",onClick:h},"确定"))))},t}(s.Component),f=n(35239),t=n(55609),g=n(64396).Z.project.dataUrlList,n=function(e){function t(){return e.apply(this,arguments)||this}l()(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=e.save,n=e.type,a=e.fetchUrlNameList,r=e.fetchPlatformList,l=e.fetchUrlList,e=f.t.get(f.V.backProjectConfig).id;t&&t({projectId:e,messageCategory:n}),a(),"NEWS"===n||r(),l()},n.componentWillUnmount=function(){var e=this.props.resetState;e&&e()},n.render=function(){return C().createElement(i,this.props)},t}(s.Component);const v=(0,t.connect)(function(e){var t=e.loading,e=r()(e,["loading"]);return a()({},e[g],{loading:t.effects[g+"/fetchTrendChartData"]||!1})},function(t){return{fetchUrlNameList:function(){return t({type:g+"/fetchUrlNameList"})},fetchPlatformList:function(){return t({type:g+"/fetchPlatformList"})},fetchUrlList:function(){return t({type:g+"/fetchUrlList"})},deleteUrl:function(){return t({type:g+"/deleteUrl"})},save:function(e){return t({type:g+"/save",payload:e})},resetState:function(){return t({type:g+"/resetState"})}}})(n)},24473:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var a=n(67154),d=n.n(a),r=n(37316),p=n.n(r),t=n(85354),l=n.n(t),a=n(67294),m=n.n(a),r=n(45697),t=n.n(r),r=n(94184),h=n.n(r),a=function(e){function t(){return e.apply(this,arguments)||this}return l()(t,e),t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.children,a=e.className,r=e.block,l=e.indeterminate,c=e.value,o=e.checked,i=e.defaultChecked,s=e.onChange,u=e.disabled,e=p()(e,["prefixCls","children","className","block","indeterminate","value","checked","defaultChecked","onChange","disabled"]),s={value:c,checked:o,defaultChecked:i,onChange:s,disabled:u},a=h()(t,((u={})[t+"-disabled"]=s.disabled,u[t+"-block"]=r,u[t+"-indeterminate"]=l,u),a);return m().createElement("label",d()({tabIndex:s.disabled?-1:0,className:a},e),m().createElement("input",d()({type:"checkbox",className:t+"-input"},s)),m().createElement("span",{className:t+"-status"}),n&&m().createElement("span",{className:t+"-text",title:n},n))},t}(a.Component);a.propTypes={prefixCls:t().string,value:t().oneOfType([t().string,t().number]),checked:t().bool,defaultChecked:t().bool,onChange:t().func,indeterminate:t().bool,disabled:t().bool,block:t().bool},a.defaultProps={prefixCls:"wt-checkbox"};const c=a},85151:(e,t,n)=>{"use strict";n.d(t,{Jg:()=>a.Z,CS:()=>o});var a=n(24473),r=n(67154),i=n.n(r),l=n(37316),s=n.n(l),t=n(85354),c=n.n(t),r=n(67294),u=n.n(r),l=n(45697),t=n.n(l),l=n(94184),d=n.n(l),l=function(r){function e(){for(var n,e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(n=r.call.apply(r,[this].concat(t))||this).handleCheckBoxChange=function(e){var t=n.props.onChange;t&&t(e)},n}return c()(e,r),e.prototype.render=function(){var r=this,e=this.props,t=e.prefixCls,n=e.children,a=e.className,l=(e.onChange,e.values),c=e.checkedList,o=e.block,e=s()(e,["prefixCls","children","className","onChange","values","checkedList","block"]),n=l?l.map(function(e,t){var n=0!==c.length&&-1!==c.indexOf(e);return u().createElement(Checkbox,{key:t,value:e,checked:n,onChange:function(e){return r.handleCheckBoxChange(e)},block:o},e)}):u().Children.map(n,function(e,t){if(e){var n=e.props,a=n.value,a=0!==c.length&&-1!==c.indexOf(a);return u().cloneElement(e,{checked:a,key:t,block:n.block||o,onChange:function(){var e=n.value;r.handleCheckBoxChange(e)}})}});return u().createElement("div",i()({className:d()(t,a)},e),n)},e}(r.Component);l.defaultProps={prefixCls:"wt-checkbox-group"},l.propTypes={onChange:t().func,values:t().array,block:t().bool};const o=l;var p=function(t){var n={};return Object.keys(t).forEach(function(e){/^data\-.+$/.test(e)&&(n[e]=t[e])}),n},r=function(e){function t(){return e.apply(this,arguments)||this}return c()(t,e),t.prototype.render=function(){var e=this.props,t=p(e);return u().createElement("label",{className:e.className,title:e.children},u().createElement("div",{className:"checkbox"},u().createElement("input",i()({checked:e.checked,type:"checkbox",name:e.name,onChange:e.onChange,disabled:e.disabled},t)),u().createElement("div",{className:"checkbox-body"}))," ",u().createElement("span",null,e.children))},t}(r.Component);r.defaultProps={className:"",name:"",checked:!1,disabled:!1,onChange:function(e){return e}}},84267:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var t=n(67154),a=n.n(t),t=n(85354),r=n.n(t),t=n(67294),c=n.n(t),l=n(85151),o=n(35239),i=function(t){function e(e){var l=t.call(this,e)||this;return l.openMenu=function(){l.setState({menuState:!l.state.menuState})},l.onChange=function(e){var t,n=l.props,a=n.columns,r=n.getShowColumns,n=n.multiSave;a&&a[e]&&((t=a.slice(0))[e].checked=!t[e].checked);e=n?n.name:"",n=o.t.get(o.V.storageColumns)?o.t.get(o.V.storageColumns):{};n[e]=t,o.t.set(o.V.storageColumns,n),r&&r(t),l.resize(),l.setState({columns:t})},l.competeSelectMenuItem=function(e){var t,n=l.props.multiSave,a=n?n.name:"",r=l.props.columns,n=o.t.get(o.V.storageColumns)?o.t.get(o.V.storageColumns)[a]:[];return r=n&&0!==n.length?("price_check"===a?n.map(function(a,e){return a.render=0<r.filter(function(e){return e.label===a.label}).length?r.filter(function(e){return e.label===a.label})[0].render:function(e,t,n){return c().createElement("span",null,e[a.prop])}}):n.map(function(e,a){return e.render=function(e,t,n){return c().createElement("span",null,e.configDetails[a]&&e.configDetails[a].topicValue)}}),n.slice(0)):e&&e.every(function(e){return e.label&&e.prop})?e:(t=[],e&&e.forEach(function(e,a){t.push({label:e.topicTypeValue,checked:!1,render:function(e,t,n){return c().createElement("span",null,e.configDetails[a].topicValue)}})}),t.slice(0)),l.setState({columns:r}),r},l.resize=function(){var e=document.querySelector(".connection-table .is-sortable");if(e){var t=l.getStyle(e,"width"),e=document.body.offsetWidth,n=l.state.columns;if(800<e&&2<n.length&&parseInt(t)<275)for(var a=0;a<n.length-2;a++)if(n[a].checked)return void l.onChange(a)}},l.close=function(e){l.state.menuState&&l.setState({menuState:!1})},l.state={menuState:!1,multiSave:null,columns:e.columns.map(function(e){return e.checked||(e.checked=!1),e})},l}r()(e,t);var n=e.prototype;return n.UNSAFE_componentWillReceiveProps=function(e){this.setState(a()({},e))},n.getStyle=function(e,t){return e.style[t]||(e.currentStyle||getComputedStyle(e,null))[t]},n.componentDidMount=function(){window.addEventListener("click",this.close),window.addEventListener("resize",this.resize,!1)},n.componentWillUnmount=function(){window.removeEventListener("resize",this.resize,!1),window.removeEventListener("click",this.close)},n.render=function(){var n=this,e=this.state.columns;return c().createElement("div",{className:"menu-wrapper",onClick:function(e){e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()}},c().createElement("span",{className:"el-dropdown-link "+(this.state.menuState?"sel":""),onClick:this.openMenu},"列",c().createElement("i",{className:"icon-cem_pull-down-or-take-up",style:{transform:this.state.menuState?"rotate(-180deg)":""}})),this.state.menuState&&c().createElement("div",{className:"menuList"},c().createElement("ul",null,0===e.length?c().createElement("li",{style:{color:"#8c8c8c"}},"无可选择内容"):e.map(function(e,t){return c().createElement("li",{key:t},c().createElement(l.Jg,{key:t,value:e.label,checked:e.checked,onChange:n.onChange.bind(n,t),block:!0},e.label))}))))},e}(t.Component)}}]);