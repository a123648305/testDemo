(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[5979],{5979:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var t=a(67154),s=a.n(t),t=a(93913),r=a.n(t),t=a(85354),i=a.n(t),t=a(67294),o=a.n(t),c=a(29383),l=a(61409),u=a(36144),h=a(72305),d=a(61193),m={0:"禁用",1:"可用"},n=function(t){function e(e){var n=t.call(this,e)||this;return n.getList=function(e){u.h.post("/user/list",s()({},n.state.form)).then(function(e){n.setState({data:e.data.result.result,from:e.data.result.from,to:e.data.result.to,count:e.data.result.count})})},n.getPage=function(e){var t=n.state.form;t.pageIndex=e,n.setState({form:t},function(e){return n.getList()})},n.state={visible:!1,columns:[{label:"",prop:"paddingLeft",width:16},{label:"用户",prop:"username",render:function(e){return o().createElement("div",{className:"user-info"},o().createElement("img",{src:e.userHeadUrl?e.userHeadUrl+"?_="+(new Date).getTime():a(7810),alt:""}),o().createElement("div",null,o().createElement("p",null,e.username),o().createElement("div",null,e.email)))}},{label:"所在团队",render:function(e){return o().createElement("div",null,e.teamVOS.map(function(t,e){return o().createElement("p",{key:e},o().createElement("span",{style:{color:"rgb(0, 82, 204)",cursor:"pointer"},onClick:function(e){return l.mW.push({pathname:"/account/team/edit",state:{id:t.id,name:t.name}})}},t.name))}))}},{label:"角色",render:function(e){return o().createElement("p",null,e.role.name)}},{label:"登录详情",width:240,render:function(e){return o().createElement("div",{className:"login-info"},o().createElement("p",null,"登录次数:",e.userExtVO.loginCount||0),e.userExtVO.loginCount&&o().createElement("p",null,"最后登录时间：",e.userExtVO.updateTime))}},{label:"状态",width:80,render:function(e){return m[e.status]}}],handle:{label:"操作",width:180,render:function(t,e,n){return d.Z.getUser().userId!==t.id&&o().createElement("span",{className:"operation_columns",style:{cursor:"pointer"},onClick:function(e){return l.mW.push({pathname:"/account/user/userEdit",query:{email:t.email,id:t.id}})}},"编辑")}},data:[],roleList:[],teamList:[],statusList:[{id:"0",name:"禁用"},{id:"1",name:"可用"}],form:{search:"",roleId:[],teamId:[],status:[],pageIndex:1,pageSize:20},from:0,to:0,count:0},n}i()(e,t);var n=e.prototype;return n.componentDidMount=function(){Promise.all([this.getList(),this.getRoleList(),this.getTeamList()]),d.Z.hasAuthority("USER_EDIT")&&this.state.columns.push(this.state.handle)},n.getTeamList=function(){var t=this;u.h.get("/team/list").then(function(e){t.setState({teamList:e.data.result.list})})},n.getRoleList=function(){var t=this;u.h.get("/role/list").then(function(e){e=[{id:"2",name:"企业管理员"},{id:"3",name:"普通成员"}].concat(e.data.result.list);t.setState({roleList:e})})},n.render=function(){var t=this,e=document.documentElement.clientHeight-46-48-24,n=this.state,a=n.columns,s=n.data,r=n.from,i=n.to,l=n.count,n=n.form;return o().createElement("div",{className:"wrap common-padding-12"},o().createElement("div",{style:{minHeight:e,backgroundColor:"#fff"}},o().createElement("div",{className:"navWrap"},o().createElement(h.Z,{list:this.allList,onChange:function(e){return t.allList=e}})),o().createElement("div",{className:"userList"},o().createElement(c.Z,{columns:a,data:s,start:r,end:i,total:l,pageSize:n.pageSize,currentPage:n.pageIndex,onPage:this.getPage}))))},r()(e,[{key:"allList",get:function(){return[{name:"角色",list:this.state.roleList,value:this.state.form.roleId},{name:"团队",list:this.state.teamList,value:this.state.form.teamId},{name:"状态",list:this.state.statusList,value:this.state.form.status}]},set:function(e){var t=this,n=this.state.form;e.forEach(function(e){switch(e.name){case"角色":n.roleId=e.value;break;case"团队":n.teamId=e.value;break;case"状态":n.status=e.value}}),n.pageIndex=1,n.pageSize=10,this.setState({form:n},function(e){return t.getList()})}}]),e}(t.Component)},24473:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var a=n(67154),h=n.n(a),s=n(37316),d=n.n(s),t=n(85354),r=n.n(t),a=n(67294),m=n.n(a),s=n(45697),t=n.n(s),s=n(94184),p=n.n(s),a=function(e){function t(){return e.apply(this,arguments)||this}return r()(t,e),t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.children,a=e.className,s=e.block,r=e.indeterminate,i=e.value,l=e.checked,o=e.defaultChecked,c=e.onChange,u=e.disabled,e=d()(e,["prefixCls","children","className","block","indeterminate","value","checked","defaultChecked","onChange","disabled"]),c={value:i,checked:l,defaultChecked:o,onChange:c,disabled:u},a=p()(t,((u={})[t+"-disabled"]=c.disabled,u[t+"-block"]=s,u[t+"-indeterminate"]=r,u),a);return m().createElement("label",h()({tabIndex:c.disabled?-1:0,className:a},e),m().createElement("input",h()({type:"checkbox",className:t+"-input"},c)),m().createElement("span",{className:t+"-status"}),n&&m().createElement("span",{className:t+"-text",title:n},n))},t}(a.Component);a.propTypes={prefixCls:t().string,value:t().oneOfType([t().string,t().number]),checked:t().bool,defaultChecked:t().bool,onChange:t().func,indeterminate:t().bool,disabled:t().bool,block:t().bool},a.defaultProps={prefixCls:"wt-checkbox"};const i=a},85151:(e,t,n)=>{"use strict";n.d(t,{Jg:()=>a.Z,CS:()=>l});var a=n(24473),s=n(67154),o=n.n(s),r=n(37316),c=n.n(r),t=n(85354),i=n.n(t),s=n(67294),u=n.n(s),r=n(45697),t=n.n(r),r=n(94184),h=n.n(r),r=function(s){function e(){for(var n,e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(n=s.call.apply(s,[this].concat(t))||this).handleCheckBoxChange=function(e){var t=n.props.onChange;t&&t(e)},n}return i()(e,s),e.prototype.render=function(){var s=this,e=this.props,t=e.prefixCls,n=e.children,a=e.className,r=(e.onChange,e.values),i=e.checkedList,l=e.block,e=c()(e,["prefixCls","children","className","onChange","values","checkedList","block"]),n=r?r.map(function(e,t){var n=0!==i.length&&-1!==i.indexOf(e);return u().createElement(Checkbox,{key:t,value:e,checked:n,onChange:function(e){return s.handleCheckBoxChange(e)},block:l},e)}):u().Children.map(n,function(e,t){if(e){var n=e.props,a=n.value,a=0!==i.length&&-1!==i.indexOf(a);return u().cloneElement(e,{checked:a,key:t,block:n.block||l,onChange:function(){var e=n.value;s.handleCheckBoxChange(e)}})}});return u().createElement("div",o()({className:h()(t,a)},e),n)},e}(s.Component);r.defaultProps={prefixCls:"wt-checkbox-group"},r.propTypes={onChange:t().func,values:t().array,block:t().bool};const l=r;var d=function(t){var n={};return Object.keys(t).forEach(function(e){/^data\-.+$/.test(e)&&(n[e]=t[e])}),n},s=function(e){function t(){return e.apply(this,arguments)||this}return i()(t,e),t.prototype.render=function(){var e=this.props,t=d(e);return u().createElement("label",{className:e.className,title:e.children},u().createElement("div",{className:"checkbox"},u().createElement("input",o()({checked:e.checked,type:"checkbox",name:e.name,onChange:e.onChange,disabled:e.disabled},t)),u().createElement("div",{className:"checkbox-body"}))," ",u().createElement("span",null,e.children))},t}(s.Component);s.defaultProps={className:"",name:"",checked:!1,disabled:!1,onChange:function(e){return e}}},72305:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var a=n(49064),r=n.n(a),t=n(85354),i=n.n(t),a=n(67294),h=n.n(a),t=n(93913),s=n.n(t),d=n(85151);const l=function(t){function e(e){var n=t.call(this,e)||this;return n.handleClear=function(e){var t=n.state.list;t.forEach(function(e){return e.sel=!1}),n.setState({list:t},function(e){return n.commitUserSel()})},n.hoverDropToggle=function(e){var t;e?(t=setTimeout(function(){n.setState({open:e,timeout:null})},100),n.setState({timeout:t})):(clearTimeout(n.state.timeout),n.setState({open:e,timeout:null}))},n.clickDropToggle=function(e){n.setState({open:!n.state.open})},n.stop=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},n.closeDrop=function(e){n.setState({open:!1})},n.state={list:JSON.parse(JSON.stringify(e.list||[])),searchKeyWords:"",open:!1,timeout:""},n}i()(e,t);var n=e.prototype;return n.search=function(){this.setState({searchKeyWords:this.refs.searchInput.value})},n.handleChecked=function(t){var n=this,e=this.state.list;this.props.singleSel?e.forEach(function(e){e.sel=e.id===t}):e.forEach(function(e){e.id===t&&(e.sel=!e.sel)}),this.setState({list:e},function(e){return n.commitUserSel()})},n.handleCheckedAll=function(){var t=this,n=!this.checkedAll,e=this.state.list;e.forEach(function(e){return e.sel=n}),this.setState({list:e},function(e){return t.commitUserSel()})},n.commitUserSel=function(){this.props.onSel(this.selList)},n.UNSAFE_componentWillReceiveProps=function(t,e){var n;(t.list||t.value)&&((n=JSON.parse(JSON.stringify(t.list))).forEach(function(e){e.sel=-1!==t.value.indexOf(e.id)}),this.setState({list:n}))},n.componentDidMount=function(){var e,t=this;this.props.value&&((e=JSON.parse(JSON.stringify(this.state.list))).forEach(function(e){e.sel=-1!==t.props.value.indexOf(e.id)}),this.setState({list:e}))},n.render=function(){var n=this,e=this.props,t=e.classNames,a=e.style,s=e.title,r=e.selectPosition,i=e.special,l=e.singleSel,o=this.state,c=o.list,u=o.searchKeyWords,e=o.open,o=0<u.length?this.searchList:c,c=c.find(function(e){return n.props.list.value===e.id});return h().createElement("div",{className:(t||"")+" back-search-select-wrap",onClick:function(e){n.stop(e)},style:a,onMouseEnter:function(){n.hoverDropToggle(!0)},onMouseLeave:function(){n.hoverDropToggle(!1)}},h().createElement("div",{className:e?"open sel-wrap":"sel-wrap"},h().createElement("div",{className:"span-wrap"},h().createElement("span",{className:"title"},s+(i?"":" : ")),!i&&(0<this.selList.length?this.selList.map(function(e,t){return h().createElement("span",{key:t},e.name,t===n.selList.length-1?"":" ,")}):h().createElement("span",null,l&&c?c.name:"全部"))),h().createElement("i",{className:"icon-cem_pull-down-or-take-up"})),e&&h().createElement("div",{className:"allSelContent",style:{left:"left"===r?"0":"",right:"right"===r?"0":""}},h().createElement("div",{className:"search"},h().createElement("p",null,h().createElement("input",{value:u,placeholder:"请输入搜索关键词",ref:"searchInput",type:"text",onChange:function(e){return n.search()}})),h().createElement("p",null,h().createElement("span",{onClick:function(e){return n.handleClear()}},"清除已选项目"))),0<o.length?h().createElement("div",{className:"all"},!l&&u.length<1&&h().createElement(d.Jg,{checked:this.checkedAll,indeterminate:this.indeterminate,onChange:function(){return n.handleCheckedAll()},block:!0},"全选"),o.map(function(e){return n.props.singleSel?h().createElement("p",{className:e.sel?"singleSel sel":"singleSel",key:e.id,onClick:function(){return n.handleChecked(e.id)}},e.name):h().createElement(d.Jg,{key:e.id,value:e.id,checked:e.sel,onChange:function(){return n.handleChecked(e.id)},block:!0},e.name)})):h().createElement("div",{className:"all"},"无选项")))},s()(e,[{key:"selList",get:function(){return this.state.list.filter(function(e,t){return e.sel})}},{key:"checkedAll",get:function(){return this.state.list.every(function(e){return e.sel})}},{key:"indeterminate",get:function(){return!this.checkedAll&&this.state.list.some(function(e){return e.sel})}},{key:"searchList",get:function(){var t=this;return this.state.list.filter(function(e){if(-1!==e.name.toLocaleLowerCase().indexOf(t.state.searchKeyWords.trim().toLocaleLowerCase()))return!0})}}]),e}(a.Component);var o=function(s){function e(){for(var t,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(t=s.call.apply(s,[this].concat(n))||this).state={filterList:[],inputVal:""},t.inputChange=function(e){t.setState({inputVal:e.target.value})},t.keywordChange=function(e){},t}i()(e,s);var t=e.prototype;return t.handleSel=function(t,n){var e=this.props,a=e.list,e=e.onChange;a.forEach(function(e){e.name===t&&(e.value=n.map(function(e){return e.id}))}),e(a)},t.UNSAFE_componentWillReceiveProps=function(e,t){e&&this.setState({filterList:e.list})},t.componentDidMount=function(){},t.buildHeaderFilter=function(){var n=this;r()(this.props);var e=this.state,e=(e.inputVal,e.filterList);return h().createElement("div",{className:"back-end-filter"},e.map(function(e,t){return h().createElement(l,{key:t,list:e&&e.list,value:e.value||[],onSel:n.handleSel.bind(n,e.name),title:e.name,singleSel:e.singleSel})}))},t.render=function(){return this.buildHeaderFilter()},e}(a.Component)}}]);