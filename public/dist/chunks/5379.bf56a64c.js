(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[5379],{1145:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var t=n(67154),m=n.n(t),t=n(85354),a=n.n(t),t=n(67294),g=n.n(t),v=n(2271),o=n(43036),y=n(92360),r=n(8201),l=n(39432),c=n(61409),t=n(30381),s=n.n(t);const i=function(n){function e(e){var t=n.call(this,e)||this;return t._handleOnFilter=function(){var e=t.state.show;t.setState({show:!e})},t.state={oriData:"",columns:[],prefixColumns:[{label:"",width:16,fixed:"left"}],columnRenders:{},headerRenders:{},entryName:"",visible:!1,show:!1},t}return a()(e,n),e.getDerivedStateFromProps=function(a,e){if((0,r.P)(a.data)&&JSON.stringify(e.oriData)!==JSON.stringify(a.data)){var t=[{label:a.type+"词条",prop:"name",width:110,fixed:"",checked:!0},{label:"词条状态",prop:"from",width:80,fixed:"",checked:!0},{label:"SKU词条数量",prop:"skuCount",width:80,fixed:"",checked:!0},{label:"最新修改时间",prop:"updatedAt",width:80,fixed:"",checked:!0},{label:"操作",prop:"control",width:120,fixed:"right",checked:!0}],i="SPU"===a.type?t:t.filter(function(e){return"skuCount"!==e.prop}),e={name:function(e){return g().createElement("span",{title:e.name},e.name)},skuCount:function(e){return g().createElement("span",{style:{color:"#0847A6",cursor:"pointer"},onClick:function(){c.mW.push({pathname:"/account/project/base/sku",state:{spuId:e.id,spuName:e.name}})}},(0,l.hE)(e.skuCount))},updatedAt:function(e){return s()(e.updatedAt).format("YYYY-MM-DD HH:mm")},control:function(e,t,n){return"云听"!==e.from&&g().createElement(g().Fragment,null,g().createElement("span",{style:{marginRight:12},className:"col-control",onClick:function(){a.onEdit(e,"edit")}},"修改"),g().createElement("span",{style:{marginRight:12},className:"col-control",onClick:function(){a.onEdit(e,"copy")}},"复制"),g().createElement("span",{className:"col-control",onClick:function(){return a.onClickDelete(e)}},"删除"))}},t={from:function(e){return g().createElement(g().Fragment,null,"词条状态",g().createElement(o.Z,{placement:"top",overlay:g().createElement("div",{style:{maxWidth:212}},"「词条状态」标识该词条的是否为当前项目创建，如果词条被系统收录，则状态由“当前项目”转变为“云听”")},g().createElement("span",{style:{marginLeft:4,color:"#979797"}},g().createElement("i",{className:"icon-cem_file1"}))))}};return a.data&&a.data.forEach(function(t,e){var n;t.config&&(0===e&&(n=[],Object.keys(JSON.parse(t.config)).forEach(function(t){n.some(function(e){return e.title===t})||n.push({label:t,prop:t,width:80,fixed:"",checked:!0})}),i.splice.apply(i,[1,0].concat(n))),Object.keys(JSON.parse(t.config)).forEach(function(e){t[e]=g().createElement("span",{title:JSON.parse(t.config)[e].join("|")},JSON.parse(t.config)[e].join("|"))}))}),{columns:i,columnRenders:e,headerRenders:t}}return null},e.prototype.render=function(){var e=this.props,t=e.type,n=e.data,a=e.total,i=e.pageIndex,o=e.pageSize,r=e.onPageChange,l=e.onPageSizeChange,c=(e.onEdit,e.entryVisible),s=e.entryName,u=e.onCancel,p=e.onDelete,d=this.state,f=d.prefixColumns,h=d.columns,e=d.columnRenders,d=d.headerRenders;return g().createElement(g().Fragment,null,g().createElement(v.Z,m()({},this.props,{data:n,prefixColumns:f,columns:h,columnRenders:e,headerRenders:d,savedKey:"SKU"===t?"product_setting_base_sku":"product_setting_base_spu",onPageChange:r,onPageSizeChange:l,pageIndex:i,pageSize:o,total:a})),g().createElement(y.Dialog,{className:"yt_product_setting_ignore_dialog_wrapper",size:"tiny",visible:c,title:"确定删除词条「"+s+"」词条？",closeOnClickModal:!1,onCancel:u},g().createElement(y.Dialog.Body,null,"如果有商品链接使用了此条词条，则相应的主题值会被重置，重置时，如果系统程序无法匹配新的词条，则相应的主题值会按“（空白）”进行标记"),g().createElement(y.Dialog.Footer,null,g().createElement(y.Button,{onClick:u},"取消"),g().createElement(y.Button,{type:"primary",onClick:p},"确定"))))},e}(g().PureComponent)},35535:(e,t,n)=>{"use strict";n.d(t,{Z:()=>C});var a=n(37316),i=n.n(a),o=n(67154),r=n.n(o),t=n(85354),l=n.n(t),a=n(67294),d=n.n(a),o=n(55609),f=n(92360),p=n(19335),c=n(35303),h=n(35239),m=n(5133),t=n(30381),s=n.n(t),n=n(64396),u=n.Z.product.setting.base.entryDrawer,g=n.Z.product.setting.base.spu,v=n.Z.product.setting.base.sku,y={visible:!1,isCopy:!1,copy:!1,isChange:!1,id:"",topicList:[],spuId:0,type:"",spuName:"",keyCode:0},a=function(t){function e(e){var p=t.call(this,e)||this;return p.show=function(e){var t=e.type,n=e.spuId,a=e.spuName,i=e.id,o=e.copy;p.setState({visible:!0,spuId:n,type:t,spuName:a}),p.props.fetchTopic({type:t,valueFrom:h.t.get(h.V.curProject).id}).then(function(e){2e4===e.code&&p.setState({topicList:e.result.topicList},function(){i?p.props.fetchTopicValue({id:i}).then(function(e){2e4===e.code&&p.setState({isCopy:o,copy:o,id:i})}):e.result.topicList.forEach(function(e,t){var n;p.props.editTopic(((n={index:t})["value"+t]="MULTI"===e.valueCheckbox?[]:void 0,n["title"+t]="(空白)",n))})})})},p.onClose=function(){p.setState(r()({},Object.assign({},y))),p.state.topicList.forEach(function(e,t){var n;p.props.editTopic(((n={index:t})["value"+t]="MULTI"===e.valueCheckbox?[]:void 0,n["title"+t]="(空白)",n))})},p.renderItem=function(t,n){return"MULTI"===t.valueCheckbox?d().createElement(c.RS,{multiple:!0,tags:!0,onChange:function(e){p._handleOnMultiSelectChange(e,n,t)},value:p.props["value"+n]&&p.props["value"+n].length?p.props["title"+n]:[],optionLabelProp:"label",optionFilterProp:"label",placeholder:"请选择或者输入"},t.list.filter(function(e){return"(空白)"!==e.name}).map(function(e){return d().createElement(c.Wx,{key:e.id,value:e.name,label:e.name},e.name)})):"SINGLE"===t.valueCheckbox?"DATE"===t.valueType?d().createElement(f.DatePicker,{type:"calendar",value:p.props["value"+n]?new Date(p.props["title"+n][0]):null,placeholder:"请选择日期",onChange:function(e){p._handleOnDateChange(s()(e).format("YYYY-MM-DD"),n,t)}}):d().createElement(c.RS,{tags:!0,multiple:!1,onChange:function(e){p._handleOnSelectChange(e,n,t)},value:p.props["value"+n]?p.props["title"+n][0]:[],optionLabelProp:"label",optionFilterProp:"label",placeholder:"请选择或者输入"},t.list.filter(function(e){return"(空白)"!==e.name}).map(function(e){return d().createElement(c.Wx,{key:e.id,value:e.name,label:e.name},e.name)})):null},p._handleOnDateChange=function(n,a,e){var t;p.setState({isChange:n!==p.props["oriTitle"+a]}),"Invalid date"!==n&&n&&!e.list.find(function(e){return e.name===n})?p.props.fetchAddTopic({ytIndustryTopicId:e.id,value:n}).then(function(e){var t;2e4===e.code&&p.props.editTopic(((t={index:a})["value"+a]=[e.result],t["title"+a]=[n],t))}):"Invalid date"!==n&&p.props.editTopic(((t={index:a})["value"+a]=[e.list.find(function(e){return e.name===n}).id],t["title"+a]=[n],t))},p._handleOnAdd=function(n,a,i,o){setTimeout(function(){n&&p.state.keyCode&&13===p.state.keyCode&&p.props.fetchAddTopic({ytIndustryTopicId:n.id,value:a}).then(function(e){var t;2e4===e.code&&(p.setState({keyCode:0}),p.props.editTopic(((t={index:i})["value"+i]="MULTI"===n.valueCheckbox?[].concat(n.list.filter(function(e){return-1<o.indexOf(e.name)}).map(function(e){return e.id}),[e.result]):[e.result],t["title"+i]="MULTI"===n.valueCheckbox?o:[a],t)))})},0)},p._handleOnMultiSelectChange=function(n,a,i){var e;p.setState({isChange:n!==p.props["oriTitle"+a]}),n&&n.length&&n.forEach(function(t){var e;i.list.find(function(e){return e.name===t})?p.props.editTopic(((e={index:a})["value"+a]=i.list.filter(function(e){return-1<n.indexOf(e.name)}).map(function(e){return e.id}),e["title"+a]=i.list.filter(function(e){return-1<n.indexOf(e.name)}).map(function(e){return e.name}),e)):p._handleOnAdd(i,t,a,n)}),n.length||p.props.editTopic(((e={index:a})["value"+a]=[],e["title"+a]=["空白"],e))},p._handleOnSelectChange=function(n,a,i){var e;p.setState({isChange:n[n.length-1]!==p.props["oriTitle"+a]}),n&&n.length&&n.forEach(function(t){var e;i.list.find(function(e){return e.name===t})?p.props.editTopic(((e={index:a})["value"+a]=[i.list.find(function(e){return e.name===t}).id],e["title"+a]=[t],e)):p._handleOnAdd(i,t,a,n)}),n.length||p.props.editTopic(((e={index:a})["value"+a]=void 0,e["title"+a]=["空白"],e))},p._handleOnCopy=function(e){p.setState({isCopy:e})},p._handleOnEnter=function(e){13===e.keyCode&&e.target.className&&p.setState({keyCode:e.keyCode})},p.onOk=function(){var e=p.state,a=e.type,i=e.isCopy,o=e.copy,r=e.isChange,l=e.id,c=e.topicList,s=e.spuId,u=p.props.compose;c.forEach(function(e,t){var n;p.props["value"+t]&&p.props["value"+t].length||p.props.editTopic(((n={index:t})["value"+t]=[e.list.find(function(e){return e.name.includes("(空白)")}).id],n["title"+t]=["(空白)"],n))}),setTimeout(function(){var t,e=""+[].concat(c.map(function(e,t){return-1<u.indexOf(String(e.id))&&p.props["title"+t]})).filter(function(e){return!1!==e}).join(""),n=[].concat(c.map(function(e,t){return{topicId:e.id,topicValueIds:p.props["value"+t],topic:e.name,topicValues:p.props["title"+t]}}));n.every(function(e){return e.topicValues===["(空白)"]})?m.Z.error("主题值不能全为(空白)"):((t={})[a.toLocaleLowerCase()+"Name"]=e.replaceAll(" ",""),l?o?r?p.props.fetchAdd({name:e,configList:n,spuId:s,callback:function(){p.props["fetch"+a+"List"]({pageIndex:1,type:a}),i?p.setState({id:""}):p.onClose()}}).then(function(e){2e4===e.data.code&&(t[a.toLocaleLowerCase()+"Id"]=e.data.result,h.t.set(h.V.newEntry,t))}):m.Z.error("词条已存在"):p.props.fetchAdd({id:l,name:e,configList:n,spuId:s,callback:function(){p.props["fetch"+a+"List"]({pageIndex:1,type:a}),i?p.setState({id:""}):p.onClose()}}).then(function(e){2e4===e.data.code&&h.t.set(h.V.newEntry,t)}):p.props.fetchAdd({name:e,configList:n,spuId:s,callback:function(){p.props["fetch"+a+"List"]({pageIndex:1,type:a}),i||p.onClose()}}).then(function(e){2e4===e.data.code&&(t[a.toLocaleLowerCase()+"Id"]=e.data.result,h.t.set(h.V.newEntry,t))}))},0)},p.state=r()({},Object.assign({},y)),p.event={},p}l()(e,t);var n=e.prototype;return n.componentDidUpdate=function(e,t){var n=this.props.topicList,a=this.state.topicList;n&&JSON.stringify(n)!==JSON.stringify(a)&&this.setState({topicList:n})},n.componentDidMount=function(){window.addEventListener("keydown",this._handleOnEnter)},n.componentWillUnmount=function(){window.removeEventListener("keydown",this._handleOnEnter)},n.render=function(){var n=this,e=this.state,t=e.type,a=e.visible,i=e.isCopy,o=e.id,r=e.copy,l=e.topicList,c=e.spuName,s=this.props,e=s.split,u=s.compose,s=s.loading,c="SPU"===t?"SPU词条":"「"+c+"」的SKU词条";return d().createElement(p.Z,{className:"yt_product_subscribe_entry_drawer_wrapper",width:527,closeable:!0,title:(o&&!r?"SPU"===t?"修改":"编辑":"SPU"===t?"申请创建":"新建")+c,visible:a,maskClosable:!0,placement:"right",onClose:this.onClose,footer:d().createElement("div",{className:"entry_drawer_footer"},d().createElement(f.Checkbox,{checked:i,onChange:function(e){n.setState({isCopy:e})}},"复制新建另一个"),d().createElement(f.Button,{onClick:this.onClose},"取消"),d().createElement(f.Button,{type:"primary",onClick:this.onOk},"确定"))},d().createElement(f.Loading,{loading:s,style:{height:"100%"}},d().createElement("div",{className:"top"},d().createElement("span",null,t,"词条"),d().createElement("span",{dangerouslySetInnerHTML:{__html:""+[].concat(l.map(function(e,t){return-1<u.indexOf(String(e.id))&&n.props["title"+t]})).filter(function(e){return!1!==e}).join(" "===e?"&nbsp;":e)}})),d().createElement("h4",null,"主题值"),d().createElement("div",{className:"topic_list_content"},l.map(function(e,t){return d().createElement("div",{className:"item",key:e.id},d().createElement("div",{className:"title "+(-1<u.indexOf(String(e.id))?"isRequired":"")},e.name),n.renderItem(e,t))}))))},e}(a.PureComponent);const C=(0,o.connect)(function(e){var t=e.loading,e=i()(e,["loading"]);return r()({},e[u],{loading:t.effects[u+"/fetchTopicValue"]||t.effects[u+"/fetchTopic"]||!1})},function(t){return{fetchTopic:function(e){return t({type:u+"/fetchTopic",payload:e})},fetchTopicValue:function(e){return t({type:u+"/fetchTopicValue",payload:e})},editTopic:function(e){return t({type:u+"/editTopic",payload:e})},fetchAdd:function(e){return t({type:u+"/fetchAdd",payload:e})},fetchSPUList:function(e){return t({type:g+"/fetchList",payload:e})},fetchSKUList:function(e){return t({type:v+"/fetchList",payload:e})},fetchAddTopic:function(e){return t({type:u+"/fetchAddTopic",payload:e})}}},null,{withRef:!0})(a)},61918:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var t=n(67294),u=n.n(t),t=n(45697),n=n.n(t),t=function(e){var t=e.className,n=e.onClear,a=e.onSearch,i=e.placeholder,o=e.style,r=e.defValue,l=e.signal,e=u().useState(r),c=e[0],s=e[1];u().useEffect(function(){s(r)},[r,l]);return u().createElement("div",{style:o,className:"yt_search_input_wrapper "+(t||"")},u().createElement("input",{placeholder:i,value:c,onKeyDown:function(e){13===e.keyCode&&a(c)},onChange:function(e){return s(e.target.value)},autoComplete:"off"}),c&&u().createElement("i",{className:"icon-cem_log-off",onClick:function(){s(""),n&&n("")}}),u().createElement("i",{className:"icon-cem_small-search",onClick:function(){return a(c)}}))};t.propTypes={className:n().string,onSearch:n().func.isRequired,placeholder:n().string,style:n().object,defValue:n().string,signal:n().any,onClear:n().func};const a=t},37841:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var t=n(67294),i=n.n(t),t=n(45697),n=n.n(t),t=function(e){var n=e.activeKey,t=e.options,a=e.onTabClick;return i().createElement("div",{className:"tabs"},t.map(function(e,t){return i().createElement("div",{key:t,className:n===e.value?"active-tab":"",onClick:function(){return n!==e.value&&a(e.value,e)}},e.key||e.label)}))};t.propTypes={activeKey:n().oneOfType([n().string,n().number]),options:n().arrayOf(n().shape({key:n().string,value:n().oneOfType([n().string,n().number])})).isRequired,onTabClick:n().func.isRequired};const a=t},2271:(e,t,n)=>{"use strict";n.d(t,{Z:()=>O});var a=n(37316),d=n.n(a),t=n(67154),f=n.n(t),a=n(93913),i=n.n(a),t=n(85354),o=n.n(t),a=n(23279),r=n.n(a),t=n(67294),h=n.n(t),m=n(92360),s=n(35303),a=n(45697),t=n.n(a),u=[{label:"10项/页",value:10},{label:"20项/页",value:20},{label:"40项/页",value:40},{label:"100项/页",value:100}];const g=function(e){var t=e.onPageChange,n=e.onSizeChange,a=e.total,i=void 0===a?0:a,o=e.pageIndex,r=e.pageSize,l=e.currLength,c=e.layout,a=e.className,e=0===i?0:(o-1)*r+1,l=0===i?0:e+l-1;return 0===i?null:h().createElement("div",{className:"yt-awp-pagination "+(a||"")},h().createElement("span",{className:"total_num"},h().createElement("span",null,e+" - "+l+" "),"项，共",h().createElement("span",null," "+i+" "),"项"),h().createElement("div",{style:{textAlign:"right",float:"right"},className:"new_pagination"},h().createElement(m.Pagination,{small:!0,pageSize:r,currentPage:o,pageCount:Math.ceil(i/r),layout:0===i?"":"prev, pager, next",onCurrentChange:t}),void 0===c||c.includes("sizes")?h().createElement(s.RS,{multiple:!1,tags:!1,showSearch:!1,optionFilterProp:"label",optionLabelProp:"label",animation:"slide-up",dropdownClassName:"custom-pagination-dropdown",value:r||10,onChange:n},u.map(function(e,t){return h().createElement(s.Wx,{key:t,label:e.label,value:e.value},e.label)})):null))};t().propTypes={onPageChange:t().func,onSizeChange:t().func,total:t().number,pageIndex:t().number,pageSize:t().number,currLength:t().number,layout:t().string,className:t().string};var v=n(8201),a=n(48926),l=n.n(a),a=n(87757),c=n.n(a),p=n(36144);function y(){return(y=l()(c().mark(function e(t){var n,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectId,a=t.key,e.abrupt("return",p.h.post("/default/value/find",{projectId:n,key:a}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function C(){return(C=l()(c().mark(function e(t){var n,a,i;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectId,a=t.value,i=t.key,e.abrupt("return",p.h.post("/default/value/update",{projectId:n,key:i,value:a}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}var k=n(39432),b=n(43036),E=n(51474),_=n(87219),a=function(t){function e(e){var s=t.call(this,e)||this;return s._setShowFalse=function(){s.setState({show:!1})},s._handleParentClick=function(e){s.state.show&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},s._handleOnTriggerClick=function(){setTimeout(function(){s.setState({show:!s.state.show})},0)},s._renderOptionItem=function(t,e,n,a,i,o){var r=s.state.maxLabelWidth,l=s.props,c=l.value,l=l.savedKey,c=c.find(function(e){return e.prop===t.prop});return h().createElement("div",{className:"opt_item "+(e?"draggable":""),key:t.prop},e&&h().createElement("i",{className:"icon-cem_move my_handle"}),h().createElement("div",{className:"opt_content",style:{width:r,marginLeft:e?0:12}},h().createElement("div",{className:"item_label",onClick:function(e){e.stopPropagation(),s._handleOnItemClick(t.prop)}},h().createElement("span",{className:"icon_checkbox "+(c&&c.checked?"checkbox_checked":"")}),h().createElement("span",null,t.label)),h().createElement("div",{className:"item_control",style:{display:"product_setting_link"===l?"none":"block"}},h().createElement(b.Z,{placement:"top",overlay:n},h().createElement("span",{onClick:function(e){return a(e,t.prop)}},h().createElement("i",{className:(e?"icon-cem_up":"icon-cem_up-and-down")+" fun_icon_a"}))),h().createElement(b.Z,{placement:"top",overlay:i},h().createElement("span",{onClick:function(e){return o(e,t.prop)},style:{marginLeft:4}},h().createElement("i",{className:"icon-cem_down fun_icon_b"}))))))},s._handleOnItemClick=function(t){var e=s.props,n=e.value,e=e.onChange;e&&e((0,_.ZP)(n,function(e){e=e.find(function(e){return e.prop===t});e&&(e.checked=!e.checked)}))},s._handleOnFilxedLeftClick=function(e,t){e.stopPropagation(),s._handleOnFixedChange(t,"left")},s._handleOnCancelFixedClick=function(e,t){e.stopPropagation(),s._handleOnFixedChange(t,"")},s._handleOnFixedRightClick=function(e,t){e.stopPropagation(),s._handleOnFixedChange(t,"right")},s._handleOnFixedChange=function(t,n){var e=s.props,a=e.value,e=e.onChange;e&&e((0,_.ZP)(a,function(e){e=e.find(function(e){return e.prop===t});e&&(e.fixed=n)}))},s.state={show:!1,value:[],leftOpts:[],normalOpts:[],rightOpts:[],maxLabelWidth:e.value.reduce(function(e,t){return Math.max((0,k.jD)(t.label,14)+56+16+16,e)},0)},s}o()(e,t),e.getDerivedStateFromProps=function(a,e){if(JSON.stringify(a.value)===JSON.stringify(e.value))return null;var t=a.value.reduce(function(e,t){var n=1;return"left"===t.fixed&&(n=0),e[n="right"===t.fixed?2:n].push(a.value.find(function(e){return e.prop===t.prop})),e},[[],[],[]]),n=t[0],e=t[1],t=t[2];return{value:a.value,leftOpts:n,normalOpts:e,rightOpts:t,maxLabelWidth:a.value.reduce(function(e,t){return Math.max((0,k.jD)(t.label,14)+56+16+16,e)},0)}};var n=e.prototype;return n.componentDidMount=function(){var r=this;window.addEventListener("click",this._setShowFalse);var e=document.querySelectorAll("#draggable_zone");e.length&&e.forEach(function(e){E.ZP.create(e,{group:"draggable_zone",animation:150,filter:".undraggable",draggable:".draggable",handle:".my_handle",onEnd:function(e){var t=r.props,n=t.value,a=t.onChange,i=e.newIndex,o=e.oldIndex;i!==o&&(t=n.filter(function(e){return"left"===e.fixed}),e=n.filter(function(e){return"right"===e.fixed}),n=(0,_.ZP)(n.filter(function(e){return!e.fixed}),function(e){var t=e.splice(o,1)[0];e.splice(i,0,t)}),a&&a([].concat(t,n,e)))}})})},n.componentWillUnmount=function(){window.removeEventListener("click",this._setShowFalse)},n.render=function(){var t=this,e=this.state,n=e.show,a=e.leftOpts,i=e.normalOpts,o=e.rightOpts,r=this.props,e=r.className,r=r.title;return h().createElement("div",{className:"yt_columns_selector_wrapper "+(e||""),onClick:this._handleParentClick},h().createElement("div",{className:"trigger "+(n?"sel":""),onClick:this._handleOnTriggerClick},r||"列",h().createElement("i",{className:"icon-cem_arrow-launches",style:{transform:n?"rotate(-180deg)":""}})),h().createElement("div",{className:"options "+(n?"active":"")},0<a.length&&h().createElement(h().Fragment,null,h().createElement("div",{className:"opt_label"},"固定在左侧"),a.map(function(e){return t._renderOptionItem(e,!1,"不固定",t._handleOnCancelFixedClick,"固定在列尾",t._handleOnFixedRightClick)})),(0<a.length||0<o.length)&&h().createElement("div",{className:"opt_label"},"不固定"),h().createElement("div",{id:"draggable_zone",style:{visibility:0<i.length}},i.map(function(e){return t._renderOptionItem(e,!0,"固定在列头",t._handleOnFilxedLeftClick,"固定在列尾",t._handleOnFixedRightClick)})),0<o.length&&h().createElement(h().Fragment,null,h().createElement("div",{className:"opt_label"},"固定在右侧"),o.map(function(e){return t._renderOptionItem(e,!1,"不固定",t._handleOnCancelFixedClick,"固定在列头",t._handleOnFilxedLeftClick)}))))},e}(h().PureComponent);const S=a;a.propTypes={className:t().string,title:t().string,value:t().arrayOf(t().shape({label:t().string,prop:t().string,fixed:t().string,checked:t().bool})),onChange:t().func};var x=n(35239),a=function(t){function e(e){var n=t.call(this,e)||this;return n._handleOnResize=function(){var e=document.querySelector(".yt-listview-wrapper");e&&n.setState({tableWidth:e.clientWidth-5})},n._handleOnColumnsChange=function(e){n.setState({columns:e},function(){n.props.savedKey&&!function(){return C.apply(this,arguments)}({projectId:x.t.get(x.V.curProject).id,key:n.props.savedKey,value:JSON.stringify(e.map(function(e){return{prop:e.prop,checked:e.checked,fixed:e.fixed}}))}).then(function(e){e.data})})},n.handleRoKey=function(e){var t=n.props.rowKeyProp;return t&&e&&e[t]?e[t]:JSON.stringify(e)},n.state={talbeWidth:0,columns:e.columns||[],loadingSave:!0},n}o()(e,t),e.getDerivedStateFromProps=function(e,t){};var n=e.prototype;return n.componentDidMount=function(){var n=this;window.addEventListener("resize",r()(this._handleOnResize,150)),this._handleOnResize();var e=this.props,t=e.savedKey,i=e.columns;t&&!function(){return y.apply(this,arguments)}({projectId:x.t.get(x.V.curProject).id,key:t}).then(function(e){var t,a=e.data;if(2e4===a.code)try{t=i.map(function(t,e){var n=JSON.parse(a.result).filter(function(e){e=e.prop;return t.prop===e});return n&&0<n.length?f()({},t,n[0]):t}).filter(function(e){return e})}catch(e){}finally{n.setState({columns:t||n.state.columns,loadingSave:!1})}})},n.componentWillUnmount=function(){window.removeEventListener("resize",this._handleOnResize)},n.componentDidUpdate=function(e,t){var i=this;JSON.stringify(e.columns)!==JSON.stringify(this.props.columns)&&0<this.props.columns.length&&this.setState({columns:this.props.columns.reduce(function(e,t,n){var a=i.state.columns.findIndex(function(e){e=e.prop;return t.prop===e});return e.splice(-1<a?a:n,0,f()({},t,i.state.columns[a])),e},[]).filter(function(e){return e})})},n.render=function(){var e=this.props,t=e.data,n=e.total,a=void 0===n?0:n,i=e.loading,o=e.savedKey,r=e.pageIndex,l=e.pageSize,c=e.onPageChange,s=e.onPageSizeChange,u=e.className,p=void 0===u?"":u,n=d()(e,["data","total","loading","savedKey","pageIndex","pageSize","onPageChange","onPageSizeChange","className"]),u=this.state,e=u.columns,u=u.loadingSave;return h().createElement(v.Z,{data:t,className:"yt-listview-wrapper "+p,loading:o&&u||i},(0,v.P)(t)&&h().createElement(h().Fragment,null,h().createElement(m.Table,f()({},n,{columns:(o?this:this.props).columns,data:t,rowKey:this.handleRoKey})),c&&h().createElement(g,{onPageChange:c,onSizeChange:s,total:a,currLength:t.length,pageIndex:r,pageSize:l}),o&&h().createElement(S,{className:"column_selector",value:e,savedKey:o,onChange:this._handleOnColumnsChange})))},i()(e,[{key:"columns",get:function(){var t,e=this.state,n=e.tableWidth,a=e.columns,i=this.props,e=i.columnRenders,o=void 0===e?{}:e,e=i.headerRenders,r=void 0===e?{}:e,i=i.prefixColumns,l=0,c=0,s=0,a=[].concat(void 0===i?[]:i,JSON.parse(JSON.stringify(a.filter(function(e){e=e.checked;return void 0===e||e}))));return a.forEach(function(e){s+=e.width,e.fixed?l+=e.width:c+=e.width;var t=o[e.prop];t&&(e.render=t);t=r[e.prop];t&&(e.renderHeader=t)}),s<n&&(t=n-l,a.forEach(function(e){void 0!==e.checked&&!e.checked||e.fixed||(e.width=e.width/c*t)})),a}}]),e}(h().PureComponent);a.propTypes={className:t().string,savedKey:t().string.isRequired,rowKeyProp:t().string,data:t().any.isRequired,total:t().number,fixedHeight:t().bool,loading:t().bool,pageIndex:t().number,pageSize:t().number,onPageChange:t().func,onPageSizeChange:t().func,columnRenders:t().shape(((n={})[t().string]=t().func,n)),headerRenders:t().shape(((n={})[t().string]=t().func,n)),prefixColumns:t().arrayOf(t().shape({label:t().string,prop:t().string,fixed:t().oneOf(["","left","right"]),width:t().number,checked:t().bool})),columns:t().arrayOf(t().shape({label:t().string,prop:t().string,fixed:t().oneOf(["","left","right"]),width:t().number,checked:t().bool})).isRequired};const O=a}}]);