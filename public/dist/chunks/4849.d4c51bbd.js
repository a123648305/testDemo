(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[4849],{19119:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-fefa3a"},14849:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>Q});var n=l(67154),p=l.n(n),a=l(85354),i=l.n(a),r=l(67294),S=l.n(r),o=l(55815);var c=l(37316),s=l.n(c),d=l(55609),u=l(5133),w=l(61918),N=l(92360),m=l(8201),t=l(30381),h=l.n(t),f=l(61409),g="#联系人姓名#";function v(e){var t=e.content,e=e.signName;return S().createElement("div",{className:"yt-nps-sms-template-edit-wrapper"},S().createElement("div",{className:"sms-sample"},S().createElement("div",{className:"sms-outer"},S().createElement("div",null,"【"+e+"】"+t,"。问卷链接：",S().createElement("span",{style:{color:"#0847A6"}},"https://cast.vip/u712sw"),"，退订回T"))))}function y(e){var t=e.title,n=e.content,a=e.signName,e=e.img;return S().createElement("div",{className:"yt-nps-email-template-edit-wrapper"},S().createElement("div",{className:"email-sample"},S().createElement("div",{className:"email-detail"},S().createElement("div",{className:"email-title "+(0===t.length?"hint":"")},t||"请输入邮件名称"),S().createElement("div",{className:"email-contact"},S().createElement("span",null,"客户体验中心"),S().createElement("span",null,"详情")),S().createElement("div",{className:"email-logo"},"客户体验调研",S().createElement("span",null,a)),S().createElement("div",{className:"email-content"},S().createElement("div",{className:0===n.length?"hint":"",dangerouslySetInnerHTML:{__html:'<span style="color: #262626">'+n.replace(/#联系人姓名#/g,"Tony").replace(/ /g,"&nbsp;").replace(/\n/g,"</br>").replace(new RegExp(g,"g"),'<span style="color: #0847A6">'+g+"</span>")+"</span>"}}),S().createElement("div",null,S().createElement("img",{src:e||l(19119),alt:""}),"如果无法正常访问，请访问链接")))))}const E=function(e){var t=e.show,n=e.type,a=e.onClose,l=e.id,e=s()(e,["show","type","onClose","id"]);return S().createElement("div",{className:"research_template_preview_wrap",style:{display:t?"flex":"none"}},"email"===n?S().createElement(y,e):S().createElement(v,e),S().createElement(N.Button,{onClick:a},"关闭"),S().createElement(N.Button,{onClick:function(){return f.mW.push({pathname:"/research/setting/template",query:{type:n.toUpperCase(),id:l}})}},"编辑模板"))};var C=l(2271),x=l(63472);const O=function(e){var t=e.data,a=(e.option.width,e.onClick),n=e.onPageChange,l=e.onPageSizeChange,i=e.pageIndex,r=e.pageSize,o=S().useState(!1),c=o[0],s=o[1],d=S().useState(!1),o=d[0],u=d[1],d={status:function(t){return(x.sl.find(function(e){return e.value===t.status})||{}).title},createdAt:function(e){return h()(e.createdAt).format("YYYY-MM-DD HH:mm")},updatedAt:function(e){return(0,x.Go)(e.updatedAt)},control:function(e,t,n){return S().createElement(S().Fragment,null,S().createElement("span",{style:{marginRight:12},className:"col-control",onClick:function(){s(!0),u(e)}},"预览"),S().createElement("span",{style:{marginRight:12},className:"col-control",onClick:function(){return a(e,"edit")}},"编辑"),S().createElement("span",{className:"col-control",onClick:function(){return a(e,"delete")}},"删除"))}};return S().createElement(m.Z,{className:"yt-nps-email-template-list",data:t},c&&S().createElement(E,{show:c,onClose:function(){return s(!1)},type:"email",title:o.name,id:o.id,content:o.content,signName:o.signatureName,img:o.img}),t&&S().createElement(C.Z,p()({},e,{data:t.result,prefixColumns:[{label:"",width:16,fixed:"left"}],columns:[{label:"模板ID",prop:"templateNumber",width:110,fixed:"",checked:!0},{label:"模板名称",prop:"name",width:110,fixed:"",checked:!0},{label:"状态",prop:"status",width:80,fixed:"",checked:!0},{label:"签名",prop:"signatureName",width:80,fixed:"",checked:!0},{label:"创建时间",prop:"createdAt",width:80,fixed:"",checked:!0},{label:"最新修改",prop:"updatedAt",width:80,fixed:"",checked:!0},{label:"操作",prop:"control",width:120,fixed:"right",checked:!0}],columnRenders:d,savedKey:"RESEARCH_SETTING_EMAIL",onPageChange:n,onPageSizeChange:l,pageIndex:i,pageSize:r,total:t.count})))};const L=function(e){var t=e.data,a=(e.option.width,e.onClick),n=e.onPageChange,l=e.onPageSizeChange,i=e.pageIndex,r=e.pageSize,o=S().useState(!1),c=o[0],s=o[1],d=S().useState(!1),o=d[0],u=d[1],d={status:function(t){return(x.sl.find(function(e){return e.value===t.status})||{}).title},createdAt:function(e){return h()(e.createdAt).format("YYYY-MM-DD HH:mm")},updatedAt:function(e){return(0,x.Go)(e.updatedAt)},control:function(e,t,n){return S().createElement(S().Fragment,null,S().createElement("span",{style:{marginRight:12},className:"col-control",onClick:function(){s(!0),u(e)}},"预览"),S().createElement("span",{style:{marginRight:12},className:"col-control",onClick:function(){return a(e,"edit")}},"编辑"),S().createElement("span",{className:"col-control",onClick:function(){return a(e,"delete")}},"删除"))}};return S().createElement(m.Z,{className:"yt-nps-sms-template-list",data:t},c&&S().createElement(E,{show:c,onClose:function(){return s(!1)},type:"sms",title:o.name,id:o.id,content:o.content,signName:o.signatureName}),t&&S().createElement(C.Z,p()({},e,{data:t.result,prefixColumns:[{label:"",width:16,fixed:"left"}],columns:[{label:"模板ID",prop:"templateNumber",width:110,fixed:"",checked:!0},{label:"模板名称",prop:"name",width:110,fixed:"",checked:!0},{label:"状态",prop:"status",width:80,fixed:"",checked:!0},{label:"签名",prop:"signatureName",width:80,fixed:"",checked:!0},{label:"创建时间",prop:"createdAt",width:80,fixed:"",checked:!0},{label:"最新修改",prop:"updatedAt",width:80,fixed:"",checked:!0},{label:"操作",prop:"control",width:120,fixed:"right",checked:!0}],columnRenders:d,savedKey:"RESEARCH_SETTING_SMS",onPageChange:n,onPageSizeChange:l,pageIndex:i,pageSize:r,total:t.count})))};var b=l(43036);const T=function(e){var t=e.data,a=(e.option.width,e.onClick),n={status:function(e){return t=e,e=x.A0.find(function(e){return e.value===t.status})||{},S().createElement("div",{style:{color:e.color}},S().createElement("span",{style:{paddingRight:5}},e.title),"AUDIT_FAILED"===t.status?S().createElement(b.Z,{placement:"top",overlay:S().createElement("div",{style:{maxWidth:220}},t.remark)},S().createElement("i",{className:e.icon})):S().createElement("i",{className:e.icon}));var t},createdAt:function(e){return h()(e.createdAt).format("YYYY-MM-DD HH:mm")},updatedAt:function(e){return(0,x.Go)(e.updatedAt)},control:function(e,t,n){return S().createElement("div",{style:{display:"flex",justifyContent:"flex-start"}},"AUDIT_FAILED"===e.status?S().createElement("span",{style:{marginRight:12},className:"col-control",onClick:function(){return a(e,"edit")}},"查看失败原因并修改"):"UN_SUBMIT"===e.status?S().createElement("span",{style:{marginRight:12},className:"col-control",onClick:function(){return a(e,"edit")}},"修改"):"",S().createElement("span",{className:"col-control",onClick:function(){return a(e,"delete")}},"删除"))}};return S().createElement(m.Z,{className:"yt-nps-signature-template-list",data:t},t?S().createElement(C.Z,p()({},e,{data:t.result,prefixColumns:[{label:"",width:16,fixed:"left"}],columns:[{label:"签名名称",prop:"signatureName",width:110,fixed:"",checked:!0},{label:"状态",prop:"status",width:80,fixed:"",checked:!0},{label:"创建时间",prop:"createdAt",width:80,fixed:"",checked:!0},{label:"最新修改",prop:"updatedAt",width:80,fixed:"",checked:!0},{label:"操作",prop:"control",width:180,fixed:"right",checked:!0}],columnRenders:n,savedKey:"RESEARCH_SETTING_SIGNATURE"})):null)},I=function(t){function e(e){var n=t.call(this,e)||this;return n.showDialog=function(e){n.state.visible?n.setState({visible:!1,callback:void 0},function(){n.setState(p()({visible:!0},e))}):n.setState(p()({visible:!0},e))},n._handleOnCancel=function(){n.setState({visible:!1,data:void 0,callback:void 0})},n._handleOnConfrim=function(){var e=n.state,t=e.callback,e=e.data;t&&t(e),n.setState({visible:!1,data:void 0,callback:void 0})},n.state={visible:!1,data:void 0,callback:void 0},n}return i()(e,t),e.prototype.render=function(){var e=this.state.visible,t=this.props.title;return S().createElement(N.Dialog,{className:"yt-nps-template-delete-dialog-wrapper",size:"tiny",visible:e,title:t,closeOnClickModal:!1,onCancel:this._handleOnCancel},S().createElement(N.Dialog.Body,null),S().createElement(N.Dialog.Footer,null,S().createElement(N.Button,{onClick:this._handleOnCancel},"取消"),S().createElement(N.Button,{type:"primary",onClick:this._handleOnConfrim},"确定")))},e}(S().PureComponent);var P=l(60496);const D=function(t){function e(e){var n=t.call(this,e)||this;return n.showDialog=function(e){n.state.visible?n.setState({visible:!1,callback:void 0},function(){n.setState(p()({visible:!0},e))}):n.setState(p()({visible:!0},e))},n._handleOnCancel=function(){n.setState({visible:!1,data:void 0,type:void 0,dialogType:void 0,callback:void 0})},n._handleOnConfrim=function(){var e=n.state,t=e.callback,e=e.data;t&&t(e),n.setState({visible:!1,data:void 0,type:void 0,dialogType:void 0,callback:void 0})},n.renderTitle=function(e){return"submit"===e?"确定提交？":"cancel"===e?"确定取消？":"delete"===e?"你无法删除此签名？":void 0},n.renderBody=function(e){return"submit"===e?S().createElement("span",{className:"cd-delete"},"提交后，需要经过相关部门审核。审核通过后，才可使用进行分发"):"cancel"===e?S().createElement("span",{className:"cd-delete"},"变更的内容将不会保存"):"delete"===e?S().createElement("span",{className:"cd-delete"},"此签名有被其他模板引用，请先找到相应模板，替换掉签名之后，再删除。"):void 0},n.state={visible:!1,data:void 0,type:void 0,dialogType:void 0,callback:void 0},n}return i()(e,t),e.prototype.render=function(){var e=this.state,t=e.visible,e=(e.type,e.dialogType);return S().createElement(N.Dialog,{className:"yt-nps-template-delete-dialog-wrapper",size:"tiny",visible:t,title:this.renderTitle(e),closeOnClickModal:!1,onCancel:this._handleOnCancel},S().createElement(N.Dialog.Body,null,this.renderBody(e)),S().createElement(N.Dialog.Footer,null,S().createElement(N.Button,{onClick:this._handleOnCancel},"取消"),S().createElement(N.Button,{type:"primary",onClick:this._handleOnConfrim},"确定")))},e}(S().PureComponent);const k=function(e){var t=e.signatureList,n=e.signatureId,a=e.signatureData,l=e.fetchingSignatureList,i=e.emailData,r=e.emailPageIndex,o=e.emailPageSize,c=e.emailKeyword,s=e.fetchingEmailTemplateList,d=e.smsData,u=e.smsPageIndex,p=e.smsPageSize,m=e.smsKeyword,h=e.fetchingSmsTemplateList,f=e.type,g=e.contentWidth,v=e.onListItemClick,y=e.onSearch,E=e.onTemplateAddClick,C=e.onFilterChange,b=e.getDialogRef,k=e.getDeleteFailRef,_=e.sort,e=e.status,m="email"===f?c:"sms"===f?m:"";return"signature"===f?S().createElement("div",{className:"yt-nps-template-list-wrapper"},S().createElement("div",{className:"template-content",id:"template-content"},S().createElement("div",{className:"template-list"},S().createElement("div",{className:"top clearfix"},S().createElement(N.Button,{type:"primary",onClick:E},"创建签名")),S().createElement("div",{style:{height:"calc(100% - 48px)",overflow:"auto"}},S().createElement(T,{data:a,loading:l,option:{width:g},onClick:v})))),S().createElement(I,{ref:b,title:"确定删除此签名"}),S().createElement(D,{ref:k})):S().createElement("div",{className:"yt-nps-template-list-wrapper"},S().createElement("div",{className:"template-content",id:"template-content"},S().createElement("div",{className:"template-list"},S().createElement("div",{className:"top"},S().createElement(w.Z,{signal:f,onSearch:function(e){var t;return y(((t={})["email"===f?"emailKeyword":"smsKeyword"]=e,t))},placeholder:"搜索模板名称",defValue:m,style:{width:180}}),S().createElement(P.Z,{onChange:function(e){y({status:e})},activeObj:e,options:x.sl,type:"button",divider:"none",preTitle:"状态",sufIcon:"icon-cem_pull-down-or-take-up"}),S().createElement(P.Z,{onChange:function(e){y({sort:e})},activeObj:_,options:x.fS,type:"button",divider:"none",preTitle:"排序",sufIcon:"icon-cem_pull-down-or-take-up"}),S().createElement(P.Z,{onChange:function(e){y({signatureId:e})},activeObj:n,options:t,type:"button",divider:"none",preTitle:"签名",sufIcon:"icon-cem_pull-down-or-take-up"}),S().createElement(N.Button,{type:"primary",onClick:E},"创建模板")),S().createElement("div",{style:{height:"calc(100% - 48px)",overflow:"auto"}},"email"===f?S().createElement(O,{data:i,loading:s,option:{width:g},onClick:v,pageIndex:r,pageSize:o,onPageChange:function(e){return C({emailPageIndex:e})},onPageSizeChange:function(e){return C({emailPageSize:e,emailPageIndex:1})}}):S().createElement(L,{data:d,loading:h,option:{width:g},onClick:v,pageIndex:u,pageSize:p,onPageChange:function(e){return C({smsPageIndex:e})},onPageSizeChange:function(e){return C({smsPageSize:e,smsPageIndex:1})}})))),S().createElement(I,{ref:b,title:"确定删除此"+("email"===f?"邮件":"短信")+"模板？"}))};var n=l(64396),_=n.Z.research.npmTemplate,a=function(t){function e(e){var a=t.call(this,e)||this;a._fetchData=function(e){var t=a.state.type;"email"===t?a.props.fetchEmailTemplateList({}):"sms"===t&&a.props.fetchSmsTemplateList({}),a.props.getSignatureList({channel:t})},a._handlOnTemplateAddClick=function(){var e=a.state.type;f.mW.push({pathname:"/research/setting/template",query:{type:e.toUpperCase()}})},a._handleOnFilterChange=function(e){var t=a.state.type;"email"===t?a.props.fetchEmailTemplateList(e):"sms"===t&&a.props.fetchSmsTemplateList(e)},a._handleOnSearch=function(e){var t=a.state.type;a.props.save(e),"email"===t?a.props.fetchEmailTemplateList({}):"sms"===t&&a.props.fetchSmsTemplateList({})},a._handleOnListItemClick=function(e,t){var n=a.state.type;"delete"===t?a.deleteDialogRef.showDialog({data:e,callback:function(e){"SIGNATURE"===n.toUpperCase()?a.props.deleteSignature({signatureId:e.signatureId,channel:n,callback:function(e){e&&u.Z.success("签名删除成功")}}).then(function(e){2e4===e.data.code&&(u.Z.success("签名删除成功"),a.props.getSignatureList({channel:"signature"}))}).catch(function(e){410017===e.data.code&&a.deleteFailRef.showDialog({dialogType:"delete"})}):a.props.deleteTemplate({id:e.id,channel:n,callback:function(e){e&&u.Z.success("模板删除成功")}})}}):"edit"===t&&f.mW.push({pathname:"/research/setting/template",query:{type:n.toUpperCase(),id:e.id},state:{id:e.signatureId,data:e}})};e=e.type;return a.deleteDialogRef=void 0,a.deleteFailRef=void 0,a.state={type:e,contentWidth:0},a.event={onTemplateAddClick:a._handlOnTemplateAddClick,onFilterChange:a._handleOnFilterChange,onSearch:a._handleOnSearch,onListItemClick:a._handleOnListItemClick,getDialogRef:function(e){return a.deleteDialogRef=e},getDeleteFailRef:function(e){return a.deleteFailRef=e}},a}i()(e,t);var n=e.prototype;return n.componentDidMount=function(){this._fetchData()},n.componentWillUnmount=function(){this.props.clear()},n.render=function(){return S().createElement(k,p()({},this.props,this.state,this.event))},e}(S().PureComponent),c=(0,d.connect)(function(e){var t=e.loading,e=s()(e,["loading"]);return p()({},e[_],{fetchingEmailTemplateList:t.effects[_+"/fetchEmailTemplateList"]||!1,fetchingSmsTemplateList:t.effects[_+"/fetchSmsTemplateList"]||!1,fetchingSignatureList:t.effects[_+"/getSignatureList"]||!1})},function(t){return{save:function(e){return t({type:_+"/save",payload:e})},fetchEmailTemplateList:function(e){return t({type:_+"/fetchEmailTemplateList",payload:e})},fetchSmsTemplateList:function(e){return t({type:_+"/fetchSmsTemplateList",payload:e})},deleteTemplate:function(e){return t({type:_+"/deleteTemplate",payload:e})},deleteSignature:function(e){return t({type:_+"/deleteSignature",payload:e})},getSignatureList:function(e){return t({type:_+"/getSignatureList",payload:e})},clear:function(){return t({type:_+"/clear"})}}})(a),t=l(45697),a=l.n(t),t=function(e){function t(){document.querySelector(".setting_dialog")&&document.querySelector(".setting_dialog").remove()}e.value,e.list,e.getValue;return S().createElement("div",{className:"yt_modal_warning_prefer_wrapper"},S().createElement("div",{className:"section"},S().createElement("div",{onClick:function(){t(),setTimeout(function(){return f.mW.push({pathname:"/research/setting/edit",state:{type:"NPS"}})},100)}},S().createElement("p",null,S().createElement("i",{className:"icon-cem_npsboard",style:{marginRight:8}}),"NPS看板"),S().createElement("div",{className:"desc"},"基于「NPS」提供的客户体验价值分析视角，分析抽取问卷中的的NPS题型，含分值题和原因题")),S().createElement("div",{onClick:function(){t(),setTimeout(function(){return f.mW.push({pathname:"/research/setting/edit",state:{type:"SATISFACTION"}})},100)}},S().createElement("p",null,S().createElement("i",{className:"icon-cem_satisfaction-score",style:{marginRight:8}}),"满意度看板"),S().createElement("div",{className:"desc"},"基于「满意度」提供的客户体验价值分析视角，分析抽取问卷中的的满意度题型，含分值题和原因题"))))};const R=t;t.propTypes={value:a().object,getValue:a().func};var A=l(57522);var F=l(35239),t=l(93913),z=l.n(t),Z=(l(61193),l(33722)),M=l(51474);const K=function(t){function e(e){var n=t.call(this,e)||this;return n.showDialog=function(e){n.state.visible?n.setState({visible:!1,callback:void 0},function(){n.setState(p()({visible:!0},e))}):n.setState(p()({visible:!0},e))},n._handleOnCancel=function(){n.setState({visible:!1,data:void 0,type:void 0,callback:void 0})},n._handleOnConfrim=function(){var e=n.state,t=e.callback,e=e.data;t&&t(e),n.setState({visible:!1,data:void 0,type:void 0,callback:void 0})},n.state={visible:!1,data:void 0,type:void 0,callback:void 0},n}return i()(e,t),e.prototype.render=function(){var e=this.state,t=e.visible,e=e.type;return S().createElement(N.Dialog,{className:"yt-nps-template-delete-dialog-wrapper",size:"tiny",visible:t,title:"delete"===e?"确定删除此看板？":"你无权访问此看板？",closeOnClickModal:!1,onCancel:this._handleOnCancel},S().createElement(N.Dialog.Body,null,"delete"===e?"删除此看板后，此看板将从相关用户的菜单中“消失”；但不会删除相关的答卷":"你需要在此看板的「谁能可见」中将自己添加到配置中，这样你就可以去查看该看板"),S().createElement(N.Dialog.Footer,null,S().createElement(N.Button,{onClick:this._handleOnCancel},"取消"),S().createElement(N.Button,{type:"primary",onClick:this._handleOnConfrim},"delete"===e?"确定":"前往配置")))},e}(S().PureComponent);var B={NPS:"NPS看板",SATISFACTION:"满意度看板"},t=function(t){function e(e){var a=t.call(this,e)||this;return a._handleOnControlClick=function(e,t){var n=a.props.boardList;"check"===e?n.some(function(e){return e.id===t.id})?f.mW.push({pathname:"/research/board/"+t.type.toLocaleLowerCase()+"/"+t.id,state:{title:t.name}}):a.deleteRef.showDialog({data:t,type:"edit",callback:function(e){f.mW.push({pathname:"/research/setting/edit",state:{id:e.id}})}}):"edit"===e?f.mW.push({pathname:"/research/setting/edit",state:{id:t.id}}):"delete"===e&&a.deleteRef.showDialog({data:t,type:"delete",callback:function(e){a.props.onDelete({id:e.id})}})},a.dragElm=void 0,a.intervalId=void 0,a.columns=[{label:"看板名称",prop:"name",width:160,fixed:"left",checked:!0},{label:"谁能看见此看板",prop:"authorized",width:200,fixed:"",checked:!0},{label:"看板类型",prop:"type",width:120,fixed:"",checked:!0},{label:"问卷数",prop:"questionnaireCount",width:80,fixed:"",checked:!0},{label:"答题数",prop:"submitCount",width:80,fixed:"",checked:!0},{label:"创建时间",prop:"createdAt",width:180,fixed:"",checked:!0},{label:"最新修改",prop:"updatedAt",width:120,fixed:"",checked:!0},{label:"操作",prop:"control",width:120,fixed:"right",checked:!0}],a.prefixColumns=[{label:"",prop:"handle",width:30,fixed:"left",checked:!0}],a.headerRenders={name:function(e){return S().createElement(S().Fragment,null,"看板名称",S().createElement(b.Z,{placement:"top",overlay:S().createElement("div",null,"拖拽即可对看板在菜单中的顺序进行排序。",S().createElement("div",{style:{marginTop:14,textAlign:"right"}},S().createElement(f.rU,{className:"yt-feedback-read-more",to:"https://www.yuque.com/docs/share/8f6f7e2b-2a9a-4331-94fb-b7ddf51a3e13?# 《看板排序功能说明》",target:"_blank"},"了解更多")))},S().createElement("span",{style:{marginLeft:4}},S().createElement("i",{className:"icon-cem_file1"}))))}},a}i()(e,t);var n=e.prototype;return n.componentDidMount=function(){var l=this;this.intervalId=setInterval(function(){l.dragElm=document.querySelector(".el-table__fixed-body-wrapper tbody"),l.dragElm&&(clearInterval(l.intervalId),M.ZP.create(l.dragElm,{group:"draggable_table",animation:150,draggable:".el-table__row",handle:".handle",onEnd:function(e){var t=l.props,n=t.onRange,a=t.data,t=e.newIndex,e=e.oldIndex;t!==e&&(e=(a=JSON.parse(JSON.stringify(a))).splice(e,1)[0],a.splice(t,0,e),n&&n({dashList:a}))}}))},200)},n.render=function(){var t=this,e=this.props,n=e.className,n=void 0===n?"":n,e=e.data;return S().createElement(S().Fragment,null,S().createElement(C.Z,{className:"yt_research_dashlist_wrapper "+n,data:e,rowKeyProp:"id",prefixColumns:this.prefixColumns,columns:this.columns,headerRenders:this.headerRenders,columnRenders:this.columnRenders,savedKey:"RESEARCH_SETTING_DASHBOARD"}),S().createElement(K,{ref:function(e){return t.deleteRef=e}}))},z()(e,[{key:"columnRenders",get:function(){var a=this;return{handle:function(e,t,n){return S().createElement("i",{className:"icon-cem_move handle",style:{display:a.props.draggable?"block":"none"}})},authorized:function(e,t,n){var a=e.userList,e=e.teamList,a=a.map(function(e){return e.name}).join("，"),e=e.map(function(e){return e.name}).join("，");return S().createElement(S().Fragment,null,a&&S().createElement(b.Z,{placement:"topLeft",overlay:a,overlayClassName:"alert-log-tips"},S().createElement("div",{className:"auth_style"},S().createElement("span",null,"用户 | "),a)),e&&S().createElement(b.Z,{placement:"topLeft",overlay:e,overlayClassName:"alert-log-tips"},S().createElement("div",{className:"auth_style"},S().createElement("span",null,"团队 | "),e)))},type:function(e,t,n){return B[e.type]},createdAt:function(e,t,n){return h()(e.createdAt).format("YYYY-MM-DD HH:mm:ss")},updatedAt:function(e,t,n){return(0,Z.Go)(e.updatedAt)},control:function(e,t,n){return S().createElement("div",{className:"operation_columns"},S().createElement("span",{onClick:function(){return a._handleOnControlClick("check",e)}},"查看"),S().createElement("span",{onClick:function(){return a._handleOnControlClick("edit",e)}},"编辑"),S().createElement("span",{onClick:function(){return a._handleOnControlClick("delete",e)}},"删除"))}}}}]),e}(S().PureComponent);const W=t;t.propTypes={className:a().string,draggable:a().bool,data:a().any,loading:a().bool,onFilterChange:a().func,onRange:a().func,onDelete:a().func,boardList:a().any};var j=l(53754);const U=function(e){var t=e.dashList,n=e.dashTotal,a=e.onFilterChange,l=e.teamList,i=e.onDashCreateClick,r=e.userList,o=e.userOptions,c=e.teamOptions,s=e.dashPageIndex,d=e.dashPageSize,u=e.loading,p=e.onRange,m=e.deleteBoard,e=e.boardList;return S().createElement("div",{className:"yt_research_dashboard_setting_wrapper"},S().createElement("div",{className:"button_zone"},S().createElement("span",null,S().createElement(j.Z,{title:"用户",options:o,value:r,onChange:function(e){return a({userList:e})}}),S().createElement(j.Z,{title:"团队",options:c,value:l,onChange:function(e){return a({teamList:e})}})),S().createElement(b.Z,{placement:"top",overlay:"最多创建10个"},S().createElement(N.Button,{type:"primary",onClick:i,disabled:9<n},"创建看板"))),S().createElement(W,{className:"table_zone",boardList:e,data:t,draggable:!l.length&&!r.length,loading:u,pageIndex:s,pageSize:d,onRange:p,onDelete:m,onFilterChange:a}))};var H=n.Z.research.setting.set,Y=n.Z.public.menu,n=function(n){function e(e){var t=n.call(this,e)||this;return t._handleOnFilterChange=function(e){t.props.fetchDashList(e)},t._handleOnRange=function(e){t.props.save(e),t.props.sortBoard({projectId:F.t.get(F.V.curProject).id}),t.props.fetchMenuList()},t._handleOnDashCreateClick=function(){var a;a={},new Promise(function(e,t){var n=p()({},a,{titleText:"看板类型",content:S().createElement(R,a),top:"50%",noFoot:!0,className:"setting_dialog"});n.onOk=function(){return e()},n.onCancel=t,(0,A.Z)(n)}).then(function(e){})},t.event={onFilterChange:t._handleOnFilterChange,onDashCreateClick:t._handleOnDashCreateClick,onRange:t._handleOnRange},t}i()(e,n);var t=e.prototype;return t.componentDidMount=function(){this.props.fetchTeamList(),this.props.fetchUserList(),this.props.fetchDashList({projectId:F.t.get(F.V.curProject).id})},t.componentWillUnmount=function(){},t.render=function(){return S().createElement(U,p()({},this.props,this.state,this.event))},e}(S().PureComponent),n=(0,d.connect)(function(e){var t=e.loading,n=s()(e,["loading"]),a=n[H],l=a.dashList,i=a.dashTotal,r=a.teamList,o=a.userList,e=a.userOptions,a=a.teamOptions,n=n[Y].menuList.questionnaireBoards;return{dashList:l,dashTotal:i,teamList:r,userList:o,userOptions:e,teamOptions:a,boardList:n&&n[F.t.get(F.V.curProject).id]||[],loading:t.effects[H+"/fetchDashList"]||!1}},function(t){return{fetchDashList:function(e){return t({type:H+"/fetchDashList",payload:e})},fetchTeamList:function(e){return t({type:H+"/fetchTeamList",payload:e})},fetchUserList:function(e){return t({type:H+"/fetchUserList",payload:e})},deleteBoard:function(e){return t({type:H+"/deleteBoard",payload:e})},sortBoard:function(e){return t({type:H+"/sortBoard",payload:e})},fetchMenuList:function(e){return t({type:Y+"/fetchMenuList",payload:e})},save:function(e){return t({type:H+"/save",payload:e})}}})(n);const q={TemplateSmsList:S().createElement(c,{type:"sms"}),TemplateEmailList:S().createElement(c,{type:"email"}),TemplateSignatureList:S().createElement(c,{type:"signature"}),Dashboard:S().createElement(n,null)};var J=[{name:"看板设置",com:"Dashboard"},{name:"短信签名",com:"TemplateSignatureList"},{name:"短信模板",com:"TemplateSmsList"},{name:"邮件模板",com:"TemplateEmailList"}];const G=function(e){var t=e.defaultType,e=S().useState(t&&J.find(function(e){return e.com===t})?J.find(function(e){return e.com===t}):J[0]),n=e[0],a=e[1];return S().createElement("div",{className:"research_setting"},S().createElement(o.Z,{title:[{title:"配置"},{title:n.name||" . "}]}),S().createElement("div",{className:"setting_wrap"},S().createElement("div",{className:"left"},J.map(function(e){return S().createElement("div",{className:(n.com===e.com?"sel":"")+" item",key:e.com,onClick:function(){a({}),setTimeout(function(){return a(e)},0)}},e.name)})),S().createElement("div",{className:"right"},q[n.com]||null)))};var V=l(39432);const Q=function(a){function e(e){var t=a.call(this,e)||this,e=t.props.location.state,n="";switch((0,V.O8)(window.location.search).type){case"sms":n="TemplateSmsList";break;case"email":n="TemplateEmailList";break;case"signature":n="TemplateSignatureList"}return e&&e.type&&F.t.get("typeKey","session")&&(n=e.type),t.state={defaultType:n},t._event={},t}i()(e,a);var t=e.prototype;return t.componentDidMount=function(){F.t.set("typeKey",!1,"session")},t.componentWillUnmount=function(){F.t.set("typeKey",!0,"session")},t.render=function(){return S().createElement(G,p()({},this.state,this.props,this._event))},e}(r.Component)},61918:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var t=n(67294),d=n.n(t),t=n(45697),n=n.n(t),t=function(e){var t=e.className,n=e.onClear,a=e.onSearch,l=e.placeholder,i=e.style,r=e.defValue,o=e.signal,e=d().useState(r),c=e[0],s=e[1];d().useEffect(function(){s(r)},[r,o]);return d().createElement("div",{style:i,className:"yt_search_input_wrapper "+(t||"")},d().createElement("input",{placeholder:l,value:c,onKeyDown:function(e){13===e.keyCode&&a(c)},onChange:function(e){return s(e.target.value)},autoComplete:"off"}),c&&d().createElement("i",{className:"icon-cem_log-off",onClick:function(){s(""),n&&n("")}}),d().createElement("i",{className:"icon-cem_small-search",onClick:function(){return a(c)}}))};t.propTypes={className:n().string,onSearch:n().func.isRequired,placeholder:n().string,style:n().object,defValue:n().string,signal:n().any,onClear:n().func};const a=t},2271:(e,t,n)=>{"use strict";n.d(t,{Z:()=>N});var a=n(37316),p=n.n(a),t=n(67154),m=n.n(t),a=n(93913),l=n.n(a),t=n(85354),i=n.n(t),a=n(23279),r=n.n(a),t=n(67294),h=n.n(t),f=n(92360),s=n(35303),a=n(45697),t=n.n(a),d=[{label:"10项/页",value:10},{label:"20项/页",value:20},{label:"40项/页",value:40},{label:"100项/页",value:100}];const g=function(e){var t=e.onPageChange,n=e.onSizeChange,a=e.total,l=void 0===a?0:a,i=e.pageIndex,r=e.pageSize,o=e.currLength,c=e.layout,a=e.className,e=0===l?0:(i-1)*r+1,o=0===l?0:e+o-1;return 0===l?null:h().createElement("div",{className:"yt-awp-pagination "+(a||"")},h().createElement("span",{className:"total_num"},h().createElement("span",null,e+" - "+o+" "),"项，共",h().createElement("span",null," "+l+" "),"项"),h().createElement("div",{style:{textAlign:"right",float:"right"},className:"new_pagination"},h().createElement(f.Pagination,{small:!0,pageSize:r,currentPage:i,pageCount:Math.ceil(l/r),layout:0===l?"":"prev, pager, next",onCurrentChange:t}),void 0===c||c.includes("sizes")?h().createElement(s.RS,{multiple:!1,tags:!1,showSearch:!1,optionFilterProp:"label",optionLabelProp:"label",animation:"slide-up",dropdownClassName:"custom-pagination-dropdown",value:r||10,onChange:n},d.map(function(e,t){return h().createElement(s.Wx,{key:t,label:e.label,value:e.value},e.label)})):null))};t().propTypes={onPageChange:t().func,onSizeChange:t().func,total:t().number,pageIndex:t().number,pageSize:t().number,currLength:t().number,layout:t().string,className:t().string};var v=n(8201),a=n(48926),o=n.n(a),a=n(87757),c=n.n(a),u=n(36144);function y(){return(y=o()(c().mark(function e(t){var n,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectId,a=t.key,e.abrupt("return",u.h.post("/default/value/find",{projectId:n,key:a}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function E(){return(E=o()(c().mark(function e(t){var n,a,l;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectId,a=t.value,l=t.key,e.abrupt("return",u.h.post("/default/value/update",{projectId:n,key:l,value:a}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}var C=n(39432),b=n(43036),k=n(51474),_=n(87219),a=function(t){function e(e){var s=t.call(this,e)||this;return s._setShowFalse=function(){s.setState({show:!1})},s._handleParentClick=function(e){s.state.show&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},s._handleOnTriggerClick=function(){setTimeout(function(){s.setState({show:!s.state.show})},0)},s._renderOptionItem=function(t,e,n,a,l,i){var r=s.state.maxLabelWidth,o=s.props,c=o.value,o=o.savedKey,c=c.find(function(e){return e.prop===t.prop});return h().createElement("div",{className:"opt_item "+(e?"draggable":""),key:t.prop},e&&h().createElement("i",{className:"icon-cem_move my_handle"}),h().createElement("div",{className:"opt_content",style:{width:r,marginLeft:e?0:12}},h().createElement("div",{className:"item_label",onClick:function(e){e.stopPropagation(),s._handleOnItemClick(t.prop)}},h().createElement("span",{className:"icon_checkbox "+(c&&c.checked?"checkbox_checked":"")}),h().createElement("span",null,t.label)),h().createElement("div",{className:"item_control",style:{display:"product_setting_link"===o?"none":"block"}},h().createElement(b.Z,{placement:"top",overlay:n},h().createElement("span",{onClick:function(e){return a(e,t.prop)}},h().createElement("i",{className:(e?"icon-cem_up":"icon-cem_up-and-down")+" fun_icon_a"}))),h().createElement(b.Z,{placement:"top",overlay:l},h().createElement("span",{onClick:function(e){return i(e,t.prop)},style:{marginLeft:4}},h().createElement("i",{className:"icon-cem_down fun_icon_b"}))))))},s._handleOnItemClick=function(t){var e=s.props,n=e.value,e=e.onChange;e&&e((0,_.ZP)(n,function(e){e=e.find(function(e){return e.prop===t});e&&(e.checked=!e.checked)}))},s._handleOnFilxedLeftClick=function(e,t){e.stopPropagation(),s._handleOnFixedChange(t,"left")},s._handleOnCancelFixedClick=function(e,t){e.stopPropagation(),s._handleOnFixedChange(t,"")},s._handleOnFixedRightClick=function(e,t){e.stopPropagation(),s._handleOnFixedChange(t,"right")},s._handleOnFixedChange=function(t,n){var e=s.props,a=e.value,e=e.onChange;e&&e((0,_.ZP)(a,function(e){e=e.find(function(e){return e.prop===t});e&&(e.fixed=n)}))},s.state={show:!1,value:[],leftOpts:[],normalOpts:[],rightOpts:[],maxLabelWidth:e.value.reduce(function(e,t){return Math.max((0,C.jD)(t.label,14)+56+16+16,e)},0)},s}i()(e,t),e.getDerivedStateFromProps=function(a,e){if(JSON.stringify(a.value)===JSON.stringify(e.value))return null;var t=a.value.reduce(function(e,t){var n=1;return"left"===t.fixed&&(n=0),e[n="right"===t.fixed?2:n].push(a.value.find(function(e){return e.prop===t.prop})),e},[[],[],[]]),n=t[0],e=t[1],t=t[2];return{value:a.value,leftOpts:n,normalOpts:e,rightOpts:t,maxLabelWidth:a.value.reduce(function(e,t){return Math.max((0,C.jD)(t.label,14)+56+16+16,e)},0)}};var n=e.prototype;return n.componentDidMount=function(){var r=this;window.addEventListener("click",this._setShowFalse);var e=document.querySelectorAll("#draggable_zone");e.length&&e.forEach(function(e){k.ZP.create(e,{group:"draggable_zone",animation:150,filter:".undraggable",draggable:".draggable",handle:".my_handle",onEnd:function(e){var t=r.props,n=t.value,a=t.onChange,l=e.newIndex,i=e.oldIndex;l!==i&&(t=n.filter(function(e){return"left"===e.fixed}),e=n.filter(function(e){return"right"===e.fixed}),n=(0,_.ZP)(n.filter(function(e){return!e.fixed}),function(e){var t=e.splice(i,1)[0];e.splice(l,0,t)}),a&&a([].concat(t,n,e)))}})})},n.componentWillUnmount=function(){window.removeEventListener("click",this._setShowFalse)},n.render=function(){var t=this,e=this.state,n=e.show,a=e.leftOpts,l=e.normalOpts,i=e.rightOpts,r=this.props,e=r.className,r=r.title;return h().createElement("div",{className:"yt_columns_selector_wrapper "+(e||""),onClick:this._handleParentClick},h().createElement("div",{className:"trigger "+(n?"sel":""),onClick:this._handleOnTriggerClick},r||"列",h().createElement("i",{className:"icon-cem_arrow-launches",style:{transform:n?"rotate(-180deg)":""}})),h().createElement("div",{className:"options "+(n?"active":"")},0<a.length&&h().createElement(h().Fragment,null,h().createElement("div",{className:"opt_label"},"固定在左侧"),a.map(function(e){return t._renderOptionItem(e,!1,"不固定",t._handleOnCancelFixedClick,"固定在列尾",t._handleOnFixedRightClick)})),(0<a.length||0<i.length)&&h().createElement("div",{className:"opt_label"},"不固定"),h().createElement("div",{id:"draggable_zone",style:{visibility:0<l.length}},l.map(function(e){return t._renderOptionItem(e,!0,"固定在列头",t._handleOnFilxedLeftClick,"固定在列尾",t._handleOnFixedRightClick)})),0<i.length&&h().createElement(h().Fragment,null,h().createElement("div",{className:"opt_label"},"固定在右侧"),i.map(function(e){return t._renderOptionItem(e,!1,"不固定",t._handleOnCancelFixedClick,"固定在列头",t._handleOnFilxedLeftClick)}))))},e}(h().PureComponent);const S=a;a.propTypes={className:t().string,title:t().string,value:t().arrayOf(t().shape({label:t().string,prop:t().string,fixed:t().string,checked:t().bool})),onChange:t().func};var w=n(35239),a=function(t){function e(e){var n=t.call(this,e)||this;return n._handleOnResize=function(){var e=document.querySelector(".yt-listview-wrapper");e&&n.setState({tableWidth:e.clientWidth-5})},n._handleOnColumnsChange=function(e){n.setState({columns:e},function(){n.props.savedKey&&!function(){return E.apply(this,arguments)}({projectId:w.t.get(w.V.curProject).id,key:n.props.savedKey,value:JSON.stringify(e.map(function(e){return{prop:e.prop,checked:e.checked,fixed:e.fixed}}))}).then(function(e){e.data})})},n.handleRoKey=function(e){var t=n.props.rowKeyProp;return t&&e&&e[t]?e[t]:JSON.stringify(e)},n.state={talbeWidth:0,columns:e.columns||[],loadingSave:!0},n}i()(e,t),e.getDerivedStateFromProps=function(e,t){};var n=e.prototype;return n.componentDidMount=function(){var n=this;window.addEventListener("resize",r()(this._handleOnResize,150)),this._handleOnResize();var e=this.props,t=e.savedKey,l=e.columns;t&&!function(){return y.apply(this,arguments)}({projectId:w.t.get(w.V.curProject).id,key:t}).then(function(e){var t,a=e.data;if(2e4===a.code)try{t=l.map(function(t,e){var n=JSON.parse(a.result).filter(function(e){e=e.prop;return t.prop===e});return n&&0<n.length?m()({},t,n[0]):t}).filter(function(e){return e})}catch(e){}finally{n.setState({columns:t||n.state.columns,loadingSave:!1})}})},n.componentWillUnmount=function(){window.removeEventListener("resize",this._handleOnResize)},n.componentDidUpdate=function(e,t){var l=this;JSON.stringify(e.columns)!==JSON.stringify(this.props.columns)&&0<this.props.columns.length&&this.setState({columns:this.props.columns.reduce(function(e,t,n){var a=l.state.columns.findIndex(function(e){e=e.prop;return t.prop===e});return e.splice(-1<a?a:n,0,m()({},t,l.state.columns[a])),e},[]).filter(function(e){return e})})},n.render=function(){var e=this.props,t=e.data,n=e.total,a=void 0===n?0:n,l=e.loading,i=e.savedKey,r=e.pageIndex,o=e.pageSize,c=e.onPageChange,s=e.onPageSizeChange,d=e.className,u=void 0===d?"":d,n=p()(e,["data","total","loading","savedKey","pageIndex","pageSize","onPageChange","onPageSizeChange","className"]),d=this.state,e=d.columns,d=d.loadingSave;return h().createElement(v.Z,{data:t,className:"yt-listview-wrapper "+u,loading:i&&d||l},(0,v.P)(t)&&h().createElement(h().Fragment,null,h().createElement(f.Table,m()({},n,{columns:(i?this:this.props).columns,data:t,rowKey:this.handleRoKey})),c&&h().createElement(g,{onPageChange:c,onSizeChange:s,total:a,currLength:t.length,pageIndex:r,pageSize:o}),i&&h().createElement(S,{className:"column_selector",value:e,savedKey:i,onChange:this._handleOnColumnsChange})))},l()(e,[{key:"columns",get:function(){var t,e=this.state,n=e.tableWidth,a=e.columns,l=this.props,e=l.columnRenders,i=void 0===e?{}:e,e=l.headerRenders,r=void 0===e?{}:e,l=l.prefixColumns,o=0,c=0,s=0,a=[].concat(void 0===l?[]:l,JSON.parse(JSON.stringify(a.filter(function(e){e=e.checked;return void 0===e||e}))));return a.forEach(function(e){s+=e.width,e.fixed?o+=e.width:c+=e.width;var t=i[e.prop];t&&(e.render=t);t=r[e.prop];t&&(e.renderHeader=t)}),s<n&&(t=n-o,a.forEach(function(e){void 0!==e.checked&&!e.checked||e.fixed||(e.width=e.width/c*t)})),a}}]),e}(h().PureComponent);a.propTypes={className:t().string,savedKey:t().string.isRequired,rowKeyProp:t().string,data:t().any.isRequired,total:t().number,fixedHeight:t().bool,loading:t().bool,pageIndex:t().number,pageSize:t().number,onPageChange:t().func,onPageSizeChange:t().func,columnRenders:t().shape(((n={})[t().string]=t().func,n)),headerRenders:t().shape(((n={})[t().string]=t().func,n)),prefixColumns:t().arrayOf(t().shape({label:t().string,prop:t().string,fixed:t().oneOf(["","left","right"]),width:t().number,checked:t().bool})),columns:t().arrayOf(t().shape({label:t().string,prop:t().string,fixed:t().oneOf(["","left","right"]),width:t().number,checked:t().bool})).isRequired};const N=a}}]);