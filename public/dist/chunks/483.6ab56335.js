(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[483],{76180:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n=a.p+"html-459a43"},13192:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});const n=a.p+"html-aa245f"},40483:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>S});var a=s(67154),g=s.n(a),t=s(85354),n=s.n(t),a=s(67294),o=s.n(a),l=s(20899),i=s(82817),c=s(40086),m=s(92360),d=s(43036),p=s(31705),u=s(94644),h=[{name:"按天",id:"DAY"},{name:"按周",id:"WEEK"}],f=function(t){function e(e){var r=t.call(this,e)||this;return r.resizeFontSize=function(){var e=.03*r.flexWrapper.offsetWidth;document.getElementById("flexSpan").style.fontSize=e+"px";for(var t=document.getElementsByClassName("category"),a=0;a<t.length;a++)t[a].style.marginRight="4px"},r.resize=function(){r.flexWrapper&&(r.resizeFontSize(),r.bar.resize())},r.switchDateDimension=function(e){r.setState({queryTimeType:e},function(){r.props.onDateDimensionChange(e.id)})},r._handleChartDownload=function(e,t){(0,u._v)(r.bar.chart,e+"-"+t)},r._handleExcelDownload=function(e,t){var a=r.state.data.map(function(e){return[e.date,e.count]});a.splice(0,0,["日期","取值"]),(0,u.aT)([a],e+"-"+t)},r.handleChartClick=function(e){var t=r.state.selectedIndex,a=e.name,n=e.dataIndex,i=r.props,e=i.clickChart,i=i.handleReset;n===t?i():(r.setState({selectedIndex:n},function(){var e=r.getChartOption();r.bar&&r.bar.setChartOption(e)}),e&&e(a))},r.handleResetChart=function(){r.setState({selectedIndex:-1},function(){var e=r.getChartOption();r.bar&&r.bar.setChartOption(e)})},r.state={queryTimeType:h[0],data:[],total:0,average:0,loading:!1,selectedIndex:-1,option:{}},r}n()(e,t);var a=e.prototype;return a.componentDidMount=function(){this.getChartOption()},a.UNSAFE_componentWillReceiveProps=function(e){this.setState(g()({},e))},a.componentDidUpdate=function(e,t){this.flexWrapper&&this.resizeFontSize()},a.formatNum=function(e){return 0<=e&&e<1e3?e:e<1e4?(e/1e3).toFixed(2)+"千":(e/1e4).toFixed(2)+"万"},a.getChartOption=function(){var e=this.state,t=e.data,a=e.selectedIndex;return{title:{text:"数据趋势",textStyle:{fontSize:14}},barMaxWidth:40,barGap:"30%",grid:g()({},i.I.grid,{top:36,left:40}),xAxis:g()({},i.I.xAxis,{data:t.map(function(e){return e.date})}),yAxis:g()({},i.I.yAxis),tooltip:g()({},i.I.tooltip,{formatter:function(e){return e[0].axisValue+"数据<br>"+e[0].marker+" "+e[0].value}}),series:{data:t.map(function(e){return e.count}),type:"bar",itemStyle:{normal:{color:function(e){return-1===a||a===e.dataIndex?"#1574B3":"#D2D2D2"}}}}}},a.render=function(){var t=this,e=this.state,a=e.data,n=e.total,i=e.queryTimeType,r=e.loading,e=("DAY"===i.id?n/30:n/4).toFixed(2);return o().createElement("div",{className:"overviewChartWrapper"},o().createElement(m.Loading,{loading:r,text:"拼命加载中"},r?o().createElement("div",{style:{height:"167px"}}):0<a.length?o().createElement("div",null,o().createElement("div",{className:"detailChart-top",ref:function(e){return t.flexWrapper=e}},o().createElement("div",null,o().createElement("div",null,o().createElement("span",null,"数据总量")),o().createElement("div",{style:{height:"62px"}},o().createElement(d.Z,{placement:"top",overlay:n},o().createElement("span",{id:"flexSpan",style:{fontSize:"50px"}},this.formatNum(n)))),o().createElement("div",null,o().createElement("div",null,o().createElement("span",{className:"category"},"平均值"),o().createElement(d.Z,{placement:"top",overlay:e},o().createElement("span",null,this.formatNum(e)))))),o().createElement("div",{className:"chart-top-wrapper"},o().createElement("div",{className:"time-btn-wrapper"},o().createElement(p.Z,{onDownChartClick:function(){return t._handleChartDownload("数据趋势",i.name)},onDownExcelClick:function(){return t._handleExcelDownload("数据趋势",i.name)}}),o().createElement(c.Z,{style:{float:"right"},list:h,onChange:this.switchDateDimension,value:i,placeholder:i.name,partingLine:!0})),o().createElement(l.Z,{ref:function(e){return t.bar=e},uniqueId:"insight",option:this.getChartOption(),height:167,clickChart:this.handleChartClick})))):o().createElement("div",{className:"noDataTips"},o().createElement("img",{src:s(76180)}),o().createElement("span",null,"暂无可用数据"))))},e}(o().Component),r=s(52314),t=s(30381),v=s.n(t),E=function(t){function e(e){var n=t.call(this,e)||this;return n.handleReset=function(){n.props.handleReset&&n.props.handleReset()},n.renderMsgList=function(e){var t=n.state.loading,a=(document.documentElement.clientWidth-64-36-76-68-24-32-200)/2;return o().createElement(m.Loading,{loading:t,text:"拼命加载中"},o().createElement("div",{className:"message-list"},e.map(function(e,t){return o().createElement("div",{className:"blog-container",key:t},o().createElement(r.X,{className:"blog-title"},o().createElement(r.J,{className:"base-info source"},o().createElement("span",{className:"source-img"},o().createElement("img",{src:e.userImage?e.userImage.startsWith("http")?e.userImage:location.protocol+"//"+e.userImage:s(13192),"data-url":e.userImage,alt:"头像"}))),o().createElement(r.J,{className:"base-info product"},e.username),o().createElement(r.J,{className:"base-info  pull-right"},o().createElement("span",{className:"time"},v()(e.createTime).format("YYYY-MM-DD HH:mm")),o().createElement("span",{className:"type"},e.type))),o().createElement(r.X,{className:"blog-body"},e.content),o().createElement("div",{className:"blog-body message-detail"},o().createElement("span",{className:"title line ellipsis",style:{maxWidth:a},title:e.title},"- "+e.title),o().createElement("div",null,o().createElement("span",{className:"source line ellipsis"},"来源：",e.sourceName),o().createElement("span",{className:"connect line ellipsis",style:{maxWidth:a},title:e.title},"链接：",e.connectionName),o().createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"line ellipsis"},"数据源"))))})))},n.state={pageIndex:1,msgList:[],loading:!1,selectedDate:""},n}n()(e,t);var a=e.prototype;return a.UNSAFE_componentWillReceiveProps=function(e){this.setState(g()({},e))},a.render=function(){var e=this.state,t=e.selectedDate,a=e.msgList,n=e.total,i=e.pageIndex,r=e.pageSize,e=this.props.onPageChange;return o().createElement("div",{className:"message-detail-wrapper"},o().createElement("div",{className:"message-top"},o().createElement("div",{className:"left"},o().createElement("span",{style:{marginLeft:5,fontSize:14}},"消息详情"),t&&o().createElement("div",{style:{display:"inline-block"}},o().createElement("span",null,t),o().createElement("span",{onClick:this.handleReset},"清除选择"))),o().createElement("div",{className:"total"},o().createElement("span",null,"共",o().createElement("i",null," ",n||0," "),"条消息"))),0<n&&this.renderMsgList(a),0<n&&o().createElement("div",{className:"pager-container"},o().createElement(m.Pagination,{pageSize:r,className:"pagination",small:!0,total:n,layout:"prev, pager, next",currentPage:i,onCurrentChange:e})))},e}(a.Component),C=s(12518),y=s(36144);const D=function(){return o().createElement("div",{className:"dividerWrapper"})};var x=s(35239),N="YYYY-MM-DD HH:mm:ss",S=function(t){function e(e){var h=t.call(this,e)||this;return h.fetchData=function(i){var e=x.t.get(x.V.backProjectConfig).id,t=h.state,a=t.id,n=t.type,r=t.msgData,s=t.msgData,o=s.beginDate,l=s.endDate,c=s.pageIndex,m=s.pageSize,d=s.isInitial,s=t.dateGroupType,t=t.selectedDate,p="custom"===n?"/userConfig/invalid/detail/list":"/userConfig/default/detail/list",u="msg"===i&&t?{projectId:e,pageIndex:c,pageSize:m,start:o,end:l,dateHistogramInterval:s}:{projectId:e,pageIndex:c,pageSize:m,end:v()().format(N),start:v()().subtract(29,"days").hour(0).minute(0).second(0).format(N),dateHistogramInterval:s};"custom"===n?u.id=a:u.content=a,h.setState({chartLoading:"msg"!==i,msgListLoading:"chart"!==i},function(){y.h.post(p,g()({},u)).then(function(e){var t=e.data,a=t.code,n=t.result;2e4===a&&n&&(t=(e=n.result).dateCountList,a=e.commentList,n=e.total,"chart"===i?h.setState({chartLoading:!1,chartData:{total:n,data:t||[]}}):"msg"===i?(h.setState({msgListLoading:!1,msgData:g()({},r,{total:n,msgList:a||[],loading:!1})}),d||(e=document.getElementsByClassName("content")&&document.getElementsByClassName("content")[0])&&(e.scrollTop=210)):h.setState({chartLoading:!1,msgListLoading:!1,chartData:{total:n,data:t||[]},msgData:g()({},r,{total:n,msgList:a||[],loading:!1,isInitial:!1})}))})})},h.handleDateDimensionChange=function(e){h.setState({dateGroupType:e},function(){return h.fetchData("chart")})},h.handleChartClick=function(e){var t,a,n,i,r=h.state.msgData,s="YYYY-MM-DD",e=7===e.length?(i=(n=e.split("-"))[0],t=n[1],a=v()(i).week(t),n=v()(a.startOf("week").format(s),s),(i=v()(a.endOf("week").format(s),s)).hour(23).minute(59).second(59),t=n.format(N),a=i.format(N),n.format(s)+" - "+i.format(s)):(a=v()(e,s).add(1,"days").format(N),t=v()(e,s).format(N),e);h.setState({selectedDate:e,msgData:g()({},r,{beginDate:t,endDate:a,pageIndex:1,isInitial:!0})},function(){return h.fetchData("msg")})},h.handleReset=function(){var e=h.state.msgData;h.setState({selectedDate:"",msgData:g()({},e,{pageIndex:1,beginDate:"",endDate:""})},function(){return h.fetchData("msg")}),h.chart&&h.chart.handleResetChart()},h.handlePageChange=function(e){var t=h.state.msgData;h.setState({msgData:g()({},t,{pageIndex:e,isInitial:!1})},function(){return h.fetchData("msg")})},h.state={id:"",type:"custom",dateGroupType:"DAY",chartData:{total:0,data:[]},chartLoading:!1,msgListLoading:!1,msgData:{beginDate:"",endDate:"",pageIndex:1,pageSize:20,total:0,msgList:[],isInitial:!0},selectedDate:""},h}n()(e,t);var a=e.prototype;return a.UNSAFE_componentWillMount=function(){var e=this,t=location.search,a=decodeURIComponent(t).replace(/\"/g,"");a.startsWith("?type")&&(a=(t=a.split("&"))[0],t=t[1],a=a.split("=")[1],t=t.split("=")[1],this.setState({id:t,type:a},function(){return e.fetchData("both")}))},a.render=function(){var t=this,e=this.state,a=e.chartData,n=e.msgData,i=e.chartLoading,r=e.msgListLoading,e=e.selectedDate,i=g()({},a,{loading:i,onDateDimensionChange:this.handleDateDimensionChange,clickChart:this.handleChartClick,handleReset:this.handleReset}),r=g()({},n,{selectedDate:e,loading:r,onPageChange:this.handlePageChange,handleReset:this.handleReset});return o().createElement("div",{className:"useless-msg-detail-wrapper"},o().createElement(C.Z,{title:"近30天无效消息"}),o().createElement("div",{className:"content"},o().createElement(f,g()({ref:function(e){return t.chart=e}},i)),o().createElement(D,null),o().createElement(E,r)))},e}(a.Component)},20899:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(85354),i=a.n(n),t=a(67294),r=a.n(t),n=a(45697),t=a.n(n),n=a(70596),s=a.n(n),o=a(67592),l=function(a){function e(e){var t=a.call(this,e)||this;return t.setChartOption=function(e){t.chart&&t.chart.setOption(e)},t.chart="",t}i()(e,a);var t=e.prototype;return t.componentDidMount=function(){var t=this,e=this.props.uniqueId;this.chart=s().init(document.getElementById(e)),this.chart.on("click",function(e){t.props.clickChart&&t.props.clickChart(e)}),this.setChartOption(this.props.option)},t.UNSAFE_componentWillReceiveProps=function(e){(0,o.d)(this.props.option,e.option)||this.setChartOption(e.option)},t.resize=function(){this.chart.resize()},t.render=function(){var e=this.props,t=e.uniqueId,e=e.height;return r().createElement("div",{className:"barchart-wrapper"},r().createElement("div",{id:t,className:"baseChart",style:{width:"100%",height:e}}))},e}(r().PureComponent);l.propTypes={uniqueId:t().string.isRequired,option:t().object,height:t().number.isRequired,clickChart:t().func}},82817:(e,t,a)=>{"use strict";a.d(t,{I:()=>n,o:()=>i});var n={legend:{data:[],itemWidth:13,itemHeight:13,itemGap:12,right:10,top:0,orient:"vertical"},textStyle:{color:"#262626",fontFamily:"'PingFang SC','Microsoft Yahei', 'Helvetica Neue', Helvetica, Tahoma, Arial, 'Hiragino Sans GB', 'WenQuanYi Micro Hei', sans-serif"},grid:{tooltip:{trigger:"axis"},containLabel:!0,left:30,right:80,bottom:5,top:5,splitLine:{show:!0}},xAxis:{type:"category",axisTick:{show:!1},axisLine:{show:!0,lineStyle:{type:"solid",color:"#E5E5E5"}},axisLabel:{show:!0,color:"#999"},axisPointer:!1,data:[]},yAxis:{type:"value",splitLine:{show:!0,lineStyle:{type:"dotted",color:"#E8E8E8"}},axisTick:{show:!1},axisLine:{show:!1},axisLabel:{show:!1}},tooltip:{trigger:"axis",backgroundColor:"rgba(255,255,255,0.9)",borderWidth:1,borderColor:"#ccc",padding:10,textStyle:{color:"#262626"},extraCssText:"box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);",confine:!0}},i=["#1550B3","#CC6A77","#119073","#CDB446","#D969BF","#2684FF","#C8662B","#9369D9","#0E97AD","#1BBF69","#D07B49","#61799B","#1EA082","#A9A557","#D8727F"]},84948:(e,t,a)=>{"use strict";a.d(t,{Z:()=>m});var n=a(67154),s=a.n(n),i=a(37316),o=a.n(i),t=a(85354),r=a.n(t),n=a(67294),l=a.n(n),i=a(45697),t=a.n(i),i=a(94184),c=a.n(i),t={prefixCls:t().string,col:t().string,fr:t().bool},n=function(e){function t(){return e.apply(this,arguments)||this}return r()(t,e),t.prototype.render=function(){var e=this.props,t=e.children,a=e.className,n=e.prefixCls,i=e.col,r=e.fr,e=o()(e,["children","className","prefixCls","col","fr"]),a=c()(n,i&&i.split(" ").map(function(e){return n+"-"+e}),((i={})[n+"-fr"]=r,i),a);return l().createElement("div",s()({className:a},e),t)},t}(n.Component);n.propTypes=t,n.defaultProps={prefixCls:"wt-col",fr:!1};const m=n},52314:(e,t,a)=>{"use strict";a.d(t,{J:()=>n.Z,X:()=>d});var n=a(84948),i=a(67154),o=a.n(i),r=a(37316),l=a.n(r),t=a(85354),s=a.n(t),i=a(67294),c=a.n(i),r=a(45697),t=a.n(r),r=a(94184),m=a.n(r),t={prefixCls:t().string,row:t().string,fluid:t().bool},i=function(e){function t(){return e.apply(this,arguments)||this}return s()(t,e),t.prototype.render=function(){var e=this.props,t=e.children,a=e.className,n=e.prefixCls,i=e.row,r=e.gutther,s=e.fluid,e=l()(e,["children","className","prefixCls","row","gutther","fluid"]),a=m()(n,i&&i.split(" ").map(function(e){return n+"-"+e}),((i={})[n+"-gutther"]=r,i[n+"-fluid"]=s,i),a);return c().createElement("div",o()({className:a},e),t)},t}(i.Component);i.propTypes=t,i.defaultProps={prefixCls:"wt-row",fluid:!1};const d=i},40086:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var n=a(67154),c=a.n(n),t=a(85354),i=a.n(t),n=a(67294),m=a.n(n),t=a(45697),t=a.n(t),r=function(a){function e(e){var t=a.call(this,e)||this;return t.stop=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},t._setEvent=function(e){return 0===e?{onMouseEnter:function(){t.setState({firstLiHover:!0})},onMouseLeave:function(){t.setState({firstLiHover:!1})}}:{}},t.setShowSelFalse=function(){t.setState({show:!1})},t.state={show:!1,firstSelected:!1},t}i()(e,a);var t=e.prototype;return t.changeShow=function(e){var t=this;this.state.show&&this.stop(e),setTimeout(function(){t.setState({show:!t.state.show})},0)},t.componentDidMount=function(){window.addEventListener("click",this.setShowSelFalse)},t.componentWillUnmount=function(){window.removeEventListener("click",this.setShowSelFalse)},t.render=function(){var a=this,e=this.state.show,t=this.props,n=t.placeholder,i=t.list,r=t.value,s=t.onChange,o=t.style,l=t.partingLine,t=i[0]&&i[0].id===r.id;return m().createElement("div",{className:"chart-select",style:o||{}},m().createElement("div",{className:"select "+(l?"line":""),onClick:function(e){return a.changeShow(e)}},m().createElement("div",{className:"infor "+(e?"sel":"")},m().createElement("span",{className:"placeholder"},n),m().createElement("i",{className:"icon icon-cem_arrow-launches",style:{transform:e?"rotate(-180deg)":"",top:e?"3px":""}}))),e&&m().createElement("div",{className:"position-wrap"},m().createElement("div",{className:"selItem "+(this.state.firstLiHover||t?"selPadHover":""),onClick:function(e){return a.stop(e)}},m().createElement("div",{className:"wrap"},m().createElement("ul",null,0<i.length?i.map(function(e,t){return m().createElement("li",c()({className:e.id===r.id?"sel":"",key:t,onClick:function(){a.setShowSelFalse(),s&&s(e,t)}},a._setEvent(t)),m().createElement("span",null,e.name))}):m().createElement("div",{className:"noData"},"无数据"))))))},e}(n.Component);r.defaultProps={placeholder:"请选择",list:[{name:"周",id:"week"},{name:"月",id:"month"}],value:{}},r.propTypes={placeholder:t().oneOfType([t().string,t().element]),list:t().array,value:t().object,onChange:t().func,style:t().object,partingLine:t().bool}}}]);