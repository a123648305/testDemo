(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[320],{2320:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var n=a(37316),l=a.n(n),r=a(67154),v=a.n(r),c=a(85354),s=a.n(c),i=a(97194),t=a(64396),n=a(55609),o=a(35239),h=a(67294),y=a.n(h),E=(a(30467),a(55673)),_=(a(58136),a(5789)),m=(a(76405),a(69843)),g=(a(1025),a(65400)),C=(a(43378),a(62443)),r=(a(89858),a(51024)),c=a(23493),T=a.n(c),D=r.default.Search;const N=function(e){var a=e.title,t=e.titleTips,n=e.onChange,l=e.data,r=e.onExport,c=(0,h.useState)(""),s=c[0],i=c[1],o=(0,h.useState)(1),e=o[0],u=o[1],c=(0,h.useState)((null==l?void 0:l.result)||[]),o=c[0],f=c[1];(0,h.useEffect)(function(){var e=(null==l?void 0:l.result)||[];f(e.slice(0,10))},[l]);function p(e){if(!e)return"";var t=new Date,a=e.substring(0,19).replace(/-/g,"/").replace(/T/," "),e=new Date(a),n=t.getTime()-e.getTime(),l=864e5;switch(!0){case n<36e5:var r=Math.abs(Math.floor(n/6e4));return r?r+"分钟前":"刚刚";case n<l:return Math.floor(n/36e5)+"小时前";case n<6048e5:return Math.floor(n/l)+"天前";case n<2592e6:return Math.floor(n/6048e5)+"周前";default:return""+a.split(" ")[0]}}var d=(0,h.useCallback)(T()(function(e){n({page:1,pageSize:10,keywords:e})},1e3),[]),c=(0,h.useCallback)(function(e){e=e.target.value;i(e),d(e)},[]);return y().createElement("div",{className:"yt_explore_scene_advice_list"},y().createElement("div",{className:"list_title"},y().createElement("div",{className:"title"},a,t?y().createElement(C.default,{overlayStyle:{maxWidth:350},placement:"top",content:t,overlayClassName:"title_desc_popup"},y().createElement("i",{className:"icon-cem_file1"})):null),y().createElement("div",{className:"search"},y().createElement(D,{placeholder:"请输入关键词",value:s,onChange:c,size:"small",suffix:y().createElement("span",null,y().createElement("i",{className:"icon-cem_small-search",style:{color:"#8c8c8c"}})),allowClear:!0})),y().createElement("div",{className:"btn-warp"},y().createElement(g.default,{className:"export",onClick:function(){return r({keywords:s})}},"导出"))),y().createElement("div",{className:"list_container"},null!=l&&l.count?o.map(function(e,t){return y().createElement("div",{key:t,className:"list_item"},y().createElement("span",{className:"flex-1"},y().createElement("div",{dangerouslySetInnerHTML:{__html:e.name.replace(new RegExp(e.highlightInfo.join("|").replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),function(e,t){return'<span class="match-text">'+e+"</span>"})}})),y().createElement(C.default,{placement:"left",content:"最新建议"===a?"建议数量："+e.count:"第一次提出时间："+p(e.date)},"最新建议"===a?y().createElement("span",{className:"sub_title"},p(e.date)):y().createElement("span",{className:"sub_title"},e.count)))}):y().createElement("div",{className:"empty-block"},"暂无数据")),null!=l&&l.count?y().createElement("div",{className:"list_footer"},y().createElement(m.default,{size:"small",className:"g-pagination",onChange:function(e){var t;t=e,e=(null==l?void 0:l.result)||[],u(t),f(e.slice(10*(t-1),10*t))},showSizeChanger:!1,current:e,pageSize:10,total:null==l?void 0:l.count})):null)};var w=a(48577),F=a(19731);const u=function(e){var t=e.pageType,a=e.dateOptions,n=void 0===a?[]:a,l=e.filterReady,r=e.filterChange,c=e.onFilterChange,s=e.onFlavorChange,i=e.onMsgClick,o=e.trendData,u=e.fetchingTrendData,f=e.timeType,p=e.fTimeType,d=e.hotAdviceData,a=e.newAdviceData,h=e.fetchNewMessage,m=e.fetchHotMessage,g=e.fetchExport;return y().createElement("div",{className:"yt_explore_scene_advice_wrapper"},y().createElement(w.Z,{onReady:l,onChange:r,pageType:t,advanceAuthority:!1,touchData:["电商评论"],selectValue:"电商评论",valueConf:["fullInfo"],showList:["fullDate","screening","save","sourceSearch"],hasHour:!0},y().createElement("div",{className:"content"},y().createElement(F.Z,{data:o,loading:u,timeType:f,fTimeType:p,timeOptions:n,onFilterChange:c,onFlavorChange:s,onMsgClick:i,pageType:t,title:"用户建议数量",graphicText:{text1:"提及用户建议去重后的消息",text2:"用户建议提及消息",text3:"消息总数"},titleOverlay:y().createElement("div",null,y().createElement("p",null,"用户建议提及率 = 提及用户建议的消息数量 ÷ 消息总量"),y().createElement("p",null,"用户建议数量计算说明：如果一条消息中出现一个用户建议就计1，一样的用户建议在一条消息中不重复计数。"))}),y().createElement("div",{className:"table_list"},y().createElement(E.default,{gutter:16},y().createElement(_.default,{span:12},y().createElement(N,{data:a,onExport:function(e){g(v()({},e,{chartType:"scene_aspect_advice_new_count"}))},onChange:function(e){h(e)},title:"最新建议",titleTips:"展示选择时间范围内的建议，按照建议第一次提出时间来 排序，例如2021年1月1日建议“希望价格便宜点”，1周后 又有一样的建议“希望价格便宜点”，那么该建议的第一次 提出时间是2021年1月1日。"})),y().createElement(_.default,{span:12},y().createElement(N,{data:d,onExport:function(e){g(v()({},e,{chartType:"scene_aspect_count"}))},onChange:function(e){m(e)},title:"最热建议"})))))))};var f=t.Z.explore.scene.advice,t=function(t){function e(e){var r=t.call(this,e)||this;return r.events=void 0,r._handleFilterReady=function(e,t){var a=(0,i.X)(e.dateFilter.numOfDays,!0),n=a.dateOptions,a=a.defaultDateType;r.props.fetchParams({projectId:o.t.get(o.V.curProject).id,headerFilterParamsNew:e.headerFilterParamsNew,dateFilter:e.dateFilter,dateOptions:n,defaultDateType:a,filterValues:t.fullInfo.filterValue})},r._handleFilterChange=function(e,t,a){var n=(0,i.X)(e.dateFilter.numOfDays,!0),l=n.dateOptions,n=n.defaultDateType;r.props.fetchDatas(v()({},e,{dateOptions:l,defaultDateType:n,filterValues:t.fullInfo.filterValue}))},r._handleOnFilterChange=function(e){e.timeType&&r.props.fetchTrendData(e)},r._handleOnFlavorChange=function(e){e.fTimeType,r.props.setDefaultValue(e)},r._handleOnMsgClick=function(e){},r.events={filterReady:r._handleFilterReady,filterChange:r._handleFilterChange,onFilterChange:r._handleOnFilterChange,onFlavorChange:r._handleOnFlavorChange,onMsgClick:r._handleOnMsgClick},r}s()(e,t);var a=e.prototype;return a.componentDidMount=function(){},a.componentWillUnmount=function(){this.props.clean()},a.render=function(){return y().createElement(u,v()({},this.props,this.state,this.events))},e}(y().Component);const p=(0,n.connect)(function(e){var t=e.loading,e=l()(e,["loading"]);return v()({},e[f],{fetchingTrendData:t.effects[f+"/fetchTrendData"]||!1})},function(t){return{save:function(e){return t({type:f+"/save",payload:e})},clean:function(){return t({type:f+"/clean"})},setDefaultValue:function(e){return t({type:f+"/setDefaultValue",payload:e})},fetchParams:function(e){return t({type:f+"/fetchParams",payload:e})},fetchDatas:function(e){return t({type:f+"/fetchDatas",payload:e})},fetchTrendData:function(e){return t({type:f+"/fetchTrendData",payload:e})},fetchNewMessage:function(e){return t({type:f+"/fetchNewMessage",payload:e})},fetchHotMessage:function(e){return t({type:f+"/fetchHotMessage",payload:e})},fetchExport:function(e){return t({type:f+"/fetchExport",payload:e})}}})(t)}}]);