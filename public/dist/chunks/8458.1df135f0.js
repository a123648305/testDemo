(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[8458],{41192:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var t=n(67294),o=n.n(t),t=n(45697),t=n.n(t),s=n(33798),c=n(43036),n=function(e){var t=e.chartType,n=e.enable,a=void 0!==n&&n,l=e.options,i=e.notLimitList,r=e.onChange;return o().createElement("div",{className:"yt-chart-type-radio-wrapper"},Object.keys(l).map(function(e){return o().createElement(c.Z,{key:e,placement:"top",overlay:l[e][2]},o().createElement("span",null,o().createElement(s.Z,{enable:!a||i.includes(e),isActive:t===e,defaultIcon:l[e][0],activeIcon:l[e][1],onClick:function(){return!a&&r(e)}})))}))};n.propTypes={chartType:t().string,enable:t().bool,options:t().object,notLimitList:t().array};const a=n},17051:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var u=n(67294),p=n.n(u),t=n(45697),t=n.n(t),d=n(43036),m=n(32283),h=n(92360),f=n(30133),n=function(e){var t=e.type,n=e.titlePrefix,a=e.quantity,l=e.leftSubTitle,i=e.leftContent,r=e.rightSubTitle,o=e.rightContent,s=e.loading,c=e.isInitial,e=document.body.clientWidth<1500;return p().createElement("div",{className:"overview-num-wrapper"},c?p().createElement(f.Z,null):s?p().createElement(h.Loading,{loading:s},p().createElement("div",{style:{height:"252px"}})):p().createElement(u.Fragment,null,p().createElement("div",{className:"overview-num-header"},p().createElement("span",null,n,"会话总量"),1<t&&p().createElement(d.Z,{overlay:["该页面的商品及会话仅对「分析商品」进行统计，不对「对比商品」进行统计","对客户咨询商品时的关注点的累加"][t-2],placement:"top",overlayClassName:"restricted-pop"},p().createElement("i",{className:"icon-cem_file1"}))),p().createElement(u.Fragment,null,p().createElement("div",{className:"overview-num-body"},p().createElement(d.Z,{overlay:a,placement:"top",overlayClassName:"restricted-pop"},p().createElement("span",null,(0,m.ao)(a)))),p().createElement("div",{className:"overview-num-footer"},p().createElement(u.Fragment,null,e?p().createElement(d.Z,{overlay:l,placement:"top",overlayClassName:"restricted-pop"},p().createElement("span",null,l.substring(0,5),"...")):p().createElement("span",null,l),p().createElement(d.Z,{overlay:i,placement:"top",overlayClassName:"restricted-pop"},p().createElement("span",null,(0,m.ao)(i))),p().createElement("span",null,r),p().createElement("span",null,Number.isInteger(o)?(0,m.ao)(o):o+"%"),1<t&&p().createElement(d.Z,{overlay:["当前分析商品会话占所有商品会话的比重","该关注点的会话量÷所有关注点的会话量，即当前分析关注点的会话占所有关注点会话的比重"][t-2],placement:"top",overlayClassName:"restricted-pop"},p().createElement("i",{className:"icon-cem_file1"})))))))};n.propTypes={type:t().number.isRequired,titlePrefix:t().string.isRequired,loading:t().bool.isRequired,isInitial:t().bool.isRequired,quantity:t().number.isRequired,leftSubTitle:t().string.isRequired,leftContent:t().number.isRequired,rightSubTitle:t().string.isRequired,rightContent:t().number.isRequired};const a=n},99543:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var a=n(85354),i=n.n(a),t=n(67294),r=n.n(t),a=n(45697),a=n.n(a),o=n(50976),s=n(31705),c=n(30133),u=n(92360),p=n(94644),d=n(32283),l=function(l){function e(){for(var n,e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(n=l.call.apply(l,[this].concat(t))||this).setOption=function(){var e=n.props,t=e.loading,e=e.data;!t&&0<e.length&&(e={title:{text:n.title,left:0,top:0},tooltip:{triger:"item",formatter:function(e){return e.marker+" "+e.name+"："+e.value+"（"+e.percent+"%）"}},series:[{name:"姓名",type:"pie",radius:75,hoverAnimation:!1,center:["50%","55%"],data:e.map(function(e){return{name:e.source,value:e.docCount}}),label:{position:"outside",color:"#000",formatter:function(e){var t=e.data,e=t.name,t=t.value;return[""+e,"{value|"+(0,d.ao)(t)+"}"].join("\n")},rich:{value:{fontSize:12,lineHeight:18,color:"#8c8c8c",align:"left"}}},labelLine:{length:13,length2:13,lineStyle:{color:"#bfbfbf"}}}]},n.instance.clear(),n.instance.setOption(e))},n.handleDownloadChart=function(){(0,p._v)(n.instance,n.title)},n.handleDownloadExcel=function(e){e=e.map(function(e){return[e.source,e.docCount]});e.splice(0,0,["平台","会话量"]),(0,p.aT)([e],n.title)},n}i()(e,l);var t=e.prototype;return t.componentDidMount=function(){var e=this.props.titlePrefix;this.title=e+"各平台会话量",this.setOption()},t.shouldComponentUpdate=function(e,t){return e.loading!==this.props.loading||(e.titlePrefix!==this.props.titlePrefix||JSON.stringify(e.data)!==JSON.stringify(this.props.data))},t.componentDidUpdate=function(){var e=this.props.titlePrefix;this.title=e+"各平台会话量",this.setOption()},t.render=function(){var t=this,e=this.props,n=e.loading,a=e.isInitial,l=e.data;return a?r().createElement(c.Z,null):n?r().createElement(u.Loading,{loading:n}):0<l.length?r().createElement("div",{className:"overview-pie-wrapper"},r().createElement(o.Z,{theme:"yunting_multi_color",showLoading:n,style:{width:"100%",height:"252px"},option:{},onChartReady:function(e){return t.instance=e}}),r().createElement(s.Z,{onDownChartClick:function(){return t.handleDownloadChart()},onDownExcelClick:function(){return t.handleDownloadExcel(l)}})):r().createElement("div",{className:"overview-pie-empty-wrapper"},r().createElement("div",{className:"empty-block"},"暂无数据"))},e}(t.Component);l.propTypes={titlePrefix:a().string.isRequired,loading:a().bool.isRequired,isInitial:a().bool.isRequired,data:a().arrayOf(a().shape({source:a().string.isRequired,docCount:a().number.isRequired}))}},50196:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var t=n(67294),f=n.n(t),v=n(50976),g=n(60496),y=n(8201),E=n(98191),t=n(67154),S=n.n(t),C=n(39432),N=n(70715),k=[{title:"按天",value:"DAY"},{title:"按周",value:"WEEK"},{title:"按月",value:"MONTH"}],w={aspect:[{title:"关注量",value:"count"},{title:"提及率",value:"rate"}],product:[{title:"会话量",value:"count"},{title:"提及率",value:"rate"}]},b=[{title:"按平台",value:"SOURCE"},{title:"按店铺",value:"SHOP"}],V={c0:["cem_cumulate-colour","cem_cumulate-twocolour","堆积图"],c1:["cem_cumulate","cem_cumulate-col","堆叠图"],c2:["cem_cumulate-alone","cem_cumulate-alone-col","总量图"]},x=n(41192),O=n(43036),_={product:"提及率=该商品的会话量÷所有商品的会话量总和",aspect:"提及率=该关注点的关注量÷所有关注点的关注量总和"};const a=function(e){var t=e.title,o=e.data,s=e.onMoreClick,n=e.loading,a=e.timeType,l=e.onFilterChange,i=e.platformType,r=e.pageType,e=f().useState(void 0),c=e[0],u=e[1],e=f().useState(null),p=e[0],d=e[1],e=f().useState("count"),m=e[0],h=e[1];return f().useEffect(function(){var e;c&&((0,y.P)(o)?(e=function(e,t,n,a,l){var o="rate"===a,i=o?1:"all"===n?2:0,r=S()({},e.dataset[i],{sourceHeader:!1}),e=Array.from({length:"all"===n?1:e.length}),s=l-426,c=t;if(s<(0,C.jD)(t,14))for(var u=0,p=t.length;u<p;u++)if(c=t.substring(0,p-1-(u+1)),(0,C.jD)(c+"...",12)<=s){c+="...";break}return{title:{text:c,textStyle:{width:l-426}},grid:{left:40,right:44,top:95,bottom:36,containLabel:!0},dataset:r,tooltip:{trigger:"axis",enterable:!0,confine:!0,extraCssText:"max-height: 320px; overflow: auto; min-width: 180px; ",appendToBody:!0,axisPointer:{type:"line"},formatter:function(r){return r.reduce(function(e,t,n){var a=t.encode,l=t.marker,i=t.seriesName,a=t.value[a.y[0]],a=o?0===a?"0%":(100*a).toFixed(2)+"%":a;return n===r.length-1?[].concat(e,[l+" "+i+"："+a,"日期："+r[0].name]):[].concat(e,[l+" "+i+"："+a])},[o?"提及率":"会话量"]).join("<br/>")}},legend:{top:50,left:16,itemWidth:16,itemHeight:16,icon:N.W4.lineRing},xAxis:{type:"category",boundaryGap:!1,axisTick:{show:!0},axisLabel:{show:!0}},yAxis:{axisTick:{show:!0,alignWithLabel:!0},axisLabel:{showMinLabel:!1,showMaxLabel:"rate"===a,formatter:function(e){return"rate"===a?(100*e).toFixed(0)+"%":e}}},series:e.map(function(){return{type:"line",stack:n,seriesLayoutBy:"row",symbol:1===r.source[0].length?"circle":"none",areaStyle:{opacity:.1}}})}}(o,o.title,p,m,c.getWidth()),c.clear(),c.setOption(e)):u(void 0))},[o,c,p,m]),f().createElement(y.Z,{data:o,className:"yt-trend-line-chart-wrapper",renderTitle:f().createElement(E.Z,{data:o,onMoreClick:function(e){return t=c,a=o,l=s,r=void 0,"image"===(n=e)?r=t:"data"===n&&(a=(e=a.dataset[0]).dimensions,e=e.source,i=JSON.parse(JSON.stringify(e)),a.forEach(function(e,t){i[t].splice(0,0,e)}),r=[i]),void l({type:n,obj:r,name:t.getOption().title[0].text});var t,n,a,l,i,r},title:t},f().createElement(g.Z,{onChange:function(e){"SHOP"===e.trendPlatformType&&null!==p&&d(null),l(e)},objName:"trendPlatformType",activeObj:i,options:b}),"overview"!==r&&f().createElement("div",{className:"hint-button"},f().createElement(g.Z,{onChange:function(e){e=e.sType;"rate"===e&&null!==p&&d(null),h(e)},objName:"sType",activeObj:m,options:w[r]}),"rate"===m&&f().createElement(O.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:_[r]},f().createElement("i",{className:"icon-cem_file1 hine"}))),f().createElement(g.Z,{onChange:l,objName:"trendTimeType",activeObj:a,options:k}),f().createElement(x.Z,{onChange:function(e){d("c0"===e?null:"c1"===e?"stack":"all")},chartType:null===p?"c0":"stack"===p?"c1":"c2",options:V,enable:"rate"===m,notLimitList:["c0"]}))},f().createElement(v.Z,{theme:"yunting_multi_color",showLoading:n,loadingOption:{text:"",color:"#20a0ff"},option:{},style:{width:"100%",height:"100%"},onChartReady:function(e){return u(e)}}))}},22120:(e,t,n)=>{"use strict";n.d(t,{R:()=>a});var a=[{id:"ENTRANCE_URL",name:"入口链接"},{id:"SESSION",name:"会话中"}]},24473:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var a=n(67154),p=n.n(a),l=n(37316),d=n.n(l),t=n(85354),i=n.n(t),a=n(67294),m=n.n(a),l=n(45697),t=n.n(l),l=n(94184),h=n.n(l),a=function(e){function t(){return e.apply(this,arguments)||this}return i()(t,e),t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.children,a=e.className,l=e.block,i=e.indeterminate,r=e.value,o=e.checked,s=e.defaultChecked,c=e.onChange,u=e.disabled,e=d()(e,["prefixCls","children","className","block","indeterminate","value","checked","defaultChecked","onChange","disabled"]),c={value:r,checked:o,defaultChecked:s,onChange:c,disabled:u},a=h()(t,((u={})[t+"-disabled"]=c.disabled,u[t+"-block"]=l,u[t+"-indeterminate"]=i,u),a);return m().createElement("label",p()({tabIndex:c.disabled?-1:0,className:a},e),m().createElement("input",p()({type:"checkbox",className:t+"-input"},c)),m().createElement("span",{className:t+"-status"}),n&&m().createElement("span",{className:t+"-text",title:n},n))},t}(a.Component);a.propTypes={prefixCls:t().string,value:t().oneOfType([t().string,t().number]),checked:t().bool,defaultChecked:t().bool,onChange:t().func,indeterminate:t().bool,disabled:t().bool,block:t().bool},a.defaultProps={prefixCls:"wt-checkbox"};const r=a},85151:(e,t,n)=>{"use strict";n.d(t,{Jg:()=>a.Z,CS:()=>o});var a=n(24473),l=n(67154),s=n.n(l),i=n(37316),c=n.n(i),t=n(85354),r=n.n(t),l=n(67294),u=n.n(l),i=n(45697),t=n.n(i),i=n(94184),p=n.n(i),i=function(l){function e(){for(var n,e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(n=l.call.apply(l,[this].concat(t))||this).handleCheckBoxChange=function(e){var t=n.props.onChange;t&&t(e)},n}return r()(e,l),e.prototype.render=function(){var l=this,e=this.props,t=e.prefixCls,n=e.children,a=e.className,i=(e.onChange,e.values),r=e.checkedList,o=e.block,e=c()(e,["prefixCls","children","className","onChange","values","checkedList","block"]),n=i?i.map(function(e,t){var n=0!==r.length&&-1!==r.indexOf(e);return u().createElement(Checkbox,{key:t,value:e,checked:n,onChange:function(e){return l.handleCheckBoxChange(e)},block:o},e)}):u().Children.map(n,function(e,t){if(e){var n=e.props,a=n.value,a=0!==r.length&&-1!==r.indexOf(a);return u().cloneElement(e,{checked:a,key:t,block:n.block||o,onChange:function(){var e=n.value;l.handleCheckBoxChange(e)}})}});return u().createElement("div",s()({className:p()(t,a)},e),n)},e}(l.Component);i.defaultProps={prefixCls:"wt-checkbox-group"},i.propTypes={onChange:t().func,values:t().array,block:t().bool};const o=i;var d=function(t){var n={};return Object.keys(t).forEach(function(e){/^data\-.+$/.test(e)&&(n[e]=t[e])}),n},l=function(e){function t(){return e.apply(this,arguments)||this}return r()(t,e),t.prototype.render=function(){var e=this.props,t=d(e);return u().createElement("label",{className:e.className,title:e.children},u().createElement("div",{className:"checkbox"},u().createElement("input",s()({checked:e.checked,type:"checkbox",name:e.name,onChange:e.onChange,disabled:e.disabled},t)),u().createElement("div",{className:"checkbox-body"}))," ",u().createElement("span",null,e.children))},t}(l.Component);l.defaultProps={className:"",name:"",checked:!1,disabled:!1,onChange:function(e){return e}}},25022:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var t=n(67294),c=n.n(t),u=n(92360),p=n(35303),t=n(45697),t=n.n(t),d=[{label:"10项/页",value:10},{label:"20项/页",value:20},{label:"40项/页",value:40},{label:"100项/页",value:100}];const a=function(e){var t=e.onPageChange,n=e.onSizeChange,a=e.total,l=void 0===a?0:a,i=e.pageIndex,r=e.pageSize,o=e.layout,s=e.className,a=e.currLength,e=0===l?0:(i-1)*r+1,a=0===l?0:a?e+a-1:e+r-1;return 0===l?null:c().createElement("div",{className:"yt-awp-pagination "+(s||"")},c().createElement("span",{className:"total_num"},c().createElement("span",null,e+" - "+a+" "),"项，共",c().createElement("span",null," "+l+" "),"项"),c().createElement("div",{style:{textAlign:"right",float:"right"},className:"new_pagination"},c().createElement(u.Pagination,{small:!0,pageSize:r,currentPage:i,pageCount:Math.ceil(l/r),layout:0===l?"":"prev, pager, next",onCurrentChange:t}),void 0===o||o.includes("sizes")?c().createElement(p.RS,{multiple:!1,tags:!1,showSearch:!1,optionFilterProp:"label",optionLabelProp:"label",animation:"slide-up",dropdownClassName:"custom-pagination-dropdown",value:r||10,onChange:n},d.map(function(e,t){return c().createElement(p.Wx,{key:t,label:e.label,value:e.value},e.label)})):null))};t().propTypes={onPageChange:t().func,onSizeChange:t().func,total:t().number,pageIndex:t().number,pageSize:t().number,layout:t().string,className:t().string}},71339:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var t=n(67294),p=n.n(t),d=n(92360),m=n(25022),t=n(45697),n=n.n(t),t=function(e){var t=e.data,n=e.total,a=void 0===n?0:n,l=e.loading,i=e.pageIndex,r=e.columns,o=e.pageSize,s=e.onPageChange,n=e.onPageSizeChange,c=e.onSortChange,u=e.defaultSort,e=e.className,e=void 0===e?"":e;return p().useEffect(function(){var e=document.getElementsByClassName("is-sortable")[0];u&&e&&e.classList.add(u.order)},[u]),p().createElement("div",{className:"yt-awp-content-list "+e},p().createElement(d.Loading,{loading:l,className:"awp-content-loading"},p().createElement(d.Table,{defaultSort:u,columns:r,style:{width:"100%"},data:t,onSortChange:function(e){return c(e)}})),s&&p().createElement(m.Z,{onPageChange:s,onSizeChange:n,total:a,currLength:t.length,pageIndex:i,pageSize:o}))};t.propTypes={data:n().array,total:n().number,loading:n().bool,pageIndex:n().number,columns:n().array,pageSize:n().number,onPageChange:n().func,onPageSizeChange:n().func,onSortChange:n().func,defaultSort:n().any,className:n().string};const a=t},67641:(e,t,n)=>{"use strict";n.d(t,{Z:()=>j});var a=n(37316),l=n.n(a),i=n(67154),f=n.n(i),t=n(85354),r=n.n(t),a=n(67294),v=n.n(a),i=n(45697),t=n.n(i),i=n(93913),o=n.n(i),g=n(92360);const s=function(e){function t(){return e.apply(this,arguments)||this}return r()(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.onConfirm,a=t.onCancel,t=t.style;return v().createElement("div",{className:"bottom_bar",style:t||{}},v().createElement("ul",{className:"handle"},0<this.props.screeningValues.filter(function(e){return"aspect"!==e.id&&"product"!==e.id}).length&&v().createElement("li",null,v().createElement("span",{className:"clear",onClick:function(){return e.props.clearAllValues()}},"清空选项"))),v().createElement(g.Button,{type:"primary",onClick:function(){n&&n()}},"查询"),v().createElement(g.Button,{onClick:function(){a&&a()}},"取消"))},t}(v().PureComponent);var h=n(85151),y=n(43036),c=function(t){function e(e){var r=t.call(this,e)||this;return r.handleCheckedAll=function(e){var t,n=r.props,a=n.data,l=n.changeState,i=n.allListLength,n=r.state.checkedList;a=100<i?(t=a.slice(0,100).map(function(e){return e.id}),e.target.checked?Array.from(new Set(t.concat(n))):n.filter(function(e){return!t.includes(e)})):e.target.checked?a.map(function(e){return e.id}):[],r.setState({newCheckedList:a}),l&&l(a,r.props.secondValue)},r.handleChange=function(e){Array.prototype.remove=function(e){e=this.indexOf(e);-1<e&&this.splice(e,1)};var t=r.state.checkedList,n=r.props.changeState;-1===t.indexOf(e)?t.push(e):t.remove(e),r.setState({checkedList:t}),n&&n(t,r.props.secondValue)},r.handleSecondChange=function(t,n){var e=r.props,a=(e.data,e.secondValue),e=e.changeState;Array.prototype.remove=function(e){e=this.indexOf(e);-1<e&&this.splice(e,1)},a.some(function(e){return e.id===t&&(-1<e.values.indexOf(n)?e.values.remove(n):e.values.push(n),!0)})||a.push({id:t,values:[n]}),e&&e(r.props.checkedList,a.filter(function(e){return 0<e.values.length}))},r.competeOpen=function(){45<r.checkBox.offsetHeight?r.setState({showOpen:!0}):r.setState({showOpen:!1})},r.renderSecondList=function(e){var t=r.props,l=t.secondValue,n=t.secondInfo,t=r.state,a=t.showSecond,i=t.searchKeywords;return v().createElement("div",{className:"second-list"},v().createElement("span",{className:"name",onClick:function(e){return r.setState({showSecond:!a})}},v().createElement("i",{className:a?"icon-cem_data-collection":"icon-cem_unfolding-data"}),v().createElement("span",null,n.name)),a&&e.filter(function(e){return-1!==e.name.toLowerCase().indexOf(i.toLowerCase())}).map(function(n,e){var a=0<l.filter(function(e){return e.id===n.id}).length?l.filter(function(e){return e.id===n.id})[0].values:[];return v().createElement("div",{key:e,className:"second-wrap"},v().createElement("span",{className:"title-second"},n.name),v().createElement("div",{className:"check-wrap"},n.child.map(function(e,t){return v().createElement(h.Jg,{className:"checkbox-yt",onChange:function(){return r.handleSecondChange(n.id,e.id)},key:e.id,value:e.id,checked:-1!==a.indexOf(e.id)},e.name)})))}))},r.state={checkedList:e.checkedList||[],open:!1,showOpen:!1,showSecond:!0,searchKeywords:e.searchKeywords},r}r()(e,t);var n=e.prototype;return n.UNSAFE_componentWillReceiveProps=function(e){var t=this;(e.checkedList||e.searchKeywords)&&this.setState({checkedList:e.checkedList,searchKeywords:e.searchKeywords},function(){return t.competeOpen()})},n.componentDidMount=function(){this.competeOpen(),window.addEventListener("resize",this.competeOpen)},n.componentWillUnmount=function(){window.removeEventListener("resize",this.competeOpen)},n.render=function(){var t=this,e=this.state,n=e.checkedList,a=e.open,l=e.showOpen,i=e.searchKeywords,r=this.props,o=r.data,s=r.categoryTitle,c=r.title,u=r.close,p=r.onSearch,d=o.map(function(e){return e.id}),m=n.filter(function(e){return 0<=d.indexOf(e)}),e=!!m.length&&o.slice(0,100).every(function(e){return n.includes(e.id)}),r=!e&&!!m.length&&o.slice(0,100).some(function(e){return n.includes(e.id)}),m=o.filter(function(e){return n.includes(e.id)&&e.child&&0<e.child.length});return v().createElement("div",{className:"checkbox-panel-yt"},v().createElement("span",{className:"title"},c,p&&v().createElement(y.Z,{overlay:"按主题值搜索",placement:"top"},v().createElement("i",{className:"icon-cem_search search",onClick:function(e){return p()}}))),v().createElement(h.Jg,{className:"check-all",checked:e,indeterminate:r,onChange:this.handleCheckedAll,disabled:this.props.disabled},s||"全选"),v().createElement("div",{className:"all-checkbox",style:{height:a?"":"38px"}},v().createElement("span",{className:"more"},l&&v().createElement("i",{className:"open",onClick:function(e){return t.setState({open:!a})}},a?"收起":"更多",v().createElement("i",{className:a?"icon-cem_pull-or-take-up":"icon-cem_pull-down-or-take-up"})),u&&v().createElement("i",{className:"close",onClick:u},"×")),v().createElement("div",{className:"check-box",ref:function(e){return t.checkBox=e}},o&&o.filter(function(e){return!i||-1!==e.name.toLowerCase().indexOf(i.toLowerCase())}).slice(0,100).map(function(e){return v().createElement(h.Jg,{className:"checkbox-yt",onChange:function(){return t.handleChange(e.id)},key:e.id,value:e.id,checked:-1!==n.indexOf(e.id),disabled:t.props.disabled},e.name)}),o&&100<o.length&&v().createElement("div",{className:"tip"},"— 该数值展示不会超过",100,"条,需要查看更多请搜索"))),0<m.length&&this.renderSecondList(m))},e}(a.Component);c.propTypes={checkedList:t().array,secondInfo:t().array,secondValue:t().array,data:t().array,allListLength:t().oneOfType([t().number,t().string]),changeState:t().func,searchKeywords:t().string,onSearch:t().func,title:t().oneOfType([t().number,t().string]),close:t().func};var u=function(t){function e(e){var n=t.call(this,e)||this;return n.handleChange=function(e){var t=n.props.changeState;t&&t(e)},n.competeOpen=function(){45<n.checkBox.offsetHeight?n.setState({showOpen:!0}):n.setState({showOpen:!1})},n.state={open:!1,showOpen:!1,showSecond:!0},n}r()(e,t);var n=e.prototype;return n.UNSAFE_componentWillReceiveProps=function(e){var t=this;(e.checkedList||e.searchKeywords)&&this.setState({checkedList:e.checkedList},function(){return t.competeOpen()})},n.componentDidMount=function(){this.competeOpen(),window.addEventListener("resize",this.competeOpen)},n.componentWillUnmount=function(){window.removeEventListener("resize",this.competeOpen)},n.render=function(){var t=this,e=this.state,n=e.open,a=e.showOpen,l=this.props,i=l.data,r=l.title,e=l.close;l.onSearch;return v().createElement("div",{className:"radio-panel-yt-header"},v().createElement("span",{className:"title"},r),v().createElement("div",{className:"all-radio",style:{height:n?"":"38px",marginLeft:"-24px"}},v().createElement("span",{className:"more"},a&&v().createElement("i",{className:"open",onClick:function(e){return t.setState({open:!n})}},n?"收起":"更多",v().createElement("i",{className:n?"icon-cem_pull-or-take-up":"icon-cem_pull-down-or-take-up"})),e&&v().createElement("i",{className:"close",onClick:e},"×")),v().createElement("div",{className:"check-box",ref:function(e){return t.checkBox=e}},v().createElement(g.Radio.Group,{value:this.props.value,onChange:function(e){t.handleChange(e)}},i&&i.map(function(e){return v().createElement(g.Radio,{className:"checkbox-yt",key:e.id,value:e.id},e.name)})))))},e}(a.Component);u.propTypes={value:t().string,data:t().array,changeState:t().func,searchKeywords:t().string,onSearch:t().func,title:t().oneOfType([t().number,t().string]),close:t().func};var p=n(36144),d=n(35239),m=function(t){function e(e){var n=t.call(this,e)||this;return n._setEvent=function(e){return 0===e?{onMouseEnter:function(){n.setState({firstLiHover:!0})},onMouseLeave:function(){n.setState({firstLiHover:!1})}}:{}},n.setDefaultValue=function(){var t=n.getValue();p.h.post("/default/value/update",{projectId:d.t.get(d.V.curProject).id,key:"PRODUCT_ANALYSIS_OBJ",value:JSON.stringify(t)}).then(function(e){n.setState({defaultSelectValue:t,shouldUpdataDefaultSelectValue:!1})})},n.state={options:[{}],sel:[{name:""},{name:""}],defaultSelectValue:n.props.defaultSelectValue,shouldUpdataDefaultSelectValue:!0,value:{},firstLiHover:!1},n}r()(e,t);var n=e.prototype;return n.onSel=function(e,t){var n=this,a=this.state.options;a.forEach(function(e){return e.sel=!1}),a[t].sel=!0,this.setState({options:a},function(e){return n.props.onChange&&n.props.onChange(n.getValue())})},n.getValue=function(){return JSON.parse(JSON.stringify(this.state.options)).filter(function(e){return e.sel})[0]},n.UNSAFE_componentWillReceiveProps=function(e){var t,n;(e.options||e.value)&&(t=JSON.parse(JSON.stringify(e.options)),n=JSON.parse(JSON.stringify(e.value)),t.forEach(function(e){e.id===n.id&&(e.sel=!0)}),this.setState({options:t,value:n}),this.state.shouldUpdataDefaultSelectValue&&this.setState({defaultSelectValue:e.defaultSelectValue}))},n.UNSAFE_componentWillMount=function(){var e=this.props.options,t=this.props.value||{};e.forEach(function(e){e.id===t.id&&(e.sel=!0)}),this.setState({options:e,value:t})},n.componentWillUnmount=function(){},n.render=function(){var n=this,e=this.state,t=e.options,a=e.defaultSelectValue,e=t[0]&&t[0].sel;return v().createElement("div",{className:"selItem "+(this.props.triangle?"triangle":"")+" "+(this.state.firstLiHover||e?"selPadHover":""),onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},v().createElement("div",{className:"wrap"},v().createElement("ul",null,0<t.length?t.map(function(e,t){return v().createElement("li",f()({className:(e.sel?"sel":"")+(e.disable?" disable":""),key:t,onClick:function(e){return n.onSel(e,t)}},n._setEvent(t)),v().createElement("span",null,e.name),!n.props.noCollect&&e.sel&&v().createElement("i",{className:"default icon-cem_star",style:{color:a.id===e.id?"#D5B437":"#8C8C8C",opacity:a.id===e.id?"1":""},onClick:a.id===e.id?null:n.setDefaultValue}),v().createElement("i",{className:"check cem-icon icon-cem_arrow-thick"}))}):v().createElement("div",{className:"noData"},"无数据"))))},e}(a.Component);m.propTypes={noCollect:t().bool,options:t().array,value:t().object,onChange:t().func};var E=n(5133),S=function(e){function t(){var i=e.call(this)||this;return i.sortList=function(e,t,n){n.stopPropagation(),n.nativeEvent.stopImmediatePropagation();var a=JSON.parse(JSON.stringify(i.state.value)),l=a.splice(e,1)[0];switch(t){case"top":a.unshift(l);break;case"up":a.splice(e-1,0,l);break;case"down":a.splice(e+1,0,l)}i.setState({value:a},function(e){return i.props.onChange&&i.props.onChange(i.getValue())})},i._setEvent=function(e){return 0===e?{onMouseEnter:function(){i.setState({firstLiHover:!0})},onMouseLeave:function(){i.setState({firstLiHover:!1})}}:{}},i.state={options:[],value:[],showSel:!1,firstLiHover:!1,searchWord:""},i}r()(t,e);var n=t.prototype;return n.onSel=function(e,n){var t=this,a=this.state.options,l=this.state.value;!n.sel&&this.props.limit&&l.length>=this.props.limit?E.Z.warning("最多选择"+this.props.limit+"个对象！"):(a.forEach(function(e){e.id===n.id&&(t.props.singelSel?(e.sel=!0,l=[e]):(e.sel=!e.sel,e.sel?l.push(e):l.some(function(e,t){return e.id===n.id&&(l.splice(t,1),!0)})))}),this.setState({options:a,value:l},function(e){return t.props.onChange&&t.props.onChange(t.getValue())}))},n.getValue=function(){return this.state.value},n.UNSAFE_componentWillReceiveProps=function(e){var t,n;(e.options||e.value)&&(t=JSON.parse(JSON.stringify(e.options)),n=JSON.parse(JSON.stringify(e.value)),t.forEach(function(e){n.map(function(e){return e.id}).includes(e.id)?e.sel=!0:e.sel=!1}),this.setState({options:t,value:n}))},n.UNSAFE_componentWillMount=function(){var e=this.props,t=e.options,e=e.value,n=void 0===e?[]:e;t.forEach(function(e){n.map(function(e){return e.id}).includes(e.id)&&(e.sel=!0)}),this.setState({options:t,value:n})},n.componentWillUnmount=function(){},n.render=function(){var a=this,e=this.state,n=e.options,t=e.value,l=e.searchWord,i=[];return 0<t.length&&0<n.filter(function(e){return e.sel}).length&&t.forEach(function(t){n.filter(function(e){return e.id===t.id})[0]&&i.push(n.filter(function(e){return e.id===t.id})[0])}),v().createElement("div",{className:"analyze-object-sort-select"},v().createElement("div",{className:"selItem "+(this.props.triangle?"triangle":"")+" "+(this.state.firstLiHover?"selPadHover":""),onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},v().createElement("div",{className:"wrap"},v().createElement("div",null,v().createElement(g.Input,{value:l,placeholder:"输入搜索关键词",className:"search",icon:"close",onChange:function(e){return a.setState({searchWord:e})},onIconClick:function(){return a.setState({searchWord:""})}})),v().createElement("ul",null,0<i.length&&i.filter(function(e){return!l||-1!==e.name.toLocaleLowerCase().indexOf(l.trim().toLocaleLowerCase())}).map(function(t,n){return v().createElement("li",f()({className:(t.sel?"sel":"")+(t.disable?" disable":""),key:n,onClick:function(e){return a.props.singelSel?"":a.onSel(e,t)}},a._setEvent(n)),!a.props.singelSel&&v().createElement(h.Jg,{className:"check-all",checked:t.sel,onChange:function(e){}}),v().createElement("span",null,t.name),!a.props.singelSel&&v().createElement("div",{className:"handle"},0!==n&&v().createElement("i",{title:"置顶",onClick:function(e){a.sortList(n,"top",e)},className:"icon-cem_roof-placement"}),0!==n&&v().createElement("i",{title:"上一位",onClick:function(e){a.sortList(n,"up",e)},className:"icon-cem_upper"}),n!==i.length-1&&v().createElement("i",{title:"下一位",onClick:function(e){a.sortList(n,"down",e)},className:"icon-cem_lower"})))}),0<i.length&&0<n.filter(function(e){return!e.sel}).length&&v().createElement("div",{className:"line"}),0<n.filter(function(e){return!e.sel}).length&&n.filter(function(e){return!e.sel}).filter(function(e){return!l||-1!==e.name.toLocaleLowerCase().indexOf(l.trim().toLocaleLowerCase())}).map(function(t,e){return v().createElement("li",{className:(t.sel?"sel":"")+(t.disable?" disable":""),key:e,onClick:function(e){return a.onSel(e,t)}},!a.props.singelSel&&v().createElement(h.Jg,{className:"check-all",checked:t.sel,onChange:function(e){}}),v().createElement("span",{className:"dark"},t.name))}),0===n.length&&v().createElement("div",{className:"noData"},"无数据")))))},t}(a.Component);S.propTypes={options:t().array,value:t().array,onChange:t().func,singelSel:t().bool};var C=function(t){function e(e){var a=t.call(this,e)||this;return a.stop=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},a.getPropsValue=function(){var e=a.props.value;e&&e[0]&&e[0].id&&(a.setState({selectValue:{id:e[0].id,name:e[0].name}},function(){return a.copyVal=a.getValue()}),e[0].values&&a.setState({sortSelectValue:e[0].values},function(){return a.copyVal=a.getValue()}))},a.setShowSelFalse=function(){a.state.show&&(a.setState({selectValue:a.copyVal?{id:a.copyVal[0].id,name:a.copyVal[0].name}:{},sortSelectValue:a.copyVal&&a.copyVal[0].values?a.copyVal[0].values:[]}),a.cancel()),a.state.show&&a.setState({show:!1})},a.cancel=function(){a.setState({show:!1})},a.onSelChange=function(e,t){var n;a.setState(((n={})[e]=t,n)),"selectValue"===e&&a.setState({sortSelectValue:[]})},a.state={list:e.list||[],selectValue:{},sortSelectValue:[],show:!1,triangle:"select"},a}r()(e,t);var n=e.prototype;return n.UNSAFE_componentWillMount=function(){var e;this.props.left&&this.props.left<-200&&this.setState({triangle:"sortSelect"}),this.props.value&&(e=this.props.value,this.setState({selectValue:{id:e.id,name:e.name},sortSelectValue:e.values}))},n.componentDidMount=function(){var t=this;this.getPropsValue(),window.addEventListener("click",this.setShowSelFalse),this.props.left&&document.querySelectorAll(".analyze-object").forEach(function(e){return e.style.setProperty("--x",t.props.left+"px")})},n.componentWillUnmount=function(){window.removeEventListener("click",this.setShowSelFalse)},n.getValue=function(){return this.state.selectValue.id?[{id:this.state.selectValue.id,values:this.state.sortSelectValue,name:this.state.selectValue.name}]:{}},n.changeShow=function(e){var t=this;this.state.show&&this.stop(e),setTimeout(function(){t.setState({show:!t.state.show})},0)},n.render=function(){var t=this,e=this.state,n=e.list,a=e.selectValue,l=e.sortSelectValue,i=e.defaultSelectValue,r=e.show,o=e.triangle,s=n.map(function(e){return{id:e.id,name:e.name}}),c=this.props.close,e=n.filter(function(e){return e.id===a.id})[0]?n.filter(function(e){return e.id===a.id})[0].values.map(function(e){return delete e.sel,e}):[],n=a.name?a.name+(l[0]&&l[0].name?" | "+l[0].name:""):"请选择";return v().createElement("div",{className:"checkbox-panel-yt-point"},v().createElement("span",{className:"title"},"关注点"),v().createElement("div",{className:"all-checkbox",style:{height:open?"":"38px"}},v().createElement("span",{className:"more"},c&&v().createElement("i",{className:"close",onClick:c},"×")),v().createElement("div",{className:"check-box",ref:function(e){return t.checkBox=e}},v().createElement("div",{className:"analyze-object"},v().createElement("div",{className:"analyze-object-select",onClick:function(e){return t.changeShow(e)}},v().createElement("div",{className:"infor "+(r?"sel":"")},v().createElement("span",null,n),v().createElement("i",{className:"icon-cem_pull-down-or-take-up",style:{transform:r?"rotate(-180deg)":""}})),r&&v().createElement(m,{noCollect:!0,options:s,defaultSelectValue:i,value:a,onChange:function(e){return t.onSelChange("selectValue",e)},triangle:"select"===o})),r&&v().createElement(S,{singelSel:!0,options:e,limit:this.props.limit,value:l,onChange:function(e){return t.onSelChange("sortSelectValue",e)},triangle:"sortSelect"===o}),r&&v().createElement("div",{className:"footer",onClick:function(e){return t.stop(e)}},0<s.length&&v().createElement("div",{className:"control"},v().createElement(g.Button,{type:"primary",disabled:!s.length||!e.length||!a.id,onClick:function(){t.copyVal=t.getValue(),t.cancel(),t.props.onChange&&t.props.onChange(t.getValue())}},"确定"),v().createElement("span",{className:"cancel",onClick:function(){t.setState({selectValue:t.copyVal?{id:t.copyVal[0].id,name:t.copyVal[0].name}:{},sortSelectValue:t.copyVal&&t.copyVal[0].values?t.copyVal[0].values:[]}),t.cancel()}},"取消")))))))},e}(a.Component);const N=function(e){var t=e.searchInfo,n=e.onInput,a=e.onClose,e=v().useState(!0),l=e[0];e[1];return v().createElement("div",{className:"filter-search-wrap"},v().createElement("div",{className:"search"},v().createElement("span",null,v().createElement("i",{className:"icon-cem_search"}),v().createElement("span",null,t.name+":")),v().createElement("input",{placeholder:"请输入搜索词",autoFocus:!0,value:t.keyword,onInput:function(e){return l&&n(e)}})),v().createElement("i",{className:"icon-cem_delete del",onClick:a}))},k=function(t){function e(e){var l=t.call(this,e)||this;return l.handleChangeSel=function(e,t){l.props.screeningValuesChange({values:[{listDetail:e,values:t}],type:l.props.type})},l.renderCheckBox=function(t,e,n){var a=l.state.searchInfo;return v().createElement(c,{key:e,checkedList:n,data:t.list,changeState:function(e){return l.handleChangeSel(t,e)},searchKeywords:a.id===t.id?a.keyword:"",onSearch:function(){l.setState({searchInfo:{isSearching:!0,id:t.id,name:t.name,keyword:""}})},title:t.name})},l._handelKeywordChange=function(e){var t=l.state.searchInfo;l.setState({searchInfo:{isSearching:!0,id:t.id,name:t.name,keyword:e.target.value}})},l._handelKeywordClose=function(){return l.setState({searchInfo:{isSearching:!1,id:"",name:"",keyword:""}})},l.state={searchInfo:{isSearching:!1,id:"",name:"",keyword:""}},l}r()(e,t);var n=e.prototype;return n.renderRadio=function(t,e,n){var a=this;return v().createElement(u,{key:e,value:n,data:t.list,changeState:function(e){return a.handleChangeSel(t,e)},onSearch:function(e){},title:t.name})},n.renderCascade=function(t,e,n){var a=this;return v().createElement(C,{left:-66,key:e,list:t.list,value:n,onChange:function(e){return a.handleChangeSel(t,e)}})},n.componentDidMount=function(){},n.render=function(){var a=this,e=this.props.screeningList,t=this.state.searchInfo;return v().createElement("div",{className:"screening_view"},v().createElement("div",{className:"screening"},t.isSearching&&v().createElement(N,{searchInfo:t,onInput:this._handelKeywordChange,onClose:this._handelKeywordClose}),e.map(function(t,e){var n=a.props.screeningValues.filter(function(e){return e.id===t.id})[0]?a.props.screeningValues.filter(function(e){return e.id===t.id})[0].values:[];switch(t.type){case"checkbox":return a.renderCheckBox(t,e,n);case"radio":return a.renderRadio(t,e,n);case"cascade":return a.renderCascade(t,e,n);default:return null}})))},e}(v().Component),w=function(n){function e(e){var t=n.call(this,e)||this;return t.onConfirm=function(){t.props.handelChange(),t.props.handelChangeShow(!1)},t.onCancel=function(){t.props.handelChangeShow(!1)},t.clearAllValues=function(){t.props.clearAllValues({type:t.props.type})},t.state={},t}return r()(e,n),e.prototype.render=function(){var e=this.props,e=(e.handelChangeShow,e.screeningValues);return v().createElement("div",{className:"screening_wrap_view"},v().createElement(k,this.props),v().createElement(s,{onConfirm:this.onConfirm,onCancel:this.onCancel,clearAllValues:this.clearAllValues,screeningValues:e}))},e}(v().Component),b=function(e){function t(){return e.apply(this,arguments)||this}return r()(t,e),t.prototype.render=function(){var e=this.props,t=e._handelClick,n=e.select,a=e.name,e=e.style;return v().createElement("div",{className:"HeaderButton",style:e||{}},v().createElement("div",{className:n?"sel wrap":"wrap",onClick:function(){return t()}},v().createElement("i",{className:"icon-cem_screen"}),v().createElement("span",null,a),v().createElement("i",{className:"icon-cem_pull-down-or-take-up",style:{transform:n?"rotate(180deg) translateY(-1px)":""}})))},t}(v().PureComponent);var V=n(77131);function x(e,t,n){return p.h.post("/default/value/update",{key:e,projectId:t,value:n})}var O=n(97189),_="empty";const L=function(t){function e(e){var c=t.call(this,e)||this;return c.getSelectedFilterObj=function(){return c.state.selFilterObj},c._handleListSelect=function(e,t){e.stopPropagation(),c.props.onFilterChange(t),c.setState({selFilterObj:t})},c._handleListStar=function(e,t,n){e.stopPropagation(),c.lastStaredSaveId=t;var a=c.state,l=a.staredFilterId,i=a.savedKey,r=a.projectId,a=a.staredFilterIndex;l!==t?(-1!==a&&(a=document.querySelectorAll(".saved-condition-list .star")[a].children[1],(0,O.removeClass)(a,"star-active")),(0,O.addClass)(e.target.parentNode,"star-active")):(0,O.removeClass)(e.target.parentNode,"star-active"),c.setState({staredFilterIndex:n,staredFilterId:l===t?_:t},function(){x(i,r,c.state.staredFilterId).then(function(e){2e4!==e.data.code&&c.setState({staredFilterId:c.lastStaredSaveId})})})},c._handleOnEditClick=function(e,t){e.stopPropagation(),c.refs.saveNameInput.refs.input.value=t.name,c.setState({targetFilterObj:t,editDialogVisible:!0})},c._handleConfitionSaveConfirm=function(){var e=c.state,l=e.selFilterObj,i=e.projectId,r=e.targetFilterObj,e=c.props,o=e.model,s=e.onFilterRename;e=r.id,p.h.post("/filter/find/save",{id:e}).then(function(e){var t,n,a=e.data;2e4===a.code&&(t=c.refs.saveNameInput.refs.input.value,r.id===l.id&&s&&s(t),n=!1,e=r.id,a=a.result.selected,p.h.post("/filter/add",{name:t,copy:n,type:o,id:e,projectId:i,selected:a}).then(function(e){2e4===e.data.code&&(E.Z.success("修改成功"),c.setState({editDialogVisible:!1}),c.refresh(l.id))}))})},c._handleOnDeleteClick=function(e,t){e.stopPropagation(),c.setState({targetFilterObj:t,delDialogVisible:!0})},c._handleOnDeleteConfirm=function(e){e.stopPropagation();var t=c.state,n=t.targetFilterObj,a=t.savedKey,l=t.projectId,i=t.staredFilterId,e=t.filterList,r=t.selFilterObj,t=[(t=n.id,p.h.post("/filter/delete",{id:t,menuModel:{}}))];i===n.id&&t.push(x(a,l,_)),Promise.all(t).then(function(e){2e4===e[0].data.code&&c.refresh(n.id===r.id?void 0:r.id)}),n.id===r.id&&c.props.onFilterChange(e[0])},c.renderDeleteDialog=function(){var e=c.state,t=e.selFilterObj,e=e.targetFilterObj;return v().createElement("div",{onMouseLeave:function(e){return e.stopPropagation()}},v().createElement(g.Dialog,{title:"删除",className:"delete-saved-confition-dialog",size:"tiny",modal:!1,visible:c.state.delDialogVisible,onMouseLeave:function(e){return e.stopPropagation()},onCancel:function(e){return c.setState({delDialogVisible:!1})}},v().createElement(g.Dialog.Body,null,v().createElement("span",null,e&&t&&t.id===e.id?"删除该筛选器后，当前页面的筛选器将自动切换为”全部数据（默认）”筛选器，是否删除？":'是否删除"'+e.name+'"筛选器？')),v().createElement(g.Dialog.Footer,null,v().createElement(g.Button,{type:"primary",onClick:c._handleOnDeleteConfirm},"确定"),v().createElement(g.Button,{type:"default",onClick:function(e){return c.setState({delDialogVisible:!1})}},"取消"))))},c.renderEditDialog=function(){return v().createElement("div",{onMouseLeave:function(e){return e.stopPropagation()}},v().createElement(g.Dialog,{title:"修改名称",className:"filter-save-name-dialog",size:"tiny",modal:!1,visible:c.state.editDialogVisible,onCancel:function(e){return c.setState({editDialogVisible:!1})}},v().createElement(g.Dialog.Body,null,v().createElement(g.Input,{className:"name-input",placeholder:"请输入名称",ref:"saveNameInput"})),v().createElement(g.Dialog.Footer,null,v().createElement(g.Button,{type:"primary",onClick:c._handleConfitionSaveConfirm},"确定"),v().createElement(g.Button,{type:"default",onClick:function(e){return c.setState({editDialogVisible:!1})}},"取消"))))},c.state={projectId:d.t.get(d.V.curProject).id,savedKey:e.model+"_SAVED_OBJ",filterList:void 0,selFilterObj:void 0,targetFilterObj:{},staredFilterId:_,staredFilterIndex:-1,isEditing:!1,delDialogVisible:!1,editDialogVisible:!1},c}r()(e,t);var n=e.prototype;return n.componentDidMount=function(){},n.componentDidUpdate=function(e,t){this.state.filterList;this.props.show===e.show||this.props.show||this.setState({isEditing:!1,fullListShow:!1})},n.componentWillUnmount=function(){},n.refresh=function(r){var o=this,e=this.state,t=e.savedKey,n=e.projectId,a=(e.staredFilterId,this.props),e=a.model,s=(a.onFilterChange,a.shouldShowDefault),c=void 0,e=p.h.post("/filter/list",{type:e,projectId:n}),n=p.h.post("/default/value/find",{key:t,projectId:n});return Promise.all([e,n]).then(function(e){var t,n,a,l,i=e[0].data;2e4===i.code&&(t=i.result.all).unshift({id:"default",name:"全部数据（默认）"});e=e[1].data;return 2e4===e.code&&(n=e.result||_,a=s?-1:t.findIndex(function(e){return e.id===n}),r&&(l=t.findIndex(function(e){return e.id===r})),c=l?t[l]:-1===a?t[0]:t[a]),o.setState({delDialogVisible:!1,selFilterObj:c,staredFilterIndex:a,filterList:t,staredFilterId:n,fullListShow:15<t.length&&o.state.fullListShow}),c})},n.render=function(){var a=this,e=this.state,t=e.filterList,l=e.selFilterObj,i=e.staredFilterId,r=e.isEditing,e=this.props,e=(e.onFilterChange,e.show),t=t?JSON.parse(JSON.stringify(t)):[];return v().createElement("div",{className:"saved-condition-wrapper",style:{display:e?"block":"none",width:2<t.length?"728px":1<t.length?"486px":"278px"}},v().createElement("div",{className:"saved-condition-list"},v().createElement("p",{className:"saved-condition-tip"},"提示：通过筛选器可提高图表查看效率"),v().createElement("ul",null,t.map(function(t,n){return v().createElement("li",{className:r?"editing":"star",key:r?"edit"+n:"star"+n,onClick:function(e){return a._handleListSelect(e,t)}},v().createElement("span",{className:l&&l.id===t.id?"active":""},v().createElement("i",{className:"radio"}),v().createElement("span",null,t.name)),"default"!==t.id&&v().createElement("span",{className:"edt-active tool"},v().createElement(y.Z,{placement:"top",overlay:i===t.id?"取消默认":"设为默认"},v().createElement("span",{className:i===t.id?"star-active":"",onClick:function(e){return a._handleListStar(e,t.id,n)}},v().createElement("i",{className:i===t.id?"icon-cem_star":"icon-cem_star-line"}))),v().createElement(y.Z,{placement:"top",overlay:"重命名"},v().createElement("span",{onClick:function(e){return a._handleOnEditClick(e,t)}},v().createElement("i",{className:"icon-cem icon-cem_screening-editor"}))),v().createElement(y.Z,{placement:"top",overlay:"删除"},v().createElement("span",{onClick:function(e){return a._handleOnDeleteClick(e,t)}},v().createElement("i",{className:"icon-cem icon-cem_delete"})))))}))),this.renderDeleteDialog(),this.renderEditDialog())},e}(v().Component),I=function(n){function e(e){var t=n.call(this,e)||this;return t.showSaveDialog=function(e){return t.setState({saveVisible:!0,dialogType:e})},t.hideSaveDialog=function(){return t.setState({saveVisible:!1})},t.state={saveVisible:!1,nameValue:"",dialogType:""},t}return r()(e,n),e.prototype.render=function(){var t=this,e=this.props,n=e.selSaveInfo,a=e.handleSaveScreen,l=this.state,e=l.saveVisible,i=l.nameValue,r=l.dialogType;return v().createElement("div",{className:"button-zone"},v().createElement("div",null,v().createElement("span",{className:"modified"},"已修改"),"default"===n.id?v().createElement("a",null,v().createElement("span",{className:"save",onClick:function(){return t.showSaveDialog("save")}},"保存为筛选器")):v().createElement("span",{className:"save",onClick:function(){return a({type:"update"})}},"更新筛选器"),n&&"default"!==n.id&&v().createElement("div",{className:"more-zone"},v().createElement("span",{className:"more"},v().createElement("i",{className:"icon-cem icon-cem_more"})),v().createElement("div",{className:"more-list"},v().createElement("div",{className:"li-item",onClick:function(){return t.showSaveDialog("saveOther")}},"另存为筛选器")))),v().createElement(g.Dialog,{title:"save"===this.state.dialogType?"保存筛选条件":"筛选条件另存为",className:"filter-save-name-dialog",size:"tiny",modal:!1,visible:e,onCancel:this.hideSaveDialog},v().createElement(g.Dialog.Body,null,v().createElement(g.Input,{className:"name-input",placeholder:"请输入名称",value:i,onChange:function(e){return t.setState({nameValue:e})}})),v().createElement(g.Dialog.Footer,null,v().createElement(g.Button,{type:"primary",onClick:function(){return a({type:r,name:i})}},"确定"),v().createElement(g.Button,{type:"default",onClick:this.hideSaveDialog},"取消"))))},e}(v().Component);var a=n(18446),D=n.n(a),F=function(t){function e(e){var a=t.call(this,e)||this;return a.handleDetailShow=function(){a.setState({isShow:!a.state.isShow})},a.competeInfoWidth=function(){var t,e,n;a.info&&(a.info.style.whiteSpace="nowrap",t=[],Array.from(a.info.getElementsByClassName("detail-info")).forEach(function(e){e.style.width="unset",t.push(e.clientWidth),e.style.width="calc(100% - 88px)"}),n=122,n+=700<(e=Math.max.apply(null,t))?700:e,a.info.style.whiteSpace="normal",a.info.style.width=n+"px")},a.state={isShow:!1},a}r()(e,t);var n=e.prototype;return n.componentDidMount=function(){var e=this;setTimeout(function(){e.competeInfoWidth()},0)},n.componentWillUnmount=function(){var e=this;setTimeout(function(){e.competeInfoWidth()},0)},n.render=function(){var t=this,e=this.props.value;return v().createElement("div",{id:"info"},v().createElement("span",{className:"detail",onMouseEnter:this.handelDetailShow},"详情"),!this.state.isShow&&v().createElement("div",{className:"info-wrap",onMouseLeave:this.handelDetailShow},v().createElement("div",null,"当前页面筛选条件"),e&&0<e.length?v().createElement("ul",{ref:function(e){return t.info=e},id:"yt_info_ul"},e.map(function(n,e){return v().createElement("li",{key:e},v().createElement("div",{className:"name"},n.name),"aspect"===n.id?v().createElement("div",{className:"detail-info"},0<n.values.length&&n.values.map(function(e,t){return v().createElement("span",{key:t},e.id,0<e.values.length&&e.values.map(function(e,t){return v().createElement("span",{key:t}," | ",e.name)}))})):v().createElement("div",{className:"detail-info"},0<n.values.length&&n.values instanceof Array?n.values.slice(0,100).map(function(e,t){return v().createElement("span",{key:t},e+(t===n.values.length-1?"":"，"))}):v().createElement("span",null,n.values)))})):v().createElement("div",{className:"noData"},"暂无筛选内容")))},e}(v().Component),P=n(30133),T={overview:"WAITER_SESSION_OVERVIEW",commodityAnalyze:"WAITER_SESSION_ASPECT",concernAnalyze:"WAITER_SESSION_PRODUCT"};const A=function(n){function e(e){var t=n.call(this,e)||this;return t.handelChangeShow=function(e){return t.setState({show:e===t.state.show?null:e})},t.handelTimeChange=function(e){t.props.dateValueChange({value:e}).then(function(){t.handelChangeShow(null),t.props.handelValueChange()})},t.state={show:e.defaultShow||null,saveFilterVisible:!1},t}r()(e,n);var t=e.prototype;return t.handleShowSave=function(e){this.saveScreen.setAttribute("class","enter"===e?"title sel":"title"),this.setState({saveFilterVisible:"enter"===e})},t.render=function(){var t=this,e=this.state.show,n=this.props,a=(n.title,n.dateFilter),l=n.handelValueChange,i=n.screeningMap,r=n.children,o=n.selSaveInfo,s=n.handleOnSaveBoxChange,c=n.handleSaveScreen,u=n.getsaveBoxRef,p=n.getTimeRef,d=n.getControlRef,m=n.type,h=n.detailInfo,n=this.state.saveFilterVisible;return v().createElement("div",{className:"header_Filter_view",style:{height:r?"100%":""}},v().createElement(g.Loading,{loading:void 0===i},v().createElement("div",{className:"header_Filter_bar"},v().createElement("div",{className:"title",ref:function(e){return t.saveScreen=e},onMouseEnter:function(){return t.handleShowSave("enter")},onMouseLeave:function(){return t.handleShowSave("leave")}},v().createElement("span",null,"筛选器: "),v().createElement("span",{className:"save_name"},o.name),v().createElement("i",{className:"icon-cem_arrow-launches"}),v().createElement(L,{ref:u,show:n,model:T[m],onFilterChange:s,onFilterRename:function(e){return s(e,"name")}})),"screening"===e&&o&&this.isScreeningChanged&&v().createElement(I,{ref:d,selSaveInfo:o,handleSaveScreen:c}),v().createElement(F,{value:h}),v().createElement(b,{name:this.time,_handelClick:function(){return t.handelChangeShow("time")},select:"time"===e}),v().createElement(b,{name:"筛选",_handelClick:function(){return t.handelChangeShow("screening")},select:"screening"===e})),v().createElement("div",null,"screening"===e&&v().createElement(w,f()({},this.props,{handelChangeShow:this.handelChangeShow,handelChange:l})),v().createElement(V.Z,{ref:p,onChange:function(e){return t.handelTimeChange(e)},show:"time"===e,onCancel:function(){return t.handelChangeShow("time")},params:a}))),r&&v().createElement("div",{className:"contentWrap"},void 0===i?v().createElement(P.Z,null):r))},o()(e,[{key:"time",get:function(){var e="时间";return e=this.props.dateFilter&&this.props.dateFilter.from?this.props.dateFilter.quickChoice||this.props.dateFilter.from.replace(/-/g,"/")+"-"+this.props.dateFilter.to.replace(/-/g,"/"):e}},{key:"isScreeningChanged",get:function(){var e=this.props,t=e.selSaveInfo,e=e.screeningValues;return!D()(t.screeningValues,e)}}]),e}(v().Component);var R=n(18854),a=n(55609),B=n(64396).Z.public.header,n=function(t){function e(e){var o=t.call(this,e)||this;return o.getAspect1=function(t){var n,e=o.props.screeningMap,a=null,l=null;return e.aspect&&(n=JSON.parse(e.aspect)[0],Object.keys(n).forEach(function(e){n[e].includes(t)&&(l=a=e)})),{id:a,name:l}},o.setDefaultValue=function(e){var t=o.props,n=t.screeningMap,a=(t.screeningList,t.type),l=[];if(e)return o.props.saveBoxChange({value:e,type:o.props.type}).then(function(){return o._handelValueChange()});function i(){l.push({id:"product",name:"分析商品",serverKey:"product",type:"radio",values:n.maxSessionProduct})}function r(){l.push({id:"aspect",name:"关注点",serverKey:"aspect",type:"cascade",values:[{id:n.maxSessionAspect,name:n.maxSessionAspect,values:[]}]})}o.props.value&&o.props.value.length?(l=JSON.parse(JSON.stringify(o.props.value)),o.props.value.some(function(e){return"product"===e.id})||"commodityAnalyze"!==a||i(),o.props.value.some(function(e){return"aspect"===e.id})||"concernAnalyze"!==a?o.props.value.some(function(e){return"aspect"===e.id})&&!o.props.value.filter(function(e){return"aspect"===e.id})[0].values[0].id&&o.props.value.filter(function(e){return"aspect"===e.id})[0].values[0].values[0].id&&(l=l.filter(function(e){return"aspect"!==e.id}),t=o.props.value.filter(function(e){return"aspect"===e.id})[0].values[0].values[0].id,t=(e=o.getAspect1(t)).id,e=e.name,l.push({id:"aspect",name:"关注点",serverKey:"aspect",type:"cascade",values:[{id:t,name:e,values:o.props.value.filter(function(e){return"aspect"===e.id})[0].values[0].values}]})):r()):("commodityAnalyze"===a&&i(),"concernAnalyze"===a&&r()),o.props.saveValue({value:l,type:o.props.type}).then(function(){return o._handelValueChange()})},o._handleOnSaveBoxChange=function(e,t){o.props.saveBoxChange({value:e,type:o.props.type,key:t}).then(function(){return t!==name&&o._handelValueChange()})},o.competeInfoWidth=function(){var t,e,n;document.getElementById("yt_info_ul")&&(document.getElementById("yt_info_ul").style.whiteSpace="nowrap",t=[],Array.from(document.getElementById("yt_info_ul").getElementsByClassName("detail-info")).forEach(function(e){e.style.width="unset",t.push(e.clientWidth),e.style.width="calc(100% - 88px)"}),n=122,n+=700<(e=Math.max.apply(null,t))?700:e,document.getElementById("yt_info_ul").style.whiteSpace="normal",document.getElementById("yt_info_ul").style.width=n+"px")},o._handelValueChange=function(e){o.props.saveDetailInfoValue({value:JSON.parse(JSON.stringify(o.props.screeningValues))}),o.props.onChange&&o.props.onChange(f()({},(0,R.bp)(o.props.screeningValues),{dateFilter:o.props.dateFilter}),o.props.screeningValues),setTimeout(function(){o.competeInfoWidth()},0)},o._handleSaveScreen=function(e){var t=e.type,e=e.name;o.props.saveScreening({type:t,name:e,model:o.props.type}).then(function(e){o.saveBoxRef.refresh(e.id)})},o.state={},o._event={handelValueChange:o._handelValueChange,handleOnSaveBoxChange:o._handleOnSaveBoxChange,handleSaveScreen:o._handleSaveScreen,getsaveBoxRef:function(e){return o.saveBoxRef=e},getTimeRef:function(e){return o.timeRef=e},getControlRef:function(e){return o.controlRef=e}},o}r()(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;this.props.screeningMap?(this.props.clearAllValues({type:this.props.type}),Promise.all([this.timeRef.fetchDefaultValue(),this.saveBoxRef.refresh()]).then(function(e){t.props.dateValueChange({value:e[0]}).then(function(){return t.setDefaultValue("default"===e[1].id?"":e[1])})})):Promise.all([this.props.fetchScreeningMap({type:this.props.type}),this.timeRef.fetchDefaultValue(),this.saveBoxRef.refresh()]).then(function(e){t.props.dateValueChange({value:e[1]}).then(function(){return t.setDefaultValue("default"===e[2].id?"":e[2])})})},n.render=function(){return v().createElement(A,f()({},this.state,this._event,this.props))},e}(v().Component);n.propTypes={onChange:t().func,type:t().string,value:t().array};const j=(0,a.connect)(function(e){var t=e.loading,e=l()(e,["loading"]);return f()({},e[B],{fetchingScreeningMap:t.effects[B+"/fetchScreeningMap"]||!1})},function(t){return{fetchScreeningMap:function(e){return t({type:B+"/fetchScreeningMap",payload:e})},saveBoxChange:function(e){return t({type:B+"/saveBoxChange",payload:e})},saveScreening:function(e){return t({type:B+"/saveScreening",payload:e})},screeningValuesChange:function(e){return t({type:B+"/screeningValuesChange",payload:e})},dateValueChange:function(e){return t({type:B+"/dateValueChange",payload:e})},clearAllValues:function(e){return t({type:B+"/clearAllValues",payload:e})},saveValue:function(e){return t({type:B+"/saveValue",payload:e})},saveDetailInfoValue:function(e){return t({type:B+"/saveDetailInfoValue",payload:e})}}},null,{withRef:!0})(n)}}]);