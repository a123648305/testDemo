(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[6148],{46148:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>k});var a=n(37316),l=n.n(a),t=n(67154),r=n.n(t),a=n(85354),c=n.n(a),t=n(67294),i=n.n(t),a=n(55609),o=n(55815),s=n(92360);var t=n(51285),m=n.n(t);const d=function(e){var t=e.visible,n=e.imgUrl,e=e.onClose;return i().createElement("div",{className:"price_enlarge_wrap"},i().createElement(m(),{className:"price_enlarge_viewer",visible:t,drag:!1,loop:!1,rotatable:!1,changeable:!1,zIndex:1001,noClose:!0,noImgDetails:!0,noToolbar:!0,noFooter:!0,onClose:e,defaultScale:1,images:[{src:n,alt:"截图"}]}),i().createElement("span",{className:"top_close_btn",onClick:e,style:{zIndex:1016}},i().createElement("i",{className:"icon-cem_cancel"})))};const u=function(e){var t=e.uImg,o=e.imgUrl,n=e.url,a=i().useState(!1),e=a[0],l=a[1];return i().createElement("div",{className:"price_screen_wrap"},!o||o.includes("fail")?i().createElement("div",{className:"empty-block",style:{minHeight:"488px"}},"暂无数据",i().createElement(s.Button,{onClick:function(){window.open(""+n)}},"查看详情")):i().createElement(i().Fragment,null,i().createElement("div",{className:"screen_title"},"截图"),i().createElement("div",{className:"top_btn"},i().createElement(s.Button,{onClick:function(){window.open(""+n)}},"查看详情"),i().createElement(s.Button,{onClick:function(){var e,a,l,r,c,i,t,n;e=o,t="截图取证",n=new Date,a=t+"-"+(""+n.getFullYear()+(n.getMonth()+1)+n.getDate()+n.getHours()+n.getMinutes()+(n.getSeconds()<10?"0"+n.getSeconds():n.getSeconds())+n.getMilliseconds()),l=1e3,r=document.createElement("canvas"),c=r.getContext("2d"),(i=new Image).onload=function(){i.height>l&&i.height>=i.width&&(i.width=l/i.height,i.height=l),i.width>l&&i.width>i.height&&(i.height*=l/i.width,i.width=l),c.clearRect(0,0,r.width,r.height),r.width=i.width,r.height=i.height,c.drawImage(i,0,0,i.width,i.height);var e=r.toDataURL("image/jpg"),t=document.createElement("a"),n=new MouseEvent("click");t.download=a||"截图取证",t.href=e,t.dispatchEvent(n)},i.crossOrigin="anonymous",i.src=e+"?timeStamp="+(new Date).getTime()}},"下载图片"),i().createElement(s.Button,{onClick:function(){l(!0)}},"大图查看")),i().createElement("div",{className:"img_wrap"},i().createElement("img",{src:t,onClick:function(){l(!0)}})),e&&i().createElement(d,{visible:e,imgUrl:o,onClose:function(){l(!1)}})))};var p=n(43036),h=n(61193),t=n(30381),E=n.n(t),g="YYYY-MM-DD HH:mm";const v=function(e){var t=e.infoData,n=e.onDeal,e=i().useState(t&&t.handlerId),a=e[0],l=e[1];return i().createElement("div",{className:"price_info_wrap"},t&&i().createElement("div",null,i().createElement("div",{className:"screen_title"},"商品基本信息"),i().createElement("div",{className:"info_list"},i().createElement("div",null,i().createElement("span",null,"商品名称"),i().createElement("span",null,t.connectionName)),i().createElement("div",null,i().createElement("span",null,"指导价"),i().createElement("span",null,parseFloat(t.compareLine).toFixed(2),"元")),i().createElement("div",null,i().createElement("span",null,"触发时间",i().createElement(p.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:i().createElement("a",{href:"https://www.yuque.com/docs/share/4fd44d72-2e46-4900-828d-7a4919afa8d4?#",target:"_blank",rel:"noopener noreferrer",style:{color:"#0847a6"}},"了解更多")},i().createElement("i",{className:"icon-cem_file1"}))),i().createElement("span",null,E()(t.breakBackTime).format(g))),i().createElement("div",null,i().createElement("span",null,"截图价"),i().createElement("span",null,parseFloat(t.breakBackPrice||0).toFixed(2),"元")),i().createElement("div",null,i().createElement("span",null,"幅度"),i().createElement("span",null,new Number(parseFloat(t.breakBackPrice||0)-parseFloat(t.compareLine)).toFixed(2),"元"))),i().createElement("div",{className:"operate_wrap"},i().createElement(s.Button,{className:a?"deal-btn-hover":"deal-btn",onClick:function(){l(!a),n()},disabled:a},"我来处理"),a&&i().createElement("p",{className:"operated"},t.handlerEmail||h.Z.getUser().email,"（",t.handlerName||h.Z.getUser().username,"）于",(t.handlerTime&&t.handlerId?E()(t.handlerTime):E()()).format(g),"已跟进处理此问题"))))};const f=function(e){var t=e.data,n=e.logData,e=e.onDeal;return i().createElement("div",{className:"yt_price_screenshot_wrapper"},i().createElement(o.Z,{title:[{title:"渠道乱价",url:"/priceChaos"},{title:"截图取证",url:""}]}),i().createElement("div",{className:"content",id:"price_screenshot_content"},i().createElement("div",{className:"price_screenshot_wrap"},i().createElement(u,{uImg:t.breakBackUrl&&t.breakBackUrl,imgUrl:t.breakBackUrl&&t.breakBackUrl,url:t.connectionUrl&&t.connectionUrl}),n&&i().createElement(v,{infoData:n,onDeal:e}))))};var w=n(64396).Z.price.screenshot,n=function(a){function e(e){var t=a.call(this,e)||this;t._handleOnDeal=function(){var e=t.state.data.id;t.props.fetchDeal({id:e})};var n=e.location.state;return t.state={data:n&&n},t.event={onDeal:t._handleOnDeal},e.fetchGetData({id:n.id}),t}return c()(e,a),e.prototype.render=function(){return i().createElement(f,r()({},this.props,this.state,this.event))},e}(i().PureComponent);const k=(0,a.connect)(function(e){e.loading;e=l()(e,["loading"]);return r()({},e[w])},function(t){return{save:function(e){return t({type:w+"/save",payload:e})},clean:function(e){return t({type:w+"/clean",payload:e})},fetchDeal:function(e){return t({type:w+"/fetchDeal",payload:e})},fetchGetData:function(e){return t({type:w+"/fetchGetData",payload:e})}}})(n)}}]);