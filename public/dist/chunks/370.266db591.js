(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[370],{60370:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>b});var a=n(37316),i=n.n(a),o=n(67154),m=n.n(o),r=n(85354),c=n.n(r),t=n(67294),k=n.n(t),h=n(35239),a=n(55609),g=n(55815),v=n(2271),S=n(8201),y=n(92360),E=n(61918),s=n(43036);const _=function(e){var t=e.data,n=e.detailList,a=e.onChooseSpu,i=e.onChooseSku,o=e.keywordSku,r=e.keywordSpu;return k().createElement("div",{className:"project_connection_maintainList_edit_left_wrap"},k().createElement("div",{className:"top"},k().createElement(s.Z,{overlay:k().createElement("div",{style:{maxWidth:260},onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},onMouseUp:function(){o&&document.querySelector(".project_connection_maintainList_edit_left_wrap")&&document.querySelector(".project_connection_maintainList_edit_left_wrap").click(),o&&i(""),a(window.getSelection().toString().trim())}},t.name),placement:"top"},k().createElement("div",{className:"title",onClick:function(){return window.open(""+t.url)}},t.name)),k().createElement("div",{className:"content_item"},n&&n.map(function(e,t){return k().createElement("div",{className:"product",key:e.id},k().createElement("span",null,e.topicName),k().createElement("div",{onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},k().createElement("span",{onMouseUp:function(){r&&document.querySelector(".project_connection_maintainList_edit_left_wrap")&&document.querySelector(".project_connection_maintainList_edit_left_wrap").click(),r&&a(""),i(window.getSelection().toString().trim())},className:"checked"},e.topicValueName)))}))))};var N=n(35303),w=n(17190);const C=function(t){function e(e){var r=t.call(this,e)||this;return r.getValue=function(){var e=r.state,t=e.spu,n=e.sku,a=e.spuName,i=e.skuName,e=e.topicList,o=[];return e.forEach(function(e){r.state["value"+e.id]&&o.push({id:e.id,name:r.state["id"+e.id]})}),{spuGroupId:t,skuGroupId:n,spuGroupName:a,skuGroupName:i,customizeConfig:o}},r._handleOnSelectChange=function(e,t,n){var a,i;e&&e.length&&(a=e[e.length-1],r.state["topicValue"+t].find(function(e){return e.value===a})?r.setState(((i={})["value"+n.id]=[a],i["id"+n.id]=r.state["topicValue"+t].find(function(e){return e.value===a}).id,i)):r.props.fetchAddTopicValue({value:a,topicId:n.id}).then(function(e){var t;2e4===e.code&&r.setState(((t={})["value"+n.id]=[a],t["id"+n.id]=e.result,t))})),e.length||r.setState(((e={})["value"+n.id]=void 0,e["id"+n.id]=void 0,e))},r.state={spu:e.data.spuId,spuName:null,sku:e.data.skuId,skuName:null,spuTip:e.spuTip,skuTip:e.skuTip,topicList:e.topicList,oddMaxLeng:0,evenMaxLeng:0},r}c()(e,t);var n=e.prototype;return n.setTopicList=function(e,t,n,a){var i=this;this.setState({topicList:[].concat(t.spuTitle.map(function(e,t){return{id:e,name:e,values:n&&i.props.spuList.find(function(e){return e.id===n})?JSON.parse(i.props.spuList.find(function(e){return e.id===n}).config)[e]:""}}),t.skuTitle.map(function(e,t){return{id:e,name:e,values:a&&i.props.skuList.find(function(e){return e.id===a})?JSON.parse(i.props.skuList.find(function(e){return e.id===a}).config)[e]:""}}),e)})},n.componentDidMount=function(){var a=this;this.props.data.spuName===this.state.spuName&&this.props.data.skuName===this.state.skuName||this.setState({spu:this.props.data.spuId,spuName:this.props.data.spuName,sku:this.props.data.skuId,skuName:this.props.data.skuName},function(){a.setTopicList(a.props.topicList,a.props.data,a.props.data.spuId,a.props.data.skuId),setTimeout(function(){var e,t;a.state.topicList&&(e=a.state.topicList.filter(function(e,t){return t%2==0}).map(function(e){return e.name.length}),t=a.state.topicList.filter(function(e,t){return t%2!=0}).map(function(e){return e.name.length}),a.setState({oddMaxLeng:6<Math.max.apply(Math,e)?6:Math.max.apply(Math,e),evenMaxLeng:6<Math.max.apply(Math,t)?6:Math.max.apply(Math,t)}))},0)}),this.props.topicOpts&&this.props.topicOpts.forEach(function(t,e){var n;a.props.topicList.find(function(e){return e.name===t.name})&&a.props.topicList.find(function(e){return e.name===t.name}).values&&a.setState(((n={})["value"+t.id]=[a.props.topicList.find(function(e){return e.name===t.name}).values],n["id"+t.id]=a.props.topicList.find(function(e){return e.name===t.name}).valuesId,n))})},n.componentDidUpdate=function(a,i){var o=this,e=a.data,t=a.spuTip,n=a.skuTip,r=this.props,c=r.data,s=r.topicList,l=r.spuTip,u=r.skuTip,p=r.topicOpts,d=i.spuName,f=i.skuName,r=(i.spu,i.sku,this.state),m=r.spuName,h=r.skuName,g=r.spu,v=r.sku;JSON.stringify(t)!==JSON.stringify(l)?this.setState({spuTip:l.substring(0,8)}):JSON.stringify(n)!==JSON.stringify(u)&&this.setState({skuTip:u.substring(0,8)}),JSON.stringify(d)===JSON.stringify(m)&&JSON.stringify(f)===JSON.stringify(h)||this.setTopicList([],c,g,v),JSON.stringify(e)!==JSON.stringify(c)&&this.setState({spu:c.spuId,spuName:c.spuName,sku:c.skuId,skuName:c.skuName,spuTip:"",skuTip:""},function(){o.props.topicOpts&&o.props.topicOpts.forEach(function(t,e){var n;o.props.topicList.find(function(e){return e.name===t.name})&&(o.props.topicList.find(function(e){return e.name===t.name}).values?o.setState(((n={})["value"+t.id]=[o.props.topicList.find(function(e){return e.name===t.name}).values],n["id"+t.id]=o.props.topicList.find(function(e){return e.name===t.name}).valuesId,n)):o.setState(((n={})["value"+t.id]=void 0,n["id"+t.id]=void 0,n)))}),o.setTopicList(s,c,g,v)}),p&&p.forEach(function(t,e){var n;o.props["topicValue"+e]&&JSON.stringify(a["topicValue"+e]!==JSON.stringify(o.props["topicValue"+e]))&&o.setState(((n={})["topicValue"+e]=o.props["topicValue"+e],n)),JSON.stringify(i["value"+t.id])===JSON.stringify(o.state["value"+t.id])&&JSON.stringify(d)===JSON.stringify(m)&&JSON.stringify(f)===JSON.stringify(h)||o.setTopicList(p.map(function(e){return{id:e.id,name:e.name,values:e.id===t.id&&o.state["value"+t.id]&&o.state["value"+e.id]?o.state["value"+t.id][0]:o.state["value"+e.id]?o.state["value"+e.id][0]:""}}),c,g,v)})},n.render=function(){var a=this,e=this.props,t=e.spuList,n=e.skuList,i=e.topicOpts,o=e.onFocus,r=e.keywordSpu,c=e.spuShow,s=e.keywordSku,l=e.skuShow,u=this.state,p=u.spu,d=u.spuName,f=u.sku,m=u.spuTip,h=u.skuTip,e=u.topicList,g=u.oddMaxLeng,v=u.evenMaxLeng;return k().createElement("div",{className:"project_connection_maintainList_edit_right_wrap"},k().createElement("div",{className:"top"},k().createElement("div",{className:"spu_sku_base"},k().createElement("span",null,"SPU词条"),k().createElement("div",null,t&&k().createElement(w.Z,{show:c,onChange:function(e){a.setState({spu:e.id,spuName:e.name,spuSplit:e.split})},trigger:"click",data:t,value:p,onTipClick:function(){m&&a.setState({spuTip:""}),o()},addText:"创建SPU词条",onAddClick:function(){window.open("/account/project/base?drawerVisible=true")},className:m?"content-error":"",keyword:r}),m&&k().createElement("span",{className:"content-error-hint"},m))),k().createElement("div",{className:"spu_sku_base"},k().createElement("span",null,"SKU词条"),k().createElement("div",null,n&&k().createElement(w.Z,{show:l,onChange:function(e){a.setState({sku:e.id,skuName:e.name,skuSplit:e.split})},trigger:"click",data:p?n.filter(function(e){return e.parentId===p}):n,value:f,onTipClick:function(){h&&a.setState({skuTip:""}),o()},addText:"创建SKU词条",disabled:!p,onAddClick:function(){window.open("/account/project/base/sku?spuId="+p+"&spuName="+d+"&drawerVisible=true")},className:h?"content-error":"",keyword:s}),h&&k().createElement("span",{className:"content-error-hint"},h)))),k().createElement("div",{className:"middle"},k().createElement("div",{className:"title"},k().createElement("h4",null,"自定义主题"),k().createElement("i",{className:"icon-cem_collection-settings",onClick:function(){window.open("/product/config/topic?open=true")}})),k().createElement("div",{className:"topic_content"},i&&i.map(function(t,n){return k().createElement("div",{className:"item",key:t.id},k().createElement("span",{className:"ellipsis"},t.name),k().createElement(N.RS,{tags:!0,multiple:!1,onChange:function(e){a._handleOnSelectChange(e,n,t)},value:a.state["value"+t.id],optionLabelProp:"label",optionFilterProp:"label",placeholder:"请选择或者输入",dropdownClassName:"project_connection_maintainList_edit_topic_opts"},a.state["topicValue"+n]&&a.state["topicValue"+n].map(function(e){return k().createElement(N.Wx,{key:e.id,value:e.value,label:e.value},e.value)})))}))),k().createElement("div",{className:"bottom"},k().createElement("h4",null,"主题值总览"),k().createElement("div",null,k().createElement("div",{className:"topicValue_content"},e&&e.map(function(e,t){return k().createElement("span",{key:e.id},k().createElement("span",{className:"name",style:{width:t%2==0?12*g+16+"px":12*v+16+"px"}},e.name),k().createElement("span",{className:"value",style:{width:t%2==0?190-12*g-16-32+"px":190-12*v-16-32+"px"}},e.values))})))))},e}(k().PureComponent);var d=n(5133),o=n(64396),l=o.Z.project.connection.maintainList,u={visible:!1,id:"",nextId:"",nextData:void 0,topicList:[],isNext:!0,data:{spuName:"",skuName:"",dataId:""},detailList:[],spuTip:"",skuTip:"",keywordSpu:"",spuShow:!1,keywordSku:"",skuShow:!1,keyword:""},r=function(t){function e(e){var p=t.call(this,e)||this;return p.show=function(e){var t=e.id,n=e.nextId,a=e.nextData,i=e.topicList,o=e.data,r=e.detailList,e=e.keyword;p.setState({visible:!0,id:t,nextId:n,nextData:a,topicList:i,data:o,detailList:r,keyword:e})},p._handleOnCancel=function(){p.setState({visible:!1})},p._handleOnAddIgnore=function(o){var e=p.state,r=(e.id,e.isNext),c=e.nextId,t=e.data,s=e.keyword,e=p.props,l=(e.dataList,e.isEdit),u=e.topicOpts;"add"===o&&(p.contentRef.getValue().spuGroupId?p.contentRef.getValue().skuGroupId?p.props.fetchAdd(m()({id:t.id},p.contentRef.getValue())).then(function(e){var t,n,a,i;2e4===e.data.code&&(d.Z.success("操作成功"),t=p.contentRef.getValue().spuGroupId,n=p.contentRef.getValue().spuGroupName,h.t.setWidthProject(h.V.connectionLinkMaintainList,e.data.result,"session"),p.props.save({isEdit:!l}),r?c?(p.setState({id:c}),a=s?e.data.result.filter(function(e){return e.name.trim().toLocaleLowerCase().includes(s.trim().toLocaleLowerCase())}):e.data.result,i=a.findIndex(function(e){return e.id===c}),a.length&&p.setState({data:m()({},a.find(function(e){return e.id===c}),{spuId:"add"===o&&!a.find(function(e){return e.id===c}).spuId&&t?t:a.find(function(e){return e.id===c}).spuId,spuName:"add"===o&&!a.find(function(e){return e.id===c}).spuId&&t?n:a.find(function(e){return e.id===c}).spuName}),topicList:[{id:"平台",name:"平台",values:a.find(function(e){return e.id===c}).sourceName}].concat(u.map(function(t){return{id:t.id,name:t.name,values:a[i+1].config&&a[i+1].config.filter(function(e){return"USER_CUSTOMIZE"===e.topicType}).length&&a[i+1].config.filter(function(e){return"USER_CUSTOMIZE"===e.topicType}).find(function(e){return e.topicName===t.name})?a[i+1].config.filter(function(e){return"USER_CUSTOMIZE"===e.topicType}).find(function(e){return e.topicName===t.name}).topicValueName:"",valuesId:a[i+1].config&&a[i+1].config.filter(function(e){return"USER_CUSTOMIZE"===e.topicType}).length&&a[i+1].config.filter(function(e){return"USER_CUSTOMIZE"===e.topicType}).find(function(e){return e.topicName===t.name})?a[i+1].config.filter(function(e){return"USER_CUSTOMIZE"===e.topicType}).find(function(e){return e.topicName===t.name}).topicValueIds[0]:void 0}})),detailList:i!==a.length-1?a[i+1].config:[],nextId:i!==a.length-1?a[i+1].id:""})):(d.Z.error("当前已是最后一个商品"),p._handleOnCancel()):p._handleOnCancel())}):p.setState({skuTip:"请选择SKU词条"+(new Date).getTime()}):p.setState({spuTip:"请选择SPU词条"+(new Date).getTime()}))},p._handleOnNextChange=function(e){p.setState({isNext:e})},p._handleOnChooseSpu=function(e){var t=p.state,n=t.spuShow;t.skuShow;p.setState({keywordSpu:e,spuShow:!n,skuShow:!1})},p._handleOnChooseSku=function(e){var t=p.state,n=t.skuShow;t.spuShow;p.setState({keywordSku:e,skuShow:!n,spuShow:!1})},p.state=m()({},Object.assign({},u)),p}return c()(e,t),e.prototype.render=function(){var t=this,e=this.state,n=e.visible,a=e.isNext,i=e.topicList,o=e.data,r=e.detailList,c=e.spuTip,s=e.skuTip,l=e.keywordSpu,u=e.spuShow,p=e.keywordSku,d=e.skuShow,f=this.props,e=f.spuList,f=f.skuList;return n?k().createElement(y.Dialog,{className:"yt_product_setting_link_edit_dialog_wrapper",title:"商品链接主题维护",size:"tiny",visible:n,onCancel:this._handleOnCancel,lockScroll:!0},k().createElement(y.Dialog.Body,null,k().createElement("div",{style:{display:"flex"}},k().createElement(_,{data:o,detailList:r,onChooseSpu:function(e){return t._handleOnChooseSpu(e)},onChooseSku:function(e){return t._handleOnChooseSku(e)},keywordSku:p,keywordSpu:l}),k().createElement(C,m()({ref:function(e){return t.contentRef=e}},this.props,{data:o,spuList:e,skuList:f,topicList:i,spuTip:c,skuTip:s,keywordSpu:l,spuShow:u,keywordSku:p,skuShow:d})))),k().createElement(y.Dialog.Footer,null,k().createElement(y.Checkbox,{checked:a,onChange:this._handleOnNextChange},"下一商品"),k().createElement(y.Button,{type:"primary",onClick:function(){return t._handleOnAddIgnore("add")}},"添加"))):null},e}(k().PureComponent);const L=(0,a.connect)(function(e){var t=m()({},e),n=t[l],a=n.skuList,i=n.spuList,o=n.dataList,r=n.list,c=n.topicOpts,e=n.details,n=n.isEdit;return m()({},t[l],{skuList:a,spuList:i,dataList:o,list:r,topicOpts:c,details:e,isEdit:n})},function(t){return{fetchLinkList:function(){return t({type:l+"/fetchLinkList"})},fetchAdd:function(e){return t({type:l+"/fetchAdd",payload:e})},fetchAddTopicValue:function(e){return t({type:l+"/fetchAddTopicValue",payload:e})},save:function(e){return t({type:l+"/save",payload:e})}}},null,{withRef:!0})(r),O=function(t){function e(e){var o=t.call(this,e)||this;return o._handleOnEdit=function(n){var t=o.props.data,a=o.state.keyword,i=(t=a?t.filter(function(e){return e.name.trim().toLocaleLowerCase().includes(a.trim().toLocaleLowerCase())}):t).findIndex(function(e){return e.id===n.id});o.props.fetchTopicOpts().then(function(e){e.forEach(function(e,n){o.props.fetchTopicValue({topicId:e.id,projectId:h.t.get(h.V.curProject).id}).then(function(e){var t;2e4===e.data.code&&o.props.save(((t={})["topicValue"+n]=e.data.result.result,t))})}),o.editModalRef.wrappedInstance.show({id:n.id,nextId:i!==t.length-1?t[i+1].id:"",data:n,topicList:[{id:"平台",name:"平台",values:n.sourceName}].concat(e.map(function(t){return{id:t.id,name:t.name,values:n.config&&n.config.filter(function(e){return"USER_CUSTOMIZE"===e.topicType}).length&&n.config.filter(function(e){return"USER_CUSTOMIZE"===e.topicType}).find(function(e){return e.topicName===t.name})?n.config.filter(function(e){return"USER_CUSTOMIZE"===e.topicType}).find(function(e){return e.topicName===t.name}).topicValueName:"",valuesId:n.config&&n.config.filter(function(e){return"USER_CUSTOMIZE"===e.topicType}).length&&n.config.filter(function(e){return"USER_CUSTOMIZE"===e.topicType}).find(function(e){return e.topicName===t.name})?n.config.filter(function(e){return"USER_CUSTOMIZE"===e.topicType}).find(function(e){return e.topicName===t.name}).topicValueIds[0]:void 0}})),detailList:n.config,keyword:a})})},o._handleOnPageChange=function(e){var t=o.state.pageSize;o.setState({pageIndex:e,dataList:o.props.data.slice((e-1)*t,e*t)})},o._handleOnPageSizeChange=function(e){o.setState({pageIndex:1,pageSize:e,dataList:o.props.data.slice(0,e)})},o.state={oriData:"",columns:[],dataList:[],prefixColumns:[{fixed:"left",label:"",width:16}],keyword:"",pageIndex:1,pageSize:10},o.columns=[{label:"链接",prop:"name",width:210,fixed:"",checked:!0},{label:"操作",prop:"control",width:120,fixed:"",checked:!0}],o.columnRenders={name:function(e){return k().createElement(s.Z,{overlay:k().createElement("div",{style:{maxWidth:210}},e.name),placement:"top"},k().createElement("div",{className:"title",onClick:function(){window.open(""+e.url)}},e.name))},control:function(e){return k().createElement("div",{className:"control"},k().createElement("span",{onClick:function(){return o._handleOnEdit(e)}},"维护"),k().createElement("span",{onClick:function(){o.props.onDeleteVisible(e)}},"删除"))}},o}return c()(e,t),e.getDerivedStateFromProps=function(e,t){if((0,S.P)(e.data)&&JSON.stringify(t.oriData)!==JSON.stringify(e.data)){var a=[{label:"链接",prop:"name",width:180,fixed:"",checked:!0},{label:"操作",prop:"control",width:120,fixed:"right",checked:!0}];return e.data&&e.data.forEach(function(t,e){var n;t.config&&(0===e&&(n=[],t.config.forEach(function(t){n.some(function(e){return e.label===t.topicName})||n.push({label:t.topicName,prop:t.topicName,width:58,fixed:"",checked:!0})}),a.splice.apply(a,[1,0].concat(n))),t&&t.config.forEach(function(e){t[e.topicName]=k().createElement("span",{title:e.topicValueName},e.topicValueName)}))}),{columns:a,dataList:e.data.slice((t.pageIndex-1)*t.pageSize,t.pageIndex*t.pageSize)}}return null},e.prototype.render=function(){var t=this,e=this.props,n=e.noticeShow,a=e.onCancel,i=e.onDelete,o=e.data,r=e.deleteVisible,c=(e.searchTitleWord,e.total,e.onFocus),s=(e.onSearch,this.state),l=s.prefixColumns,u=s.columns,p=s.pageIndex,d=s.pageSize,e=s.dataList,f=s.keyword;return k().createElement(k().Fragment,null,k().createElement("div",{className:"operate_zone",style:{top:n?72:16}}),k().createElement("div",{className:"top_zone"},k().createElement(E.Z,{onSearch:function(e){t.setState({pageIndex:1,keyword:e})},onClear:function(e){t.setState({pageIndex:1,keyword:e})},placeholder:"搜索链接",defValue:f,style:{width:198}})),k().createElement(v.Z,m()({},this.props,{data:0<e.length&&f?e.filter(function(e){return e.name.trim().toLocaleLowerCase().includes(f.trim().toLocaleLowerCase())}):e,prefixColumns:l,columns:u,columnRenders:this.columnRenders,headerRenders:this.headerRenders,savedKey:"project_connection_maintainList",rowKeyProp:"id",onPageChange:this._handleOnPageChange,onPageSizeChange:this._handleOnPageSizeChange,pageIndex:p,pageSize:d,total:o?o.length:0})),k().createElement(y.Dialog,{className:"yt_project_connection_maintainList_delete_dialog_wrapper",size:"tiny",visible:r,title:"确定要删除此链接？",closeOnClickModal:!1,onCancel:a},k().createElement(y.Dialog.Body,null,"删除后，不可再找回。"),k().createElement(y.Dialog.Footer,null,k().createElement(y.Button,{onClick:a},"取消"),k().createElement(y.Button,{type:"primary",onClick:i},"确定"))),k().createElement(L,{ref:function(e){return t.editModalRef=e},onFocus:c}))},e}(t.PureComponent);var x=n(46701);const p=function(e){var t=k().useState(!0),n=t[0],a=t[1],i=k().useState(!1),o=i[0],r=i[1],c=k().useState(""),s=c[0],l=c[1],u=k().useState(h.t.getWidthProject(h.V.connectionLinkMaintainList,"session")&&h.t.getWidthProject(h.V.connectionLinkMaintainList,"session").length?h.t.getWidthProject(h.V.connectionLinkMaintainList,"session"):[]),p=u[0],d=u[1],f=e.onDelete,m=e.fetchTopicOpts,t=e.fetchTopicValue,i=e.save,c=e.isEdit,u=e.onFocus,e=e.location;k().useEffect(function(){(0,S.P)(h.t.getWidthProject(h.V.connectionLinkMaintainList,"session"))&&d(h.t.getWidthProject(h.V.connectionLinkMaintainList,"session"))},[c]);e=e.pathname.split("/")[3];return k().createElement("div",{className:"project_maintain_list_wrapper"},k().createElement(g.Z,{title:(0,x.u)({title:"待维护商品链接",url:"/account/project/"+e+"/batchAdd"})}),k().createElement("div",{className:"content"},k().createElement("div",{className:"tableList_wrap"},k().createElement("div",{className:"notice_zone",style:{display:n?"block":"none"}},"关闭浏览器就会清空当前列表，刷新或者重新打开不会清空。",k().createElement("i",{className:"icon-cem_cancel",onClick:function(){a(!n)}})),k().createElement(O,{className:"list_content_wrap",noticeShow:n,data:p&&p.length?p:[],deleteVisible:o,onCancel:function(){r(!1)},onDeleteVisible:function(e){l(e.id),r(!0)},onDelete:function(){f(s),r(!1)},onFocus:u,fetchTopicOpts:m,fetchTopicValue:t,save:i}))))};var f=o.Z.project.connection.maintainList,o=function(t){function e(e){var c=t.call(this,e)||this;return c._handleOnFocus=function(){var e=c.props,t=e.spuList,n=e.skuList,e=h.t.get(h.V.newEntry)||{},a=e.spuName,i=e.skuName,o=e.spuId,r=e.skuId;(a&&!t.find(function(e){return a.includes(e.name.replaceAll(e.split,"").replaceAll("|",""))})||i&&!n.find(function(e){return i.includes(e.name.replaceAll(e.split,"").replaceAll("|",""))})||o&&!t.find(function(e){return String(e.id)===String(o)})||r&&!n.find(function(e){return String(e.id)===String(r)}))&&c.props.fetchEntryOpts({projectId:h.t.get(h.V.curProject).id,id:1})},c._handleOnSearch=function(e){c.props.fetchLinkList({searchTitleWord:e,pageIndex:1})},c._handleOnDelete=function(e){c.props.fetchDelete({id:e})},c.state={data:[]},c.event={onSearch:c._handleOnSearch,onDelete:c._handleOnDelete,onPageChange:c._handleOnPageChange,onPageSizeChange:c._handleOnPageSizeChange,onFocus:c._handleOnFocus},c}c()(e,t);var n=e.prototype;return n.componentDidMount=function(){this.props.fetchEntryOpts({batchNo:this.props.location.state&&this.props.location.state.batchNo?this.props.location.state.batchNo:"",projectId:h.t.get(h.V.curProject).id})},n.componentWillUnmount=function(){},n.render=function(){return k().createElement(p,m()({},this.props,this.state,this.event))},e}(k().PureComponent);const b=(0,a.connect)(function(e){var t=e.loading,e=i()(e,["loading"]);return m()({},e[f],{loading:t.effects[f+"/fetchLinkList"]||!1})},function(t){return{fetchLinkList:function(e){return t({type:f+"/fetchLinkList",payload:e})},fetchDelete:function(e){return t({type:f+"/fetchDelete",payload:e})},fetchAdd:function(e){return t({type:f+"/fetchAdd",payload:e})},fetchTopicOpts:function(){return t({type:f+"/fetchTopicOpts"})},fetchTopicValue:function(e){return t({type:f+"/fetchTopicValue",payload:e})},fetchAddTopicValue:function(e){return t({type:f+"/fetchAddTopicValue",payload:e})},fetchEntryOpts:function(e){return t({type:f+"/fetchEntryOpts",payload:e})},fetchClear:function(e){return t({type:f+"/fetchClear",payload:e})},save:function(e){return t({type:f+"/save",payload:e})},clean:function(e){return t({type:f+"/clean",payload:e})}}})(o)},46701:(e,t,n)=>{"use strict";n.d(t,{u:()=>i});var a=n(35239),i=function(e){var t=e.title,e=e.url;return[{title:"所有项目",url:"/account/project"},{title:a.t.get(a.V.backProjectConfig).name,url:"/account/project/preview"},{title:"comment"===e.split("/")[3]?"电商评论":"price"===e.split("/")[3]?"电商监控":"数据链接",url:"/account/project/"+e.split("/")[3]},{title:t,url:e}]}},17190:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var t=n(67154),a=n.n(t),t=n(85354),i=n.n(t),t=n(67294),_=n.n(t),r=void 0;const N=function(e){var t=e.data.name,n=e.onCheck,a=e.checked,e=_().useState(a),i=e[0],o=e[1];return _().useEffect(function(){o(a)},[a]),_().createElement("label",{className:"el-checkbox yt_product_subscribe_editable-radio",onClick:function(e){r=setTimeout(function(){r&&clearTimeout(r);var e=!i;o(e),n(e)},100)}},_().createElement("input",{value:t,className:"ec-label "+(i?"is_checked":""),title:t,maxLength:6,style:{background:"transparent"}}))};var c=n(92360),s=void 0;const w=function(e){var t=e.keyword,n=e.onCloseClick,a=e.onChange,i=_().useState(t),e=i[0],o=i[1];return _().useEffect(function(){o(t)},[t]),_().createElement(c.Input,{placeholder:"请输入关键字",value:e,icon:e&&"close",onIconClick:function(){o(""),n()},onChange:function(e){o(e),s&&clearTimeout(s),s=setTimeout(function(){a(e),s=void 0},500)}})};const o=function(e){var t=e.className,n=e.onTipClick,a=e.show,i=e.onClick,o=e.onMouseEnter,r=e.onMouseLeave,c=e.addText,s=e.data,l=e.value,u=e.trigger,p=e.defaultValue,d=e.onTagChange,f=e.getTagListRef,m=e.onAddClick,h=e.disabled,g=e.keyword,v=l&&s.find(function(e){return e.id===l})?s.find(function(e){return e.id===l}).name:p&&s&&s.some(function(e){return e.id===p})?s&&s.find(function(e){return e.id===p}).name:s&&s.length?"请选择":"请添加",k=_().useState(g||""),S=k[0],y=k[1],e=_().useState(s),k=e[0],E=e[1];return _().useEffect(function(){E(s)},[s]),_().useEffect(function(){var e=S?s.filter(function(e){return 0<=e.name.toLowerCase().indexOf(S.toLowerCase())}):s;E(e)},[S,s]),_().useEffect(function(){g&&y(g)},[g]),_().createElement("div",{className:"yt_product_setting_edit_input_select_wraper "+t,onClick:"click"===u&&n,onMouseEnter:"hover"===u&&n,onMouseLeave:function(){"hover"===u&&(r(),S&&y(""))}},_().createElement("div",null,_().createElement("div",{className:"ets-trigger",onClick:function(){"click"===u&&(i(),S&&y(""))},onMouseEnter:function(){"hover"===u&&(a||o())}},_().createElement("span",{className:"ets-trigger-title",style:{color:l||!s||s.find(function(e){return e.id===l})||p?"#262626":"#bfbfbf"}},v),_().createElement("i",{className:"icon-cem_pull-down-or-take-up",style:{transform:a?"rotate(-180deg)":""}})),_().createElement("div",{className:"ets-option-panel "+(a?"ets-show":""),onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},_().createElement("div",{className:"ets-list",ref:f},s&&0<s.length?_().createElement(_().Fragment,null,_().createElement("div",{style:{maxHeight:260}},_().createElement("div",{className:"ets-search"},_().createElement(w,{keyword:S,onChange:y,onCloseClick:function(){return y("")}})),_().createElement("div",{className:"ets-list-content"},k&&0<k.length?_().createElement(_().Fragment,null,k.slice(0,100).map(function(e){return _().createElement(N,{key:e.id,data:e,checked:l===e.id,onCheck:function(){return e.id?d({id:e.id,name:e.name,split:e.split}):d({name:e.name,split:e.split})}})}),99<k.length&&_().createElement("div",{style:{color:"#d96969",paddingLeft:"18px",fontSize:"12px"}},"— 查看更多请搜索")):_().createElement("div",{className:"no_data"},"暂无数据")))):_().createElement("div",{className:"no_data"},"暂无数据")),_().createElement("div",{className:"ets-add"},_().createElement("div",{className:"ets-add-diviver"}),_().createElement("div",{className:"add_btn "+(h?"add_disabled_btn":""),onClick:function(){h||(m(),S&&y(""),("click"===u?i:o)())}},c)))))},l=function(t){function e(e){var n=t.call(this,e)||this;return n._handleOnTagChange=function(e){n.props.onChange(e),n._setPadShowFalse()},n._setPadShowFalse=function(){n.state.show&&n.setState({show:!1})},n._setPadShowTrue=function(){n.state.show||n.setState({show:!0})},n._handleOnMouseEnter=function(){var e=n.state.show;setTimeout(function(){n.setState({show:!e})},0)},n._handleOnClick=function(e){var t=n.state.show;setTimeout(function(){n.setState({show:!t})},0)},n.tagListRef=void 0,n.state={show:!1},n.event={onClick:n._handleOnClick,onMouseEnter:n._handleOnMouseEnter,onMouseLeave:n._setPadShowFalse,onTagChange:n._handleOnTagChange,getTagListRef:function(e){return n.tagListRef=e}},n}i()(e,t);var n=e.prototype;return n.UNSAFE_componentWillReceiveProps=function(e){e.show!==this.props.show&&this._setPadShowTrue()},n.componentDidMount=function(){window.addEventListener("click",this._setPadShowFalse)},n.componentWillUnmount=function(){window.addEventListener("click",this._setPadShowFalse)},n.render=function(){return _().createElement(o,a()({},this.props,this.state,this.event))},e}(_().PureComponent)},61918:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var t=n(67294),u=n.n(t),t=n(45697),n=n.n(t),t=function(e){var t=e.className,n=e.onClear,a=e.onSearch,i=e.placeholder,o=e.style,r=e.defValue,c=e.signal,e=u().useState(r),s=e[0],l=e[1];u().useEffect(function(){l(r)},[r,c]);return u().createElement("div",{style:o,className:"yt_search_input_wrapper "+(t||"")},u().createElement("input",{placeholder:i,value:s,onKeyDown:function(e){13===e.keyCode&&a(s)},onChange:function(e){return l(e.target.value)},autoComplete:"off"}),s&&u().createElement("i",{className:"icon-cem_log-off",onClick:function(){l(""),n&&n("")}}),u().createElement("i",{className:"icon-cem_small-search",onClick:function(){return a(s)}}))};t.propTypes={className:n().string,onSearch:n().func.isRequired,placeholder:n().string,style:n().object,defValue:n().string,signal:n().any,onClear:n().func};const a=t},2271:(e,t,n)=>{"use strict";n.d(t,{Z:()=>L});var a=n(37316),d=n.n(a),t=n(67154),f=n.n(t),a=n(93913),i=n.n(a),t=n(85354),o=n.n(t),a=n(23279),r=n.n(a),t=n(67294),m=n.n(t),h=n(92360),l=n(35303),a=n(45697),t=n.n(a),u=[{label:"10项/页",value:10},{label:"20项/页",value:20},{label:"40项/页",value:40},{label:"100项/页",value:100}];const g=function(e){var t=e.onPageChange,n=e.onSizeChange,a=e.total,i=void 0===a?0:a,o=e.pageIndex,r=e.pageSize,c=e.currLength,s=e.layout,a=e.className,e=0===i?0:(o-1)*r+1,c=0===i?0:e+c-1;return 0===i?null:m().createElement("div",{className:"yt-awp-pagination "+(a||"")},m().createElement("span",{className:"total_num"},m().createElement("span",null,e+" - "+c+" "),"项，共",m().createElement("span",null," "+i+" "),"项"),m().createElement("div",{style:{textAlign:"right",float:"right"},className:"new_pagination"},m().createElement(h.Pagination,{small:!0,pageSize:r,currentPage:o,pageCount:Math.ceil(i/r),layout:0===i?"":"prev, pager, next",onCurrentChange:t}),void 0===s||s.includes("sizes")?m().createElement(l.RS,{multiple:!1,tags:!1,showSearch:!1,optionFilterProp:"label",optionLabelProp:"label",animation:"slide-up",dropdownClassName:"custom-pagination-dropdown",value:r||10,onChange:n},u.map(function(e,t){return m().createElement(l.Wx,{key:t,label:e.label,value:e.value},e.label)})):null))};t().propTypes={onPageChange:t().func,onSizeChange:t().func,total:t().number,pageIndex:t().number,pageSize:t().number,currLength:t().number,layout:t().string,className:t().string};var v=n(8201),a=n(48926),c=n.n(a),a=n(87757),s=n.n(a),p=n(36144);function k(){return(k=c()(s().mark(function e(t){var n,a;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectId,a=t.key,e.abrupt("return",p.h.post("/default/value/find",{projectId:n,key:a}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function S(){return(S=c()(s().mark(function e(t){var n,a,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectId,a=t.value,i=t.key,e.abrupt("return",p.h.post("/default/value/update",{projectId:n,key:i,value:a}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}var y=n(39432),E=n(43036),_=n(51474),N=n(87219),a=function(t){function e(e){var l=t.call(this,e)||this;return l._setShowFalse=function(){l.setState({show:!1})},l._handleParentClick=function(e){l.state.show&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},l._handleOnTriggerClick=function(){setTimeout(function(){l.setState({show:!l.state.show})},0)},l._renderOptionItem=function(t,e,n,a,i,o){var r=l.state.maxLabelWidth,c=l.props,s=c.value,c=c.savedKey,s=s.find(function(e){return e.prop===t.prop});return m().createElement("div",{className:"opt_item "+(e?"draggable":""),key:t.prop},e&&m().createElement("i",{className:"icon-cem_move my_handle"}),m().createElement("div",{className:"opt_content",style:{width:r,marginLeft:e?0:12}},m().createElement("div",{className:"item_label",onClick:function(e){e.stopPropagation(),l._handleOnItemClick(t.prop)}},m().createElement("span",{className:"icon_checkbox "+(s&&s.checked?"checkbox_checked":"")}),m().createElement("span",null,t.label)),m().createElement("div",{className:"item_control",style:{display:"product_setting_link"===c?"none":"block"}},m().createElement(E.Z,{placement:"top",overlay:n},m().createElement("span",{onClick:function(e){return a(e,t.prop)}},m().createElement("i",{className:(e?"icon-cem_up":"icon-cem_up-and-down")+" fun_icon_a"}))),m().createElement(E.Z,{placement:"top",overlay:i},m().createElement("span",{onClick:function(e){return o(e,t.prop)},style:{marginLeft:4}},m().createElement("i",{className:"icon-cem_down fun_icon_b"}))))))},l._handleOnItemClick=function(t){var e=l.props,n=e.value,e=e.onChange;e&&e((0,N.ZP)(n,function(e){e=e.find(function(e){return e.prop===t});e&&(e.checked=!e.checked)}))},l._handleOnFilxedLeftClick=function(e,t){e.stopPropagation(),l._handleOnFixedChange(t,"left")},l._handleOnCancelFixedClick=function(e,t){e.stopPropagation(),l._handleOnFixedChange(t,"")},l._handleOnFixedRightClick=function(e,t){e.stopPropagation(),l._handleOnFixedChange(t,"right")},l._handleOnFixedChange=function(t,n){var e=l.props,a=e.value,e=e.onChange;e&&e((0,N.ZP)(a,function(e){e=e.find(function(e){return e.prop===t});e&&(e.fixed=n)}))},l.state={show:!1,value:[],leftOpts:[],normalOpts:[],rightOpts:[],maxLabelWidth:e.value.reduce(function(e,t){return Math.max((0,y.jD)(t.label,14)+56+16+16,e)},0)},l}o()(e,t),e.getDerivedStateFromProps=function(a,e){if(JSON.stringify(a.value)===JSON.stringify(e.value))return null;var t=a.value.reduce(function(e,t){var n=1;return"left"===t.fixed&&(n=0),e[n="right"===t.fixed?2:n].push(a.value.find(function(e){return e.prop===t.prop})),e},[[],[],[]]),n=t[0],e=t[1],t=t[2];return{value:a.value,leftOpts:n,normalOpts:e,rightOpts:t,maxLabelWidth:a.value.reduce(function(e,t){return Math.max((0,y.jD)(t.label,14)+56+16+16,e)},0)}};var n=e.prototype;return n.componentDidMount=function(){var r=this;window.addEventListener("click",this._setShowFalse);var e=document.querySelectorAll("#draggable_zone");e.length&&e.forEach(function(e){_.ZP.create(e,{group:"draggable_zone",animation:150,filter:".undraggable",draggable:".draggable",handle:".my_handle",onEnd:function(e){var t=r.props,n=t.value,a=t.onChange,i=e.newIndex,o=e.oldIndex;i!==o&&(t=n.filter(function(e){return"left"===e.fixed}),e=n.filter(function(e){return"right"===e.fixed}),n=(0,N.ZP)(n.filter(function(e){return!e.fixed}),function(e){var t=e.splice(o,1)[0];e.splice(i,0,t)}),a&&a([].concat(t,n,e)))}})})},n.componentWillUnmount=function(){window.removeEventListener("click",this._setShowFalse)},n.render=function(){var t=this,e=this.state,n=e.show,a=e.leftOpts,i=e.normalOpts,o=e.rightOpts,r=this.props,e=r.className,r=r.title;return m().createElement("div",{className:"yt_columns_selector_wrapper "+(e||""),onClick:this._handleParentClick},m().createElement("div",{className:"trigger "+(n?"sel":""),onClick:this._handleOnTriggerClick},r||"列",m().createElement("i",{className:"icon-cem_arrow-launches",style:{transform:n?"rotate(-180deg)":""}})),m().createElement("div",{className:"options "+(n?"active":"")},0<a.length&&m().createElement(m().Fragment,null,m().createElement("div",{className:"opt_label"},"固定在左侧"),a.map(function(e){return t._renderOptionItem(e,!1,"不固定",t._handleOnCancelFixedClick,"固定在列尾",t._handleOnFixedRightClick)})),(0<a.length||0<o.length)&&m().createElement("div",{className:"opt_label"},"不固定"),m().createElement("div",{id:"draggable_zone",style:{visibility:0<i.length}},i.map(function(e){return t._renderOptionItem(e,!0,"固定在列头",t._handleOnFilxedLeftClick,"固定在列尾",t._handleOnFixedRightClick)})),0<o.length&&m().createElement(m().Fragment,null,m().createElement("div",{className:"opt_label"},"固定在右侧"),o.map(function(e){return t._renderOptionItem(e,!1,"不固定",t._handleOnCancelFixedClick,"固定在列头",t._handleOnFilxedLeftClick)}))))},e}(m().PureComponent);const w=a;a.propTypes={className:t().string,title:t().string,value:t().arrayOf(t().shape({label:t().string,prop:t().string,fixed:t().string,checked:t().bool})),onChange:t().func};var C=n(35239),a=function(t){function e(e){var n=t.call(this,e)||this;return n._handleOnResize=function(){var e=document.querySelector(".yt-listview-wrapper");e&&n.setState({tableWidth:e.clientWidth-5})},n._handleOnColumnsChange=function(e){n.setState({columns:e},function(){n.props.savedKey&&!function(){return S.apply(this,arguments)}({projectId:C.t.get(C.V.curProject).id,key:n.props.savedKey,value:JSON.stringify(e.map(function(e){return{prop:e.prop,checked:e.checked,fixed:e.fixed}}))}).then(function(e){e.data})})},n.handleRoKey=function(e){var t=n.props.rowKeyProp;return t&&e&&e[t]?e[t]:JSON.stringify(e)},n.state={talbeWidth:0,columns:e.columns||[],loadingSave:!0},n}o()(e,t),e.getDerivedStateFromProps=function(e,t){};var n=e.prototype;return n.componentDidMount=function(){var n=this;window.addEventListener("resize",r()(this._handleOnResize,150)),this._handleOnResize();var e=this.props,t=e.savedKey,i=e.columns;t&&!function(){return k.apply(this,arguments)}({projectId:C.t.get(C.V.curProject).id,key:t}).then(function(e){var t,a=e.data;if(2e4===a.code)try{t=i.map(function(t,e){var n=JSON.parse(a.result).filter(function(e){e=e.prop;return t.prop===e});return n&&0<n.length?f()({},t,n[0]):t}).filter(function(e){return e})}catch(e){}finally{n.setState({columns:t||n.state.columns,loadingSave:!1})}})},n.componentWillUnmount=function(){window.removeEventListener("resize",this._handleOnResize)},n.componentDidUpdate=function(e,t){var i=this;JSON.stringify(e.columns)!==JSON.stringify(this.props.columns)&&0<this.props.columns.length&&this.setState({columns:this.props.columns.reduce(function(e,t,n){var a=i.state.columns.findIndex(function(e){e=e.prop;return t.prop===e});return e.splice(-1<a?a:n,0,f()({},t,i.state.columns[a])),e},[]).filter(function(e){return e})})},n.render=function(){var e=this.props,t=e.data,n=e.total,a=void 0===n?0:n,i=e.loading,o=e.savedKey,r=e.pageIndex,c=e.pageSize,s=e.onPageChange,l=e.onPageSizeChange,u=e.className,p=void 0===u?"":u,n=d()(e,["data","total","loading","savedKey","pageIndex","pageSize","onPageChange","onPageSizeChange","className"]),u=this.state,e=u.columns,u=u.loadingSave;return m().createElement(v.Z,{data:t,className:"yt-listview-wrapper "+p,loading:o&&u||i},(0,v.P)(t)&&m().createElement(m().Fragment,null,m().createElement(h.Table,f()({},n,{columns:(o?this:this.props).columns,data:t,rowKey:this.handleRoKey})),s&&m().createElement(g,{onPageChange:s,onSizeChange:l,total:a,currLength:t.length,pageIndex:r,pageSize:c}),o&&m().createElement(w,{className:"column_selector",value:e,savedKey:o,onChange:this._handleOnColumnsChange})))},i()(e,[{key:"columns",get:function(){var t,e=this.state,n=e.tableWidth,a=e.columns,i=this.props,e=i.columnRenders,o=void 0===e?{}:e,e=i.headerRenders,r=void 0===e?{}:e,i=i.prefixColumns,c=0,s=0,l=0,a=[].concat(void 0===i?[]:i,JSON.parse(JSON.stringify(a.filter(function(e){e=e.checked;return void 0===e||e}))));return a.forEach(function(e){l+=e.width,e.fixed?c+=e.width:s+=e.width;var t=o[e.prop];t&&(e.render=t);t=r[e.prop];t&&(e.renderHeader=t)}),l<n&&(t=n-c,a.forEach(function(e){void 0!==e.checked&&!e.checked||e.fixed||(e.width=e.width/s*t)})),a}}]),e}(m().PureComponent);a.propTypes={className:t().string,savedKey:t().string.isRequired,rowKeyProp:t().string,data:t().any.isRequired,total:t().number,fixedHeight:t().bool,loading:t().bool,pageIndex:t().number,pageSize:t().number,onPageChange:t().func,onPageSizeChange:t().func,columnRenders:t().shape(((n={})[t().string]=t().func,n)),headerRenders:t().shape(((n={})[t().string]=t().func,n)),prefixColumns:t().arrayOf(t().shape({label:t().string,prop:t().string,fixed:t().oneOf(["","left","right"]),width:t().number,checked:t().bool})),columns:t().arrayOf(t().shape({label:t().string,prop:t().string,fixed:t().oneOf(["","left","right"]),width:t().number,checked:t().bool})).isRequired};const L=a}}]);