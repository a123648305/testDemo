(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[5619],{75619:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>x});var a=t(37316),r=t.n(a),o=t(67154),p=t.n(o),i=t(85354),s=t.n(i),n=t(67294),c=t.n(n),a=t(55609),o=(t(35239),t(64396)),u=t(97189),g=t(61409),i=(t(5133),t(93913)),l=t.n(i),h=t(89565),d=t(70597),f=t(14187),C=t(73119);const v=function(n){function e(e){var r=n.call(this,e)||this;return r.renderQuestion=function(e,n,t){var e=C.Z[f.yK[e]],a=r.props.onValueChange;return c().createElement(e,p()({},n,{ref:function(e){return r.quesRef[t]=e},showType:"answer",key:t,onValueChange:function(e){return a({index:t,value:e})}}))},r._handelPageChangeTest=function(e){var n=r.props.pageIndexChange,t=!0;"next"!==e&&"submit"!==e||r.quesRef.forEach(function(e){e&&e.test&&!e.test()&&(console.error("第"+e.props.number+"题校验失败"),t=!1)}),t&&(r.quesRef=[],n(e))},r.state={},r.quesRef=[],r}s()(e,n);var t=e.prototype;return t.componentDidMount=function(){},t.render=function(){var t=this,e=this.props,n=e.list,a=e.headerConfig,r=e.pageButtonConfig,o=e.pageIndex,e=n[o];return c().createElement("div",{className:"questions_list"},c().createElement(d.Z,{list:n,headerConfig:a,pageButtonConfig:r,pageIndex:o,showType:"answer",pageButtonClick:this._handelPageChangeTest},e&&e.questionTypes&&e.questionTypes.map(function(e,n){return t.renderQuestion(e.type,e,n)})))},e}(n.Component);var m=t(8201);const y=function(t){function e(e){var n=t.call(this,e)||this;return n.state={isPc:"pc"==(e=navigator.userAgent.toLowerCase(),/ipad|iphone|midp|rv:1.2.3.4|ucweb|android|windows ce|windows mobile/.test(e)?"mobile":"pc")},n}return s()(e,t),e.prototype.render=function(){var e=this.list,n=this.state.isPc,t=this.props,a=t.pageIndex,r=t.pageButtonConfig,o=t.headerConfig,i=t.fetchingConfig,s=t.pageIndexChange,u=t.onValueChange,t=t.submiting;return c().createElement("div",{className:"research_answer "+(n?"pc_wrap":"")},c().createElement("div",{className:n?"pc_show":""},c().createElement(m.Z,{data:i?void 0:[],loading:t},c().createElement("div",{className:"answer_wrap"},c().createElement(v,p()({},this.props,{headerConfig:o,pageButtonConfig:r,pageIndexChange:s,list:e,pageIndex:a,onValueChange:u}))))))},l()(e,[{key:"list",get:function(){return(0,h.P0)(this.props.list)}}]),e}(n.Component);var I=o.Z.research.answer,w=o.Z.research.questions,n=function(n){function e(e){var r=n.call(this,e)||this;return r._handelValueChange=function(e){r.leaveHookTest=!1,r.props.valueChange(e)},r._handelPageIndexChange=function(e){var n=r.props,t=n.pageIndex,a=n.submit,n=n.changePageIndex;"submit"!==e?n("prev"===e?t-1:t+1):a().then(function(){r.leaveHookTest=!0,r.props.save({pageIndex:r.props.list.length-2})})},r.routerWillLeave=function(){return!!r.leaveHookTest||"信息还未保存，确认要离开？"},r.state={},r._event={onValueChange:r._handelValueChange,pageIndexChange:r._handelPageIndexChange},r}s()(e,n);var t=e.prototype;return t.componentDidMount=function(){var e=this;(0,u.getQuery)("id")||(0,u.getQuery)("detailId")||(0,u.getQuery)("channel")?this.props.fetchConfig({id:(0,u.getQuery)("id"),isAnswer:!0,detailId:(0,u.getQuery)("detailId"),channel:(0,u.getQuery)("channel")}).then(function(){"DELETED"===e.props.status?g.mW.push("/notFind"):"DISPATCHED"!==e.props.status&&e.props.save({pageIndex:e.props.list.length-1})}):g.mW.push("/notFind")},t.componentWillUnmount=function(){this.props.clear()},t.render=function(){return c().createElement(y,p()({},this.state,this.props,this._event))},e}(n.Component);const x=(0,a.connect)(function(e){var n=e.loading,e=r()(e,["loading"]);return p()({},e[I],e[w],{fetchingConfig:n.effects[w+"/fetchConfig"]||!1,submiting:n.effects[I+"/submit"]||!1})},function(n){return{save:function(e){return n({type:I+"/save",payload:e})},fetchConfig:function(e){return n({type:w+"/fetchConfig",payload:e})},changePageIndex:function(e){return n({type:I+"/changePageIndex",payload:e})},valueChange:function(e){return n({type:I+"/valueChange",payload:e})},submit:function(e){return n({type:I+"/submit",payload:e})},clear:function(){return n({type:I+"/clear"})}}})(n)}}]);