(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[8971],{59132:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var t=n(67294),u=n.n(t),d=n(43036),p=n(25713),h=n(39432),t=n(45697),t=n.n(t),m=n(8201),n=function(e){var t=e.title,n=void 0===t?"":t,a=e.data,r=e.titleOverlay,o=e.titleSelector,l=e.children,i=e.onMoreClick,c=e.moreOptions,s=e.className,t=e.status,a=(e.id,!(0,m.P)(a));return u().createElement("div",{className:"yt_dashboard_chart_title_wrapper "+(s||"")},u().createElement("span",{className:"chart_title"},a&&u().createElement("span",{className:"chart_title_name"},n),(o||r)&&u().createElement("span",{className:"chart_title_suffix",style:{marginLeft:a?0:(0,h.jD)(n)+14+(o?14:0)}},!!o&&o,r&&u().createElement(d.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:r},u().createElement("i",{className:"icon-cem_file1"})))),u().createElement("span",{className:"chart_title_buttons"},l,i&&u().createElement(p.Z,{disabled:t||!1,disableType:["copy","edit"],panelOverlay:"出于某种原因，如相关负责人要求\r下架，该图表模板已下架，你可以\r去添加能够满足相同分析意图的图\r表。如果你仍需要该图表，请联系\r系统管理员。",onClick:i,options:c})))};const a=n;n.propTypes={data:t().any,title:t().string,titleOverlay:t().string,titleSelector:t().node,onMoreClick:t().func,moreOptions:t().array}},88971:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>D});var a=n(37316),i=n.n(a),r=n(67154),W=n.n(r),t=n(85354),o=n.n(t),a=n(67294),R=n.n(a),p=n(19586),r=n(69968),s=n.n(r),u=n(87219),V=n(50976),P=n(8201),t=n(45697),r=n.n(t),d=(n(36144),n(35239)),t=n(94184),h=n.n(t),l=[{name:"按天",id:"DAY"},{name:"按周",id:"WEEK"},{name:"按月",id:"MONTH"}],M=function(n){function e(e){var t=Object.prototype.hasOwnProperty.call(e,"dateRange"),r=n.call(this,e)||this;return r.handleToggleDisplay=function(e){var t=r.state.panelShow;setTimeout(function(){return r.setState({panelShow:!t})},0)},r.handleParentClick=function(e){r.state.panelShow&&r.props.showFlavor&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},r.handleCollapse=function(){return r.setState({panelShow:!1})},r.handleSwitchValue=function(t){var e,n=r.state.dateOptions,a=r.props.onChange;t!==r.state.value&&(e=(0<n.filter(function(e){return e.id===t}).length?n.filter(function(e){return e.id===t}):n)[0].id,r.setState({value:t},function(){return a&&a(e)}))},r.DATE_DIMENSIONS=t?[{id:"HOUR",name:"按时"}].concat(l):l,r.state={value:"",dateRange:parseInt(e.dateRange),dateOptions:t?[{id:"HOUR",name:"按时"}].concat(l):l,panelShow:!1},r}o()(e,n);var t=e.prototype;return t.componentDidMount=function(){var e=this.props,t=(e.uniqueId,e.dateRange),n=e.onChange,e=this.state.value;this.projectId=d.t.get(d.V.curProject).id,window.addEventListener("click",this.handleCollapse),Object.prototype.hasOwnProperty.call(this.props,"dateRange")?this.getCurrDateOptions(parseInt(t),!0):n&&n(e)},t.componentWillUnmount=function(){window.removeEventListener("click",this.handleCollapse)},t.componentDidUpdate=function(e,t){var n=this,a=this.props,r=a.dateRange,a=a.defaultValue;e.dateRange!==r&&this.setState({dateRange:parseInt(r)},function(){return n.getCurrDateOptions(parseInt(r))}),e.defaultValue!==a&&this.setState({value:a})},t.getCurrDateOptions=function(e,t){var n,a,r,o,l,i,c,s=this;1<=e&&(i=this.props,n=i.onChange,a=i.noHour,r=i.collectValue,o=i.defaultValue,l=this.DATE_DIMENSIONS,i=[],c="",c=1===e?(i=l.slice(a?1:0,a?2:1),(a?l.filter(function(e){return"按天"===e.name}):l.filter(function(e){return"按时"===e.name}))[0].id):1<e&&e<=7?(i=l.slice(a?1:0,a?3:2),l.filter(function(e){return"按天"===e.name})[0].id):7<e&&e<=30?(i=l.slice(a?1:0,a?4:3),l.filter(function(e){return"按天"===e.name})[0].id):30<e&&e<=60?(i=l.slice(1,a?5:4),l.filter(function(e){return"按天"===e.name})[0].id):60<e&&e<=180?(i=l.slice(1,a?5:4),l.filter(function(e){return"按周"===e.name})[0].id):(i=l.slice(1,a?5:4),l.filter(function(e){return"按月"===e.name})[0].id),t&&i.some(function(e){return e.id===r})?c=r:t&&i.some(function(e){return e.id===o})?c=o:i.some(function(e){return e.id===s.state.value})&&(c=this.state.value),this.setState({dateOptions:i,value:c},function(){n&&n(c)}))},t.render=function(){var a=this,e=this.props,t=e.style,r=e.showFlavor,o=e.collectValue,l=e.updateCollectValue,n=this.state,i=n.dateOptions,c=n.value,e=n.panelShow,n=i.filter(function(e){return e.id===c})[0]&&i.filter(function(e){return e.id===c})[0].name;return R().createElement("div",{className:"dashboard_date_dimension_selector_wrapper",style:t,onClick:this.handleParentClick},R().createElement("div",{className:e?"date_dimension_btn active":"date_dimension_btn",onClick:this.handleToggleDisplay},R().createElement("span",null,n),R().createElement("i",{className:"icon icon-cem_arrow-launches",style:{transform:e?"rotate(-180deg)":""}})),R().createElement("ul",{className:"date_dimension_panel",style:{display:e?"inline-block":"none"}},i.map(function(e){var t=e.name,n=e.id;return R().createElement("li",{className:h()(c===n?"date_dimension_item active":"date_dimension",r&&"flavor_style"),key:n,onClick:function(){return a.handleSwitchValue(n)}},R().createElement("span",null,t),R().createElement("i",{className:o===n?"icon-cem_collection-settings stared":"icon-cem_collection-settings",onClick:function(e){e.stopPropagation(),l(n===o?void 0:n)}}))})))},e}(a.Component);M.propTypes={noHour:r().bool,dateRange:r().number,defaultValue:r().oneOf(["HOUR","DAY","WEEK","MONTH"]),onChange:r().func.isRequired,style:r().object,collectValue:r().string,updateCollectValue:r().func};var c=n(33798),Z=n(43036),t=function(e){var t=e.chartType,n=e.enable,a=void 0!==n&&n,r=e.options,n=e.notLimitList,o=void 0===n?[]:n,l=e.onChange;return R().createElement("div",{className:"yt-chart-type-radio-wrapper"},Object.keys(r).map(function(e){return R().createElement(Z.Z,{key:e,placement:"top",overlay:r[e][2]},R().createElement("span",null,R().createElement(c.Z,{enable:!a||o.includes(e),isActive:t===e,defaultIcon:r[e][0],activeIcon:r[e][1],onClick:function(){return!a&&l(e)}})))}))};t.propTypes={chartType:r().string,enable:r().bool,options:r().object,notLimitList:r().array};const A=t;var m=n(39432),t=function(t){function e(e){var n=t.call(this,e)||this;return n.getPanelWidth=function(){var e=n.props,t=e.showFlavor,t=void 0!==t&&t,e=e.options,e=Math.max.apply(null,e.map(function(e){return(0,m.jD)(e.title,14)}))+2+24+25;return 100<(e+=t?24:0)?e:100},n._setPadShowFalse=function(){n.state.show&&n.setState({show:!1})},n._handleParentClick=function(e){n.state.show&&n.props.showFlavor&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},n._handleTriggerOnClick=function(){var e=n.state.show;setTimeout(function(){n.setState({show:!e})},0)},n.state={show:!1,firstLiHover:!1,panelWidth:n.getPanelWidth()},n}o()(e,t);var n=e.prototype;return n.componentDidMount=function(){window.addEventListener("click",this._setPadShowFalse)},n.componentWillUnmount=function(){window.removeEventListener("click",this._setPadShowFalse)},n.componentDidUpdate=function(e){var t=e.options,e=this.props.options;JSON.stringify(t)!==JSON.stringify(e)&&this.setState({panelWidth:this.getPanelWidth()})},n.render=function(){var e=this.state,t=e.show,n=e.panelWidth,a=this.props,r=a.activeObj,o=void 0===r?"":r,l=a.onChange,i=a.options,c=a.objName,s=a.preTitle,u=a.sufTitle,d=void 0===u?"":u,p=a.showTitle,e=void 0===p||p,r=a.overlay,u=a.divider,p=void 0===u?"right":u,h=(a.flavor,a.onFlavorChange,a.showFlavor,a.collectValue),m=a.updateCollectValue,a=i.find(function(e){return e.value===o}),a=""===o?d:a&&a.title;return R().createElement("div",{className:"dashboard-single-select-button-wrapper dashboard_single_select_diviver_"+p,onClick:this._handleParentClick},R().createElement("div",{className:"button_content"},R().createElement("span",{onClick:this._handleTriggerOnClick},R().createElement("span",{className:"button-trigger "+(t?"sel":"")},e&&R().createElement(R().Fragment,null,s&&R().createElement("span",{className:"pre-title"},s,"："),R().createElement("span",{className:"button-title"},a)),R().createElement("i",{className:"icon-cem_arrow-launches",style:{transform:t?"rotate(-180deg)":""}})),r&&R().createElement("span",{style:{marginLeft:4}},R().createElement(Z.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:r},R().createElement("i",{className:"icon-cem_file1"})))),R().createElement("div",{className:"button-panel "+(t?"active":""),style:{minWidth:n}},i.map(function(t,e){return R().createElement("div",{className:"panel-item "+(t.value===o?"sel":"")+" "+(t.disabled?"disabled":""),key:t.value,onClick:function(){var e;t.disabled||l(c?((e={})[c]=t.value,e):t.value)}},t.title,R().createElement("i",{className:h===t.value?"icon-cem_collection-settings stared":"icon-cem_collection-settings",onClick:function(e){e.stopPropagation(),m(t.value===h?void 0:t.value)}}))}))))},e}(R().PureComponent);t.propTypes={activeObj:r().any,onChange:r().func.isRequired,options:r().array.isRequired,objName:r().any,preTitle:r().string,sufTitle:r().string,showTitle:r().bool,overlay:r().string,divider:r().oneOf(["both","left","right"]),showFlavor:r().bool,flavor:r().string,onFlavorChange:r().func};const B=t;var H=n(92360),f=function(e){function t(){var l=e.call(this)||this;return l.sortList=function(t,e,n){n.stopPropagation(),n.nativeEvent.stopImmediatePropagation();var a=JSON.parse(JSON.stringify(l.getShowList()));if(a.some(function(e){return e.value===t.value})){var r=a.findIndex(function(e){return e.value===t.value}),o=a.splice(r,1)[0];switch(e){case"top":a.unshift(o);break;case"up":a.splice(r-1,0,o);break;case"down":a.splice(r+1,0,o)}l.props.onChange&&l.props.onChange(a.map(function(e){return{value:e.value,title:e.title}}))}},l.getShowList=function(){var e=l.props,n=e.options,e=e.value,a=[];return 0===e.length?n:(e.forEach(function(t){n.forEach(function(e){t.value===e.value&&a.push(e)})}),a.length!==n.length&&n.forEach(function(t){a.some(function(e){return e.value===t.value})||a.push(t)}),a)},l.state={showSel:!1,searchWord:""},l}o()(t,e);var n=t.prototype;return n.getValue=function(){return this.state.value},n.UNSAFE_componentWillReceiveProps=function(e){},n.UNSAFE_componentWillMount=function(){},n.componentWillUnmount=function(){},n.render=function(){var n=this,a=this.state.searchWord,r=this.getShowList();return R().createElement("div",{className:"dashboard-sort-select "+(this.props.triangle?"triangle":""),onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},R().createElement("div",{className:"wrap"},R().createElement("div",null,R().createElement(H.Input,{value:a,placeholder:"输入关键词",className:"search",icon:"close",onChange:function(e){n.setState({searchWord:e})},onIconClick:function(){return n.setState({searchWord:""})}})),R().createElement("ul",null,0<r.length&&r.filter(function(e){return!a||-1!==e.title.toLocaleLowerCase().indexOf(a.trim().toLocaleLowerCase())}).map(function(t,e){return R().createElement("li",{key:e},R().createElement("span",{title:t.title},t.title),R().createElement("div",{className:"handle"},(0!==e||a)&&R().createElement("i",{title:"置顶",onClick:function(e){n.sortList(t,"top",e)},className:"icon-cem_roof-placement"}),0!==e&&!a&&R().createElement("i",{title:"上一位",onClick:function(e){n.sortList(t,"up",e)},className:"icon-cem_upper"}),e!==r.length-1&&!a&&R().createElement("i",{title:"下一位",onClick:function(e){n.sortList(t,"down",e)},className:"icon-cem_lower"})))}),0===r.length&&R().createElement("div",{className:"noData"},"无数据"))))},t}(a.Component);f.propTypes={options:r().array,value:r().array,onChange:r().func,singelSel:r().bool};var F=function(t){function e(e){var a=t.call(this,e)||this;return a._setPadShowFalse=function(){a.state.show&&a.setState({show:!1})},a._handleParentClick=function(e){a.state.show&&a.props.showFlavor&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},a._handleTriggerOnClick=function(){var e=a.state.show;setTimeout(function(){a.setState({show:!e})},0)},a.updateCollectValue=function(e){var t=JSON.parse(JSON.stringify(a.props)),n=t.listId,t=t.collectValue;t.some(function(e){return e.value===n})?t.find(function(e){return e.value===n}).children=e:t.push({value:n,children:e}),a.props.onChange&&a.props.onChange(t)},a.state={show:!1},a}o()(e,t);var n=e.prototype;return n.componentDidMount=function(){window.addEventListener("click",this._setPadShowFalse)},n.componentWillUnmount=function(){window.removeEventListener("click",this._setPadShowFalse)},n.render=function(){var t=this,e=this.state.show,n=this.props,a=n.options,r=n.listId,n=n.collectValue;return R().createElement("div",{className:"dashboard-sort-select-wrap",onClick:this._handleParentClick},R().createElement("div",{className:"infor "+(e?"sel":""),onClick:function(){return t._handleTriggerOnClick()}},R().createElement("span",null,"颜色"),R().createElement("i",{className:"icon-cem_arrow-launches",style:{transform:e?"rotate(-180deg)":""}})),e&&R().createElement(f,{options:a.find(function(e){return e.value===r})&&a.find(function(e){return e.value===r}).children||[],value:n&&n.some(function(e){return e.value===r})?n.find(function(e){return e.value===r}).children:[],onChange:function(e){return t.updateCollectValue(e)},triangle:e}))},e}(R().Component),j=n(59132),z=n(57522),t=n(18446),U=n.n(t),G=n(94644),q=n(61409),t=n(2258),v=n.n(t),t=(n(83796),function(e){function t(t,e){var n,a;"mfolderId"===e?(i(t),s(r.find(function(e){return e.value===t}).dashboard[0].id),n=t,a=r.find(function(e){return e.value===t}).dashboard[0].id):"mdashId"===e&&(s(t),n=l,a=t),setTimeout(function(){return o&&o(n,a)},0)}var n=e.folderOption,r=void 0===n?[]:n,a=e.dashId,n=e.folderId,o=e.getValue,n=R().useState(n),l=n[0],i=n[1],a=R().useState(a),c=a[0],s=a[1],a=r.filter(function(e){return e.value===l})[0].dashboard.map(function(e){return{label:e.name,value:e.id}});return R().createElement("div",{className:"yt_modal_dashboard_edit_wrapper"},R().createElement("div",{className:"content_item"},R().createElement("span",null,"文件夹"),R().createElement("span",null,R().createElement(v(),{className:"content_item_select",value:r.find(function(e){return e.value===l}).label,onChange:function(e){return t(e,"mfolderId")},inputIcon:R().createElement("i",{className:"icon-cem_arrow-launches",style:{color:"#8C8C8C"}})},r.map(function(e){return R().createElement(v().Option,{value:e.value,key:e.value},e.label)})))),R().createElement("div",{className:"content_item"},R().createElement("span",null,"仪表盘"),R().createElement("span",null,R().createElement(v(),{className:"content_item_select",value:a.find(function(e){return e.value===c}).label,onChange:function(e){return t(e,"mdashId")},inputIcon:R().createElement("i",{className:"icon-cem_arrow-launches",style:{color:"#8C8C8C"}})},a.map(function(e){return R().createElement(v().Option,{value:e.value,key:e.value},e.label)})))))});const y=t;t.propTypes={folderOption:r().arrayOf({label:r().string,value:r().string,dashboard:r().arrayOf({label:r().string,value:r().string})}),folderId:r().string,dashId:r().string,getValue:r().func};t=function(e){var t=e.value,n=e.getValue,e=R().useState(t.rotate||"0"),a=e[0],r=e[1],e=R().useState(t.row||"1"),o=e[0],l=e[1],e=R().useState(t.length||"12"),i=e[0],c=e[1],t=R().useState(!0),e=t[0],s=t[1];return R().useEffect(function(){var e=Number(i);e&&6<=e&&e<=12&&e.toFixed()===String(e)?s(!0):s(!1)},[i]),R().useEffect(function(){n({rotate:a,row:o,length:i})},[a,o,i]),R().createElement("div",{className:"yt_modal_dashboard_prefer_wrapper"},R().createElement("h3",null,"X坐标轴刻度标签"),R().createElement("div",{className:" first"},R().createElement("span",null,"旋转角度"),R().createElement("span",null,R().createElement(H.Radio.Group,{value:a,onChange:function(e){return r(e)}},R().createElement(H.Radio,{value:"0"},"横排显示"),R().createElement(H.Radio,{value:"-45"},"左起斜下"),R().createElement(H.Radio,{value:"45"},"右起斜下")))),R().createElement("div",{className:" second"},R().createElement("span",null,"文本长度"),R().createElement("span",null,"按 ",R().createElement(v(),{className:"content_item_select",value:o,onChange:function(e){return l(e)},inputIcon:R().createElement("i",{className:"icon-cem_arrow-launches",style:{color:"#8C8C8C"}})},[{value:"1",label:"1"},{value:"2",label:"2"}].map(function(e){return R().createElement(v().Option,{value:e.value,key:e.value},e.label)}))," 行显示"),R().createElement("br",null),R().createElement("span",null,R().createElement("span",null,"超过了 ",R().createElement(H.Input,{className:e?"":"err",value:i,onChange:function(e){return c(e)}})," 个字符时，才","2"===o?"换行":"省略")),R().createElement("p",{className:e?"":"err"},"*文本长度最少6字符，最多12个字符")))};const J=t;function Y(o){return new Promise(function(e,t){var n=o.folderId,a=o.dashId,r=W()({},o,{titleText:"选择图表复制到下面的仪表盘",content:R().createElement(y,W()({},o,{getValue:function(e,t){n=e,a=t}}))});r.onOk=function(){return e({folderId:n,dashId:a})},r.onCancel=t,(0,z.Z)(r)})}t.propTypes={value:r().object,getValue:r().func};var t=n(50361),b=n.n(t);function K(e,t,n){if(!e)return{option:void 0};if("empty"===e)return{option:e};var a,l=b()(e);try{var r=(t?t.filter(function(e){return"stackType"===e.id}):[])[0];if(r&&Array.isArray(l.series))switch(r.value){case"c0":l.series.forEach(function(e){e.stack=void 0,e.type="line"});break;case"c1":l.series.forEach(function(e){e.stack="a",e.type="line"});break;case"c2":l.series.forEach(function(e){e.stack=void 0,e.type="bar"});break;case"c3":l.series.forEach(function(e){e.stack="a",e.type="bar"})}var o=(t?t.filter(function(e){return"labelType"===e.type}):[])[0];o&&Array.isArray(l.series)&&l.series.forEach(function(e){return e.label=W()({},e.label,{show:o.value,position:"top"}),e});var i,c,s=(t?t.filter(function(e){return/^sort_/.test(e.id)}):[])[0];s&&t.some(function(e){return e.id===s.id.replace("sort_","")})&&(i=t.find(function(e){return e.id===s.id.replace("sort_","")}).value,c=(c=s.collectValue&&s.collectValue.find(function(e){return e.value===i})?s.collectValue:s.option).find(function(e){return e.value===i})?c.find(function(e){return e.value===i}).children:[],"FIRST"===n.sortMode&&l.dataset?((c=c.filter(function(e){return l.dataset.source[0].includes(e.title)}).map(function(e){return e.title})).unshift(""),c.forEach(function(r,o){l.dataset.source[0].forEach(function(e,t){var n,a;r===e&&(n=t,a=o,l.dataset.source.forEach(function(e){var t=e.splice(n,1);e.splice(a,0,t[0])}))})})):"SECOND"===n.sortMode&&l.dataset&&((c=c.filter(function(e){return l.dataset.source.map(function(e){return e[0]}).includes(e.title)}).map(function(e){return e.title})).unshift(""),(c=Array.from(new Set(c))).forEach(function(n,a){l.dataset.source.map(function(e){return e[0]}).forEach(function(e,t){n===e&&(e=a,t=l.dataset.source.splice(t,1),l.dataset.source.splice(e,0,t[0]))})})));var u,d,p=(t?t.filter(function(e){return"prefer"===e.id}):[])[0];p&&p.collectValue&&(u=p.collectValue,l.xAxis&&(d=function(e){e.axisLabel=e.axisLabel||{},e.axisLabel.rotate=u.rotate||0,e.axisLabel.formatter=function(e){e=String(e);var t=Number(u.length||"12");return"2"===u.row?e.substring(0,t)+(e.length>t?"\n"+e.substring(t,2*t):"")+(0<e.substring(2*t).length?"...":""):e.substring(0,t)+(e.length>t?"...":"")}},Array.isArray(l.xAxis)?l.xAxis.forEach(d):d(l.xAxis)))}catch(e){a=!0,console.error("op解析失败，请查看op格式，"+e)}return{option:a?"error":l}}var Q=[{title:"导出图片",type:"image"},{title:"导出数据",type:"data"}],X=[{title:"复制",type:"copy"}],$=[{title:"偏好设置",type:"prefer"}],ee=[{title:"编辑",type:"edit"},{title:"删除",type:"del"}];const g=function(e){var c=e.chart,n=e.dateRange,a=e.onSelectorChange,t=e.lock,r=e.dashboardId,l=e.folderId,i=e.delDash,o=e.changeEnlargeId,s=e.shrink,u=(e.dashboardType,e.systermAuthority),d=e.fetchingDashboards,p=e.dateFilter,h=e.className,m=e.updateCollectValue,f=e.menu,v=c.option,y=c.source,b=c.selector,g=c.name,E=c.id,C=c.templateDeleted,w=c.description,e=R().useState(void 0),S=e[0],_=e[1],e=R().useState(void 0),k=e[0],N=e[1],e=R().useState({}),I=e[0],T=e[1],e=R().useState(O),O=e[0],x=e[1],e=R().useState(p),D=e[0],L=e[1];return R().useEffect(function(){var e,t;k&&S&&(e=k,(t=S).clear(),t.setOption(e))},[k,S]),R().useEffect(function(){var e=K(v,O,c).option;N(e),T(y)},[v]),R().useEffect(function(){setTimeout(function(){return L(p)},0)},[p]),R().useEffect(function(){var e,t,n,a,r,o,l,i;x(b),b&&(e=b.filter(function(e){return"stackType"===e.id})[0],t=(O?O.filter(function(e){return"stackType"===e.id}):[])[0],n=b.filter(function(e){return/^sort_/.test(e.id)})[0],a=(O?O.filter(function(e){return/^sort_/.test(e.id)}):[])[0],r=b.filter(function(e){return"prefer"===e.id})[0],o=(O?O.filter(function(e){return"prefer"===e.id}):[])[0],l=b.filter(function(e){return"labelType"===e.id})[0],i=(O?O.filter(function(e){return"labelType"===e.id}):[])[0],v&&(void 0!==e&&e.value!==(t?t.value:void 0)||void 0!==n&&!U()(n.collectValue,a?a.collectValue:void 0)||void 0!==r&&!U()(r,o||void 0)||void 0!==l&&!U()(l,i||void 0))&&(i=K(v,b,c).option,N(i)))},[b]),R().createElement(P.Z,{data:k,className:"yt_dashborad_chart_wrap "+(h||""),loading:!!d&&d.includes(E),renderTitle:R().createElement(j.Z,{className:!s&&(0,P.P)(k)?"hover_to_show":"",data:k,onMoreClick:function(e){return"del"===e?(0,z.Z)({dialogType:"danger",titleText:"确定删除图表？",showClose:!1,content:"确定删除图表"+g+"？",onCancel:function(){},onOk:function(){return i&&i({id:E})}}):"prefer"===e?(o={value:O.find(function(e){return"prefer"===e.id})&&O.find(function(e){return"prefer"===e.id}).collectValue||{},onCancel:function(){}},new Promise(function(e,t){var n=o.value||{},a=!0,r=W()({},o,{titleText:"偏好设置",content:R().createElement(J,W()({},o,{getValue:function(e){n=e;e=Number(e.length);a=e&&6<=e&&e<=12&&e.toFixed()===String(e)}})),test:function(){return a}});r.onOk=function(){return e(n)},r.onCancel=t,(0,z.Z)(r)}).then(function(e){m({id:E,selectId:"prefer",val:e})})):function(e,t,n,a,r,o,l,i,c){try{var s,u,d,p;"image"===t?(0,G._v)(e,a||"云听仪表盘}"):"data"===t?(s=[n],(0,G.aT)(s,a||"云听仪表盘}")):"copy"===t?(u=i&&i.dashboards?i.dashboards.map(function(e){return{label:e.name,value:e.id,dashboard:e.dataDashboardVOList,type:e.type}}).filter(function(e){return(c||"SELF_FOLDER"===e.type)&&e.dashboard&&0<e.dashboard.length}):[],d=l,p=r,u.some(function(e){return e.value===d})||(d=u[0].value,p=u[0].dashboard[0].id),Y({folderOption:u,folderId:d,dashId:p,onCancel:function(){}}).then(function(e){e.folderId;e=e.dashId;q.mW.push({pathname:"/dashboard/"+e+"/edit",state:{chartId:o,isCopy:!0}})})):"edit"===t&&q.mW.push({pathname:"/dashboard/"+r+"/edit",state:{chartId:o,isCopy:!1}})}catch(e){H.Message.error("copy"===t?"复制失败":"导出失败"),console.error("导出失败,"+e)}}(S,e,I,g,r,E,l,f,u);var o},title:g,id:E,status:C||!1,moreOptions:Q.concat(O&&O.find(function(e){return"prefer"===e.id})?$:[]).concat(X).concat(t?[]:ee),titleOverlay:w},R().createElement("div",null,O&&O.filter(function(e){return"prefer"!==e.id&&"labelType"!==e.id}).map(function(t){if(/^sort_/.test(t.id))return R().createElement(F,{key:t.id,onChange:function(e){return m({id:E,selectId:t.id,val:e})},listId:O.find(function(e){return e.id===t.id.replace("sort_","")})?O.find(function(e){return e.id===t.id.replace("sort_","")}).value:"",options:t.option||[],collectValue:t.collectValue||[]});switch(t.id){case"dateGroupingType":return n?R().createElement("span",{key:t.id},R().createElement(M,{noHour:!0,dateRange:n,onChange:function(e){v&&e===t.value&&p.from===D.from&&p.to===D.to||a({id:E,selectId:"dateGroupingType",val:e})},defaultValue:t.value,collectValue:t.collectValue,updateCollectValue:function(e){return m({id:E,selectId:"dateGroupingType",val:e})}})):"";case"stackType":return R().createElement(A,{key:t.id,onChange:function(e){return a({id:E,selectId:"stackType",val:e})},chartType:t.value,options:t.option});default:return R().createElement(B,{key:t.id,onChange:function(e){return a({id:E,selectId:t.id,val:e[t.id]})},objName:t.id,activeObj:t.value,options:t.option,collectValue:t.collectValue,updateCollectValue:function(e){return m({id:E,selectId:t.id,val:e})}})}}),O&&O.filter(function(e){return"labelType"===e.id}).map(function(e){return R().createElement(Z.Z,{overlay:"展示图表标签",placement:"top",key:e.id},R().createElement("i",{className:"icon-tubiaobiaoqian enlarge "+(e.value?"show":""),onClick:function(){return a({id:E,selectId:e.id,val:!e.value})}}))}),s?R().createElement("i",{className:(s?"icon-cem_reduce":"icon-cem_enlarge")+" enlarge",onClick:function(){return s?s():o({id:E})}},R().createElement("span",null,"退出全屏 ")):R().createElement(Z.Z,{overlay:"全屏显示",placement:"top",disable:!s},R().createElement("i",{className:(s?"icon-cem_reduce":"icon-cem_enlarge")+" enlarge",onClick:function(){return s?s():o({id:E})}}))))},R().createElement(V.Z,{className:t||s?"":"lock",theme:"yunting_dashboard_theme",loadingOption:{text:"加载中",color:"#20a0ff"},option:{},opts:{devicePixelRatio:2},style:{width:"100%",height:"100%"},onChartReady:function(e){return _(e)}}))};var te=function(t){function e(e){e=t.call(this,e)||this;return e.state={},e}o()(e,t);var n=e.prototype;return n.resizeTable=function(){var e=this.state,t=e.total,n=e.start,a=e.end,r=e.top,e=window.innerHeight-document.querySelector(".cem-table-wrap").getClientRects()[0].top-20,r=t&&n&&a?r?80:40:0;e<document.querySelector(".el-table.cem-table .el-table__body-wrapper .el-table__body").clientHeight+40+r&&(document.querySelector(".cem-table-wrap").style.height=e+"px",document.querySelector(".el-table.cem-table").style.height="calc(100% - "+r+"px)")},n.render=function(){var t=this,e=this.props,n=e.columns,a=e.data,r=e.className,o=e.style,l=e.maxHeight,e=i()(e,["columns","data","className","style","maxHeight"]);return R().createElement("div",{className:"dashboard-table-wrap",style:o},R().createElement(H.Table,W()({ref:function(e){return t.cemTable=e},className:"cem-table "+(r||""),columns:n,data:a||[],maxHeight:l},e)))},e}(a.Component);te.propTypes={columns:r().array,data:r().array,className:r().string,style:r().object};n(93162);var ne=[{title:"导出数据",type:"data"}],ae=[{title:"复制",type:"copy"}],re=[{title:"编辑",type:"edit"},{title:"删除",type:"del"}];const E=function(e){var t=e.chart,n=e.dateRange,a=e.onSelectorChange,r=e.lock,o=e.dashboardId,l=e.folderId,i=e.delDash,c=e.changeEnlargeId,s=e.shrink,u=(e.dashboardType,e.systermAuthority),d=e.fetchingDashboards,p=e.dateFilter,h=e.className,m=e.updateCollectValue,f=e.menu,v=e.status,y=t.option,b=t.source,g=t.selector,E=t.name,C=t.id,w=t.w,S=t.h,_=R().useState(void 0),k=_[0],N=_[1],I=R().useState([]),T=I[0],O=I[1],x=R().useState(g),e=x[0],D=x[1],t=R().useState(p),L=t[0],W=t[1],_=R().useState([]),I=_[0],V=_[1],x=R().useState([]),t=x[0],A=x[1],_=R().useState(200),x=_[0],F=_[1];return R().useEffect(function(){O(b)},[b]),R().useEffect(function(){var e=function(e){var t=[],n=[],a=e?JSON.parse(JSON.stringify(e)):[];try{a[0]&&a[0].forEach(function(e){n.push({label:e,prop:e})}),a.filter(function(e,t){return 0!==t}).length&&a.filter(function(e,t){return 0!==t}).forEach(function(e){var n={};e.forEach(function(e,t){n[a[0][t]]=e}),t.push(n)}),n.forEach(function(e,t){0===t&&(e.fixed=!0),e.align="center"})}catch(e){console.error("source解析失败，请查看数据，"+e)}return{data:t,columns:n}}(T),t=e.data,e=e.columns;V(t),A(e)},[T]),R().useEffect(function(){k&&F(k.getBoundingClientRect().height-84)},[w,S,k]),R().useEffect(function(){setTimeout(function(){return W(p)},0)},[p]),R().useEffect(function(){D(g)},[g]),R().createElement(P.Z,{data:b,className:"yt_dashborad_chart_wrap "+(h||""),loading:!!d&&d.includes(C),renderTitle:R().createElement(j.Z,{data:void 0,onMoreClick:function(e){return"del"===e?(0,z.Z)({dialogType:"danger",titleText:"确定删除图表？",showClose:!1,content:"确定删除图表"+E+"？",onCancel:function(){},onOk:function(){return i&&i({id:C})}}):function(e,t,n,a,r,o,l,i,c){try{var s,u,d,p;"image"===t?(0,G._v)(e,a||"云听仪表盘}"):"data"===t?(s=[n],(0,G.aT)(s,a||"云听仪表盘}")):"copy"===t?(u=i&&i.dashboards?i.dashboards.map(function(e){return{label:e.name,value:e.id,dashboard:e.dataDashboardVOList,type:e.type}}).filter(function(e){return(c||"SELF_FOLDER"===e.type)&&e.dashboard&&0<e.dashboard.length}):[],d=l,p=r,u.some(function(e){return e.value===d})||(d=u[0].value,p=u[0].dashboard[0].id),Y({folderOption:u,folderId:d,dashId:p,onCancel:function(){}}).then(function(e){e.folderId;e=e.dashId;q.mW.push({pathname:"/dashboard/"+e+"/edit",state:{chartId:o,isCopy:!0}})})):"edit"===t&&q.mW.push({pathname:"/dashboard/"+r+"/edit",state:{chartId:o,isCopy:!1}})}catch(e){H.Message.error("copy"===t?"复制失败":"导出失败"),console.error("导出失败,"+e)}}(1,e,T,E,o,C,l,f,u)},title:E,id:C,status:v,moreOptions:ne.concat(ae).concat(r?[]:re)},R().createElement("div",null,e&&e.filter(function(e){return"prefer"!==e.id}).map(function(t){if(/^sort_/.test(t.id))return null;switch(t.id){case"dateGroupingType":return n?R().createElement("span",{key:t.id},R().createElement(M,{noHour:!0,dateRange:n,onChange:function(e){y&&e===t.value&&p.from===L.from&&p.to===L.to||a({id:C,selectId:"dateGroupingType",val:e})},defaultValue:t.value,collectValue:t.collectValue,updateCollectValue:function(e){return m({id:C,selectId:"dateGroupingType",val:e})}})):"";case"stackType":return null;default:return R().createElement(B,{key:t.id,onChange:function(e){return a({id:C,selectId:t.id,val:e[t.id]})},objName:t.id,activeObj:t.value,options:t.option,collectValue:t.collectValue,updateCollectValue:function(e){return m({id:C,selectId:t.id,val:e})}})}}),s?R().createElement("i",{className:(s?"icon-cem_reduce":"icon-cem_enlarge")+" enlarge",onClick:function(){return s?s():c({id:C})}},R().createElement("span",null,"退出全屏 ")):R().createElement(Z.Z,{overlay:"全屏显示",placement:"top",disable:!s},R().createElement("i",{className:(s?"icon-cem_reduce":"icon-cem_enlarge")+" enlarge",onClick:function(){return s?s():c({id:C})}}))))},R().createElement("div",{className:"dashboard_table",ref:function(e){return N(e)}},R().createElement(te,{columns:t,data:I,style:{height:"100%"},maxHeight:x})))};var C=function(n){function e(e){var t=n.call(this,e)||this;return t.resizeListener=function(){var e;t.dashWrap&&(e=t.dashWrap.getBoundingClientRect().width,t.setState({ratio:e/1200,width:e}))},t.onDrag=function(e){e.y<94?(t.topDistance=94-e.y,t.topInterval||(t.topInterval=setInterval(function(){t.dashWrap.scrollTop=t.dashWrap.scrollTop-t.topDistance},10))):window.innerHeight-e.y<20?(t.bottomDistance=20-(window.innerHeight-e.y),t.bottomInterval||(t.bottomInterval=setInterval(function(){t.dashWrap.scrollTop=t.dashWrap.scrollTop+t.bottomDistance},10))):(clearInterval(t.topInterval),clearInterval(t.bottomInterval),t.topInterval=null,t.bottomInterval=null)},t.onDragStop=function(){clearInterval(t.topInterval),clearInterval(t.bottomInterval),t.topInterval=null,t.bottomInterval=null},t.state={width:1200,ratio:1},t}o()(e,n);var t=e.prototype;return t.componentDidMount=function(){window.addEventListener("resize",this.resizeListener),this.resizeListener()},t.componentWillUnmount=function(){window.removeEventListener("resize",this.resizeListener)},t.componentDidUpdate=function(e){var t=this;e.shrinkMenu!==this.shrinkMenu&&(this.shrinkMenu=e.shrinkMenu,setTimeout(function(){return t.resizeListener()},400))},t.competeWidth=function(e){if(this.dashWrap){var t=this.dashWrap.getBoundingClientRect().width;return e?e*(t/1200):t}return 0},t.render=function(){var o=this,e=this.state,t=e.width,n=e.ratio,a=this.props,r=a.dashboards,l=a.lock,i=a.onLayoutChange,c=a.dashboardId,e=a.dashboardType,a=a.systermAuthority;return R().createElement("div",{className:"dashboard_page",ref:function(e){return o.dashWrap=e}},0<r.length?R().createElement(s(),{className:"layout",cols:36,rowHeight:30,width:t,compactType:"",measureBeforeMount:!1,preventCollision:!0,useCSSTransforms:!0,isDraggable:!l,isResizable:!l,onLayoutChange:i,onDrag:function(e,t,n,a,r){return o.onDrag(r)},onDragStop:this.onDragStop},(0,u.ZP)(r,function(e){e.forEach(function(e){e.i=e.id,e.w=e.w*n,e.static=l})}).map(function(e){var t=e.option&&e.option.series&&(Array.isArray(e.option.series)?e.option.series.every(function(e){return"table"===e.type}):"table"===e.option.series.type),n=e.selector&&e.selector.find(function(e){return"tableView"===e.id})&&"table"===e.selector.find(function(e){return"tableView"===e.id}).value;return R().createElement("div",{key:e.id,"data-grid":{i:e.id,x:e.x,y:e.y,w:e.w,h:e.h,minW:9,minH:8},style:{zIndex:e.y}},t||n?R().createElement(E,W()({},o.props,{chart:e,className:"dashboard_chart_"+e.id})):R().createElement(g,W()({},o.props,{chart:e,className:"dashboard_chart_"+e.id})))})):r&&R().createElement("div",{className:"dashborad_nodata"},R().createElement("i",{className:"icon-cem_invalid-save"}),R().createElement("span",null,"当前仪表盘还没有任何「图表」"),("SELF_FOLDER"===e||a)&&R().createElement(H.Button,{type:"primary",onClick:function(){return q.mW.push("/dashboard/"+c+"/list")}},"立即新建")))},e}(R().Component),w=n(61193);const S=function(e){var t=e.chart,n=e.shrink,e=i()(e,["chart","shrink"]);return R().createElement("div",{className:"elarge_wrap"},R().createElement("div",{className:"elarge_header"},R().createElement("span",{className:"chart_name"},t.name)),R().createElement("div",{className:"elarge_chart_wrap"},t.option&&t.option.series&&(Array.isArray(t.option.series)?t.option.series.every(function(e){return"table"===e.type}):"table"===t.option.series.type)?R().createElement(E,W()({},e,{chart:t,lock:!0,shrink:n})):R().createElement(g,W()({},e,{chart:t,lock:!0,shrink:n}))))};const _=function(e){var t,n=W()({},e),a=n.onFilterChange,r=n.onFilterReady,o=n.dashboards,l=n.enlargeId,i=n.changeEnlargeId,c=n.title,s=n.lock,u=n.onLockChange,d=n.dashboardId,e=n.dashboardType;n.systermAuthority;return o&&l&&(t=o.filter(function(e){return e.id===l})[0]),R().createElement("div",{className:"dashboard"},R().createElement(p.Z,{title:R().createElement("div",{className:"dashboard_title"},R().createElement("span",null,c),("SELF_FOLDER"===e||w.Z.hasAuthority("DASHBOARD_OPERATION"))&&R().createElement("span",null,R().createElement("span",{className:"line"}),R().createElement(H.Button,{type:"primary",onClick:function(){return q.mW.push("/dashboard/"+d+"/list")}},"添加图表"),R().createElement("span",{className:"line"}),R().createElement(Z.Z,{overlay:s?"解锁后，可以拖拽和编辑图表":"请锁定仪表盘，以防止误操作",placement:"top"},R().createElement("i",{className:s?"icon-cem_locking":"icon-cem_open",onClick:u})))),showList:["time"],onFilterReady:r,onChange:a}),R().createElement(P.Z,{data:o,className:"section_dashboard"},R().createElement(C,n)),l&&R().createElement(S,W()({},n,{chart:t,shrink:function(){return i({id:""})}})))};var t=n(64396),a=n(55609),r=n(70596),k=n.n(r),N=["#1574B3","#CDB446","#D07B49","#1EA082","#3D85FF","#D8727F","#0E97AD","#119073","#D969BF","#A9A557","#3D42C6","#3ACCD3","#1A9E59","#1574B3","#38B5FF","#9369D9","#1BBF69","#CC6A77","#A3A3A3","#D2D2D2"],I={color:N,backgroundColor:"#ffffff",textStyle:{fontFamily:"'PingFang SC','Microsoft Yahei', 'Helvetica Neue', Helvetica, Tahoma, Arial, 'Hiragino Sans GB', 'WenQuanYi Micro Hei', sans-serif"},grid:{top:108,right:32,bottom:24,left:32,containLabel:!0},title:{top:24,left:32,textStyle:{color:"#262626",fontSize:14},subtextStyle:{color:"#8c8c8c"}},line:{itemStyle:{normal:{borderWidth:1}},lineStyle:{normal:{width:2}},symbolSize:4,symbol:"circle",smooth:!0},radar:{itemStyle:{normal:{borderWidth:1}},lineStyle:{normal:{width:2}},symbolSize:4,symbol:"circle",smooth:!0},bar:{itemStyle:{normal:{barBorderWidth:"0",barBorderColor:"#ccc"},emphasis:{barBorderWidth:"0",barBorderColor:"#ccc"}}},pie:{itemStyle:{normal:{borderWidth:"0",borderColor:"#ccc"},emphasis:{borderWidth:"0",borderColor:"#ccc"}}},scatter:{itemStyle:{normal:{borderWidth:"0",borderColor:"#ccc"},emphasis:{borderWidth:"0",borderColor:"#ccc"}}},boxplot:{itemStyle:{normal:{borderWidth:"0",borderColor:"#ccc"},emphasis:{borderWidth:"0",borderColor:"#ccc"}}},parallel:{itemStyle:{normal:{borderWidth:"0",borderColor:"#ccc"},emphasis:{borderWidth:"0",borderColor:"#ccc"}}},sankey:{itemStyle:{normal:{borderWidth:"0",borderColor:"#ccc"},emphasis:{borderWidth:"0",borderColor:"#ccc"}}},funnel:{itemStyle:{normal:{borderWidth:"0",borderColor:"#ccc"},emphasis:{borderWidth:"0",borderColor:"#ccc"}}},gauge:{itemStyle:{normal:{borderWidth:"0",borderColor:"#ccc"},emphasis:{borderWidth:"0",borderColor:"#ccc"}}},candlestick:{itemStyle:{normal:{color:"#c12e34",color0:"#2b821d",borderColor:"#c12e34",borderColor0:"#2b821d",borderWidth:1}}},graph:{itemStyle:{normal:{color:function(e){return N[e.dataIndex%N.length]},borderWidth:"0",borderColor:"#ccc"}},lineStyle:{normal:{width:1,color:"#aaaaaa"}},symbolSize:4,symbol:"circle",smooth:!0,color:N,label:{normal:{textStyle:{color:"#ffffff"}}}},map:{itemStyle:{normal:{areaColor:"#dddddd",borderColor:"#eeeeee",borderWidth:.5},emphasis:{areaColor:"rgba(230,182,0,1)",borderColor:"#dddddd",borderWidth:1}},label:{normal:{textStyle:{color:"#c12e34"}},emphasis:{textStyle:{color:"rgb(193,46,52)"}}}},geo:{itemStyle:{normal:{areaColor:"#dddddd",borderColor:"#eeeeee",borderWidth:.5},emphasis:{areaColor:"rgba(230,182,0,1)",borderColor:"#dddddd",borderWidth:1}},label:{normal:{textStyle:{color:"#c12e34"}},emphasis:{textStyle:{color:"rgb(193,46,52)"}}}},wordCloud:{textStyle:{normal:{color:function(e){return N[e.dataIndex%N.length]}}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#ebebeb"}},axisTick:{show:!1},axisLabel:{show:!0,textStyle:{color:"#262626"}},splitLine:{show:!1,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#ebebeb"}},axisTick:{show:!1,lineStyle:{color:"#ebebeb"}},axisLabel:{show:!0,textStyle:{color:"#262626"}},splitLine:{show:!1,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#ebebeb"}},axisTick:{show:!1,lineStyle:{color:"#ebebeb"}},axisLabel:{show:!0,textStyle:{color:"#262626"}},splitLine:{show:!1,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#ebebeb"}},axisTick:{show:!1,lineStyle:{color:"#ebebeb"}},axisLabel:{show:!0,textStyle:{color:"#262626"}},splitLine:{show:!1,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},toolbox:{iconStyle:{normal:{borderColor:"#D2D2D2"},emphasis:{borderColor:"#093B88"}},feature:{dataView:{readOnly:!0},dataZoom:{title:{zoom:"区域缩放",back:"缩放还原"}},saveAsImage:{title:"导出图片",pixelRatio:2}}},legend:{top:60,left:32,right:32,textStyle:{color:"#262626"}},tooltip:{textStyle:{color:"#262626",fontSize:12},backgroundColor:"rgba(255,255,255,0.9)",borderWidth:1,padding:[8,18],borderColor:"#ccc",extraCssText:"box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);",axisPointer:{lineStyle:{color:"#bfbfbf",width:1},label:{show:!0,backgroundColor:"#000",shadowColor:"rgba(0, 0, 0, 0.15)",shadowBlur:8},crossStyle:{color:"#bfbfbf",type:"dashed"}}},timeline:{lineStyle:{color:"#0847a6",width:1},itemStyle:{normal:{color:"#0847a6",borderWidth:1},emphasis:{color:"#0847a6"}},controlStyle:{normal:{color:"#0847a6",borderColor:"#0847a6",borderWidth:.5},emphasis:{color:"#0847a6",borderColor:"#0847a6",borderWidth:.5}},checkpointStyle:{color:"#0847a6",borderColor:"rgba(49,107,194,0.5)"},label:{normal:{textStyle:{color:"#0847a6"}},emphasis:{textStyle:{color:"#0847a6"}}}},visualMap:{color:["#D07B49","#CDB446","#1574B3"]},dataZoom:{backgroundColor:"rgba(47,69,84,0)",dataBackgroundColor:"rgba(47,69,84,0.3)",fillerColor:"rgba(167,183,204,0.4)",handleColor:"#a7b7cc",handleSize:"100%",textStyle:{color:"#333333"}},markPoint:{label:{normal:{textStyle:{color:"#ffffff"}},emphasis:{textStyle:{color:"#ffffff"}}}}};const T=function(){return k().registerTheme("yunting_dashboard_theme",I)};var O=t.Z.dashboard.dashboard,x=t.Z.public.menu;T();t=function(t){function e(e){var c=t.call(this,e)||this;return c.escPress=function(e){27===e.keyCode&&c.props.changeEnlargeId({id:""})},c._handleOnFilterReady=function(e){var n,a,r,o,t=c.props,l=t.save,i=t.menu;i&&i.dashboards?(t=e.dateFilter,o=c.props.params.id,i.dashboards.forEach(function(t){t.dataDashboardVOList&&t.dataDashboardVOList.forEach(function(e){e.id===o&&(n=e.name,a=t.type,r=t.id)})}),l({dashboardId:o,folderId:r,projectId:d.t.get(d.V.curProject).id,title:n,dashboardType:a,lock:!w.Z.hasAuthority("DASHBOARD_OPERATION")||!(!1===d.t.get(d.V.dashboardLock,"session")),systermAuthority:w.Z.hasAuthority("DASHBOARD_OPERATION"),dateFilter:t,dateRange:t.numOfDays+Math.random()}),c.props.fetchDashboards().then(function(e){e.forEach(function(e){e.selector&&e.selector&&e.selector.some(function(e){return"dateGroupingType"===e.id})||c.props.fetchChart({chart:e})})})):setTimeout(function(){return c._handleOnFilterReady(e)},10)},c._handleOnFilterChange=function(e){var t=c.props.save,e=e.dateFilter;t({dateFilter:e,dateRange:e.numOfDays+Math.random(),dashboards:(0,u.ZP)(c.props.dashboards,function(e){e.forEach(function(e){return e.option=void 0})})}),c.props.dashboards.forEach(function(e){e.selector&&e.selector&&e.selector.some(function(e){return"dateGroupingType"===e.id})||c.props.fetchChart({chart:e})})},c._handelOnLayoutChange=function(e){var l,t=c.props,n=t.dashboards,a=t.onLayoutChange;t.lock||(l=[],n.forEach(function(o){e.forEach(function(e){var t,n,a,r;o.id!==e.i||o.x===e.x&&o.y===e.y&&o.w===e.w&&o.h===e.h||(t=e.x,n=e.y,a=e.w,r=e.h,l.push({x:t,y:n,w:a,h:r,id:e.i,chartName:o.name}))})}),1<l.length||1===l.length&&a(l[0]))},c._events={onFilterChange:c._handleOnFilterChange,onFilterReady:c._handleOnFilterReady,onLayoutChange:c._handelOnLayoutChange},c}o()(e,t);var n=e.prototype;return n.componentDidMount=function(){document.addEventListener("keydown",this.escPress)},n.componentWillUnmount=function(){this.props.clean(),document.removeEventListener("keydown",this.escPress)},n.render=function(){return R().createElement(_,W()({},this.props,this._events))},e}(R().Component);const D=(0,a.connect)(function(e){e.loading;e=i()(e,["loading"]);return W()({},e[O],{menu:e[x].menuList,shrinkMenu:e[x].shrinkMenu})},function(t){return{filterReady:function(e){return t({type:O+"/filterReady",payload:e})},fetchDashboards:function(e){return t({type:O+"/fetchDashboards",payload:e})},fetchChart:function(e){return t({type:O+"/fetchChart",payload:e})},onSelectorChange:function(e){return t({type:O+"/onSelectorChange",payload:e})},updateCollectValue:function(e){return t({type:O+"/updateCollectValue",payload:e})},onLayoutChange:function(e){return t({type:O+"/onLayoutChange",payload:e})},delDash:function(e){return t({type:O+"/delDash",payload:e})},onLockChange:function(){return t({type:O+"/onLockChange"})},changeEnlargeId:function(e){return t({type:O+"/changeEnlargeId",payload:e})},save:function(e){return t({type:O+"/save",payload:e})},clean:function(e){return t({type:O+"/clean",payload:e})}}})(t)}}]);