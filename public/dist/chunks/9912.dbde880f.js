(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[9912],{93266:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-7ef925"},54114:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-43cb92"},6005:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-ebf79b"},46424:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-c76ee9"},85250:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-871d0c"},84216:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-b8b5f7"},90421:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-58f22e"},67385:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-84bced"},71493:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-012355"},42226:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-b9939c"},34276:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-93e58c"},17833:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-eda506"},5354:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-614297"},208:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-60582c"},99201:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-9c6ee6"},72188:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-d98780"},93853:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-d2bb54"},42099:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-29e131"},46634:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-133e8a"},41259:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-d8cbd3"},11965:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-ddc524"},77429:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-4603ac"},52857:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-561563"},93990:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-9a126f"},95537:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-d42acb"},39821:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-d892fd"},66965:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-60ff00"},88331:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-d0cba3"},19166:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-14379e"},70277:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-6813ef"},99255:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-e0ed41"},18301:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-4cc015"},47203:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-860a9e"},3246:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-ae6bef"},21265:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-3be555"},19029:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-404ec1"},67037:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-42ec6d"},18281:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-e2b5a7"},21263:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-d1e953"},32710:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-33d39a"},29898:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-5457c8"},10847:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-cbf301"},21267:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-03835c"},12284:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var a=n(37316),r=n.n(a),t=n(67154),i=n.n(t),a=n(85354),l=n.n(a),d=n(67294),g=n.n(d),v=n(55815),C=n(35239),t=n(45697),a=n.n(t),m=n(2258),h=n.n(m),f=n(7660),y={like:"包含",notlike:"不包含",is:"其中一个",in:"其中一个",notin:"不为其中任一个"},t=function(t){function e(e){var o=t.call(this,e)||this;return o._handleOnAddTag=function(e){var t=e.name,n=o.props,a=n.onChange,r=n.index,l=n.data.contents,e=n.conData,n=n.conOptions,t=t.trim();e.some(function(e){return 1===e.times})&&n.some(function(e){return"is"===e})&&(t.includes("https://weibo.com/")?t=(t.includes("?")?t.split("?")[0]:t).split("https://weibo.com/")[1]:o.setState({tips:"请输入正确的微博用户主页URL"})),t&&l.length<5&&a(r,{type:"contents",value:l.concat([t])})},o._handleOnTagDelete=function(e,t,n){var a=o.props;(0,a.onChange)(a.index,{type:"contents",value:n.map(function(e){return e.name})}),e.name.includes("https://weibo.com/")||""===o.state.tips||o.setState({tips:""})},o._handleOnTagBlur=function(e){e=e.target;o.tagInputRef&&e.value&&(o._handleOnAddTag({name:e.value}),o.tagInputRef.setState({tagName:""}))},o._handleOnObjectSelect=function(e){var t=o.props,n=t.index,a=t.onChange,t=t.data;a(n,{type:"name",value:e}),"is"!==t.type&&""!==o.state.tips&&o.setState({tips:""})},o._handleOnConditionSelect=function(e){var t=o.props,n=t.index;(0,t.onChange)(n,{type:"type",value:e})},o._handleOnContentsSelect=function(e){var t=o.props,n=t.index;(0,t.onChange)(n,{type:"contents",value:[e]})},o._handleOnDelete=function(){var e=o.props,t=e.index;(0,e.onDelete)(t)},o._handleInputKeyDown=function(e){8===e.keyCode&&o.tagInputElm&&!o.tagInputElm.value&&(0,(e=o.props).onChange)(e.index,{type:"contents",value:(e=e.data.contents).slice(0,e.length-1)})},o.tagInputRef=void 0,o.tagInputElm=void 0,o.state={tips:""},o}l()(e,t);var n=e.prototype;return n.componentDidUpdate=function(){var e=this.props.data.contents;5===e.length&&this.tagInputElm&&this.tagInputElm.setAttribute("disabled",!0),e.length<5&&this.tagInputElm&&this.tagInputElm.removeAttribute("disabled")},n.componentWillUnmount=function(){this.tagInputElm&&this.tagInputElm.removeEventListener("keydown",this._handleInputKeyDown)},n.render=function(){var t=this,e=this.props,n=e.index,a=e.data,r=e.objOptions,l=e.conOptions,o=e.plaOptions,s=e.test,c=1===n,i=c?"rule_first":5===n?"rule_last":"",u=a.name,e=a.type,p=a.contents,a=p.map(function(e){return{name:e}});return g().createElement("div",{className:"yt_link_rule_wrapper",style:{height:"47px"}},g().createElement("span",{className:"rule_index "+i},g().createElement("span",null,n)),g().createElement("span",{className:"rule_object "+(c?"rule_object_first":"")},g().createElement(h(),{value:u,className:"rule_select",tags:!1,showSearch:!1,inputIcon:g().createElement("i",{className:"icon-cem_pull-down-or-take-up"}),onSelect:this._handleOnObjectSelect},r.map(function(e){return g().createElement(m.Option,{key:e,value:e,disabled:1===n&&"平台"===e},e)}))),g().createElement(h(),{value:y[e],disabled:1===n,className:"rule_select",style:{width:140,minWidth:140},tags:!1,showSearch:!1,inputIcon:g().createElement("i",{className:"icon-cem_pull-down-or-take-up"}),onSelect:this._handleOnConditionSelect},l.map(function(e){return g().createElement(m.Option,{key:e,value:e},y[e])})),"平台"===u?g().createElement(h(),{className:"rule_content_select",value:o.find(function(e){return e.id===p[0]}).name,tags:!1,showSearch:!1,inputIcon:g().createElement("i",{className:"icon-cem_pull-down-or-take-up"}),onSelect:this._handleOnContentsSelect},o.map(function(e){return g().createElement(m.Option,{key:e.id,value:e.id},e.name)})):g().createElement(d.Fragment,null,g().createElement(f.EG,{ref:function(e){e&&(e=(t.tagInputRef=e).refs.tagInput.getElementsByTagName("input")[0],t.tagInputElm=e,t.tagInputElm.addEventListener("keydown",t._handleInputKeyDown))},className:"rule_content "+((!s||""!==this.state.tips)&&"rule_content_error")+" "+(5===p.length?"rule_content_input_hide":"rule_content_input_show"),tags:a,onAdd:this._handleOnAddTag,createTagOnKeys:[13],placeholder:"还可输入"+(5-p.length)+"个关键词",onDelete:this._handleOnTagDelete,onBlur:this._handleOnTagBlur}),g().createElement("span",{className:"tip_error"},this.state.tips)),!c&&g().createElement("i",{onClick:this._handleOnDelete,className:"icon-cem_delete rule_delete_icon"}))},e}(g().PureComponent);const p=t;t.propTypes={index:a().number,data:a().shape({id:a().string,key:a().string,name:a().string,type:a().string,content:a().arrayOf(a().string)}).isRequired,objOptions:a().arrayOf(a().string).isRequired,conOptions:a().arrayOf(a().string).isRequired,plaOptions:a().array,onDelete:a().func.isRequired,onChange:a().func.isRequired,test:a().bool};var b=n(58992),E=n(61409),_=n(92360),t=function(t){function e(e){var n=t.call(this,e)||this;return n._handleConpositing=function(){n.compositing=!0},n._handleCompositionEnd=function(e){var t=e.currentTarget,e=n.props.onChange;n.compositing=!1,e(t.value)},n._handleOnChange=function(e){var t=e.target,e=n.props.onChange;n.compositing||e(t.value)},n.compositing=!1,n}return l()(e,t),e.prototype.render=function(){var t=this,e=this.props,n=e.title,a=e.value,r=void 0===a?"":a,a=e.test,a=void 0===a||a,e=e.placeHolder;return g().createElement("div",{className:"yt_content_input_wrapper"},n,g().createElement("input",{className:a?"":"error",placeholder:e,value:r,onChange:function(e){e=e.target;return t.props.onChange(e.value)}}))},e}(g().PureComponent);const k=t;function u(e){return{key:e.key,name:e.name,type:e.type,contents:[]}}t.propTypes={onChange:a().func.isRequired,title:a().string.isRequired,value:a().string,placeHolder:a().string,test:a().bool};t=function(t){function e(e){var c=t.call(this,e)||this;return c.setQueAnsState=function(e){var t=e.preConData,n=e.nowConData,e=e.value;JSON.stringify(t)!==JSON.stringify(n)&&c.setState({content:e})},c.setBBSState=function(e){var t=e.preConData,n=e.nowConData,e=e.value,e=void 0===e?"":e;JSON.stringify(t)!==JSON.stringify(n)&&c.setState({rules:void 0,contentStr:e})},c.setSocialState=function(e){var t,a,r,l,n=e.preConData,o=e.nowConData,s=e.value;JSON.stringify(n)!==JSON.stringify(o)&&(t=o.list[0],a=[],r={},l={},o.list.forEach(function(e){var t=e.name,n=e.key,e=e.type;a.push(t),r[t]=n,l[t]="is"!==e?[e,"not"+e]:[e]}),(e={objOptions:a,keyDict:r,conDict:l}).rules=s&&!n&&o?s.map(function(e){return i()({},e,{contents:e[e.type]||e["not"+e.type],type:e[e.type]?e.type:"not"+e.type})}):[u(t)],c.setState(e))},c.getValue=function(){var e=c.state,t=e.rules,n=e.content,e=e.contentStr;return t?{rules:t.map(function(e){var t={key:e.key};return t[e.type]=e.contents,t})}:n?{content:c.contentRuleRef.getValue()}:e?{contentStr:e}:void 0},c.hasChanged=function(){return c.contentRuleRef?c.contentRuleRef.hasChanged():c.state.hasChanged},c.resetChanged=function(){return c.setState({hasChanged:!1})},c.test=function(){var e=c.state,t=e.rules,n=e.content,e=e.contentStr,a=!0;return t?(t=t.map(function(e){e=0<e.contents.length;return a=e&&a,e}),c.setState({testRules:t})):n||void 0!==e&&c.setState({testRules:a=!!e}),a},c._handleOnLinkRuleChange=function(e,t){var n=c.state,a=n.rules,r=n.conDict,l=n.keyDict,o=n.testRules,n=c.props.plaData,e=a[e-1];e[t.type]=t.value,"name"===t.type&&(e.type=r[t.value][0],e.key=l[t.value],"平台"===t.value?e.contents=[n[0].id]:e.contents=[]),c.setState({rules:JSON.parse(JSON.stringify(a)),testRules:"contents"===t.type?void 0:o,hasChanged:!0})},c._handleOnLinkRuleDelete=function(e){var t=c.state.rules,n=c.props.conData;t.splice(e-1,1);var a=[];n.list.forEach(function(e){e=e.name;return a.push(e)}),1===t.length&&c.setState({objOptions:a}),c.setState({hasChanged:!0,rules:JSON.parse(JSON.stringify(t))})},c._handleOnLinkRuleAdd=function(){var t=c.props.conData,e=c.state,n=e.rules,a=e.objOptions,e=t.list[0];t.list.some(function(e){return 1===e.times})&&(e=t.list.filter(function(e){return 1!==e.times})[0],c.setState({objOptions:a.filter(function(e){return e!==t.list.find(function(e){return 1===e.times}).name})})),c.setState({rules:n.concat([u(e)]),hasChanged:!0})},c._handleOnContentInputChange=function(e){c.setState({hasChanged:!0,contentStr:e,testRules:void 0})},c.state={rules:void 0,content:void 0,contentStr:void 0,objOptions:[],conDict:{},keyDict:{},testRules:void 0,hasChanged:!1},c}l()(e,t);var n=e.prototype;return n.componentDidUpdate=function(e,t){var n=e.conData,a=this.props,r=a.conData,e=a.value,a=a.messageCategory;"BBS"===a&&r&&14!==Number(r.sourceId)?this.setBBSState({preConData:n,nowConData:r,value:e}):("SOCIAL"===a||"NEWS"===a||"QUE_ANS"===a||"SELF"===a||"COMPLAINT"===a||"VIDEO"===a||"BBS"===a&&r&&14===Number(r.sourceId))&&r&&0!==r.list&&r.sourceId&&this.setSocialState({preConData:n,nowConData:r,value:e})},n.render=function(){var n=this,e=this.state,t=e.rules,a=e.content,r=e.contentStr,l=e.objOptions,o=e.conDict,s=e.testRules,c=this.props,i=c.conData,e=c.loading,u=c.plaData;return g().createElement("div",{className:"yt_link_rule_com_wrapper "+(this.props.className||"")},g().createElement("div",{className:"link_rule_title"},g().createElement("span",null,"链接规则"),g().createElement("span",null,"（以下规则将逐层生效过滤要获取的数据，关键词不区分英文大小写）"),g().createElement(E.rU,{className:"rule_guild",to:"https://www.yuque.com/docs/share/126ea85b-e42f-4d1a-9164-8892d7d0c16a?#",target:"_blank"},"操作指南")),g().createElement(_.Loading,{loading:e},t?g().createElement(g().Fragment,null,t.map(function(e,t){return g().createElement(p,{data:e,objOptions:l,conOptions:o[e.name],plaOptions:u,key:"rule_"+t,index:t+1,conData:i.list,test:!s||s[t],onDelete:n._handleOnLinkRuleDelete,onChange:n._handleOnLinkRuleChange})}),0<t.length&&t.length<5?g().createElement("div",{className:"link_rule_more"},g().createElement("span",{onClick:this._handleOnLinkRuleAdd},g().createElement("i",{className:"icon-cem_add-to"})),"还可添加",5-t.length,"条规则"):g().createElement("div",{className:"link_rule_no_more"},"最多可添加5条规则")):a?g().createElement("div",{className:"link_content_rule"},g().createElement(b.Z,{value:a,ref:function(e){return n.contentRuleRef=e}})):void 0!==r?g().createElement(k,{title:"专栏",placeHolder:"请输入规则内容",test:s,onChange:this._handleOnContentInputChange,value:r}):""))},e}(g().PureComponent);const S=t;t.propTypes={className:a().string,conData:a().object,plaData:a().array.isRequired,loading:a().bool,value:a().oneOf([a().string,a().array]),messageCategory:a().string};var O=n(29030),N=n(43036);function R(e){try{return n(44311)("./"+e+".png")}catch(e){return n(90421)}}const x=function(e){var t=e.list,n=e.show,a=e.cancelShow,e=g().useState(""),r=e[0],l=e[1];return g().createElement("div",{className:"platform_source_dialog"},g().createElement(_.Dialog,{style:{width:"700px"},title:g().createElement("div",{className:"dialog_title"},g().createElement("span",null,"全部平台"),g().createElement(_.Input,{value:r,type:"text",placeholder:"请输入平台名称",icon:"search",onChange:function(e){return l(e)}})),onCancel:a,visible:n},g().createElement(_.Dialog.Body,null,g().createElement("ul",null,t.filter(function(e){return!r||-1!==e.name.indexOf(r)}).map(function(e){return g().createElement("li",{key:e.id},g().createElement("img",{src:R(O.z[e.name]),alt:""}),g().createElement("div",null,e.name))})))))};var w=function(t){function e(e){var a=t.call(this,e)||this;return a._handelChange=function(e,t){var n;a.setState(((n={})[e]=t,n.hasChanged=!0,n)),"source"===e?a.props.handelSourceChange&&a.props.handelSourceChange(t):a.input.style.border="1px solid #e5e5e5"},a.getValue=function(){var e=a.state;return{sourceId:e.source,name:e.urlName}},a.hasChanged=function(){return a.state.hasChanged},a.resetChanged=function(){return a.setState({hasChanged:!1})},a.test=function(){return""!==a.state.urlName||!(a.input.style.border="1px solid red")},a.state={show:!1,source:e.platValue&&e.platValue.sourceId||"",hasChanged:!1,urlName:e.platValue&&e.platValue.name||""},a}return l()(e,t),e.prototype.render=function(){var n=this,e=this.props,a=e.messageCategory,t=e.platformList,r=e.platLocked,l=this.state,o=l.source,s=l.urlName,e=l.show,l=20<t.length,c="NEWS"===a;return g().createElement("div",{className:"platform "+(this.props.className||"")},g().createElement("div",{className:"platform_wrap "},g().createElement("p",null,"平台"),g().createElement("ul",null,t.slice(0,c&&l?19:1/0).map(function(e,t){return g().createElement(N.Z,{key:e.id,placement:"top",overlay:e.name,mouseEnterDelay:.3},g().createElement("li",{onClick:c?function(){}:function(){r||e.id===o||n._handelChange("source",e.id)},className:r?"disable":c?"":"cursor"},g().createElement("img",{src:R(O.z[e.name]),alt:""}),!c&&g().createElement("div",null,g().createElement(_.Radio,{value:"",checked:e.id===o,disabled:"BBS"===a&&""!==s&&e.id!==o||r&&e.id!==o}))))}),c&&l&&g().createElement("li",{className:"more_plat",onClick:function(){return n.setState({show:!0})}},"查看更多"))),c&&l&&g().createElement("section",null,"共"+t.length+"个新闻平台，当前最多展示19个平台，点击查看更多"),g().createElement("div",{className:"url_name"},g().createElement("p",null,"链接名称",g().createElement("span",null,"*")),g().createElement("input",{type:"text",ref:function(e){return n.input=e},placeholder:"输入或选择链接名称",value:s,onChange:function(){return n._handelChange("urlName",n.input.value.substring(0,16))}})),g().createElement(x,{list:t,show:e,cancelShow:function(){return n.setState({show:!1})}}))},e}(d.Component),D=n(8201);const I=function(t){function e(e){var n=t.call(this,e)||this;return n.showDialog=function(e){n.state.visible?n.setState({visible:!1,callback:void 0},function(){n.setState(i()({visible:!0},e))}):n.setState(i()({visible:!0},e))},n._handleOnCancel=function(){n.setState({visible:!1,data:void 0,callback:void 0})},n._handleOnConfrim=function(){var e=n.state,t=e.callback,e=e.data;t&&t(e),n.setState({visible:!1,data:void 0,callback:void 0})},n.state={visible:!1,data:void 0,callback:void 0},n}return l()(e,t),e.prototype.render=function(){var e=this.state.visible;return g().createElement(_.Dialog,{className:"yt-nps-template-delete-dialog-wrapper",size:"tiny",visible:e,title:"确定离开此页面？",closeOnClickModal:!1,onCancel:this._handleOnCancel},g().createElement(_.Dialog.Body,null,"你有修改的内容尚未提交，现在离开此页面系统不会保存已修改的内容。"),g().createElement(_.Dialog.Footer,null,g().createElement(_.Button,{onClick:this._handleOnCancel},"取消"),g().createElement(_.Button,{type:"primary",onClick:this._handleOnConfrim},"确定")))},e}(g().PureComponent);const o=function(e){var t=e.messageCategory,n=e.platformList,a=e.platValue,r=e.name,l=e.ruleValue,o=e.conditionList,s=e.onSourceChange,c=e.getPlatformRef,i=e.getLinkRuleRef,u=e.onCancel,p=e.onSave,d=e.onSaveAndReturn,m=e.preUrl,h=e.fetchingPlatformConditionList,f=e.getExitDialogRef,e=(e=a&&a.name||"")?"编辑「"+e+"」":"新增数据链接",r=!!r||!r&&!(!a||!a.name);return g().createElement("div",{className:"yt_project_data_url_edit_wrapper"},g().createElement(v.Z,{title:(m=m,e=e,[{title:"所有项目",url:"/account/project"},{title:C.t.get(C.V.backProjectConfig).name,url:"/account/project/preview"},{title:"数据链接",url:m},{title:e,url:""}]),beforeJump:u}),g().createElement(D.Z,{data:n,className:"yt_project_detail_url_edit_content_wrapper"},g().createElement("div",{className:"edit_content"},n&&g().createElement(w,{ref:c,className:"edit_content_platform",messageCategory:t,platformList:n,platValue:a,handelSourceChange:s,platLocked:r}),g().createElement(S,{value:l,ref:i,messageCategory:t,className:"edit_content_rule",conData:o,plaData:n,loading:h})),g().createElement("div",{className:"edit_footer"},g().createElement(_.Button,{onClick:u},"取消"),g().createElement(_.Button,{onClick:p},"保存"),g().createElement(_.Button,{type:"primary",onClick:d},"保存并返回")),g().createElement(I,{ref:f})))};var t=n(55609),P=n(5133),s=n(64396).Z.project.dataUrlEdit,a=function(c){function e(e){var n=c.call(this,e)||this;n._handleOnSourceChange=function(e){n.props.fetchPlatformConditionList({id:e})},n._handleOnCancel=function(){n.plateformRef.hasChanged()||n.linkRuleRef.hasChanged()?n.exitDialogRef.showDialog({callback:function(){E.mW.go(-1)}}):E.mW.go(-1)},n._handleOnSave=function(e,t){n.plateformRef.test()&&n.linkRuleRef.test()&&n.props.commitDataScrabble(i()({},n.plateformRef.getValue(),n.linkRuleRef.getValue(),{callback:function(){P.Z.success("保存成功"),t&&E.mW.go(-1),n.plateformRef.resetChanged(),n.linkRuleRef.resetChanged()}}))},n._handleOnSaveAndReturn=function(e){n._handleOnSave(e,!0)};var t=e.location.pathname,a=e.location.state,r=a.messageType,l=a.id,o=a.syncKey,s=a.name,a=a.sourceId;return e.fetchPlatformList({messageCategory:r,urlId:l,syncKey:o,sourceId:a,name:s,projectId:C.t.get(C.V.backProjectConfig).id}),n.state={preUrl:t.substring(0,t.lastIndexOf("/")),urlId:e.location.state.id,platLocked:!1},n.event={getPlatformRef:function(e){return n.plateformRef=e},getLinkRuleRef:function(e){return n.linkRuleRef=e},getExitDialogRef:function(e){return n.exitDialogRef=e},onSave:n._handleOnSave,onCancel:n._handleOnCancel,onSourceChange:n._handleOnSourceChange,onSaveAndReturn:n._handleOnSaveAndReturn},n}l()(e,c);var t=e.prototype;return t.componentWillUnmount=function(){this.props.clean()},t.render=function(){return g().createElement(o,i()({},this.props,this.state,this.event,{key:this.state.urlId}))},e}(g().PureComponent);const c=(0,t.connect)(function(e){var t=e.loading,e=r()(e,["loading"]);return i()({},e[s],{fetchingPlatformConditionList:t.effects[s+"/fetchPlatformConditionList"]||!1})},function(t){return{fetchPlatformList:function(e){return t({type:s+"/fetchPlatformList",payload:e})},fetchPlatformConditionList:function(e){return t({type:s+"/fetchPlatformConditionList",payload:e})},commitDataScrabble:function(e){return t({type:s+"/commitDataScrabble",payload:e})},clean:function(e){return t({type:s+"/clean",payload:e})}}})(a)},24473:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var a=n(67154),p=n.n(a),r=n(37316),d=n.n(r),t=n(85354),l=n.n(t),a=n(67294),m=n.n(a),r=n(45697),t=n.n(r),r=n(94184),h=n.n(r),a=function(e){function t(){return e.apply(this,arguments)||this}return l()(t,e),t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.children,a=e.className,r=e.block,l=e.indeterminate,o=e.value,s=e.checked,c=e.defaultChecked,i=e.onChange,u=e.disabled,e=d()(e,["prefixCls","children","className","block","indeterminate","value","checked","defaultChecked","onChange","disabled"]),i={value:o,checked:s,defaultChecked:c,onChange:i,disabled:u},a=h()(t,((u={})[t+"-disabled"]=i.disabled,u[t+"-block"]=r,u[t+"-indeterminate"]=l,u),a);return m().createElement("label",p()({tabIndex:i.disabled?-1:0,className:a},e),m().createElement("input",p()({type:"checkbox",className:t+"-input"},i)),m().createElement("span",{className:t+"-status"}),n&&m().createElement("span",{className:t+"-text",title:n},n))},t}(a.Component);a.propTypes={prefixCls:t().string,value:t().oneOfType([t().string,t().number]),checked:t().bool,defaultChecked:t().bool,onChange:t().func,indeterminate:t().bool,disabled:t().bool,block:t().bool},a.defaultProps={prefixCls:"wt-checkbox"};const o=a},85151:(e,t,n)=>{"use strict";n.d(t,{Jg:()=>a.Z,CS:()=>s});var a=n(24473),r=n(67154),c=n.n(r),l=n(37316),i=n.n(l),t=n(85354),o=n.n(t),r=n(67294),u=n.n(r),l=n(45697),t=n.n(l),l=n(94184),p=n.n(l),l=function(r){function e(){for(var n,e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(n=r.call.apply(r,[this].concat(t))||this).handleCheckBoxChange=function(e){var t=n.props.onChange;t&&t(e)},n}return o()(e,r),e.prototype.render=function(){var r=this,e=this.props,t=e.prefixCls,n=e.children,a=e.className,l=(e.onChange,e.values),o=e.checkedList,s=e.block,e=i()(e,["prefixCls","children","className","onChange","values","checkedList","block"]),n=l?l.map(function(e,t){var n=0!==o.length&&-1!==o.indexOf(e);return u().createElement(Checkbox,{key:t,value:e,checked:n,onChange:function(e){return r.handleCheckBoxChange(e)},block:s},e)}):u().Children.map(n,function(e,t){if(e){var n=e.props,a=n.value,a=0!==o.length&&-1!==o.indexOf(a);return u().cloneElement(e,{checked:a,key:t,block:n.block||s,onChange:function(){var e=n.value;r.handleCheckBoxChange(e)}})}});return u().createElement("div",c()({className:p()(t,a)},e),n)},e}(r.Component);l.defaultProps={prefixCls:"wt-checkbox-group"},l.propTypes={onChange:t().func,values:t().array,block:t().bool};const s=l;var d=function(t){var n={};return Object.keys(t).forEach(function(e){/^data\-.+$/.test(e)&&(n[e]=t[e])}),n},r=function(e){function t(){return e.apply(this,arguments)||this}return o()(t,e),t.prototype.render=function(){var e=this.props,t=d(e);return u().createElement("label",{className:e.className,title:e.children},u().createElement("div",{className:"checkbox"},u().createElement("input",c()({checked:e.checked,type:"checkbox",name:e.name,onChange:e.onChange,disabled:e.disabled},t)),u().createElement("div",{className:"checkbox-body"}))," ",u().createElement("span",null,e.children))},t}(r.Component);r.defaultProps={className:"",name:"",checked:!1,disabled:!1,onChange:function(e){return e}}},58992:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var t=n(67154),o=n.n(t),t=n(85354),a=n.n(t),t=n(67294),g=n.n(t),v=n(92360),t=n(45697),t=n.n(t),C=n(2258),y=n.n(C),b=n(85151),E=[{label:"包含",value:"contain"},{label:"不包含",value:"notContain"}];const s=function(e){var l=e.ruleGroup,o=e.formRef,s=e.groupIdx,r=e.editable,c=e.onSelectChange,i=e.onInputChange,u=e.onRuleItemDelete,t=e.onRuleGroupDelete,n=e.onRuleItemAdd,a=e.onActiveRuleCheckChange,p=(0===l.contain.length||""===l.contain[0])&&0===l.notContain.length,d=g().useState(p),m=d[0],h=d[1],e=g().useState(""),p=e[0],f=e[1];g().useEffect(function(){var e,n;m||f((e=l.sentence,n=l,(e?"一句话中":"全文中")+"："+["contain","notContain"].reduce(function(e,t){return n[t]&&0<n[t].length?[].concat(e,[("contain"===t?"包含":"不包含")+n[t].map(function(e){return'<span style="color: #262626;">“'+e+"”</span>"}).join("，")]):e},[]).join("，且")))},[m]);d=l.contain.length+l.notContain.length,e=42*d+30+10;return g().createElement("div",{className:"content-rule-group"},g().createElement("div",{className:"content-rule-group-top"},g().createElement("span",{className:"show-icon",onClick:function(){var t,a,e,n,r;m?(t=l,a=s,e=o,n=["contain","notContain"].reduce(function(e,n){return[].concat(e,t[n].map(function(e,t){return"rule-"+a+"-"+n+"-"+t}))},[]),r=e[0],n=n.map(function(e){return new Promise(function(t,n){r?r.validateField(e,function(e){(null===e?t:n)()}):n()})}),Promise.all(n).then(function(){h(!1)})):h(!0)}},g().createElement("i",{className:"icon-cem_pull-or-take-up",style:{transform:"rotate("+(m?-180:0)+"deg)"}})),g().createElement("span",{className:"content-rule-group-title"},m?g().createElement("span",{className:"group-title-check"},g().createElement(b.Jg,{checked:l.sentence,onChange:function(e){e=e.currentTarget.checked;return a(s,e)}}),g().createElement("span",{style:{marginLeft:8}},"以下关键词出现在",g().createElement("span",{style:{color:"#262626"}},"“一句话”"),"中条件才生效?")):g().createElement("span",{dangerouslySetInnerHTML:{__html:p}})),g().createElement("span",{className:"group-delete",onClick:function(){return t(s)}},g().createElement("i",{className:"icon-cem_delete"}))),g().createElement("div",{className:"content-rule-group-list",style:{height:m?e:0,paddingTop:m?10:0}},g().createElement("div",{className:"group-list "+(1<d?"mulit-group-list":"")},g().createElement("span",{className:"list-left"},g().createElement("span",{style:{fontSize:14}},"且")),g().createElement("span",{className:"list-right"},["contain","notContain"].map(function(a){return l[a]&&l[a].map(function(e,t){var n="rule-"+s+"-"+a+"-"+t;return g().createElement("div",{key:n,className:"content-rule-group-item"},g().createElement("span",null,g().createElement(y(),{disabled:!r,value:E.find(function(e){return e.value===a}).label,onChange:function(e){return c(n,e)}},E.map(function(e){return g().createElement(C.Option,{key:e.value,title:e.label},e.label)}))),g().createElement("span",{style:{height:42}},g().createElement(v.Form.Item,{prop:n},g().createElement(v.Input,{disabled:!r,value:e,onChange:function(e){return i(n,e)}}))),r&&g().createElement("span",{onClick:function(){return u(n)}},g().createElement("i",{className:"icon-cem_delete"})))})}))),r&&g().createElement(g().Fragment,null,g().createElement("span",{className:"add-icon",onClick:function(){return n(s)}},g().createElement("i",{className:"icon-cem_add-to"})),g().createElement("span",{style:{marginLeft:8,color:"#262626",fontSize:14}},"添加新的关键词"))))};var r={contain:[""],notContain:[],sentence:!0,id:Math.round(1e4*Math.random())},n=function(t){function e(e){var s=t.call(this,e)||this;s._handleOnRuleGroupAdd=function(){var e=s.state.content,e=[].concat(e,[JSON.parse(JSON.stringify(r))]);s.setState({content:e,formProps:s.getFormProps(e),hasChanged:!0})},s._handleOnRuleItemAdd=function(e){var t,n=s.state.content,a=s.props.onChange;n[e]&&((t=JSON.parse(JSON.stringify(n)))[e].contain||(t[e].contain=[]),t[e].contain.push(""),s.setState({content:t,formProps:s.getFormProps(t),hasChanged:!0},function(){return a&&a(t)}))},s._handleOnRuleItemDelete=function(e){var t,n,a,r,l;e&&(t=s.state.content,n=s.props.onChange,(r=e.split("-"))[0],a=r[1],e=r[2],r=r[3],t[a]&&t[a][e]&&void 0!==t[a][e][r]&&((l=JSON.parse(JSON.stringify(t)))[a][e].splice(r,1),0===l[a].contain.length&&0===l[a].notContain.length&&l.splice(a,1),s.setState({content:l,formProps:s.getFormProps(l),hasChanged:!0},function(){return n&&n(l)})))},s._handleOnSelecChange=function(e,t){var n,a,r,l,o;e&&t&&(n=s.state.content,a=s.props.onChange,(o=e.split("-"))[0],r=o[1],e=o[2],o=o[3],n[r]&&n[r][e]&&void 0!==n[r][e][o]&&(o=(l=JSON.parse(JSON.stringify(n)))[r][e].splice(o,1),l[r][t].push(o[0]),s.setState({content:l,formProps:s.getFormProps(l),hasChanged:!0},function(){return a&&a(l)})))},s._handleOnInputChange=function(e,t){var n,a,r,l,o;e&&(n=s.state.content,a=s.props.onChange,(l=e.split("-"))[0],r=l[1],e=l[2],l=l[3],n[r]&&n[r][e]&&void 0!==n[r][e][l]&&((o=JSON.parse(JSON.stringify(n)))[r][e][l]=t,s.setState({content:o,formProps:s.getFormProps(o),hasChanged:!0},function(){return a&&a(o)})))},s._handleOnActiveRuleCheckChange=function(e,t){var n,a=s.state.content,r=s.props.onChange;a[e]&&((n=JSON.parse(JSON.stringify(a)))[e].sentence=t,s.setState({content:n,hasChanged:!0},function(){return r&&r(n)}))},s._handleOnRuleGroupDelete=function(e){var t,n=s.state.content,a=s.props.onChange;!n[e]||(t=JSON.parse(JSON.stringify(n))).splice(e,1)&&s.setState({content:t,hasChanged:!0,formProps:s.getFormProps(t)},function(){return a&&a(t)})},s.getValue=function(){return s.state.content},s.hasChanged=function(){return s.state.hasChanged},s.getFormProps=function(e){var r={model:{},rules:{}};return e&&0<e.length&&e.forEach(function(e,a){e&&["contain","notContain"].forEach(function(n){e[n]&&e[n].forEach(function(e,t){t="rule-"+a+"-"+n+"-"+t;r.model[t]=e,r.rules[t]=[{required:!0,message:" ",trigger:"blur"}]})})}),r},s.mRefs=[],s.formRef=void 0;e=(e.value||[r]).map(function(e){return o()({},e,{id:Math.round(1e4*Math.random())})});return s.state={content:e,formProps:s.getFormProps(e),hasChanged:!1},s}a()(e,t);var n=e.prototype;return n.componentDidUpdate=function(e){var t=e.value,e=this.props.value;JSON.stringify(t)!==JSON.stringify(e)&&this.setState({content:e,formProps:this.getFormProps(e)})},n.render=function(){var n=this,e=this.state,t=e.content,a=e.formProps,r=this.props,e=r.editable,l=void 0===e||e,r=r.className,r=void 0===r?"":r;return g().createElement("div",{className:"content-rule-wrapper "+r},g().createElement("span",{className:"content-rule-title"},"内容"),g().createElement("div",{className:"content-rule"},g().createElement(v.Form,o()({},a,{ref:function(e){n.formRef=e,n.mRefs.splice(0,n.mRefs.length),n.mRefs.push(e)}}),0<t.length&&g().createElement("span",{className:"content-rule-hint"},"满足任意一组条件，该规则即生效"),t.map(function(e,t){return g().createElement(s,{key:e.id,formRef:n.mRefs,ruleGroup:e,groupIdx:t,editable:l,onSelectChange:n._handleOnSelecChange,onRuleGroupDelete:n._handleOnRuleGroupDelete,onInputChange:n._handleOnInputChange,onRuleItemDelete:n._handleOnRuleItemDelete,onRuleItemAdd:n._handleOnRuleItemAdd,onActiveRuleCheckChange:n._handleOnActiveRuleCheckChange})})),l&&g().createElement(g().Fragment,null,g().createElement("span",{className:"add-icon",onClick:this._handleOnRuleGroupAdd},g().createElement("i",{className:"icon-cem_add-to"})),g().createElement("span",{style:{marginLeft:8,color:"#262626",fontSize:14}},"添加新的条件"))))},e}(g().PureComponent);const l=n;n.propTypes={value:t().array,editable:t().bool,onChange:t().func,className:t().string}},29030:(e,t,n)=>{"use strict";n.d(t,{z:()=>a});var a={"百度知道":"bdzd","百度贴吧":"bdtb","八爪鱼":"bzy","nps问卷":"nps","科沃斯":"ecovacs","科沃斯官网":"ecovacs","科沃斯商城":"ecovacs","国美":"gm","京东":"jd","苏宁易购":"snyg","苏宁":"snyg","天猫":"tm","淘宝":"tb","唯品会":"wph","微信":"wx","公众号":"wx","微信公众号":"wx","新浪":"xl","新浪微博":"xl","微博":"xl","新浪新闻":"xlxw","小米商城":"xm","小米社区":"xm_bbs","亚马逊":"ymx","米家有品":"yp","知乎":"zh","百度":"bd","VIVO官网":"vivo","海信":"haixin","1号店":"yhd","创维":"chuangwei","欢太商城":"htsc","自定义":"custom","云听CEM":"nps","花粉俱乐部":"huawei","vivo社区":"vivo_bbs","coloros社区":"coloros_bbs","酒仙":"jx","一点资讯":"yd","小红书":"xhs","什么值得买":"smzdm",bilibili:"bilibili","今日头条":"jrtt","网易新闻":"wyxw","百度新闻":"bdxw","腾讯新闻":"txxw","抖音":"dy","新闻":"xw","聚投诉":"jts","黑猫投诉":"hmts","拼多多":"pdd","OPPO社区":"opposq","大众点评":"dzdp","微博评论":"xl","抖音小店":"douyin"}},44311:(e,t,n)=>{var a={"./bdtb.png":93266,"./bdxw.png":54114,"./bdzd.png":6005,"./bilibili.png":46424,"./chuangwei.png":85250,"./coloros_bbs.png":84216,"./custom.png":90421,"./dy.png":67385,"./dzdp.png":71493,"./ecovacs.png":42226,"./gm.png":34276,"./haixin.png":17833,"./hmts.png":5354,"./htsc.png":208,"./huawei.png":99201,"./jd.png":72188,"./jrtt.png":93853,"./jts.png":42099,"./jx.png":46634,"./nps.png":41259,"./opposq.png":11965,"./pdd.png":77429,"./smzdm.png":52857,"./snyg.png":93990,"./tb.png":95537,"./tm.png":39821,"./txxw.png":66965,"./vivo.png":88331,"./vivo_bbs.png":19166,"./wph.png":70277,"./wx.png":99255,"./wyxw.png":18301,"./xhs.png":47203,"./xl.png":3246,"./xlxw.png":21265,"./xm.png":19029,"./xm_bbs.png":67037,"./xm_bbs1.png":18281,"./yd.png":21263,"./yhd.png":32710,"./ymx.png":29898,"./yp.png":10847,"./zh.png":21267};function r(e){e=l(e);return n(e)}function l(e){if(n.o(a,e))return a[e];e=new Error("Cannot find module '"+e+"'");throw e.code="MODULE_NOT_FOUND",e}r.keys=function(){return Object.keys(a)},r.resolve=l,(e.exports=r).id=44311}}]);