(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[50],{"6Xi5":function(e,t,n){"use strict";n.r(t);var a=n("k1fw"),c=(n("+L6B"),n("2/Rp")),l=(n("ozfa"),n("MJZm")),o=(n("sRBo"),n("kaz8")),r=(n("miYZ"),n("tsqr")),i=n("oBTY"),d=(n("5NDa"),n("5rEg")),u=n("fWQN"),s=n("mtLc"),h=n("yKVA"),p=n("879j"),m=n("q1tI"),k=n.n(m),f=n("9kvl"),y=n("4u2m"),v=n("SlE0"),b=n.n(v),j=n("Hx5s"),N=function(e){Object(h["a"])(n,e);var t=Object(p["a"])(n);function n(e){var a,c;Object(u["a"])(this,n),c=t.call(this,e),c.state=void 0,c.setTreeData=function(){c.setState({treeData:c.props.options.map((function(e){return{id:e.id,key:e.menuType,title:k.a.createElement(d["a"],{defaultValue:e.menuName,placeholder:"\u8bf7\u8f93\u5165\u83dc\u5355\u540d\u79f0",size:"small",style:{border:"none"},onPressEnter:function(e){var t=e.target;c._handleOnRename(t.value)}}),children:e.submenu?e.submenu.map((function(e){return{id:e.id,key:e.menuType,title:k.a.createElement(d["a"],{defaultValue:e.menuName,placeholder:"\u8bf7\u8f93\u5165\u83dc\u5355\u540d\u79f0",size:"small",style:{border:"none"},onPressEnter:function(e){var t=e.target;c._handleOnRename(t.value)}}),children:e.submenu?e.submenu.map((function(e){return{id:e.id,key:e.menuType,title:k.a.createElement(d["a"],{defaultValue:e.menuName,placeholder:"\u8bf7\u8f93\u5165\u83dc\u5355\u540d\u79f0",size:"small",style:{border:"none"},onPressEnter:function(e){var t=e.target;c._handleOnRename(t.value)}})}})):null}})):null}}))})},c._handleOnRename=function(e){if(e){var t=c.state,n=t.selectedKeys,a=t.checkedNodes;c.setState({checkedNodes:a.find((function(e){return e.menuType===n.key}))?[].concat(Object(i["a"])(a.filter((function(e){return e.menuType!==n.key})).map((function(e){return e}))),[{id:n.id,menuType:n.key,menuName:e}]):[].concat(Object(i["a"])(a),[{id:n.id,menuType:n.key,menuName:e}])},(function(){c.props.editMenu({projectTypes:c.state.checkedNodes})}))}else r["default"].error("\u83dc\u5355\u540d\u4e0d\u80fd\u4e3a\u7a7a")},c.onSelect=function(e,t){c.setState({selectedKeys:t.node})},c.onCheck=function(e,t){var n=c.props,a=n.options,l=n.value,o=Object(y["a"])(a).length===l.length,r=e.checked.length>0&&!o&&Object(y["a"])(a).length!==l.length;c.setState({isAllChecked:o,indeterminate:r,checkedValues:{checked:e.checked,halfChecked:[]},checkedNodes:t.checkedNodes.map((function(e){return{id:e.id,menuType:e.key,menuName:e.title.props.defaultValue}}))})},c._handleOnAllChange=function(e){var t=e.target,n=c.props.options,a=t.checked;c.setState({isAllChecked:a,indeterminate:!1,checkedValues:{checked:a?Object(y["a"])(n).map((function(e){return e.menuType})):[],halfChecked:[]},checkedNodes:a?Object(y["a"])(n):[]})},c._handleOnSave=function(){var e=c.state.checkedNodes;c.props.editMenu({projectTypes:e})};var l=e.options,o=e.value,s=e.checkedNodes,h=e.location,p=o.length>0&&Object(y["a"])(l).length===o.length;return c.state={isAllChecked:p,indeterminate:!p&&o.length>0,checkedValues:{checked:o,halfChecked:[]},checkedNodes:s,treeData:[],selectedKeys:{}},c.props.fetchMenuAllList({id:null===(a=h.state)||void 0===a?void 0:a.projectId}),c}return Object(s["a"])(n,[{key:"componentDidMount",value:function(){this.setTreeData()}},{key:"componentDidUpdate",value:function(e,t){var n=e.value,a=(e.options,e.id),c=(e.checkedNodes,this.props),l=c.options,o=c.value,r=c.id,i=c.checkedNodes;if(JSON.stringify(n)!==JSON.stringify(o)){var d=Object(y["a"])(l).length===o.length;this.setState({isAllChecked:d,checkedValues:{checked:o,halfChecked:[]},checkedNodes:i,indeterminate:!d&&o.length>0})}a!==r&&this.setTreeData()}},{key:"componentWillUnmount",value:function(){this.props.clean()}},{key:"render",value:function(){var e=this.state,t=e.indeterminate,n=e.isAllChecked,a=e.checkedValues,r=e.treeData;return k.a.createElement(j["b"],{title:"\u83dc\u5355\u914d\u7f6e",className:b.a.project_menu},k.a.createElement("div",{className:b.a.content},k.a.createElement("div",{className:b.a.checkboxAllWrapper},k.a.createElement(o["a"],{indeterminate:t,onChange:this._handleOnAllChange,checked:n},"\u5168\u9009")),r&&r.length>0&&k.a.createElement(l["a"],{checkable:!0,checkStrictly:!0,checkedKeys:a.checked,defaultExpandAll:!0,onSelect:this.onSelect,onCheck:this.onCheck,treeData:r}),k.a.createElement("div",{className:b.a.footerStyle},k.a.createElement(c["a"],{onClick:function(){f["d"].push("/account/projects")}},"\u53d6\u6d88"),k.a.createElement(c["a"],{onClick:this._handleOnSave},"\u4fdd\u5b58"))))}}]),n}(k.a.PureComponent),g=function(e){var t=e.projectMenuEdit,n=e.loading;return Object(a["a"])(Object(a["a"])({},t),{},{loading:n.effects["projectMenuEdit/fetchMenuAllList"]||!1})},O=function(e){return{save:function(t){return e({type:"projectMenuEdit/save",payload:t})},clean:function(t){return e({type:"projectMenuEdit/clean",payload:t})},fetchMenuAllList:function(t){return e({type:"projectMenuEdit/fetchMenuAllList",payload:t})},editMenu:function(t){return e({type:"projectMenuEdit/editMenu",payload:t})}}};t["default"]=Object(f["a"])(g,O)(N)},SlE0:function(e,t,n){e.exports={project_menu:"project_menu___1FILa",content:"content___HFwGk",checkboxAllWrapper:"checkboxAllWrapper___sr2Ni",footerStyle:"footerStyle___3o8Hq"}}}]);