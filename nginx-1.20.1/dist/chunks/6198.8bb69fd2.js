"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[6198],{26198:(e,t,n)=>{n.d(t,{Z:()=>T});var a=n(63366),l=n(87462),r=n(94578),i=n(67294),o=n(45697),s=n.n(o),c=n(43144),u=n(92360);const d=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.onConfirm,a=t.onCancel,l=t.style;return i.createElement("div",{className:"bottom_bar",style:l||{}},i.createElement("ul",{className:"handle"},this.props.screeningValues.length>0&&i.createElement("li",null,i.createElement("span",{className:"clear",onClick:function(){return e.props.clearAllValues()}},"\u6e05\u7a7a\u9009\u9879"))),i.createElement(u.Button,{type:"primary",onClick:function(){n&&n()}},"\u67e5\u8be2"),i.createElement(u.Button,{onClick:function(){a&&a()}},"\u53d6\u6d88"))},t}(i.PureComponent);var f=n(83330);const h=function(e){function t(t){var n;return(n=e.call(this,t)||this).onConfirm=function(){n.props.handelChangeShow(!1),n.props.onSearchButtonClick()},n.onCancel=function(){n.props.handelChangeShow(!1)},n.clearAllValues=function(){n.props.clearAllValues()},n.state={},n}return(0,r.Z)(t,e),t.prototype.render=function(){var e=this.props,t=(e.handelChangeShow,e.screeningValues),n=e.show,a=e.onFilterReady,r=e.type;return i.createElement("div",{className:"screening_wrap_view"},i.createElement(f.Z,(0,l.Z)({},this.props,{onReady:a,type:r,onChange:void 0})),n&&i.createElement(d,{onConfirm:this.onConfirm,onCancel:this.onCancel,clearAllValues:this.clearAllValues,screeningValues:t}))},t}(i.Component);const p=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e._handelClick,n=e.select,a=e.name,l=e.style,r=e.icon;return i.createElement("div",{className:"HeaderButton",style:l||{}},i.createElement("div",{className:n?"sel wrap":"wrap",onClick:function(){return t()}},i.createElement("i",{className:"icon-cem_"+r}),i.createElement("span",null,a),i.createElement("i",{className:"icon-cem_pull-down-or-take-up",style:{transform:n?"rotate(180deg) translateY(-1px)":""}})))},t}(i.PureComponent);var m=n(77131),v=n(18446),g=n.n(v),C=n(30133),S=n(97326),k=n(5133),y=function(e){return void 0===e&&(e=""),e.length>16?e.substring(0,15)+"...":e},E=function(e){function t(t){var n;return(n=e.call(this,t)||this).sortList=function(e,t,a){a.stopPropagation(),a.nativeEvent.stopImmediatePropagation();var l=JSON.parse(JSON.stringify(n.state.value)),r=l.splice(e,1)[0];switch(t){case"top":l.unshift(r);break;case"up":l.splice(e-1,0,r);break;case"down":l.splice(e+1,0,r)}n.setState({value:l},(function(e){return n.props.onChange&&n.props.onChange(n.getValue())}))},n.state={value:t.defaultChecks||[],searchWord:""},n}(0,r.Z)(t,e);var n=t.prototype;return n.onSel=function(e,t){var n=this.state.value;(n=JSON.parse(JSON.stringify(n))).map((function(e){return e.id})).includes(t.id)?n.splice(n.findIndex((function(e){return e.id===t.id})),1):n.push(t),this.props.maxSelect&&n.length>this.props.maxSelect?k.Z.warning("\u6700\u591a\u9009\u62e9"+this.props.maxSelect+"\u4e2a\u5bf9\u8c61\uff01"):this.setState({value:n})},n.getValue=function(){return this.state.value},n.render=function(){var e=this,t=this.props,n=t.options,a=t.defaultChecks,l=t.maxSelect,r=t.onCancel,o=t.onChange,s=t.disabledValue,c=this.state,d=c.value,f=c.searchWord,h=a.map((function(e){return e.id})),p=d.map((function(e){return e.id})),m=n.filter((function(e){return!h.includes(e.id)})),v=a.filter((function(e){return!f||-1!==(e.label||"").toLocaleLowerCase().indexOf(f.trim().toLocaleLowerCase())})),g=m.filter((function(e){return!f||-1!==(e.label||"").toLocaleLowerCase().indexOf(f.trim().toLocaleLowerCase())}));return i.createElement("div",{className:"filter-sort-select"},i.createElement("div",{className:"selItem "+(this.props.triangle?"triangle":""),onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},i.createElement("div",{className:"wrap"},i.createElement("div",{className:"title_name"},"\u6dfb\u52a0\u5c55\u793a",i.createElement("span",null,"\uff08\u6700\u591a"+l+"\u4e2a\uff0c\u5df2\u6dfb\u52a0"+d.length+"\u4e2a\uff09")),i.createElement("div",null,i.createElement(u.Input,{value:f,placeholder:"\u8bf7\u8f93\u5165\u5173\u952e\u8bcd",className:"search",size:"small",icon:f?"close":"search",onChange:function(t){return e.setState({searchWord:t})},onIconClick:function(){return e.setState({searchWord:""})}})),i.createElement("ul",null,v.map((function(t,n){return i.createElement("li",{className:(p.includes(t.id)?"sel":"")+(t.disable?" disable":""),key:n,onClick:function(n){!s.includes(t.id)&&e.onSel(n,t)}},i.createElement(u.Checkbox,{className:"check-all",checked:p.includes(t.id),disabled:s.includes(t.id),onChange:function(n){return s.includes(t.id)?"":e.onSel(n,t)}},i.createElement("span",null,y(t.label))))})),g.slice(0,100-v.length).map((function(t,n){return i.createElement("li",{className:(p.includes(t.id)?"sel":"")+(t.disable?" disable":""),key:n,onClick:function(n){return e.onSel(n,t)}},i.createElement(u.Checkbox,{className:"check-all",checked:p.includes(t.id),onChange:function(n){return e.onSel(n,t)},disabled:!p.includes(t.id)&&d.length>=l},i.createElement("span",{className:"dark"},y(t.label))))})),v.length+g.length>100?i.createElement("li",{style:{color:"#d96969"}},"\u6570\u503c\u5c55\u793a\u4e0d\u8d85\u8fc7100\u6761\uff0c\u67e5\u770b\u66f4\u591a\u8bf7\u641c\u7d22"):null,0===v.length&&0===g.length&&i.createElement("div",{className:"noData"},"\u6ca1\u6709\u76f8\u5173\u9009\u9879"))),i.createElement("div",{className:"line"}),i.createElement("div",{className:"control"},i.createElement("div",null,i.createElement(u.Button,{type:"",onClick:r},"\u53d6\u6d88"),i.createElement(u.Button,{type:"primary",onClick:function(){return o(d)}},"\u786e\u5b9a")))))},t}(i.Component);E.propTypes={options:s().array,value:s().array,onChange:s().func,show:s().bool,onCancel:s().func,maxSelect:s().number};var N=n(51474),w=n(39432),b=n(43036),F=function(e){function t(t){var n;return(n=e.call(this,t)||this).getPanelWidth=function(){var e=n.props,t=e.showFlavor,a=void 0!==t&&t,l=e.options,r=Math.max.apply(null,l.map((function(e){return(0,w.jD)(e.title,14)})))+2+24+25;return(r+=a?24:0)>100?r:100},n.setHoverDisable=function(){n.setState({disableHover:!0}),setTimeout((function(){return n.setState({disableHover:!1})}),100)},n.state={disableHover:!1,firstLiHover:!1,panelWidth:n.getPanelWidth()},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){window.addEventListener("click",this._setPadShowFalse)},n.componentWillUnmount=function(){window.removeEventListener("click",this._setPadShowFalse)},n.componentDidUpdate=function(e){var t=e.options,n=this.props.options;JSON.stringify(t)!==JSON.stringify(n)&&this.setState({panelWidth:this.getPanelWidth()})},n.render=function(){var e=this,t=this.state,n=t.panelWidth,a=t.disableHover,l=this.props,r=l.activeObj,o=void 0===r?"":r,s=l.onChange,c=l.options,u=l.objName,d=l.preTitle,f=l.sufTitle,h=void 0===f?"":f,p=l.showTitle,m=void 0===p||p,v=l.overlay,g=(l.flavor,l.onFlavorChange,l.showFlavor,l.collectValue,l.updateCollectValue,c.find((function(e){return e.value===o}))),C=""===o?h:g&&g.title;return i.createElement("div",{className:"fast-single-select-button-wrapper",onClick:this._handleParentClick,style:{pointerEvents:a?"none":""}},i.createElement("div",{className:"button_content"},i.createElement("span",{onClick:this._handleTriggerOnClick},i.createElement("span",{className:"button-trigger"},m&&i.createElement(i.Fragment,null,d&&i.createElement("span",{className:"pre-title"},d,"\uff1a"),i.createElement("span",{className:"button-title"},C)),i.createElement("i",{className:"icon-cem_arrow-launches"})),v&&i.createElement("span",{style:{marginLeft:4}},i.createElement(b.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:v},i.createElement("i",{className:"icon-cem_file1"})))),i.createElement("div",{className:"button-panel",style:{minWidth:n,top:a?"-1000px":""}},c.map((function(t,n){return i.createElement("div",{className:"panel-item "+(t.value===o?"sel":"")+" "+(t.disabled?"disabled":""),key:t.value,onClick:function(){var n;e.setHoverDisable(),!t.disabled&&t.value!==o&&s(u?((n={})[u]=t.value,n):t.value)}},t.title)})))))},t}(i.PureComponent);F.propTypes={activeObj:s().any,onChange:s().func.isRequired,options:s().array.isRequired,objName:s().any,preTitle:s().string,sufTitle:s().string,showTitle:s().bool,overlay:s().string,showFlavor:s().bool,flavor:s().string,onFlavorChange:s().func};const V=F;var _=function(e){return document.querySelector(e)};const O=function(e){function t(t){var n;return(n=e.call(this,t)||this).defaultIsSelectAllChange=function(){var e=JSON.parse(JSON.stringify(n.props)).defaultConfig,t=(0,S.Z)(n).curFast;e.defaultChecked.forEach((function(e){e.id===t.id&&(e.isSelectAll=!e.isSelectAll)})),n.props.defaultValueChange({value:{defaultChecked:e.defaultChecked}}).then((function(){n.props.onSearch()}))},n.defaultChecksNameChange=function(e){n.props.defaultValueChange({value:{defaultChecksName:[e]}}).then((function(){n.props.onSearch()}))},n.defaultCheckedChange=function(e,t){var a=JSON.parse(JSON.stringify(n.props)).defaultConfig,l=a.defaultNumberChecked,r=(0,S.Z)(n),i=r.curFast,o=r.curFastShowList,s=JSON.parse(JSON.stringify(i.values));if("add"===e)if(1===l)s=[t];else{var c=[];s.push(t),o.forEach((function(e){return s.forEach((function(t){return t===e.id&&c.push(t)}))})),s=c}else if("del"===e){if(1===s.length)return void k.Z.warning("\u81f3\u5c11\u4fdd\u7559\u4e00\u4e2a\u9009\u9879");s.splice(s.indexOf(t),1)}a.defaultChecked.forEach((function(e){e.id===i.id&&(e.values=s)})),n.props.defaultValueChange({value:{defaultChecked:a.defaultChecked}}).then((function(){n.props.onSearch()}))},n.defaultChecksChange=function(e,t){var a=JSON.parse(JSON.stringify(n.curFastShowList)),l=JSON.parse(JSON.stringify(n.props)).defaultConfig;"add"===e?a.push(t):"del"===e?a.splice(a.findIndex((function(e){return e.id===t.id})),1):"replace"===e&&(a=t),l.defaultChecks.forEach((function(e){e.id===n.curFast.id&&(e.values=a)})),n.props.defaultValueChange({value:{defaultChecks:l.defaultChecks}})},n.clickListener=function(e){n.setState({showSelector:!1})},n.getWidth=function(){var e=_(".header_Filter_bar").offsetWidth-Array.from(_(".header_Filter_bar").children).filter((function(e){return"fast_filter"!==e.className})).reduce((function(e,t){return e+t.offsetWidth}),0)-_(".header_Filter_bar .fast_filter .name").offsetWidth-40-28-32;n.setState({maxWidth:e})},n.state={showSelector:!1,maxWidth:500},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;window.addEventListener("click",this.clickListener),window.addEventListener("resize",this.getWidth),this.getWidth(),new N.default(document.querySelector(".fast_wrap"),{sort:!0,animation:150,draggable:".fast_block",handel:".handel",onEnd:function(t){var n=t.oldIndex,a=t.newIndex,l=JSON.parse(JSON.stringify(e.props)).defaultConfig,r=e.curFast,i=e.curFastShowList,o=JSON.parse(JSON.stringify(i)),s=o.splice(n,1)[0];o.splice(a,0,s),l.defaultChecks.forEach((function(e){e.id===r.id&&(e.values=o)}));var c={defaultChecks:l.defaultChecks};g()(r.values,o.filter((function(e){return r.values.includes(e.id)})).map((function(e){return e.id})))||(l.defaultChecked.forEach((function(e){e.id===r.id&&(e.values=[],o.forEach((function(t){r.values.forEach((function(n){t.id===n&&e.values.push(n)}))})))})),c.defaultChecked=l.defaultChecked),e.props.defaultValueChange({value:c}).then((function(){return c.defaultChecked&&e.props.onSearch()}))}})},n.componentWillUnmount=function(){window.removeEventListener("click",this.clickListener),window.removeEventListener("resize",this.getWidth)},n.render=function(){var e=this,t=this.props,n=t.defaultConfig,a=t.screeningList,l=this.state,r=l.showSelector,o=l.maxWidth,s=this.curFast,c=this.curFastShowList,u=s.isSelectAll,d=n.defaultChecked,f=void 0===d?[]:d,h=n.defaultChecksName,p=void 0===h?[]:h,m=n.defaultNumberChecked,v=n.defaultNumberConfig,g=a.map((function(e){return e.data})).flat(1).filter((function(e){return e.id===p[0]})).length?a.map((function(e){return e.data})).flat(1).filter((function(e){return e.id===p[0]}))[0]:{};return i.createElement("div",{className:"fast_filter"},i.createElement("div",{className:"name"},1===f.length?g.label:i.createElement(V,{options:f.map((function(e){return{title:e.label,value:e.id}})),activeObj:p[0],onChange:function(t){return e.defaultChecksNameChange(t)}}),"boolean"===typeof u&&i.createElement("div",{className:"select_all "+(u?"select":""),onClick:this.defaultIsSelectAllChange},i.createElement("span",null,"\u5168\u9009"))),i.createElement("div",{className:"fast_wrap",style:{maxWidth:o}},u&&i.createElement("div",{className:"cover",onClick:this.defaultIsSelectAllChange}),c.map((function(t){return i.createElement("span",{key:t.id,className:"fast_block "+(s.values.includes(t.id)?"select":"")+" "+(s.values.length>=m&&1!==m?"disabled":"")+" "+(u?"disabled_all":""),onClick:function(){return u?"":(s.values.length<m||s.values.includes(t.id)||1===m)&&e.defaultCheckedChange(s.values.includes(t.id)?"del":"add",t.id)}},i.createElement("span",{title:t.label},t.label),i.createElement("i",{className:"icon-cem_cancel",onClick:function(n){n.stopPropagation(),e.defaultChecksChange("del",t)}}))}))),i.createElement("div",{className:"add",onClick:function(t){t.stopPropagation(),e.setState({showSelector:!r})}},i.createElement("span",null,"+"),r&&i.createElement(E,{options:g.options,defaultChecks:c,onChange:function(t){e.setState({showSelector:!1}),e.defaultChecksChange("replace",t)},disabledValue:s.values,maxSelect:v,onCancel:function(){return e.setState({showSelector:!1})}})))},(0,c.Z)(t,[{key:"curFast",get:function(){var e=this.props.defaultConfig;return e.defaultChecked.find((function(t){return t.id===e.defaultChecksName[0]}))||{}}},{key:"curFastShowList",get:function(){var e=this.props.defaultConfig;return(e.defaultChecks.find((function(t){return t.id===e.defaultChecksName[0]}))||{}).values||[]}}]),t}(i.Component);const L=function(e){function t(t){var n;return(n=e.call(this,t)||this).handelChangeShow=function(e){return n.setState({show:e===n.state.show?null:e})},n.handelTimeChange=function(e){n.props.dateValueChange({value:e}).then((function(){n.fastRef&&n.fastRef.getWidth(),n.handelChangeShow(null),n.props.onSearch()}))},n.state={show:t.defaultShow?t.defaultShow:null},n}return(0,r.Z)(t,e),t.prototype.render=function(){var e=this,t=this.state.show,n=this.props,a=n.title,r=n.dateFilter,o=n.onSearchButtonClick,s=n.screeningList,c=n.curScreeningMap,d=n.children,f=n.getTimeRef,v=n.defaultConfig,g=n.defaultValueChange,S=n.onSearch,k=n.onFilterReady,y=n.expandInfo,E=n.noSavingFilterList,N=n.transferValue;return i.createElement("div",{className:"header_Filter_view",style:{height:d?"100%":""}},i.createElement(u.Loading,{loading:void 0===c||void 0===v},i.createElement("div",{className:"header_Filter_bar"},a?"string"===typeof a?i.createElement("div",{className:"filter_title"},a):i.createElement("div",{style:{float:"left"}},a):v&&v.defaultChecksName&&v.defaultChecksName.length>0&&i.createElement(O,{ref:function(t){return e.fastRef=t},defaultConfig:v,screeningList:s,defaultValueChange:g,onSearch:S,disabled:"screening"===t}),i.createElement(p,{name:this.time,_handelClick:function(){return e.handelChangeShow("time")},select:"time"===t,icon:"time-controller"}),i.createElement(p,{name:"\u7b5b\u9009",_handelClick:function(){return e.handelChangeShow("screening")},select:"screening"===t,icon:"screen"})),i.createElement("div",null,i.createElement(h,(0,l.Z)({},this.props,{show:"screening"===t,handelChangeShow:this.handelChangeShow,onSearchButtonClick:o,onFilterReady:k,expandInfo:y,noSavingFilterList:E,transferValue:N})),i.createElement(m.Z,{ref:f,onChange:function(t){return e.handelTimeChange(t)},show:"time"===t,onCancel:function(){return e.handelChangeShow("time")},params:r}))),d&&i.createElement("div",{className:"contentWrap"},void 0===c?i.createElement(C.Z,null):d))},(0,c.Z)(t,[{key:"time",get:function(){var e="\u65f6\u95f4";return this.props.dateFilter&&this.props.dateFilter.from&&(e=this.props.dateFilter.quickChoice?this.props.dateFilter.quickChoice:this.props.dateFilter.from.replace(/-/g,"/")+"-"+this.props.dateFilter.to.replace(/-/g,"/")),e}},{key:"isScreeningChanged",get:function(){var e=this.props,t=e.selSaveInfo,n=e.screeningValues;return!g()(t.screeningValues,n)}}]),t}(i.Component);var J=n(55609),W=n(64396),Z=["loading"],x=W.Z.headerScreening,R=W.Z.screening;Array.prototype.deepcopy=function(){return JSON.parse(JSON.stringify(this))};var I=function(e){function t(t){var n;return(n=e.call(this,t)||this).getValue=function(){var e=n.props,t=e.screeningValues,a=e.defaultConfig,l=e.dateFilter,r=e.curScreeningMap,i=t.deepcopy().filter((function(e){return e.values.length>0})),o=JSON.parse(JSON.stringify(a)),s=r.filter((function(e){return e.data.some((function(e){return e.id===o.defaultChecksName[0]}))}))[0],c=o.defaultChecked.find((function(e){return e.id===o.defaultChecksName[0]}))||{};return c.isSelectAll&&i.forEach((function(e){e.values.some((function(e){return e.id===o.defaultChecksName[0]}))&&e.values.forEach((function(e){e.id===o.defaultChecksName[0]&&(e.values=[])}))})),{filterValue:i,analysisModel:s?[{id:s.id,values:o.defaultChecked.filter((function(e){return e.id===o.defaultChecksName[0]&&(e.values=c.isSelectAll?[]:e.values,!0)}))}]:void 0,dateFilter:l}},n.getTransferValue=function(){var e=n.props,t=e.screeningList,a=e.curScreeningMap,l=e.screeningValues;return{defaultConfig:e.defaultConfig,screeningList:t,curScreeningMap:a,screeningValues:l,dateFilter:e.dateFilter}},n.getFullValue=function(){var e=JSON.parse(JSON.stringify(n.props));return function(e,t,n){e.forEach((function(e){n.forEach((function(t){e.id===t.id&&(e.label=t.label,e.values.forEach((function(e){t.data.forEach((function(t){e.id===t.id&&(e.label=t.label,e.values=e.values.map((function(e){var n={id:e};return t.options.forEach((function(t){e===t.id&&(n.label=t.label)})),n})))}))})))}))}));var a=t.defaultChecked.find((function(e){return e.id===t.defaultChecksName[0]}))||{};return{filterValue:e,analysisModel:JSON.parse(JSON.stringify(e)).filter((function(e){return!!e.values.some((function(e){return e.id===t.defaultChecksName[0]}))&&(e.values=e.values.filter((function(e){return e.id===t.defaultChecksName[0]})),e.values=a.isSelectAll?[{label:"\u5168\u90e8"}]:e.values,!0)}))}}(e.screeningValues,e.defaultConfig,e.curScreeningMap)},n._handelOnFilterReady=function(){var e=n.props.valueConf,t=void 0===e?[]:e;n.timeRef?n.timeRef.fetchDefaultValue().then((function(e){n.props.dateValueChange({value:e}).then((function(){var a=n.getValue(),r={};t.includes("fullInfo")&&(r.fullInfo=n.getFullValue()),setTimeout((function(){return n.props.onReady&&n.props.onReady((0,l.Z)({},a,{dateFilter:e}),r)}),0)}))})):setTimeout((function(){return n._handelOnFilterReady()}),100)},n._handelSearch=function(){var e=n.props.valueConf,t=void 0===e?[]:e,a=n.getValue(),l={};t.includes("fullInfo")&&(l.fullInfo=n.getFullValue()),n.props.onChange&&n.props.onChange(a,l)},n._handelSearchButtonClick=function(){return n.props.freshFastFilter().then((function(){return n._handelSearch()}))},t.transferValue&&t.transferValue.dateFilter&&t.save({dateFilter:t.transferValue.dateFilter}),n.state={},n._event={onFilterReady:n._handelOnFilterReady,onSearchButtonClick:n._handelSearchButtonClick,onSearch:n._handelSearch,getTimeRef:function(e){return n.timeRef=e}},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){},n.componentWillUnmount=function(){this.props.clear()},n.render=function(){return i.createElement(L,(0,l.Z)({},this.state,this._event,this.props))},t}(i.Component);I.propTypes={title:s().oneOfType([s().string,s().node]),onChange:s().func,pageType:s().string,onReady:s().func,valueConf:s().array,expandInfo:s().object,noSavingFilterList:s().bool,transferValue:s().object};const T=(0,J.connect)((function(e){e.loading;var t=(0,a.Z)(e,Z);return(0,l.Z)({},t[x],t[R])}),(function(e){return{freshFastFilter:function(t){return e({type:x+"/freshFastFilter",payload:t})},defaultValueChange:function(t){return e({type:x+"/defaultValueChange",payload:t})},dateValueChange:function(t){return e({type:x+"/dateValueChange",payload:t})},clearAllValues:function(t){return e({type:x+"/clearAllValues",payload:t})},clear:function(){return e({type:x+"/clear"})},save:function(t){return e({type:x+"/save",payload:t})}}}),null,{withRef:!0})(I)}}]);