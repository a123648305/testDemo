"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[9063],{36025:(e,t,n)=>{n.d(t,{Nm:()=>i,o:()=>l,Ku:()=>o,hj:()=>s});var a=n(87462),r=n(35239),i=function(e){var t=(JSON.parse(r.t.get(r.V.filterList))||{list:[]}).list;return Object.keys(e).reduce((function(n,r){var i=e[r],l=Object.prototype.toString.call(i);if("[object Array]"===l){var o=i[0],c=Object.prototype.toString.call(o);if("[object String]"===c){var s,u=t.find((function(e){return e.id===r}));return u?(0,a.Z)({},n,((s={})[u.name]=i.map((function(e){return u.values.find((function(t){return t.id===e})).name})).join("\uff0c"),s)):n}if("[object Object]"===c)return(0,a.Z)({},n,i.reduce((function(e,n){var r,i=t.find((function(e){return e.id===n.id}));return i?(0,a.Z)({},e,((r={})[i.name]=n.values.reduce((function(e,t){var n=i.values.find((function(e){return e.id===t}));return n?[].concat(e,[n.name]):e}),[]).join("\uff0c"),r)):e}),{}))}else if("[object Object]"===l){var d,p=t.find((function(e){return e.id===i.id}));return p?(0,a.Z)({},n,((d={})[p.name]=i.values.reduce((function(e,t){var n=p.values.find((function(e){return e.id===t}));return n?[].concat(e,[n.name]):e}),[]).join("\uff0c"),d)):n}return n}),{})},l=[{title:"\u6b63\u9762",value:"positive"},{title:"\u8d1f\u9762",value:"negative"}],o={positive:"8",negative:"3"},c={"9b3298db87a4405d9c093ce8f1a75d0a":"\u5173\u952e\u5b57"},s=function(e){var t=c[r.t.get(r.V.curProject).id];return"\u578b\u53f7"===e&&t?t:e}},99063:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_e});var a=n(63366),r=n(87462),i=n(94578),l=n(67294),o=n(55609),c=(n(30467),n(55673)),s=(n(58136),n(5789)),u=(n(89626),n(70302)),d=(n(1025),n(65400)),p=n(61409),f=(n(9405),n(89552)),m=(n(76405),n(69843)),h=(n(15086),n(94055)),g=n(30381),v=n.n(g),y=n(43036),E=n(35239),C=n(45697),S=n.n(C),N=n(43144),k=n(97326),_=(n(35797),n(64749)),b=n(18446),F=n.n(b),w=n(92360),I=n(5133),D=function(e){return void 0===e&&(e=""),e.length>16?e.substring(0,15)+"...":e},L=function(e){function t(t){var n;return(n=e.call(this,t)||this).sortList=function(e,t,a){a.stopPropagation(),a.nativeEvent.stopImmediatePropagation();var r=JSON.parse(JSON.stringify(n.state.value)),i=r.splice(e,1)[0];switch(t){case"top":r.unshift(i);break;case"up":r.splice(e-1,0,i);break;case"down":r.splice(e+1,0,i)}n.setState({value:r},(function(e){return n.props.onChange&&n.props.onChange(n.getValue())}))},n.state={value:t.defaultChecks||[],searchWord:""},n}(0,i.Z)(t,e);var n=t.prototype;return n.onSel=function(e,t){var n=this.state.value;(n=JSON.parse(JSON.stringify(n))).map((function(e){return e.id})).includes(t.id)?n.splice(n.findIndex((function(e){return e.id===t.id})),1):n.push(t),this.props.maxSelect&&n.length>this.props.maxSelect?I.Z.warning("\u6700\u591a\u9009\u62e9"+this.props.maxSelect+"\u4e2a\u5bf9\u8c61\uff01"):this.setState({value:n})},n.getValue=function(){return this.state.value},n.render=function(){var e=this,t=this.props,n=t.options,a=t.defaultChecks,r=t.maxSelect,i=t.onCancel,o=t.onChange,c=t.disabledValue,s=this.state,u=s.value,d=s.searchWord,p=a.map((function(e){return e.id})),f=u.map((function(e){return e.id})),m=n.filter((function(e){return!p.includes(e.id)})),h=a.filter((function(e){return!d||-1!==(e.label||"").toLocaleLowerCase().indexOf(d.trim().toLocaleLowerCase())})),g=m.filter((function(e){return!d||-1!==(e.label||"").toLocaleLowerCase().indexOf(d.trim().toLocaleLowerCase())}));return l.createElement("div",{className:"filter-sort-select-trend"},l.createElement("div",{className:"selItem "+(this.props.triangle?"triangle":""),onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},l.createElement("div",{className:"wrap"},l.createElement("div",{className:"title_name"},"\u6dfb\u52a0\u5c55\u793a",l.createElement("span",null,"\uff08\u6700\u591a"+r+"\u4e2a\uff0c\u5df2\u6dfb\u52a0"+u.length+"\u4e2a\uff09")),l.createElement("div",null,l.createElement(w.Input,{value:d,placeholder:"\u8bf7\u8f93\u5165\u5173\u952e\u8bcd",className:"search",size:"small",icon:d?"close":"search",onChange:function(t){return e.setState({searchWord:t})},onIconClick:function(){return e.setState({searchWord:""})}})),l.createElement("ul",null,h.map((function(t,n){return l.createElement("li",{className:(f.includes(t.id)?"sel":"")+(t.disable?" disable":""),key:n,onClick:function(n){!c.includes(t.id)&&e.onSel(n,t)}},l.createElement(w.Checkbox,{className:"check-all",checked:f.includes(t.id),disabled:c.includes(t.id)||!f.includes(t.id)&&u.length>=r,onChange:function(n){return c.includes(t.id)?"":e.onSel(n,t)}},l.createElement("span",null,D(t.label))))})),g.slice(0,100-h.length).map((function(t,n){return l.createElement("li",{className:(f.includes(t.id)?"sel":"")+(t.disable?" disable":""),key:n,onClick:function(n){return e.onSel(n,t)}},l.createElement(w.Checkbox,{className:"check-all",checked:f.includes(t.id),onChange:function(n){return e.onSel(n,t)},disabled:!f.includes(t.id)&&u.length>=r},l.createElement("span",{className:"dark"},D(t.label))))})),h.length+g.length>100?l.createElement("li",{style:{color:"#d96969"}},"\u6570\u503c\u5c55\u793a\u4e0d\u8d85\u8fc7100\u6761\uff0c\u67e5\u770b\u66f4\u591a\u8bf7\u641c\u7d22"):null,0===h.length&&0===g.length&&l.createElement("div",{className:"noData"},"\u6ca1\u6709\u76f8\u5173\u9009\u9879"))),l.createElement("div",{className:"line"}),l.createElement("div",{className:"control"},l.createElement("div",null,l.createElement(w.Button,{type:"",onClick:i},"\u53d6\u6d88"),l.createElement(w.Button,{type:"primary",onClick:function(){return o(u)}},"\u786e\u5b9a")))))},t}(l.Component);L.propTypes={options:S().array,value:S().array,onChange:S().func,show:S().bool,onCancel:S().func,maxSelect:S().number};var T={COMMENT:"OPINION_INDEX",SELF:"OPINION_INDEX_SELF",SERVICE:"OPINION_INDEX"},O=n(36025),V=n(51474),A=n(49101);_.default.Option;const Z=function(e){function t(t){var n;return(n=e.call(this,t)||this).defaultIsSelectAllChange=function(){var e=JSON.parse(JSON.stringify(n.props)).defaultConfig,t=(0,k.Z)(n).curFast;e.defaultChecked.forEach((function(e){e.id===t.id&&(e.isSelectAll=!e.isSelectAll)})),n.props.defaultValueChange({value:{defaultChecked:e.defaultChecked}}).then((function(){n.props.onSearch()}))},n.defaultChecksTypeChange=function(e){n.props.changeFilter({pageType:T[e],queryType:e})},n.defaultChecksNameChange=function(e){n.setState({defaultValue:e}),n.props.defaultValueChange({value:{defaultChecksName:[e]}}).then((function(){n.props.onSearch()}))},n.defaultCheckedChange=function(e,t){var a=JSON.parse(JSON.stringify(n.props)).defaultConfig,r=a.defaultNumberChecked,i=(0,k.Z)(n),l=i.curFast,o=i.curFastShowList,c=JSON.parse(JSON.stringify(l.values));if("add"===e)if(1===r)c=[t];else{var s=[];c.push(t),o.forEach((function(e){return c.forEach((function(t){return t===e.id&&s.push(t)}))})),c=s}else if("del"===e){if(1===c.length)return void I.Z.warning("\u81f3\u5c11\u4fdd\u7559\u4e00\u4e2a\u9009\u9879");c.splice(c.indexOf(t),1)}a.defaultChecked.forEach((function(e){e.id===l.id&&(e.values=c)})),n.props.fetchTopicCheck({brandId:t,queryType:n.state.currentSourceType}),n.props.defaultValueChange({value:{defaultChecked:a.defaultChecked}}).then((function(){n.props.onSearch()}))},n.defaultChecksChange=function(e,t){var a=JSON.parse(JSON.stringify(n.curFastShowList)),r=JSON.parse(JSON.stringify(n.props)).defaultConfig;"add"===e?a.push(t):"del"===e?a.splice(a.findIndex((function(e){return e.id===t.id})),1):"replace"===e&&(a=t),r.defaultChecks.forEach((function(e){e.id===n.curFast.id&&(e.values=a)})),n.props.defaultValueChange({value:{defaultChecks:r.defaultChecks}})},n.clickListener=function(){n.setState({showSelector:!1})},n.state={showSelector:!1,maxWidth:500,defaultValue:"",currentSourceType:"COMMENT"},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;this.curFast&&Array.isArray(this.curFast.values)&&this.curFast.values.length&&this.props.fetchTopicCheck({brandId:this.curFast.values[0],queryType:this.state.currentSourceType}),window.addEventListener("click",this.clickListener),new V.default(document.querySelector(".fast_wrap"),{sort:!0,animation:150,draggable:".fast_block",handel:".handel",onEnd:function(t){var n=t.oldIndex,a=t.newIndex,r=JSON.parse(JSON.stringify(e.props)).defaultConfig,i=e.curFast,l=e.curFastShowList,o=JSON.parse(JSON.stringify(l)),c=o.splice(n,1)[0];o.splice(a,0,c),r.defaultChecks.forEach((function(e){e.id===i.id&&(e.values=o)}));var s={defaultChecks:r.defaultChecks};F()(i.values,o.filter((function(e){return i.values.includes(e.id)})).map((function(e){return e.id})))||(r.defaultChecked.forEach((function(e){e.id===i.id&&(e.values=[],o.forEach((function(t){i.values.forEach((function(n){t.id===n&&e.values.push(n)}))})))})),s.defaultChecked=r.defaultChecked),e.props.defaultValueChange({value:s}).then((function(){return s.defaultChecked&&e.props.onSearch()}))}})},n.componentDidUpdate=function(e){var t=this.props.defaultConfig;F()(e.defaultConfig,t)||this.curFast&&Array.isArray(this.curFast.values)&&this.curFast.values.length&&this.props.fetchTopicCheck({brandId:this.curFast.values[0],queryType:this.state.currentSourceType})},n.componentWillUnmount=function(){window.removeEventListener("click",this.clickListener)},n.render=function(){var e,t=this,n=this.props,a=n.defaultConfig,r=n.screeningList,i=n.queryTypeList,o=this.state,c=o.showSelector,s=o.defaultValue,u=o.currentSourceType,d=this.curFast,p=this.curFastShowList,f=d.isSelectAll,m=a.defaultChecksName,h=void 0===m?[]:m,g=a.defaultNumberChecked,v=a.defaultNumberConfig,y=(a.defaultChecks||[]).map((function(e){return{value:e.id,label:(0,O.hj)(e.label)}})),E=r.map((function(e){return e.data})).flat(1).filter((function(e){return e.id===h[0]})).length?r.map((function(e){return e.data})).flat(1).filter((function(e){return e.id===h[0]}))[0]:{};return l.createElement("div",{className:"opnion_fast_filter"},l.createElement("div",{className:"name"},l.createElement("span",{className:"filter_select"},l.createElement(_.default,{value:null!=(e=i[0])&&e.value?u:"\u7535\u5546\u8bc4\u8bba",bordered:!1,onChange:function(e){t.defaultChecksTypeChange(e),t.setState({currentSourceType:e})},options:i}),l.createElement(_.default,{value:s||h[0],bordered:!1,onChange:function(e){return t.defaultChecksNameChange(e)},options:y}))),l.createElement("div",{className:"fast_wrap"},f&&l.createElement("div",{className:"cover",onClick:this.defaultIsSelectAllChange}),p.map((function(e){return l.createElement("span",{key:e.id,className:"fast_block "+(d.values.includes(e.id)?"select":"")+" "+(d.values.length>=g&&1!==g?"disabled":"")+" "+(f?"disabled_all":""),onClick:function(){return f?"":(d.values.length<g||d.values.includes(e.id)||1===g)&&t.defaultCheckedChange(d.values.includes(e.id)?"del":"add",e.id)}},l.createElement("span",{title:e.label},e.label),l.createElement("i",{className:"icon-cem_cancel",onClick:function(n){n.stopPropagation(),t.defaultChecksChange("del",e)}}))}))),l.createElement("div",{className:"add",onClick:function(e){e.stopPropagation(),t.setState({showSelector:!c})}},l.createElement(A.Z,null),c&&l.createElement(L,{options:E.options,defaultChecks:p,onChange:function(e){t.setState({showSelector:!1}),t.defaultChecksChange("replace",e)},disabledValue:d.values,maxSelect:v,onCancel:function(){return t.setState({showSelector:!1})}})))},(0,N.Z)(t,[{key:"curFast",get:function(){var e=this.props.defaultConfig;return e.defaultChecked.find((function(t){return t.id===e.defaultChecksName[0]}))||{}}},{key:"curFastShowList",get:function(){var e=this.props.defaultConfig;return(e.defaultChecks.find((function(t){return t.id===e.defaultChecksName[0]}))||{}).values||[]}}]),t}(l.Component);const x=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnHide=function(){var e=n.props,t=e.showKind,a=e.changeShow;if(t){if("screening"===t)return;a(null)}},n.state={},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){window.addEventListener("click",this._handleOnHide)},n.componentWillUnmount=function(){window.removeEventListener("click",this._handleOnHide)},n.render=function(){var e=this,t=this.props,n=t.screeningList,a=t.children,r=t.defaultConfig,i=t.defaultValueChange,o=t.queryTypeList,c=t.changeFilter,s=t.onSearch,u=t.showKind,d=t.fetchTopicCheck;return l.createElement("div",{className:"opnion_header_Filter",style:{height:a?"100%":""}},l.createElement("div",{className:"opnion_header_Filter_bar"},r&&l.createElement(Z,{ref:function(t){return e.fastRef=t},defaultConfig:r,screeningList:n,queryTypeList:o,defaultValueChange:i,changeFilter:c,onSearch:s,disabled:"screening"===u,fetchTopicCheck:d})))},t}(l.Component);var M=n(64396),P=["loading"],Y=M.Z.IDBHeaderScreening.headerScreening,J=M.Z.IDBHeaderScreening.screening,R=M.Z.IDBHeaderScreening.savedScreening,j=M.Z.IDBHeaderScreening.timeScreening,z=M.Z.opinion.opinionScreening,B=M.Z.opinion.everyOpinion;Array.prototype.deepcopy=function(){return JSON.parse(JSON.stringify(this))};var U=function(e){function t(t){var n,a;return(n=e.call(this,t)||this).getValue=function(){var e=n.props,t=e.screeningValues,a=e.defaultConfig,i=e.dateFilter,l=e.content,o=e.advancedFilter,c=e.curScreeningMap,s=t.deepcopy().filter((function(e){return e.values.length>0})),u=JSON.parse(JSON.stringify(a)),d=c.filter((function(e){return e.data.some((function(e){return e.id===u.defaultChecksName[0]}))}))[0],p=u.defaultChecked&&u.defaultChecked.find((function(e){return e.id===u.defaultChecksName[0]}))||{};return p.isSelectAll&&s.forEach((function(e){e.values.some((function(e){return e.id===u.defaultChecksName[0]}))&&e.values.forEach((function(e){e.id===u.defaultChecksName[0]&&(e.values=[])}))})),JSON.parse(JSON.stringify({dateFilter:i,filterModel:(0,r.Z)({content:l&&l[0]&&l[0].contain&&l[0].contain.length?l:void 0},o),headerFilterParamsNew:s,analysisModel:d?[{id:d.id,values:u.defaultChecked.filter((function(e){return e.id===u.defaultChecksName[0]&&(e.values=p.isSelectAll?[]:e.values,!0)}))}]:void 0}))},n.getTransferValue=function(){var e=n.props,t=e.screeningList,a=e.curScreeningMap,r=e.screeningValues;return{defaultConfig:e.defaultConfig,screeningList:t,curScreeningMap:a,screeningValues:r,dateFilter:e.dateFilter}},n.getFullValue=function(){var e={screeningValues:n.props.screeningValues,defaultConfig:n.props.defaultConfig,curScreeningMap:n.props.curScreeningMap},t=JSON.parse(JSON.stringify(e));return function(e,t,n){var a=JSON.parse(JSON.stringify(e));a.forEach((function(e){n.forEach((function(t){e.id===t.id&&(e.label=t.label,e.values.forEach((function(e){t.data.forEach((function(t){e.id===t.id&&(e.label=t.label,e.values=e.values.map((function(e){var n={id:e};return t.options.forEach((function(t){e===t.id&&(n.label=t.label)})),n})))}))})))}))}));var r=t.defaultChecked.find((function(e){return e.id===t.defaultChecksName[0]}))||{};return r.isSelectAll&&a.forEach((function(e){e.values.some((function(e){return e.id===t.defaultChecksName[0]}))&&e.values.forEach((function(e){e.id===t.defaultChecksName[0]&&(e.values=[{label:"\u5168\u90e8"}])}))})),{filterValue:a,analysisModel:JSON.parse(JSON.stringify(a)).filter((function(e){return!!e.values.some((function(e){return e.id===t.defaultChecksName[0]}))&&(e.values=e.values.filter((function(e){return e.id===t.defaultChecksName[0]})),e.values=r.isSelectAll?[{label:"\u5168\u90e8"}]:e.values,!0)}))}}(t.screeningValues,t.defaultConfig,t.curScreeningMap)},n._handelSearch=function(){var e=n.props.valueConf,t=void 0===e?[]:e,a=n.getValue(),r={selectValue:n.props.selectValue,comparisonItems:n.props.comparisonItemsSave};t.includes("fullInfo")&&(r.fullInfo=n.getFullValue()),n.props.onChange&&n.props.onChange(a,r)},n._changeFilter=function(e,t){n.props.init({type:e?e.pageType:n.props.selectValue||n.props.type,screening:{noSavingFilterList:n.props.noSavingFilterList},hasHour:n.props.hasHour,dateValue:n.props.dateValue,filterId:t?t.id:n.props.filterId}).then((function(){var t=n.props.valueConf,a=void 0===t?[]:t,i=n.getValue(),l=(0,r.Z)({selectValue:e.pageType||n.props.selectValue,comparisonItems:n.props.comparisonItemsSave},e||{});a.includes("fullInfo")&&(l.fullInfo=n.getFullValue()),n.props.onChange&&n.props.onChange(i,l)}))},n._handelSearchButtonClick=function(){return n.props.freshFastFilter().then((function(){return n._handelSearch()}))},t.transferValue&&t.transferValue.dateFilter&&t.save({dateFilter:t.transferValue.dateFilter}),n.state={},n._event={onFilterReady:n._handelOnFilterReady,onSearchButtonClick:n._handelSearchButtonClick,onSearch:n._handelSearch,changeFilter:n._changeFilter,getSaveRef:function(e){return n.saveRef=e}},t.selectValue&&t.comparisonItems&&t.findTouchSpotByAccountId(),t.screenValue&&Array.isArray(t.screenValue)&&(a=t.screenValue),t.init({type:t.pageType,hasHour:t.hasHour,screening:{value:a,noSavingFilterList:t.noSavingFilterList},dateValue:t.dateValue,contentValue:t.contentValue,filterId:t.filterId}).then((function(){var e=n.props.valueConf,a=void 0===e?[]:e,r=n.getValue(),i={selectValue:n.props.selectValue,comparisonItems:n.props.comparisonItemsSave};a.includes("fullInfo")&&(i.fullInfo=n.getFullValue()),t.onReady&&t.onReady(r,i)})),n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){},n.componentWillUnmount=function(){this.props.clear()},n.render=function(){return l.createElement(x,(0,r.Z)({},this.state,this._event,this.props,{saveRef:this.saveRef}))},t}(l.Component);U.propTypes={title:S().oneOfType([S().string,S().node]),onChange:S().func,pageType:S().string,onReady:S().func,valueConf:S().array,expandInfo:S().object,noSavingFilterList:S().bool,transferValue:S().object,advanceAuthority:S().bool,sourceSearch:S().bool,contentSearch:S().bool,hasHour:S().bool,rightContent:S().node,filterId:S().string,filterDateFilter:S().object,recordId:S().string,selectValue:S().string,touchData:S().arrayOf(S().string),findTouchSpotByAccountId:S().func};const H=(0,o.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,P);return(0,r.Z)({},n[Y],n[J],{queryTypeList:n[B].queryTypeList,savedScreening:(0,r.Z)({},n[R]),dateFilter:n[j].dateFilter,fetchingScreeningMap:t.effects[Y+"/init"]||!1})}),(function(e){return{freshFastFilter:function(t){return e({type:Y+"/freshFastFilter",payload:t})},defaultValueChange:function(t){return e({type:Y+"/defaultValueChange",payload:t})},dateValueChange:function(t){return e({type:Y+"/dateValueChange",payload:t})},clearAllValues:function(t){return e({type:Y+"/clearAllValues",payload:t})},clear:function(){return e({type:Y+"/clear"})},save:function(t){return e({type:Y+"/save",payload:t})},changeShow:function(t){return e({type:Y+"/changeShow",payload:t})},changeAdvancedShow:function(t){return e({type:Y+"/changeAdvancedShow",payload:t})},updateScreeningValues:function(t){return e({type:J+"/updateScreeningValues",payload:t})},contentChange:function(t){return e({type:Y+"/contentChange",payload:t})},savedFilterChange:function(t){return e({type:Y+"/savedFilterChange",payload:t})},init:function(t){return e({type:Y+"/init",payload:t})},fetchTopicCheck:function(t){return e({type:z+"/fetchTopicCheck",payload:t})}}}),null,{withRef:!0})(U);var q=n(50976);const W=function(e){var t=e.loading,n=e.chartData,a=e.enlarge,r=e.date,i=l.useState(void 0),o=i[0],c=i[1];return l.useEffect((function(){if(o&&!t&&n&&n.length>0){var e=function(e,t,n){return{title:{show:t,text:"\u4e00\u5468\u6570\u636e\u8d70\u52bf",textStyle:{color:"#262626",fontSize:"12px",lineHeight:17},padding:-8},backgroundColor:t?"#fff":"#f1f3f4",tooltip:{trigger:"axis",formatter:'<span style="margin-right: 38px;color: #262626;font-size: 12px;">{b}</span><span style="font-weight: 600;font-size: 12px;color: #262626;">{c}</span>'},grid:{show:!1,top:t?40:0,left:t?35:0,right:t?35:0,bottom:t?20:0},xAxis:{type:"category",boundaryGap:!1,data:n,axisLine:{show:t},axisLabel:{show:t,interval:n&&n.length>2?n.length-2:0,color:"#626262"},axisTick:{show:!1},splitLine:{show:!1}},yAxis:{type:"value",axisLine:{show:!1},axisLabel:{show:t,color:"#626262"},axisTick:{show:!1},splitLine:{show:t,lineStyle:{type:"dashed",color:"#E5E5E5"}},splitNumber:4,minInterval:1},series:[{type:"line",symbol:"none",smooth:!0,lineStyle:{color:t?"#7262FD":"#5B8FF9",width:1.5},data:e.length>0?e:[]}]}}(n,a,r);o.clear(),o.setOption(e)}}),[o,t,n]),l.createElement(q.Z,{theme:"yunting_multi_color",style:a?{width:"324px",height:"224px"}:{width:"54px",height:"24px"},showLoading:t,loadingOption:{text:"",color:"#1574B3"},option:{},onChartReady:function(e){return c(e)}})};var X=function(e){var t=parseInt(v()().format("E")),n=1===t?e+1:e,a=v()().subtract(t+7*n-1,"days").format("YYYY-MM-DD"),r=v()().subtract(t+7*(n-1),"days").format("YYYY-MM-DD");return n||(r=v()().subtract(1,"days").format("YYYY-MM-DD")),[a,r]},G=function(){return[X(0),X(1),X(2),X(3),X(4)].reverse()},K=["loading"],$=M.Z.opinion.everyOpinion,Q=M.Z.opinion.opinionScreening,ee=function(e){function t(t){var n;return(n=e.call(this,t)||this).onFilterReady=function(e,t){var a,i=((null!=e&&null!=(a=e.headerFilterParamsNew)&&a.length?e.headerFilterParamsNew:null==e?void 0:e.analysisModel)||[]).map((function(e){var t;delete e.isSelectAll;var n=null==(t=e.values)?void 0:t.map((function(e){return delete e.isSelectAll,delete e.label,e}));return(0,r.Z)({},e,{values:n})}));n.props.fetchParams({projectId:E.t.get(E.V.curProject).id,headerFilterParamsNew:i,dateFilter:{from:G()[0][0],to:G()[0][1]}}),n.props.fetchOpinionTouchSpot()},n.onFilterChange=function(e,t){var a,i=((null!=e&&null!=(a=e.headerFilterParamsNew)&&a.length?e.headerFilterParamsNew:null==e?void 0:e.analysisModel)||[]).map((function(e){var t;delete e.isSelectAll;var n=null==(t=e.values)?void 0:t.map((function(e){return delete e.isSelectAll,delete e.label,e}));return(0,r.Z)({},e,{values:n})}));n.props.fetchParams((0,r.Z)({projectId:E.t.get(E.V.curProject).id,headerFilterParamsNew:i},t.pageType?t:{}))},n.customPage=function(e,t,n){if("page"===t){var a=G()[e-1].map((function(e){return v()(e,"YYYY-MM-DD").format("MM/DD")}));return l.createElement("a",{className:"nofollow"},a.join("~"))}return n},n.onPageChange=function(e){n.props.save({dateFilter:{from:G()[e-1][0],to:G()[e-1][1]}}),n.props.opinionFind()},n.state={},n.event={},n}return(0,i.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.loading,n=e.opinionData,a=e.pageType,r=e.check;return l.createElement(f.default,{spinning:t},l.createElement("div",{className:"everyday_table"},l.createElement("div",{className:"everyday_table_header"},l.createElement("span",{className:"title"},"\u6bcf\u5468\u5178\u578b\u610f\u89c1"),l.createElement("span",{className:"tip"},l.createElement(y.Z,{overlay:l.createElement("span",null,"\u53ea\u5c55\u793a\u6700\u8fd15\u5468\u7684\u6570\u636e\u3002",l.createElement("br",null),"\u56e0\u4e3a\u9879\u76ee\u4e2d\u7684\u6570\u636e\u4f1a\u6709\u53d8\u5316\uff0c\u4f8b\u5982\u6dfb\u52a0\u4e00\u6761\u65b0\u94fe\u63a5\uff0c\u5386\u53f2\u7684\u8bc4\u8bba\u6570\u636e\u6709\u6240\u589e\u52a0\uff0c\u5bf9\u5e94\u7684\u6bcf\u5468\u5178\u578b\u610f\u89c1\u7ed3\u679c\u8ddf\u524d\u51e0\u5929\u8ba1\u7b97\u7684\u7ed3\u679c\u4e0d\u4e00\u81f4\uff0c\u56e0\u6b64\u7cfb\u7edf\u6bcf\u5929\u66f4\u65b0\u6700\u8fd15\u5468\u7684\u6570\u636e\uff0c\u786e\u4fdd\u5206\u6790\u6700\u65b0\u6570\u636e\u3002"),placement:"top",mouseEnterDelay:.5},l.createElement("i",{className:"icon-cem_file1",style:{marginLeft:4,fontSize:14,color:"#979797",verticalAlign:"unset"}}))),l.createElement(H,{pageType:a,onReady:this.onFilterReady,onChange:this.onFilterChange,advanceAuthority:!1,sourceSearch:!0,selectValue:"OPINION_INDEX",valueConf:["fullInfo"],hasHour:!1})),n&&n.length?l.createElement("div",{className:"list"},n.map((function(e,t){var n=t<10?"#729FF9":"#8c8c8c",a=e.trend&&e.trend.opinionInfoMsg;return l.createElement("div",{className:"item",key:e.id},l.createElement("span",{className:"index",style:{background:n}},t+1),l.createElement("span",{className:"name"},e.id),l.createElement(h.default,{overlayClassName:t>4&&t<10||t>14?"every_table_tip_bottom":"every_table_tip",getPopupContainer:function(){return document.querySelector(".list")},title:a?l.createElement(W,{loading:!1,chartData:a.map((function(e){return e.name})),enlarge:!0,date:a.map((function(e){return v()(e.id,"YYYY-MM-DD").format("YYYY/MM/DD")}))}):l.createElement("div",{className:"empty-block",style:{height:"216px"}},"\u6682\u65e0\u6570\u636e"),placement:t>4&&t<10||t>14?"leftBottom":"leftTop",mouseEnterDelay:.5},l.createElement("span",{className:"total"},a?l.createElement(W,{loading:!1,chartData:a&&a.map((function(e){return e.name})),enlarge:!1}):l.createElement("i",{className:"icon-cem_line",style:{color:"rgb(191, 191, 191)",fontSize:20}}))))}))):r?l.createElement("div",{className:"empty-block"},"\u6682\u65e0\u6570\u636e"):l.createElement("div",{className:"not-generated-block"},"\u6700\u8fd15\u5468\u7684\u5178\u578b\u610f\u89c1\u7ed3\u679c\u5c06\u5728\u660e\u59298\u70b9\u524d\u751f\u6210"),l.createElement("div",null,l.createElement("span",{className:"result_update_time"},"\u7ed3\u679c\u66f4\u65b0\u65f6\u95f4\uff1a\u6bcf\u59291~8\u70b9\u3002"),l.createElement(m.default,{size:"small",total:5,itemRender:this.customPage,pageSize:1,onChange:this.onPageChange}))))},t}(l.PureComponent);const te=(0,o.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,K);return(0,r.Z)({},n[$],n[Q],{loading:t.effects["${namespace}/opinionFind"]||!1})}),(function(e){return{opinionFind:function(t){return e({type:$+"/opinionFind",payload:t})},fetchOpinionTouchSpot:function(t){return e({type:$+"/fetchOpinionTouchSpot",payload:t})},save:function(t){return e({type:$+"/save",payload:t})},clean:function(t){return e({type:$+"/clean",payload:t})},fetchParams:function(t){return e({type:$+"/fetchParams",payload:t})}}}))(ee);n(14574);var ne=n(56590),ae=(n(75314),n(11187)),re=(n(23461),n(53740)),ie=(n(89858),n(51024)),le=n(39432),oe=["loading"],ce=M.Z.opinion.savaFilter,se=M.Z.opinion.savaResult,ue=ie.default.Search,de=re.Z.Paragraph,pe=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleDeleteClick=function(e){(0,n.props.save)({modalShow:!0,target:e})},n.handleUpClick=function(e){},n.handleEditClick=function(e,t,a){""!==e?e!==a&&(0,n.props.opinionRename)({newName:e,id:t}):ae.default.error("\u8f93\u5165\u9519\u8bef\uff0c\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a")},n.handleSearch=function(e){n.props.save({name:e}),n.props.opinionList({name:e})},n.state={value:"",isJump:!1},n._event={},n.props.save({projectId:E.t.get(E.V.curProject).id}),n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.opinionList()},n.componentWillUnmount=function(){this.props.clean()},n.render=function(){var e=this,t=this.props,n=t.filterData,a=t.save,r=t.modalShow,i=t.opinionDelete,o=t.target,c=t.loading,s=t.pageNumber,u=this.state,d=u.value,m=u.isJump;return l.createElement("div",{className:"opinion_filter_list left_list"},l.createElement(f.default,{spinning:c},l.createElement("div",{className:"opinion_filter_list_header"},l.createElement("span",{className:"opinion_filter_list_header_title"},"\u8ba1\u7b97\u4efb\u52a1"),l.createElement("span",{className:"tip"},l.createElement(y.Z,{overlay:"\u6700\u591a\u4fdd\u5b5820\u4e2a\u8ba1\u7b97\u4efb\u52a1\uff0c\u8d85\u8fc720\u4e2a\u65f6\u9ed8\u8ba4\u5220\u9664\u4e4b\u524d\u7684\u4efb\u52a1\u3002\u5217\u8868\u4e2d\u53ea\u5c55\u793a\u79bb\u7ebf\u67e5\u8be2\u7684\u4efb\u52a1\uff0c\u4e0d\u5c55\u793a\u7acb\u5373\u67e5\u8be2\u7684\u4efb\u52a1\u3002",placement:"top",mouseEnterDelay:.5,getPopupContainer:function(){return document.querySelector(".opinion_filter_list.left_list")}},l.createElement("i",{className:"icon-cem_file1",style:{marginLeft:4,fontSize:14,color:"#979797",verticalAlign:"unset"}}))),l.createElement("span",{className:"search"},l.createElement(ue,{placeholder:"\u8bf7\u8f93\u5165",onSearch:function(t){return e.handleSearch(t)},onChange:function(t){e.setState({value:t.target.value})},size:"small",suffix:l.createElement("span",{onClick:function(){return e.handleSearch(d)}},l.createElement("i",{className:"icon-cem_small-search",style:{color:"#8c8c8c"}})),allowClear:!0}))),n&&n.list&&n.list.length>0?l.createElement(ne.default,{className:"filter_tab",itemLayout:"vertical",size:"small",pagination:{onChange:function(t){var n=e.props,a=n.save,r=n.opinionList;a({pageNumber:t}),r()},pageSize:10,size:"small",total:n&&n.total,hideOnSinglePage:!0,showSizeChanger:!1,current:s},dataSource:n&&n.list,renderItem:function(t){return l.createElement(ne.default.Item,{key:t.id},l.createElement(h.default,{placement:"top",mouseEnterDelay:.5,title:"REPEATEDLY"===t.calculationType?l.createElement("div",null,t.name,l.createElement("br",null),"\u4e0b\u4e00\u6b21\u7ed3\u679c\u751f\u6210\u65f6\u95f4\uff1a",t.lastStartTime?v()(t.lastStartTime,"YYYY-MM-DD").add(t.calculationFrequency,"days").format("YYYY/MM/DD"):v()().add(1,"days").format("YYYY/MM/DD")):null,getPopupContainer:function(){return document.querySelector(".opinion_filter_list.left_list")}},l.createElement("span",{className:"opinion_filter_list_many"},"REPEATEDLY"===t.calculationType?"\u591a":"\u5355"),l.createElement("span",{className:"opinion_filter_list_content"},l.createElement(p.rU,{to:{pathname:"/explore/opinion/screen",query:{id:t.id}},onClick:function(e){m&&e.preventDefault()}},l.createElement(de,{editable:{autoSize:{maxRows:1,minRows:1},maxLength:40,tooltip:!1,icon:l.createElement("i",{className:"icon-bianji",onClick:function(e){return e.preventDefault()}}),onChange:function(n){e.setState({isJump:!1}),e.handleEditClick(n.trim(),t.id,t.name)},onStart:function(){return e.setState({isJump:!0})},onCancel:function(){return e.setState({isJump:!1})}}},t.name))),l.createElement("span",{className:"opinion_filter_list_date"},(0,le.qS)(t.updateTime.split("T")[0])),l.createElement("span",{className:"opinion_filter_list_delete",onClick:function(){return e.handleDeleteClick(t)}},l.createElement("i",{className:"icon-cem_trash"})),l.createElement("span",{className:"opinion_filter_list_edit",onClick:function(){return e.handleDeleteClick(t)}},l.createElement("i",{className:"icon-bianji"}))))}}):l.createElement("div",{className:"empty-block"},"\u65e0\u8ba1\u7b97\u4efb\u52a1")),l.createElement(w.Dialog,{className:"data_url_delete_dialog",title:"\u5220\u9664",size:"tiny",visible:r,onCancel:function(){return a({modalShow:!1})},lockScroll:!1},l.createElement(w.Dialog.Body,null,l.createElement("div",{className:"dialog-content"},o&&"\u662f\u5426\u5220\u9664\u201c"+o.name+"\u201d"+("REPEATEDLY"===o.calculationType?"\uff0c\u8be5\u4efb\u52a1\u4e3a\u591a\u6b21\u4efb\u52a1\uff0c\u5220\u9664\u540e\u4e0d\u518d\u751f\u6210\u5bf9\u5e94\u7684\u7ed3\u679c\uff0c\u4f46\u4e4b\u524d\u5df2\u751f\u6210\u7684\u7ed3\u679c\u8fd8\u4f1a\u4fdd\u5b58\u5728\u5217\u8868\u4e2d":"\u8ba1\u7b97\u4efb\u52a1"))),l.createElement(w.Dialog.Footer,{className:"dialog-footer"},l.createElement(w.Button,{onClick:function(){return a({modalShow:!1})}},"\u53d6\u6d88"),l.createElement(w.Button,{type:"primary",onClick:function(){i().then((function(){return e.props.taskList()}))}},"\u786e\u5b9a"))))},t}(l.Component);const fe=(0,o.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,oe);return(0,r.Z)({},n[ce],{loading:t.effects[ce+"/opinionList"]||!1})}),(function(e){return{save:function(t){return e({type:ce+"/save",payload:t})},clean:function(){return e({type:ce+"/clean"})},opinionList:function(t){return e({type:ce+"/opinionList",payload:t})},opinionDelete:function(t){return e({type:ce+"/opinionDelete",payload:t})},opinionRename:function(t){return e({type:ce+"/opinionRename",payload:t})},taskList:function(t){return e({type:se+"/taskList",payload:t})}}}))(pe);var me=["loading"],he=M.Z.opinion.savaResult,ge=ie.default.Search,ve=re.Z.Paragraph,ye=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleDeleteClick=function(e){(0,n.props.save)({modalShow:!0,target:e})},n.handleUpClick=function(e){},n.handleEditClick=function(e,t,a){""!==e?a!==e&&(0,n.props.taskRename)({value:e,id:t}):ae.default.error("\u8f93\u5165\u9519\u8bef\uff0c\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a")},n.handleSearch=function(e){n.props.save({name:e}),n.props.taskList({name:e})},n.handleCalculating=function(e){var t=n.state.nowTime;return t.diff(v()(e),"minutes")>0?l.createElement("span",{style:{color:"#F08A8A"}},"\u8d85\u65f6",t.diff(v()(e),"minutes"),"\u5206\u949f"):0===t.diff(v()(e),"minutes")?t.diff(v()(e),"seconds")>0?l.createElement("span",{style:{color:"#F08A8A"}},"\u8d85\u65f61\u5206\u949f"):"\u9884\u4f30"+v()(e).diff(t,"seconds")+"\u79d2\u540e\u751f\u6210":t.diff(v()(e),"minutes")<0?"\u9884\u4f30"+v()(e).diff(t,"minutes")+"\u5206\u949f\u540e\u751f\u6210":void 0},n.handleTime=function(e,t,a,r){switch(e){case"ENABLE":return"\u5f85\u751f\u6210";case"FAILURE":case"EXPIRED":return l.createElement("span",{style:{color:"#F08A8A"}},"\u751f\u6210\u5931\u8d25");case"DISABLE":return r>5e5?"\u65e0\u6cd5\u8ba1\u7b97\u7ed3\u679c\uff0c\u89c2\u70b9\u6570\u5df2\u8d85\u4e0a\u9650":l.createElement("span",{style:{color:"#F08A8A"}},"\u751f\u6210\u5931\u8d25");case"CALCULATING":case"CALCULATING_NLP":return n.handleCalculating(t);case"FINISH":return(0,le.qS)(a.split("T")[0]);case"TO_BE_GENERATED":return v()(t).format("YYYY/MM/DD HH:mm")+" \u540e\u751f\u6210";default:return}},n.handleUpdateClick=function(e){n.props.taskUpdate({id:e})},n._handleOnWsMessage=function(e){var t=e.data,a=n.state.taskIds;if(t.type&&"ws"===t.type){var r=t.payload,i=r.type,l=r.result;"OPINION_TASK_RESULT"===i&&(a.includes(l.taskId)||(a.push(l.taskId),n.setState({taskIds:a})))}},n.state={value:"",isJump:!1,nowTime:v()(),taskIds:[]},n._event={},n.props.save({projectId:E.t.get(E.V.curProject).id}),n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;setInterval((function(){return e.setState({nowTime:v()()})}),1e3),this.props.taskList(),window.addEventListener("message",this._handleOnWsMessage)},n.componentWillUnmount=function(){window.removeEventListener("message",this._handleOnWsMessage),this.props.clean()},n.render=function(){var e=this,t=this.props,n=t.filterData,a=t.save,r=t.modalShow,i=t.taskDelete,o=t.target,c=t.loading,s=t.pageNumber,u=this.state,d=u.value,m=u.isJump,h=u.taskIds;return l.createElement("div",{className:"opinion_filter_list right_list"},l.createElement(f.default,{spinning:c},l.createElement("div",{className:"opinion_filter_list_header"},l.createElement("span",{className:"opinion_filter_list_header_title"},"\u4fdd\u5b58\u7684\u5178\u578b\u610f\u89c1\u7ed3\u679c"),l.createElement("span",{className:"tip"},l.createElement(y.Z,{overlay:"\u6700\u591a\u4fdd\u5b58100\u4e2a\u5178\u578b\u610f\u89c1\u7ed3\u679c\uff0c\u8d85\u8fc7100\u4e2a\u65f6\u9ed8\u8ba4\u5220\u9664\u4e4b\u524d\u4fdd\u5b58\u7684\u7ed3\u679c\u3002\u4e0d\u7ba1\u662f\u7acb\u5373\u67e5\u8be2\u8fd8\u662f\u79bb\u7ebf\u67e5\u8be2\u7684\u4efb\u52a1\u7ed3\u679c\u90fd\u4f1a\u5728\u5217\u8868\u4e2d\u5c55\u793a\u3002",placement:"top",mouseEnterDelay:.5,getPopupContainer:function(){return document.querySelector(".opinion_filter_list.right_list")}},l.createElement("i",{className:"icon-cem_file1 tipppp",style:{marginLeft:4,fontSize:14,color:"#979797",verticalAlign:"unset"}}))),l.createElement("span",{className:"search"},l.createElement(ge,{placeholder:"\u8bf7\u8f93\u5165",onSearch:function(t){return e.handleSearch(t)},onChange:function(t){return e.setState({value:t.target.value})},size:"small",suffix:l.createElement("span",{onClick:function(){return e.handleSearch(d)}},l.createElement("i",{className:"icon-cem_small-search",style:{color:"#8c8c8c"}})),allowClear:!0}))),n&&n.list&&n.list.length>0?l.createElement(ne.default,{className:"result_tab",itemLayout:"vertical",size:"small",pagination:{onChange:function(t){var n=e.props,a=n.save,r=n.taskList;a({pageNumber:t}),r()},pageSize:10,size:"small",total:n.total,hideOnSinglePage:!0,showSizeChanger:!1,current:s},dataSource:n&&n.list,renderItem:function(t){return l.createElement(ne.default.Item,{key:t.id},l.createElement("span",{className:"opinion_filter_list_many"},"REPEATEDLY"===t.calculationType?"\u591a":"\u5355"),l.createElement("span",{className:"opinion_filter_list_content"},l.createElement(p.rU,{to:{pathname:"/opinionDetail?"+encodeURIComponent(JSON.stringify({id:t.id}))},onClick:function(e){"I"!==e.target.nodeName&&("TO_BE_GENERATED"===t.status&&(e.preventDefault(),ae.default.warning("\u8bf7\u60a8\u660e\u5929\u67e5\u770b\u7ed3\u679c")),m&&e.preventDefault())},target:"_blank"},l.createElement(ve,{editable:{tooltip:"\u6309ESC\u9000\u51fa\u7f16\u8f91",icon:l.createElement("i",{className:"icon-bianji",onClick:function(e){return e.preventDefault()}}),autoSize:{maxRows:1},maxLength:40,onChange:function(n){e.setState({isJump:!1}),e.handleEditClick(n.trim(),t.id,t.name)},onStart:function(){return e.setState({isJump:!0})},onCancel:function(){return e.setState({isJump:!1})}}},t.name))),l.createElement("span",{className:"opinion_filter_list_date"},e.handleTime(h.length>0&&h.includes(t.id)?"FINISH":t.status,t.predictTime,t.updateTime,t.opinionTotal),("FAILURE"===t.status||"DISABLE"===t.status&&t.opinionTotal<=5e5||"EXPIRED"===t.status)&&l.createElement("i",{className:"icon-cem_auto-refresh",style:{color:"#7262FD",marginLeft:4},onClick:function(){return e.handleUpdateClick(t.id)}})),l.createElement("span",{className:"opinion_filter_list_delete",onClick:function(){return e.handleDeleteClick(t)}},l.createElement("i",{className:"icon-cem_trash"})),l.createElement("span",{className:"opinion_filter_list_edit",onClick:function(){return e.handleDeleteClick(t)}},l.createElement("i",{className:"icon-bianji"})))}}):l.createElement("div",{className:"empty-block"},"\u65e0\u4fdd\u5b58\u7ed3\u679c")),l.createElement(w.Dialog,{className:"data_url_delete_dialog",title:"\u5220\u9664",size:"tiny",visible:r,onCancel:function(){return a({modalShow:!1})},lockScroll:!1},l.createElement(w.Dialog.Body,null,l.createElement("div",{className:"dialog-content"},"\u662f\u5426\u5220\u9664\u201c",o&&o.name,"\u201d\u5178\u578b\u610f\u89c1\u7ed3\u679c")),l.createElement(w.Dialog.Footer,{className:"dialog-footer"},l.createElement(w.Button,{onClick:function(){return a({modalShow:!1})}},"\u53d6\u6d88"),l.createElement(w.Button,{type:"primary",onClick:i},"\u786e\u5b9a"))))},t}(l.Component);const Ee=(0,o.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,me);return(0,r.Z)({},n[he],{loading:t.effects[he+"/taskList"]||!1})}),(function(e){return{save:function(t){return e({type:he+"/save",payload:t})},clean:function(){return e({type:he+"/clean"})},taskList:function(t){return e({type:he+"/taskList",payload:t})},taskDelete:function(t){return e({type:he+"/taskDelete",payload:t})},taskUpdate:function(t){return e({type:he+"/taskUpdate",payload:t})},taskRename:function(t){return e({type:he+"/taskRename",payload:t})}}}))(ye);const Ce=function(e){return(0,l.useEffect)((function(){}),[]),l.createElement("div",{className:"yt_opinion_home"},l.createElement(d.default,{type:"primary",size:"large",onClick:function(){return p.mW.push("/explore/opinion/screen")}},"\u5f00\u59cb\u63a2\u7d22"),l.createElement(te,null),l.createElement("div",{className:"opinion-list-wrapper"},l.createElement(c.default,{gutter:16},l.createElement(s.default,{span:12},l.createElement(u.Z,{bordered:!1},l.createElement(fe,null))),l.createElement(s.default,{span:12},l.createElement(u.Z,{bordered:!1},l.createElement(Ee,null))))))};var Se=["loading"],Ne=M.Z.opinionHome,ke=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={},n._event={},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){},n.render=function(){return l.createElement(Ce,(0,r.Z)({},this.state,this.props,this._event))},t}(l.Component);const _e=(0,o.connect)((function(e){e.loading;var t=(0,a.Z)(e,Se);return(0,r.Z)({},t[Ne])}),(function(e){return{save:function(t){return e({type:Ne+"/save",payload:t})},clean:function(){return e({type:Ne+"/clean"})}}}))(ke)}}]);