"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[7421],{1374:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(67294);const a=function(e){var t=e.src,n=e.defaultImg,a=e.timeoutTime,u=void 0===a?1e3:a,i=(0,r.useState)(t),o=i[0],l=i[1];return(0,r.useEffect)((function(){var e=new Image;e.src=t;var r=setTimeout((function(){l(n),e.onerror=null}),u);return e.onload=function(n){e.onload=null,clearTimeout(r),l(t)},e.onerror=function(t){e.onerror=null,clearTimeout(r),l(n)},function(){clearTimeout(r)}}),[t]),r.createElement("img",{src:o,alt:""})}},29604:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var r=n(87462),a=(n(29809),n(97538)),u=(n(1025),n(65400)),i=(n(89858),n(51024)),o=(n(53294),n(56697)),l=(n(77785),n(59361)),c=n(15861),s=(n(75314),n(11187)),d=n(87757),m=n.n(d),p=n(67294),f=n(68855),g=n(96889),v=n(20503),y=n(76295),h=n(70259),b=n(55815),E=n(13713),S={labelCol:{span:5},wrapperCol:{span:18}};const w=function(e){var t=e.location.state.teamId,d=e.location.state.team,w=(0,p.useState)(void 0),k=w[0],x=w[1],I=(0,p.useState)(void 0),C=I[0],T=I[1],z=(0,p.useState)(!1),N=z[0],Z=z[1],j=(0,p.useState)(""),V=j[0],F=(j[1],(0,p.useState)("hidden")),O=(F[0],F[1]),R=(0,p.useState)(""),U=R[0],P=R[1],_=(0,p.useState)(10),D=_[0],B=_[1],K=(0,p.useState)(1),H=K[0],L=K[1],M=(0,p.useRef)(null),G=(0,p.useRef)(null),W=(0,p.useState)(""),A=W[0],q=W[1],J=(0,p.useState)([]),Q=J[0],X=J[1],Y=p.createRef(),$=(0,p.useState)(!1),ee=$[0],te=$[1],ne=(0,p.useState)(void 0),re=ne[0],ae=ne[1],ue=function(){var e=document.getElementsByClassName("container")[0];ae((null==e?void 0:e.clientHeight)-79)};(0,p.useEffect)((function(){return window.addEventListener("resize",ue),ue(),function(){return window.removeEventListener("resize",ue)}}),[]);var ie=function(){var e=(0,c.Z)(m().mark((function e(n){return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.description,n.members,n.name,e.next=3,(0,v.Kp)({id:t,members:Q.map((function(e){return"DEPT"===e.objType?e.directlyUnder?{id:e.objId,type:"ExcludeSub"}:{id:e.objId,type:"IncludeSub"}:{id:e.objId,type:e.objType}}))});case 3:2e4===e.sent.data.code&&Q.length&&(L(1),s.default.success("\u64cd\u4f5c\u6210\u529f"),se({pageIndex:1,pageSize:D,keyword:U})),Y.current&&Y.current.resetFields();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=[{title:"\u6210\u5458/\u90e8\u95e8",dataIndex:"name",width:"35%",render:function(e,t){var r,a;return p.createElement("div",{className:"user-info"},p.createElement("img",{style:{width:"24px",height:"24px",borderRadius:"50%"},src:-1!==(null==(r=t.type)?void 0:r.indexOf("USER"))?null!==t.userHeadUrl?t.userHeadUrl:n(7732):n(87595),alt:""}),p.createElement("span",null,"\xa0",t.name,"\xa0"),-1===(null==(a=t.type)?void 0:a.indexOf("USER"))&&p.createElement(l.default,{color:"#e7f3ff",style:{color:"#1890ff"}},-1!==t.type.indexOf("IncludeSub")?"\u6240\u6709\u6210\u5458":"\u76f4\u5c5e\u6210\u5458"))}},{title:"\u90e8\u95e8",dataIndex:"DEPARTMENT",width:"25%",render:function(e,t){var n;return p.createElement("div",{className:"user-info"},-1===(null==(n=t.type)?void 0:n.indexOf("USER"))?t.name:t.department)}},{title:"\u90ae\u7bb1",dataIndex:"email",width:"25%",render:function(e,t){return t.email?t.email:"--"}},{title:"\u64cd\u4f5c",width:"15%",valueType:"option",render:function(e,t){return[p.createElement("a",{key:"delete",onClick:function(){!function(e){ce({title:"\u79fb\u9664\u6210\u5458/\u90e8\u95e8",icon:p.createElement(f.Z,{style:{color:"#FF7955"}}),autoFocusButton:null,content:"\u662f\u5426\u786e\u5b9a\u4ece\u8be5\u7528\u6237\u7ec4\u4e2d\u79fb\u9664\uff1f",className:"warn-modal",onOk:function(){le(e)},onCancel:function(){}})}(t)}},"\u79fb\u9664")]}}],le=function(){var e=(0,c.Z)(m().mark((function e(n){var r;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,v.WT)({id:t,member:{id:n.id,type:n.type}});case 3:r=e.sent,se({pageIndex:1===k.length?H-1||1:H,pageSize:D,keyword:U}),2e4===r.data.code?s.default.success("\u64cd\u4f5c\u6210\u529f"):s.default.error("\u64cd\u4f5c\u5931\u8d25"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),ce=o.Z.confirm;var se=function(){var e=(0,c.Z)(m().mark((function e(n){var r,a,u;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.pageIndex,a=n.pageSize,u=n.keyword,te(!0),e.next=5,(0,v.rV)({id:t,pageIndex:r||1,pageSize:a||10,keyword:u||""}).then((function(e){return x(e.data.result.list),T(e.data.result.total),e.data.result}));case 5:te(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=function(e){void 0!==e.inputValue&&(P(e.inputValue),se({pageIndex:1,pageSize:e.pageSize,keyword:e.inputValue}))};return(0,p.useEffect)((function(){se({pageIndex:1,pageSize:10,keyword:""})}),[]),p.createElement("div",{className:"project_usergroup_container"},p.createElement(b.Z,{title:(0,E.u)({title:d,url:"/account/project/usergroup/memberlist"})}),p.createElement("div",{className:"container",ref:G},p.createElement(g.ZP,{columns:oe,loading:ee,pagination:{current:H,defaultPageSize:10,total:C},scroll:{y:re-131},style:{minHeight:re},dataSource:k,onChange:function(e){!function(e){L(e.current),B(e.pageSize),se({pageIndex:e.current,pageSize:e.pageSize,keyword:U})}(e),B(e.pageSize)},toolbar:{search:p.createElement(i.default,{ref:M,placeholder:"\u8bf7\u8f93\u5165",allowClear:!0,style:{width:240,height:28},suffix:p.createElement("i",{className:"icon-cem_small-search",style:{color:"#BFBFBF"},onClick:function(){return de({pageIndex:1,pageSize:D,inputValue:U})}}),onPressEnter:function(){return de({pageIndex:1,pageSize:D,inputValue:U})},onKeyUp:function(e){P(M.current.state.value)},onChange:function(e){""===e.target.value&&(L(1),de({pageIndex:1,pageSize:D,inputValue:""}))}}),actions:[p.createElement(u.default,{key:"primary",type:"primary",onClick:function(){return Z(!0)}},"\u6dfb\u52a0\u6210\u5458/\u90e8\u95e8")]},rowKey:"key",search:!1,options:!1})),p.createElement(o.Z,{className:"adddept_modal",title:"\u6dfb\u52a0\u6210\u5458/\u90e8\u95e8",width:595,destroyOnClose:!0,visible:N,onOk:function(){""!==V?(Z(!1),O("hidden")):O("visible")},onCancel:function(){X([]),Z(!1)},footer:null},p.createElement("div",{className:"addUserGroup_body"},p.createElement(a.Z,(0,r.Z)({},S,{name:"userGroup-messages",onFinish:ie,ref:Y}),p.createElement(a.Z.Item,{className:"members",label:"\u6210\u5458/\u90e8\u95e8",name:"members",key:"members"},p.createElement(h.Z,{memberList:Q,setModalTitle:q,handleDeleteTag:function(e,t){X(Q.filter((function(e){return e.objId!==t.objId}))),e.preventDefault()}})),p.createElement(a.Z.Item,{wrapperCol:{span:17,offset:18},className:"btns"},p.createElement(u.default,{key:"cancel",htmlType:"button",onClick:function(){Y.current.resetFields(),X([]),Z(!1)}},"\u53d6\u6d88"),p.createElement(u.default,{type:"primary",key:"comfirm",htmlType:"submit",onClick:function(){Q.length?(Y.current.resetFields(),X([]),Z(!1)):s.default.error("\u8bf7\u9009\u62e9\u6210\u5458\u6216\u90e8\u95e8")}},"\u786e\u5b9a")))),p.createElement(y.Z,{members:Q,list:Q,searchOptions:[{label:"\u641c\u7d22\u6210\u5458",value:"USER"},{label:"\u641c\u7d22\u90e8\u95e8",value:"DEPT"}],type:3,directControl:!0,subTitle:"\u4ec5\u9009\u62e9\u90e8\u95e8\u7684\u76f4\u5c5e\u6210\u5458",title:A,onOk:function(e){X(e.members)},onCancel:function(){return q("")}})))}},70259:(e,t,n)=>{n.d(t,{Z:()=>u});n(77785);var r=n(59361),a=n(67294);const u=function(e){var t=e.memberList,n=e.setModalTitle,u=e.handleDeleteTag,i=e.memberValidate;return a.createElement("div",{className:"item member"},a.createElement("div",{className:i?"tag_content err":"tag_content",onClick:function(){n("\u9009\u62e9\u6210\u5458\u6216\u90e8\u95e8")}},null!=t&&t.length?t.map((function(e){return a.createElement(r.default,{onClick:function(e){e.stopPropagation()},closable:!0,key:e.id,onClose:function(t){return u(t,e)},icon:a.createElement("i",{className:"USER"===e.objType?"icon-cem_name":"icon-jiagou"})},e.name)})):a.createElement("span",{className:"tip"},"\u8bf7\u9009\u62e9\u6210\u5458/\u90e8\u95e8")))}},20503:(e,t,n)=>{n.d(t,{eP:()=>a,Kh:()=>u,g1:()=>i,oV:()=>o,Vm:()=>l,rV:()=>c,WT:()=>s,Kp:()=>d,Dn:()=>m});var r=n(49722),a=function(e){return r.h.post("/upms/team/delete",e)},u=function(e){return r.h.post("/upms/team/list",e)},i=function(e){return r.h.post("/upms/team/member/count",e)},o=function(e){return r.h.post("/upms/team/update",e)},l=function(e){return r.h.post("/upms/team/add",e)},c=function(e){return r.h.post("/upms/team/detail",e)},s=function(e){return r.h.post("/upms/team/member/delete",e)},d=function(e){return r.h.post("/upms/team/member/add",e)},m=function(e){return r.h.post("/upms/team/validateName",e)}},13713:(e,t,n)=>{n.d(t,{u:()=>a});var r=n(35239),a=function(e){var t=e.title,n=e.url,a=r.t.get(r.V.backProjectConfig).name;return n&&-1!==n.indexOf("memberlist")?[{title:a,url:"/account/project/preview"},{title:"\u7528\u6237\u7ec4",url:"/account/project/usergroup"},{title:t,url:n}]:[{title:a,url:"/account/project/preview"},{title:t,url:n}]}},87595:(e,t,n)=>{e.exports=n.p+"img/a27e4157e2da5f1f4b80.png"}}]);