"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[5979],{5979:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p});var a=n(87462),s=n(43144),r=n(94578),l=(n(89858),n(51024)),i=n(67294),c=n(29383),o=n(61409),u=n(49722),h=n(72305),m=n(61193),d=(l.default.Search,{0:"\u7981\u7528",1:"\u53ef\u7528"}),p=function(e){function t(t){var s;return(s=e.call(this,t)||this).getList=function(e){u.h.post("/user/list",(0,a.Z)({},s.state.form)).then((function(e){s.setState({data:e.data.result.result,from:e.data.result.from,to:e.data.result.to,count:e.data.result.count})}))},s.setSearch=function(e){s.setState({search:e.target.value}),e.target.value||s.getSearch("")},s.getSearch=function(e){var t=s.state.form;t.pageIndex=1,t.pageSize=20,u.h.post("/user/list",(0,a.Z)({},s.state.form,{search:e})).then((function(e){s.setState({data:e.data.result.result,from:e.data.result.from,to:e.data.result.to,count:e.data.result.count})}))},s.getPage=function(e){var t=s.state.form;t.pageIndex=e,s.setState({form:t},(function(e){return s.getList()}))},s.state={visible:!1,search:"",columns:[{label:"",prop:"paddingLeft",width:16},{label:"\u7528\u6237",prop:"username",render:function(e){return i.createElement("div",{className:"user-info"},i.createElement("img",{src:e.userHeadUrl?e.userHeadUrl+"?_="+(new Date).getTime():n(7732),alt:""}),i.createElement("div",null,i.createElement("p",null,e.username),i.createElement("div",null,e.email)))}},{label:"\u6240\u5728\u56e2\u961f",render:function(e){return i.createElement("div",null,e.teamVOS.map((function(e,t){return i.createElement("p",{key:t},i.createElement("span",{style:{color:"rgb(0, 82, 204)",cursor:"pointer"},onClick:function(t){return o.mW.push({pathname:"/account/team/edit",state:{id:e.id,name:e.name}})}},e.name))})))}},{label:"\u89d2\u8272",render:function(e){return i.createElement("p",null,e.role.name)}},{label:"\u767b\u5f55\u8be6\u60c5",width:240,render:function(e){return i.createElement("div",{className:"login-info"},i.createElement("p",null,"\u767b\u5f55\u6b21\u6570:",e.userExtVO.loginCount||0),e.userExtVO.loginCount&&i.createElement("p",null,"\u6700\u540e\u767b\u5f55\u65f6\u95f4\uff1a",e.userExtVO.updateTime))}},{label:"\u72b6\u6001",width:80,render:function(e){return d[e.status]}}],handle:{label:"\u64cd\u4f5c",width:180,render:function(e,t,n){return m.Z.getUser().userId!==e.id&&i.createElement("span",{className:"operation_columns",style:{cursor:"pointer"},onClick:function(t){return o.mW.push({pathname:"/account/user/userEdit",query:{email:e.email,id:e.id}})}},"\u7f16\u8f91")}},data:[],roleList:[],teamList:[],statusList:[{id:"0",name:"\u7981\u7528"},{id:"1",name:"\u53ef\u7528"}],form:{search:"",roleId:[],teamId:[],status:[],pageIndex:1,pageSize:20},from:0,to:0,count:0},s}(0,r.Z)(t,e);var p=t.prototype;return p.componentDidMount=function(){Promise.all([this.getList(),this.getRoleList(),this.getTeamList()]),m.Z.hasAuthority("USER_EDIT")&&this.state.columns.push(this.state.handle)},p.getTeamList=function(){var e=this;u.h.get("/team/list").then((function(t){e.setState({teamList:t.data.result.list})}))},p.getRoleList=function(){var e=this;u.h.get("/role/list").then((function(t){var n=[{id:"2",name:"\u4f01\u4e1a\u7ba1\u7406\u5458"},{id:"3",name:"\u666e\u901a\u6210\u5458"}].concat(t.data.result.list);e.setState({roleList:n})}))},p.render=function(){var e=this,t=document.documentElement.clientHeight-46-48-24,n=this.state,a=n.columns,s=n.data,r=n.from,o=n.to,u=n.count,m=n.form;return i.createElement("div",{className:"wrap common-padding-12"},i.createElement("div",{style:{minHeight:t,backgroundColor:"#fff"}},i.createElement("div",{className:"navWrap"},i.createElement(l.default,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d\u6216\u8005\u90ae\u7bb1",onChange:this.setSearch,allowClear:!0,suffix:i.createElement("i",{className:"icon-cem_small-search",onClick:function(){e.getSearch(e.state.search)}}),onPressEnter:function(){e.getSearch(e.state.search)},style:{width:"200px",marginRight:"15px",top:"-9px",height:"30px"}}),i.createElement(h.Z,{list:this.allList,onChange:function(t){return e.allList=t}})),i.createElement("div",{className:"userList"},i.createElement(c.Z,{columns:a,data:s,start:r,end:o,total:u,pageSize:m.pageSize,currentPage:m.pageIndex,onPage:this.getPage}))))},(0,s.Z)(t,[{key:"allList",get:function(){return[{name:"\u89d2\u8272",list:this.state.roleList,value:this.state.form.roleId},{name:"\u56e2\u961f",list:this.state.teamList,value:this.state.form.teamId},{name:"\u72b6\u6001",list:this.state.statusList,value:this.state.form.status}]},set:function(e){var t=this,n=this.state.form;e.forEach((function(e){switch(e.name){case"\u89d2\u8272":n.roleId=e.value;break;case"\u56e2\u961f":n.teamId=e.value;break;case"\u72b6\u6001":n.status=e.value}})),n.pageIndex=1,n.pageSize=10,this.setState({form:n},(function(e){return t.getList()}))}}]),t}(i.Component)},24473:(e,t,n)=>{n.d(t,{Z:()=>d});var a=n(87462),s=n(63366),r=n(94578),l=n(67294),i=n(45697),c=n.n(i),o=n(94184),u=n.n(o),h=["prefixCls","children","className","block","indeterminate","value","checked","defaultChecked","onChange","disabled"],m=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.prefixCls,r=t.children,i=t.className,c=t.block,o=t.indeterminate,m=t.value,d=t.checked,p=t.defaultChecked,f=t.onChange,g=t.disabled,v=(0,s.Z)(t,h),k={value:m,checked:d,defaultChecked:p,onChange:f,disabled:g},E=u()(n,((e={})[n+"-disabled"]=k.disabled,e[n+"-block"]=c,e[n+"-indeterminate"]=o,e),i);return l.createElement("label",(0,a.Z)({tabIndex:k.disabled?-1:0,className:E},v),l.createElement("input",(0,a.Z)({type:"checkbox",className:n+"-input"},k)),l.createElement("span",{className:n+"-status"}),r&&l.createElement("span",{className:n+"-text",title:r},r))},t}(l.Component);m.propTypes={prefixCls:c().string,value:c().oneOfType([c().string,c().number]),checked:c().bool,defaultChecked:c().bool,onChange:c().func,indeterminate:c().bool,disabled:c().bool,block:c().bool},m.defaultProps={prefixCls:"wt-checkbox"};const d=m},85151:(e,t,n)=>{n.d(t,{Jg:()=>a.Z,CS:()=>p});var a=n(24473),s=n(87462),r=n(63366),l=n(94578),i=n(67294),c=n(45697),o=n.n(c),u=n(94184),h=n.n(u),m=["prefixCls","children","className","onChange","values","checkedList","block"],d=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(t=e.call.apply(e,[this].concat(a))||this).handleCheckBoxChange=function(e){var n=t.props.onChange;n&&n(e)},t}return(0,l.Z)(t,e),t.prototype.render=function(){var e,t=this,n=this.props,a=n.prefixCls,l=n.children,c=n.className,o=(n.onChange,n.values),u=n.checkedList,d=n.block,p=(0,r.Z)(n,m);return e=o?o.map((function(e,n){var a=0!==u.length&&-1!==u.indexOf(e);return i.createElement(Checkbox,{key:n,value:e,checked:a,onChange:function(e){return t.handleCheckBoxChange(e)},block:d},e)})):i.Children.map(l,(function(e,n){if(e){var a=e.props,s=a.value,r=0!==u.length&&-1!==u.indexOf(s);return i.cloneElement(e,{checked:r,key:n,block:a.block||d,onChange:function(){var e=a.value;t.handleCheckBoxChange(e)}})}})),i.createElement("div",(0,s.Z)({className:h()(a,c)},p),e)},t}(i.Component);d.defaultProps={prefixCls:"wt-checkbox-group"},d.propTypes={onChange:o().func,values:o().array,block:o().bool};const p=d;var f=function(e){var t={};return Object.keys(e).forEach((function(n){/^data\-.+$/.test(n)&&(t[n]=e[n])})),t},g=function(e){function t(){return e.apply(this,arguments)||this}return(0,l.Z)(t,e),t.prototype.render=function(){var e=this.props,t=f(e);return i.createElement("label",{className:e.className,title:e.children},i.createElement("div",{className:"checkbox"},i.createElement("input",(0,s.Z)({checked:e.checked,type:"checkbox",name:e.name,onChange:e.onChange,disabled:e.disabled},t)),i.createElement("div",{className:"checkbox-body"})),"\xa0",i.createElement("span",null,e.children))},t}(i.Component);g.defaultProps={className:"",name:"",checked:!1,disabled:!1,onChange:function(e){return e}}},72305:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(36459),s=n(94578),r=n(67294),l=n(43144),i=n(85151);const c=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleClear=function(e){var t=n.state.list;t.forEach((function(e){return e.sel=!1})),n.setState({list:t},(function(e){return n.commitUserSel()}))},n.hoverDropToggle=function(e){if(e){var t=setTimeout((function(){n.setState({open:e,timeout:null})}),100);n.setState({timeout:t})}else clearTimeout(n.state.timeout),n.setState({open:e,timeout:null})},n.clickDropToggle=function(e){n.setState({open:!n.state.open})},n.stop=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},n.closeDrop=function(e){n.setState({open:!1})},n.state={list:JSON.parse(JSON.stringify(t.list||[])),searchKeyWords:"",open:!1,timeout:""},n}(0,s.Z)(t,e);var n=t.prototype;return n.search=function(){this.setState({searchKeyWords:this.refs.searchInput.value})},n.handleChecked=function(e){var t=this,n=this.state.list;this.props.singleSel?n.forEach((function(t){t.sel=t.id===e})):n.forEach((function(t){t.id===e&&(t.sel=!t.sel)})),this.setState({list:n},(function(e){return t.commitUserSel()}))},n.handleCheckedAll=function(){var e=this,t=!this.checkedAll,n=this.state.list;n.forEach((function(e){return e.sel=t})),this.setState({list:n},(function(t){return e.commitUserSel()}))},n.commitUserSel=function(){this.props.onSel(this.selList)},n.UNSAFE_componentWillReceiveProps=function(e,t){if(e.list||e.value){var n=JSON.parse(JSON.stringify(e.list));n.forEach((function(t){t.sel=-1!==e.value.indexOf(t.id)})),this.setState({list:n})}},n.componentDidMount=function(){var e=this;if(this.props.value){var t=JSON.parse(JSON.stringify(this.state.list));t.forEach((function(t){t.sel=-1!==e.props.value.indexOf(t.id)})),this.setState({list:t})}},n.render=function(){var e=this,t=this.props,n=t.classNames,a=t.style,s=t.title,l=t.selectPosition,c=t.special,o=t.singleSel,u=this.state,h=u.list,m=u.searchKeyWords,d=u.open,p=m.length>0?this.searchList:h,f=h.find((function(t){return e.props.list.value===t.id}));return r.createElement("div",{className:(n||"")+" back-search-select-wrap",onClick:function(t){e.stop(t)},style:a,onMouseEnter:function(){e.hoverDropToggle(!0)},onMouseLeave:function(){e.hoverDropToggle(!1)}},r.createElement("div",{className:d?"open sel-wrap":"sel-wrap"},r.createElement("div",{className:"span-wrap"},r.createElement("span",{className:"title"},s+(c?"":" : ")),!c&&(this.selList.length>0?this.selList.map((function(t,n){return r.createElement("span",{key:n},t.name,n===e.selList.length-1?"":" ,")})):r.createElement("span",null,o&&f?f.name:"\u5168\u90e8"))),r.createElement("i",{className:"icon-cem_pull-down-or-take-up"})),d&&r.createElement(r.Fragment,null,r.createElement("div",{className:"allSelContent",style:{left:"left"===l?"0":"",right:"right"===l?"0":""}},r.createElement("div",{className:"search"},r.createElement("p",{style:{padding:"5px"}},r.createElement("input",{value:m,placeholder:"\u8bf7\u8f93\u5165",ref:"searchInput",type:"text",onChange:function(t){return e.search()}}))),p.length>0?r.createElement("div",{className:"all"},r.createElement("div",{className:"all_check"},!o&&m.length<1&&r.createElement(i.Jg,{checked:this.checkedAll,indeterminate:this.indeterminate,onChange:function(){return e.handleCheckedAll()},block:!0},"\u5168\u9009")),p.map((function(t){return e.props.singleSel?r.createElement("p",{className:t.sel?"singleSel sel":"singleSel",key:t.id,onClick:function(){return e.handleChecked(t.id)}},t.name):r.createElement(i.Jg,{key:t.id,value:t.id,checked:t.sel,onChange:function(){return e.handleChecked(t.id)},block:!0},t.name)}))):r.createElement("div",{className:"all"},"\u65e0\u9009\u9879"),r.createElement("div",{className:"search_bottom"},r.createElement("p",null,r.createElement("span",{onClick:function(t){return e.handleClear()}},"\u6e05\u9664"))))))},(0,l.Z)(t,[{key:"selList",get:function(){return this.state.list.filter((function(e,t){return e.sel}))}},{key:"checkedAll",get:function(){return this.state.list.every((function(e){return e.sel}))}},{key:"indeterminate",get:function(){return!this.checkedAll&&this.state.list.some((function(e){return e.sel}))}},{key:"searchList",get:function(){var e=this;return this.state.list.filter((function(t){if(-1!==t.name.toLocaleLowerCase().indexOf(e.state.searchKeyWords.trim().toLocaleLowerCase()))return!0}))}}]),t}(r.Component);var o=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(t=e.call.apply(e,[this].concat(a))||this).state={filterList:[],inputVal:""},t.inputChange=function(e){t.setState({inputVal:e.target.value})},t.keywordChange=function(e){},t}(0,s.Z)(t,e);var n=t.prototype;return n.handleSel=function(e,t){var n=this.props,a=n.list,s=n.onChange;a.forEach((function(n){n.name===e&&(n.value=t.map((function(e){return e.id})))})),s(a)},n.UNSAFE_componentWillReceiveProps=function(e,t){e&&this.setState({filterList:e.list})},n.componentDidMount=function(){},n.buildHeaderFilter=function(){var e=this;(0,a.Z)(this.props);var t=this.state,n=(t.inputVal,t.filterList);return r.createElement("div",{className:"back-end-filter"},n.map((function(t,n){return r.createElement(c,{key:n,list:t&&t.list,value:t.value||[],onSel:e.handleSel.bind(e,t.name),title:t.name,singleSel:t.singleSel})})))},n.render=function(){return this.buildHeaderFilter()},t}(r.Component)}}]);