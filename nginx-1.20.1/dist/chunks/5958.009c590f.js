(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[5958],{25958:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>V});var a=n(37316),o=n.n(a),r=n(67154),k=n.n(r),i=n(85354),s=n.n(i),t=n(67294),D=n.n(t),a=n(55609),O=n(17051),L=n(99543),A=n(50196),w=n(41192),E=n(60496),r=n(93913),c=n.n(r),i=n(45697),r=n.n(i),S=n(39432),i=function(t){function e(e){var a=t.call(this,e)||this;a.inputChange=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),a.setState({searchKeyWords:e.target.value,isShow:!1})},a.keywordChange=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),"keydown"===e.type&&13===e.keyCode&&a.handleCompareClick(a.props.options.find(function(e){return e.value.toLocaleLowerCase()===a.state.searchKeyWords.trim().toLocaleLowerCase()})),a.setState({isShow:!1})},a._setPadShowFalse=function(){a.state.show&&a.setState({show:!1})},a._handleOnClick=function(e){var t=a.state.show;t&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()),setTimeout(function(){a.setState({show:!t})},0)},a.handleProductClick=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();e=a.props.onChange;a.state.disabled||e({productCompare:""}),a.setState({searchKeyWords:"",productTitle:"无"})},a.handleCompareClick=function(t){var e=a.props,n=e.onChange,e=e.objName;a.props.options.filter(function(e){return e.value===t});a.setState({isShow:!0,productTitle:t.value}),t.disabled||n(e?((n={})[e]=t.value,n):t.value)};e=Math.max.apply(null,e.options.map(function(e){return(0,S.jD)(e.title,14)}))+16+2;return a.state={show:!1,firstLiHover:!1,panelWidth:100<e?e:100,isDisabled:!1,searchKeyWords:"",isShow:!0,productTitle:"无"},a}s()(e,t);var n=e.prototype;return n.componentDidMount=function(){window.addEventListener("click",this._setPadShowFalse)},n.componentWillUnmount=function(){window.removeEventListener("click",this._setPadShowFalse)},n.render=function(){var n=this,e=this.state,t=e.show,a=e.panelWidth,o=e.searchKeyWords,r=e.isShow,i=e.productTitle,s=this.props,c=s.activeObj,l=void 0===c?"":c,d=s.objName,p=s.preTitle,u=s.sufTitle,e=void 0===u?"":u,c=s.showTitle,u=void 0===c||c,c=(s=this.props.options).find(function(e){return e.value===l}),c=""===l?e:c&&c.title,s=this.searchList!==[]?this.searchList:s.filter(function(e){return e.value!==i});return D().createElement("div",{className:"co-single-select-button-wrapper",onClick:this._handleOnClick},D().createElement("span",{className:"button-trigger "+(t?"sel":"")},u&&D().createElement(D().Fragment,null,p&&D().createElement("span",{className:"pre-title"}," ",p,"： "),D().createElement("span",{className:"button-title"}," ",c," ")),D().createElement("i",{className:"icon-cem_arrow-launches",style:{transform:t?"rotate(-180deg)":""}})),D().createElement("div",{className:"button-panel "+(t?"active":""),style:{minWidth:a}},"productCompare"===d&&D().createElement("div",{className:"search"},D().createElement("input",{value:o,placeholder:"请输入关键词",type:"text",onChange:this.inputChange,onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},onKeyDown:this.keywordChange}),r&&s&&D().createElement("i",{className:"icon-cem_search",onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),n.handleCompareClick(n.props.options.find(function(e){return e.value.toLocaleLowerCase()===n.state.searchKeyWords.trim().toLocaleLowerCase()}))}}),!r&&""!==o&&s&&D().createElement("i",{className:"icon-cem_close-window",onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),n.setState({searchKeyWords:"",isShow:!0})}})),D().createElement("div",{style:{overflow:"auto",maxHeight:206,marginTop:16}},r&&"productCompare"===d&&D().createElement("p",{className:"product"},i,"无"!==i&&D().createElement("i",{className:"icon-cem_cancel",onClick:this.handleProductClick})),s.map(function(e,t){return D().createElement("div",{className:"panel-item",key:e.value,onClick:function(){n.handleCompareClick(e)},style:{display:e.title===i?"none":"block"}},e.title)}))))},c()(e,[{key:"searchList",get:function(){var t=this;return this.props.options.filter(function(e){return-1!==e.value.toLocaleLowerCase().indexOf(t.state.searchKeyWords.trim().toLocaleLowerCase())})}}]),e}(D().PureComponent);i.propTypes={activeObj:r().any,onChange:r().func.isRequired,options:r().array.isRequired,objName:r().string.isRequired,preTitle:r().string,sufTitle:r().string,showTitle:r().bool};const b=i;var T=n(50976),p=n(71339);const x=function(e){var t=e.option,n=e.data,a=e.loading,o=e.product,r=D().useState(1),i=r[0],s=r[1],c=D().useState(10),l=c[0],e=c[1],r=D().useState([]),c=r[0],d=r[1];D().useEffect(function(){d(n.slice(0,l)),s(1)},[l,t.aspectType]),D().useEffect(function(){n&&n instanceof Array&&d(n.slice((i-1)*l,i*l))},[n,i,o]);o=function(e,t,a){e=e-5-24-40-32;return t&&1===t.length?[{label:"",width:16},{label:"排序",width:.3*e,render:function(e,t,n){return n+1}},{label:"关注点",width:.3*e,prop:"name"},{label:"数量",width:.3*e,prop:"value"},{label:"占比",width:.1*e,prop:"precent",render:function(e){return(100*e.precent).toFixed(2)+"%"}},{label:"",width:16}]:t&&2===t.length?[{label:"",width:16},{label:"排序",width:.12*e,render:function(e,t,n){return n+1}},{label:"关注点",width:.16*e,prop:"name"},{label:t[0]+"数量",width:.18*e,prop:"value"},{label:t[0]+"占比",width:.18*e,prop:"precent",render:function(e){return(100*e.precent).toFixed(2)+"%"}},{label:t[1]+"数量",width:.18*e,prop:"value2",render:function(e,t,n){return a[n].value2}},{label:t[1]+"占比",width:.18*e,prop:"precent2",render:function(e,t,n){return(100*a[n].precent2).toFixed(2)+"%"}},{label:"",width:16}]:void 0}(t.width,o,c);return D().createElement("div",{className:"yt-aspect-table-wrapper",style:t.style},D().createElement(p.Z,{data:c,loading:a,option:t,columns:o,total:n.length,pageIndex:i,pageSize:l,onPageSizeChange:e,onPageChange:s}))};var P=n(8201),N=n(53754),_=n(43036),I=n(22120),R=n(98191),F=n(70715);var W=[{title:"导出图片",type:"image"},{title:"导出数据",type:"data"}],M=[{title:"数量",value:"NUMBER"},{title:"比例",value:"RATIO"}],Z=[{title:"一级关注点",value:"ASPECT1"},{title:"二级关注点",value:"ASPECT2"}],j={c0:["cem_histogram-gray","cem_histogram-colour","对比柱状图"],c1:["cem_bar-type","cem_bar-chart-col","对比条形图"],c2:["cem_form-new","cem_form-new-col","表格"]};const z=function(e){var t=e.title,i=e.data,s=e.onMoreClick,n=e.loading,a=e.aspectType,o=e.formulaType,r=e.productCompare,c=e.productOptions,l=e.onFilterChange,d=e.contentWidth,p=e.onChartClick,u=e.conPosition,h=e.onConPositionChange,m=D().useState("c0"),f=m[0],e=m[1],m=D().useState(void 0),g=m[0],y=m[1],o=D().useState(o),v=o[0],C=o[1],o="c2"===f?W.slice(1):W;return D().useEffect(function(){var e;g&&"c2"!==f&&((0,P.P)(i)?(e="c0"===f?function(e,t,i,n){void 0===i&&(i="NUMBER"),void 0===n&&(n="ASPECT1");var a=e.chartData,o=e.title,r=e.dataType,s=e.product,c=Array.from({length:a.length}),e=a.source[0],l=.8*t/(63*e.length),d=1<(0,S.jD)(e.join(""),12)/(.6*t);return{title:{text:o,textStyle:{fontSize:14}},color:["#1574B3","#A1C7E1"],dataset:c.map(function(e,t){return{dimensions:a.dimensions,sourceHeader:!1,source:a.source}}),grid:c.map(function(){return{show:!1,left:24,right:24,top:80,bottom:d?60:l<1?50:30,containLabel:!0}}),tooltip:{trigger:"axis",axisPointer:{type:"none"},formatter:function(e){return("ASPECT2"===n?2===e.length?[e[0]]:4===e.length?[e[0],e[2]]:e:e).reduce(function(e,t,n){var a=t.marker,o=t.data,r=t.dimensionNames[2*n+1],t=o[2*n+1],o=o[2*n+2],n=t,t="数量",r=r.substring(0,r.lastIndexOf("-"));return"RATIO"===i&&(n=0===o?0:(100*o).toFixed(2)+"%",t="比例"),[].concat(e,[a+" "+r+"关注点"+t+"："+n])},[e[0].name]).join("<br/>")}},legend:{left:16,top:40,itemWidth:12,itemHeight:12,data:s.map(function(e){return{name:e,icon:F.W4.square}})},dataZoom:{show:l<1,type:"slider",xAxisIndex:c.map(function(e,t){return t}),start:0,end:+(100*l).toFixed(0),height:20,handleSize:"100%",showDelay:!1},xAxis:c.map(function(e,t){return{type:"category",gridIndex:t,show:0===t,triggerEvent:"aspect"===r,axisTick:{show:0===t,alignWithLabel:!0},axisLabel:{interval:0,rotate:d?45:0,margin:d?15:8,formatter:function(e){return 6<e.length?e.substring(0,5)+"...":e}}}}),yAxis:c.map(function(e,t){return{max:"NUMBER"===i?parseInt(1.05*a.max):1,type:"value",gridIndex:t,show:0===t,axisLabel:{formatter:function(e){return 0===e?0:"RATIO"===i&&e<=1?(100*e).toFixed(0)+"%":e}}}}),series:c.map(function(e,t){return{type:"bar",name:s[t],zlevel:a.length-t,yAxisIndex:t,xAxisIndex:t,seriesLayoutBy:"row",datasetIndex:t,encode:{x:0,y:2*t+("NUMBER"===i?1:2)},barMaxWidth:1===a.length||0===t?24:36}})}}(i,g.getWidth(),v,a):function(e,t,i,n){void 0===i&&(i="NUMBER"),void 0===n&&(n="ASPECT1");var a=e.chartData,o=e.title,r=e.dataType,s=e.product,c=.6*t/(60*a.source[0].length),e=c<1,t=Array.from({length:a.length});return{title:{text:o},color:["#1574B3","#A1C7E1"],dataset:t.map(function(e,t){return{dimensions:a.dimensions,sourceHeader:!1,source:a.source}}),tooltip:{trigger:"axis",axisPointer:{type:"line"},formatter:function(e){return("ASPECT2"===n?2===e.length?[e[0]]:4===e.length?[e[0],e[2]]:e:e).reduce(function(e,t,n){var a=t.marker,o=t.data,r=t.dimensionNames[2*n+1],t=o[2*n+1],o=o[2*n+2],n=t,t="数量",r=r.substring(0,r.lastIndexOf("-"));return"RATIO"===i&&(n=0===o?0:(100*o).toFixed(2)+"%",t="比例"),[].concat(e,[a+" "+r+"关注点"+t+"："+n])},[e[0].name]).join("<br/>")}},dataZoom:[{show:e,type:"slider",yAxisIndex:0,left:20,start:0,end:+(100*c).toFixed(0),width:20,handleSize:"100%",showDelay:!1}],grid:{show:!1,left:e?50:24,right:24,top:80,bottom:30,containLabel:!0},legend:{left:16,top:40,itemWidth:12,itemHeight:12,data:s.map(function(e){return{name:e,icon:F.W4.square}})},xAxis:{type:"value",max:"NUMBER"===i?parseInt(1.05*a.max):1,axisLabel:{formatter:function(e){return 0===e?0:"RATIO"===i&&e<=1?(100*e).toFixed(0)+"%":e}}},yAxis:{type:"category",inverse:!0,triggerEvent:"aspect"===r},series:t.map(function(e,t){return{type:"bar",name:s[t],seriesLayoutBy:"row",datasetIndex:t,encode:{x:2*t+("NUMBER"===i?1:2),y:0},barMaxWidth:24}})}}(i,g.getHeight(),v,a),g.clear(),g.setOption(e)):y(void 0))},[i,g,f,v]),D().createElement(P.Z,{data:i,className:"yt-product-bar-table-wrapper",renderTitle:D().createElement(R.Z,{data:i,title:"c2"!==f?t:"",onMoreClick:function(e){return t=g,n=i,a=s,r=void 0,"image"===(e=e)?r=t:"data"===e&&(o=JSON.parse(JSON.stringify(n.chartData.source)),["product"===n.dataType?"产品":"关注点","会话数量"].map(function(e,t){return o[t].splice(0,0,e)}),r=[o]),void a({type:e,obj:r,name:t.getOption().title[0].text});var t,n,a,o,r},moreOptions:o},"c2"!==f&&v&&D().createElement(E.Z,{preTitle:"公式",onChange:function(e){e=e.formulaType;C(e)},objName:"formulaType",activeObj:v,options:M,data:i,aspectType:a}),D().createElement("i",null,void 0!==r&&D().createElement(b,{preTitle:"对比商品",sufTitle:"请选择",onChange:l,objName:"productCompare",activeObj:r,options:c})),a&&D().createElement(E.Z,{onChange:l,objName:"aspectType",activeObj:a,options:Z}),u&&D().createElement("div",{className:"con-position"},D().createElement(N.Z,{type:1,title:"会话位置",options:I.R,value:u,onChange:h}),D().createElement(_.Z,{placement:"top",overlay:"由于客户从某个商品链接进入阿里旺旺等咨询聊天窗口后，不一定是咨询该商品。为了提高业务分析的灵活性，这里将“商品”在会话中的位置做区分，供用户切换",overlayClassName:"restricted-width-pop"},D().createElement("i",{className:"icon-cem_problem-new"}))),D().createElement(w.Z,{onChange:e,chartType:f,options:j}))},i&&D().createElement(D().Fragment,null,D().createElement(T.Z,{theme:"yunting_multi_color",option:{},style:{width:"100%",height:375,display:"c2"===f?"none":"block"},onEvents:{click:p},onChartReady:function(e){return y(e)}}),D().createElement(x,{option:{aspectType:a,width:d,style:{display:"c2"===f?"block":"none",paddingTop:40}},product:i.product,data:i.tableData,loading:n})))};function l(e){var t=e.filter(function(e){return e.self});t.sort(function(e,t){return e.count-t.count});e=e.filter(function(e){return!e.self});return e.sort(function(e,t){return e.count-t.count}),[].concat(e,t)}var d=function(t){function e(e){var r=t.call(this,e)||this;return r.toggleShow=function(e){var t=r.state,n=t.selfShow,a=t.othersShow,t=t.data,o=[];1===e?(t.forEach(function(e){(!n&&e.self||a&&!e.self)&&o.push(e)}),e=10<o.length?100-10/o.length*100:0,r.setState({selfShow:!n,filteredData:l(o),start:e},function(){return r.resetChart()})):(t.forEach(function(e){(n&&e.self||!a&&!e.self)&&o.push(e)}),t=10<o.length?100-10/o.length*100:0,r.setState({othersShow:!a,filteredData:l(o),start:t},function(){return r.resetChart()}))},r.resetChart=function(){var e=r.state,t=e.filteredData,n=e.start,a=e.selfShow,e=e.othersShow,n={tooltip:{trigger:"item",formatter:function(e){return""+e.marker+e.name+"："+e.value}},grid:{show:!1,left:10<t.length?48:20,right:32,top:60,bottom:14,containLabel:!0},graphic:{type:"group",left:0,top:24,children:[{type:"rect",shape:{width:12,height:12},style:{fill:a?"#1574B3":"#CCCCCC"},cursor:"pointer",onclick:function(){return r.toggleShow(1)}},{type:"text",left:20,top:2,style:{text:"本品",fill:a?"#262626":"#CCCCCC"},cursor:"pointer",onclick:function(){return r.toggleShow(1)}},{type:"rect",left:60,shape:{width:12,height:12},style:{fill:e?"#A1C7E1":"#CCCCCC"},cursor:"pointer",onclick:function(){return r.toggleShow(2)}},{type:"text",left:80,top:2,style:{text:"竞品",fill:e?"#262626":"#CCCCCC"},cursor:"pointer",onclick:function(){return r.toggleShow(2)}}]},xAxis:{type:"value"},yAxis:{type:"category",data:t.map(function(e){return e.name})},series:[{name:"本品",type:"bar",barMaxWidth:20,data:t.map(function(e){return{name:e.name,value:e.count,itemStyle:{color:e.self?"#1574B3":"#A1C7E1"}}})}],dataZoom:{show:10<t.length,type:"slider",showDetail:!1,yAxisIndex:[0],width:20,left:0,filterMode:"filter",start:n,end:100}};r.instance.clear(),r.instance.setOption(n)},r.state={data:e.data,filteredData:l(e.data),start:10<e.data.length?100-10/e.data.length*100:0,selfShow:!0,othersShow:!0},r}s()(e,t);var n=e.prototype;return n.componentDidMount=function(){this.instance=this.chart.getEchartsInstance(),this.resetChart()},n.render=function(){var t=this,e=this.props.onChartClick;return D().createElement(T.Z,{ref:function(e){return t.chart=e},option:{},theme:"yunting_neg_pos",style:{width:"100%",height:"353px"},onEvents:{click:e}})},e}(t.Component);d.propTypes={data:r().array.isRequired};var u=function(n){function e(e){var t=n.call(this,e)||this;return t.resetChart=function(){var e=t.state.data,e={tooltip:{trigger:"item",formatter:function(e){return""+e.marker+e.name+"："+e.value}},xAxis:{type:"value"},yAxis:{type:"category",data:e.map(function(e){return e.name})},series:[{type:"treemap",top:25,left:0,right:0,bottom:0,label:{formatter:"{b}\n{@c}",lineHeight:14},nodeClick:!1,silent:!1,roam:!1,breadcrumb:{show:!1},levels:[{itemStyle:{normal:{borderWidth:0,gapWidth:0}}},{itemStyle:{normal:{borderWidth:0,gapWidth:0}}}],data:e.map(function(e){return{name:e.name,value:e.count}})}]};t.instance.clear(),t.instance.setOption(e)},t.state={data:e.data},t}s()(e,n);var t=e.prototype;return t.componentDidMount=function(){this.instance=this.chart.getEchartsInstance(),this.resetChart()},t.render=function(){var t=this;return D().createElement(T.Z,{ref:function(e){return t.chart=e},option:{},theme:"yunting_multi_color",style:{width:"100%",height:"353px"}})},e}(t.Component);u.propTypes={data:r().array.isRequired};var h=n(29383),m=function(t){function e(e){var a=t.call(this,e)||this;return a.switchPage=function(e){var t=a.state,n=t.pageSize,n=t.data.slice((e-1)*n,e*n);a.setState({currPageData:n,pageIndex:e})},a.switchPageSize=function(e){var t=a.state.data.slice(0,e);a.setState({currPageData:t,pageIndex:1,pageSize:e})},a.state={currPageData:[],data:e.data,pageIndex:1,pageSize:10},a}s()(e,t);var n=e.prototype;return n.componentDidMount=function(){this.switchPage(1)},n.render=function(){var e=this.state,t=e.currPageData,n=e.data,a=e.pageIndex,e=e.pageSize;return D().createElement(h.Z,{columns:[{label:"",prop:"paddingLeft",width:16},{label:"排序",prop:"rank"},{label:"关注点",prop:"name"},{label:"数量",prop:"count"},{label:"占比",prop:"percentage",render:function(e){return e.percentage+"%"}},{label:"",prop:"paddingRight",width:16}],data:t,total:n.length,pagePosition:"down",pageSize:e,currentPage:a,onPage:this.switchPage,pageSizeSelectorShow:!0,onPageSizeChange:this.switchPageSize,notLimit:!0})},e}(t.Component);m.propTypes={data:r().arrayOf(r().shape({name:r().string.isRequired,count:r().number.isRequired,brand:r().string,self:r().bool.isRequired,percentage:r().number.isRequired}))};var f=n(40086),g=n(30133),y=n(25713),v=n(33798),C=n(92360),q=n(94644),B=function(t){function e(e){var n=t.call(this,e)||this;return n.handleSwitchCategory=function(e){var t=n.props.onGroupTypeChange;t&&t({groupType:e})},n.handleSwitchChartType=function(e){n.state.chartType!==e&&n.setState({chartType:e})},n.handleDownload=function(e,t){"img"===e?n.handleDownloadChart(t):n.handleDownloadExcel(t)},n.handleDownloadExcel=function(e){var t=n.state.data.map(function(e){return[e.rank,e.name,e.count,e.percentage]});t.splice(0,0,["排序","关注点","数量","占比（%）"]),(0,q.aT)([t],e)},n.handleDownloadChart=function(e){"bar"===n.state.chartType?(0,q._v)(n.bar.instance,e):(0,q._v)(n.treeMap.instance,e)},n.state={loading:e.loading,data:e.data,product:e.product,chartType:"bar"},n}return s()(e,t),e.getDerivedStateFromProps=function(e,t){return e.loading!==t.loading?{loading:e.loading}:JSON.stringify(e.data)!==JSON.stringify(t.data)?{data:e.data}:null},e.prototype.render=function(){var o=this,r=this.state.chartType,e=this.props,t=e.loading,n=e.isInitial,a=e.product,i=e.data,s=e.groupType,c=e.onChartClick,e=JSON.parse(JSON.stringify(i)),s={list:[{name:"品牌",id:"BRAND"},{name:"型号",id:"SUBJECT"}],value:s,placeholder:s.name,onChange:this.handleSwitchCategory},l="提及"+a+"时也提到的其他商品",a="table"===r?[{type:"excel",title:"导出数据"}]:[{type:"img",title:"导出图片"},{type:"excel",title:"导出数据"}];return D().createElement("div",{className:"comparison-chart-wrapper"},D().createElement("div",{className:"comparison-chart-header"},D().createElement("span",{className:"title"},l),D().createElement("div",{className:"appendix"},D().createElement(f.Z,s),[{type:"bar",className:"cem_bar-type",activeClassName:"cem_bar-type-colour",title:"柱状图"},{type:"tree",className:"cem_area",activeClassName:"cem_area-col",title:"面积图"},{type:"table",className:"cem_form-new",activeClassName:"cem_form-new-col",title:"表格"}].map(function(e){var t=e.type,n=e.className,a=e.activeClassName,e=e.title;return D().createElement(_.Z,{key:t,placement:"top",overlay:e},D().createElement(v.Z,{enable:!0,isActive:r===t,defaultIcon:n,activeIcon:a,onClick:function(){return o.handleSwitchChartType(t)}}))}),D().createElement(y.Z,{options:a,onClick:function(e){return o.handleDownload(e,l)}})),n?D().createElement(g.Z,null):t?D().createElement(C.Loading,{loading:t},D().createElement("div",{style:{height:"343px"}})):0<i.length?"bar"===r?D().createElement(d,{ref:function(e){return o.bar=e},data:e,onChartClick:c}):"tree"===r?D().createElement(u,{ref:function(e){return o.treeMap=e},data:e}):D().createElement(m,{data:e}):D().createElement("div",{className:"empty-block"},"暂无数据")))},e}(t.Component);B.propTypes={loading:r().bool,isInitial:r().bool.isRequired,product:r().string.isRequired,data:r().arrayOf(r().shape({name:r().string.isRequired,count:r().number.isRequired,brand:r().string,self:r().bool.isRequired,percentage:r().number.isRequired})),onGroupTypeChange:r().func.isRequired};var J=n(67641);const H=function(e){var t=e.isInitial,n=e.conData,a=n.sum,o=n.total,r=n.sourceList,i=n.titlePrefix,s=e.overviewLoading,c=e.trendData,l=e.trendLoading,d=e.trendTimeType,p=e.trendPlatformType,u=e.onTrendFilterChange,h=e.productFocusPointData,m=e.productLoading,f=e.productOptions,g=e.productCompare,y=e.productAspectType,v=e.onProductFilterChange,C=e.mentionedGoodsLoading,w=e.mentionedGoodsData,E=e.fetchMentionedGoods,S=e.headerDefValue,b=e.onMoreClick,T=e.contentWidth,x=e.onFilterChange,P=e.onAspectChartClick,N=e.getHeaderRef,n=e.onChartClick,e=e.formulaType;return D().createElement("div",{className:"yt-conversation-commodity-wrapper"},D().createElement(J.Z,{onChange:x,type:"commodityAnalyze",value:S,ref:N,title:"商品分析"}),D().createElement("div",{className:"co-content",id:"co-content"},D().createElement("div",null,D().createElement(O.Z,{type:2,titlePrefix:i,loading:s,isInitial:t,quantity:a,leftSubTitle:"所有商品会话量",leftContent:o,rightSubTitle:"提及率",rightContent:""+(0===o?0:(a/o*100).toFixed(2))}),D().createElement(L.Z,{titlePrefix:i,loading:s,isInitial:t,data:r}),D().createElement(A.Z,{title:i+"会话走势",pageType:"product",data:c,loading:l,onMoreClick:b,timeType:d,platformType:p,onFilterChange:u})),D().createElement(z,{title:"提及"+i+"时的关注点",data:h,loading:m,formulaType:e,aspectType:y,productCompare:g,onMoreClick:b,onFilterChange:v,contentWidth:T,productOptions:f,onChartClick:P}),D().createElement(B,k()({title:"提及"+i+"时也提及到的其他商品"},w,{product:i,loading:C,isInitial:t,onGroupTypeChange:E,onChartClick:n}))))};var G=n(35239),U=n(61409),K=n(64396).Z.conversation.commodityAnalyze,t=function(t){function e(e){var p=t.call(this,e)||this;p._handleOnMoreClick=function(e){"image"===e.type?(0,q._v)(e.obj,e.name):"data"===e.type&&(0,q.aT)(e.obj,e.name)},p._handleWindowResize=function(){p.setState({contentWidth:document.getElementById("co-content").offsetWidth})},p._handleOnProductFilterChange=function(e){var t=e.aspectType&&"ASPECT1"===e.aspectType?{aspect1:[]}:{};p.props.fetchProductFocusPointData(k()({},e,t))},p._handleOnFilterChange=function(e,t){G.t.set(G.V.conversationCommodityHeader,t),p.props.fetchDatas({projectId:G.t.get(G.V.curProject).id,refresh:p.shouldRefresh,headerState:JSON.parse(JSON.stringify(t)),filter:k()({source:[],shopName:[],waiter:[],typeList:[],aspect1:[],aspect2:[],product:[]},JSON.parse(JSON.stringify(e)))}).then(function(){p.shouldRefresh=!1})},p._handleOnTrendFilterChange=function(e){p.props.fetchConversationTrendData(k()({},e))},p._handleOnAspectChartClick=function(e){var t=p.props,n=t.productAspectType,a=t.filter,o=t.productList,r=t.fetchProductFocusPointData,i=e.componentType,s=e.name,c=e.value,l=e.dimensionNames,d=e.seriesIndex,t=e.seriesName;"series"===i?(e=s,s="ASPECT2"===n?[p.headerRef.getAspect1(e).name,e]:[e],t=(d=l[2*d+1]).substring(0,d.lastIndexOf("-")),U.mW.push({pathname:"/conversation/commodityAnalyze/detail",state:k()({},JSON.parse(JSON.stringify(a)),((o={queryType:"ASPECT",product:[t],productList:JSON.parse(JSON.stringify(o.filter(function(e){return e!==a.product[0]}))),aspect1:[],aspect2:[]})[n.toLowerCase()]=[e],o.aspect=s,o))})):"xAxis"!==i&&"yAxis"!==i||r({aspectType:(n="ASPECT1"===n)?"ASPECT2":"ASPECT1",aspect1:n?[c]:[]})},p._handleOnProductChartClick=function(e){var t=p.props,n=t.projectId,a=t.filter,t=t.mentionedGoodsData;"series"===e.componentType&&"BRAND"===t.groupType.id&&U.mW.push({pathname:"/conversation/commodityAnalyze/detail",state:k()({},JSON.parse(JSON.stringify(a)),{brand:e.name,projectId:n,aspect:[]})})},p.headerRef=void 0;e=e.location.state;return p.shouldRefresh=e&&"detail"===e.from,p.state={contentWidth:0},p.event={onFilterChange:p._handleOnFilterChange,onTrendFilterChange:p._handleOnTrendFilterChange,onProductFilterChange:p._handleOnProductFilterChange,onMoreClick:p._handleOnMoreClick,onAspectChartClick:p._handleOnAspectChartClick,getHeaderRef:function(e){return p.headerRef=e&&e.wrappedInstance},onChartClick:p._handleOnProductChartClick},p}s()(e,t);var n=e.prototype;return n.componentDidMount=function(){this._handleWindowResize(),window.addEventListener("resize",this._handleWindowResize)},n.componentWillUnmount=function(){window.removeEventListener("resize",this._handleWindowResize)},n.render=function(){return D().createElement(H,k()({},this.props,this.state,this.event))},e}(t.Component);const V=(0,a.connect)(function(e,t){var n=e.loading,e=o()(e,["loading"]);return k()({},e[K],{headerDefValue:t.location.state&&t.location.state.defHeader||e[K].headerState,overviewLoading:n.effects[K+"/fetchConversationData"]||!1,mentionedGoodsLoading:n.effects[K+"/fetchMentionedGoods"]||!1,trendLoading:n.effects[K+"/fetchConversationTrendData"]||!1,productLoading:n.effects[K+"/fetchProductFocusPointData"]||!1,focusLoading:n.effects[K+"/fetchFocusDistributionData"]||!1})},function(t){return{fetchDatas:function(e){return t({type:K+"/fetchDatas",payload:e})},fetchConversationTrendData:function(e){return t({type:K+"/fetchConversationTrendData",payload:e})},fetchProductFocusPointData:function(e){return t({type:K+"/fetchProductFocusPointData",payload:e})},fetchMentionedGoods:function(e){return t({type:K+"/fetchMentionedGoods",payload:e})}}})(t)},40086:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var a=n(67154),l=n.n(a),t=n(85354),o=n.n(t),a=n(67294),d=n.n(a),t=n(45697),t=n.n(t),r=function(n){function e(e){var t=n.call(this,e)||this;return t.stop=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},t._setEvent=function(e){return 0===e?{onMouseEnter:function(){t.setState({firstLiHover:!0})},onMouseLeave:function(){t.setState({firstLiHover:!1})}}:{}},t.setShowSelFalse=function(){t.setState({show:!1})},t.state={show:!1,firstSelected:!1},t}o()(e,n);var t=e.prototype;return t.changeShow=function(e){var t=this;this.state.show&&this.stop(e),setTimeout(function(){t.setState({show:!t.state.show})},0)},t.componentDidMount=function(){window.addEventListener("click",this.setShowSelFalse)},t.componentWillUnmount=function(){window.removeEventListener("click",this.setShowSelFalse)},t.render=function(){var n=this,e=this.state.show,t=this.props,a=t.placeholder,o=t.list,r=t.value,i=t.onChange,s=t.style,c=t.partingLine,t=o[0]&&o[0].id===r.id;return d().createElement("div",{className:"chart-select",style:s||{}},d().createElement("div",{className:"select "+(c?"line":""),onClick:function(e){return n.changeShow(e)}},d().createElement("div",{className:"infor "+(e?"sel":"")},d().createElement("span",{className:"placeholder"},a),d().createElement("i",{className:"icon icon-cem_arrow-launches",style:{transform:e?"rotate(-180deg)":"",top:e?"3px":""}}))),e&&d().createElement("div",{className:"position-wrap"},d().createElement("div",{className:"selItem "+(this.state.firstLiHover||t?"selPadHover":""),onClick:function(e){return n.stop(e)}},d().createElement("div",{className:"wrap"},d().createElement("ul",null,0<o.length?o.map(function(e,t){return d().createElement("li",l()({className:e.id===r.id?"sel":"",key:t,onClick:function(){n.setShowSelFalse(),i&&i(e,t)}},n._setEvent(t)),d().createElement("span",null,e.name))}):d().createElement("div",{className:"noData"},"无数据"))))))},e}(a.Component);r.defaultProps={placeholder:"请选择",list:[{name:"周",id:"week"},{name:"月",id:"month"}],value:{}},r.propTypes={placeholder:t().oneOfType([t().string,t().element]),list:t().array,value:t().object,onChange:t().func,style:t().object,partingLine:t().bool}}}]);