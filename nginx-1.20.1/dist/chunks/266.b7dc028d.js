"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[266],{634:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(94578),o=n(43036),r=n(45697),i=n.n(r),l=n(67294),c=n(39432),s=function(e){function t(t){var n;return(n=e.call(this,t)||this).getPanelWidth=function(){var e=n.props,t=e.flavor,a=e.options,o=e.rightHook,r=Math.max.apply(null,a.map((function(e){return(0,c.jD)(e.title,14)})))+2+10+32;return r+=void 0!==t?24:0,(r+=void 0!==o?30:0)>100?r:100},n._setPadShowFalse=function(){n.state.show&&n.setState({show:!1})},n._handleParentClick=function(e){n.state.show&&n.props.showFlavor&&n.props.enable&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},n._handleTriggerOnClick=function(){var e=n.state.show;n.props.enable&&setTimeout((function(){n.setState({show:!e})}),0)},n.state={show:!1,firstLiHover:!1,panelWidth:n.getPanelWidth()},n}(0,a.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){window.addEventListener("click",this._setPadShowFalse)},n.componentWillUnmount=function(){window.removeEventListener("click",this._setPadShowFalse)},n.componentDidUpdate=function(e){var t=e.options,n=this.props.options;JSON.stringify(t)!==JSON.stringify(n)&&this.setState({panelWidth:this.getPanelWidth()})},n.render=function(){var e=this.state,t=e.show,n=e.panelWidth,a=this.props,r=a.activeObj,i=a.onChange,c=a.options,s=a.objName,u=a.preTitle,p=a.sufTitle,d=void 0===p?"":p,m=a.showTitle,h=void 0===m||m,f=a.overlay,g=a.divider,v=void 0===g?"right":g,y=a.flavor,b=a.className,E=void 0===b?"":b,k=a.onFlavorChange,C=a.sufIcon,w=a.style,N=a.type,_=void 0===N?"text":N,S=a.enable,Z=a.rightHook,I=c.find((function(e){return e.value===r})),W=void 0===typeof r?d:I&&I.title,O=void 0===typeof r?d:I&&I.icon;return l.createElement("div",{className:"single_select_button_wrapper single_select_diviver_"+v+" single-select-button_"+_+" "+E,style:w,onClick:this._handleParentClick},l.createElement("div",{className:"button_content "+(S?"":"button_content_disable")},l.createElement("span",{onClick:this._handleTriggerOnClick},l.createElement("span",{className:"button-trigger "+(t?"sel":"")},h&&l.createElement(l.Fragment,null,u&&l.createElement("span",{className:"pre-title"},u,"\uff1a"),O?l.createElement("i",{className:O+" word_icon_hover"}):l.createElement("span",{className:"button-title"},W)),l.createElement("i",{className:C||"icon-cem_pull-down-or-take-up",style:{transform:t?"rotate(-180deg)":""}})),f&&l.createElement("span",{style:{marginLeft:4}},l.createElement(o.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:f},l.createElement("i",{className:"icon-cem_file1"})))),l.createElement("div",{className:"button-panel "+(t?"active":""),style:{minWidth:n}},c.map((function(e,t){return l.createElement("div",{className:"panel-item "+(e.value===r?"sel":"")+" "+(e.disabled?"disabled":""),key:e.value,onClick:function(){var t;!e.disabled&&i(s?((t={})[s]=e.value,t):e.value)}},e.icon&&l.createElement("i",{className:e.icon+" panel-item-icon"}),l.createElement("span",{className:"ellipsis",style:{maxWidth:97.5}},e.title),void 0!==y&&l.createElement("i",{className:y===e.value?"icon-cem_star":"icon-cem_star-filling star_hide",onClick:function(t){var n,a,o;t.stopPropagation(),k(y===e.value?s?((n={})[s]="",n):"":s?((a={})[s]=e.value,a):e.value),i(s?((o={})[s]=e.value,o):e.value)}}),l.createElement("i",{className:e.value===r&&Z?"icon-cem_right1 choice":""}))})))))},t}(l.PureComponent);s.defaultProps={enable:!0,activeObj:"",sufTitle:"",showTitle:!0,divider:"right",className:"",type:"text"},s.propTypes={activeObj:i().any,onChange:i().func.isRequired,options:i().array.isRequired,objName:i().any,preTitle:i().string,sufTitle:i().string,showTitle:i().bool,overlay:i().string,divider:i().oneOf(["both","left","right","none"]),flavor:i().string,onFlavorChange:i().func,className:i().string,sufIcon:i().string,style:i().object,type:i().oneOf(["button","text"]),enable:i().bool,rightHook:i().bool};const u=s},60266:(e,t,n)=>{n.r(t),n.d(t,{default:()=>H});var a=n(63366),o=n(87462),r=n(94578),i=n(67294),l=n(55609),c=n(35239),s=(n(1025),n(65400)),u=(n(89858),n(51024)),p=(n(48145),n(40987)),d=(n(43378),n(62443)),m=(n(53294),n(56697)),h=n(55815),f=n(96889),g=[{title:"\u5168\u90e8",value:"ALL"},{title:"\u98de\u4e66",value:"FEISHU"},{title:"\u9489\u9489",value:"DINGDING"}],v=n(30381),y=n.n(v),b=n(68855),E=n(634),k=(n(29809),n(97538)),C=(n(35797),n(64749)),w=n(15861),N=(n(75314),n(11187)),_=n(23279),S=n.n(_),Z=n(87757),I=n.n(Z),W=n(64396),O=["loading"],x=W.Z.project.weebhook,F=[{label:"\u98de\u4e66",value:"FEISHU"},{label:"\u9489\u9489",value:"DINGDING"}],L=function(e){function t(t){var n;return(n=e.call(this,t)||this).formRef=void 0,n.originState=void 0,n.show=function(e){n.setState((0,o.Z)({visible:!0},e),(function(){var t;null==(t=n.formRef)||t.setFieldsValue((0,o.Z)({},e))}))},n.onConfirm=function(){var e,t,a,r=n.state.id,i=null==(e=n.formRef)?void 0:e.getFieldValue("name"),l=null==(t=n.formRef)?void 0:t.getFieldValue("url");""!==i.trim()?""!==l.trim()?null==(a=n.formRef)||a.validateFields().then(function(){var e=(0,w.Z)(I().mark((function e(t){var a,i,l;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.type,a=t.name,i=t.url,l=t.verificationKey,e.next=3,n.props.fetchOperateChange((0,o.Z)({id:r},t,{name:a.trim(),url:i.trim(),verificationKey:l&&l.trim(),projectId:c.t.get(c.V.backProjectConfig).id}));case 3:e.sent&&n.onCancel();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):N.default.error("\u8bf7\u8f93\u5165\u6b63\u786e\u7684webhook\u5730\u5740"):N.default.error("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u540d\u79f0")},n.onCancel=function(){var e;null==(e=n.formRef)||e.resetFields(),n.setState((0,o.Z)({},Object.assign({},n.originState)),(function(){var e;null==(e=n.formRef)||e.setFieldsValue({name:n.originState.name,type:n.originState.type,url:n.originState.url,verificationKey:n.originState.verificationKey})}))},n.urlCheck=S()((function(e,t){n.props.webhookUrlCheck({url:e}).then((function(e){e?t():t("\u8be5\u5730\u5740\u5df2\u6dfb\u52a0\u8fc7\uff0c\u8bf7\u6dfb\u52a0\u5176\u4ed6\u5730\u5740")}))}),500),n.originState={visible:!1,type:"FEISHU",id:void 0,name:"",url:"",verificationKey:""},n.state=(0,o.Z)({},Object.assign({},n.originState)),n}return(0,r.Z)(t,e),t.prototype.render=function(){var e=this,t=this.state,n=t.visible,a=t.id,o=t.type,r=t.name,l=t.url,c=t.verificationKey,s=this.props.ref;return i.createElement(m.Z,{className:"yt_project_weebhook_edit_modal",width:560,title:(a?"\u7f16\u8f91":"\u6dfb\u52a0")+"Webhook",visible:n,onCancel:this.onCancel,onOk:this.onConfirm,ref:s},i.createElement(k.Z,{ref:function(t){return e.formRef=t},labelCol:{span:5},wrapperCol:{span:17},initialValues:{name:r,type:o,url:l,verificationKey:c}},i.createElement(k.Z.Item,{label:"\u7c7b\u578b",name:"type"},i.createElement(C.default,{placeholder:"\u8bf7\u9009\u62e9\u7c7b\u578b",options:F,disabled:void 0!==a,style:{width:300,height:28}})),i.createElement(k.Z.Item,{label:"\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u540d\u79f0"},{type:"string",max:20,message:"\u540d\u79f0\u4e0d\u80fd\u8d85\u8fc720\u4e2a\u5b57"}]},i.createElement(u.default,{placeholder:"\u8bf7\u8f93\u5165",style:{width:300,height:28}})),i.createElement(k.Z.Item,{label:"Webhook\u5730\u5740",name:"url",rules:a?[{required:!0,message:"\u8bf7\u8f93\u5165Webhook\u5730\u5740"}]:[{required:!0,message:"\u8bf7\u8f93\u5165Webhook\u5730\u5740"},{validator:function(t,n,a){e.urlCheck(n,a)}}]},i.createElement(u.default,{placeholder:"\u4ece\u7b2c\u4e09\u65b9\u7cfb\u7edf\u83b7\u53d6Webhook\u5e76\u586b\u5199\u5230\u6b64\u5904",disabled:void 0!==a,style:{width:300,height:28}})),i.createElement(k.Z.Item,{label:"\u6821\u9a8c\u5bc6\u94a5",name:"verificationKey"},i.createElement(u.default,{placeholder:"\u4ece\u7b2c\u4e09\u65b9\u7cfb\u7edf\u83b7\u53d6\u5bc6\u94a5\u5e76\u586b\u5199\u5230\u6b64\u5904",style:{width:300,height:28}}))))},t}(i.Component);const P=(0,l.connect)((function(e){e.loading;var t=(0,a.Z)(e,O);return(0,o.Z)({},t[x])}),(function(e){return{fetchOperateChange:function(t){return e({type:x+"/fetchOperateChange",payload:t})},webhookUrlCheck:function(t){return e({type:x+"/webhookUrlCheck",payload:t})}}}),null,{withRef:!0})(L);const j=function(e){function t(t){var n;return(n=e.call(this,t)||this).modalRef=void 0,n.onSwitchChange=function(e,t){m.Z.confirm({icon:i.createElement(b.Z,{style:{fontSize:"20px",color:"#FF7955"}}),title:e?"\u542f\u7528":"\u505c\u7528",content:e?"\u542f\u7528\u540e\uff0c\u4f5c\u4e3a\u901a\u77e5\u63a8\u9001\u65b9\u5f0f\uff0c\u53ef\u5728\u89c4\u5219\u914d\u7f6e\u4e2d\u52fe\u9009\u8be5Webhook\u5730\u5740":"\u505c\u7528\u540e\uff0c\u4e0d\u518d\u5411\u8be5Webhook\u5730\u5740\u53d1\u901a\u77e5",onOk:function(){n.props.onStatusChange({id:t,status:e?"ENABLE":"DISABLE"})}})},n.onDelete=function(e){m.Z.confirm({icon:i.createElement(b.Z,{style:{fontSize:"20px",color:"#FF7955"}}),title:"\u5220\u9664",content:"\u5220\u9664\u540e\uff0c\u4e0d\u518d\u5411\u8be5Webhook\u5730\u5740\u53d1\u9884\u8b66\u901a\u77e5\uff0c\u662f\u5426\u786e\u8ba4\u5220\u9664",onOk:function(){n.props.onStatusChange({id:e,status:"DELETED"})}})},n.state={columns:[{title:"",width:"1%"},{title:"\u7c7b\u578b",dataIndex:"type",width:"9%",render:function(e){return i.createElement("span",null,e?"DINGDING"===e?"\u9489\u9489":"\u98de\u4e66":"")}},{title:"\u540d\u79f0",dataIndex:"name",width:"15%",render:function(e){return i.createElement("span",{className:"ellipsis"},e)}},{title:"Webhook\u5730\u5740",dataIndex:"url",width:"38%",render:function(e){return i.createElement("span",null,e)}},{title:"\u6700\u8fd1\u4fee\u6539\u65f6\u95f4",dataIndex:"updatedAt",width:"12%",render:function(e,t){return i.createElement(d.default,{content:t.updator,mouseEnterDelay:.4,getPopupContainer:function(e){return e.parentNode}},y()(e).format("YYYY/MM/DD HH:mm"))}},{title:"\u662f\u5426\u542f\u7528",dataIndex:"status",width:"12%",render:function(e,t){return i.createElement(d.default,{content:"ENABLE"===e?"\u5df2\u542f\u7528":"\u5df2\u505c\u7528",mouseEnterDelay:.4,getPopupContainer:function(e){return e.parentNode}},i.createElement(p.Z,{checked:"ENABLE"===e,onChange:function(e){return n.onSwitchChange(e,t.id)}}))}},{title:"\u64cd\u4f5c",width:"16%",dataIndex:"operate",render:function(e,t){return i.createElement("span",{className:"operate"},i.createElement("span",{onClick:function(){n.modalRef.wrappedInstance.show((0,o.Z)({},t))}},"\u7f16\u8f91"),i.createElement("span",{onClick:function(){return n.onDelete(t.id)}},"\u5220\u9664"))}}]},n}return(0,r.Z)(t,e),t.prototype.render=function(){var e,t=this,n=this.state.columns,a=this.props,r=a.loading,l=a.weebhookList,p=a.total,m=a.pageIndex,v=a.pageSize,y=a.name,b=a.type,k=a.onFilterChange,C=a.save;return i.createElement("div",{className:"yt_project_weebook_wrapper"},i.createElement(h.Z,{title:(e={title:"Webhook\u7ba1\u7406"},[{title:c.t.get(c.V.backProjectConfig).name,url:"/account/project/preview"},{title:e.title,url:e.url}])}),i.createElement("div",{className:"container"},i.createElement("div",{className:"content"},i.createElement("div",{className:"table_top"},i.createElement("div",null,i.createElement(u.default,{placeholder:"\u8bf7\u8f93\u5165\u540d\u79f0",allowClear:!0,suffix:i.createElement("i",{className:"icon-cem_small-search",onClick:function(){return k({name:y})}}),onPressEnter:function(){return k({name:y})},onChange:function(e){C({name:e.target.value}),""===e.target.value&&k({name:e.target.value})},value:y,style:{height:28,width:160}}),i.createElement(E.Z,{options:g,onChange:function(e){return k({type:e})},preTitle:"\u7c7b\u578b",divider:"none",type:"button",activeObj:b,sufIcon:"icon-cem_pull-down-or-take-up"})),i.createElement("div",null,i.createElement(s.default,{type:"primary",key:"btn_add",onClick:function(){t.modalRef.wrappedInstance.show()}},"\u6dfb\u52a0Webhook"),i.createElement(d.default,{key:"pop_tips",placement:"topRight",content:i.createElement("div",{style:{fontSize:12,maxWidth:200}},"\u7cfb\u7edf\u4f1a\u5411\u6307\u5b9aWebhook\u5730\u5740\u53d1\u9001\u9884\u8b66\u901a\u77e5\u3002\u6dfb\u52a0Webhook\u5e76\u586b\u5165\u76f8\u5e94\u7684Webhook\u5730\u5740\u5373\u53ef\u4f5c\u4e3a\u9884\u8b66\u901a\u77e5\u63a8\u9001\u65b9\u5f0f\u3002\u5173\u4e8eWebhook\u7684\u4f7f\u7528\uff0c\u8be6\u60c5\u53c2\u8003\u5e2e\u52a9\u6587\u6863",i.createElement("a",{href:"https://skieer.feishu.cn/docs/doccnIIHlpLFpqW9gkgg8NvYYJg",style:{color:"#1890FF"}},"Webhook"))},i.createElement("i",{className:"icon-cem_file1",style:{fontSize:14,color:"#979797",marginLeft:8,paddingRight:12}})))),i.createElement(f.ZP,{tableLayout:"fixed",loading:r,dataSource:l,columns:n,rowKey:"id",search:!1,options:!1,tableAlertRender:!1,toolBarRender:!1,pagination:{total:p,current:m,pageSize:v},onChange:function(e){v!==e.pageSize?k((0,o.Z)({},e,{pageIndex:1})):k((0,o.Z)({},e,{pageIndex:e.current}))}}))),i.createElement(P,{ref:function(e){return t.modalRef=e}}))},t}(i.Component);var R=["loading"],T=W.Z.project.weebhook,D=function(e){function t(t){var n;return(n=e.call(this,t)||this).events=void 0,n._handleOnFilterChange=function(e){e.type||e.pageIndex||e.pageSize?n.props.fetchWeebhookList((0,o.Z)({},e,{name:n.props.name,pageIndex:e.pageIndex||1})):void 0!==e.name&&n.props.fetchWeebhookList({name:e.name,pageIndex:1})},n._handleOnStatusChange=function(e){n.props.fetchStatusChange(e)},n.state={},n.events={onFilterChange:n._handleOnFilterChange,onStatusChange:n._handleOnStatusChange},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.fetchWeebhookList({projectId:c.t.get(c.V.backProjectConfig).id,pageIndex:1,pageSize:10})},n.render=function(){return i.createElement(j,(0,o.Z)({},this.props,this.state,this.events))},t}(i.PureComponent);const H=(0,l.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,R);return(0,o.Z)({},n[T],{loading:t.effects[T+"/fetchWeebhookList"]||!1})}),(function(e){return{save:function(t){return e({type:T+"/save",payload:t})},clean:function(){return e({type:T+"/clean"})},fetchWeebhookList:function(t){return e({type:T+"/fetchWeebhookList",payload:t})},fetchStatusChange:function(t){return e({type:T+"/fetchStatusChange",payload:t})},fetchOperateChange:function(t){return e({type:T+"/fetchOperateChange",payload:t})},webhookUrlCheck:function(t){return e({type:T+"/webhookUrlCheck",payload:t})}}}))(D)},55815:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(94578),o=n(67294),r=n(45697),i=n.n(r),l=n(43036),c=n(61409),s=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props,a=n.title,o=n.beforeJump;e!==a.length-1&&(o?new Promise((function(e,t){return o(e,t)})).then((function(){c.mW.push({pathname:a[e].url,state:a[e].state})})):c.mW.push({pathname:a[e].url,state:a[e].state}))},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.mainTitle,r=t.rightContent,i=t.className,c=t.overlay;return o.createElement("div",{className:"breadcumb-wrapper "+i},n instanceof Array?o.createElement("div",{className:"breadcrumb-left"},o.createElement("div",null,n.map((function(t,a){return o.createElement("span",{className:t.url?"":"not_clickable",key:a,onClick:function(){return t.url&&a!==n.length-1&&e._handleBreadcrumbClick(a)}},t.title,a!==n.length-1&&" / ")}))),o.createElement("span",null,a||n[n.length-1].title,c&&o.createElement(l.Z,{placement:"top",overlay:c},o.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}})))):o.createElement("div",{className:"normal-title"},n,c&&o.createElement(l.Z,{placement:"top",overlay:c},o.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}}))),r||"")},t}(o.Component);s.propTypes={className:i().string,title:i().oneOfType([i().string,i().arrayOf(i().shape({title:i().string,url:i().string,state:i().object}))]).isRequired,overlay:i().oneOfType([i().string,i().node]),mainTitle:i().oneOfType([i().string,i().node]),beforeJump:i().func,rightContent:i().node};const u=s}}]);