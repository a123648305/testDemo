"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[5958],{25958:(e,t,n)=>{n.r(t),n.d(t,{default:()=>$});var a=n(63366),o=n(87462),r=n(94578),i=n(67294),s=n(55609),c=n(17051),l=n(99543),p=n(50196),d=n(41192),u=n(60496),h=n(43144),m=n(45697),f=n.n(m),g=n(39432),y=function(e){function t(t){var n;(n=e.call(this,t)||this).inputChange=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),n.setState({searchKeyWords:e.target.value,isShow:!1})},n.keywordChange=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),"keydown"===e.type&&13===e.keyCode&&n.handleCompareClick(n.props.options.find((function(e){return e.value.toLocaleLowerCase()===n.state.searchKeyWords.trim().toLocaleLowerCase()}))),n.setState({isShow:!1})},n._setPadShowFalse=function(){n.state.show&&n.setState({show:!1})},n._handleOnClick=function(e){var t=n.state.show;t&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()),setTimeout((function(){n.setState({show:!t})}),0)},n.handleProductClick=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();var t=n.props.onChange;!n.state.disabled&&t({productCompare:""}),n.setState({searchKeyWords:"",productTitle:"\u65e0"})},n.handleCompareClick=function(e){var t,a=n.props,o=a.onChange,r=a.objName,i=n.props.options;i=i.filter((function(t){return t.value===e})),n.setState({isShow:!0,productTitle:e.value}),!e.disabled&&o(r?((t={})[r]=e.value,t):e.value)};var a=Math.max.apply(null,t.options.map((function(e){return(0,g.jD)(e.title,14)})))+16+2;return n.state={show:!1,firstLiHover:!1,panelWidth:a>100?a:100,isDisabled:!1,searchKeyWords:"",isShow:!0,productTitle:"\u65e0"},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){window.addEventListener("click",this._setPadShowFalse)},n.componentWillUnmount=function(){window.removeEventListener("click",this._setPadShowFalse)},n.render=function(){var e=this,t=this.state,n=t.show,a=t.panelWidth,o=t.searchKeyWords,r=t.isShow,s=t.productTitle,c=this.props,l=c.activeObj,p=void 0===l?"":l,d=c.objName,u=c.preTitle,h=c.sufTitle,m=void 0===h?"":h,f=c.showTitle,g=void 0===f||f,y=this.props.options,v=y.find((function(e){return e.value===p})),C=""===p?m:v&&v.title;return y=this.searchList!==[]?this.searchList:y.filter((function(e){return e.value!==s})),i.createElement("div",{className:"co-single-select-button-wrapper",onClick:this._handleOnClick},i.createElement("span",{className:"button-trigger "+(n?"sel":"")},g&&i.createElement(i.Fragment,null,u&&i.createElement("span",{className:"pre-title"}," ",u,"\uff1a "),i.createElement("span",{className:"button-title"}," ",C," ")),i.createElement("i",{className:"icon-cem_arrow-launches",style:{transform:n?"rotate(-180deg)":""}})),i.createElement("div",{className:"button-panel "+(n?"active":""),style:{minWidth:a}},"productCompare"===d&&i.createElement("div",{className:"search"},i.createElement("input",{value:o,placeholder:"\u8bf7\u8f93\u5165\u5173\u952e\u8bcd",type:"text",onChange:this.inputChange,onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},onKeyDown:this.keywordChange}),r&&y&&i.createElement("i",{className:"icon-cem_search",onClick:function(t){t.stopPropagation(),t.nativeEvent.stopImmediatePropagation(),e.handleCompareClick(e.props.options.find((function(t){return t.value.toLocaleLowerCase()===e.state.searchKeyWords.trim().toLocaleLowerCase()})))}}),!r&&""!==o&&y&&i.createElement("i",{className:"icon-cem_close-window",onClick:function(t){t.stopPropagation(),t.nativeEvent.stopImmediatePropagation(),e.setState({searchKeyWords:"",isShow:!0})}})),i.createElement("div",{style:{overflow:"auto",maxHeight:206,marginTop:16}},r&&"productCompare"===d&&i.createElement("p",{className:"product"},s,"\u65e0"!==s&&i.createElement("i",{className:"icon-cem_cancel",onClick:this.handleProductClick})),y.map((function(t,n){return i.createElement("div",{className:"panel-item",key:t.value,onClick:function(){e.handleCompareClick(t)},style:{display:t.title===s?"none":"block"}},t.title)})))))},(0,h.Z)(t,[{key:"searchList",get:function(){var e=this;return this.props.options.filter((function(t){return-1!==t.value.toLocaleLowerCase().indexOf(e.state.searchKeyWords.trim().toLocaleLowerCase())}))}}]),t}(i.PureComponent);y.propTypes={activeObj:f().any,onChange:f().func.isRequired,options:f().array.isRequired,objName:f().string.isRequired,preTitle:f().string,sufTitle:f().string,showTitle:f().bool};const v=y;var C=n(50976),w=n(71339);const E=function(e){var t=e.option,n=e.data,a=e.loading,o=e.product,r=i.useState(1),s=r[0],c=r[1],l=i.useState(10),p=l[0],d=l[1],u=i.useState([]),h=u[0],m=u[1];i.useEffect((function(){m(n.slice(0,p)),c(1)}),[p,t.aspectType]),i.useEffect((function(){if(n&&n instanceof Array){var e=(s-1)*p,t=s*p;m(n.slice(e,t))}}),[n,s,o]);var f=function(e,t,n){var a=e-5-24-40-32;return t&&1===t.length?[{label:"",width:16},{label:"\u6392\u5e8f",width:.3*a,render:function(e,t,n){return n+1}},{label:"\u5173\u6ce8\u70b9",width:.3*a,prop:"name"},{label:"\u6570\u91cf",width:.3*a,prop:"value"},{label:"\u5360\u6bd4",width:.1*a,prop:"precent",render:function(e){return(100*e.precent).toFixed(2)+"%"}},{label:"",width:16}]:t&&2===t.length?[{label:"",width:16},{label:"\u6392\u5e8f",width:.12*a,render:function(e,t,n){return n+1}},{label:"\u5173\u6ce8\u70b9",width:.16*a,prop:"name"},{label:t[0]+"\u6570\u91cf",width:.18*a,prop:"value"},{label:t[0]+"\u5360\u6bd4",width:.18*a,prop:"precent",render:function(e){return(100*e.precent).toFixed(2)+"%"}},{label:t[1]+"\u6570\u91cf",width:.18*a,prop:"value2",render:function(e,t,a){return n[a].value2}},{label:t[1]+"\u5360\u6bd4",width:.18*a,prop:"precent2",render:function(e,t,a){return(100*n[a].precent2).toFixed(2)+"%"}},{label:"",width:16}]:void 0}(t.width,o,h);return i.createElement("div",{className:"yt-aspect-table-wrapper",style:t.style},i.createElement(w.Z,{data:h,loading:a,option:t,columns:f,total:n.length,pageIndex:s,pageSize:p,onPageSizeChange:d,onPageChange:c}))};var S=n(8201),b=n(53754),T=n(43036),x=n(22120),P=n(98191),N=n(70715);var k=[{title:"\u5bfc\u51fa\u56fe\u7247",type:"image"},{title:"\u5bfc\u51fa\u6570\u636e",type:"data"}],D=[{title:"\u6570\u91cf",value:"NUMBER"},{title:"\u6bd4\u4f8b",value:"RATIO"}],O=[{title:"\u4e00\u7ea7\u5173\u6ce8\u70b9",value:"ASPECT1"},{title:"\u4e8c\u7ea7\u5173\u6ce8\u70b9",value:"ASPECT2"}],L={c0:["cem_histogram-gray","cem_histogram-colour","\u5bf9\u6bd4\u67f1\u72b6\u56fe"],c1:["cem_bar-type","cem_bar-chart-col","\u5bf9\u6bd4\u6761\u5f62\u56fe"],c2:["cem_form-new","cem_form-new-col","\u8868\u683c"]};const A=function(e){var t=e.title,n=e.data,a=e.onMoreClick,o=e.loading,r=e.aspectType,s=e.formulaType,c=e.productCompare,l=e.productOptions,p=e.onFilterChange,h=e.contentWidth,m=e.onChartClick,f=e.conPosition,y=e.onConPositionChange,w=i.useState("c0"),A=w[0],_=w[1],I=i.useState(void 0),R=I[0],Z=I[1],F=i.useState(s),W=F[0],M=F[1],j="c2"===A?k.slice(1):k;return i.useEffect((function(){if(R&&"c2"!==A)if((0,S.P)(n)){var e="c0"===A?function(e,t,n,a){void 0===n&&(n="NUMBER"),void 0===a&&(a="ASPECT1");var o=e.chartData,r=e.title,i=e.dataType,s=e.product,c=Array.from({length:o.length}),l=o.source[0],p=.8*t/(63*l.length),d=(0,g.jD)(l.join(""),12)/(.6*t)>1;return{title:{text:r,textStyle:{fontSize:14}},color:["#1574B3","#A1C7E1"],dataset:c.map((function(e,t){return{dimensions:o.dimensions,sourceHeader:!1,source:o.source}})),grid:c.map((function(){return{show:!1,left:24,right:24,top:80,bottom:d?60:p<1?50:30,containLabel:!0}})),tooltip:{trigger:"axis",axisPointer:{type:"none"},formatter:function(e){return("ASPECT2"===a?2===e.length?[e[0]]:4===e.length?[e[0],e[2]]:e:e).reduce((function(e,t,a){var o=t.marker,r=t.data,i=t.dimensionNames[2*a+1],s=r[2*a+1],c=r[2*a+2],l=s,p="\u6570\u91cf",d=i.substring(0,i.lastIndexOf("-"));return"RATIO"===n&&(l=0===c?0:(100*c).toFixed(2)+"%",p="\u6bd4\u4f8b"),[].concat(e,[o+" "+d+"\u5173\u6ce8\u70b9"+p+"\uff1a"+l])}),[e[0].name]).join("<br/>")}},legend:{left:16,top:40,itemWidth:12,itemHeight:12,data:s.map((function(e){return{name:e,icon:N.W4.square}}))},dataZoom:{show:p<1,type:"slider",xAxisIndex:c.map((function(e,t){return t})),start:0,end:(100*p).toFixed(0)-0,height:20,handleSize:"100%",showDelay:!1},xAxis:c.map((function(e,t){return{type:"category",gridIndex:t,show:0===t,triggerEvent:"aspect"===i,axisTick:{show:0===t,alignWithLabel:!0},axisLabel:{interval:0,rotate:d?45:0,margin:d?15:8,formatter:function(e){return e.length>6?e.substring(0,5)+"...":e}}}})),yAxis:c.map((function(e,t){return{max:"NUMBER"===n?parseInt(1.05*o.max):1,type:"value",gridIndex:t,show:0===t,axisLabel:{formatter:function(e){return 0===e?0:"RATIO"===n&&e<=1?(100*e).toFixed(0)+"%":e}}}})),series:c.map((function(e,t){return{type:"bar",name:s[t],zlevel:o.length-t,yAxisIndex:t,xAxisIndex:t,seriesLayoutBy:"row",datasetIndex:t,encode:{x:0,y:2*t+("NUMBER"===n?1:2)},barMaxWidth:1===o.length||0===t?24:36}}))}}(n,R.getWidth(),W,r):function(e,t,n,a){void 0===n&&(n="NUMBER"),void 0===a&&(a="ASPECT1");var o=e.chartData,r=e.title,i=e.dataType,s=e.product,c=.6*t/(60*o.source[0].length),l=c<1,p=Array.from({length:o.length});return{title:{text:r},color:["#1574B3","#A1C7E1"],dataset:p.map((function(e,t){return{dimensions:o.dimensions,sourceHeader:!1,source:o.source}})),tooltip:{trigger:"axis",axisPointer:{type:"line"},formatter:function(e){return("ASPECT2"===a?2===e.length?[e[0]]:4===e.length?[e[0],e[2]]:e:e).reduce((function(e,t,a){var o=t.marker,r=t.data,i=t.dimensionNames[2*a+1],s=r[2*a+1],c=r[2*a+2],l=s,p="\u6570\u91cf",d=i.substring(0,i.lastIndexOf("-"));return"RATIO"===n&&(l=0===c?0:(100*c).toFixed(2)+"%",p="\u6bd4\u4f8b"),[].concat(e,[o+" "+d+"\u5173\u6ce8\u70b9"+p+"\uff1a"+l])}),[e[0].name]).join("<br/>")}},dataZoom:[{show:l,type:"slider",yAxisIndex:0,left:20,start:0,end:(100*c).toFixed(0)-0,width:20,handleSize:"100%",showDelay:!1}],grid:{show:!1,left:l?50:24,right:24,top:80,bottom:30,containLabel:!0},legend:{left:16,top:40,itemWidth:12,itemHeight:12,data:s.map((function(e){return{name:e,icon:N.W4.square}}))},xAxis:{type:"value",max:"NUMBER"===n?parseInt(1.05*o.max):1,axisLabel:{formatter:function(e){return 0===e?0:"RATIO"===n&&e<=1?(100*e).toFixed(0)+"%":e}}},yAxis:{type:"category",inverse:!0,triggerEvent:"aspect"===i},series:p.map((function(e,t){return{type:"bar",name:s[t],seriesLayoutBy:"row",datasetIndex:t,encode:{x:2*t+("NUMBER"===n?1:2),y:0},barMaxWidth:24}}))}}(n,R.getHeight(),W,r);R.clear(),R.setOption(e)}else Z(void 0)}),[n,R,A,W]),i.createElement(S.Z,{data:n,className:"yt-product-bar-table-wrapper",renderTitle:i.createElement(P.Z,{data:n,title:"c2"!==A?t:"",onMoreClick:function(e){return function(e,t,n,a){var o=void 0;if("image"===t)o=e;else if("data"===t){var r=JSON.parse(JSON.stringify(n.chartData.source));["product"===n.dataType?"\u4ea7\u54c1":"\u5173\u6ce8\u70b9","\u4f1a\u8bdd\u6570\u91cf"].map((function(e,t){return r[t].splice(0,0,e)})),o=[r]}a({type:t,obj:o,name:e.getOption().title[0].text})}(R,e,n,a)},moreOptions:j},"c2"!==A&&W&&i.createElement(u.Z,{preTitle:"\u516c\u5f0f",onChange:function(e){var t=e.formulaType;M(t)},objName:"formulaType",activeObj:W,options:D,data:n,aspectType:r}),i.createElement("i",null,void 0!==c&&i.createElement(v,{preTitle:"\u5bf9\u6bd4\u5546\u54c1",sufTitle:"\u8bf7\u9009\u62e9",onChange:p,objName:"productCompare",activeObj:c,options:l})),r&&i.createElement(u.Z,{onChange:p,objName:"aspectType",activeObj:r,options:O}),f&&i.createElement("div",{className:"con-position"},i.createElement(b.Z,{type:1,title:"\u4f1a\u8bdd\u4f4d\u7f6e",options:x.R,value:f,onChange:y}),i.createElement(T.Z,{placement:"top",overlay:"\u7531\u4e8e\u5ba2\u6237\u4ece\u67d0\u4e2a\u5546\u54c1\u94fe\u63a5\u8fdb\u5165\u963f\u91cc\u65fa\u65fa\u7b49\u54a8\u8be2\u804a\u5929\u7a97\u53e3\u540e\uff0c\u4e0d\u4e00\u5b9a\u662f\u54a8\u8be2\u8be5\u5546\u54c1\u3002\u4e3a\u4e86\u63d0\u9ad8\u4e1a\u52a1\u5206\u6790\u7684\u7075\u6d3b\u6027\uff0c\u8fd9\u91cc\u5c06\u201c\u5546\u54c1\u201d\u5728\u4f1a\u8bdd\u4e2d\u7684\u4f4d\u7f6e\u505a\u533a\u5206\uff0c\u4f9b\u7528\u6237\u5207\u6362",overlayClassName:"restricted-width-pop"},i.createElement("i",{className:"icon-cem_problem-new"}))),i.createElement(d.Z,{onChange:_,chartType:A,options:L}))},n&&i.createElement(i.Fragment,null,i.createElement(C.Z,{theme:"yunting_multi_color",option:{},style:{width:"100%",height:375,display:"c2"===A?"none":"block"},onEvents:{click:m},onChartReady:function(e){return Z(e)}}),i.createElement(E,{option:{aspectType:r,width:h,style:{display:"c2"===A?"block":"none",paddingTop:40}},product:n.product,data:n.tableData,loading:o})))};function _(e){var t=e.filter((function(e){return e.self}));t.sort((function(e,t){return e.count-t.count}));var n=e.filter((function(e){return!e.self}));return n.sort((function(e,t){return e.count-t.count})),[].concat(n,t)}var I=function(e){function t(t){var n;return(n=e.call(this,t)||this).toggleShow=function(e){var t=n.state,a=t.selfShow,o=t.othersShow,r=t.data,i=[];if(1===e){r.forEach((function(e){(!a&&e.self||o&&!e.self)&&i.push(e)}));var s=i.length>10?100-10/i.length*100:0;n.setState({selfShow:!a,filteredData:_(i),start:s},(function(){return n.resetChart()}))}else{r.forEach((function(e){(a&&e.self||!o&&!e.self)&&i.push(e)}));var c=i.length>10?100-10/i.length*100:0;n.setState({othersShow:!o,filteredData:_(i),start:c},(function(){return n.resetChart()}))}},n.resetChart=function(){var e=n.state,t=e.filteredData,a=e.start,o=e.selfShow,r=e.othersShow,i={tooltip:{trigger:"item",formatter:function(e){return""+e.marker+e.name+"\uff1a"+e.value}},grid:{show:!1,left:t.length>10?48:20,right:32,top:60,bottom:14,containLabel:!0},graphic:{type:"group",left:0,top:24,children:[{type:"rect",shape:{width:12,height:12},style:{fill:o?"#1574B3":"#CCCCCC"},cursor:"pointer",onclick:function(){return n.toggleShow(1)}},{type:"text",left:20,top:2,style:{text:"\u672c\u54c1",fill:o?"#262626":"#CCCCCC"},cursor:"pointer",onclick:function(){return n.toggleShow(1)}},{type:"rect",left:60,shape:{width:12,height:12},style:{fill:r?"#A1C7E1":"#CCCCCC"},cursor:"pointer",onclick:function(){return n.toggleShow(2)}},{type:"text",left:80,top:2,style:{text:"\u7ade\u54c1",fill:r?"#262626":"#CCCCCC"},cursor:"pointer",onclick:function(){return n.toggleShow(2)}}]},xAxis:{type:"value"},yAxis:{type:"category",data:t.map((function(e){return e.name}))},series:[{name:"\u672c\u54c1",type:"bar",barMaxWidth:20,data:t.map((function(e){return{name:e.name,value:e.count,itemStyle:{color:e.self?"#1574B3":"#A1C7E1"}}}))}],dataZoom:{show:t.length>10,type:"slider",showDetail:!1,yAxisIndex:[0],width:20,left:0,filterMode:"filter",start:a,end:100}};n.instance.clear(),n.instance.setOption(i)},n.state={data:t.data,filteredData:_(t.data),start:t.data.length>10?100-10/t.data.length*100:0,selfShow:!0,othersShow:!0},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.instance=this.chart.getEchartsInstance(),this.resetChart()},n.render=function(){var e=this,t=this.props.onChartClick;return i.createElement(C.Z,{ref:function(t){return e.chart=t},option:{},theme:"yunting_neg_pos",style:{width:"100%",height:"353px"},onEvents:{click:t}})},t}(i.Component);I.propTypes={data:f().array.isRequired};var R=function(e){function t(t){var n;return(n=e.call(this,t)||this).resetChart=function(){var e=n.state.data,t={tooltip:{trigger:"item",formatter:function(e){return""+e.marker+e.name+"\uff1a"+e.value}},xAxis:{type:"value"},yAxis:{type:"category",data:e.map((function(e){return e.name}))},series:[{type:"treemap",top:25,left:0,right:0,bottom:0,label:{formatter:"{b}\n{@c}",lineHeight:14},nodeClick:!1,silent:!1,roam:!1,breadcrumb:{show:!1},levels:[{itemStyle:{normal:{borderWidth:0,gapWidth:0}}},{itemStyle:{normal:{borderWidth:0,gapWidth:0}}}],data:e.map((function(e){return{name:e.name,value:e.count}}))}]};n.instance.clear(),n.instance.setOption(t)},n.state={data:t.data},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.instance=this.chart.getEchartsInstance(),this.resetChart()},n.render=function(){var e=this;return i.createElement(C.Z,{ref:function(t){return e.chart=t},option:{},theme:"yunting_multi_color",style:{width:"100%",height:"353px"}})},t}(i.Component);R.propTypes={data:f().array.isRequired};var Z=n(29383),F=function(e){function t(t){var n;return(n=e.call(this,t)||this).switchPage=function(e){var t=n.state,a=t.pageSize,o=t.data.slice((e-1)*a,e*a);n.setState({currPageData:o,pageIndex:e})},n.switchPageSize=function(e){var t=n.state.data.slice(0,e);n.setState({currPageData:t,pageIndex:1,pageSize:e})},n.state={currPageData:[],data:t.data,pageIndex:1,pageSize:10},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.switchPage(1)},n.render=function(){var e=this.state,t=e.currPageData,n=e.data,a=e.pageIndex,o=e.pageSize;return i.createElement(Z.Z,{columns:[{label:"",prop:"paddingLeft",width:16},{label:"\u6392\u5e8f",prop:"rank"},{label:"\u5173\u6ce8\u70b9",prop:"name"},{label:"\u6570\u91cf",prop:"count"},{label:"\u5360\u6bd4",prop:"percentage",render:function(e){return e.percentage+"%"}},{label:"",prop:"paddingRight",width:16}],data:t,total:n.length,pagePosition:"down",pageSize:o,currentPage:a,onPage:this.switchPage,pageSizeSelectorShow:!0,onPageSizeChange:this.switchPageSize,notLimit:!0})},t}(i.Component);F.propTypes={data:f().arrayOf(f().shape({name:f().string.isRequired,count:f().number.isRequired,brand:f().string,self:f().bool.isRequired,percentage:f().number.isRequired}))};var W=n(40086),M=n(30133),j=n(25713),z=n(33798),q=n(92360),B=n(94644),J=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleSwitchCategory=function(e){var t=n.props.onGroupTypeChange;t&&t({groupType:e})},n.handleSwitchChartType=function(e){n.state.chartType!==e&&n.setState({chartType:e})},n.handleDownload=function(e,t){"img"===e?n.handleDownloadChart(t):n.handleDownloadExcel(t)},n.handleDownloadExcel=function(e){var t=n.state.data.map((function(e){return[e.rank,e.name,e.count,e.percentage]}));t.splice(0,0,["\u6392\u5e8f","\u5173\u6ce8\u70b9","\u6570\u91cf","\u5360\u6bd4\uff08%\uff09"]),(0,B.aT)([t],e)},n.handleDownloadChart=function(e){"bar"===n.state.chartType?(0,B._v)(n.bar.instance,e):(0,B._v)(n.treeMap.instance,e)},n.state={loading:t.loading,data:t.data,product:t.product,chartType:"bar"},n}return(0,r.Z)(t,e),t.getDerivedStateFromProps=function(e,t){return e.loading!==t.loading?{loading:e.loading}:JSON.stringify(e.data)!==JSON.stringify(t.data)?{data:e.data}:null},t.prototype.render=function(){var e=this,t=this.state.chartType,n=this.props,a=n.loading,o=n.isInitial,r=n.product,s=n.data,c=n.groupType,l=n.onChartClick,p=JSON.parse(JSON.stringify(s)),d={list:[{name:"\u54c1\u724c",id:"BRAND"},{name:"\u578b\u53f7",id:"SUBJECT"}],value:c,placeholder:c.name,onChange:this.handleSwitchCategory},u="\u63d0\u53ca"+r+"\u65f6\u4e5f\u63d0\u5230\u7684\u5176\u4ed6\u5546\u54c1",h="table"===t?[{type:"excel",title:"\u5bfc\u51fa\u6570\u636e"}]:[{type:"img",title:"\u5bfc\u51fa\u56fe\u7247"},{type:"excel",title:"\u5bfc\u51fa\u6570\u636e"}];return i.createElement("div",{className:"comparison-chart-wrapper"},i.createElement("div",{className:"comparison-chart-header"},i.createElement("span",{className:"title"},u),i.createElement("div",{className:"appendix"},i.createElement(W.Z,d),[{type:"bar",className:"cem_bar-type",activeClassName:"cem_bar-type-colour",title:"\u67f1\u72b6\u56fe"},{type:"tree",className:"cem_area",activeClassName:"cem_area-col",title:"\u9762\u79ef\u56fe"},{type:"table",className:"cem_form-new",activeClassName:"cem_form-new-col",title:"\u8868\u683c"}].map((function(n){var a=n.type,o=n.className,r=n.activeClassName,s=n.title;return i.createElement(T.Z,{key:a,placement:"top",overlay:s},i.createElement(z.Z,{enable:!0,isActive:t===a,defaultIcon:o,activeIcon:r,onClick:function(){return e.handleSwitchChartType(a)}}))})),i.createElement(j.Z,{options:h,onClick:function(t){return e.handleDownload(t,u)}})),o?i.createElement(M.Z,null):a?i.createElement(q.Loading,{loading:a},i.createElement("div",{style:{height:"343px"}})):s.length>0?"bar"===t?i.createElement(I,{ref:function(t){return e.bar=t},data:p,onChartClick:l}):"tree"===t?i.createElement(R,{ref:function(t){return e.treeMap=t},data:p}):i.createElement(F,{data:p}):i.createElement("div",{className:"empty-block"},"\u6682\u65e0\u6570\u636e")))},t}(i.Component);J.propTypes={loading:f().bool,isInitial:f().bool.isRequired,product:f().string.isRequired,data:f().arrayOf(f().shape({name:f().string.isRequired,count:f().number.isRequired,brand:f().string,self:f().bool.isRequired,percentage:f().number.isRequired})),onGroupTypeChange:f().func.isRequired};var H=n(67641);const G=function(e){var t=e.isInitial,n=e.conData,a=n.sum,r=n.total,s=n.sourceList,d=n.titlePrefix,u=e.overviewLoading,h=e.trendData,m=e.trendLoading,f=e.trendTimeType,g=e.trendPlatformType,y=e.onTrendFilterChange,v=e.productFocusPointData,C=e.productLoading,w=e.productOptions,E=e.productCompare,S=e.productAspectType,b=e.onProductFilterChange,T=e.mentionedGoodsLoading,x=e.mentionedGoodsData,P=e.fetchMentionedGoods,N=e.headerDefValue,k=e.onMoreClick,D=e.contentWidth,O=e.onFilterChange,L=e.onAspectChartClick,_=e.getHeaderRef,I=e.onChartClick,R=e.formulaType;return i.createElement("div",{className:"yt-conversation-commodity-wrapper"},i.createElement(H.Z,{onChange:O,type:"commodityAnalyze",value:N,ref:_,title:"\u5546\u54c1\u5206\u6790"}),i.createElement("div",{className:"co-content",id:"co-content"},i.createElement("div",null,i.createElement(c.Z,{type:2,titlePrefix:d,loading:u,isInitial:t,quantity:a,leftSubTitle:"\u6240\u6709\u5546\u54c1\u4f1a\u8bdd\u91cf",leftContent:r,rightSubTitle:"\u63d0\u53ca\u7387",rightContent:""+(0===r?0:(a/r*100).toFixed(2))}),i.createElement(l.Z,{titlePrefix:d,loading:u,isInitial:t,data:s}),i.createElement(p.Z,{title:d+"\u4f1a\u8bdd\u8d70\u52bf",pageType:"product",data:h,loading:m,onMoreClick:k,timeType:f,platformType:g,onFilterChange:y})),i.createElement(A,{title:"\u63d0\u53ca"+d+"\u65f6\u7684\u5173\u6ce8\u70b9",data:v,loading:C,formulaType:R,aspectType:S,productCompare:E,onMoreClick:k,onFilterChange:b,contentWidth:D,productOptions:w,onChartClick:L}),i.createElement(J,(0,o.Z)({title:"\u63d0\u53ca"+d+"\u65f6\u4e5f\u63d0\u53ca\u5230\u7684\u5176\u4ed6\u5546\u54c1"},x,{product:d,loading:T,isInitial:t,onGroupTypeChange:P,onChartClick:I}))))};var U=n(35239),K=n(61409),V=n(64396),Q=["loading"],X=V.Z.conversation.commodityAnalyze,Y=function(e){function t(t){var n;(n=e.call(this,t)||this)._handleOnMoreClick=function(e){"image"===e.type?(0,B._v)(e.obj,e.name):"data"===e.type&&(0,B.aT)(e.obj,e.name)},n._handleWindowResize=function(){n.setState({contentWidth:document.getElementById("co-content").offsetWidth})},n._handleOnProductFilterChange=function(e){var t=e.aspectType&&"ASPECT1"===e.aspectType?{aspect1:[]}:{};n.props.fetchProductFocusPointData((0,o.Z)({},e,t))},n._handleOnFilterChange=function(e,t){U.t.set(U.V.conversationCommodityHeader,t),n.props.fetchDatas({projectId:U.t.get(U.V.curProject).id,refresh:n.shouldRefresh,headerState:JSON.parse(JSON.stringify(t)),filter:(0,o.Z)({source:[],shopName:[],waiter:[],typeList:[],aspect1:[],aspect2:[],product:[]},JSON.parse(JSON.stringify(e)))}).then((function(){n.shouldRefresh=!1}))},n._handleOnTrendFilterChange=function(e){n.props.fetchConversationTrendData((0,o.Z)({},e))},n._handleOnAspectChartClick=function(e){var t=n.props,a=t.productAspectType,r=t.filter,i=t.productList,s=t.fetchProductFocusPointData,c=e.componentType,l=e.name,p=e.value,d=e.dimensionNames,u=e.seriesIndex,h=e.seriesName;if("series"===c){var m,f=l,g="ASPECT2"===a?[n.headerRef.getAspect1(f).name,f]:[f],y=d[2*u+1];h=y.substring(0,y.lastIndexOf("-")),K.mW.push({pathname:"/conversation/commodityAnalyze/detail",state:(0,o.Z)({},JSON.parse(JSON.stringify(r)),(m={queryType:"ASPECT",product:[h],productList:JSON.parse(JSON.stringify(i.filter((function(e){return e!==r.product[0]})))),aspect1:[],aspect2:[]},m[a.toLowerCase()]=[f],m.aspect=g,m))})}else if("xAxis"===c||"yAxis"===c){var v="ASPECT1"===a;s({aspectType:v?"ASPECT2":"ASPECT1",aspect1:v?[p]:[]})}},n._handleOnProductChartClick=function(e){var t=n.props,a=t.projectId,r=t.filter,i=t.mentionedGoodsData;"series"===e.componentType&&"BRAND"===i.groupType.id&&K.mW.push({pathname:"/conversation/commodityAnalyze/detail",state:(0,o.Z)({},JSON.parse(JSON.stringify(r)),{brand:e.name,projectId:a,aspect:[]})})},n.headerRef=void 0;var a=t.location.state;return n.shouldRefresh=a&&"detail"===a.from,n.state={contentWidth:0},n.event={onFilterChange:n._handleOnFilterChange,onTrendFilterChange:n._handleOnTrendFilterChange,onProductFilterChange:n._handleOnProductFilterChange,onMoreClick:n._handleOnMoreClick,onAspectChartClick:n._handleOnAspectChartClick,getHeaderRef:function(e){return n.headerRef=e&&e.wrappedInstance},onChartClick:n._handleOnProductChartClick},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this._handleWindowResize(),window.addEventListener("resize",this._handleWindowResize)},n.componentWillUnmount=function(){window.removeEventListener("resize",this._handleWindowResize)},n.render=function(){return i.createElement(G,(0,o.Z)({},this.props,this.state,this.event))},t}(i.Component);const $=(0,s.connect)((function(e,t){var n=e.loading,r=(0,a.Z)(e,Q);return(0,o.Z)({},r[X],{headerDefValue:t.location.state&&t.location.state.defHeader||r[X].headerState,overviewLoading:n.effects[X+"/fetchConversationData"]||!1,mentionedGoodsLoading:n.effects[X+"/fetchMentionedGoods"]||!1,trendLoading:n.effects[X+"/fetchConversationTrendData"]||!1,productLoading:n.effects[X+"/fetchProductFocusPointData"]||!1,focusLoading:n.effects[X+"/fetchFocusDistributionData"]||!1})}),(function(e){return{fetchDatas:function(t){return e({type:X+"/fetchDatas",payload:t})},fetchConversationTrendData:function(t){return e({type:X+"/fetchConversationTrendData",payload:t})},fetchProductFocusPointData:function(t){return e({type:X+"/fetchProductFocusPointData",payload:t})},fetchMentionedGoods:function(t){return e({type:X+"/fetchMentionedGoods",payload:t})}}}))(Y)},40086:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(87462),o=n(94578),r=n(67294),i=n(45697),s=n.n(i),c=function(e){function t(t){var n;return(n=e.call(this,t)||this).stop=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},n._setEvent=function(e){return 0===e?{onMouseEnter:function(){n.setState({firstLiHover:!0})},onMouseLeave:function(){n.setState({firstLiHover:!1})}}:{}},n.setShowSelFalse=function(){n.setState({show:!1})},n.state={show:!1,firstSelected:!1},n}(0,o.Z)(t,e);var n=t.prototype;return n.changeShow=function(e){var t=this;this.state.show&&this.stop(e),setTimeout((function(){t.setState({show:!t.state.show})}),0)},n.componentDidMount=function(){window.addEventListener("click",this.setShowSelFalse)},n.componentWillUnmount=function(){window.removeEventListener("click",this.setShowSelFalse)},n.render=function(){var e=this,t=this.state.show,n=this.props,o=n.placeholder,i=n.list,s=n.value,c=n.onChange,l=n.style,p=n.partingLine,d=i[0]&&i[0].id===s.id;return r.createElement("div",{className:"chart-select",style:l||{}},r.createElement("div",{className:"select "+(p?"line":""),onClick:function(t){return e.changeShow(t)}},r.createElement("div",{className:"infor "+(t?"sel":"")},r.createElement("span",{className:"placeholder"},o),r.createElement("i",{className:"icon icon-cem_arrow-launches",style:{transform:t?"rotate(-180deg)":"",top:t?"3px":""}}))),t&&r.createElement("div",{className:"position-wrap"},r.createElement("div",{className:"selItem "+(this.state.firstLiHover||d?"selPadHover":""),onClick:function(t){return e.stop(t)}},r.createElement("div",{className:"wrap"},r.createElement("ul",null,i.length>0?i.map((function(t,n){return r.createElement("li",(0,a.Z)({className:t.id===s.id?"sel":"",key:n,onClick:function(){e.setShowSelFalse(),c&&c(t,n)}},e._setEvent(n)),r.createElement("span",null,t.name))})):r.createElement("div",{className:"noData"},"\u65e0\u6570\u636e"))))))},t}(r.Component);c.defaultProps={placeholder:"\u8bf7\u9009\u62e9",list:[{name:"\u5468",id:"week"},{name:"\u6708",id:"month"}],value:{}},c.propTypes={placeholder:s().oneOfType([s().string,s().element]),list:s().array,value:s().object,onChange:s().func,style:s().object,partingLine:s().bool}}}]);