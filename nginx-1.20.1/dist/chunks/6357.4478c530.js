(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[6357],{16357:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Ee});var a=n(63366),i=n(87462),l=n(94578),r=(n(1025),n(65400)),o=(n(48980),n(20838)),s=n(67294),c=n(61918),u=n(1179),p=n(55815),d=(n(15144),n(2307)),m=(n(77785),n(59361)),f=n(43144),h=n(23279),v=n.n(h),g=n(45697),y=n.n(g),E=n(39432),C=n(43036),b=n(51474),N=n(87219),_=function(e){function t(t){var n;return(n=e.call(this,t)||this)._setShowFalse=function(){n.setState({show:!1})},n._handleParentClick=function(e){n.state.show&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},n._handleOnTriggerClick=function(){setTimeout((function(){n.setState({show:!n.state.show})}),0)},n._renderOptionItem=function(e,t,a,i,l,r){var o=n.state.maxLabelWidth,c=n.props.value.find((function(t){return t.value===e.value}));return s.createElement("div",{className:"opt_item "+(t?"draggable":""),key:e.value},t&&s.createElement("i",{className:"icon-cem_move my_handle"}),s.createElement("div",{className:"opt_content",style:{width:o,marginLeft:t?0:14}},s.createElement("div",{className:"item_label",onClick:function(t){t.stopPropagation(),n._handleOnItemClick(e.value)}},s.createElement("span",{className:"icon_checkbox "+(c&&c.checked?"checkbox_checked":"")}),s.createElement("span",null,e.label)),s.createElement("div",{className:"item_control"},s.createElement(C.Z,{placement:"top",overlay:a},s.createElement("span",{onClick:function(t){return i(t,e.value)}},s.createElement("i",{className:(t?"icon-cem_up":"icon-cem_up-and-down")+" fun_icon_a"}))),s.createElement(C.Z,{placement:"top",overlay:l},s.createElement("span",{onClick:function(t){return r(t,e.value)},style:{marginLeft:4}},s.createElement("i",{className:"icon-cem_down fun_icon_b"}))))))},n._handleOnItemClick=function(e){var t=n.props,a=t.value,i=t.onChange;i&&i((0,N.ZP)(a,(function(t){var n=t.find((function(t){return t.value===e}));n&&(n.checked=!n.checked)})))},n._handleOnFilxedLeftClick=function(e,t){e.stopPropagation(),n._handleOnFixedChange(t,"left")},n._handleOnCancelFixedClick=function(e,t){e.stopPropagation(),n._handleOnFixedChange(t,"")},n._handleOnFixedRightClick=function(e,t){e.stopPropagation(),n._handleOnFixedChange(t,"right")},n._handleOnFixedChange=function(e,t){var a=n.props,i=a.value,l=a.onChange;l&&l((0,N.ZP)(i,(function(n){var a=n.find((function(t){return t.value===e}));a&&(a.fixed=t)})))},n.state={show:!1,value:[],leftOpts:[],normalOpts:[],rightOpts:[],maxLabelWidth:t.options.reduce((function(e,t){return Math.max((0,E.jD)(t.label,14)+56+16+16,e)}),0)},n}(0,l.Z)(t,e),t.getDerivedStateFromProps=function(e,t){if(JSON.stringify(e.value)!==JSON.stringify(t.value)){var n=e.value.reduce((function(t,n){var a=1;"left"===n.fixed&&(a=0),"right"===n.fixed&&(a=2);var i=e.options.find((function(e){return e.value===n.value}));return i&&t[a].push(i),t}),[[],[],[]]),a=n[0],i=n[1],l=n[2];return{value:e.value,leftOpts:a,normalOpts:i,rightOpts:l}}return null};var n=t.prototype;return n.componentDidMount=function(){var e=this;window.addEventListener("click",this._setShowFalse);var t=document.getElementById("draggable_zone");t&&b.default.create(t,{group:"draggable_zone",animation:150,filter:".undraggable",draggable:".draggable",handle:".my_handle",onEnd:function(t){var n=e.props,a=n.value,i=n.onChange,l=t.newIndex,r=t.oldIndex;if(l!==r){var o=a.filter((function(e){return"left"===e.fixed}));i&&i((0,N.ZP)(a,(function(e){var t=e.splice(r+o.length,1)[0];e.splice(l+o.length,0,t)})))}}})},n.componentWillUnmount=function(){window.removeEventListener("click",this._setShowFalse)},n.render=function(){var e=this,t=this.state,n=t.show,a=t.leftOpts,i=t.normalOpts,l=t.rightOpts,r=this.props,o=r.className,c=r.title;return s.createElement("div",{className:"yt_column_selector_wrapper "+(o||""),onClick:this._handleParentClick},s.createElement("div",{className:"trigger "+(n?"sel":""),onClick:this._handleOnTriggerClick},c||"\u5217",s.createElement("i",{className:"icon-cem_arrow-launches",style:{transform:n?"rotate(-180deg)":""}})),s.createElement("div",{className:"options "+(n?"active":"")},a.length>0&&s.createElement(s.Fragment,null,s.createElement("div",{className:"opt_label"},"\u56fa\u5b9a\u5728\u5de6\u4fa7"),a.map((function(t){return e._renderOptionItem(t,!1,"\u4e0d\u56fa\u5b9a",e._handleOnCancelFixedClick,"\u56fa\u5b9a\u5728\u5217\u5c3e",e._handleOnFixedRightClick)}))),(a.length>0||l.length>0)&&s.createElement("div",{className:"opt_label"},"\u4e0d\u56fa\u5b9a"),s.createElement("div",{id:"draggable_zone",style:{visibility:i.length>0}},i.map((function(t){return e._renderOptionItem(t,!0,"\u56fa\u5b9a\u5728\u5217\u5934",e._handleOnFilxedLeftClick,"\u56fa\u5b9a\u5728\u5217\u5c3e",e._handleOnFixedRightClick)}))),l.length>0&&s.createElement(s.Fragment,null,s.createElement("div",{className:"opt_label"},"\u56fa\u5b9a\u5728\u53f3\u4fa7"),l.map((function(t){return e._renderOptionItem(t,!1,"\u4e0d\u56fa\u5b9a",e._handleOnCancelFixedClick,"\u56fa\u5b9a\u5728\u5217\u5934",e._handleOnFilxedLeftClick)})))))},t}(s.PureComponent);const w=_;_.propTypes={className:y().string,title:y().string,options:y().array,value:y().array,onChange:y().func};var S=n(30381),T=n.n(S),k=n(77153),I=n(33722),D=n(61193),P=function(e){var t=Math.max.apply(null,e.map((function(e){return(0,E.jD)(e.title,14)})))+2+10+32;return(t+=0)>98?t:98};const O=function(e){function t(t){var n;return(n=e.call(this,t)||this).pageSize=10,n.handleResize=v()((function(){var e=document.getElementById("table_zone"),t=document.querySelector(".ant-tabs-content-holder"),a=t?t.offsetHeight-130:350;e&&t&&n.setState({tableWidth:e.clientWidth,maxHeight:a})}),150),n.getDropDown=function(e,t){var a=n.state,i=a.active,l=a.activeId,r=("UN_DISPATCH"===e.status?I.pX:"DISPATCHED"===e.status?I.CQ:I._d).filter((function(e){return!e.PermissionCode||D.Z.hasAuthority(e.PermissionCode)}));return s.createElement("div",{className:"button-panel",style:{minWidth:P(r)}},r.map((function(a){return s.createElement("div",{key:a.value,className:"panel-item ellipsis "+(a.value===i&&a.id===l&&"sel"),onClick:function(){n.setState({active:a.value,activeId:a.id}),t(a.value,e)}},a.title)})))},n.hide=function(e){e()},n.genSingleColumn=function(e,t){var a=e.value,l=e.label,r=n.props,o=r.onClick,c=r.onChange,u=r.isThirdParty,p=r.pageIndex,d=n.state,f=(d.tableWidth,d.questionnaireStatus),h=d.date,v=(0,i.Z)({},e,{title:l,dataIndex:a,key:t});return"title"===a?(u||(v.width=207),v.render=function(e,t){return s.createElement(C.Z,{placement:"top",overlay:t.title},s.createElement("span",{style:{cursor:"pointer",color:"#2572FF"},onClick:function(){return o("detail",t)}},t.title))}):"questionnaireType"===a?(u||(v.width=153),v.render=function(e,t){return n=t.questionnaireType,Array.isArray(n)&&n.length?n.sort().map((function(e){var t=I.nx.find((function(t){return t.value===e}));return t?t.title:e})).join("\uff0c"):"";var n}):"status"===a?(u||(v.width=147),v.onCell=function(){return{style:{padding:"10px 16px"}}},v.filterDropdown=function(e){e.setSelectedKeys,e.selectedKeys;var t=e.confirm;e.clearFilters;return s.createElement("ul",{className:"dropdown-question-status"},I.hm.map((function(e){return s.createElement("li",{key:e.value,onClick:function(){c({status:e.value}),n.setState({questionnaireStatus:e.value}),n.hide(t)},className:f===e.value?"sel":""},e.title)})))},v.filterIcon=function(){return s.createElement("span",{className:"iconfont down-icon"},s.createElement("svg",{viewBox:"64 64 896 896",focusable:"false","data-icon":"filter",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},s.createElement("path",{d:"M349 838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V642H349v196zm531.1-684H143.9c-24.5 0-39.8 26.7-27.5 48l221.3 376h348.8l221.3-376c12.1-21.3-3.2-48-27.7-48z"})))},v.render=function(e,t){return s.createElement(m.default,{className:"temp-column-tag "+t.status},function(e){var t=I.hm.find((function(t){return t.value===e}));return t?t.title:e}(t.status))}):"submitted"===a?(u||(v.width=99),u||(v.filterDropdown=function(e){e.setSelectedKeys,e.selectedKeys;var t=e.confirm;e.clearFilters;return s.createElement("ul",{className:"dropdown-question-status"},I.eF.map((function(e){return s.createElement("li",{key:e.value,onClick:function(){c({intervalType:e.value,pageIndex:p}),n.setState({date:e.value}),n.hide(t)},className:h===e.value?"sel":""},e.title)})))},v.filterIcon=function(){return s.createElement("span",{className:"iconfont filter-icon"},"\ue646")}),v.render=function(e,t){return E.ZP.getApproximateNum(t.submitted)}):"npsScore"===a?(u||(v.width=113),v.render=function(e,t){return t.npsScore?Number(t.npsScore).toFixed(2):"--"}):"satisfactionScore"===a?(u||(v.width=113),v.render=function(e,t){return t.satisfactionScore?Number(t.satisfactionScore).toFixed(2):"--"}):"lastSubmittedAt"===a?(u||(v.width=207),v.sorter=function(e,t){return new Date(t.lastSubmittedAt?t.lastSubmittedAt:"1970").getTime()-new Date(e.lastSubmittedAt?e.lastSubmittedAt:"1970").getTime()},v.render=function(e,t){return t.lastSubmittedAt?T()(t.lastSubmittedAt).format("YYYY-MM-DD HH:mm"):"--"}):"createdAt"===a?(u||(v.width=207),v.sorter=function(e,t){return new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()},v.render=function(e,t){return T()(t.createdAt).format("YYYY-MM-DD HH:mm")}):"updatedAt"===a?(u||(v.width=147,v.sorter=function(e,t){return new Date(t.updatedAt).getTime()-new Date(e.updatedAt).getTime()}),v.render=function(e,t){return(0,I.Go)(t.updatedAt)}):"operator"===a&&(u||(v.width=241),v.render=function(e,t){return s.createElement("div",{className:"col-nm-control"},D.Z.hasAuthority("QUESTIONNAIRE_COLLECT_ENABLE")&&s.createElement("span",{onClick:function(){return o("dispatch",t)},style:{color:"#2572FF"}},"\u5206\u53d1"),s.createElement("span",{onClick:function(){return o("preview",t)},style:{color:"#2572FF"}},"\u9884\u89c8"),D.Z.hasAuthority("QUESTIONNAIRE_UPDATE")&&s.createElement("span",{onClick:function(){return o("edit",t)},style:{color:"#2572FF"}},"\u7f16\u8f91"),s.createElement(C.Z,{placement:"bottomLeft",overlayClassName:"research_nps_manage_list_overlay",overlay:function(){return n.getDropDown(t,o)}},s.createElement("span",{className:"icon-cem_more-more",style:{color:"#000"}})))}),v},n.handleOnColumnChange=function(e){n.props.setDefaultValue({activeColumnProps:e}),n.props.save({activeColumnProps:e})},n.onPageChange=function(e,t,a,i){if("paginate"===i.action){var l=e.current,r=e.pageSize,o=n.props,s=o.onPageSizeChange,c=o.onPageChange;n.pageSize===r?c(l):(s(r),n.pageSize=r)}},n.state={tableWidth:0,maxHeight:500,questionnaireStatus:"ALL",date:"ALL"},n}(0,l.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){window.addEventListener("rezise",this.handleResize),this.handleResize()},n.jump=function(e,t){if(0!==location.search.length){var n=JSON.parse(decodeURIComponent(location.search.slice(1))),a=n.questionnaireId,l=n.jumpType,r=void 0===l?null:l,o=e.find((function(e){return e.id===a}));t("detail",(0,i.Z)({},o,{jumpType:r}))}},n.componentWillUnmount=function(){window.removeEventListener("rezise",this.handleResize)},n.render=function(){var e,t,n=this.props,a=n.loading,i=n.data,l=n.total,r=n.pageIndex,o=n.pageSize,c=n.onColumnChange,u=n.activeColumnProps,p=n.disableColumnSelect,m=n.isThirdParty;this.state.maxHeight;0!==i.length&&this.jump(this.props.data,this.props.onClick),document.querySelectorAll(".el-table-poper").forEach((function(e,t){t<=1||(e.style.display="none")}));var f=0===this.columns.length?s.createElement("span",{style:{color:"#8c8c8c",fontSize:"14px"}},"\u81f3\u5c11\u9009\u4e2d\u4e00\u4e2a\u663e\u793a\u5217"):s.createElement("div",{style:{margin:"160px 0"}},s.createElement("img",{src:k,alt:"",style:{margin:"5px 0"}}),s.createElement("p",{style:{color:"#8c8c8c",fontSize:"14px"}},"\u6682\u65e0\u6570\u636e"));return s.createElement("div",{id:"table_zone",className:"yt_research_nps_manage_list"},s.createElement(d.Z,{className:"yt_research_nps_antd_table",loading:a,columns:this.columns,dataSource:null!=(e=this.columns)&&e.length?i:[],scroll:{x:m?void 0:1200,y:this.maxHeight},showSorterTooltip:!1,locale:{emptyText:f},pagination:{defaultCurrent:1,current:r,total:l,pageSize:o,pageSizeOptions:[10,20,40,100],showTotal:function(e,t){return s.createElement("span",null,t[0],"-",t[1],s.createElement("i",{style:{color:"#8C8C8C"}}," \u9879\uff0c\u5171 "),e,s.createElement("i",{style:{color:"#8C8C8C"}}," \u9879 "))},showSizeChanger:!0},onChange:this.onPageChange}),!p&&s.createElement(w,{className:"column_selector "+(null!=(t=this.columns)&&t.length?"top13":"top3"),options:I.SE,value:u,onChange:c}))},(0,f.Z)(t,[{key:"columns",get:function(){var e=this,t=[],n=[],a=[],i=[],l=this.props,r=l.activeColumnProps,o=l.isThirdParty;if(r.forEach((function(i,l){if(i.checked){var r=e.genSingleColumn(i,l);"left"===i.fixed?t.push(r):"right"===i.fixed?n.push(r):a.push(r)}})),o)return i=[].concat(t,a,n);var s={title:""},c=t.length>0,u=n.length>0,p=a.length;if(p>0&&p<3&&(c||u)){var d=a.reduce((function(e,t){return e.concat([t,s])}),[s]);i=[].concat(t,d,n)}else if(0===p&&u)i=[].concat(t,[s],n);else{var m=a.reduce((function(e,t){return e.concat([t,s])}),[s]);i=[].concat(t,m,n)}return i}}]),t}(s.PureComponent);n(9405);var x=n(89552),L=(n(76405),n(69843)),F=n(35239),A=n(46342),Z=[{label:"10\u9879/\u9875",value:10},{label:"20\u9879/\u9875",value:20},{label:"40\u9879/\u9875",value:40},{label:"100\u9879/\u9875",value:100}],q={skyblue:"smallPic1",bubble:"smallPic2",fresh:"smallPic3"},z=n(98422),W=function(e){var t=e||{},a=t.skinId,i=t.url;if("default"===a)return z;if(a in q){var l=q[a];return n(76589)("./"+l+".png")}return i||z};const M=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))||this).pageSize=10,t.containerDom=null,t.sizeChange=function(){if(t.containerDom){var e=t.containerDom.offsetWidth-4-5-1-16,n=t.containerDom.querySelectorAll("li");if(n[0]){var a=n[0].offsetWidth,i=Math.floor(e/(a+30)),l=Math.floor((e-i*a)/(i-1));n.forEach((function(t,n){t.style.marginLeft=1!==i?(n+1)%i===1?"0px":l+"px":Math.floor((e-a)/2)+"px"}))}else setTimeout((function(){t.sizeChange()}),100)}else setTimeout((function(){t.sizeChange()}),100)},t.getQuestionnaireType=function(e){return 1===e.length?"SATISFACTION"===e[0]?"\u6ee1\u610f\u5ea6":"NORMAL"===e[0]?"\u666e\u901a\u9898\u578b":"NPS":"NPS/\u6ee1\u610f\u5ea6"},t.getStatusTag=function(e){return"DISPATCHED"===e?s.createElement(m.default,{color:"#f7f8fc",className:"status",style:{color:"#8C8C8C"}},"\u5df2\u53d1\u5e03"):"UN_DISPATCH"===e?s.createElement(m.default,{color:"#fff6ed",className:"status"},"\u672a\u53d1\u5e03"):s.createElement(m.default,{color:"#f7f8fca5",className:"status",style:{color:"#8C8C8Ca5"}},"\u5df2\u7ed3\u675f")},t.getValue=function(e){var t="",n="";return-1!==e.questionnaireType.indexOf("NPS")&&(t=void 0!==e.npsScore?""+e.npsScore:"--"),-1!==e.questionnaireType.indexOf("SATISFACTION")&&(n=void 0!==e.satisfactionScore?""+e.satisfactionScore:"--"),t&&n&&t+"/"+n||t||n||"--"},t.getDropDown=function(e,t){var n=null;return n="DISPATCHED"===e.status?I.CQ.map((function(n,a){return s.createElement("p",{onClick:function(a){a.stopPropagation(),t(n.value,e)},key:a},n.title)})):"CLOSED"===e.status?I._d.map((function(n,a){return s.createElement("p",{onClick:function(a){a.stopPropagation(),t(n.value,e)},key:a},n.title)})):I.pX.map((function(n,a){return s.createElement("p",{onClick:function(a){a.stopPropagation(),t(n.value,e)},key:a},n.title)})),s.createElement("div",{className:"yt_npsManage_card_btn_panel",style:{height:"UN_DISPATCH"===e.status?"152px":"190px"}},s.createElement("p",{onClick:function(n){n.stopPropagation(),t("edit",e)}},"\u7f16\u8f91"),n)},t.onPageChange=function(e,n){var a=t.props,i=a.onPageSizeChange,l=a.onPageChange;t.pageSize===n?l(e):(i(n),t.pageSize=n)},t}(0,l.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.sizeChange(),window.addEventListener("resize",this.sizeChange)},n.componentWillUnmount=function(){window.removeEventListener("resize",this.sizeChange)},n.componentDidUpdate=function(){this.sizeChange()},n.render=function(){var e=this,t=this.props,n=t.data,a=t.onClick,l=t.loading,r=t.total,o=t.pageIndex,c=t.pageSize;return s.createElement(s.Fragment,null,s.createElement(x.default,{spinning:l},0===n.length?s.createElement("div",{style:{margin:"160px auto",textAlign:"center"}},s.createElement("img",{src:k,alt:"",style:{margin:"5px 0"}}),s.createElement("p",{style:{color:"#8c8c8c",fontSize:"14px"}},"\u6682\u65e0\u6570\u636e")):s.createElement("ul",{className:"yt_npsManage_card_list clearfix",ref:function(t){return e.containerDom=t}},n.map((function(t){return s.createElement("li",{className:"card",onClick:function(){a("edit",t)},key:t.id},s.createElement("div",{className:"img-container"},s.createElement("img",{src:W(t),alt:"background-image"})),s.createElement(C.Z,{placement:"top",overlay:t.title},s.createElement("h3",null,t.title)),e.getStatusTag(t.status),s.createElement("div",{className:"more-msg"},s.createElement("div",null,s.createElement("p",{className:"value"},t.submitted),s.createElement("p",{className:"title"},"\u7b54\u5377\u6570")),s.createElement("div",null,s.createElement("p",{className:"value"},e.getQuestionnaireType(t.questionnaireType)),s.createElement("p",{className:"title question-type"},"\u4f53\u9a8c\u9898\u578b")),s.createElement("div",null,s.createElement("p",{className:"value"},e.getValue(t)),s.createElement("p",{className:"title"},"\u5206\u503c"))),s.createElement("div",{className:"more-operate"},s.createElement("div",{onClick:function(e){e.stopPropagation(),a("dispatch",t)}},s.createElement("span",{className:"iconfont"},"\ue602"),"\u5206\u53d1"),s.createElement("div",{onClick:function(e){e.stopPropagation(),(0,A.Q2)({id:t.id}).then((function(e){var t=JSON.parse(e.data.result.newConfiguration),n=(0,i.Z)({questionslist:JSON.parse(e.data.result.newConfiguration).questions},t);F.t.set("pageConfig",JSON.stringify(n)),setTimeout((function(){window.open("/research/questionnaireAnswer/answer?type=1")}),200)}))}},s.createElement("span",{className:"iconfont",style:{fontWeight:600}},"\ue7a6"),"\u9884\u89c8"),s.createElement("div",{onClick:function(e){e.stopPropagation(),a("detail",t)}},s.createElement("span",{className:"iconfont"},"\ue603"),"\u6570\u636e"),s.createElement("div",null,s.createElement(C.Z,{placement:"bottom",overlayClassName:"yt_npsManage_card_btn_panel_overlay",overlay:function(){return e.getDropDown(t,a)}},s.createElement("span",{className:"iconfont",style:{display:"inline-block",width:"100%",height:"100%"},onClick:function(e){e.stopPropagation()}},"\ue754")))))}))),s.createElement("div",{className:"yt_npsManage_card_list_bottom"},s.createElement(L.default,{total:r,pageSizeOptions:Z.map((function(e){return""+e.value})),pageSize:c,current:o,onChange:this.onPageChange,showTotal:function(e,t){return s.createElement("span",{className:"yt_npsManage_card_list_bottom_pagination_msg"},t[0],"-",t[1],s.createElement("i",{style:{color:"#8C8C8C"}}," \u9879\uff0c\u5171 "),e," ",s.createElement("i",{style:{color:"#8C8C8C"}}," \u9879 "))},showSizeChanger:!0}))))},t}(s.Component);var H=n(92360),R=n(66130),V="YYYY-MM-DD";const j=function(e){function t(t){var n;return(n=e.call(this,t)||this).showDialog=function(e){n.state.visible?n.setState({visible:!1,callback:void 0,nps:void 0,type:""},(function(){n.setState((0,i.Z)({visible:!0},e))})):n.setState((0,i.Z)({visible:!0},e))},n.renderTitle=function(e,t){if("delete"===e)return"\u786e\u5b9a\u5220\u9664\u6b64\u95ee\u5377\uff1f";if("edit"===e)return"\u63d0\u793a";if("switch"===e){if("DISPATCHED"===t.status)return"\u786e\u5b9a\u505c\u6b62\u6536\u96c6\u6b64\u95ee\u5377\u7684\u7b54\u5377\uff1f";if("CLOSED"===t.status)return"\u786e\u5b9a\u91cd\u65b0\u6253\u5f00\u6b64\u95ee\u5377\uff1f"}else{if("updateNpsTime"===e)return"\u6b64NPS\u5df2\u8fc7\u671f\uff0c\u91cd\u65b0\u53d1\u5e03\uff1f";if("dispatch"===e)return"\u786e\u5b9a\u4ecd\u8981\u5206\u53d1\u6b64\u95ee\u5377\uff1f"}},n.switchExpireTimeType=function(e){var t=n.props.updateNps,a="";if(2===e){var i=n.datePicker.state.value;i&&(a=i.format(V)),t({expireTimeType:2,expireTime:a,valid:!(2===e&&(a&&T()().valueOf()>T()(a,V)||!a))})}else t({expireTimeType:1,valid:!0})},n.handleSetExpireTime=function(e){var t=n.props.updateNps,a="";if(e){a=e.format(V);var i=T()().valueOf()<T()(a,V);t({expireTime:a,valid:i,expireTimeType:2})}else setTimeout((function(){t({expireTimeType:1,valid:!0})}),0)},n.renderBody=function(e,t){var a=n.props.nps,l=a.expireTimeType,r=a.expireTime,o=a.valid,c=n.state;c.recycleRules,c.recycleForm;if("delete"===e)return s.createElement("span",{className:"cd-delete"},"\u5220\u9664\u540e\uff0c\u6b64\u95ee\u5377\u53ca\u5176\u56de\u6536\u7684\u7b54\u5377\u4e5f\u5c06\u4f5c\u5e9f");if("edit"===e){if("CLOSED"===t.status)return s.createElement("span",{className:"cd-delete"},"\u95ee\u5377\u300c\u5df2\u5173\u95ed\u300d\uff0c\u5982\u679c\u5ba2\u6237\u6709\u6536\u5230\u5206\u53d1\u94fe\u63a5\uff0c\u5219\u83b7\u5f97\u7684\u53cd\u9988\u662f\u201c\u95ee\u5377\u5df2\u7ed3\u675f\u201d\uff1b\u540c\u65f6\u4f60\u4e0d\u80fd\u4fee\u589e\u5220\u9898\u578b\u53ca\u589e\u5220\u9009\u9879\uff0c\u4f46\u53ef\u4ee5\u5bf9\u6587\u6848\u505a\u8c03\u6574");if("DISPATCHED"===t.status)return s.createElement("span",{className:"cd-delete"},"\u95ee\u5377\u300c\u5df2\u53d1\u5e03\u300d\uff0c\u4f60\u4e0d\u80fd\u518d\u5bf9\u9898\u578b\u548c\u9009\u9879\u505a\u589e\u5220\uff0c\u4f46\u53ef\u4ee5\u5bf9\u6587\u6848\u505a\u8c03\u6574\u3002")}else if("switch"===e){if("DISPATCHED"===t.status)return s.createElement("span",{className:"cd-delete"},"\u7cfb\u7edf\u5c06\u505c\u6b62\u7b54\u5377\u56de\u6536");if("CLOSED"===t.status)return s.createElement("span",{className:"cd-delete"},"\u91cd\u65b0\u6253\u5f00\u6b64\u95ee\u5377\u540e\uff0c\u5c06\u7ee7\u7eed\u56de\u6536\u5ba2\u6237\u63d0\u4ea4\u7684\u7b54\u5377")}else if("dispatch"===e){if("CLOSED"===t.status)return s.createElement("span",{className:"cd-delete"},"\u6b64\u95ee\u5377\u5f53\u524d\u5904\u4e8e\u300c\u5df2\u5173\u95ed\u300d\u72b6\u6001\uff0c\u5df2\u505c\u6b62\u5bf9\u7b54\u5377\u7684\u6536\u96c6\u3002 \u6253\u5f00\u540e\uff0c\u95ee\u5377\u7684\u72b6\u6001\u5c06\u5207\u6362\u4e3a\u300c\u5df2\u53d1\u5e03\u300d\uff0c\u5c06\u7ee7\u7eed\u6536\u96c6\u7b54\u5377\uff0c\u5305\u62ec\u901a\u8fc7\u4e4b\u524d\u5206\u53d1\u7684\u94fe\u63a5\u3002");if("UN_DISPATCH"===t.status)return s.createElement("span",{className:"cd-delete"},"\u6b64\u95ee\u5377\u5f53\u524d\u5904\u4e8e\u300c\u672a\u53d1\u5e03\u300d\u72b6\u6001\uff0c\u4f60\u53ef\u4ee5\u81ea\u7531\u7f16\u8f91\u95ee\u5377\u91cc\u9762\u7684\u5185\u5bb9\u3002\u5f53\u95ee\u5377\u5904\u4e8e\u300c\u5df2\u5206\u53d1\u300d\u6216\u300c\u5df2\u5173\u95ed\u300d\u72b6\u6001\u65f6\uff0c\u4e0d\u652f\u6301\u589e\u5220\u9898\u76ee\uff0c\u4ee5\u53ca\u589e\u5220\u9009\u9879\u3002")}else if("updateNpsTime"===e){var u={defaultValue:r?T()(r,V):T()(),disabled:1===l,getDateRange:n.handleSetExpireTime,disabledDate:function(e){if(!e)return!1;var t=T()();return e.valueOf()<t.valueOf()}};return s.createElement("div",{className:"update-nps-time"},s.createElement("div",null,"\u6709\u6548\u65e5\u671f"),s.createElement("div",{className:o?"":"invalid"},s.createElement(H.Radio,{value:1,checked:1===l,onChange:n.switchExpireTimeType},"\u957f\u671f\u6709\u6548"),s.createElement(H.Radio,{value:2,checked:2===l,onChange:n.switchExpireTimeType},s.createElement("span",{style:{marginRight:"8px"}},"\u5230"),s.createElement(R.M,(0,i.Z)({ref:function(e){return n.datePicker=e}},u)),s.createElement("span",{style:{marginLeft:"8px"}},"\u5c31\u5931\u6548"))))}},n._handleOnCancel=function(){n.state.type;n.setState({visible:!1,callback:void 0,nps:void 0,type:""})},n._handleOnConfrim=function(){var e=n.state,t=e.callback,a=e.nps,i=e.type,l=(e.recycleForm,n.props.nps.valid);("delete"===i||"edit"===i||"switch"===i||"dispatch"===i||"updateNpsTime"===i&&l)&&(n.setState({visible:!1,callback:void 0,nps:void 0,type:""}),t&&t(i,a))},n.state={visible:!1,callback:void 0,nps:void 0},n}return(0,l.Z)(t,e),t.prototype.render=function(){var e=this.state,t=e.visible,n=e.type,a=e.nps;return s.createElement(H.Dialog,{className:"simple-dialog-wrapper simple-dialog-warning",size:"tiny",visible:t,title:this.renderTitle(n,a),closeOnClickModal:!1,onCancel:this._handleOnCancel},s.createElement(H.Dialog.Body,null,this.renderBody(n,a)),s.createElement(H.Dialog.Footer,null,s.createElement("span",null,s.createElement(H.Button,{onClick:this._handleOnCancel},"\u53d6\u6d88"),s.createElement(H.Button,{type:"primary",onClick:this._handleOnConfrim},"edit"===n?"\u7f16\u8f91\u95ee\u5377":"\u786e\u5b9a"))))},t}(s.PureComponent);var U=function(e){e.value,e.list,e.getValue;var t=function(){document.querySelector(".manage_dialog")&&document.querySelector(".manage_dialog").remove()};return s.createElement("div",{className:"yt_modal_warning_prefer_wrapper"},s.createElement("div",{className:"section"},s.createElement("div",{onClick:function(){t(),setTimeout((function(){return window.open("/research/questionnaireEdit")}),100)}},"+ \u7a7a\u767d\u521b\u5efa"),s.createElement("div",{onClick:function(){t(),setTimeout((function(){return window.open("/research/questionnaireEdit?type=NPS")}),100)}},s.createElement("p",null,"NPS\u8c03\u67e5"),s.createElement("div",{className:"tag"},s.createElement("span",null,"NPS")),s.createElement("div",{className:"total"},"\u5171 2 \u9898")),s.createElement("div",{onClick:function(){t(),setTimeout((function(){return window.open("/research/questionnaireEdit?type=SATISFACTION")}),100)}},s.createElement("p",null,"\u6ee1\u610f\u5ea6\u8c03\u67e5"),s.createElement("div",{className:"tag"},s.createElement("span",null,"\u6ee1\u610f\u5ea6")),s.createElement("div",{className:"total"},"\u5171 2 \u9898"))))};const B=U;U.propTypes={value:y().object,getValue:y().func};var Y=n(57522);n(53294);var J=n(56697),G=(n(7940),n(31059)),K=(n(43378),n(62443)),Q=(n(35797),n(64749)),X=(n(59567),n(8799)),$=(n(75314),n(11187)),ee=n(15861),te=(n(29809),n(97538)),ne=n(87757),ae=n.n(ne);const ie=function(e){var t=e.visible,n=e.questionnaireId,a=e.onClose,i=e.userList,l=e.teamList,r=e.webhookList,o=e.projectId,c=te.Z.useForm()[0],u={noticeCount:[{required:!0,message:"\u8bf7\u586b\u5199\u76ee\u6807\u6570\u503c"}],singleNotice:[{required:!0,message:"\u8bf7\u586b\u5199\u76ee\u6807\u6570\u503c"}],notifyWay:[{required:!0,message:"\u8bf7\u81f3\u5c11\u8bbe\u7f6e1\u4e2a\u63a8\u9001\u65b9\u5f0f"}]},p=(0,s.useState)({}),d=p[0],m=p[1],f=(0,s.useState)({noticeCount:100,singleNotice:1,teamList:[],userList:[],notifyWay:[],fsWebhooks:[],dtWebhooks:[]}),h=f[0],v=f[1],g=(0,s.useState)(!1),y=g[0],E=g[1],C=(0,s.useState)(!1),b=C[0],N=C[1],_=(l||[]).map((function(e){return{label:e.name,value:e.id}})),w=(i||[]).map((function(e){return{label:e.username,value:e.id}})),S=[],T=[];(r||[]).forEach((function(e){"ENABLE"===e.status&&("FEISHU"===e.type?S.push({label:e.name,value:e.id}):"DINGDING"===e.type&&T.push({label:e.name,value:e.id}))}));var k=function(){var e=(0,ee.Z)(ae().mark((function e(){var t,a,i,l,r,s,u,p,m,f;return ae().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.validateFields();case 2:if(t=e.sent,o||d.warningId||n){e.next=5;break}return e.abrupt("return",$.default.error("\u9879\u76eeID\u548c\u95ee\u5377ID\u4e0d\u80fd\u4e3a\u7a7a"));case 5:a=t.noticeCount,i=t.singleNotice,l=t.teamList,r=t.userList,s=t.notifyWay,u=t.fsWebhooks,p=t.dtWebhooks,m=[],u&&u.length&&u.forEach((function(e){m.push({type:"FEISHU",webhookId:e,key:null})})),p&&p.length&&p.forEach((function(e){m.push({type:"DINGDING",webhookId:e,key:null})})),f={projectId:o,questionnaireId:n,warningId:d.warningId,status:d.status||"ENABLE",noticeCount:a,singleNotice:i,rules:[{type:"RECALL_COUNT",threshold:a},{type:"RECALL",threshold:i}],condition:{pushWay:s,webHookModels:m},receiverTeamIdList:l,receiverUserIdList:r},(0,A.Is)(f).then((function(e){2e4===e.data.code&&($.default.success("\u8bbe\u7f6e\u6210\u529f\uff01"),I())}));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=function(){c.resetFields(),a()};return(0,s.useEffect)((function(){n&&(0,A.lO)({questionnaireId:n}).then((function(e){2e4===e.data.code?function(e){var t,n,a,r,o;m(e);var s=null==e||null==(t=e.rules)||null==(n=t.find((function(e){return"RECALL_COUNT"===e.type})))?void 0:n.threshold,u=null==e||null==(a=e.rules)||null==(r=a.find((function(e){return"RECALL"===e.type})))?void 0:r.threshold,p=[],d=[],f=[],h=[];Array.isArray(e.receiverTeamIdList)&&(p=e.receiverTeamIdList.filter((function(e){return(l||[]).some((function(t){return t.id===e}))}))),Array.isArray(e.receiverUserIdList)&&(d=e.receiverUserIdList.filter((function(e){return(i||[]).some((function(t){return t.id===e}))})));try{e.condition.webHookModels.forEach((function(e){e.webhookId&&"FEISHU"===e.type?f.push(e.webhookId):e.webhookId&&"DINGDING"===e.type&&h.push(e.webhookId)}))}catch(b){f=[],h=[]}var g={warningId:e.warningId,status:e.status,noticeCount:s||10,singleNotice:u||100,teamList:p,userList:d,notifyWay:(null==(o=e.condition)?void 0:o.pushWay)||[],fsWebhooks:f,dtWebhooks:h};v(g),c.setFieldsValue(g);var y=g.notifyWay.includes("DINGDING_CHAT"),C=g.notifyWay.includes("FEISHU_CHAT");E(y),N(C)}(e.data.result):console.error(e.data.msg)}))}),["questionnaireId"]),s.createElement(J.Z,{visible:t,title:"\u901a\u77e5\u8bbe\u7f6e",className:"yt-nps-notify-modal",width:480,onOk:k,onCancel:I},s.createElement(te.Z,{form:c,initialValues:h},s.createElement(te.Z.Item,null,s.createElement(s.Fragment,null,s.createElement("span",null,"\u63d0\u4ea4\u7b54\u5377\u6570\u8fbe\u5230"),s.createElement(te.Z.Item,{name:"noticeCount",rules:u.noticeCount,noStyle:!0},s.createElement(X.Z,{max:9999999999,min:1,precision:0})),s.createElement("span",null,"\u4efd\u65f6\u901a\u77e5\u6211"))),s.createElement(te.Z.Item,null,s.createElement(s.Fragment,null,s.createElement("span",null,"\u6bcf\u56de\u6536"),s.createElement(te.Z.Item,{name:"singleNotice",rules:u.singleNotice,noStyle:!0},s.createElement(X.Z,{max:9999999999,min:1,precision:0})),s.createElement("span",null,"\u4efd\u7b54\u5377\u65f6\u901a\u77e5\u6211"))),s.createElement("div",{className:"diviline"}),s.createElement(te.Z.Item,{label:"\u63a8\u9001\u7528\u6237\u7ec4",name:"teamList",colon:!1},s.createElement(Q.default,{mode:"multiple",options:_,optionFilterProp:"label",showArrow:!0})),s.createElement(te.Z.Item,{label:"\u63a8\u9001\u6210\u5458",name:"userList",colon:!1},s.createElement(Q.default,{mode:"multiple",options:w,optionFilterProp:"label",showArrow:!0})),s.createElement(te.Z.Item,{label:"\u63a8\u9001\u65b9\u5f0f",name:"notifyWay",required:!0,rules:u.notifyWay,colon:!1},s.createElement(G.default.Group,{onChange:function(){var e=c.getFieldValue("notifyWay"),t=e.includes("DINGDING_CHAT"),n=e.includes("FEISHU_CHAT");E(t),N(n),t||c.setFieldsValue({dtWebhooks:[]}),n||c.setFieldsValue({fsWebhooks:[]})}},[{label:"\u5fae\u4fe1\u901a\u77e5",value:"WEIXIN"},{label:"\u9489\u9489\u7fa4\u901a\u77e5",value:"DINGDING_CHAT"},{label:"\u98de\u4e66\u7fa4\u901a\u77e5",value:"FEISHU_CHAT"},{label:"\u90ae\u4ef6\u901a\u77e5",value:"EMAIL"}].map((function(e){return s.createElement(G.default,{key:e.value,value:e.value,checked:h.notifyWay&&h.notifyWay.includes(e.value)},e.label,"WEIXIN"===e.value&&s.createElement(K.default,{content:s.createElement("div",{style:{maxWidth:200,fontSize:12}},"\u7cfb\u7edf\u9ed8\u8ba4\u7ed9\u7ed1\u5b9a\u4e86\u5fae\u4fe1\u7684\u7528\u6237\u63a8\u9001\u5fae\u4fe1\u901a\u77e5\u3002\u5982\u672a\u7ed1\u5b9a\uff0c\u53ef\u524d\u5f80\u201c\u4e2a\u4eba\u4e2d\u5fc3/\u4e2a\u4eba\u8d44\u6599\u201d\u9875\u9762\u626b\u7801\u7ed1\u5b9a\u5fae\u4fe1\u3002",s.createElement("br",null),s.createElement("a",{href:"/personalSettings/overview",target:"_black",style:{color:"#1890FF"}},"\u7acb\u5373\u524d\u5f80"))},s.createElement("i",{className:"icon-cem_file1",style:{fontSize:14,color:"#979797",marginLeft:4}})))})))),s.createElement(te.Z.Item,null,s.createElement(s.Fragment,null,(y||b)&&s.createElement("div",{className:"notice"},s.createElement("span",null,"\u7fa4\u901a\u77e5"),s.createElement("a",{href:"/account/project/webhookList",target:"_blank"},"\u914d\u7f6eWebhook\u540e\uff0c\u624d\u80fd\u4f7f\u7528\u7fa4\u901a\u77e5>")),y&&s.createElement(te.Z.Item,{className:"push_way_chats",name:"dtWebhooks",label:"\u9489\u9489\u7fa4Webhook",colon:!1},s.createElement(Q.default,{mode:"multiple",showArrow:!0,options:T,placeholder:"\u8bf7\u9009\u62e9Webhook\u5730\u5740"})),b&&s.createElement(te.Z.Item,{className:"push_way_chats",name:"fsWebhooks",label:"\u98de\u4e66\u7fa4Webhook",colon:!1},s.createElement(Q.default,{mode:"multiple",showArrow:!0,options:S,placeholder:"\u8bf7\u9009\u62e9Webhook\u5730\u5740"}))))))};var le=n(19155),re=n.n(le),oe=n(49101),se=["key","name","fieldKey"],ce=Q.default.Option;const ue=function(e){var t=e.loading,n=e.data,l=e.name,o=e.pageIndex,p=e.pageSize,d=e.sortType,m=e.questionnaireType,f=e.onPageChange,h=e.onPaseSizeChange,v=e.onBtnClick,g=e.onFilterChange,y=e.productData,E=e.onFilterProduct,C=(0,s.useState)(0),b=C[0],N=C[1],_=(0,s.useState)(!1),w=_[0],S=_[1],T=(0,s.useState)([]),k=T[0],D=T[1],P=(0,s.useState)(0),x=P[0],L=P[1],F=function(){var e=document.getElementById("nps_manage_list");N(e.clientWidth)},A=function(e,t){var n;D((0,i.Z)({},k,((n={})[t]=function(e){return re()(null==y?void 0:y.map((function(t){return{value:t[e],label:t[e]}})),"value")}(e),n)))};(0,s.useEffect)((function(){return window.addEventListener("resize",F),F(),function(){return window.removeEventListener("resize",F)}}),[]);return s.createElement("div",{className:"table"},s.createElement("div",{className:"filter-wrapper"},s.createElement(c.Z,{className:"yt_nps_manage_search_wrap",style:{width:150},placeholder:"\u641c\u7d22\u95ee\u5377\u540d\u79f0",defValue:l,onClear:function(e){return g&&g({name:e})},onSearch:function(e){return g&&g({name:e})}}),s.createElement(u.Z,{options:I.nx,onChange:g,objName:"questionnaireType",preTitle:"\u4f53\u9a8c\u9898\u578b",divider:"none",type:"button",activeObj:m,sufIcon:"icon-cem_pull-down-or-take-up"}),s.createElement("button",{className:"more-button "+(w?"primary-button":"default-button"),onClick:function(){return S(!w)}},s.createElement("span",null,"\u66f4\u591a"),0!==x&&s.createElement("span",{className:"badge"},x),s.createElement("i",{className:"icon-cem_pull-down-or-take-up ",style:{color:w?"#fff":"#BEBEBE"}})),s.createElement("div",{className:"setting-filter-wrapper "+(w?"show-modal":"hide-modal")},s.createElement("div",{className:"title"},"\u8bbe\u7f6e\u66f4\u591a\u7b5b\u9009\u6761\u4ef6"),s.createElement(te.Z,{name:"filter",onFinish:function(e){E(e),S(!1)},autoComplete:"off"},s.createElement(te.Z.List,{name:"users"},(function(e,t){var n=t.add,l=t.remove;return s.createElement(s.Fragment,null,e.map((function(e){var t=e.key,n=e.name,r=e.fieldKey,o=(0,a.Z)(e,se);return s.createElement("div",{key:t,style:{display:"flex"}},s.createElement(te.Z.Item,(0,i.Z)({},o,{name:[n,"first"],fieldKey:[r,"first"],rules:[{required:!0,message:"\u8bf7\u9009\u62e9"}],className:"first-form",style:{width:"120px"}}),s.createElement(Q.default,{onChange:function(e){return A(e,r)}},s.createElement(ce,{value:"productVersion"},"\u4ea7\u54c1\u7248\u672c"),s.createElement(ce,{value:"productLine"},"\u4ea7\u54c1\u7ebf"))),s.createElement(te.Z.Item,(0,i.Z)({},o,{name:[n,"last"],fieldKey:[r,"last"],rules:[{required:!0,message:"\u8bf7\u9009\u62e9"}],className:"last-form",style:{width:"316px"}}),s.createElement(Q.default,{mode:"multiple",allowClear:!0,style:{width:"100%"},options:k[r],optionFilterProp:"label"})),s.createElement("i",{className:"icon-cem_cancel",onClick:function(){l(n),L(x-1)},style:{marginTop:"9px",color:"#BEBEBE"}}))})),e.length<3&&s.createElement(te.Z.Item,null,s.createElement("div",null,s.createElement("span",{onClick:function(){n(),L(x+1)},className:"add-button"},s.createElement(oe.Z,null),"\u6dfb\u52a0\u7b5b\u9009\u6761\u4ef6"))))})),s.createElement(te.Z.Item,{className:"buttom-form"},s.createElement(r.default,{onClick:function(){return S(!1)}},"\u53d6\u6d88"),s.createElement(r.default,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"))))),s.createElement("div",{className:"table_zone"},s.createElement(O,{activeColumnProps:[{label:"\u95ee\u5377\u540d\u79f0",value:"title",checked:!0},{label:"\u4f53\u9a8c\u9898\u578b",value:"questionnaireType",checked:!0},{label:"\u7b54\u5377\u6570",value:"submitted",checked:!0},{label:"\u6700\u540e\u4fee\u6539",value:"updatedAt",checked:!0}],order:d,data:n&&n.list instanceof Array?n.list:[],total:n?n.total:0,pageIndex:o,pageSize:p,loading:t,onClick:v,option:{width:b},onPageSizeChange:h,onPageChange:f,disableColumnSelect:!0,isThirdParty:!0})))};var pe=o.default.TabPane;const de=function(e){var t,n=e.activeColumnProps,a=e.loading,l=e.data,d=e.name,m=e.pageIndex,f=e.pageSize,h=e.sortType,v=e.nps,g=e.questionnaireType,y=(e.status,e.timeType,e.onPageChange),E=e.onPaseSizeChange,C=e.onColumnChange,b=e.onBtnClick,N=e.getNpsDialogRef,_=e.updateNps,w=e.onFilterChange,S=e.publicResource,T=e.onTabChange,k=e.onFilterProduct,P=e.showNotifyModal,x=e.onNotifyClose,L=e.teamList,F=e.userList,A=e.webhookList,Z=e.questionnaireId,q=e.projectId,z=(0,s.useState)(0),W=z[0],H=z[1],R=(0,s.useState)("list"),V=R[0],U=R[1],J=(0,s.useState)("system"),G=J[0],K=J[1],Q=function(){var e=document.getElementById("nps_manage_list");H(e.clientWidth)};return s.useEffect((function(){return window.addEventListener("resize",Q),function(){if(0!==location.search.length){var e=JSON.parse(decodeURIComponent(location.search.slice(1)));e.questionnaireId,"QUESTIONNAIRE_OTHER"===e.dataLevel?(K("thirdParty"),T("thirdParty")):(K("system"),T("system"))}}(),Q(),function(){return window.removeEventListener("resize",Q)}}),[]),s.createElement("div",{className:"yt_nps_manage_wrapper"},s.createElement(p.Z,{title:"\u95ee\u5377\u7ba1\u7406"}),s.createElement("div",{className:"yt_nps_manage_list_wrap",id:"nps_manage_list"},s.createElement(o.default,{activeKey:G,onChange:function(e){T(e),K(e)}},s.createElement(pe,{tab:"\u65b0\u5efa\u95ee\u5377",key:"system"},s.createElement("div",{className:"table"},s.createElement("div",{className:"filter-wrapper"},s.createElement(c.Z,{className:"yt_nps_manage_search_wrap",style:{width:150},placeholder:"\u641c\u7d22\u95ee\u5377\u540d\u79f0",defValue:d,onClear:function(e){return w&&w({name:e})},onSearch:function(e){return w&&w({name:e})}}),s.createElement(u.Z,{className:"yt_nps_select_questionnaire_type",options:I.nx,onChange:w,objName:"questionnaireType",preTitle:"\u4f53\u9a8c\u9898\u578b",divider:"none",type:"button",activeObj:g,sufIcon:"icon-cem_pull-down-or-take-up"}),s.createElement("div",{className:"yt_nps_manage_check_list_card"},s.createElement("span",{className:"list"===V?"iconfont active":"iconfont",onClick:function(){U("list")}},"\ue7c9"),s.createElement("span",{className:"card"===V?"iconfont active":"iconfont",onClick:function(){return U("card")}},"\ue680")),s.createElement("span",null,D.Z.hasAuthority("QUESTIONNAIRE_ADD")&&s.createElement(r.default,{type:"primary",onClick:function(){return new Promise((function(t,n){var a=(0,i.Z)({},e,{titleText:"\u9009\u62e9\u6a21\u677f",content:s.createElement(B,e),top:"50%",noFoot:!0,className:"manage_dialog"});a.onOk=function(){return t()},a.onCancel=n,(0,Y.Z)(a)}));var e}},"\u65b0\u5efa\u95ee\u5377"))),s.createElement("div",{className:"table_zone"},"list"===V?s.createElement(O,{activeColumnProps:n,order:h,data:l&&l.list instanceof Array?l.list:[],total:l?l.total:0,pageIndex:m,pageSize:f,loading:a,onClick:b,option:{width:W},onPageSizeChange:E,onPageChange:y,onColumnChange:C,onChange:w,options:I.hm}):s.createElement(M,{data:l&&l.list instanceof Array?l.list:[],total:l?l.total:0,pageIndex:m,pageSize:f,onClick:b,loading:a,onPageSizeChange:E,onPageChange:y})))),s.createElement(pe,{tab:"\u5bfc\u5165\u95ee\u5377",key:"thirdParty"},s.createElement(ue,{productData:null==S||null==(t=S.PRODUCT_INFO)?void 0:t.data,activeColumnProps:n,loading:a,data:l,name:d,pageIndex:m,pageSize:f,sortType:h,questionnaireType:g,onPageChange:y,onPaseSizeChange:E,onColumnChange:C,onBtnClick:b,onFilterChange:w,onFilterProduct:k})))),s.createElement(j,{ref:N,nps:v,updateNps:_}),P&&s.createElement(ie,{visible:P,questionnaireId:Z,onClose:x,userList:F,teamList:L,webhookList:A,projectId:q}))};var me=n(55609),fe=n(61409),he=n(64396),ve=["loading"],ge=he.Z.research.npsManage,ye=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleFilterProduct=function(e){var t=n.props.fetchNpsList,a={productName:[],productVersion:[],productLine:[]};e.users.forEach((function(e){var t;a=(0,i.Z)({},a,((t={})[e.first]=e.last,t))})),t(a)},n._handleTabChange=function(e){var t=n.props,a=t.fetchNpsList,i=t.clean,l=t.fetchParams;i(),"system"===e?l({projectId:F.t.get(F.V.curProject).id,thirdParty:!1}):a({thirdParty:"thirdParty"===e})},n._handleOnColumnChange=function(e){n.props.save({activeColumnProps:e}),n.props.setDefaultValue({activeColumnProps:e})},n._handleOnFilterChange=function(e){var t=n.props,a=t.name,l=t.questionnaireType,r=t.status,o=t.sortName,s=t.sortType,c=t.intervalType;e.timeType?(n.props.fetchNpsList({sortName:e.timeType.split("_")[0],sortType:e.timeType.split("_")[1],pageIndex:1,name:a,questionnaireType:l,status:r,intervalType:c}),n.props.save({timeType:e.timeType})):(void 0!==e.name||e.questionnaireType||e.status||e.intervalType)&&(n.props.fetchNpsList((0,i.Z)({pageIndex:1,sortName:o,sortType:s,name:a,questionnaireType:e.questionnaireType||l,status:e.status||r,intervalType:e.intervalType||c},e)),n.props.save({questionnaireType:e.questionnaireType||l,status:e.status||r,intervalType:e.intervalType||c}))},n._handleOnPageChange=function(e){var t=n.props,a=t.name;(0,t.fetchNpsList)({pageIndex:e,name:a,questionnaireType:t.questionnaireType,status:t.status,sortName:t.sortName,sortType:t.sortType,intervalType:t.intervalType})},n._handleOnPageSizeChange=function(e){var t=n.props,a=t.name;(0,t.fetchNpsList)({pageSize:e,pageIndex:1,name:a,questionnaireType:t.questionnaireType,status:t.status,sortName:t.sortName,sortType:t.sortType,intervalType:t.intervalType})},n._handleOnBtnClick=function(e,t){var a=n.state.projectId,l=n.props.thirdParty;if("newNps"===e)fe.mW.push({pathname:"/nps/edit",state:{projectId:a}});else if("switch"===e)"DISPATCHED"===t.status?n.npsDialogRef.showDialog({type:"switch",nps:t,callback:function(e,t){n.props.updateNpsStatus({id:t.id,projectId:n.state.projectId,status:"CLOSED"})}}):"CLOSED"===t.status&&n.npsDialogRef.showDialog({type:"switch",nps:t,callback:function(e,t){n.props.updateNpsStatus({id:t.id,status:"DISPATCHED"})}});else if("edit"===e)"UN_DISPATCH"===t.status?window.open("/research/questionnaireEdit/edit?id="+t.id):n.npsDialogRef.showDialog({type:"edit",nps:t,callback:function(e,t){window.open("/research/questionnaireEdit/edit?id="+t.id)}});else if("dispatch"===e)"CLOSED"===t.status||"UN_DISPATCH"===t.status?n.npsDialogRef.showDialog({type:"dispatch",nps:t,callback:function(e,t){n.props.updateNpsStatus({id:t.id,status:"DISPATCHED",type:"UN_DISPATCH"}),fe.mW.push({pathname:"/research/manage/distribute",state:{id:t.id,title:t.title,questionnaireType:t.questionnaireType}})}}):fe.mW.push({pathname:"/research/manage/distribute",state:{id:t.id,title:t.title,questionnaireType:t.questionnaireType}});else if("detail"===e)fe.mW.push({pathname:"/research/manage/analysis",state:{questionnaireId:t.id,title:t.title,thirdParty:l,questionnaireType:t.questionnaireType,jumpType:t.jumpType}});else if("delete"===e)n.npsDialogRef.showDialog({type:"delete",nps:t,callback:function(e,t){n.props.deleteNps({id:t.id})}});else if("copy"===e)window.open("/research/questionnaireEdit/edit?id="+t.id+"&copy=true");else if("preview"===e)(0,A.Q2)({id:t.id}).then((function(e){var t=JSON.parse(e.data.result.newConfiguration),n=(0,i.Z)({questionslist:JSON.parse(e.data.result.newConfiguration).questions},t);F.t.set("pageConfig",JSON.stringify(n)),setTimeout((function(){window.open("/research/questionnaireAnswer/answer?type=1")}),200)}));else if("recycle"===e){var r=n.props,o=r.getUserAndTeamList,s=r.getWebhookList,c=r.teamList,u=r.userList,p=function(){n.setState({showNotifyModal:!0,questionnaireId:t.id})};s(),c.length&&u.length?p():o().then((function(){p()}))}},n._handleOnNotifyClose=function(){n.setState({showNotifyModal:!1,questionnaireId:""})},n.state={projectId:F.t.get(F.V.curProject).id,showNotifyModal:!1,questionnaireId:""},n._event={onFilterChange:n._handleOnFilterChange,onPageChange:n._handleOnPageChange,onPaseSizeChange:n._handleOnPageSizeChange,onBtnClick:n._handleOnBtnClick,onColumnChange:n._handleOnColumnChange,getNpsDialogRef:function(e){return n.npsDialogRef=e},onTabChange:n._handleTabChange,onFilterProduct:n._handleFilterProduct,onNotifyClose:n._handleOnNotifyClose},0===location.search.length&&t.fetchParams({projectId:F.t.get(F.V.curProject).id}),n}(0,l.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.init()},n.componentWillUnmount=function(){this.props.clean()},n.render=function(){return s.createElement(de,(0,i.Z)({},this.state,this.props,this._event))},t}(s.Component);const Ee=(0,me.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,ve);return(0,i.Z)({},n[ge],{publicResource:n[he.Z.global].publicResource,loading:t.effects[ge+"/fetchNpsList"]||!1})}),(function(e){return{fetchParams:function(t){return e({type:ge+"/fetchParams",payload:t})},fetchNpsList:function(t){return e({type:ge+"/fetchNpsList",payload:t})},deleteNps:function(t){return e({type:ge+"/deleteNps",payload:t})},updateNpsStatus:function(t){return e({type:ge+"/updateNpsStatus",payload:t})},copyNps:function(t){return e({type:ge+"/copyNps",payload:t})},updateNps:function(t){return e({type:ge+"/updateNps",payload:t})},updateNpsTime:function(t){return e({type:ge+"/updateNpsTime",payload:t})},setDefaultValue:function(t){return e({type:ge+"/setDefaultValue",payload:t})},save:function(t){return e({type:ge+"/save",payload:t})},clean:function(){return e({type:ge+"/clean"})},init:function(){return e({type:he.Z.global+"/init"})},getUserAndTeamList:function(){return e({type:ge+"/getUserAndTeamList"})},getWebhookList:function(){return e({type:ge+"/getWebhookList"})}}}))(ye)},55815:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var a=n(94578),i=n(67294),l=n(45697),r=n.n(l),o=n(43036),s=n(61409),c=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props,a=n.title,i=n.beforeJump;e!==a.length-1&&(i?new Promise((function(e,t){return i(e,t)})).then((function(){s.mW.push({pathname:a[e].url,state:a[e].state})})):s.mW.push({pathname:a[e].url,state:a[e].state}))},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.mainTitle,l=t.rightContent,r=t.className,s=t.overlay;return i.createElement("div",{className:"breadcumb-wrapper "+r},n instanceof Array?i.createElement("div",{className:"breadcrumb-left"},i.createElement("div",null,n.map((function(t,a){return i.createElement("span",{className:t.url?"":"not_clickable",key:a,onClick:function(){return t.url&&a!==n.length-1&&e._handleBreadcrumbClick(a)}},t.title,a!==n.length-1&&" / ")}))),i.createElement("span",null,a||n[n.length-1].title,s&&i.createElement(o.Z,{placement:"top",overlay:s},i.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}})))):i.createElement("div",{className:"normal-title"},n,s&&i.createElement(o.Z,{placement:"top",overlay:s},i.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}}))),l||"")},t}(i.Component);c.propTypes={className:r().string,title:r().oneOfType([r().string,r().arrayOf(r().shape({title:r().string,url:r().string,state:r().object}))]).isRequired,overlay:r().oneOfType([r().string,r().node]),mainTitle:r().oneOfType([r().string,r().node]),beforeJump:r().func,rightContent:r().node};const u=c},1179:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var a=n(94578),i=n(43036),l=n(45697),r=n.n(l),o=n(67294),s=n(39432),c=function(e){function t(t){var n;return(n=e.call(this,t)||this).getPanelWidth=function(){var e=n.props,t=e.flavor,a=e.options,i=e.rightHook,l=Math.max.apply(null,a.map((function(e){return(0,s.jD)(e.title,14)})))+2+10+32;return l+=void 0!==t?24:0,(l+=void 0!==i?30:0)>100?l:100},n._setPadShowFalse=function(){n.state.show&&n.setState({show:!1})},n._handleParentClick=function(e){n.state.show&&n.props.showFlavor&&n.props.enable&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},n._handleTriggerOnClick=function(){var e=n.state.show;n.props.enable&&setTimeout((function(){n.setState({show:!e})}),0)},n.state={show:!1,firstLiHover:!1,panelWidth:n.getPanelWidth()},n}(0,a.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){window.addEventListener("click",this._setPadShowFalse)},n.componentWillUnmount=function(){window.removeEventListener("click",this._setPadShowFalse)},n.componentDidUpdate=function(e){var t=e.options,n=this.props.options;JSON.stringify(t)!==JSON.stringify(n)&&this.setState({panelWidth:this.getPanelWidth()})},n.render=function(){var e=this.state,t=e.show,n=e.panelWidth,a=this.props,l=a.activeObj,r=a.onChange,s=a.options,c=a.objName,u=a.preTitle,p=a.sufTitle,d=void 0===p?"":p,m=a.showTitle,f=void 0===m||m,h=a.overlay,v=a.divider,g=void 0===v?"right":v,y=a.flavor,E=a.className,C=void 0===E?"":E,b=a.onFlavorChange,N=a.sufIcon,_=a.style,w=a.type,S=void 0===w?"text":w,T=a.enable,k=a.rightHook,I=s.find((function(e){return e.value===l})),D=void 0===typeof l?d:I&&I.title,P=void 0===typeof l?d:I&&I.icon;return o.createElement("div",{className:"single_select_button_wrapper single_select_diviver_"+g+" single-select-button_"+S+" "+C,style:_,onClick:this._handleParentClick},o.createElement("div",{className:"button_content "+(T?"":"button_content_disable")},o.createElement("span",{onClick:this._handleTriggerOnClick},o.createElement("span",{className:"button-trigger "+(t?"sel":"")},f&&o.createElement(o.Fragment,null,u&&o.createElement("span",{className:"pre-title"},u,"\uff1a"),P?o.createElement("i",{className:P+" word_icon_hover"}):o.createElement("span",{className:"button-title"},D)),o.createElement("i",{className:N||"icon-cem_pull-down-or-take-up",style:{transform:t?"rotate(-180deg)":""}})),h&&o.createElement("span",{style:{marginLeft:4}},o.createElement(i.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:h},o.createElement("i",{className:"icon-cem_file1"})))),o.createElement("div",{className:"button-panel "+(t?"active":""),style:{minWidth:n}},s.map((function(e,t){return o.createElement("div",{className:"panel-item "+(e.value===l?"sel":"")+" "+(e.disabled?"disabled":""),key:e.value,onClick:function(){var t;!e.disabled&&r(c?((t={})[c]=e.value,t):e.value)}},e.icon&&o.createElement("i",{className:e.icon+" panel-item-icon"}),o.createElement("span",{className:"ellipsis",style:{maxWidth:97.5}},e.title),void 0!==y&&o.createElement("i",{className:y===e.value?"icon-cem_star":"icon-cem_star-filling star_hide",onClick:function(t){var n,a,i;t.stopPropagation(),b(y===e.value?c?((n={})[c]="",n):"":c?((a={})[c]=e.value,a):e.value),r(c?((i={})[c]=e.value,i):e.value)}}),o.createElement("i",{className:e.value===l&&k?"icon-cem_right1 choice":""}))})))))},t}(o.PureComponent);c.defaultProps={enable:!0,activeObj:"",sufTitle:"",showTitle:!0,divider:"right",className:"",type:"text"},c.propTypes={activeObj:r().any,onChange:r().func.isRequired,options:r().array.isRequired,objName:r().any,preTitle:r().string,sufTitle:r().string,showTitle:r().bool,overlay:r().string,divider:r().oneOf(["both","left","right","none"]),flavor:r().string,onFlavorChange:r().func,className:r().string,sufIcon:r().string,style:r().object,type:r().oneOf(["button","text"]),enable:r().bool,rightHook:r().bool};const u=c},66130:(e,t,n)=>{"use strict";n.d(t,{M:()=>y,S:()=>S});var a=n(87462),i=n(94578),l=n(67294),r=n(45697),o=n.n(r),s=n(91751),c=n(98619),u=n.n(c),p=n(82784),d=n.n(p),m=n(30381),f=n.n(m),h=(n(83839),"YYYY-MM-DD");function v(e){if(!e)return!1;var t=f()();return e.valueOf()>t.valueOf()}var g=function(e){function t(t){var n;return(n=e.call(this,t)||this).onChange=function(e){n.setState({value:e},(function(){n.props.getDateRange(e)}))},n.onOpenChange=function(e){!n.state.disabled&&n.setState({open:e})},n.onFocus=function(){!n.state.open&&n.state.isMouseDown?n.setState({isMouseDown:!1}):n.setState({open:!0})},n.onMouseEnter=function(){var e=n.state,t=e.value,a=e.disabled;t&&!a&&n.setState({clearable:!0})},n.onMouseDown=function(){n.setState({isMouseDown:!0})},n.clearValue=function(){n.setState({value:null}),n.props.getDateRange("")},n.state={showDateInput:!0,disabled:t.disabled||!1,open:!1,value:t.defaultValue?t.defaultValue:f()(),clearable:!1},n}(0,i.Z)(t,e);var n=t.prototype;return n.UNSAFE_componentWillReceiveProps=function(e){var t=this.props,n=t.disabled,a=t.disabledDate,i=t.defaultValue;JSON.stringify(i)!==JSON.stringify(e.defaultValue)&&this.setState({value:e.defaultValue}),JSON.stringify(a)!==JSON.stringify(e.disabledDate)&&this.setState({disabledDate:e.disabledDate}),n!==e.disabled&&this.setState({disabled:e.disabled})},n.render=function(){var e=this,t=this.state,n=t.showDateInput,i=t.value,r=t.open,o=t.disabled,c=t.clearable,p={showDateInput:!0,locale:d(),showOk:!1,showToday:!1,format:h,renderFooter:function(){return null}},m=l.createElement(s.Z,(0,a.Z)({},p,{dateInputPlaceholder:"\u8bf7\u9009\u62e9\u65e5\u671f",showDateInput:n,disabledDate:this.props.disabledDate||v,focusablePanel:!1}));return l.createElement(u(),{animation:"slide-up",calendar:m,value:i,onChange:this.onChange,onOpenChange:this.onOpenChange,open:r,style:{zIndex:1014}},(function(t){var n=t.value;return l.createElement("span",{className:"ant-calendar-picker ant-calendar-picker-default",tabIndex:"0",onMouseDown:e.onMouseDown,onFocus:e.onFocus,onMouseEnter:e.onMouseEnter,onMouseLeave:function(){return e.setState({clearable:!1})}},l.createElement("div",null,l.createElement("input",{placeholder:"\u8bf7\u9009\u62e9\u65e5\u671f",disabled:o,readOnly:!0,tabIndex:"-1",className:o?"ant-calendar-picker-input ant-input disabled":"ant-calendar-picker-input ant-input",value:n&&n.format(h)||""}),l.createElement("i",{className:"icon-cem_time-controller .ant-calendar-picker-icon",style:{visibility:c?"hidden":"visible"}}),l.createElement("i",{className:"icon-cem_close-window .ant-calendar-picker-icon",style:{visibility:c?"visible":"hidden"},onClick:function(t){o||(t.stopPropagation(),e.clearValue())}})))}))},t}(l.Component);g.propTypes={defaultValue:o().object,getDateRange:o().func.isRequired,disabledDate:o().func,disabled:o().bool};const y=g;var E=n(59108),C=n.n(E),b="YYYY-MM-DD";function N(e){return e?e.format(b):""}function _(e){return e&&e[0]&&e[1]}function w(e){return!!e&&f()().valueOf()<e.valueOf()}var S=function(e){function t(t){var n;return(n=e.call(this,t)||this).onChange=function(e){n.setState({value:e});var t=e.map((function(e){return N(e)}));n.props.getDateRange(t)},n.onHoverChange=function(e){n.setState({hoverValue:e})},n.onFocus=function(){!n.state.open&&n.state.isMouseDown?n.setState({isMouseDown:!1}):n.setState({open:!0})},n.onMouseDown=function(){n.setState({isMouseDown:!0})},n.onMouserEnter=function(){_(n.state.value)&&n.setState({clearable:!0})},n.clearValue=function(){n.setState({value:[]}),n.props.getDateRange(["",""])},n.state={disabled:!1,showDateInput:!1,value:t.defaultValue||[],hoverValue:[],clearable:!1},n}return(0,i.Z)(t,e),t.prototype.render=function(){var e=this,t=this.state,n=t.value,i=t.hoverValue,r=t.clearable,o=t.disabled,s=t.defaultValue,c={showDateInput:!1,locale:d(),showOk:!1,showToday:!1,format:b,renderFooter:function(){return null}},p=l.createElement(C(),(0,a.Z)({},c,{hoverValue:i,onHoverChange:this.onHoverChange,dateInputPlaceholder:["\u5f00\u59cb\u65e5\u671f","\u7ed3\u675f\u65e5\u671f"],defaultValue:s,disabledDate:w})),m=_(n);return l.createElement(u(),{animation:"slide-up",calendar:p,value:n,onChange:this.onChange},(function(t){var n=t.value;return l.createElement("span",{tabIndex:"0",className:"ant-calendar-picker",onMouseDown:e.onMouseDown,onFocus:e.onFocus},l.createElement("span",{className:"ant-calendar-picker-input ant-input",onMouseEnter:e.onMouserEnter,onMouseLeave:function(){e.setState({clearable:!1})}},l.createElement("input",{placeholder:"\u5f00\u59cb\u65e5\u671f",style:{width:130},disabled:o,readOnly:!0,tabIndex:"-1",className:"ant-calendar-range-picker-input",value:m&&""+N(n[0])||""}),l.createElement("span",null,"\u81f3"),l.createElement("input",{placeholder:"\u7ed3\u675f\u65e5\u671f",style:{width:130},disabled:o,readOnly:!0,tabIndex:"-1",className:"ant-calendar-range-picker-input",value:m&&""+N(n[1])||""}),l.createElement("i",{className:"icon-cem_time-controller",style:{visibility:m?"hidden":"visible"}}),l.createElement("i",{className:"icon-cem_close-window",style:{visibility:r?"visible":"hidden"},onClick:function(t){t.stopPropagation(),e.clearValue()}})))}))},t}(l.Component);S.propTypes={defaultValue:o().array,getDateRange:o().func.isRequired,disabledDate:o().func,disabled:o().bool}},61918:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var a=n(67294),i=n(45697),l=n.n(i),r=function(e){var t=e.className,n=e.onClear,i=e.onSearch,l=e.placeholder,r=e.style,o=e.defValue,s=e.signal,c=a.useState(o),u=c[0],p=c[1];a.useEffect((function(){p(o)}),[o,s]);return a.createElement("div",{style:r,className:"yt_search_input_wrapper "+(t||"")},a.createElement("input",{placeholder:l,value:u,onKeyDown:function(e){13===e.keyCode&&i(u)},onChange:function(e){return p(e.target.value)},autoComplete:"off"}),u&&a.createElement("i",{className:"icon-cem_log-off",onClick:function(){p(""),n&&n("")}}),a.createElement("i",{className:"icon-cem_small-search",onClick:function(){return i(u)}}))};r.propTypes={className:l().string,onSearch:l().func.isRequired,placeholder:l().string,style:l().object,defValue:l().string,signal:l().any,onClear:l().func};const o=r},76589:(e,t,n)=>{var a={"./bg1.png":27246,"./bg2.png":68286,"./bg3.png":41289,"./smallPic1.png":98422,"./smallPic2.png":76237,"./smallPic3.png":82770};function i(e){var t=l(e);return n(t)}function l(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=l,e.exports=i,i.id=76589},77153:(e,t,n)=>{"use strict";e.exports=n.p+"img/ca022b95fd75dfac3fc4.png"}}]);