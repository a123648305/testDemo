"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[5806],{89165:(e,n,t)=>{t.r(n),t.d(n,{default:()=>M});var a=t(63366),r=t(87462),i=t(94578),o=t(18446),l=t.n(o),c=t(64396),d=t(53113),u=t(55609),f=t(35239),s=t(67294),p=(t(15086),t(94055)),C=t(39432),h=t(76893),y=t(35103),m=t(7566),T=t(89212);const g=function(e){var n,t,a=e.onMsgClick,r=e.dataSource,i=e.onLookMsgClick,o=e.concernPagination,l=e.dateGroupType,c=e.filterReady,d=e.filterChange,u=e.outsideFilter,f=e.onChangeCardBarTable,g=e.fetchingConcernAnalyzeData,A=e.concernAnalyzeCardBarData,E=e.fetchingConcernAnalyzeCardBarData,D=e.onConcernMsgClick,v=e.concernAnalyzeTableData,I=e.fetchingConcernAnalyzeTableData,O=e.concernAnalyzeCardBarTotalCount,_=e.concernAnalyzeCardBarTotalPreCount;return s.createElement("div",{className:"yt_serviceInsight_concernAnalyze_wrapper"},s.createElement(y.Z,{onReady:c,onChange:d,pageType:"WAITER_SESSION_FOCUS",advanceAuthority:!1,screenValue:u&&u.headerFilterParamsNew,dateValue:u&&u.dateFilter,valueConf:["fullInfo"],showList:["quickDate","screening","save"]},s.createElement("div",{className:"content"},s.createElement("div",{style:{margin:"16px 0"}},s.createElement(m.Z,{titleOverlay:"\u7edf\u8ba1\u4e00\u3001\u4e8c\u7ea7\u5173\u6ce8\u70b9\u7684\u5173\u6ce8\u70b9\u58f0\u91cf\uff0c\u5982\u679c\u4e00\u4e2a\u4f1a\u8bdd\u4e2d\u63d0\u5230\u76f8\u540c\u7684\u5173\u6ce8\u70b9\u591a\u6b21\uff0c\u5219\u8be5\u5173\u6ce8\u70b9\u7684\u58f0\u91cf\u53ea\u8ba11\u6b21\u3002\u5982\u679c\u4e00\u4e2a\u4f1a\u8bdd\u4e2d\u63d0\u5230\u540c\u4e00\u4e2a\u300c\u4e00\u7ea7\u5173\u6ce8\u70b9\u300d\u7684\u4e0d\u540c\u300c\u4e8c\u7ea7\u5173\u6ce8\u70b9\u300dn\u6b21\uff0c\u5219\u5404\u300c\u4e8c\u7ea7\u5173\u6ce8\u70b9\u300d\u7684\u5173\u6ce8\u70b9\u58f0\u91cf\u53ea\u8ba11\u6b21\uff1b\u800c\u8be5 \u300c\u4e00\u7ea7\u5173\u6ce8\u70b9\u300d\u8ba1n\u6b21\u3002",loading:g,dataSource:r,columns:(n=i,t=l,[{titlie:"",width:"0.1%"},{title:"\u65e5\u671f",dataIndex:"name",key:"name",width:"25%",render:function(e){return s.createElement("span",null,(0,C.Sn)(t,e))}},{title:"\u5173\u6ce8\u70b9\u58f0\u91cf",dataIndex:"count",key:"count",width:"25%",render:function(e){return s.createElement("span",null,(0,C.uf)(e))}},{title:function(e){return s.createElement("span",{style:{paddingLeft:20}},"\u73af\u6bd4",s.createElement(p.default,{overlay:"\u73af\u6bd4 = (\u5f53\u671f\u5173\u6ce8\u70b9\u58f0\u91cf\uff0d\u5f80\u671f\u5173\u6ce8\u70b9\u58f0\u91cf\uff09\xf7 \u5f80\u671f\u5173\u6ce8\u70b9\u58f0\u91cf \xd7 100%"},s.createElement("i",{style:{marginLeft:4},className:"icon-cem_file1"})))},dataIndex:"linkIndex",key:"linkIndex",width:"28%",render:function(e){return"--"===(0,T.Sv)(e.icon)?s.createElement("div",{style:{marginLeft:"40px"}},"--"):s.createElement("div",{style:{display:"inline-block",width:100,textAlign:"right"}},e.text,(0,T.Sv)(e.icon))}},{title:"\u64cd\u4f5c",key:"operator",width:"15%",render:function(e){return s.createElement("span",{style:{color:"#1890FF",cursor:"pointer"},onClick:function(){return n(e)}},"\u67e5\u770b\u6d88\u606f")}}]),title:"\u5173\u6ce8\u70b9\u58f0\u91cf",onMsgClick:a,pagination:o,tooltipText:"\u5173\u6ce8\u70b9\u58f0\u91cf",timeType:l})),s.createElement("div",{style:{marginBottom:25}},s.createElement(h.Z,{pageType:"WAITER_SESSION_FOCUS",data:A,tableData:v,totalPreCount:_,totalCount:O,title:"\u5173\u6ce8\u70b9\u5206\u6790",loading:E,tableLoading:I,onChange:f,onMsgClick:D})))))};var A=t(87219),E=t(30381),D=t.n(E);function v(e,n){return"HOUR"===n?{from:D()(e).format("YYYY-MM-DD HH:00:00"),to:D()(e).format("YYYY-MM-DD HH:59:59")}:{from:D()(e).format("YYYY-MM-DD HH:00:00"),to:D()(e).format("YYYY-MM-DD 23:59:59")}}var I=["loading"],O=c.Z.service.concernAnalyze,_=function(e){function n(n){var t;return(t=e.call(this,n)||this).events=void 0,t._handleFilterReady=function(e,n){var a=(0,d.X)(e.dateFilter.numOfDays,!0),r=a.dateOptions,i=a.defaultDateType;t.props.fetchParams({projectId:f.t.get(f.V.curProject).id,headerFilterParamsNew:e.headerFilterParamsNew,dateFilter:e.dateFilter,dateOptions:r,defaultDateType:i,dateGroupType:l()(e.dateFilter.from,e.dateFilter.to)?"HOUR":"DAY"})},t._handleFilterChange=function(e,n,a){var i=(0,d.X)(e.dateFilter.numOfDays,!0),o=i.dateOptions,c=i.defaultDateType;t.props.fetchDatas((0,r.Z)({},e,{dateOptions:o,defaultDateType:c,dateGroupType:l()(e.dateFilter.from,e.dateFilter.to)?"HOUR":"DAY"}))},t._handleOnChangeCardBarTable=function(e,n){if("name"===n)t.props.fetchConcernAnalyzeTableData({aspect1:e})},t._handleOnChartClick=function(e){},t._handleOnLookMsgClick=function(e){var n=t.props,a=n.headerFilterParamsNew,i=n.dateFilter,o=n.projectId,l=n.dateGroupType,c=n.concernAnalyzeCardBarData,d=v(e.name.replaceAll("/","-"),l),u=d.from,f=d.to,s={dateFilter:(0,r.Z)({},i,{numOfDays:1,dateGroupType:l,from:u,to:f,quickChoice:u.replace(/-/g,".")+" - "+f.replace(/-/g,".")}),filterModel:{project:[o]},projectId:o,filterTip:null,headerFilterParamsNew:(0,A.ZP)(a,(function(e){e.find((function(e){return"WAITER_MODEL"===e.id}))?e.find((function(e){return"WAITER_MODEL"===e.id})).values=[{id:"WAITER_ASPECT1",values:c.map((function(e){return e.name}))}]:e.push({id:"WAITER_MODEL",values:[{id:"WAITER_ASPECT1",values:c.map((function(e){return e.name}))}]})}))};window.open("/inbox/service?"+encodeURIComponent(JSON.stringify(s)))},t._handleOnMsgClick=function(e,n){var a=t.props,i=a.headerFilterParamsNew,o=a.dateFilter,l=a.projectId,c=a.dateGroupType,d=a.concernAnalyzeCardBarData,u=v(e[0].data.name.replaceAll("/","-"),c),f=u.from,s=u.to,p={dateFilter:(0,r.Z)({},o,{numOfDays:1,dateGroupType:c,from:f,to:s,quickChoice:f.replace(/-/g,".")+" - "+s.replace(/-/g,".")}),filterModel:{project:[l]},projectId:l,filterTip:null,headerFilterParamsNew:(0,A.ZP)(i,(function(e){e.find((function(e){return"WAITER_MODEL"===e.id}))?e.find((function(e){return"WAITER_MODEL"===e.id})).values=[{id:"WAITER_ASPECT1",values:d.map((function(e){return e.name}))}]:e.push({id:"WAITER_MODEL",values:[{id:"WAITER_ASPECT1",values:d.map((function(e){return e.name}))}]})}))};window.open("/inbox/service?"+encodeURIComponent(JSON.stringify(p)))},t._handleOnConcernMsgClick=function(e,n,a){var r=t.props,i=r.headerFilterParamsNew,o=r.dateFilter,l=r.projectId;if("card"===n||"bar"===n){var c={dateFilter:"\u5f80\u671f"===e.seriesName?(0,T.yz)(o):o,filterModel:{project:[l]},projectId:l,filterTip:null,headerFilterParamsNew:(0,A.ZP)(i,(function(t){t.find((function(e){return"WAITER_MODEL"===e.id}))?t.find((function(e){return"WAITER_MODEL"===e.id})).values=[{id:"WAITER_ASPECT1",values:"card"===n?e:[e.name]}]:t.push({id:"WAITER_MODEL",values:[{id:"WAITER_ASPECT1",values:"card"===n?e:[e.name]}]})}))};window.open("/inbox/service?"+encodeURIComponent(JSON.stringify(c)))}else if("table"===n){var d={dateFilter:"\u5f80\u671f"===e.barType?(0,T.yz)(o):o,filterModel:{project:[l]},projectId:l,filterTip:null,headerFilterParamsNew:(0,A.ZP)(i,(function(n){n.find((function(e){return"WAITER_MODEL"===e.id}))?n.find((function(e){return"WAITER_MODEL"===e.id})).values=[{id:"WAITER_ASPECT2",values:[e.name]}]:n.push({id:"WAITER_MODEL",values:[{id:"WAITER_ASPECT2",values:[e.name]}]})}))};window.open("/inbox/service?"+encodeURIComponent(JSON.stringify(d)))}},t.events={filterReady:t._handleFilterReady,filterChange:t._handleFilterChange,onMsgClick:t._handleOnMsgClick,onLookMsgClick:t._handleOnLookMsgClick,onChartClick:t._handleOnChartClick,onConcernMsgClick:t._handleOnConcernMsgClick,onChangeCardBarTable:t._handleOnChangeCardBarTable},t}(0,i.Z)(n,e);var t=n.prototype;return t.componentDidMount=function(){},t.componentWillUnmount=function(){this.props.clean()},t.render=function(){return s.createElement(g,(0,r.Z)({},this.props,this.state,this.events))},n}(s.Component);const M=(0,u.connect)((function(e){var n=e.loading,t=(0,a.Z)(e,I);return(0,r.Z)({},t[O],{fetchingTrendData:n.effects[O+" /fetchTrendData"]||!1,fetchingConcernAnalyzeData:n.effects[O+"/fetchConcernAnalyzeData"]||!1,fetchingConcernAnalyzeTableData:n.effects[O+"/fetchConcernAnalyzeTableData"]||!1,fetchingConcernAnalyzeCardBarData:n.effects[O+"/fetchConcernAnalyzeCardBarData"]||!1})}),(function(e){return{save:function(n){return e({type:O+"/save",payload:n})},clean:function(){return e({type:O+"/clean"})},fetchParams:function(n){return e({type:O+"/fetchParams",payload:n})},fetchDatas:function(n){return e({type:O+"/fetchDatas",payload:n})},fetchConcernAnalyzeData:function(n){return e({type:O+"/fetchConcernAnalyzeData",payload:n})},fetchConcernAnalyzeCardBarData:function(n){return e({type:O+"/fetchConcernAnalyzeCardBarData",payload:n})},fetchConcernAnalyzeTableData:function(n){return e({type:O+"/fetchConcernAnalyzeTableData",payload:n})}}}))(_)}}]);