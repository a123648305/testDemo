"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[7891],{77891:(e,t,n)=>{n.r(t),n.d(t,{default:()=>fe});var a=n(63366),r=n(87462),i=n(94578),o=n(67294),l=n(2329),c=n(55815),s=n(8201),u=n(98191),h=n(60496),d=n(39432),p=n(70715),f=n(87300),m=n(94644);function v(e,t){var n=["\u65e5\u671f",t],a=e.map((function(e){return[e.name,e.count]}));return{length:e.length,datasets:{dimensions:n,source:a}}}var g=function(e,t,n,a,r){var i=.8*a/(63*e.map((function(e){return e.name})).length),o=v(e).datasets.source;return{title:{text:t},tooltip:{trigger:"axis",showDelay:200,hideDelay:500,enterable:!0,padding:0,position:function(e,t,n,a,r){var i=r.contentSize,o=r.viewSize,l=e[0]<o[0]/2?0:-1,c=e[1]<o[1]/2?-.5:-1;return[e[0]+l*i[0],e[1]+c*i[1]]},formatter:function(e,a,i){if(e.length){var o=e[0],l=o.marker,c=o.seriesName,s=o.name,u=o.value;return setTimeout((function(){i(a,(0,f.r)(""+(0,d.yV)(n,s),[""+l+c+"\uff1a"+(0,d.hE)(u)],[{title:"\u6d88\u606f",icon:"icon-cem_jump-message",callback:function(){return r(e[0],t,"trend")}}]))}),0)}}},grid:{top:56,left:36,right:48,bottom:i<1?40:16,containLabel:!0},dataZoom:{show:i<1,left:55,right:55,bottom:16,height:16,handleSize:"100%",showDetail:!1},xAxis:{type:"category",boundaryGap:!1,axisTick:{show:!0},data:o.map((function(e){return(0,d.yV)(n,e[0])}))},yAxis:{type:"value",splitNumber:3,minInterval:1},series:[{type:"line",name:"\u6807\u7b7e\u58f0\u91cf",data:o.map((function(e,t){return{name:e[0],value:e[1],symbol:"circle"}}))}]}},y=n(45697),C=n.n(y),E=n(50976),O=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).renderChart=function(){var e=t.props,n=e.data,a=e.title,r=e.timeType,i=e.onMsgClick;if((0,s.P)(n)&&t.chartRef){var o=g(n,a,r,t.chartRef.getWidth(),i);t.chartRef.clear(),t.chartRef.setOption(o)}},t.getChartRef=function(e){return t.chartRef=e},t}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;this.internalId=setInterval((function(){if(e.chartRef){clearInterval(e.internalId),e.renderChart();var t=e.chartRef._dom.children,n=t[0],a=t[1];n.addEventListener("mouseleave",(function(t){e.chartLeaveTimeout=setTimeout((function(){e.chartLeaveTimeout&&(a.style.display="none")}),2e3)})),a&&a.addEventListener("mouseenter",(function(t){e.chartLeaveTimeout=void 0}))}}),200)},n.componentDidUpdate=function(e,t){var n=e.data,a=this.props.data;(0,s.P)(a)&&JSON.stringify(n)!==JSON.stringify(a)&&this.renderChart(),!(0,s.P)(a)&&this.chartRef&&(this.chartRef=void 0)},n.render=function(){var e=this,t=this.props,n=t.className,a=t.title,r=void 0===a?"\u63d0\u53ca\u58f0\u91cf\u8d70\u52bf":a,i=t.data,l=t.loading,c=t.timeOptions,d=t.timeType,p=t.onFilterChange;return o.createElement(s.Z,{data:i,loading:l,className:"product_scene_line_chart_wrap "+n,renderTitle:o.createElement(u.Z,{title:r,data:i,onMoreClick:function(t){return function(e,t,n,a){if("image"===t)(0,m._v)(e,a);else if("data"===t){var r=v(n).datasets,i=[r.dimensions].concat(r.source);(0,m.aT)([i],a)}}(e.chartRef,t,i,r)}},o.createElement(h.Z,{options:c,activeObj:d,onChange:function(e){return p({c1TimeType:e})}}))},o.createElement(E.Z,{theme:"yunting_multi_color",className:"yt_echarts_style",option:{},style:{width:"100%",height:"100%"},onChartReady:this.getChartRef}))},t}(o.Component);const b=O;O.propsType={className:C().string,title:C().string,data:C().any,loading:C().bool,onFilterChange:C().func,timeOptions:C().arrayOf(C().shape({title:C().string,value:C().string})),timeType:C().string,fTimeType:C().string,onFlavorChange:C().func};var S=n(97326),T=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).dimensions=void 0,t.source=void 0,t.chartRef=void 0,t.margin=0,t.mColor=p.Fq,t.getChartRef=function(e){return t.chartRef=e},t.setValue=function(e){var n=e.sort((function(e,t){return t.count-e.count}));t.source=[],t.dimensions=["\u6307\u6807","\u58f0\u91cf","\u7d2f\u8ba1\u58f0\u91cf\u5360\u6bd4"];var a=(0,d.jD)("100%",12)+30,r=n.reduce((function(e,n){a=Math.max(a,(0,d.jD)(n.count,12)+30);var r=e+n.count;return t.source.push([n.name,n.count,r]),r}),0);t.source.forEach((function(e){e[2]=r?e[2]/r:0})),t.margin=a},t.getOption=function(e){return{title:{text:e},tooltip:{trigger:"axis",showDelay:200,hideDelay:500,enterable:!0,padding:0,position:function(e,t,n,a,r){var i=r.contentSize,o=r.viewSize,l=e[0]<o[0]/2?0:-1,c=e[1]<o[1]/2?-.5:-1;return[e[0]+l*i[0],e[1]+c*i[1]]},formatter:function(n,a,r){return setTimeout((function(){var i=n.find((function(e){return"bar"===e.componentSubType})),o=n.find((function(e){return"line"===e.componentSubType}));r(a,(0,f.r)(i.marker+" "+i.name,["\u6807\u7b7e\u58f0\u91cf\uff1a"+(0,d.hE)(i.value),"\u7d2f\u8ba1\u5360\u6bd4\uff1a"+(100*o.value).toFixed(2)+"%"],[{title:"\u6d88\u606f",icon:"icon-cem_jump-message",callback:function(){return t.handleOnMsgClick(i,e)}}]))}),0)}},legend:{left:20,top:50,itemWidth:10,itemHeight:10,data:[{name:"\u58f0\u91cf",icon:p.W4.square},{name:"\u7d2f\u8ba1\u58f0\u91cf\u5360\u6bd4",icon:p.W4.lineRing}]},grid:{bottom:70,left:t.margin,right:t.margin,top:80},dataZoom:[{show:"slider",bottom:20,xAxisIndex:[0,1],height:15,handleSize:"100%",showDetail:!1}],dataset:[{source:t.source,dimensions:t.dimensions}],xAxis:[0,1].map((function(e){return{type:"category",data:t.source.map((function(e){return e[0]})),position:"bottom",show:!e}})),yAxis:[0,1].map((function(e){return{type:"value",name:e?"":"\u5404\u5546\u54c1\u6307\u6807\u6392\u884c",nameTextStyle:{color:"#262626"},axisLabel:{formatter:function(t){return e?(100*t).toFixed(0)+"%":t}}}})),series:[{type:"bar",yAxisIndex:0,barMaxWidth:24,data:t.source.map((function(e){return{value:e[1],itemStyle:{color:"#1574B3"}}})),markLine:{symbolSize:0,data:[{name:"\u5747\u503c",type:"average",lineStyle:{color:"#bfbfbf"},label:{backgroundColor:"rgba(140, 140, 140, 0.3)",textShadowColor:"#1574b3",textShadowBlur:2,padding:[2,4],color:"#fff"}}]}},{type:"line",yAxisIndex:1,data:t.source.map((function(e){return{value:e[2],itemStyle:{color:"#CDB446"}}}))}]}},t}return(0,i.Z)(t,e),t.prototype.renderChart=function(e,t){this.setValue(e),this.chartRef.clear(),this.chartRef.setOption(this.getOption(t))},t}(o.PureComponent);const D=T;var k=n(61409),_=n(92360),N=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleOnMoreClick=function(e){var t=n.props,a=t.title,r=t.value;"image"===e&&n.chartRef?(0,m._v)(n.chartRef,a):"data"===e&&(0,s.P)(r)&&(0,m.aT)([[n.dimensions].concat(n.source.map((function(e){return[e[0],e[1],(100*e[2]).toFixed(2)+"%"]})))],a)},n.handleOnMsgClick=function(e,t){n.props.onMsgClick(e,t,"allConfig")},n.handleOnChartClick=function(e){var t=e.componentSubType,a=e.componentType,r=e.dataIndex;"series"===a&&"bar"===t&&n.setState({clickedDataIndex:n.state.clickedDataIndex===r?-1:r},(function(){var e=n.props,t=e.onChartClick,a=e.value,i=e.topicObj;t&&t("bar",-1===n.state.clickedDataIndex?null:{analysis:{id:i,values:[a[r].id],type:a[r].type}})}))},n.handleOnSwitch=function(t){n.setState({showZero:t},(function(){var a=n.props,r=a.value,i=a.title;e.prototype.renderChart.call((0,S.Z)(n),t?r:r.filter((function(e){return e.count})),i)}))},n.state={showZero:!1,clickedDataIndex:-1},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;this.internalId=setInterval((function(){if(e.chartRef){clearInterval(e.internalId),e.renderChart();var t=e.chartRef._dom.children,n=t[0],a=t[1];n.addEventListener("mouseleave",(function(t){e.chartLeaveTimeout=setTimeout((function(){e.chartLeaveTimeout&&(a.style.display="none")}),2e3)})),a&&a.addEventListener("mouseenter",(function(t){e.chartLeaveTimeout=void 0}))}}),200)},n.componentDidUpdate=function(e,t){var n=this,a=e.value,r=this.props.value,i=t.clickedDataIndex,o=this.state.clickedDataIndex;if((0,s.P)(r)&&JSON.stringify(a)!==JSON.stringify(r)&&this.renderChart(),!(0,s.P)(r)&&this.chartRef&&(this.chartRef=void 0),i!==o&&this.chartRef){var l=this.chartRef.getOption().series.map((function(e,t){return{data:e.data.map((function(e,a){return{value:e.value,itemStyle:{color:-1===o||o===a?n.mColor[t%n.mColor.length]:"#d8d8d8"}}}))}}));this.chartRef.setOption({series:l})}},n.renderChart=function(){var t=this.props,n=t.value,a=t.title,r=this.state.showZero;(0,s.P)(n)&&this.chartRef&&e.prototype.renderChart.call(this,r?n:n.filter((function(e){return e.count})),a)},n.resetChartRender=function(){this.setState({clickedDataIndex:-1})},n.render=function(){var e=this.state.showZero,t=this.props,n=t.value,a=t.loading,r=t.title,i=t.topicOpts,l=t.topicObj,c=t.onFilterChange;return o.createElement(s.Z,{className:"yt_overview_aspect_bar_chart_wrapper",data:n,loading:a,renderTitle:o.createElement(u.Z,{title:r,data:n,onMoreClick:this.handleOnMoreClick,titleOverlay:o.createElement("div",null,o.createElement("div",null,"\u6b64\u56fe\u7684\u5206\u6790\u65b9\u6cd5\u662f\u7edf\u8ba1\u5206\u6790\u4e2d\u5e38\u7528\u7684\u67cf\u62c9\u56fe"),o.createElement("div",{style:{marginTop:14,textAlign:"right"}},o.createElement(k.rU,{className:"yt-feedback-read-more",to:"https://www.yuque.com/docs/share/5cc9676c-e68a-4304-8f36-f2bcdd347edb?#",target:"_blank"},"\u4e86\u89e3\u66f4\u591a")))},o.createElement(h.Z,{options:i,objName:"c2AnalyzeObj",preTitle:"\u5206\u6790\u5bf9\u8c61",sufTitle:"\u65e0",activeObj:l,onChange:c}),o.createElement(_.Checkbox,{checked:e,onChange:this.handleOnSwitch,className:"zero_switch"},"\u663e\u793a'0'"))},o.createElement(E.Z,{onChartReady:this.getChartRef,theme:"yunting_multi_color",option:{},style:{height:"100%"},onEvents:{click:this.handleOnChartClick}}))},t}(D);const R=N;N.propTypes={value:C().any,topicOpts:C().array,topicObj:C().string,loading:C().bool,title:C().string,onFilterChange:C().func,onChartClick:C().func};var w=["\u6027\u522b","\u5e74\u9f84","\u5173\u7cfb","\u4f7f\u7528\u573a\u5408","\u7528\u9014","\u8d2d\u4e70\u51b3\u7b56"],x=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).source=void 0,t.chartRef=void 0,t.clusterData=void 0,t.globalCata=void 0,t.categories=void 0,t.getChartRef=function(e){return t.chartRef=e},t.setValue=function(e){var n=["\u573a\u666f","\u6807\u7b7e","\u603b\u63d0\u53ca\u58f0\u91cf","\u6807\u7b7e\u58f0\u91cf","\u5173\u8054\u6807\u7b7e\u58f0\u91cf","\u5173\u8054\u6570","\u7f6e\u4fe1\u5ea6","\u63d0\u5347\u5ea6"];t.clusterData=[n];var a=[],r=e.reduce((function(e,t){var n=[t.sceneName,t.key,t.messageCount,t.aspectCount,t.total,t.relTotal,t.trustRate,t.upRate];return e[t.sceneName]||(e[t.sceneName]=[]),e[t.sceneName].push(n),a.push(n),e}),{});t.categories=Object.keys(r),Object.values(r).forEach((function(e){e.sort((function(e,t){return t[4]-e[4]})).forEach((function(e){t.clusterData.push(e)}))})),t.globalCata=a.sort((function(e,t){return t[4]-e[4]})),t.globalCata.splice(0,0,n)},t.getOptions=function(e,n){var a=t.categories.map((function(e,t){var n=w.indexOf(e);return p.Fq[n>-1?n:t]}));return{title:{text:e},dataset:[{source:t.source}],grid:{top:86,bottom:50,left:36,right:48,containLabel:!0},visualMap:[{type:"piecewise",top:46,left:20,itemWidth:10,itemHeight:10,orient:"horizontal",dimension:0,categories:t.categories,inRange:{symbol:"rect",color:a},outOfRange:{color:"#bfbfbf"}}],dataZoom:[{show:"slider",bottom:20,xAxisIndex:0,height:15,handleSize:"100%",showDetail:!1}],tooltip:{showDelay:200,hideDelay:500,enterable:!0,padding:0,position:function(e,t,n,a,r){var i=r.contentSize,o=r.viewSize,l=e[0]<o[0]/2?0:-1,c=e[1]<o[1]/2?-.5:-1;return[e[0]+l*i[0],e[1]+c*i[1]]},formatter:function(a,r,i){return setTimeout((function(){var o=a.marker,l=a.data,c="";c=1===l[7]?"\u65e0\u5173\u8054":l[7]>1?"\u5173\u8054\u6027\u5f3a":"\u5173\u8054\u6027\u4e0d\u5f3a";var s=l[1].split(":")[1];i(r,(0,f.r)(o+" "+s,["\u6807\u7b7e\u58f0\u91cf\uff1a"+(0,d.hE)(l[4]),"\u63d0\u5230\u300c"+n+"\u300d\u7684\u6d88\u606f\u4e2d</br>\u6709"+(0,d.bC)(l[6])+"%\u7684\u6982\u7387\u4e5f\u4f1a\u63d0\u5230\u300c"+s+"\u300d\uff0c</br>\u63d0\u5347\u5ea6\u4e3a"+l[7].toFixed(2)+"\uff0c\u4e24\u8005"+c],[{title:"\u6d88\u606f",icon:"icon-cem_jump-message",callback:function(){return t.handleOnMsgClick(a,e)}}]))}),0)}},xAxis:{type:"category",axisLabel:{formatter:function(e){return e.split(":")[1]}}},yAxis:{type:"value"},series:[{type:"bar",barMaxWidth:24,encode:{x:1,y:4}}]}},t}(0,i.Z)(t,e);var n=t.prototype;return n.renderChart=function(e,t,n,a){this.setValue(e),this.updateChart(t,n,a)},n.updateChart=function(e,t,n){"global"===t?this.source=this.globalCata:"cluster"===t&&(this.source=this.clusterData),this.chartRef.clear(),this.chartRef.setOption(this.getOptions(e,n))},t}(o.Component);const A=x;var M=n(33798),L=n(43036),I=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleOnMoreClick=function(e){var t=n.props,a=t.title,r=t.data;"image"===e&&n.chartRef?(0,m._v)(n.chartRef,a):"data"===e&&(0,s.P)(r)&&(0,m.aT)([n.source.map((function(e,t){return 0===t?e:[e[0],e[1].split(":")[1],e[2],e[3],e[4],e[5],(100*e[6]).toFixed(2)+"%",""+e[7].toFixed(2)]}))],a)},n.handleOnMsgClick=function(e,t){n.props.onMsgClick(e,t,"aspect")},n.state={rangeType:"global"},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;this.internalId=setInterval((function(){if(e.chartRef){clearInterval(e.internalId),e.renderChart();var t=e.chartRef._dom.children,n=t[0],a=t[1];n.addEventListener("mouseleave",(function(t){e.chartLeaveTimeout=setTimeout((function(){e.chartLeaveTimeout&&(a.style.display="none")}),2e3)})),a&&a.addEventListener("mouseenter",(function(t){e.chartLeaveTimeout=void 0}))}}),200)},n.componentDidUpdate=function(t,n){var a=t.data,r=this.props.data,i=n.rangeType,o=this.state.rangeType;(0,s.P)(r)&&JSON.stringify(a)!==JSON.stringify(r)&&this.renderChart(),!(0,s.P)(r)&&this.chartRef&&(this.chartRef=void 0),i!==o&&this.chartRef&&e.prototype.updateChart.call(this,this.props.title,o)},n.renderChart=function(){var t=this.props,n=t.data,a=t.title,r=t.aspectName,i=this.state.rangeType;(0,s.P)(n)&&this.chartRef&&e.prototype.renderChart.call(this,n,a,i,r)},n.render=function(){var e=this,t=this.state.rangeType,n=this.props,a=n.data,r=n.loading,i=n.title;return o.createElement(s.Z,{className:"yt_scene_bar_chart_wrapper",data:a,loading:r,renderTitle:o.createElement(u.Z,{title:i,data:a,onMoreClick:this.handleOnMoreClick,titleOverlay:o.createElement("div",null,o.createElement("div",null,"\u5c55\u793a\u4e00\u6761\u6d88\u606f\u4e2d\u5171\u540c\u63d0\u53ca\u7684\u5176\u4ed6\u573a\u666f\u6807\u7b7e\u5173\u8054\u5173\u7cfb"),o.createElement("div",null,"\u63d0\u793a\uff1a\u573a\u666f\u7c7b\u578b\u5305\u542b\u6027\u522b\u3001\u5e74\u9f84\u6bb5\u3001\u5173\u7cfb\u3001\u7528\u9014\u3001\u8d2d\u4e70\u51b3\u7b56\u3001\u4f7f\u7528\u573a\u5408\uff0c\u5982\u679c\u5206\u6790\u4f7f\u7528\u573a\u5408\u6807\u7b7e\u7684\u5173\u8054\u6807\u7b7e\u65f6\uff0c\u53ea\u5206\u6790\u4e0d\u5305\u542b\u4f7f\u7528\u573a\u5408\u7684\u5176\u4ed6\u7c7b\u578b\u6807\u7b7e\u4e4b\u95f4\u7684\u5173\u7cfb"),o.createElement("div",{style:{marginTop:14,textAlign:"right"}},o.createElement(k.rU,{className:"yt-feedback-read-more",to:"https://www.yuque.com/docs/share/1442b1bd-72da-476d-b42b-db965a8aaeff?# \u300a\u5173\u8054\u5206\u6790\u516c\u5f0f\u8bf4\u660e\u300b",target:"_blank"},"\u4e86\u89e3\u66f4\u591a")))},o.createElement(L.Z,{placement:"top",overlay:"\u5168\u5c40\u6392\u5e8f"},o.createElement("span",{onClick:function(){return e.setState({rangeType:"global"})}},o.createElement(M.Z,{isActive:"global"===t,defaultIcon:"cem_non-sort-within-group",activeIcon:"cem_non-sort-within-group-color"}))),o.createElement(L.Z,{placement:"top",overlay:"\u5206\u7ec4\u6392\u5e8f"},o.createElement("span",{onClick:function(){return e.setState({rangeType:"cluster"})}},o.createElement(M.Z,{isActive:"cluster"===t,defaultIcon:"cem_sort-within-group",activeIcon:"cem_sort-within-group-color"}))),o.createElement("div",{className:"v-divider"}))},o.createElement(E.Z,{onChartReady:this.getChartRef,theme:"yunting_multi_color",option:{},style:{height:"100%"},onEvents:{click:this.handleOnChartClick}}))},t}(A);const Z=I;I.propTypes={data:C().any,loading:C().bool,title:C().string,aspectName:C().string};var F=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).source=void 0,t.chartRef=void 0,t.getChartRef=function(e){return t.chartRef=e},t.setValue=function(e,n){t.source=e.map((function(e){return[e.name,e.count]})),t.source.splice(0,0,[n,"\u58f0\u91cf"])},t.getOptions=function(e,n){return{title:{text:e},dataset:[{source:t.source}],grid:{top:56,bottom:20,left:36,right:48,containLabel:!0},tooltip:{trigger:"axis",showDelay:200,hideDelay:500,enterable:!0,padding:0,position:function(e,t,n,a,r){var i=r.contentSize,o=r.viewSize,l=e[0]<o[0]/2?0:-1,c=e[1]<o[1]/2?-.5:-1;return[e[0]+l*i[0],e[1]+c*i[1]]},formatter:function(n,a,r){return setTimeout((function(){var i=n[0];r(a,(0,f.r)(i.marker+" "+i.name,["\u6807\u7b7e\u58f0\u91cf\uff1a"+(0,d.hE)(i.value)],[{title:"\u6d88\u606f",icon:"icon-cem_jump-message",callback:function(){return t.handleOnMsgClick(i,e)}}]))}),0)}},xAxis:{type:"value",show:!1,axisLabel:{show:!1}},yAxis:{type:"category",inverse:!0,data:t.source.slice(1).map((function(e){return e[0]}))},series:[{type:"bar",barMaxWidth:24,data:t.source.slice(1).map((function(e){return{value:e[1],name:e[0],itemStyle:{color:n===e[0]?"#CDB446":"#1574B3"}}})),label:{show:!0,position:"right",color:"#262626"}}]}},t}return(0,i.Z)(t,e),t.prototype.renderChart=function(e,t,n,a){this.setValue(e,n,a),this.chartRef.clear(),this.chartRef.setOption(this.getOptions(t,a))},t}(o.Component);const P=F;var j=n(94184),V=n.n(j),J=function(e){function t(t){var n;return(n=e.call(this,t)||this).togglePanel=function(e){var t=n.state,a=t.panelShow;t.value,t.filteredOptions;a&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()),setTimeout((function(){return n.setState({panelShow:!a})}),0)},n.handleCheckAllStatus=function(){var e=n.state,t=e.tempValue,a=e.filteredOptions;n.setState({allChecked:t.length>0&&t.length===a.length,indeterminate:t.length>0&&t.length<a.length})},n.handleConfirm=function(){var e=n.state.tempValue;n.setState({value:JSON.parse(JSON.stringify(e)),panelShow:!1}),n.props.onChange(e)},n.handleCancel=function(){var e=n.state,t=e.value,a=e.filteredOptions;n.setState({tempValue:JSON.parse(JSON.stringify(t)),panelShow:!1,allChecked:t&&t.length>0&&t.length===a.length,indeterminate:t&&t.length>0&&t.length<a.length},(function(){return n.handleClearInput()}))},n.handleReset=function(){n.setState({tempValue:[],value:[],panelShow:!1,searchText:""},(function(){return n.handleCheckAllStatus()}))},n.handleFilter=function(e){var t=n.state.options;if(e.trim().length>0){var a=t.filter((function(t){return t.name.toUpperCase().includes(e.toUpperCase())}));n.setState({searchText:e,filteredOptions:a})}else n.setState({filteredOptions:t,searchText:e})},n.handleClearInput=function(){var e=n.state,t=e.searchText,a=e.options;t.length>0&&n.setState({searchText:"",filteredOptions:a},(function(){return n.handleCheckAllStatus()}))},n.state={type:t.type||2,title:t.title||"",options:[],filteredOptions:[],tempValue:t.defaultValue||[],value:t.defaultValue||[],maxLength:t.maxLength||0,indeterminate:!1,allChecked:!1,panelShow:!1,searchText:""},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){window.addEventListener("click",this.handleCancel)},t.getDerivedStateFromProps=function(e,t){var n=e.type,a=e.title,r=e.options,i=e.value;if(n!==t.type)return{type:n};if(a!==t.title)return{title:a};if(Array.isArray(i)&&JSON.stringify(i)!==JSON.stringify(t.value)){var o=r?r.reduce((function(e,t){var n=i.indexOf(t.id);return n>-1?e[n]=t:e.splice(e.length,0,t),e}),i.slice()):[];return{options:o,filteredOptions:o,value:i||[],tempValue:i||[],allChecked:i&&i.length>0&&i.length===t.filteredOptions.length,indeterminate:i&&i.length>0&&i.length<t.filteredOptions.length}}return null},n.componentWillUnmount=function(){window.removeEventListener("click",this.handleCancel)},n.handleCheckAll=function(){var e=this,t=this.state,n=t.tempValue,a=t.filteredOptions;this.setState({tempValue:n.length===a.length?[]:a.map((function(e){return e.id}))},(function(){return e.handleCheckAllStatus()}))},n.handleCheckOne=function(e){var t=this,n=this.state,a=n.tempValue,r=n.maxLength;if(r>0&&(a.length>=r&&a.includes(e)||a.length<r)||0===r){var i=a.indexOf(e);i>-1?a.splice(i,1):a.push(e),this.setState({tempValue:a},(function(){return t.handleCheckAllStatus()}))}},n.render=function(){var e=this,t=this.state,n=t.type,a=t.title,i=t.options,l=t.filteredOptions,c=t.indeterminate,s=t.allChecked,u=t.panelShow,h=t.tempValue,d=t.value,p=t.maxLength,f=t.style,m=t.searchText,v=i.length>0?i.filter((function(e){return d.includes(e.id)})).map((function(e){return e.name})):[],g=V()({"cc_multi-select-wrapper":!0,whiteBg:1===n,sel:u}),y=n&&1===n?"\u8bf7\u9009\u62e9":"\u5168\u90e8",C=this.props.note;return o.createElement("div",{className:g,style:(0,r.Z)({backgroundColor:u?"rgb(97,121,155)":""},f),onClick:this.togglePanel},o.createElement("span",null,a&&a+"\uff1a"),o.createElement("span",{className:"currValue",title:v.length>0?v.length===i.length?"\u5168\u90e8":v.join("\uff0c"):y},v.length>0?v.length===i.length?"\u5168\u90e8":v.join("\uff0c"):y),o.createElement("i",{className:"icon-cem_arrow-launches",style:{transform:u?"rotate(-180deg)":"",top:u?"-2px":"3px"}}),o.createElement("div",{className:"multi-select-panel",style:{display:u?"block":"none"},onClick:function(e){return e.stopPropagation()}},o.createElement("div",{className:"multi-select-header"},p&&o.createElement("div",{className:"limit_info"},"\u6dfb\u52a0\u5c55\u793a",o.createElement("span",null,"\uff08\u6700\u591a"+p+"\u4e2a\uff0c\u5df2\u6dfb\u52a0"+h.length+"\u4e2a\uff09")),o.createElement(_.Input,{ref:function(t){return e.input=t},value:m,onChange:this.handleFilter,placeholder:"\u8bf7\u8f93\u5165\u641c\u7d22\u5173\u952e\u8bcd",icon:m.length>0?"close":"search",onIconClick:this.handleClearInput})),o.createElement("ul",{className:"multi-select-panel-body"},l.length>0?o.createElement(o.Fragment,null,0===p&&o.createElement("li",{className:"all_check",onClick:function(){return e.handleCheckAll()}},o.createElement("div",{className:"all_select"},o.createElement(_.Checkbox,{checked:s,indeterminate:c,onChange:function(){return e.handleCheckAll()}}),o.createElement("label",null,"\u5168\u9009"))),l.map((function(t,n){return o.createElement("li",{key:n,className:p>0&&h.length>=p&&!h.includes(t.id)?"disabled":"",onClick:function(){return e.handleCheckOne(t.id)},style:{height:C?"50px":"36px"}},o.createElement(_.Checkbox,{disabled:p>0&&h.length>=p&&!h.includes(t.id),checked:h.includes(t.id),value:t.id,onChange:function(){return e.handleCheckOne(t.id)}}),o.createElement("label",{title:t.name},t.name),C&&o.createElement("p",{className:"note"},C(t)))}))):o.createElement("li",null,o.createElement("label",null,"\u6682\u65e0\u6570\u636e"))),o.createElement("div",{className:"multi-select-panel-footer"},o.createElement(_.Button,{type:"primary",onClick:this.handleConfirm},"\u786e\u8ba4"),o.createElement(_.Button,{onClick:this.handleCancel},"\u53d6\u6d88"))))},t}(o.Component);J.propTypes={type:C().number,title:C().string.isRequired,options:C().arrayOf(C().shape({id:C().oneOfType([C().string,C().number]),name:C().string})),defaultValue:C().arrayOf(C().string),value:C().arrayOf(C().string),maxLength:C().number,onChange:C().func.isRequired,style:C().object,note:C().func};var B=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleOnMoreClick=function(e){var t=n.props,a=t.title,r=t.data;"image"===e&&n.chartRef?(0,m._v)(n.chartRef,a):"data"===e&&(0,s.P)(r)&&(0,m.aT)([n.source],a)},n.handleOnChange=function(e){var t=n.props.onChange;t&&t({c4SelectedObjs:e})},n.handleOnMsgClick=function(e,t){n.props.onMsgClick(e,t,"config")},n.state={options:[]},n}(0,i.Z)(t,e),t.getDerivedStateFromProps=function(e,t){return t.options.length?null:{options:e.options.map((function(e){return{id:e.value,name:e.title}}))}};var n=t.prototype;return n.componentDidMount=function(){var e=this;this.internalId=setInterval((function(){if(e.chartRef){clearInterval(e.internalId),e.renderChart();var t=e.chartRef._dom.children,n=t[0],a=t[1];n.addEventListener("mouseleave",(function(t){e.chartLeaveTimeout=setTimeout((function(){e.chartLeaveTimeout&&(a.style.display="none")}),2e3)})),a&&a.addEventListener("mouseenter",(function(t){e.chartLeaveTimeout=void 0}))}}),200)},n.componentDidUpdate=function(e,t){var n=e.data,a=this.props.data;(0,s.P)(a)&&JSON.stringify(n)!==JSON.stringify(a)&&this.renderChart(),!(0,s.P)(a)&&this.chartRef&&(this.chartRef=void 0)},n.renderChart=function(){var t=this.props,n=t.data,a=t.title,r=t.topicName,i=t.defaultName;(0,s.P)(n)&&this.chartRef&&e.prototype.renderChart.call(this,n,a,r,i)},n.render=function(){var e=this.props,t=e.data,n=e.loading,a=e.title,r=e.selectedObjs,i=e.topicName,l=this.state.options;return o.createElement(s.Z,{className:"yt_scene_bar_chart_wrapper",data:t,loading:n,renderTitle:o.createElement(u.Z,{title:a,data:t,onMoreClick:this.handleOnMoreClick,titleOverlay:"\u53ea\u5bf9\u6bd4\u54c1\u724c\u6216\u578b\u53f7\u7684\u6807\u7b7e\u58f0\u91cf\uff0c\u5982\u679c\u7b5b\u9009\u4e86\u54c1\u724c\uff0c\u4ece\u54c1\u724c\u89d2\u5ea6\u5bf9\u6bd4\u5404\u54c1\u724c\u7684\u6807\u7b7e\u58f0\u91cf\uff0c\u5982\u679c\u7b5b\u9009\u4e86\u578b\u53f7\uff0c\u4ece\u578b\u53f7\u89d2\u5ea6\u5bf9\u6bd4\u5404\u578b\u53f7\u7684\u6807\u7b7e\u58f0\u91cf"},o.createElement(J,{title:i,options:l,maxLength:10,value:r,onChange:this.handleOnChange}),o.createElement("div",{className:"v-divider"}))},o.createElement(E.Z,{onChartReady:this.getChartRef,theme:"yunting_multi_color",option:{},style:{height:"100%"}}))},t}(P);const z=B;B.propTypes={data:C().any,loading:C().bool,title:C().string,topicName:C().string,selectedObjs:C().arrayOf(C().string),defaultName:C().string,options:C().arrayOf(C().shape({title:C().string,value:C().string}))};var W=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).source=void 0,t.dimensions=void 0,t.countDimensions=["\u6307\u6807","\u8d1f\u9762\u58f0\u91cf","\u6b63\u9762\u58f0\u91cf","\u603b\u58f0\u91cf"],t.rateDimensions=["\u6307\u6807","\u8d1f\u9762\u58f0\u91cf\u5360\u6bd4","\u6b63\u9762\u58f0\u91cf\u5360\u6bd4","\u603b\u58f0\u91cf\u5360\u6bd4"],t.chartRef=void 0,t.countData=void 0,t.rateData=void 0,t.getChartRef=function(e){return t.chartRef=e},t.setValue=function(e){t.countData=[],t.rateData=[];var n=0;e.forEach((function(e){n+=e.total,t.countData.push([e.name,e.negative,e.positive,e.total]),t.rateData.push([e.name,e.negative?e.negative/e.total:0,e.positive?e.positive/e.total:0,e.total])})),t.rateData.forEach((function(e){e[3]=n?e[3]/n:0}))},t.getOptions=function(e,n){return{title:{text:e},dataset:[{dimensions:t.dimensions,source:t.source}],grid:{top:86,bottom:50,left:36,right:48,containLabel:!0},legend:{left:20,top:46,itemWidth:10,itemHeight:10,itemGap:16,icon:p.W4.square,data:["\u8d1f\u9762","\u6b63\u9762"]},dataZoom:[{show:"slider",bottom:20,xAxisIndex:0,height:15,handleSize:"100%",showDetail:!1}],tooltip:{trigger:"axis",showDelay:200,hideDelay:500,enterable:!0,padding:0,position:function(e,t,n,a,r){var i=r.contentSize,o=r.viewSize,l=e[0]<o[0]/2?0:-1,c=e[1]<o[1]/2?-.5:-1;return[e[0]+l*i[0],e[1]+c*i[1]]},formatter:function(n,a,r){return setTimeout((function(){r(a,(0,f.r)(""+n[0].name,n.map((function(e){var n="\u6b63\u9762"===e.seriesName?2:1,a=t.countData.find((function(t){return t[0]===e.name}))[n],r=t.rateData.find((function(t){return t[0]===e.name}))[n];return e.marker+" "+e.seriesName+"\uff1a "+(0,d.hE)(a)+" ("+(100*r).toFixed(2)+"%)"})),[{title:"\u6d88\u606f",icon:"icon-cem_jump-message",callback:function(){return t.handleOMsgClick(n,e)}}]))}),0)}},xAxis:{type:"category",triggerEvent:!0},yAxis:{type:"value",axisLabel:{formatter:function(e){return"count"===n?e:100*e+"%"}}},series:["\u8d1f\u9762","\u6b63\u9762"].map((function(e,t){return{name:e,type:"bar",stack:"stack",barMaxWidth:24,itemStyle:{borderWidth:2,borderColor:"#fff"},encode:{x:0,y:t+1}}}))}},t}(0,i.Z)(t,e);var n=t.prototype;return n.renderChart=function(e,t,n,a){this.setValue(e),this.updateChart(t,n,a)},n.updateChart=function(e,t,n){"count"===t?(this.source=this.countData,this.dimensions=this.countDimensions):"rate"===t&&(this.source=this.rateData,this.dimensions=this.rateDimensions),"total"===n?this.source=this.source.sort((function(e,t){return t[3]-e[3]})):"positive"===n?this.source=this.source.sort((function(e,t){return t[1]-e[1]})):"negative"===n&&(this.source=this.source.sort((function(e,t){return t[2]-e[2]}))),this.chartRef.clear(),this.chartRef.setOption(this.getOptions(e,t))},t}(o.Component);var U=[{title:"\u4e00\u7ea7\u6307\u6807",value:"ASPECT1"},{title:"\u4e8c\u7ea7\u6307\u6807",value:"ASPECT2"}],G=[{title:"\u6570\u91cf",value:"count"},{title:"\u6bd4\u4f8b",value:"rate"}],q=[{title:"\u6307\u6807\u58f0\u91cf",value:"total"},{title:"\u6307\u6807\u8d1f\u9762\u58f0\u91cf",value:"positive"},{title:"\u6307\u6807\u6b63\u9762\u58f0\u91cf",value:"negative"}],H=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleOnMoreClick=function(e){var t=n.props,a=t.title,r=t.data,i=n.state.dataType;"image"===e&&n.chartRef?(0,m._v)(n.chartRef,a):"data"===e&&(0,s.P)(r)&&(0,m.aT)([[n.dimensions].concat("count"===i?n.source:n.source.map((function(e){return[e[0],(100*e[1]).toFixed(2)+"%",(100*e[2]).toFixed(2)+"%",(100*e[3]).toFixed(2)+"%"]})))],a)},n.handleOnAspectTypeChange=function(e){var t=n.props.onChange;t&&t({c5AspectLevel:e,c5Aspect1:""})},n.handleOnDataTypeChange=function(e){n.setState({dataType:e})},n.handleOnRangeTypeChange=function(e){n.setState({rangeType:e})},n.handleOMsgClick=function(e,t){n.props.onMsgClick(e,t,"model")},n._handleOnClick=function(e){var t=n.props,a=t.aspectLevel,r=t.onChange,i=e.componentType,o=e.value;"xAxis"===i&&r&&r({c5Aspect1:"ASPECT1"===a?o:"",c5AspectLevel:"ASPECT1"===a?"ASPECT2":"ASPECT1"})},n.state={dataType:"count",rangeType:"total"},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;this.internalId=setInterval((function(){if(e.chartRef){clearInterval(e.internalId),e.renderChart();var t=e.chartRef._dom.children,n=t[0],a=t[1];n.addEventListener("mouseleave",(function(t){e.chartLeaveTimeout=setTimeout((function(){e.chartLeaveTimeout&&(a.style.display="none")}),2e3)})),a&&a.addEventListener("mouseenter",(function(t){e.chartLeaveTimeout=void 0}))}}),200)},n.componentDidUpdate=function(t,n){var a=t.data,r=this.props.data,i=n.rangeType,o=n.dataType,l=this.state,c=l.rangeType,u=l.dataType;(0,s.P)(r)&&JSON.stringify(a)!==JSON.stringify(r)&&this.renderChart(),!(0,s.P)(r)&&this.chartRef&&(this.chartRef=void 0),i===c&&o===u||!this.chartRef||e.prototype.updateChart.call(this,this.props.title,u,c)},n.renderChart=function(){var t=this.props,n=t.data,a=t.title,r=this.state,i=r.rangeType,o=r.dataType;(0,s.P)(n)&&this.chartRef&&e.prototype.renderChart.call(this,n,a,o,i)},n.render=function(){var e=this.props,t=e.data,n=e.loading,a=e.title,r=e.aspectLevel,i=e.className,l=void 0===i?"":i,c=this.state,d=c.dataType,p=c.rangeType;return o.createElement(s.Z,{className:"yt_scene_bar_chart_wrapper "+l,data:t,loading:n,renderTitle:o.createElement(u.Z,{title:a,data:t,onMoreClick:this.handleOnMoreClick,titleOverlay:"\u63d0\u53ca\u5230\u76f8\u5173\u300c\u573a\u666f\u6807\u7b7e\u300d\u6d88\u606f\u7684\u6307\u6807\u60c5\u611f\u5206\u6790"},o.createElement(h.Z,{options:U,activeObj:r,onChange:this.handleOnAspectTypeChange}),o.createElement(h.Z,{options:G,activeObj:d,onChange:this.handleOnDataTypeChange}),o.createElement(h.Z,{preTitle:"\u6392\u5e8f",options:q,activeObj:p,onChange:this.handleOnRangeTypeChange}))},o.createElement(E.Z,{onChartReady:this.getChartRef,theme:"yunting_neg_pos",option:{},onEvents:{click:this._handleOnClick},style:{height:"100%"}}))},t}(W);const X=H;H.propTypes={data:C().any,className:C().string,loading:C().bool,title:C().string,aspectLevel:C().string,onChange:C().func};n(89777);var Y=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).source=void 0,t.dimensions=void 0,t.chartRef=void 0,t.tableRef=void 0,t.clusterData=void 0,t.globalCata=void 0,t.categories=void 0,t.getChartRef=function(e){return t.chartRef=e},t.getTableRef=function(e){return t.tableRef=e},t.getOptions=function(e,n){return{tooltip:{showDelay:200,hideDelay:500,enterable:!0,padding:0,position:function(e,t,n,a,r){var i=r.contentSize,o=r.viewSize,l=e[0]<o[0]/2?0:-1,c=e[1]<o[1]/2?-.5:-1;return[e[0]+l*i[0],e[1]+c*i[1]]},formatter:function(e,a,r){return setTimeout((function(){r(a,(0,f.r)(e.marker+" "+e.name,["\u58f0\u91cf\uff1a"+(0,d.hE)(e.data.oriValue)],[{title:"\u6d88\u606f",icon:"icon-cem_jump-message",callback:function(){return t.handleOnMsgClick(e,n)}}]))}),0)}},series:{name:"opinionWordCloud",type:"wordCloud",shape:"circle",left:"center",top:"center",sizeRange:[12,60],gridSize:6,rotationRange:[0,0],drawOutOfBound:!1,data:e,textStyle:{emphasis:{color:"#D8D8D8"}}}}},t}return(0,i.Z)(t,e),t.prototype.renderChart=function(e,t){this.chartRef.clear(),this.chartRef.setOption(this.getOptions(e,t))},t}(o.Component);const K=Y;var Q=n(33905),$=30;const ee=function(e){function t(t){var n;(n=e.call(this,t)||this).renderWordOverlay=function(e){return o.createElement("div",{onClick:function(e){e.stopPropagation()}},o.createElement("span",null,e),o.createElement("span",{onClick:function(t){return n.handleOnFilter(e)}},"\u9690\u85cf"))},n.handleOnFilter=function(e){var t=n.state,a=t.page,r=t.data.filter((function(t){return t.name!==e}));n.setState({data:r,cluData:r.slice((a-1)*$,a*$)})},n.handleOnClick=function(e){var t=n.props.onClick;t&&t(e)},n.handleOnPageChange=function(e){var t=n.state.data;n.setState({page:e,cluData:t.slice((e-1)*$,e*$)})};var a=t.data,r=void 0===a?[]:a;return n.state={data:r,oriData:[],page:1,cluData:r.slice(0,$)},n}return(0,i.Z)(t,e),t.getDerivedStateFromProps=function(e,t){return JSON.stringify(e.data)!==JSON.stringify(t.oriData)?{oriData:e.data,data:e.data,cluData:e.data.slice(0,$),page:1}:null},t.prototype.render=function(){var e=this,t=this.state,n=t.cluData,a=t.page,r=t.data,i=this.props,l=i.style,c=i.getTableRef,s=JSON.parse(JSON.stringify(n));if(s.length<30)for(var u=3-s.length,h=0;h<30-u;h++)s.push(void 0);return o.createElement("div",{className:"yt_wordcloud_opinion_list_wrapper",style:l,ref:c},o.createElement("div",{className:"opinion_list"},s.map((function(t,n){var r=30*(a-1)+n+1;return o.createElement("div",{key:t?t.name:n},t?o.createElement(o.Fragment,null,o.createElement(L.Z,{overlayClassName:"popover-detail-wrodcloud-list-wrapper",placement:"top",overlay:e.renderWordOverlay(t.name)},o.createElement("span",{className:"option-item ",onClick:function(n){return e.handleOnClick(t.name,r)}},o.createElement("span",null,o.createElement("span",{style:{backgroundColor:""+(r<7?Q.rf[r%Q.rf.length]:"#8c8c8c")}},r)),o.createElement("span",null,t.name),o.createElement("span",null,(0,d.hE)(t.oriValue)),o.createElement("span",null,"("+(100*t.ratio).toFixed(2)+"%)")))):null)}))),r.length>30&&o.createElement("div",{style:{textAlign:"right"}},o.createElement(_.Pagination,{className:"oppion-word-pagination",layout:"prev, pager, next",total:r.length,pageSize:30,currentPage:a,small:!0,onCurrentChange:this.handleOnPageChange})))},t}(o.Component);var te=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleOnMoreClick=function(e){var t=n.props.title,a=n.state,r=a.data,i=a.chartType;"image"===e&&n.chartRef?"chart"===i?(0,m._v)(n.chartRef,t):(0,m.Mx)(n.tableRef,t):"data"===e&&(0,s.P)(r)&&r instanceof Array&&(0,m.aT)([[["\u5173\u952e\u8bcd","\u58f0\u91cf","\u5360\u6bd4"]].concat(r.map((function(e){return[e.name,e.oriValue,(100*e.ratio).toFixed(2)+"%"]})))],t)},n.handleOnChange=function(e){var t=n.props.onChange;t&&t({clusterLevel:e})},n.handleOnMsgClick=function(e,t){n.props.onMsgClick(e,t,"word")},n.state={chartType:"chart",data:void 0},n}(0,i.Z)(t,e),t.getDerivedStateFromProps=function(e,t){if(JSON.stringify(e.data)!==JSON.stringify(t.data)){var n=e.data;if(n instanceof Array){var a=n.reduce((function(e,t){return e+t.value}),0);n=n.map((function(e){var t=e.name,n=e.value;return{ratio:a?n/a:0,value:Math.sqrt(n),name:t,oriValue:n}})).sort((function(e,t){return t.oriValue-e.oriValue}))}return{data:n}}return null};var n=t.prototype;return n.componentDidMount=function(){var e=this;this.internalId=setInterval((function(){if(e.chartRef){clearInterval(e.internalId),e.renderChart();var t=e.chartRef._dom.children,n=t[0],a=t[1];n.addEventListener("mouseleave",(function(t){e.chartLeaveTimeout=setTimeout((function(){e.chartLeaveTimeout&&(a.style.display="none")}),2e3)})),a&&a.addEventListener("mouseenter",(function(t){e.chartLeaveTimeout=void 0}))}}),200)},n.componentDidUpdate=function(e,t){var n=t.data,a=this.state.data;(0,s.P)(a)&&JSON.stringify(n)!==JSON.stringify(a)&&this.renderChart(),!(0,s.P)(a)&&this.chartRef&&(this.chartRef=void 0)},n.renderChart=function(){var t=this.props.title,n=this.state.data;(0,s.P)(n)&&n instanceof Array&&this.chartRef&&e.prototype.renderChart.call(this,n,t)},n.render=function(){var e=this,t=this.state,n=t.data,a=t.chartType,r=this.props,i=r.title,l=r.options,c=r.clusterLevel,d=r.className,p=void 0===d?"":d,f=r.wsRunning,m=void 0,v=void 0,g=!1;return(0,s.P)(n)&&"number"===typeof n?1===n?(g=!0,m=n):(m="error",2===n?v="\u5f53\u524d\u6d88\u606f\u4e2d\u5c11\u4e8e20\u4e2a\u89c2\u70b9\uff0c\u65e0\u6cd5\u542f\u52a8\u5178\u578b\u610f\u89c1":3===n?v="\u5f53\u524d\u5c11\u4e8e50\u6761\u6d88\u606f\uff0c\u65e0\u6cd5\u542f\u52a8\u5178\u578b\u610f\u89c1":4===n&&(v="\u5f53\u524d\u5927\u4e8e50\u4e07\u6761\u6d88\u606f\uff0c\u65e0\u6cd5\u542f\u52a8\u5178\u578b\u610f\u89c1")):m=n,o.createElement(s.Z,{className:"yt_scene_bar_chart_wrapper "+(v?"yt_scene_bar_chart_error_wrapper":"")+" "+p+" ",data:m,errorHint:v,loading:g,renderTitle:o.createElement(u.Z,{title:i,data:void 0,onMoreClick:this.handleOnMoreClick,titleOverlay:o.createElement(o.Fragment,null,o.createElement("div",null,"\u8be5\u6570\u636e\u4e3a\u60a8\u663e\u793a\uff1a\u7531\u4e8e\u6240\u9009\u7684\u6d88\u606f\u4e2d\u4e0d\u5149\u4f1a\u6709\u4e0e\u4e2d\u5fc3\u6307\u6807\u60c5\u611f\u76f8\u5173\u7684\u89c2\u70b9\uff0c\u8fd8\u4f1a\u6709\u5176\u4ed6\u76f8\u5173\u6307\u6807\u548c\u60c5\u611f\u7684\u89c2\u70b9\uff0c\u7528\u6237\u53ef\u4ee5\u81ea\u4e3b\u63a7\u5236\u662f\u5426\u5c55\u793a\u4ec5\u5c55\u793a\u4e2d\u5fc3\u6307\u6807\u60c5\u611f\u76f8\u5173\u7684\u89c2\u70b9\uff1b\u540c\u65f6\u5bf9\u4e8e\u805a\u7c7b\u7684\u89c2\u70b9\u7c97\u7ec6\u7a0b\u5ea6\u4e5f\u53ef\u4ee5\u7531\u7528\u6237\u9009\u62e9\u3002"),o.createElement("div",null,"\u7b97\u6cd5\u8bf4\u660e\uff1a\u5178\u578b\u610f\u89c1\u7684\u83b7\u5f97\u5927\u81f4\u7ecf\u5386\u5982\u4e0b\u51e0\u4e2a\u6b65\u9aa4\uff1a\u2460\u4ece\u6d88\u606f\u4e2d\u62bd\u53d6\u89c2\u70b9\u2192\u2461\u5bf9\u89c2\u70b9\u805a\u7c7b\u2192\u2462\u9009\u4e3e\u4e2d\u5fc3\u89c2\u70b9\u3002\u5728\u4ee5\u4e0a\u6b65\u9aa4\u4e0a\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u2460\u4e4b\u540e\u9009\u62e9\u5373\u5c06\u805a\u7c7b\u7684\u89c2\u70b9\u662f\u5426\u4e0e\u4e2d\u5fc3\u6307\u6807\u60c5\u611f\u76f8\u5173\uff1b\u5728\u2461\u7528\u6237\u53ef\u4ee5\u9009\u62e9\u805a\u7c7b\u7684\u7c97\u7ec6\u7a0b\u5e8f\uff0c\u53c2\u6570\u8bbe\u7f6e\u8d8a\u5c0f\uff0c\u805a\u7c7b\u7684\u89c2\u70b9\u8d8a\u7ec6\uff1b\u5728\u2462\u53ef\u80fd\u4f1a\u9009\u4e3e\u51fa\u4e0e\u4e2d\u5fc3\u6307\u6807\u7684\u60c5\u611f\u76f8\u5173\u7684\u89c2\u70b9\uff0c\u8fd9\u662f\u7528\u6237\u53ef\u4ee5\u9009\u62e9\u6392\u9664\u8be5\u4e2d\u5fc3\u89c2\u70b9\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u7ed9\u51fa\u7b2c\u4e8c\u5907\u9009\u7684\u89c2\u70b9\u3002"),o.createElement("div",null,"\u540d\u8bcd\u8fa8\u6790\uff1a\u5178\u578b\u610f\u89c1\u5373\u89c2\u70b9\uff0c\u662f\u4e00\u4e2a\u805a\u7c7b\u51fa\u7684\u89c2\u70b9\u7c07\u4e2d\u7684\u4ee3\u8868\u3002"))},o.createElement(L.Z,{overlay:"\u5f53\u524d\u56fe\u8868\u663e\u793a\u7684\u662f\u524d5000\u6761\u6d88\u606f\u7684\u5178\u578b\u610f\u89c1\u7ed3\u7b97\u7ed3\u679c\uff0c\u7cfb\u7edf\u6b63\u5728\u8ba1\u7b97\u5168\u90e8\u6d88\u606f\u7684\u5178\u578b\u610f\u89c1\uff0c\u8ba1\u7b97\u597d\u4e4b\u540e\u4f1a\u81ea\u52a8\u5237\u65b0\u56fe\u8868",placement:"top",overlayClassName:"alert-log-tips"},o.createElement("i",{className:"icon-cem_refresh "+(f?"refreshing":"")+" ",style:{display:f?"inline-block":"none"}})),o.createElement(h.Z,{preTitle:"\u805a\u7c7b\u9897\u7c92",activeObj:c,options:l,onChange:this.handleOnChange}),o.createElement(L.Z,{placement:"top",overlay:"\u8bcd\u4e91\u56fe"},o.createElement("span",{onClick:function(){return e.setState({chartType:"chart"})}},o.createElement(M.Z,{isActive:"chart"===a,defaultIcon:"cem_terms",activeIcon:"cem_terms-color"}))),o.createElement(L.Z,{placement:"top",overlay:"\u6570\u636e\u8868\u683c"},o.createElement("span",{onClick:function(){return e.setState({chartType:"table"})}},o.createElement(M.Z,{isActive:"table"===a,defaultIcon:"cem_word-list",activeIcon:"cem_word-list-color"}))),o.createElement("div",{className:"v-divider"}))},o.createElement(E.Z,{onChartReady:this.getChartRef,theme:"yunting_multi_color",option:{},style:{height:"100%",display:"chart"===a?"block":"none"}}),(0,s.P)(m)&&m instanceof Array&&o.createElement(ee,{data:m,getTableRef:this.getTableRef,onClick:this.handleOnMsgClick,style:{height:"100%",display:"table"===a?"block":"none"}}))},t}(K);const ne=te;te.propTypes={className:C().string,data:C().any,loading:C().bool,title:C().string,clusterLevel:C().string,onChange:C().func,onMsgClick:C().func,options:C().arrayOf(C().shape({title:C().string,value:C().string,disabled:C().bool}))};const ae=function(e){var t=e.c1Data,n=e.c1TimeType,a=e.fetchingC1Data,r=e.timeOpts,i=e.c2Data,l=e.c2AnalyzeObj,s=e.topicOpts,u=e.fetchingC2Data,h=e.c3Data,d=e.fetchingC3Data,p=e.c4Data,f=e.c4SelectedObjs,m=e.compareOpts,v=e.fetchingC4Data,g=e.c4DefaultName,y=e.c5Data,C=e.c5AspectLevel,E=e.fetchingC5Data,O=e.c6Data,S=e.clusterLevel,T=e.clusterLevelOpts,D=e.wsRunning,k=e.target,_=e.aspectName,N=e.topicName,w=e.onMsgClick,x=e.onFilterChange;return o.createElement("div",{className:"yt_drill_down_scene_wrapper"},o.createElement(c.Z,{title:"\u8be6\u60c5\uff1a"+k.name+"\uff0c"+_}),o.createElement("div",{className:"content"},o.createElement("div",{className:"chart_group_a"},o.createElement(b,{title:"\u573a\u666f\u6807\u7b7e\u300c"+_+"\u300d\u58f0\u91cf\u8d70\u52bf",data:t,timeType:n,timeOptions:r,loading:a,onMsgClick:w,onFilterChange:x}),o.createElement(R,{title:"\u573a\u666f\u6807\u7b7e\u300c"+_+"\u300d\u58f0\u91cf\u5206\u5e03",value:i,loading:u,topicObj:l,topicOpts:s,onMsgClick:w,onFilterChange:x})),o.createElement("div",{className:"chart_group_b"},o.createElement(Z,{title:"\u4e0e\u5176\u4ed6\u573a\u666f\u6807\u7b7e\u7684\u5173\u8054\u5206\u6790",data:h,loading:d,onMsgClick:w,aspectName:_}),o.createElement(z,{data:p,options:m,loading:v,title:N+"\u5bf9\u6bd4",selectedObjs:f,defaultName:g,topicName:N,onMsgClick:w,onChange:x})),o.createElement(X,{className:"chart_group_c",data:y,loading:E,title:"\u6307\u6807\u60c5\u611f\u5206\u6790",aspectLevel:C,onMsgClick:w,onChange:x}),o.createElement(ne,{className:"chart_group_d",title:"\u5178\u578b\u610f\u89c1",data:O,options:T,clusterLevel:S,onMsgClick:w,onChange:x,wsRunning:D})))};var re=n(35239),ie=n(64396),oe=n(55609),le=n(87219),ce=n(53113),se=n(11765),ue=["loading"],he={SCENE_SEX:"user.gender",SCENE_AGE:"user.age",SCENE_USE_SCENE:"space",SCENE_USE:"usage",SCENE_BUY_DECISION:"buy_decision",SCENE_RELATION:"relation",SCENE_MY_ADVICE:"suggestion"},de=ie.Z.drillDown.sceneAnalyze,pe=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnMsgClick=function(e,t,a){var i=n.props,o=i.projectId,c=i.dateFilter,s=i.filterModel,u=i.analysisModel,h=i.oriFilterModel,d=i.c1TimeType,p=i.c1Data,f=i.c2Data,m=i.c2AnalyzeObj,v=i.c4Data,g=i.c5AspectLevel,y=i.taskId,C=e.name,E=e.componentSubType,O=e.data,b=u[0].values[0].id,S="trend"===a?s:"aspect"===a?(0,se.gt)(h,O[1].split(":")[1],O[0]):"config"===a?(0,se.DR)(s,v.find((function(e){return e.name===C})).id,b):"model"===a?(0,se.c6)(s,e[0].name,[g,e.length>1?"total":e[0].seriesName]):"allConfig"===a?(0,se.DR)(s,f.find((function(e){return e.name===C})).id,m):s,T="word"===a?{clusterLevel:20,content:[{contain:[]}],opinion:C,taskId:y}:{},D={projectId:o,dateFilter:p instanceof Array&&p.length>0?(0,l.X_)(E,c,C,p.map((function(e){return e.name})),d):c,filterModel:(0,r.Z)({project:[o],messageType:["MESSAGE_COMMENT"]},T),newFilterModel:S,filterTip:"\u4ea7\u54c1\u6d1e\u5bdf/\u573a\u666f\u6316\u6398/\u5206\u6790\u8be6\u60c5/"+t};window.open("/inbox/public?"+encodeURIComponent(JSON.stringify(D)))},n._handleOnWsMessage=function(e){var t=e.data;if(t.type&&"ws"===t.type){var a=t.payload,r=a.type,i=a.result;if("OPINION_TASK_RESULT"===r){var o=n.props,l=o.clusterLevelOpts,c=o.taskId,s=o.tmpC6Data,u=i.taskId,h=i.clusterLevel,d=i.data;if(u===c){var p=String(h);if(-1===h)n.props.fetchOpinionData({clusterLevel:"20",wsRunning:!1,clusterLevelOpts:(0,le.ZP)(l,(function(e){e.forEach((function(e){return e.disabled=!1}))}))});else{var f={clusterLevel:p,tmpC6Data:(0,le.ZP)(s,(function(e){e[p]=d})),clusterLevelOpts:(0,le.ZP)(l,(function(e){var t=e.find((function(e){return e.value===p}));t&&(t.disabled=!1)}))};20===h&&(f.c6Data=f.tmpC6Data[p]),n.props.save(f)}}}}},n._handleOnFilterChange=function(e){e.c1TimeType?n.props.fetchC1Data(e):e.c2AnalyzeObj?n.props.fetchC2Data(e):e.c4SelectedObjs?n.props.fetchC4Data(e):e.c5AspectLevel?n.props.fetchC5Data(e):e.clusterLevel&&n.props.fetchOpinionData(e)},n.state={},n.event={onFilterChange:n._handleOnFilterChange,onMsgClick:n._handleOnMsgClick},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=JSON.parse(decodeURIComponent(this.props.location.search.substr(1))),t=e.pageType,n=e.name,a=e.aspectObj,r=void 0===a?{id:void 0,name:void 0}:a,i=e.target,o=void 0===i?{id:void 0,name:void 0}:i,l=e.filterModel,c=void 0===l?[]:l,s=e.compareOpts,u=void 0===s?[]:s,h=e.dateFilter,d=void 0===h?{}:h,p=e.analysisModel,f=void 0===p?[]:p,m=e.oriFilterModel,v=[],g=[],y=[],C="",E="",O="";try{g=(0,ce.X)(d.numOfDays).dateOptions,C=f[0].values[0].label,E=f[0].values[0].id,O=(v=re.t.get(re.V.configOptions).filter((function(e){return e.value!==E})))[0].value||"",y="\u5168\u9009"===o.name?[]:u.map((function(e){return e.value}))}catch(b){}this.props.fetchData({projectId:re.t.get(re.V.curProject).id,pageType:t,sceneName:n,target:o,filterModel:c,analysisModel:f,dateFilter:d,topicOpts:v,timeOpts:g,c4SelectedObjs:y,aspectName:r.name,aspectId:r.id,aspectIdKey:he[r.id],topicName:C,topicId:E,c2AnalyzeObj:O,oriFilterModel:m}),window.addEventListener("message",this._handleOnWsMessage)},n.componentWillUnmount=function(){window.removeEventListener("message",this._handleOnWsMessage)},n.render=function(){return o.createElement(ae,(0,r.Z)({},this.props,this.state,this.event))},t}(o.Component);const fe=(0,oe.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,ue);return(0,r.Z)({},n[[de]],{fetchingC1Data:t.effects[de+"/fetchC1Data"]||!1,fetchingC2Data:t.effects[de+"/fetchC2Data"]||!1,fetchingC3Data:t.effects[de+"/fetchC3Data"]||!1,fetchingC4Data:t.effects[de+"/fetchC4Data"]||!1,fetchingC5Data:t.effects[de+"/fetchC5Data"]||!1,fetchingC6Data:t.effects[de+"/fetchC6Data"]||!1})}),(function(e){return{save:function(t){return e({type:de+"/save",payload:t})},fetchData:function(t){return e({type:de+"/fetchData",payload:t})},wordcloudReducer:function(t){return e({type:de+"/wordcloudReducer",payload:t})},fetchC1Data:function(t){return e({type:de+"/fetchC1Data",payload:t})},fetchC2Data:function(t){return e({type:de+"/fetchC2Data",payload:t})},fetchC4Data:function(t){return e({type:de+"/fetchC4Data",payload:t})},fetchC5Data:function(t){return e({type:de+"/fetchC5Data",payload:t})},fetchOpinionData:function(t){return e({type:de+"/fetchOpinionData",payload:t})}}}))(pe)},11765:(e,t,n)=>{n.d(t,{gt:()=>i,DR:()=>o,c6:()=>l});var a=n(87462),r=(n(2329),{"\u6027\u522b":"SCENE_SEX","\u5e74\u9f84\u6bb5":"SCENE_AGE","\u5e74\u9f84":"SCENE_AGE","\u5173\u7cfb":"SCENE_RELATION","\u4f7f\u7528\u573a\u5408":"SCENE_USE_SCENE","\u7528\u9014":"SCENE_USE","\u8d2d\u4e70\u51b3\u7b56":"SCENE_BUY_DECISION","\u7528\u6237\u5efa\u8bae":"SCENE_MY_ADVICE"}),i=function(e,t,n){var i=e.find((function(e){return"SCENE_ASPECT"===e.id}));return[].concat(e.filter((function(e){return"SCENE_ASPECT"!==e.id})).map((function(e){return(0,a.Z)({},e)})),[{id:"SCENE_ASPECT",isSelectAll:i&&i.isSelectAll?i.isSelectAll:null,values:i?[].concat(i.values.map((function(e){return(0,a.Z)({},e)})),[{id:r[n],values:[t]}]):[{id:r[n],values:[t]}]}])},o=function(e,t,n){var r=e.find((function(e){return"CONFIG"===e.id}));return[].concat(e.filter((function(e){return"CONFIG"!==e.id})).map((function(e){return(0,a.Z)({},e)})),[{id:"CONFIG",isSelectAll:r&&r.isSelectAll?r.isSelectAll:null,values:[].concat(r.values.filter((function(e){return e.id!==n})).map((function(e){return(0,a.Z)({},e)})),[{id:n,values:[t]}])}])},l=function(e,t,n){var r=e.find((function(e){return"ASPECT_MODEL"===e.id}));return[].concat(e.filter((function(e){return"ASPECT_MODEL"!==e.id})).map((function(e){return(0,a.Z)({},e)})),[{id:"ASPECT_MODEL",values:r?[].concat(r.values.filter((function(e){return e.id!==n[0]&&"ASPECT_ESCORE"!==e.id})).map((function(e){return(0,a.Z)({},e)})),[{id:n[0],values:[t]},{id:"ASPECT_ESCORE",values:n[1].includes("\u8d1f\u9762")?["3"]:n[1].includes("\u6b63\u9762")?["8"]:["3","8"]}]):[{id:n[0],values:[t]},{id:"ASPECT_ESCORE",values:n[1].includes("\u8d1f\u9762")?["3"]:n[1].includes("\u6b63\u9762")?["8"]:["3","8"]}]}])}},33905:(e,t,n)=>{n.d(t,{kQ:()=>o,ao:()=>s,yc:()=>l,ch:()=>i,rf:()=>a,t7:()=>r,KT:()=>c});var a=["#1550B3","#CC6A77","#119073","#CDB446","#D969BF","#2684FF","#C8662B","#9369D9","#0E97AD","#1BBF69","#D07B49","#61799B","#1EA082","#A9A557","#D8727F"],r=["#3D85FF","#FFA7B2","#15D4A9","#F7D956","#FF9FE9","#75B1FF","#FF9E63","#C7A6FF","#1AC9E5","#47F79B","#FFA875","#4D6282","#2EE0B7","#D2CE77","#FF9FAC"],i=["#D96969","#15B374"],o={barWidth:21,barGap:"30%",barCategoryGap:20,height:300,marginTop:40,marginBottom:40},l=function(e,t){switch(e){case"s1":return t;case"s2":return"positive"===t?"positiveWeight1":"negativeWeight1";case"s3":return"positive"===t?"positiveA":"negativeA";case"s4":return"positive"===t?"positiveB":"negativeB";case"s5":return"positive"===t?"positiveC":"negativeC"}},c=function(e,t,n,a){if(a.length<1)return a;var r=l(n,e),i=JSON.parse(JSON.stringify(a)).map((function(e){return e.data=[],e}));return i.forEach((function(e,n){e.data=JSON.parse(JSON.stringify(a[n])).data.sort((function(e,n){return"asc"===t?e[r]-n[r]:"desc"===t?n[r]-e[r]:null}))})),i},s=function(e){return 0<=e&&e<1e3?e:e<1e4?(e/1e3).toFixed(2)+"\u5343":(e/1e4).toFixed(2)+"\u4e07"}},55815:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(94578),r=n(67294),i=n(45697),o=n.n(i),l=n(43036),c=n(61409),s=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props,a=n.title,r=n.beforeJump;e!==a.length-1&&(r?new Promise((function(e,t){return r(e,t)})).then((function(){c.mW.push({pathname:a[e].url,state:a[e].state})})):c.mW.push({pathname:a[e].url,state:a[e].state}))},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.mainTitle,i=t.rightContent,o=t.className,c=t.overlay;return r.createElement("div",{className:"breadcumb-wrapper "+o},n instanceof Array?r.createElement("div",{className:"breadcrumb-left"},r.createElement("div",null,n.map((function(t,a){return r.createElement("span",{className:t.url?"":"not_clickable",key:a,onClick:function(){return t.url&&a!==n.length-1&&e._handleBreadcrumbClick(a)}},t.title,a!==n.length-1&&" / ")}))),r.createElement("span",null,a||n[n.length-1].title,c&&r.createElement(l.Z,{placement:"top",overlay:c},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}})))):r.createElement("div",{className:"normal-title"},n,c&&r.createElement(l.Z,{placement:"top",overlay:c},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}}))),i||"")},t}(r.Component);s.propTypes={className:o().string,title:o().oneOfType([o().string,o().arrayOf(o().shape({title:o().string,url:o().string,state:o().object}))]).isRequired,overlay:o().oneOfType([o().string,o().node]),mainTitle:o().oneOfType([o().string,o().node]),beforeJump:o().func,rightContent:o().node};const u=s}}]);