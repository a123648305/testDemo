"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[1322],{91322:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var a=n(63366),r=n(87462),i=n(94578),l=n(67294),o=n(92360),s=n(55815),c=n(8201),u=n(23570),p=n(71339),d=n(43036),h=n(39432),m=n(35303),g=(n(15267),n(64713)),f=n(43144),v=n(55609),y=n(61918),C=n(2271),S=n(87219),_=n(64396),E=n(33722),b=["loading"],N=_.Z.research.setting.edit;function O(e,t){for(var n=new RegExp(t.toLocaleLowerCase()),a=[],r=0;r<e.length;r++)n.test(e[r].title.toLocaleLowerCase())&&a.push(e[r]);return a}var L={visible:!1,curPageList:void 0,pageIndex:1,pageSize:10,queList:[],filterQueList:void 0,filterTotal:void 0,oriQueList:[],keyword:"",queType:"system"},x=function(e){function t(t){var n;return(n=e.call(this,t)||this).showDialog=function(e){n.setState((0,r.Z)({queType:"system",visible:!0},e),(function(){n.props.fetchQuestionnaireList({}),n.props.fetchQuestionnaireList({thirdParty:!0})}))},n._handleOnCancel=function(){n.setState(JSON.parse(JSON.stringify(L)))},n._handleOnConfrim=function(){var e=n.props,t=e.queList,a=e.thQueList;n.props.save({questionnaireList:null==t?void 0:t.filter((function(e){return e.checked})).concat(null==a?void 0:a.filter((function(e){return e.checked}))),queList:[]}),n._handleOnCancel()},n._handleOnPageIndexChange=function(e){var t=n.state,a=t.queList,r=t.pageSize,i=t.filterQueList;n.setState({pageIndex:e,curPageList:(i||a).slice((e-1)*r,e*r)})},n._handleOnPageSizeChange=function(e){var t=n.state,a=t.queList,r=t.filterQueList;n.setState({pageIndex:1,pageSize:e,curPageList:(r||a).slice(0,e)})},n._handleOnAllChange=function(e){var t,a=n.state,i=a.queList,l=a.pageIndex,o=a.pageSize,s=a.filterQueList,c=a.keyword,u=a.queType,p=i.map((function(t){return(0,r.Z)({},t,{checked:s?s.some((function(e){return e.id===t.id}))?e:t.checked:e})})),d=s?O(p,c):void 0;n.setState({queList:p,curPageList:d||p.slice((l-1)*o,l*o),filterQueList:d}),n.props.save(((t={})["thirdParty"===u?"thQueList":"queList"]=p,t))},n._handleOnChange=function(e,t){var a,r=n.state,i=r.queList,l=r.pageIndex,o=r.pageSize,s=r.filterQueList,c=r.keyword,u=r.queType,p=(0,S.ZP)(i,(function(n){n.find((function(t){return t.id===e})).checked=t})),d=s?O(p,c):void 0;n.setState({queList:p,curPageList:d||p.slice((l-1)*o,l*o),filterQueList:d}),n.props.save(((a={})["thirdParty"===u?"thQueList":"queList"]=p,a))},n._handleOnSearch=function(e){var t=n.state,a=t.queList,r=t.pageSize,i=e?O(a,e):void 0;n.setState({keyword:e,curPageList:(i||a).slice(0,r),pageIndex:1,filterQueList:i,filterTotal:i?i.length:void 0})},n.onRadioChange=function(e){var t=e.target.value;n.setState({queType:t})},n.state=JSON.parse(JSON.stringify(L)),n}return(0,i.Z)(t,e),t.getDerivedStateFromProps=function(e,t){var n=t.pageIndex,a=t.pageSize,r=t.oriQueList,i=t.queType,l=e.queList,o=e.thQueList,s="thirdParty"===i?o:l;return JSON.stringify(r)!==JSON.stringify(s)?{oriQueList:s,queList:s,curPageList:null==s?void 0:s.slice((n-1)*a,n*a)}:null},t.prototype.render=function(){var e=this.state,t=e.visible,n=e.curPageList,a=e.pageIndex,r=e.pageSize,i=e.filterTotal,s=e.queType,c=this.props,u=c.queTotal,p=c.type,d=c.loading,h=c.thQueTotal,m="thirdParty"===s?h:u;return l.createElement(o.Dialog,{className:"yt_board_edit_select_dialog_wrapper",size:"tiny",visible:t,title:l.createElement("div",null,"\u5173\u8054\u95ee\u5377",l.createElement("span",{className:"tips"},"\u6ce8\uff1a\u4ec5\u5c55\u793a\u542b\u6709","NPS"===p?"NPS":"\u6ee1\u610f\u5ea6","\u5ba2\u89c2\u9898\u7684\u95ee\u5377")),closeOnClickModal:!1,onCancel:this._handleOnCancel},l.createElement(o.Dialog.Body,null,l.createElement(y.Z,{placeholder:"\u8bf7\u8f93\u5165\u95ee\u5377\u540d",onSearch:this._handleOnSearch,onClear:this._handleOnSearch}),l.createElement(g.default.Group,{options:[{label:"\u7cfb\u7edf\u81ea\u5e26",value:"system"},{label:"\u7b2c\u4e09\u65b9",value:"thirdParty"}],onChange:this.onRadioChange,value:s,optionType:"button"}),l.createElement(C.Z,{columns:this.columns,data:n,total:void 0!==i?i:m,rowKeyProp:"id",pageIndex:a,pageSize:r,loading:d,onPageChange:this._handleOnPageIndexChange,onPageSizeChange:this._handleOnPageSizeChange})),l.createElement(o.Dialog.Footer,null,l.createElement(o.Button,{onClick:this._handleOnCancel},"\u53d6\u6d88"),l.createElement(o.Button,{type:"primary",onClick:this._handleOnConfrim},"\u786e\u5b9a")))},(0,f.Z)(t,[{key:"columns",get:function(){var e=this,t=this.state,n=t.queList,a=t.filterQueList,r=!1,i=a?n.filter((function(e){var t=e.id;return a.some((function(e){return e.id===t}))})):n,s=!(null==i||!i.length)&&i.reduce((function(e,t){var n=t.checked;return!r&&n&&(r=!0),n&&e}),!0);return[{prop:"select",renderHeader:function(t){return l.createElement(o.Checkbox,{checked:s,indeterminate:!s&&r,onChange:e._handleOnAllChange})},width:50,render:function(t,n,a){return l.createElement(o.Checkbox,{checked:t.checked,onChange:function(n){return e._handleOnChange(t.id,n)}})}},{label:"\u95ee\u5377\u540d\u79f0",prop:"title"},{label:"\u5ba2\u89c2\u9898\u56de\u7b54\u6570",prop:"submitted"},{label:"\u6700\u8fd1\u4e00\u6b21\u4fee\u6539",prop:"updatedAt",render:function(e){return(0,E.Go)(e.updatedAt)}}]}}]),t}(l.PureComponent);const k=(0,v.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,b)[N],r=n.queList,i=n.queTotal,l=n.questionnaireList;return{type:n.type,queList:r,queTotal:i,questionnaireList:l,thQueList:n.thQueList,thQueTotal:n.thQueTotal,loading:t.effects[N+"/fetchQuestionnaireList"]||!1}}),(function(e){return{fetchQuestionnaireList:function(t){return e({type:N+"/fetchQuestionnaireList",payload:t})},save:function(t){return e({type:N+"/save",payload:t})}}}),null,{withRef:!0})(x);const P=function(e){function t(t){var n;(n=e.call(this,t)||this)._handleOnPageChange=function(e){var t=n.props,a=(t.save,t.questionnaireList);n.setState({pageIndex:e},(function(){n.setState({questionnaireData:a.slice((n.state.pageIndex-1)*n.state.pageSize,n.state.pageIndex*n.state.pageSize)})}))},n._handleOnPageSizeChange=function(e){var t=n.props,a=(t.save,t.questionnaireList);n.setState({pageSize:e,pageIndex:1},(function(){n.setState({questionnaireData:a.slice((n.state.pageIndex-1)*n.state.pageSize,n.state.pageIndex*n.state.pageSize)})}))},n._handleOnNameChange=function(e,t,a){var r=e.target;n.nameRef=t,n.setState({inputText:a}),n.props.formChange({key:"name",value:r.value})},n._handleOnNameBlur=function(e){n.state.inputText&&n.setState({inputText:""})},n._getRef=function(e){e&&(n.dialogRef=e.wrappedInstance)},n._handleOnAdd=function(){n.dialogRef&&n.dialogRef.showDialog()};var a=t.onDeleteQues;return n.dialogRef=void 0,n.state={inputText:t.inputText,columns:[{label:"",width:16},{label:"\u95ee\u5377\u540d\u79f0",prop:"title",width:333.5,render:function(e){return l.createElement("span",{className:"ellipisis"},e.title)}},{label:"\u5206\u503c\u9898\u56de\u7b54\u6570",prop:"submitted",width:294.814,render:function(e){return l.createElement("span",{className:"ellipisis"},(0,h.hE)(e.submitted))}},{label:"\u64cd\u4f5c",width:38.686,render:function(e){return l.createElement("span",{className:"operator",onClick:function(){a(e.id),1!==n.state.pageIndex&&n._handleOnPageChange(1)}},"\u79fb\u51fa")}},{label:"",width:16}],pageSize:10,pageIndex:1,questionnaireData:[]},n.nameRef=void 0,n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e,t){var n=e.inputText,a=e.questionnaireList,r=this.props,i=r.inputText,l=r.questionnaireList;JSON.stringify(n)!==JSON.stringify(i)&&this.setState({inputText:i}),JSON.stringify(a)!==JSON.stringify(l)&&this.setState({questionnaireData:l.slice(0,this.state.pageSize)})},n.render=function(){var e=this.props,t=e.type,n=e.fetchingDetail,a=e.teamList,r=e.userList,i=e.form,o=e.questionnaireList,s=e.formChange,h=this.state,g=h.inputText,f=h.columns,v=h.pageIndex,y=h.pageSize,C=h.questionnaireData;return l.createElement(c.Z,{loading:n,data:i,className:"research_dashboard_edit_content_wrapper"},l.createElement("div",{className:"type_wrap"},l.createElement("span",null,"\u770b\u677f\u7c7b\u578b"),l.createElement("div",null,l.createElement("div",null,l.createElement("i",{className:"SATISFACTION"===t?"icon-cem_satisfaction-score":"icon-cem_npsboard"}),"SATISFACTION"===t?"\u6ee1\u610f\u5ea6\u770b\u677f":"NPS\u770b\u677f"),l.createElement("div",{className:"desc"},"SATISFACTION"===t?"\u57fa\u4e8e\u300c\u6ee1\u610f\u5ea6\u300d\u63d0\u4f9b\u7684\u5ba2\u6237\u4f53\u9a8c\u4ef7\u503c\u5206\u6790\u89c6\u89d2\uff0c\u5206\u6790\u62bd\u53d6\u95ee\u5377\u4e2d\u7684\u7684\u6ee1\u610f\u5ea6\u9898\u578b\uff0c\u542b\u5206\u503c\u9898\u548c\u539f\u56e0\u9898":"\u57fa\u4e8e\u300cNPS\u300d\u63d0\u4f9b\u7684\u5ba2\u6237\u4f53\u9a8c\u4ef7\u503c\u5206\u6790\u89c6\u89d2\uff0c\u5206\u6790\u62bd\u53d6\u95ee\u5377\u4e2d\u7684\u7684NPS\u9898\u578b\uff0c\u542b\u5206\u503c\u9898\u548c\u539f\u56e0\u9898"))),l.createElement("div",{className:"name_wrap"},l.createElement("span",null,"\u770b\u677f\u540d\u79f0"),l.createElement("div",null,l.createElement(u.Z,{placeholder:"\u8bf7\u8f93\u5165\u770b\u677f\u540d\u79f0",className:g?"input_error":"",onChange:this._handleOnNameChange,onBlur:this._handleOnNameBlur,maxLength:10,defaultValue:i.name}),g&&l.createElement("p",{className:"tip_text"},g))),l.createElement("div",{className:"user_wrap"},l.createElement("span",null,"\u8c01\u80fd\u53ef\u89c1"),l.createElement("div",null,l.createElement("span",null,l.createElement("span",null,"\u7528\u6237\u7ec4"),l.createElement("span",null,l.createElement(m.RS,{multiple:!0,tags:!1,onChange:function(e){return s({key:"teamIdList",value:e})},value:i.teamIdList,optionLabelProp:"label",optionFilterProp:"label"},a.map((function(e,t){return l.createElement(m.Wx,{key:t,value:e.id,label:e.name},e.name)}))))),l.createElement("span",null,l.createElement("span",null,"\u2003\u6210\u5458"),l.createElement("span",null,l.createElement(m.RS,{multiple:!0,tags:!1,onChange:function(e){return s({key:"userIdList",value:e})},value:i.userIdList,optionLabelProp:"label",optionFilterProp:"label"},r.map((function(e,t){return l.createElement(m.Wx,{key:t,value:e.id,label:e.username},e.username)}))))))),l.createElement("div",{className:"list_wrap"},l.createElement("span",null,"\u5173\u8054\u95ee\u5377",l.createElement(d.Z,{overlay:l.createElement("div",{style:{maxWidth:260}},l.createElement("div",null,"\u6b64\u770b\u677f\u4ec5\u5173\u8054\u300c","SATISFACTION"===t?"\u6ee1\u610f\u5ea6":"NPS","\u300d\u9898\u578b\uff0c\u5305\u62ec\u5206\u503c\u9898\u548c\u539f\u56e0\u9898 \u5982\u679c\u5904\u4e8e\u300c\u672a\u53d1\u5e03\u300d\u72b6\u6001\u7684\u95ee\u5377\u539f\u672c\u6709","SATISFACTION"===t?"\u6ee1\u610f\u5ea6":"NPS","\u9898\uff0c\u5728\u53d1\u5e03\u524d\u53c8\u5220\u9664\u4e86","SATISFACTION"===t?"\u6ee1\u610f\u5ea6":"NPS","\u9898\uff0c\u5219\u7cfb\u7edf\u4f1a\u81ea\u52a8\u53d6\u6d88\u76f8\u5173\u95ee\u5377\u4e0e\u6b64\u770b\u677f\u7684\u5173\u8054")),placement:"top"},l.createElement("span",null,l.createElement("i",{className:"icon-cem_file1",style:{marginLeft:4}})))),l.createElement("div",null,l.createElement("div",{className:"top_zone"},"\u5df2\u9009\u4e2d",o.length,"\u4e2a\u4e0e\u300c","SATISFACTION"===t?"\u6ee1\u610f\u5ea6":"NPS","\u300d\u6709\u5173\u7684\u95ee\u5377",l.createElement("div",{className:"add_ques_btn",onClick:this._handleOnAdd},l.createElement("i",{className:"icon-cem_add-to"}),"\u6dfb\u52a0\u95ee\u5377")),l.createElement(p.Z,{loading:!1,columns:f,data:o&&o instanceof Array?C:[],total:o?o.length:0,pageSize:y,pageIndex:v,onPageChange:this._handleOnPageChange,onPageSizeChange:this._handleOnPageSizeChange}))),l.createElement(k,{ref:this._getRef}))},t}(l.PureComponent);function w(e){return[{title:"\u914d\u7f6e",url:""},{title:"\u770b\u677f\u8bbe\u7f6e",url:"/research/setting"},{title:(e?"\u7f16\u8f91":"\u65b0\u5efa")+"\u770b\u677f",url:""}]}const I=function(e){var t=e.id,n=e.onCancel,a=e.onSubmit;return l.createElement("div",{className:"yt_research_dashboard_edit_wrapper"},l.createElement(s.Z,{title:w(t)}),l.createElement("div",{className:"content"},l.createElement(P,e),l.createElement("div",{className:"button_zone"},l.createElement(o.Button,{onClick:n},"\u53d6\u6d88"),l.createElement(o.Button,{type:"primary",onClick:a},"\u4fdd\u5b58"))))};var z=n(61409),T=n(35239),q=n(61193),Z=n(5133),R=["loading"],F=_.Z.research.setting.edit,D=_.Z.public.menu,Q=function(e){function t(t){var n;return(n=e.call(this,t)||this).routerWillLeave=function(){return!n.props.hasChange||"\u4fe1\u606f\u8fd8\u672a\u4fdd\u5b58\uff0c\u786e\u8ba4\u8981\u79bb\u5f00\uff1f"},n.test=function(){var e=n.props.form.name,t="";return n.setState({isTest:!0}),e.length||(t="\u6b64\u5904\u4e3a\u5fc5\u586b\u9879\uff0c\u8bf7\u8f93\u5165\u770b\u677f\u540d\u79f0",n.setState({inputText:t})),!t},n._handleOnCancel=function(){z.mW.push({pathname:"/research/setting"})},n._handleOnSubmit=function(e){var t=n.props.type;n.test()&&n.props.submit().then((function(e){var a=e.data;2e4===a.code?(Z.Z.success(a.msg),n.props.save({hasChange:!1}),n.props.fetchMenuList({}),z.mW.push({pathname:"/research/setting"}),"NPS"===t?n.props.cleanNps({}):n.props.cleanSta({})):Z.Z.error(a.msg)}))},n._handleOnDeleteQues=function(e){var t=n.props,a=t.questionnaireList;(0,t.formChange)({key:"questionnaireList",value:a.filter((function(t){return t.id!==e}))})},n.state={isTest:!1,inputText:""},n._event={onCancel:n._handleOnCancel,onSubmit:n._handleOnSubmit,onDeleteQues:n._handleOnDeleteQues},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props.location.state,t=e.id,n=e.type;t?this.props.fetchDetail({id:t}):(n&&this.props.save({type:n}),this.props.formChange({key:"userIdList",value:[q.Z.getUser()&&q.Z.getUser().userId],hasChange:!1})),this.props.fetchUserList({projectId:T.t.get(T.V.curProject).id}),this.props.router.setRouteLeaveHook(this.props.route,this.routerWillLeave)},n.componentWillUnmount=function(){this.props.clean()},n.render=function(){return l.createElement(I,(0,r.Z)({},this.state,this.props,this._event))},t}(l.PureComponent);const A=(0,v.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,R);return(0,r.Z)({},n[F],{fetchingDetail:t.effects[F+"/fetchDetail"]||!1})}),(function(e){return{save:function(t){return e({type:F+"/save",payload:t})},fetchUserList:function(t){return e({type:F+"/fetchUserList",payload:t})},fetchDetail:function(t){return e({type:F+"/fetchDetail",payload:t})},formChange:function(t){return e({type:F+"/formChange",payload:t})},submit:function(t){return e({type:F+"/submit",payload:t})},clean:function(){return e({type:F+"/clean"})},cleanNps:function(t){return e({type:"researchAnalyzeNps/clear",payload:t})},cleanSta:function(t){return e({type:"researchAnalyzeSatisfaction/clear",payload:t})},fetchMenuList:function(t){return e({type:D+"/fetchMenuList",payload:t})}}}))(Q)},55815:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(94578),r=n(67294),i=n(45697),l=n.n(i),o=n(43036),s=n(61409),c=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props,a=n.title,r=n.beforeJump;e!==a.length-1&&(r?new Promise((function(e,t){return r(e,t)})).then((function(){s.mW.push({pathname:a[e].url,state:a[e].state})})):s.mW.push({pathname:a[e].url,state:a[e].state}))},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.mainTitle,i=t.rightContent,l=t.className,s=t.overlay;return r.createElement("div",{className:"breadcumb-wrapper "+l},n instanceof Array?r.createElement("div",{className:"breadcrumb-left"},r.createElement("div",null,n.map((function(t,a){return r.createElement("span",{className:t.url?"":"not_clickable",key:a,onClick:function(){return t.url&&a!==n.length-1&&e._handleBreadcrumbClick(a)}},t.title,a!==n.length-1&&" / ")}))),r.createElement("span",null,a||n[n.length-1].title,s&&r.createElement(o.Z,{placement:"top",overlay:s},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}})))):r.createElement("div",{className:"normal-title"},n,s&&r.createElement(o.Z,{placement:"top",overlay:s},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}}))),i||"")},t}(r.Component);c.propTypes={className:l().string,title:l().oneOfType([l().string,l().arrayOf(l().shape({title:l().string,url:l().string,state:l().object}))]).isRequired,overlay:l().oneOfType([l().string,l().node]),mainTitle:l().oneOfType([l().string,l().node]),beforeJump:l().func,rightContent:l().node};const u=c},25022:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(67294),r=n(92360),i=n(35303),l=n(45697),o=n.n(l),s=[{label:"10\u9879/\u9875",value:10},{label:"20\u9879/\u9875",value:20},{label:"40\u9879/\u9875",value:40},{label:"100\u9879/\u9875",value:100}];const c=function(e){var t=e.onPageChange,n=e.onSizeChange,l=e.total,o=void 0===l?0:l,c=e.pageIndex,u=e.pageSize,p=e.layout,d=e.className,h=e.currLength,m=0===o?0:(c-1)*u+1,g=0===o?0:h?m+h-1:m+u-1;return 0===o?null:a.createElement("div",{className:"yt-awp-pagination "+(d||"")},a.createElement("span",{className:"total_num"},a.createElement("span",null,m+" - "+g+" "),"\u9879\uff0c\u5171",a.createElement("span",null," "+o+" "),"\u9879"),a.createElement("div",{style:{textAlign:"right",float:"right"},className:"new_pagination"},a.createElement(r.Pagination,{small:!0,pageSize:u,currentPage:c,pageCount:Math.ceil(o/u),layout:0===o?"":"prev, pager, next",onCurrentChange:t}),void 0===p||p.includes("sizes")?a.createElement(i.RS,{multiple:!1,tags:!1,showSearch:!1,optionFilterProp:"label",optionLabelProp:"label",animation:"slide-up",dropdownClassName:"custom-pagination-dropdown",value:u||10,onChange:n},s.map((function(e,t){return a.createElement(i.Wx,{key:t,label:e.label,value:e.value},e.label)}))):null))};o().propTypes={onPageChange:o().func,onSizeChange:o().func,total:o().number,pageIndex:o().number,pageSize:o().number,layout:o().string,className:o().string}},71339:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(67294),r=n(92360),i=n(25022),l=n(45697),o=n.n(l),s=function(e){var t=e.data,n=e.total,l=void 0===n?0:n,o=e.loading,s=e.pageIndex,c=e.columns,u=e.pageSize,p=e.onPageChange,d=e.onPageSizeChange,h=e.onSortChange,m=e.defaultSort,g=e.className,f=void 0===g?"":g;return a.useEffect((function(){var e=document.getElementsByClassName("is-sortable")[0];m&&e&&e.classList.add(m.order)}),[m]),a.createElement("div",{className:"yt-awp-content-list "+f},a.createElement(r.Loading,{loading:o,className:"awp-content-loading"},a.createElement(r.Table,{defaultSort:m,columns:c,style:{width:"100%"},data:t,onSortChange:function(e){return h(e)}})),p&&a.createElement(i.Z,{onPageChange:p,onSizeChange:d,total:l,currLength:t.length,pageIndex:s,pageSize:u}))};s.propTypes={data:o().array,total:o().number,loading:o().bool,pageIndex:o().number,columns:o().array,pageSize:o().number,onPageChange:o().func,onPageSizeChange:o().func,onSortChange:o().func,defaultSort:o().any,className:o().string};const c=s},61918:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(67294),r=n(45697),i=n.n(r),l=function(e){var t=e.className,n=e.onClear,r=e.onSearch,i=e.placeholder,l=e.style,o=e.defValue,s=e.signal,c=a.useState(o),u=c[0],p=c[1];a.useEffect((function(){p(o)}),[o,s]);return a.createElement("div",{style:l,className:"yt_search_input_wrapper "+(t||"")},a.createElement("input",{placeholder:i,value:u,onKeyDown:function(e){13===e.keyCode&&r(u)},onChange:function(e){return p(e.target.value)},autoComplete:"off"}),u&&a.createElement("i",{className:"icon-cem_log-off",onClick:function(){p(""),n&&n("")}}),a.createElement("i",{className:"icon-cem_small-search",onClick:function(){return r(u)}}))};l.propTypes={className:i().string,onSearch:i().func.isRequired,placeholder:i().string,style:i().object,defValue:i().string,signal:i().any,onClear:i().func};const o=l},2271:(e,t,n)=>{n.d(t,{Z:()=>q});var a=n(63366),r=n(87462),i=n(43144),l=n(94578),o=n(23279),s=n.n(o),c=n(67294),u=n(92360),p=n(35303),d=n(45697),h=n.n(d),m=[{label:"10\u9879/\u9875",value:10},{label:"20\u9879/\u9875",value:20},{label:"40\u9879/\u9875",value:40},{label:"100\u9879/\u9875",value:100}];const g=function(e){var t=e.onPageChange,n=e.onSizeChange,a=e.total,r=void 0===a?0:a,i=e.pageIndex,l=e.pageSize,o=e.currLength,s=e.layout,d=e.className,h=0===r?0:(i-1)*l+1,g=0===r?0:h+o-1;return 0===r?null:c.createElement("div",{className:"yt-awp-pagination "+(d||"")},c.createElement("span",{className:"total_num"},c.createElement("span",null,h+" - "+g+" "),"\u9879\uff0c\u5171",c.createElement("span",null," "+r+" "),"\u9879"),c.createElement("div",{style:{textAlign:"right",float:"right"},className:"new_pagination"},c.createElement(u.Pagination,{small:!0,pageSize:l,currentPage:i,pageCount:Math.ceil(r/l),layout:0===r?"":"prev, pager, next",onCurrentChange:t}),void 0===s||s.includes("sizes")?c.createElement(p.RS,{multiple:!1,tags:!1,showSearch:!1,optionFilterProp:"label",optionLabelProp:"label",animation:"slide-up",dropdownClassName:"custom-pagination-dropdown",value:l||10,onChange:n},m.map((function(e,t){return c.createElement(p.Wx,{key:t,label:e.label,value:e.value},e.label)}))):null))};h().propTypes={onPageChange:h().func,onSizeChange:h().func,total:h().number,pageIndex:h().number,pageSize:h().number,currLength:h().number,layout:h().string,className:h().string};var f=n(8201),v=n(15861),y=n(87757),C=n.n(y),S=n(49722);function _(){return(_=(0,v.Z)(C().mark((function e(t){var n,a;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectId,a=t.key,e.abrupt("return",S.h.post("/default/value/find",{projectId:n,key:a}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){return(E=(0,v.Z)(C().mark((function e(t){var n,a,r;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectId,a=t.value,r=t.key,e.abrupt("return",S.h.post("/default/value/update",{projectId:n,key:r,value:a}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var b=n(39432),N=n(43036),O=n(51474),L=n(87219),x=function(e){function t(t){var n;return(n=e.call(this,t)||this)._setShowFalse=function(){n.setState({show:!1})},n._handleParentClick=function(e){n.state.show&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},n._handleOnTriggerClick=function(){setTimeout((function(){n.setState({show:!n.state.show})}),0)},n._renderOptionItem=function(e,t,a,r,i,l){var o=n.state.maxLabelWidth,s=n.props,u=s.value,p=s.savedKey,d=u.find((function(t){return t.prop===e.prop}));return c.createElement("div",{className:"opt_item "+(t?"draggable":""),key:e.prop},t&&c.createElement("i",{className:"icon-cem_move my_handle"}),c.createElement("div",{className:"opt_content",style:{width:o,marginLeft:t?0:12}},c.createElement("div",{className:"item_label",onClick:function(t){t.stopPropagation(),n._handleOnItemClick(e.prop)}},c.createElement("span",{className:"icon_checkbox "+(d&&d.checked?"checkbox_checked":"")}),c.createElement("span",null,e.label)),c.createElement("div",{className:"item_control",style:{display:"product_setting_link"===p?"none":"block"}},c.createElement(N.Z,{placement:"top",overlay:a},c.createElement("span",{onClick:function(t){return r(t,e.prop)}},c.createElement("i",{className:(t?"icon-cem_up":"icon-cem_up-and-down")+" fun_icon_a"}))),c.createElement(N.Z,{placement:"top",overlay:i},c.createElement("span",{onClick:function(t){return l(t,e.prop)},style:{marginLeft:4}},c.createElement("i",{className:"icon-cem_down fun_icon_b"}))))))},n._handleOnItemClick=function(e){var t=n.props,a=t.value,r=t.onChange;r&&r((0,L.ZP)(a,(function(t){var n=t.find((function(t){return t.prop===e}));n&&(n.checked=!n.checked)})))},n._handleOnFilxedLeftClick=function(e,t){e.stopPropagation(),n._handleOnFixedChange(t,"left")},n._handleOnCancelFixedClick=function(e,t){e.stopPropagation(),n._handleOnFixedChange(t,"")},n._handleOnFixedRightClick=function(e,t){e.stopPropagation(),n._handleOnFixedChange(t,"right")},n._handleOnFixedChange=function(e,t){var a=n.props,r=a.value,i=a.onChange;i&&i((0,L.ZP)(r,(function(n){var a=n.find((function(t){return t.prop===e}));a&&(a.fixed=t)})))},n.state={show:!1,value:[],leftOpts:[],normalOpts:[],rightOpts:[],maxLabelWidth:t.value.reduce((function(e,t){return Math.max((0,b.jD)(t.label,14)+56+16+16,e)}),0)},n}(0,l.Z)(t,e),t.getDerivedStateFromProps=function(e,t){if(JSON.stringify(e.value)!==JSON.stringify(t.value)){var n=e.value.reduce((function(t,n){var a=1;return"left"===n.fixed&&(a=0),"right"===n.fixed&&(a=2),t[a].push(e.value.find((function(e){return e.prop===n.prop}))),t}),[[],[],[]]),a=n[0],r=n[1],i=n[2];return{value:e.value,leftOpts:a,normalOpts:r,rightOpts:i,maxLabelWidth:e.value.reduce((function(e,t){return Math.max((0,b.jD)(t.label,14)+56+16+16,e)}),0)}}return null};var n=t.prototype;return n.componentDidMount=function(){var e=this;window.addEventListener("click",this._setShowFalse);var t=document.querySelectorAll("#draggable_zone");t.length&&t.forEach((function(t){O.default.create(t,{group:"draggable_zone",animation:150,filter:".undraggable",draggable:".draggable",handle:".my_handle",onEnd:function(t){var n=e.props,a=n.value,r=n.onChange,i=t.newIndex,l=t.oldIndex;if(i!==l){var o=a.filter((function(e){return"left"===e.fixed})),s=a.filter((function(e){return"right"===e.fixed})),c=(0,L.ZP)(a.filter((function(e){return!e.fixed})),(function(e){var t=e.splice(l,1)[0];e.splice(i,0,t)}));r&&r([].concat(o,c,s))}}})}))},n.componentWillUnmount=function(){window.removeEventListener("click",this._setShowFalse)},n.render=function(){var e=this,t=this.state,n=t.show,a=t.leftOpts,r=t.normalOpts,i=t.rightOpts,l=this.props,o=l.className,s=l.title;return c.createElement("div",{className:"yt_columns_selector_wrapper "+(o||""),onClick:this._handleParentClick},c.createElement("div",{className:"trigger "+(n?"sel":""),onClick:this._handleOnTriggerClick},s||"\u5217",c.createElement("i",{className:"icon-cem_arrow-launches",style:{transform:n?"rotate(-180deg)":""}})),c.createElement("div",{className:"options "+(n?"active":"")},a.length>0&&c.createElement(c.Fragment,null,c.createElement("div",{className:"opt_label"},"\u56fa\u5b9a\u5728\u5de6\u4fa7"),a.map((function(t){return e._renderOptionItem(t,!1,"\u4e0d\u56fa\u5b9a",e._handleOnCancelFixedClick,"\u56fa\u5b9a\u5728\u5217\u5c3e",e._handleOnFixedRightClick)}))),(a.length>0||i.length>0)&&c.createElement("div",{className:"opt_label"},"\u4e0d\u56fa\u5b9a"),c.createElement("div",{id:"draggable_zone",style:{visibility:r.length>0}},r.map((function(t){return e._renderOptionItem(t,!0,"\u56fa\u5b9a\u5728\u5217\u5934",e._handleOnFilxedLeftClick,"\u56fa\u5b9a\u5728\u5217\u5c3e",e._handleOnFixedRightClick)}))),i.length>0&&c.createElement(c.Fragment,null,c.createElement("div",{className:"opt_label"},"\u56fa\u5b9a\u5728\u53f3\u4fa7"),i.map((function(t){return e._renderOptionItem(t,!1,"\u4e0d\u56fa\u5b9a",e._handleOnCancelFixedClick,"\u56fa\u5b9a\u5728\u5217\u5934",e._handleOnFilxedLeftClick)})))))},t}(c.PureComponent);const k=x;x.propTypes={className:h().string,title:h().string,value:h().arrayOf(h().shape({label:h().string,prop:h().string,fixed:h().string,checked:h().bool})),onChange:h().func};var P,w,I=n(35239),z=["data","total","loading","savedKey","pageIndex","pageSize","onPageChange","onPageSizeChange","className"],T=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnResize=function(){var e=document.querySelector(".yt-listview-wrapper");e&&n.setState({tableWidth:e.clientWidth-5})},n._handleOnColumnsChange=function(e){n.setState({columns:e},(function(){n.props.savedKey&&function(e){return E.apply(this,arguments)}({projectId:I.t.get(I.V.curProject).id,key:n.props.savedKey,value:JSON.stringify(e.map((function(e){return{prop:e.prop,checked:e.checked,fixed:e.fixed}})))}).then((function(e){e.data}))}))},n.handleRoKey=function(e){var t=n.props.rowKeyProp;return t&&e&&e[t]?e[t]:JSON.stringify(e)},n.state={talbeWidth:0,columns:t.columns||[],loadingSave:!0},n}(0,l.Z)(t,e),t.getDerivedStateFromProps=function(e,t){};var n=t.prototype;return n.componentDidMount=function(){var e=this;window.addEventListener("resize",s()(this._handleOnResize,150)),this._handleOnResize();var t=this.props,n=t.savedKey,a=t.columns;n&&function(e){return _.apply(this,arguments)}({projectId:I.t.get(I.V.curProject).id,key:n}).then((function(t){var n,i=t.data;if(2e4===i.code)try{n=a.map((function(e,t){var n=JSON.parse(i.result).filter((function(t){var n=t.prop;return e.prop===n}));return n&&n.length>0?(0,r.Z)({},e,n[0]):e})).filter((function(e){return e}))}catch(l){}finally{e.setState({columns:n||e.state.columns,loadingSave:!1})}}))},n.componentWillUnmount=function(){window.removeEventListener("resize",this._handleOnResize)},n.componentDidUpdate=function(e,t){var n=this;JSON.stringify(e.columns)!==JSON.stringify(this.props.columns)&&this.props.columns.length>0&&this.setState({columns:this.props.columns.reduce((function(e,t,a){var i=n.state.columns.findIndex((function(e){var n=e.prop;return t.prop===n}));return e.splice(i>-1?i:a,0,(0,r.Z)({},t,n.state.columns[i])),e}),[]).filter((function(e){return e}))})},n.render=function(){var e=this.props,t=e.data,n=e.total,i=void 0===n?0:n,l=e.loading,o=e.savedKey,s=e.pageIndex,p=e.pageSize,d=e.onPageChange,h=e.onPageSizeChange,m=e.className,v=void 0===m?"":m,y=(0,a.Z)(e,z),C=this.state,S=C.columns,_=C.loadingSave;return c.createElement(f.Z,{data:t,className:"yt-listview-wrapper "+v,loading:o&&_||l},(0,f.P)(t)&&c.createElement(c.Fragment,null,c.createElement(u.Table,(0,r.Z)({},y,{columns:o?this.columns:this.props.columns,data:t,rowKey:this.handleRoKey})),d&&c.createElement(g,{onPageChange:d,onSizeChange:h,total:i,currLength:t.length,pageIndex:s,pageSize:p}),o&&c.createElement(k,{className:"column_selector",value:S,savedKey:o,onChange:this._handleOnColumnsChange})))},(0,i.Z)(t,[{key:"columns",get:function(){var e=this.state,t=e.tableWidth,n=e.columns,a=this.props,r=a.columnRenders,i=void 0===r?{}:r,l=a.headerRenders,o=void 0===l?{}:l,s=a.prefixColumns,c=0,u=0,p=0,d=[].concat(void 0===s?[]:s,JSON.parse(JSON.stringify(n.filter((function(e){var t=e.checked;return void 0===t||t})))));if(d.forEach((function(e){p+=e.width,e.fixed?c+=e.width:u+=e.width;var t=i[e.prop];t&&(e.render=t);var n=o[e.prop];n&&(e.renderHeader=n)})),t>p){var h=t-c;d.forEach((function(e){void 0!==e.checked&&!e.checked||e.fixed||(e.width=e.width/u*h)}))}return d}}]),t}(c.PureComponent);T.propTypes={className:h().string,savedKey:h().string.isRequired,rowKeyProp:h().string,data:h().any.isRequired,total:h().number,fixedHeight:h().bool,loading:h().bool,pageIndex:h().number,pageSize:h().number,onPageChange:h().func,onPageSizeChange:h().func,columnRenders:h().shape((P={},P[h().string]=h().func,P)),headerRenders:h().shape((w={},w[h().string]=h().func,w)),prefixColumns:h().arrayOf(h().shape({label:h().string,prop:h().string,fixed:h().oneOf(["","left","right"]),width:h().number,checked:h().bool})),columns:h().arrayOf(h().shape({label:h().string,prop:h().string,fixed:h().oneOf(["","left","right"]),width:h().number,checked:h().bool})).isRequired};const q=T}}]);