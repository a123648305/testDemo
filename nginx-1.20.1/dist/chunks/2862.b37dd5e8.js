"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[2862],{52862:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P});var a=n(63366),r=n(87462),o=n(94578),l=n(67294),s=(n(15267),n(64713)),i=(n(89858),n(51024)),c=(n(6373),n(82891)),u=(n(54214),n(12386)),m=(n(53294),n(56697)),p=(n(1025),n(65400)),d=(n(15086),n(94055)),h=(n(35797),n(64749)),f=n(61409),g=n(40847),y=n(57254),v=n(96889),k=n(53754),S=n(45697),E=n.n(S),b=n(94184),I=n.n(b),w=function(e){function t(t){var n;return(n=e.call(this,t)||this).togglePanel=function(e){var t=n.state.panelShow;t&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()),setTimeout((function(){return n.setState({panelShow:!t})}),0)},n.handleCancel=function(){n.setState({panelShow:!1})},n.state={title:t.title||"",options:t.options||[],activeKey:t.defaultActivekey||"",panelShow:!1},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){window.addEventListener("click",this.handleCancel)},t.getDerivedStateFromProps=function(e,t){var n=e.title,a=e.options,r=e.defaultActivekey;return r!==t.defaultActivekey?{title:n,activeKey:r||""}:JSON.stringify(a)!==JSON.stringify(t.options)?{options:a||[],activeKey:r||""}:null},n.componentWillUnmount=function(){window.removeEventListener("click",this.handleCancel)},n.handleCheckOne=function(e){var t=this;setTimeout((function(){t.setState({activeKey:e,panelShow:!1})}),300),this.props.onChange(e)},n.render=function(){var e=this,t=this.state,n=t.title,a=t.options,r=t.panelShow,o=t.activeKey,s=I()({"multi-select-wrapper":!0,whiteBg:!1,sel:r});return l.createElement("div",{className:s,style:{backgroundColor:r?"rgb(97,121,155)":""},onClick:this.togglePanel},l.createElement("span",null,n&&n+"\uff1a"),l.createElement("span",{className:"currValue"}," ",o&&a.filter((function(e){return e.key===o}))[0].val),l.createElement("i",{className:"icon-cem_arrow-launches",style:{transform:r?"rotate(-180deg)":"",top:r?"-2px":"3px"}}),l.createElement("div",{className:"multi-select-panel",style:{display:r?"block":"none"},onClick:function(e){return e.stopPropagation()}},l.createElement("ul",{className:"multi-select-panel-body"},l.createElement(l.Fragment,null,a.map((function(t){return l.createElement("li",{key:t.key,onClick:function(){return e.handleCheckOne(t.key)},style:{minHeight:"36px",color:t.key===o?"#7262FD":"",backgroundColor:t.key===o?"f7f8fa":""}},l.createElement("label",{title:t.val},t.val))}))))))},t}(l.Component);w.propTypes={title:E().string.isRequired,options:E().arrayOf(E().shape({key:E().oneOfType([E().string,E().number]),val:E().string})),defaultActivekey:E().string,onChange:E().func.isRequired};var Y=n(30381),N=n.n(Y),_=function(e){return e?Number(e).toLocaleString():0},C=function(e){if(!e||"-"===e)return"--";var t=new Date;t.setTime(e);var n=t.getFullYear(),a=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,r=t.getDate()<10?"0"+t.getDate():t.getDate(),o=t.getHours()<10?"0"+t.getHours():t.getHours(),l=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes();t.getSeconds(),t.getSeconds();return(new Date).getFullYear()===n?a+"/"+r+"      "+o+":"+l:n+"/"+a+"/"+r+"     "+o+":"+l},D=[{label:"\u5168\u90e8",value:""},{label:"\u9884\u552e",value:"PRE_SALE"},{label:"\u5728\u552e",value:"ON_LINE"},{label:"\u4e0b\u67b6",value:"OFF_LINE"}],T=[{key:"noTimeLimit",val:"\u65f6\u95f4\u4e0d\u9650"},{key:"yesterday",val:"\u8fd11\u5929"},{key:"lastThreeDays",val:"\u8fd13\u5929"},{key:"lastSevenDays",val:"\u8fd17\u5929"},{key:"nearly30Days",val:"\u8fd130\u5929"}],M={noTimeLimit:{to:"",from:""},yesterday:{from:N()().subtract(1,"days").format("YYYY-MM-DD HH:mm:ss"),to:N()().format("YYYY-MM-DD HH:mm:ss")},lastThreeDays:{from:N()().subtract(3,"days").format("YYYY-MM-DD HH:mm:ss"),to:N()().format("YYYY-MM-DD HH:mm:ss")},lastSevenDays:{from:N()().subtract(7,"days").format("YYYY-MM-DD HH:mm:ss"),to:N()().format("YYYY-MM-DD HH:mm:ss")},nearly30Days:{from:N()().subtract(30,"days").format("YYYY-MM-DD HH:mm:ss"),to:N()().format("YYYY-MM-DD HH:mm:ss")},last3Months:{from:N()().subtract(3,"months").format("YYYY-MM-DD HH:mm:ss"),to:N()().format("YYYY-MM-DD HH:mm:ss")},last6Months:{from:N()().subtract(6,"months").format("YYYY-MM-DD HH:mm:ss"),to:N()().format("YYYY-MM-DD HH:mm:ss")},nearlyOneYear:{from:N()().subtract(12,"months").format("YYYY-MM-DD HH:mm:ss"),to:N()().format("YYYY-MM-DD HH:mm:ss")}},O=n(97753);h.default.Option;const x=function(e){var t=e.dataList,n=e.total,a=e.pageIndex,r=e.loading,o=e.location,h=e.ruleOpts,S=e.ruleNumbers,E=e.onFilterChange,b=e.ruleNameObj,I=e.activekeyType,Y=e.maintainParams,N=e.onSearchType,x=e.selectedRowKeys,L=e.onSelectedRowKeys,H=e.onIgnoreBath,A=e.onIgnoreAll,B=e.salesStatus,R=e.onSalesStatus,K=e.onChangeTimer,F=e.onExportBath,P=e.countData,Z=e.searchTitleWord,j=e.onChangeSearchTitleWord,W=e.dateFilter,U=[{title:"\u6807\u9898",dataIndex:"name",width:"35%",align:"left",render:function(e,t){var n=t.imgUrl,a=t.urlTopics,r=t.realId;return l.createElement("div",{className:"current-row_name"},l.createElement("img",{src:n&&n.length>0?n[0]:O}),l.createElement("div",null,l.createElement("a",{href:t.url,target:"_blank",rel:"noopener noreferrer"},e),l.createElement("p",{className:"current-row_name_topic"},a?Object.values(JSON.parse(a)).join(" "):""),l.createElement("p",{className:"current-row_name_ID"},"ID: "+r)))}},{title:"\u53d1\u73b0\u65f6\u95f4",dataIndex:"discoveryTime",width:"100px",align:"left",render:function(e){return C(e)}},{title:l.createElement("span",null,"\u8ba2\u9605\u65f6\u95f4",l.createElement(d.default,{overlayClassName:"updater_hover_style",overlay:"\u94fe\u63a5\u901a\u8fc7\u8ba2\u9605\u89c4\u5219\u8ba2\u9605\u5230\u7684\u6700\u65e9\u65f6\u95f4"},l.createElement("i",{className:"icon-cem_file1 price_tip",style:{marginLeft:4}}))),dataIndex:"subscribeTime",width:"100px",align:"center",render:function(e){return C(e)}},{title:"\u9500\u552e\u72b6\u6001",dataIndex:"salesStatus",width:"120px",render:function(e,t){return l.createElement("div",null,l.createElement("div",{className:"salesStatus_front"},e),l.createElement("div",{className:"update_front"},function(e){if(!e)return"--";var t=1e3*(Date.parse(new Date)/1e3-parseInt(e)/1e3),n=Math.floor(t/864e5),a=t%864e5,r=Math.floor(a/36e5),o=a%36e5,l=Math.floor(o/6e4),s=o%6e4,i=Math.round(s/1e3);return n>0?n+"\u5929\u524d\u66f4\u65b0":r>0?" "+r+"\u5c0f\u65f6\u524d\u66f4\u65b0":l>0?l+" \u5206\u949f \u524d\u66f4\u65b0":i>0?i+" \u524d\u66f4\u65b0":void 0}(t.salesStatusTime)))}},{title:"\u8ba2\u9605\u72b6\u6001",dataIndex:"status",align:"center",width:"120px",render:function(e){switch(e){case"INIT":return"\u65b0\u53d1\u73b0";case"ADD":return"\u5df2\u6dfb\u52a0";case"IGNORE":return"\u5df2\u5ffd\u7565"}}},{title:"\u64cd\u4f5c",width:"164px",key:"option",align:"center",valueType:"option",render:function(t,n){return l.createElement("div",null,("INIT"===n.status||"IGNORE"===n.status)&&l.createElement(p.default,{key:"link3",type:"primary",ghost:!0,onClick:function(){return function(e,t,n){var a=b&&b.ruleName||o.state.title||void 0;f.mW.push({pathname:"/account/project/"+o.pathname.split("/")[3]+"/subscribe/linkMaintenance",state:{maintainParams:{id:e,status:t,esId:n,params:Y.params},title:"\u6dfb\u52a0\u94fe\u63a5",ruleNameObj:{ruleName:a,url:"/account/project/"+o.pathname.split("/")[3]+"/subscribe/link",state:{title:a}}}})}(n.spu,n.status,n.esId)},className:"btn_color"}," ","\u6dfb\u52a0"," "),"INIT"===n.status&&l.createElement("a",{key:"link2",onClick:function(){return e.onIgnore(n)}},"\u5ffd\u7565"))}}],J=function(e){switch(e){case"downBatch":z("\u672c\u6b21\u64cd\u4f5c\u5bfc\u51fa"+x.length+"\u6761\u94fe\u63a5\u3002",e);break;case"downAllBatch":z(n>=2e4?"\u6700\u591a\u5bfc\u51fa20000\u6761\u94fe\u63a5\uff0c\u672c\u6b21\u64cd\u4f5c\u5bfc\u51fa20000\u6761\u3002":"\u672c\u6b21\u64cd\u4f5c\u5bfc\u51fa"+n+"\u6761\u94fe\u63a5\u3002",e);break;case"ignoreBatch":z("\u672c\u6b21\u64cd\u4f5c\u5ffd\u7565"+x.length+"\u6761\u94fe\u63a5\u3002",e);break;case"ignoreAllBatch":z("\u672c\u6b21\u64cd\u4f5c\u5ffd\u7565"+n+"\u6761\u94fe\u63a5\u3002",e)}},z=function(e,t){m.Z.confirm({title:"\u63d0\u793a",icon:l.createElement(g.Z,null),className:"fuzhi_tixing",content:""+e,onOk:function(){return function(e){switch(e){case"downBatch":return F(x);case"downAllBatch":return F();case"ignoreBatch":return H(x);case"ignoreAllBatch":return A()}}(t).then((function(e){})).catch((function(){return console.log("Oops errors!")}))},onCancel:function(){}})},V=l.createElement(u.default,null,l.createElement(u.default.Item,{key:"downBatch",disabled:x.length<=0,onClick:function(){return J("downBatch")}},"\u5bfc\u51fa\u9009\u4e2d\u94fe\u63a5"),l.createElement(u.default.Item,{key:"downAllBatch",disabled:x.length>0,onClick:function(){return J("downAllBatch")}},"\u5bfc\u51fa\u5168\u90e8\u94fe\u63a5")),G=l.createElement(u.default,null,l.createElement(u.default.Item,{key:"ignoreBatch",disabled:x.length<=0,onClick:function(){return J("ignoreBatch")}},"\u5ffd\u7565\u9009\u4e2d\u94fe\u63a5"),l.createElement(u.default.Item,{key:"ignoreAllBatch",disabled:x.length>0,onClick:function(){return J("ignoreAllBatch")}},"\u5ffd\u7565\u5168\u90e8\u94fe\u63a5")),q={selectedRowKeys:x,onChange:function(e){L(e)},fixed:!0};return l.createElement("div",{className:"yt_subscribe_link_wrapper"},l.createElement("div",{className:"yt_subscribe_link_toolbar"},l.createElement(u.default,{mode:"horizontal",onClick:function(e){N(e.key)},selectedKeys:[I]},l.createElement(u.default.Item,{key:"totalHis"},l.createElement("span",{style:{marginRight:"6px"}},"\u5168\u90e8\u94fe\u63a5"),_(P.totalHis)),l.createElement(u.default.Item,{key:"countUpcoming"},l.createElement("span",{style:{marginRight:"6px"}},"\u65b0\u53d1\u73b0"),_(P.countUpcoming)),l.createElement(u.default.Item,{key:"totalAdd"},l.createElement("span",{style:{marginRight:"6px"}},"\u5df2\u6dfb\u52a0"),_(P.totalAdd)),l.createElement(u.default.Item,{key:"totalIgnore"},l.createElement("span",{style:{marginRight:"6px"}},"\u5df2\u5ffd\u7565"),_(P.totalIgnore))),l.createElement("span",{className:"yt_subscribe_link_dropdown"},l.createElement(c.default,{overlay:V,disabled:t&&0===t.length},l.createElement(p.default,null,"\u5bfc\u51fa ",l.createElement(y.Z,null))),"countUpcoming"===I&&l.createElement(c.default,{overlay:G,className:"add",disabled:t&&0===t.length},l.createElement(p.default,null,"\u6279\u91cf\u5ffd\u7565 ",l.createElement(y.Z,null))))),l.createElement("div",{className:"yt_subscribe_link_header"},l.createElement(i.default,{placeholder:"\u8f93\u5165\u5546\u54c1\u6807\u9898",allowClear:!0,suffix:l.createElement("i",{className:"icon-cem_small-search",onClick:function(){return e.onSearch({searchTitleWord:Z,pageIndex:1})}}),onPressEnter:function(){return e.onSearch({searchTitleWord:Z,pageIndex:1})},onChange:function(t){j(t.target.value),""===t.target.value&&e.onSearch({pageIndex:1})},value:Z,size:"small"}),b?l.createElement("div",{className:"multi-select-wrapper",style:{background:"#fff",cursor:"default",display:"none"}},l.createElement("span",{style:{marginRight:"5px"}},"\u8ba2\u9605\u89c4\u5219\uff1a"),l.createElement("span",null,b.ruleName)):l.createElement(k.Z,{title:"\u8ba2\u9605\u89c4\u5219",options:h,value:S,onChange:function(e){E({ruleNumbers:e})}}),l.createElement(s.default.Group,{options:D,onChange:function(e){R(e.target.value)},value:B,optionType:"button"}),l.createElement("div",{className:"select_options"},l.createElement(w,{title:"\u8ba2\u9605\u65f6\u95f4",options:T,onChange:function(e){!function(e){var t=M[e];(t="noTimeLimit"===e?{to:"",from:""}:{to:new Date(t.to).getTime(),from:new Date(t.from).getTime()}).activeValueTime=e,K(t)}(e)},defaultActivekey:W&&W.activeValueTime}))),l.createElement(v.ZP,{loading:r,columns:U,dataSource:t,rowKey:"id",pagination:{defaultPageSize:"10",total:n,current:a,onChange:e.onPageChange},scroll:{y:.6*document.body.clientHeight+"px"},search:!1,dateFormatter:"string",options:!1,rowSelection:q,tableAlertRender:!1}))};var L=n(55609),H=n(64396),A=n(35239),B=["loading"],R=H.Z.product.comment.subscribeLink,K=H.Z.IDBHeaderScreening.timeScreening,F=function(e){function t(t){var n;(n=e.call(this,t)||this)._handleOnPageChange=function(e,t){var a=n.props,r=a.save,o=a.fetchLinkList;r({pageIndex:e,pageSize:t}),o()},n._handleOnSalesStatus=function(e){sessionStorage.setItem("salesStatus",e);var t=n.props,a=t.save,r=t.fetchLinkList;a({salesStatus:e,pageIndex:1}),r()},n._handleChangeTimer=function(e){sessionStorage.setItem("dateFilter",JSON.stringify(e));var t=n.props,a=t.save,r=t.fetchLinkList;a({dateFilter:e,pageIndex:1}),r()},n._handleOnIgnore=function(e){return n.props.fetchIgnore({selectedRowKeys:[e.id],isAll:!1})},n._handleExportBath=function(e){return void 0===e&&(e=[]),n.props.fetchLinkExport({selectedRowKeys:e,downloadNumber:e.length>0?e.length:n.props.total})},n._handleOnIgnoreBath=function(e){return n.props.fetchIgnore({selectedRowKeys:e,isAll:!1})},n._handleOnIgnoreAll=function(){return n.props.fetchIgnore({isAll:!0})},n._handleOnSearch=function(e){n.props.fetchLinkList(e)},n._handleOnSearchType=function(e){sessionStorage.setItem("activekeyType",e),n.props.save({activekeyType:e,pageIndex:1}),n.props.fetchLinkList(n.props.activeKeys[e])},n._selectedRowKeys=function(e){n.props.save({selectedRowKeys:e})},n._changeSearchTitleWord=function(e){n.props.save({searchTitleWord:e})},n._handleOnFilterChange=function(e){sessionStorage.setItem("ruleNumbers",JSON.stringify(e.ruleNumbers)),n.props.save((0,r.Z)({},e)),n.props.fetchLinkList((0,r.Z)({},e,{pageIndex:1}))},n.state={},n.event={onPageChange:n._handleOnPageChange,onIgnore:n._handleOnIgnore,onSearch:n._handleOnSearch,onSearchType:n._handleOnSearchType,onFilterChange:n._handleOnFilterChange,onSelectedRowKeys:n._selectedRowKeys,onIgnoreBath:n._handleOnIgnoreBath,onIgnoreAll:n._handleOnIgnoreAll,onSalesStatus:n._handleOnSalesStatus,onChangeTimer:n._handleChangeTimer,onExportBath:n._handleExportBath,onChangeSearchTitleWord:n._changeSearchTitleWord};var a=t.location.state,o=sessionStorage.getItem("ruleNumbers")&&[sessionStorage.getItem("ruleNumbers")],l=sessionStorage.getItem("activekeyType")&&n.props.activeKeys[sessionStorage.getItem("activekeyType")].status;return t.save({connectionType:t.location.pathname.includes("/price")?"PRICE":"DEFAULT",projectId:A.t.get(A.V.backProjectConfig).id,state:a,ruleNameObj:t.ruleNameObj||a&&a.ruleNameObj,ruleNumbers:o||t.ruleNumbers||a&&a.ruleNameObj&&a.ruleNameObj.ruleNumbers,activekeyType:sessionStorage.getItem("activekeyType")||t.activekeyType||t.location.state.params||"totalHis",salesStatus:sessionStorage.getItem("salesStatus")||"",dateFilter:JSON.parse(sessionStorage.getItem("dateFilter"))||{activeValueTime:"noTimeLimit"},status:l||t.status||(t.location.state.params?t.activeKeys[t.location.state.params].status:[])||[]}),n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.fetchLinkList(),this.props.fetchRuleList(),this.props.fetchSubscribeCount()},n.componentWillUnmount=function(){window.location.pathname&&window.location.pathname.indexOf("linkMaintenance")<0&&(sessionStorage.removeItem("activekeyType"),sessionStorage.removeItem("salesStatus"),sessionStorage.removeItem("ruleNumbers"),sessionStorage.removeItem("dateFilter")),this.props.clean()},n.render=function(){return l.createElement(x,(0,r.Z)({},this.props,this.state,this.event))},t}(l.PureComponent);const P=(0,L.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,B);return(0,r.Z)({},n[R],{loading:t.effects[R+"/fetchLinkList"]||!1,staredQuickTimeChoice:n[K].staredQuickTimeChoice})}),(function(e){return{save:function(t){return e({type:R+"/save",payload:t})},clean:function(t){return e({type:R+"/clean",payload:t})},timerInit:function(t){return e({type:K+"/init",payload:t})},changeShow:function(t){return e({type:R+"/changeShow",payload:t})},fetchLinkList:function(t){return e({type:R+"/fetchLinkList",payload:t})},fetchIgnoreSingle:function(t){return e({type:R+"/fetchIgnoreSingle",payload:t})},fetchRuleList:function(t){return e({type:R+"/fetchRuleList",payload:t})},fetchIgnore:function(t){return e({type:R+"/fetchIgnore",payload:t})},fetchLinkExport:function(t){return e({type:R+"/fetchLinkExport",payload:t})},fetchSubscribeCount:function(t){return e({type:R+"/fetchSubscribeCount",payload:t})}}}))(F)},97753:(e,t,n)=>{e.exports=n.p+"img/910a95789a4767e8719c.png"}}]);