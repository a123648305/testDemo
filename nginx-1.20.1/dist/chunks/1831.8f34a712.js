"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[1831],{51831:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var i=n(87462),r=n(97326),a=n(94578),o=n(50361),s=n.n(o),c=n(67294),d=(n(89858),n(51024)),l=n(96889),u=n(30381),h=n.n(u),f=n(32624),p=n(61193);const g=function(e){var t=e.dataList,n=e.handlekeyword,i=e.loading,r=e.pagination,a=e.stateList,o=e.getPagination,s=e.onFresh,u=(0,c.useState)(void 0),g=u[0],m=u[1],y=(0,c.useState)(!1),k=y[0],v=y[1],_=(0,c.useState)(""),w=_[0],I=_[1],E=(0,c.useState)(null),S=E[0],x=E[1],L=(0,c.useState)(0),b=L[0],R=L[1];(0,c.useEffect)((function(){R(document.body.offsetHeight-400)}),[]);var C=function(e,t){I(e),x(t),v(!0)},F=[{title:"\u7f16\u53f7",dataIndex:"code",key:"code",width:"100px",render:function(e,t){return c.createElement("span",{className:"title_key",style:{color:"#1890FF",cursor:"pointer"},onClick:function(){return C("view",t)}},e)}},{title:"\u6807\u9898",dataIndex:"title",key:"title",width:"600px",render:function(e,t){return c.createElement("span",{className:"title_key",style:{color:"#1890FF",cursor:"pointer"},onClick:function(){return C("view",t)}},e)}},{title:"\u5220\u9664\u4eba",dataIndex:"deleter",key:"deleter",width:"150px"},{title:"\u5220\u9664\u65f6\u95f4",dataIndex:"deleteAt",key:"deleteAt",render:function(e){return"-"!==e?h()(e).format("YYYY/MM/DD HH:mm"):"--"},width:"150px"}].concat(p.Z.hasAuthority("REDUCTION_WORK_ORDER")?[{title:"\u64cd\u4f5c",key:"action",width:"80px",render:function(e,t){return c.createElement("span",{style:{color:"#1890FF",cursor:"pointer"},onClick:function(){return C("recover",t)}},"\u6062\u590d")}}]:[]);return c.createElement(c.Fragment,null,c.createElement("div",{className:"board_list"},c.createElement("div",{className:"board_list_header"},c.createElement("p",null,"\u56de\u6536\u7ad9")),c.createElement("div",{className:"board_list_content"},c.createElement("div",{className:"board_list_content_screen"},c.createElement(d.default,{placeholder:"\u8bf7\u8f93\u5165",value:g,onChange:function(e){m(e.target.value)},suffix:c.createElement("i",{className:"icon-cem_small-search",onClick:function(){n(g)}}),onPressEnter:function(){n(g)},style:{width:"160px",height:"28px"}})),c.createElement(l.ZP,{columns:F,search:!1,options:!1,rowKey:function(e){return e.id},dataSource:t,pagination:r,loading:i,onChange:function(e){o(e)},className:"pro_table",scroll:{y:b}}))),c.createElement(f.Z,{visible:k,editType:w,isRecover:{isView:p.Z.hasAuthority("EDIT_WORK_ORDER")||(null==S?void 0:S.assigneeId)===p.Z.getUser().userId||(null==S?void 0:S.creatorId)===p.Z.getUser().userId},workOrderId:null==S?void 0:S.id,stateList:a,setVisible:function(e,t){v(e),x(null),t&&s()}}))};var m=n(35239),y=n(49722);var k=n(6406);const v=function(e){function t(t){var n;return(n=e.call(this,t)||this).events=void 0,n.state={projectId:m.t.get(m.V.curProject).id,dataList:[],loading:!1,keyword:"",pagination:{current:1,pageSize:10,total:0,showSizeChanger:!0,size:"small"},stateList:[]},n.events={handlekeyword:n._getkeyword.bind((0,r.Z)(n)),getPagination:n._getPagination.bind((0,r.Z)(n)),onFresh:n._handleFresh.bind((0,r.Z)(n))},n}(0,a.Z)(t,e);var n=t.prototype;return n._getkeyword=function(e){var t=this,n=this.state.pagination,i=s()(n);i.current=1,this.setState({keyword:e,pagination:i}),setTimeout((function(){t._fetchWorkOrderRecycledList()}),200)},n._fetchWorkOrderRecycledList=function(){var e=this,t=this.state,n=t.projectId,i=t.pagination,r=t.keyword,a=void 0===r?"":r,o=s()(i);this.setState({loading:!0}),function(e){var t=e.keyword,n=e.projectId,i=e.pageIndex,r=e.pageSize;return y.h.get("/workorder/work-order/recycled/list?keyword="+t+"&projectId="+n+"&pageIndex="+i+"&pageSize="+r)}({projectId:n,pageIndex:i.current,pageSize:i.pageSize,keyword:a}).then((function(t){if(2e4===t.data.code){var n=t.data.result.list;o.total=t.data.result.total,e.setState({dataList:n,pagination:o})}})).finally((function(){e.setState({loading:!1})}))},n._getPagination=function(e){var t=this;this.setState({pagination:e}),setTimeout((function(){t._fetchWorkOrderRecycledList()}),200)},n._fetchStatusList=function(){var e=this,t=this.state.projectId;(0,k.PH)({projectId:t}).then((function(t){2e4===t.data.code&&e.setState({stateList:t.data.result})})).catch((function(e){return console.error(e)}))},n._handleFresh=function(){this._fetchWorkOrderRecycledList()},n.componentDidMount=function(){this._fetchWorkOrderRecycledList(),this._fetchStatusList()},n.componentWillUnmount=function(){},n.render=function(){return c.createElement(g,(0,i.Z)({},this.props,this.state,this.events))},t}(c.Component)}}]);