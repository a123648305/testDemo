"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[2659],{42659:(e,t,n)=>{n.r(t),n.d(t,{default:()=>g});var a=n(94578),s=n(67294),i=n(5133),c=n(29383),r=n(92360),l=n(49722),o=n(55815),u=n(88308),m=n(45697),h=n.n(m),d={placeholder:h().string,value:h().string,disabled:h().bool,customItem:h().func,fetchSuggestion:h().func,popperClass:h().string,triggerOnFocus:h().bool,onSelect:h().func,searchBtnClass:h().string,customLabel:h().func,delLabel:h().func,searchClick:h().func},p={placeholder:"",value:"",disabled:!1,triggerOnFocus:!0,searchBtnValue:"\u6dfb\u52a0",delLabel:function(e){},searchClick:function(e,t){},onSelect:function(e){}},f=function(e){function t(t){var n;(n=e.call(this,t)||this).checkHide=function(e){var t=n.state.suggestionShow,a=e.target||window.event.srcElement;!t||n.closest(a,".search-input")||n.closest(a,".auto-suggestion-list")||n.suggestionsHide()};var a=n.props.value;return n.state={value:a,suggestionShow:!1,data:[]},n}(0,a.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){document.body.addEventListener("click",this.checkHide,!1),this.resetData()},n.componentWillUnmount=function(){document.body.addEventListener("click",this.checkHide,!1)},n.resetData=function(){var e=this.props.fetchSuggestion,t=document.querySelector(".search-input").value,n=e(t);this.setState({value:t,data:n})},n.focus=function(){var e=this.props.triggerOnFocus;this.state.data;e&&this.setState({suggestionShow:!0})},n.closest=function(e,t){for(var n=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector;e&&!n.call(e,t);)e=e.parentElement;return e},n.suggestionsHide=function(){this.setState({suggestionShow:!1})},n.search=function(){var e=this.state.data,t=this.props;(0,t.searchClick)(e,t.seclectData)},n.fetchSearch=function(){var e=this.state.value;return(0,this.props.fetchFunc)(e)},n.selectSuggestion=function(e){(0,this.props.onSelect)(e),this.setState({suggestionShow:!1})},n.delLabel=function(e){var t=this.props.delLabel;t(e)},n.render=function(){var e=this,t=this.props,n=t.placeholder,a=t.customItem,i=t.popperClass,c=t.seclectData,r=t.searchBtnValue,l=t.disabled,o=t.customLabel,u=t.labelClass,m=this.state,h=m.value,d=m.suggestionShow,p=m.data,f=u?"seclect-label-wrap "+u:"seclect-label-wrap",v=i?"auto-suggestion-list "+i:"auto-suggestion-list";return s.createElement("div",{className:"auto-seatch-wrap"},s.createElement("div",{className:"content"},s.createElement("div",{className:"main-cont"},s.createElement("ul",{className:"select-labels"},null==c?void 0:c.map((function(t){return s.createElement("li",{className:f,key:t.id},s.createElement("span",{className:"seclect-label"},o(t)),s.createElement("i",{className:"icon-cem_delete",onClick:e.delLabel.bind(e,t)}))}))),s.createElement("div",{className:"search-input-cont"},s.createElement("input",{className:"search-input",type:"text",disabled:l,value:h,placeholder:n,onFocus:this.focus.bind(this),onChange:this.resetData.bind(this)}))),s.createElement("span",{className:"search-btn",onClick:this.search.bind(this)},r instanceof Function?r():r)),d&&p.length>0&&s.createElement("ul",{className:v},p.map((function(t){return s.createElement("li",{className:"auto-suggestion-item",onClick:e.selectSuggestion.bind(e,t),key:t.id},a(t))}))))},t}(s.Component);f.propTypes=d,f.defaultProps=p;const v=f;var g=function(e){function t(t){var a,i=(a=e.call(this,t)||this).props.location.state.id;return a.state={name:"",isEdit:!1,id:i,outUsers:[],curOutUsers:[],inUsers:[],seclectData:[],columns:[{label:"\u7528\u6237",prop:"user",render:function(e,t,a){return s.createElement("div",{className:"user-info"},s.createElement("img",{className:"user-pic",src:e.userHeadUrl||n(7732)}),s.createElement("span",{className:"user-name"},e.username),s.createElement("span",{className:"user-email"},e.email))}},{label:"\u64cd\u4f5c",prop:"operation",width:200,render:function(e,t,n){return s.createElement("div",{className:"operation suggestion-del operation_columns",onClick:function(){return a.contentConfirm(e)}},"\u79fb\u51fa")}}]},a}(0,a.Z)(t,e);var m=t.prototype;return m.componentDidMount=function(){this.resetTeam()},m.resetTeam=function(){var e=this,t=this.state.id;l.h.post("/team/user/list",{id:t}).then((function(t){var n=t.data.result,a=n.outUsers,s=n.inUsers,i=n.name;e.setState({outUsers:a,curOutUsers:a,inUsers:s,name:i}),e.autosearch.resetData()}))},m.closeInput=function(e){var t=this,n=this.state.id;l.h.post("/team/update",{id:n,name:e}).then((function(n){i.Z.success("\u4fee\u6539\u6210\u529f"),t.setState({name:e})})).catch((function(e){t.resetTeam()}))},m.customLabel=function(e){return e.username},m.customItem=function(e){return s.createElement("div",{className:"user-info"},s.createElement("div",{className:"user-pic"},s.createElement("img",{src:e.userHeadUrl||n(7732)})),s.createElement("span",{className:"user-name"},e.username),s.createElement("span",{className:"user-email"},e.email))},m.fetchSuggestion=function(e){var t=this.state.curOutUsers,n=[];return t.forEach((function(t){var a=t.username.indexOf(e)>-1,s=t.email.indexOf(e)>-1;(a||s)&&n.push(t)})),n},m.search=function(e,t){var n=this;if(0!==t.length){var a=this.state,s=a.id,c=a.name,r=[];t.forEach((function(e){r.push(e.id)})),l.h.post("/team/user/add",{id:s,name:c,users:r}).then((function(e){i.Z.success("\u4fee\u6539\u6210\u529f"),n.resetTeam(),n.setState({seclectData:[]}),n.autosearch.suggestionsHide(),n.resetTeam()}))}},m.selectSuggestion=function(e){var t=this,n=this.state,a=n.curOutUsers,s=n.seclectData;a.forEach((function(n,i){if(n.id===e.id)return s.push(n),a.splice(i,1),t.setState({curOutUsers:a,seclectData:s}),t.autosearch.resetData(),!1}))},m.delLabel=function(e){var t=this,n=this.state,a=n.curOutUsers,s=n.seclectData;s.forEach((function(n,i){if(n.id===e.id)return a.push(n),s.splice(i,1),t.setState({curOutUsers:a,seclectData:s}),t.autosearch.resetData(),!1}))},m.contentConfirm=function(e){var t=this;r.MessageBox.confirm("\u786e\u8ba4\u4ece\u8be5\u56e2\u961f\u4e2d\u79fb\u51fa\u6b64\u7528\u6237?","\u63d0\u793a",{type:"warning"}).then((function(n){t.delSuggestion(e)}))},m.delSuggestion=function(e){var t=this,n=this.state.id;l.h.post("/team/user/remove",{id:n,users:[e.id]}).then((function(e){i.Z.success("\u64cd\u4f5c\u6210\u529f"),t.resetTeam()})).catch((function(e){console.error(e)}))},m.render=function(){var e=this,t=this.state,n=t.name,a=t.inUsers,i=t.seclectData,r=t.columns,l=document.documentElement.clientHeight-46-54-24,m=[{title:"\u56e2\u961f",url:"/account/team"},{title:n,url:""}];return s.createElement("div",{className:"flex-col"},s.createElement("div",{className:"flex-other container common-wrapper"},s.createElement(o.Z,{title:m}),s.createElement("div",{className:"common-padding-12"},s.createElement("div",{className:"main-container",style:{minHeight:l,backgroundColor:"#fff"}},s.createElement("div",{className:"team-name-cont"},s.createElement("span",{className:"team-name"},"\u56e2\u961f\u540d\u79f0"),s.createElement(u.Z,{id:"editTeam",value:n,name:"\u56e2\u961f\u540d\u79f0",confirm:this.closeInput.bind(this)})),s.createElement("div",{className:"member-wrap"},s.createElement("h4",{className:"section-title"},"\u7ba1\u7406\u6210\u5458"),s.createElement("div",{className:"search-member"},s.createElement(v,{ref:function(t){return e.autosearch=t},fetchSuggestion:this.fetchSuggestion.bind(this),delLabel:this.delLabel.bind(this),seclectData:i,onSelect:this.selectSuggestion.bind(this),customLabel:this.customLabel.bind(this),customItem:this.customItem.bind(this),searchClick:this.search.bind(this)}))),s.createElement("div",null,s.createElement(c.Z,{className:"edit-team-table",columns:r,data:a,start:1,end:a.length,total:a.length}))))))},t}(s.Component)},55815:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(94578),s=n(67294),i=n(45697),c=n.n(i),r=n(43036),l=n(61409),o=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props,a=n.title,s=n.beforeJump;e!==a.length-1&&(s?new Promise((function(e,t){return s(e,t)})).then((function(){l.mW.push({pathname:a[e].url,state:a[e].state})})):l.mW.push({pathname:a[e].url,state:a[e].state}))},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.mainTitle,i=t.rightContent,c=t.className,l=t.overlay;return s.createElement("div",{className:"breadcumb-wrapper "+c},n instanceof Array?s.createElement("div",{className:"breadcrumb-left"},s.createElement("div",null,n.map((function(t,a){return s.createElement("span",{className:t.url?"":"not_clickable",key:a,onClick:function(){return t.url&&a!==n.length-1&&e._handleBreadcrumbClick(a)}},t.title,a!==n.length-1&&" / ")}))),s.createElement("span",null,a||n[n.length-1].title,l&&s.createElement(r.Z,{placement:"top",overlay:l},s.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}})))):s.createElement("div",{className:"normal-title"},n,l&&s.createElement(r.Z,{placement:"top",overlay:l},s.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}}))),i||"")},t}(s.Component);o.propTypes={className:c().string,title:c().oneOfType([c().string,c().arrayOf(c().shape({title:c().string,url:c().string,state:c().object}))]).isRequired,overlay:c().oneOfType([c().string,c().node]),mainTitle:c().oneOfType([c().string,c().node]),beforeJump:c().func,rightContent:c().node};const u=o},88308:(e,t,n)=>{n.d(t,{Z:()=>p});var a=n(94578),s=n(67294),i=n(45697),c=n.n(i),r=n(5133),l=n(43036),o=n(94184),u=n.n(o),m={value:c().string,id:c().any.isRequired,enter:c().bool,blurFun:c().func,name:c().string,empty:c().bool,placeholder:c().string,type:c().string,confirmNoChange:c().func},h={value:"",enter:!0,name:"\u540d\u79f0",empty:!1,placeholder:"",cancel:function(e,t){},confirm:function(e,t){},type:"normal"},d=function(e){function t(t){var n;(n=e.call(this,t)||this).enter=function(e){n.props.enter&&13===e.keyCode&&n.confirmEdit()};var a=n.props.value;return n.state={isEdit:!1,curValue:a||"",lastVal:a||"",hover:!1,canEdit:!1},n}(0,a.Z)(t,e);var n=t.prototype;return n.UNSAFE_componentWillReceiveProps=function(e){var t=this;e.value!==this.state.lastVal&&e.value&&this.setState({curValue:e.value,lastVal:e.value}),!0!==e.canEdit||this.state.canEdit||this.setState({canEdit:!0},(function(e){t.toEdit()}))},n.componentDidMount=function(){var e=this;document.body.addEventListener("click",(function(t){var n=t.target||window.event.srcElement,a=e.props.className,s="edit-input-wrap";a&&(s=a.split(" ")[0]);(function(e,t){for(var n=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector;e&&!n.call(e,t);)e=e.parentElement;return e})(n,"."+s)||e.cancelEdit()}))},n.changeName=function(){var e=this.props.id,t=document.getElementById(e).value;this.setState({curValue:t})},n.toEdit=function(){var e=this.state,t=e.isEdit,n=(e.canEdit,this.props.id);t||this.setState({isEdit:!0,hover:!0},(function(e){var t=document.getElementById(n);setTimeout((function(){t.focus()}))}))},n.checkEdit=function(){"normal"===this.props.type&&this.toEdit()},n.cancelEdit=function(){var e=this.state,t=e.curValue,n=e.lastVal,a=e.isEdit,s=e.canEdit,i=this.props.cancel;a&&(s&&this.setState({canEdit:!1}),this.setState({isEdit:!1,hover:!1,curValue:n},(function(e){i&&i(t,n)})))},n.borderShow=function(){var e=this.state.hover;"normal"!==this.props.type||e||this.setState({hover:!0})},n.borderHide=function(){var e=this.state,t=e.hover,n=e.isEdit;"normal"===this.props.type&&t&&!n&&this.setState({hover:!1})},n.confirmEdit=function(){var e=this.state,t=e.curValue,n=e.lastVal,a=e.canEdit,s=this.props,i=s.confirm,c=s.id,l=s.name,o=s.empty,u=s.confirmNoChange,m=s.inputType,h=document.getElementById(c);""!==String(t).replace(/\s/g,"")||o||"remark"===m?(""===String(t).replace(/\s/g,"")&&o||"remark"==m?(this.setState({isEdit:!1,hover:!1,lastVal:t},(function(e){h.blur()})),i&&i(t,n)):n===t?this.setState({isEdit:!1,hover:!1},(function(e){h.blur()})):(this.setState({isEdit:!1,hover:!1,lastVal:t},(function(e){h.blur()})),i&&i(t,n)),a&&(u&&u(t),this.setState({canEdit:!1}))):(r.Z.warning(l+"\u4e0d\u80fd\u4e3a\u7a7a"),this.setState({curValue:n},(function(e){h.focus()})))},n.render=function(){var e=this.props,t=e.id,n=e.style,a=e.className,i=e.placeholder,c=this.state,r=c.isEdit,o=c.curValue,m=c.hover,h=u()(["edit-input-wrap",a]),d=u()(["edit-input-cont",{hover:m,"is-edit":r}]),p=u()(["edit-input",{disabled:!r}]);return s.createElement("div",{className:h,style:n},s.createElement("div",{className:d,onMouseEnter:this.borderShow.bind(this),onMouseLeave:this.borderHide.bind(this),onClick:this.checkEdit.bind(this)},s.createElement("input",{id:t,className:p,type:"text",value:o,title:o,placeholder:i,style:n,disabled:!r,onInput:this.changeName.bind(this),onKeyDown:this.enter.bind(this)}),m&&!r&&s.createElement(l.Z,{placement:"top",overlay:"\u7f16\u8f91"},s.createElement("div",{className:"btn-wrap",title:"\u7f16\u8f91"},s.createElement("i",{className:"name-edit edit-btn icon-cem_edit"}))),m&&r&&s.createElement("div",{className:"btn-wrap"},s.createElement(l.Z,{placement:"top",overlay:"\u53d6\u6d88"},s.createElement("i",{className:"cancel-edit edit-btn icon-cem_delete",onClick:this.cancelEdit.bind(this),title:"\u53d6\u6d88"})),s.createElement(l.Z,{placement:"top",overlay:"\u786e\u8ba4"},s.createElement("i",{className:"confirm-edit edit-btn icon-cem_check-out",onClick:this.confirmEdit.bind(this),title:"\u786e\u8ba4"})))))},t}(s.Component);d.propTypes=m,d.defaultProps=h;const p=d}}]);