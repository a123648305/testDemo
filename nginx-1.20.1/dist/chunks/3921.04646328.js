"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[3921,1438],{4333:(e,t,n)=>{n.r(t),n.d(t,{default:()=>W});var a=n(87462),r=n(43144),o=n(94578),i=n(67294),c=n(92360),l=n(5133),s=n(29383),u=n(49722),d=n(55815),p=n(1486),m=n(61193),f=n(61409),h=n(35239),g=n(45697),v=n.n(g),y=n(91438),E=n(80157),S=n(94184),k=n.n(S),C=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).getParams=function(){var e=t.refs.filter?{filterModel:t.refs.filter.getParams()}:{filterModel:{}};return t.refs.time&&(e.dateFilter=t.refs.time.getParams()),e},t.getAspect=function(){var e=t.props.filter;return e&&e.show&&e.aspect?t.refs.filter.getAspect():null},t.setAspectType=function(){var e,n=t.props.filter;return n&&n.show&&n.aspect&&(e=t.refs.filter).changeAspectType.apply(e,arguments)},t}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.refs.filter||this.props.confirm&&this.props.confirm()},n.render=function(){var e=this.props,t=e.title,n=e.time,r=e.filter,o=e.className,c=e.confirm,l=k()("header",o);return i.createElement("div",{className:l},t&&i.createElement("div",{className:"page-title"},t),r&&r.show&&i.createElement(E.Z,(0,a.Z)({ref:"filter"},r,{confirm:c})),n&&n.show&&i.createElement(y.default,{ref:"time",model:n.model,group:n.group,onceShow:n.onceShow,confirm:c}))},t}(i.Component);C.defaultProps={title:"",filter:{show:!1,aspect:!1},time:{show:!1,group:!1},model:null,id:null,confirm:null},C.propTypes={confirm:v().func,time:v().object,title:v().string,model:v().string,id:v().string,filter:v().object};var b=n(26687);const N=function(e){function t(t){var n;return(n=e.call(this,t)||this).updateVisibleState=function(e,t,a){n.setState({id:e,title:t,body:a,dialogVisible:!n.state.dialogVisible})},n._handleOnConfirm=function(e){var t=n.props,a=t.onConfirm,r=t.title,o=n.state,i=o.id,c=o.title;e.stopPropagation(),n.setState({dialogVisible:!1},(function(){return a(i,c||r)}))},n._handleOnCancel=function(e){var t=n.props,a=t.onCancel,r=t.title,o=n.state,i=o.id,c=o.title;e.stopPropagation(),n.setState({dialogVisible:!1},(function(){return a(i,c||r)}))},n.state={id:void 0,title:void 0,body:void 0,dialogVisible:!1},n}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.body,r=this.state,o=r.title,l=r.body;return i.createElement(c.Dialog,{customClass:"cem-delete-dialog-small",title:n||o,modal:!1,closeOnClickModal:!1,visible:this.state.dialogVisible,onCancel:function(t){return e.setState({dialogVisible:!1})}},i.createElement(c.Dialog.Body,null,i.createElement("span",null,a||l)),i.createElement(c.Dialog.Footer,null,i.createElement(c.Button,{type:"primary",onClick:this._handleOnConfirm},"\u786e\u5b9a"),i.createElement(c.Button,{type:"default",onClick:this._handleOnCancel},"\u53d6\u6d88")))},t}(i.Component);var I=n(68003),_=n(17190);const w=function(e){var t=e.data,n=e.formModel,a=e.onChange,r=e.onBlur,o=e.spuList,l=e.spuTip,s=e.skuList,u=e.skuTip,d=e.onFocus,p=i.useState(l),m=p[0],f=p[1],h=i.useState(u),g=h[0],v=h[1];return i.useEffect((function(){f(l)}),[l]),i.useEffect((function(){v(u)}),[u]),i.createElement("div",null,i.createElement("div",null,t.name),i.createElement("div",{className:"divider"}),i.createElement(c.Input,{disabled:!0,placeholder:t.sourceName,prepend:i.createElement("span",null,"\u6570\u636e\u6765\u6e90"),className:"prepend-input"}),i.createElement(c.Input,{disabled:!0,placeholder:t.url,prepend:i.createElement("span",null,"SKU\u94fe\u63a5"),className:"prepend-input"}),i.createElement("div",{className:"source"},i.createElement(c.Checkbox,{checked:!0,disabled:!0,className:"COMMENT"===t.taskType?"checked":""},"\u8bc4\u8bba\u6570\u636e"),i.createElement(c.Checkbox,{checked:!0,disabled:!0,className:"PRICE"===t.taskType?"checked":""},"\u4ef7\u683c\u6570\u636e")),i.createElement(c.Form.Item,{prop:"name",label:"\u4efb\u52a1\u540d\u79f0"},i.createElement(c.Input,{onBlur:function(e){return r("name",e.target.value)},onChange:function(e){return a("name",e,"")},placeholder:"\u8bf7\u8f93\u5165\u4efb\u52a1\u540d\u79f0",value:n.extra.name})),o&&o.length>0&&i.createElement(c.Form.Item,{prop:"spu",label:"SPU\u8bcd\u6761",className:"spu_sku_select_item"},i.createElement(_.Z,{onChange:function(e){a("spuGroupId",e,"extra")},trigger:"click",data:o,value:n.extra.spuGroupId,onTipClick:function(){m&&f(""),d()},addText:"\u521b\u5efaSPU\u8bcd\u6761",onAddClick:function(){window.open("/account/project/base?drawerVisible=true")},className:(m?"content-error":"")+" select_opts"}),m&&i.createElement("span",{className:"content-error-hint"},m)),s&&s.length>0&&i.createElement(c.Form.Item,{prop:"sku",label:"SKU\u8bcd\u6761",className:"spu_sku_select_item"},i.createElement(_.Z,{onChange:function(e){a("skuGroupId",e.id,"extra")},trigger:"click",data:n.extra.spuGroupId?s.filter((function(e){return e.parentId===n.extra.spuGroupId})):s,value:n.extra.skuGroupId,onTipClick:function(){g&&v(""),d()},addText:"\u521b\u5efaSKU\u8bcd\u6761",disabled:!n.extra.spuGroupId,onAddClick:function(){window.open("/account/project/base/sku?spuId="+n.extra.spuGroupId+"&spuName="+o.find((function(e){return e.id===n.extra.spuGroupId})).name+"&drawerVisible=true")},className:(g?"content-error":"")+" select_opts"}),g&&i.createElement("span",{className:"content-error-hint"},g)))};var O=n(35303),T=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnInputChange=function(e){var t=n.props.separator;n.setState({value:e},(function(){if("space"===t){var e=n.state,a=e.value,r=e.tagData;a.endsWith(" ")&&n._updateValue(a,r)}}))},n._handleOnKeyDown=function(e){var t=n.props.separator,a=void 0===t?"enter":t,r=n.state,o=r.value,i=r.tagData;if(13===e.keyCode){if(n.props.single&&i.length>0)return void n.setState({value:""});"space"===a?o?n._updateValue(o,i).then((function(){n._handleOnSearch()})):n._handleOnSearch():"enter"===a&&n._updateValue(o,i)}else 8===e.keyCode&&(o||n._deleteWord())},n._deleteWord=function(){var e=n.props.onChange,t=n.state,a=t.value,r=t.tagData;!a&&r.length>0&&n.setState({tagData:r.splice(0,r.length-1)},(function(){e&&e(n.state.tagData.join(" "))}))},n._handleOnTagClose=function(e){var t=n.props.onChange;n.setState({tagData:n.state.tagData.filter((function(t){return t!==e}))},(function(){t&&t(n.state.tagData.join(" "))}))},n._handleOnInputBlur=function(e){var t=n.state.tagData;n._updateValue(e.target.value,t)},n._updateValue=function(e,t){return new Promise((function(a){var r=e.trim(" "),o=n.props.onChange;if(r.length>0)if(t.includes(r))l.Z.warning("\u8be5\u5173\u952e\u8bcd\u5df2\u5b58\u5728");else{var i=[].concat(t,[r]);n.setState({value:"",tagData:i}),o&&o(i.join(" ")),a()}}))},n._handleOnSearch=function(){var e=n.props.onSearch;e&&e(n.state.tagData.join(" "))},n.clear=function(){n.setState({value:"",tagData:[]});var e=n.props.onChange;e&&e("")},n.state={tagData:t.value?t.value.split(" ").filter((function(e){return e})):[],value:""},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentWillUnmount=function(){this.setState({tagData:[],value:""})},n.componentDidUpdate=function(e,t){var n=this.state.tagData,a=this.props,r=a.single,o=a.onChange,i=a.id;if(r&&n.length>1){var c=n.slice(0,1);this.setState({value:"",tagData:c}),o(c.join(" "))}i!==e.id&&this.setState({value:"",tagData:[]})},n.render=function(){var e=this,t=this.state,n=t.tagData,r=t.value,o=this.props,l=o.placeholder,s=o.disabled,u=void 0!==s&&s,d=o.append,p=o.size,m=o.onKeyUp,f=o.type,h=void 0===f?"normal":f,g={placeholder:l,disabled:u};return d&&(g.append=d),"search"===h&&(g.append=i.createElement("i",{onClick:this._handleOnSearch,className:"icon-cem_search"})),p&&(g.size=p),m&&(g.size=m),i.createElement(c.Input,(0,a.Z)({value:r,className:"keyword-input-wrapper",onBlur:this._handleOnInputBlur,prepend:i.createElement("span",null,n.map((function(t){return i.createElement(c.Tag,{key:t,closable:!u,closeTransition:!1,onClose:e._handleOnTagClose.bind(e,t)},t)}))),onChange:this._handleOnInputChange,onKeyDown:this._handleOnKeyDown},g))},t}(i.Component);const D=T;T.propTypes={type:v().oneOf(["search","normal"]),append:v().object,size:v().string,disabled:v().bool,plactHolder:v().string,onChange:v().func,onKeyUp:v().func,separator:v().oneOf(["space","enter"]),onSearch:v().func,single:v().bool,onClear:v().func};var x=[{label:"\u5305\u542b",value:"contain"},{label:"\u4e0d\u5305\u542b",value:"notContain"}],P={contain:[""],notContain:[],id:Math.round(1e4*Math.random())},L=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnRuleGroupAdd=function(){var e=n.state.content,t=[].concat(e,[JSON.parse(JSON.stringify(P))]);n.setState({content:t,formProps:n.getFormProps(t)})},n._handleOnRuleItemAdd=function(e){var t=n.state.content;if(t[e]){var a=JSON.parse(JSON.stringify(t));!a[e].contain&&(a[e].contain=[]),a[e].contain.push(""),n.setState({content:a,formProps:n.getFormProps(a)})}},n._handleOnRuleItemDelete=function(e){if(e){var t=n.state.content,a=e.split("-"),r=(a[0],a[1]),o=a[2],i=a[3];if(t[r]&&t[r][o]&&void 0!==t[r][o][i]){var c=JSON.parse(JSON.stringify(t));c[r][o].splice(i,1),0===c[r].contain.length&&0===c[r].notContain.length&&c.splice(r,1),n.setState({content:c,formProps:n.getFormProps(c)})}}},n._handleOnSelecChange=function(e,t){if(e&&t){var a=n.state.content,r=e.split("-"),o=(r[0],r[1]),i=r[2],c=r[3];if(a[o]&&a[o][i]&&void 0!==a[o][i][c]){var l=JSON.parse(JSON.stringify(a)),s=l[o][i].splice(c,1);l[o][t].push(s[0]),n.setState({content:l,formProps:n.getFormProps(l)})}}},n._handleOnInputChange=function(e,t){if(e){var a=n.state.content,r=e.split("-"),o=(r[0],r[1]),i=r[2],c=r[3];if(a[o]&&a[o][i]&&void 0!==a[o][i][c]){var l=JSON.parse(JSON.stringify(a));l[o][i][c]=t,n.setState({content:l,formProps:n.getFormProps(l)})}}},n.getValue=function(){return n.state.content},n.getFormProps=function(e){var t={model:{},rules:{}};return e&&e.length>0&&e.forEach((function(e,n){e&&["contain","notContain"].forEach((function(a){e[a]&&e[a].forEach((function(e,r){var o="rule-"+n+"-"+a+"-"+r;t.model[o]=e,t.rules[o]=[{required:!0,message:"\u8bf7\u8f93\u5165\u5185\u5bb9\u89c4\u5219",trigger:"blur"}]}))}))})),t},n.formRef=void 0,n.state={content:(t.value||[]).map((function(e){return(0,a.Z)({},e,{id:Math.round(1e4*Math.random())})})),formProps:{model:{},rules:{}}},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){var t=e.value,n=this.props.value;JSON.stringify(t)!==JSON.stringify(n)&&this.setState({content:n,formProps:this.getFormProps(n)})},n.render=function(){var e=this,t=this.state,n=t.content,r=t.formProps,o=this.props.editable,l=void 0===o||o;return i.createElement("div",{className:"content-rule-2-wrapper"},i.createElement("span",{className:"content-rule-2-title"},"\u5185\u5bb9"),i.createElement("div",{className:"content-rule-2"},n.length>0?i.createElement(c.Form,(0,a.Z)({},r,{ref:function(t){return e.formRef=t}}),i.createElement("span",null,"\u5982\u679c"),n.map((function(t,n){return i.createElement("div",{className:"content-rule-2-group",key:t.id},["contain","notContain"].map((function(a){return t[a]&&t[a].map((function(t,r){var o="rule-"+n+"-"+a+"-"+r;return i.createElement("div",{key:o,className:"content-rule-2-group-item"},i.createElement("span",null,"\u5185\u5bb9"),i.createElement("span",null,i.createElement(c.Select,{disabled:!l,value:a,onChange:function(t){return e._handleOnSelecChange(o,t)}},x.map((function(e){return i.createElement(c.Select.Option,{key:e.value,label:e.label,value:e.value})})))),i.createElement("span",null,i.createElement(c.Form.Item,{prop:o},i.createElement(c.Input,{disabled:!l,value:t,onChange:function(t){return e._handleOnInputChange(o,t)}}))),l&&i.createElement("span",null,i.createElement("i",{className:"icon-cem_delete",onClick:function(){return e._handleOnRuleItemDelete(o)}})))}))})),l&&i.createElement(c.Button,{className:"content-rule-2-btn btn-and",onClick:function(){return e._handleOnRuleItemAdd(n)}},"\u4e14 +"))})),l&&i.createElement(c.Button,{className:"content-rule-2-btn",type:"primary",onClick:this._handleOnRuleGroupAdd},"\u6216 +")):l&&i.createElement(c.Button,{className:"content-rule-2-btn",type:"primary",onClick:this._handleOnRuleGroupAdd},"\u6dfb\u52a0\u89c4\u5219\u5185\u5bb9")))},t}(i.PureComponent);const M=L;L.propTypes={value:v().array,editable:v().bool};var V={multiple:!1,tags:!1,optionFilterProp:"label",optionLabelProp:"label",showSearch:!1};const Z=function(e){var t=e.formModel,n=e.psData,r=e.sData,o=e.onChange,l=e.pcCount,s=e.onBlur,u=e.getContentRuleRef;return i.createElement("div",{className:"keyword-add-wrapper"},i.createElement(c.Form.Item,{prop:"sourceId",label:"\u6570\u636e\u6765\u6e90"},i.createElement("div",null,i.createElement(O.RS,(0,a.Z)({className:"m_select_"+(l+0),value:t.extra.sourceId,onChange:function(e){return o("sourceId",e,"extra")}},V),n.values.map((function(e,t){return i.createElement(O.Wx,{key:t,label:e.name,value:e.id},e.name)}))))),r&&i.createElement(c.Form.Item,{prop:"sourceChildId",label:"\u5b50\u6765\u6e90"},i.createElement("div",null,i.createElement(O.RS,(0,a.Z)({className:"m_select_"+(l+1),value:t.extra.sourceChildId,onChange:function(e){return o("sourceChildId",e,"extra")}},V),r.map((function(e,t){return i.createElement(O.Wx,{key:t,label:e.sourceChildShowName,value:e.sourceChildId},e.sourceChildShowName)}))))),r&&r.find((function(e){return e.sourceChildId===t.extra.sourceChildId})).viewConfig.map((function(e,n){return i.createElement(c.Form.Item,{key:n,prop:e.itemProperty.name,label:e.itemProperty.showName},function(e,t,n,a,r,o){switch(t.itemType){case"input":return"key"===t.itemProperty.name?i.createElement("div",{style:{padding:"4px 0"}},"11"===e.extra.sourceId?i.createElement(M,{value:e.extra[t.itemProperty.name],ref:o}):i.createElement(D,{id:e.extra.sourceChildId,single:"14"===e.extra.sourceId,placeholder:t.itemProperty.placeholder,onChange:function(e){return n(t.itemProperty.name,e,"extra")}})):i.createElement(c.Input,{onBlur:function(e){return r(t.itemProperty.name,e.target.value)},style:{padding:"4px 0"},value:e.extra[t.itemProperty.name],placeholder:t.itemProperty.placeholder,onChange:function(e){return n(t.itemProperty.name,e,"extra")}});case"select-dropdown":return i.createElement("div",null,i.createElement(O.RS,{className:"m_select_"+a,value:e.extra[t.itemProperty.name],onChange:function(e){return n(t.itemProperty.name,e,"extra")}},t.itemProperty.selectItems.map((function(e,t){return i.createElement(O.Wx,{key:t,label:e.name,value:e.id},e.name)}))))}}(t,e,o,l+2+n,s,u))})))},A=function(e){var t=e.data,n=e.formModel,a=e.onChange,r=e.onBlur,o=e.getContentRuleRef;return i.createElement("div",{className:"keyword-edit-wrapper"},i.createElement(c.Input,{style:{padding:"4px 0"},disabled:!0,placeholder:t.sourceName,prepend:i.createElement("span",null,"\u6570\u636e\u6765\u6e90"),className:"prepend-input"}),i.createElement(c.Input,{style:{padding:"4px 0"},disabled:!0,placeholder:t.sourceChildName,prepend:i.createElement("span",null,"\u5b50\u6765\u6e90"),className:"prepend-input"}),i.createElement(c.Form.Item,{prop:"",label:"\u5173\u952e\u8bcd"},"11"===t.sourceId?i.createElement(M,{value:JSON.parse(t.url),ref:o,editable:!1}):i.createElement(D,{disabled:!0,value:t.url})),i.createElement(c.Form.Item,{prop:"name",label:"\u4efb\u52a1\u540d\u79f0"},i.createElement(c.Input,{onBlur:function(e){return r("name",e.target.value)},onChange:function(e){return a("name",e,"extra")},placeholder:"\u8bf7\u8f93\u5165\u4efb\u52a1\u540d\u79f0",value:n.extra.name})))};var R=function(e){function t(t){var n;return(n=e.call(this,t)||this)._fetchSourceDetail=function(e){var t=n.state.formModel;u.h.post("/source/sourcechild/config",{sourceId:e.sourceId}).then((function(r){var o=r.data;if(2e4===o.code){var i=o.result,c=i[0].viewConfig.reduce((function(t,r){var o,i;switch(r.itemType){case"input":"name"===r.itemProperty.name?(n.defName=j(e.sourceName,""),i=n.defName):"key"===r.itemProperty.name?(n.keyName=r.itemProperty.showName,i=""):i="";break;case"select-dropdown":i=r.itemProperty.selectItems[0].id}return(0,a.Z)({},t,((o={})[r.itemProperty.name]=i,o))}),{}),l=(0,a.Z)({},t,{extra:(0,a.Z)({},c,{categoryId:i[0].categoryId,categoryName:i[0].categoryName,sourceId:e.sourceId,sourceName:e.sourceName,sourceChildId:i[0].sourceChildId})});n.setState({sData:i,loading:!1,formModel:l})}}))},n._fetchTopics=function(e){u.h.post("/subscribe-topic/list",{projectId:e,pageIndex:1,pageSize:100,name:"",valueFrom:[e]}).then((function(t){var a=t.data.result.result.filter((function(e){return"USER_CUSTOMIZE"===e.topicType}));n.setState({topicOpts:a}),a.forEach((function(t,a){u.h.post("/subscribe-topic-value/list",{projectId:e,topicId:t.id,valueFrom:[e],pageSize:1e3,pageIndex:1}).then((function(e){var t;2e4===e.data.code&&n.setState(((t={})["topicValue"+a]=e.data.result.result,t))}))}))}))},n._fetchConnectionCommondData=function(e){u.h.post("/projects/connection/search",{id:e}).then((function(e){var t=e.data;if(2e4===t.code){var r=t.result.titles,o=[],i={};r&&r instanceof Array&&r.forEach((function(e){o.push(e),i[e.id]=[];var t=e.child;t&&(o.push(t),i[t.id]="")})),o.length>0&&n.setState({pcData:o,defPcData:[].concat(o),formModel:(0,a.Z)({},i),pcFormModel:i})}}))},n._handleOnCancel=function(){n.setState((0,a.Z)({},n.cleanState))},n._handleSelectFilterMethod=function(e,t,r){var o=n.state,i=o.pcData,c=o.formModel,l=c[t.id];l!==e&&(n.filterTimeoutId&&clearTimeout(n.filterTimeoutId),n.filterTimeoutId=setTimeout((function(){var o,s=t.values.filter((function(t){return t.name.includes(e)})),u=s.find((function(t){return t.name===e}));!e||u||0!==s.length&&l===e||s.push({name:e,id:""});var d=(0,a.Z)({},t,{fValues:s});i[r]=d;var p=(0,a.Z)({},c,((o={})[t.id]=e,o));n.setState({pcData:i},(function(){return n.setState({formModel:p},(function(){var e=document.getElementsByClassName("m_select_"+r)[0];e.childNodes[1].setAttribute("style",F(e.childNodes[0].offsetTop-n.mScrollTop+40,107,"block"))}))}))}),500))},n._handleOnSubmit=function(e){(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),n.contentRuleRef)?0===(n.contentRuleRef?n.contentRuleRef.getValue():[]).length?l.Z.error("\u5173\u952e\u8bcd\u4e0d\u80fd\u4e3a\u7a7a"):n.contentRuleRef.formRef.validate((function(e){e?n._updateConnectionSetting():l.Z.error("\u63d0\u53d6\u6761\u4ef6\u4e2d\u5b58\u5728\u5185\u5bb9\u89c4\u5219\u4e3a\u7a7a")})):n._updateConnectionSetting()},n._updateConnectionSetting=function(){var e=n.state,t=e.formModel,r=(e.psData,e.type),o=e.pcData,i=e.title,c=(e.spuTip,e.skuTip,e.topicOpts),s=n.props,d=s.projectId,p=s.onConfirm,m=s.spuList,f=s.skuList,h="/connection/update",g=void 0;if(r.includes("add")){if(h="/projects/connection/add",!t.extra.name)return void l.Z.error("\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a");if(n.contentRuleRef){if(0===(g=n.contentRuleRef.getValue()).length||0===g[0].contain.length&&0===g[0].noContain.length)return void l.Z.error("\u5173\u952e\u8bcd\u4e0d\u80fd\u4e3a\u7a7a");g.forEach((function(e){e.contain.forEach((function(t,n){return e.contain[n]=t.toUpperCase()})),e.notContain.forEach((function(t,n){return e.notContain[n]=t.toUpperCase()}))}))}else if(!t.extra.key)return void l.Z.error(n.keyName+"\u4e0d\u80fd\u4e3a\u7a7a")}var v=JSON.parse(JSON.stringify(t));Object.keys(v).forEach((function(e){if("extra"!==e){for(var t=v[e],n=[],a=o.filter((function(t){return t.id===e}))[0].values,r=0;r<t.length;r++){for(var i=!1,c=0;c<a.length;c++)if(t[r]===a[c].name){var l=a[c],s=l.id,u=l.name;n.push({id:s,name:u}),i=!0}i||n.push({id:"",name:t[r]})}v[e]=n}}));var y=(0,a.Z)({},v.extra),E=[];c&&c.forEach((function(e){n.state["value"+e.id]&&E.push({id:e.id,name:n.state["id"+e.id]})}));var S=(0,a.Z)({projectId:d,categoryId:y.categoryId,categoryName:y.categoryName,sourceName:y.sourceName,topics:Object.keys(v).filter((function(e){return"extra"!==e})).map((function(e){return{topicTypeId:e,topicArr:"\u7f16\u8f91\u94fe\u63a5\u4efb\u52a1"===i&&v[e].length>0?v[e]:[{id:o.find((function(t){return t.id===e})).values.find((function(e){return e.name.includes("\u7a7a\u503c")})).id,name:o.find((function(t){return t.id===e})).values.find((function(e){return e.name.includes("\u7a7a\u503c")})).name}]}})),customizeConfig:E},y);m&&m.length>0&&f&&f.length>0&&(S.flag="PROJECT"),g&&(S.key=JSON.stringify(g),S.content=g),n.props.spuList&&n.props.spuList.length&&!y.spuGroupId?n.setState({spuTip:"\u8bf7\u9009\u62e9SPU\u8bcd\u6761"}):n.props.skuList&&n.props.skuList.length&&!y.skuGroupId?n.setState({skuTip:"\u8bf7\u9009\u62e9SKU\u8bcd\u6761"}):u.h.post(h,S).then((function(e){2e4===e.data.code&&l.Z.success("\u64cd\u4f5c\u6210\u529f"),n.setState((0,a.Z)({},n.cleanState),(function(){return p()}))}))},n._handleOnSelectChange=function(e,t,a){var r;if(e&&e.length){var o,i=e[e.length-1];if(n.state["topicValue"+t].find((function(e){return e.value===i})))n.setState(((o={})["value"+a.id]=[i],o["id"+a.id]=n.state["topicValue"+t].find((function(e){return e.value===i})).id,o));else u.h.post("/subscribe-topic-value/add",{projectId:n.props.projectId,topicId:a.id,value:i}).then((function(e){var t,r=e.data;2e4===r.code&&n.setState(((t={})["value"+a.id]=[i],t["id"+a.id]=r.result,t))}))}!e.length&&n.setState(((r={})["value"+a.id]=void 0,r))},n._handleFormValueChange=function(e,t,r){var o=n.state,i=o.formModel,c=o.psData,l=o.sData,s=(0,a.Z)({},i);"extra"===r?(s.extra[e]=t,"sourceId"===e?(s.extra.key="",s.extra.sourceName=c.values.find((function(e){return e.id===t})).name,n.defName=j(s.extra.sourceName,""),s.extra.name=n.defName):"sourceChildId"===e?(s.extra.key="",n.keyName=l.find((function(e){return e.sourceChildId===t})).viewConfig.find((function(e){return"key"===e.itemProperty.name})).itemProperty.showName):"key"===e?(n.defName=j(c.values.find((function(e){return e.id===i.extra.sourceId})).name,t),s.extra.name=n.defName,s.extra[e]="string"===typeof t?t.trim():t instanceof Array?t.filter((function(e){return e}))[0]:""):"spuGroupId"===e?(s.extra.spuGroupId=t.id,s.extra.spuGroupName=t.name,s.extra.skuGroupId=void 0):"skuGroupId"===e&&(s.extra.skuGroupId=t)):s[e]=t,n.setState({formModel:s},(function(){"sourceId"===e&&n._fetchSourceDetail({sourceId:s.extra.sourceId,sourceName:s.extra.sourceName})}))},n._handelOnSelectClick=function(e){n.setState({curSelectIdx:e});var t=document.getElementsByClassName("m_select_"+e)[0];t.childNodes[1].setAttribute("style",F(t.childNodes[0].offsetTop-n.mScrollTop+40,107,"block"))},n._handleOnSelectVisibleChange=function(e,t){t||setTimeout((function(){e===n.state.curSelectIdx&&n.setState({curSelectIdx:-1})}),100)},n._handleOnNameInputBlur=function(e,t){if("name"===e&&!t){var r=n.state.formModel,o=(0,a.Z)({},r);o.extra.name=n.defName||"",n.setState({formModel:o})}},n._handleOnSelectBlur=function(e){setTimeout((function(){document.getElementsByClassName("m_select_"+e)[0].childNodes[1].setAttribute("style",F(0,1e4,"none"))}),500)},n._handleGetContentRuleRef=function(e){return n.contentRuleRef=e},n._handleOnFocus=function(){var e=n.props,t=e.spuList,a=e.skuList,r=e.projectId,o=h.t.get(h.V.newEntry)||{},i=o.spuName,c=o.skuName,l=o.spuId,s=o.skuId;(i&&!t.find((function(e){return i.includes(e.name.replaceAll(e.split,"").replaceAll("|",""))}))||c&&!a.find((function(e){return c.includes(e.name.replaceAll(e.split,"").replaceAll("|",""))}))||l&&!t.find((function(e){return String(e.id)===String(l)}))||s&&!a.find((function(e){return String(e.id)===String(s)})))&&u.h.post("/subproject-connection/group/list",{projectId:r})},n.renderDiffComp=function(){var e=n.state,t=e.type,a=e.cData,r=e.formModel,o=e.psData,c=e.sData,l=e.pcData,s=e.spuTip,u=e.skuTip,d=n.props,p=d.spuList,m=d.skuList;switch(t){case"connection-edit":return"KEYWORD"===a.taskType?i.createElement(A,{data:a,onBlur:n._handleOnNameInputBlur,formModel:r,onChange:n._handleFormValueChange,getContentRuleRef:n._handleGetContentRuleRef}):i.createElement(w,{data:a,onBlur:n._handleOnNameInputBlur,formModel:r,onChange:n._handleFormValueChange,spuList:p,spuTip:s,skuList:m,skuTip:u,onFocus:n._handleOnFocus});case"keyword-add":return i.createElement(Z,{formModel:r,pcCount:l.length,psData:o,onChange:n._handleFormValueChange,sData:c,onBlur:n._handleOnNameInputBlur,getContentRuleRef:n._handleGetContentRuleRef})}},n.renderSelectOption=function(e){return(e.fValues?e.fValues:e.values).map((function(e,t){return i.createElement(O.Wx,{key:t,value:e.name,className:""===e.id?"new-selection":""},e.name)}))},n.defName=void 0,n.keyName=void 0,n.state={pcData:[],defPcData:[],title:"",psData:{id:"sources",name:"\u6570\u636e\u6765\u6e90",values:[{id:"11",name:"\u77e5\u4e4e"},{id:"12",name:"\u65b0\u6d6a\u5fae\u535a"},{id:"14",name:"\u767e\u5ea6\u8d34\u5427"}]},cData:void 0,sData:void 0,visible:!1,loading:!1,formModel:{extra:{}},pcFormModel:{},curSelectIdx:-1,spuTip:"",skuTip:"",topicOpts:[]},n}(0,o.Z)(t,e);var n=t.prototype;return n.updateVisibleState=function(e,t){var n,r,o=this,i=this.state,c=i.pcFormModel,l=i.psData,s=i.topicOpts,u=t||{};switch(e){case"connection-edit":r="KEYWORD"===t.taskType?"\u7f16\u8f91\u5173\u952e\u8bcd\u4efb\u52a1":"\u7f16\u8f91\u94fe\u63a5\u4efb\u52a1",(n=u.configDetails.reduce((function(e,t){var n;return t.topicTypeId?(0,a.Z)({},e,((n={})[t.topicTypeId]=t.topicArr.filter((function(e){return!e.name.includes("\u7a7a\u503c")})).map((function(e){return e.name})),n)):e}),{extra:{id:u.id}})).extra.name=u.name,n.extra.spuGroupId=u.spuGroupId,n.extra.skuGroupId=u.skuGroupId,s.forEach((function(e,t){var n;u.skuTopics&&u.skuTopics.find((function(t){return String(t.topicId)===String(e.id)}))&&(u.skuTopics.find((function(t){return String(t.topicId)===String(e.id)})).topicValueId&&o.setState(((n={})["value"+e.id]=[u.skuTopics.find((function(t){return String(t.topicId)===String(e.id)})).topicValue],n["id"+e.id]=u.skuTopics.find((function(t){return String(t.topicId)===String(e.id)})).topicValueId,n)))})),this.defName=u.name;break;case"keyword-add":r="\u65b0\u589e\u5173\u952e\u8bcd\u4efb\u52a1";var d=l.values[0];n=(0,a.Z)({},c,{extra:{sourceId:d.id}}),u.sourceId=d.id,u.sourceName=d.name}var p=e.includes("add");this.setState({type:e,title:r,formModel:n,cData:u,loading:p,visible:!0},(function(){return p&&o._fetchSourceDetail(o.state.cData)}))},n.componentDidMount=function(){var e=this.props.projectId;this._fetchConnectionCommondData(e),this._fetchTopics(e)},n.render=function(){var e=this,t=this.state,n=t.visible,r=t.loading,o=t.formModel,l=t.pcData,s=t.title,u=t.topicOpts,d=this.props,p=d.title,m=d.spuList,f=d.skuList,h="\u7f16\u8f91\u94fe\u63a5\u4efb\u52a1"===s?l.map((function(e,t){return(0,a.Z)({},e,{values:e.values.filter((function(e){return!e.name.includes("\u7a7a\u503c")}))})})):l;return i.createElement(c.Dialog,{className:"cem-edit-dialog-large",visible:n,closeOnClickModal:!1,title:p||s,onCancel:this._handleOnCancel},i.createElement(c.Dialog.Body,null,i.createElement(c.Loading,{loading:r},n&&i.createElement(c.Form,{model:o},this.renderDiffComp(),m&&f&&u&&u?u.map((function(t,n){return i.createElement("div",{className:"topic_select_item",key:t.id},i.createElement("span",{className:"ellipsis"},t.name),i.createElement(O.RS,{tags:!0,multiple:!1,onChange:function(a){e._handleOnSelectChange(a,n,t)},value:e.state["value"+t.id],optionLabelProp:"label",optionFilterProp:"label",placeholder:"\u8bf7\u9009\u62e9\u6216\u8005\u8f93\u5165"},e.state["topicValue"+n]&&e.state["topicValue"+n].map((function(e){return i.createElement(O.Wx,{key:e.id,value:e.value,label:e.value},e.value)}))))})):null,h.map((function(t,n){return i.createElement(c.Form.Item,{key:n,label:t.name,prop:t.id},i.createElement("div",null,i.createElement(O.RS,{className:"m_select_"+n,value:o[t.id],onChange:function(n){return e._handleFormValueChange(t.id,n,"")},placeholder:"\u8bf7\u9009\u62e9\u5df2\u6709"+t.name+"\u6216\u952e\u5165\u65b0\u7684"+t.name,multiple:!0,tags:!0},e.renderSelectOption(t))))}))))),i.createElement(c.Dialog.Footer,null,i.createElement(c.Button,{type:"primary",onClick:this._handleOnSubmit},"\u786e\u5b9a"),i.createElement(c.Button,{type:"default",onClick:this._handleOnCancel},"\u53d6\u6d88")))},(0,r.Z)(t,[{key:"cleanState",get:function(){this.mScrollTop=0,this.defName=void 0;var e=this.state,t=e.defPcData,n=e.pcFormModel;return{visible:!1,loading:!1,cData:void 0,pcData:[].concat(t),sData:void 0,curSelectIdx:-1,formModel:(0,a.Z)({},n,{extra:{}}),spuTip:"",skuTip:""}}}]),t}(i.Component),j=function(e,t){return"\u4ece"+e+"\u6570\u636e\u6e90\u4f9d\u636e"+t+"\u5173\u952e\u8bcd\u63d0\u53d6"},F=function(e,t,n){return"min-width: 595px; top: "+e+"px !important; left: "+t+"px !important; will-change: top, left; transform: all 0.3s; display: "+n+" !important"};const B=R;var G=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={defaultChecked:!1},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.setState((0,a.Z)({},this.props))},n.componentWillReceiveProps=function(e){this.setState((0,a.Z)({},e))},n.handleClick=function(e){var t=this.state,n=t.type,a=t.defaultChecked,r=t.selectedList,o=t.totalList;if("checkAll"===n)a?this.props.onChange([]):this.props.onChange(o);else{var i=r.indexOf(e);i>-1?r.splice(i,1):r.push(e),this.props.onChange(r)}this.setState({defaultChecked:!a})},n.render=function(){var e=this,t=this.state,n=t.type,a=t.defaultChecked,r=t.indeterminate,o=t.uniqueId,c="customized-checkobx";return a?c="customized-checkobx checked":"checkAll"===n&&r&&(c="customized-checkobx indeterminate"),i.createElement("div",{className:"customized-checkobx-wrapper"},i.createElement("div",{className:c,onClick:function(t){t.stopPropagation(),e.handleClick(o)}}))},t}(i.PureComponent),U=n(30381),z=n.n(U),W=function(e){function t(t){var n;return(n=e.call(this,t)||this)._getLinkName=function(e){return e.name?e.name:e.configDetails.map((function(e){return e.topicTypeValue})).join(" ")},n._handleDeleteConfirm=function(e){var t=n.state.pageIndex;u.h.post("/connection/delete",{ids:e}).then((function(a){n.setState({selectedList:[],pageIndex:e.length>1?1:t},(function(){return n.getList()}))}))},n.getShowColumns=function(e){n.setState({selectMenuItem:e})},n.selPage=function(e){n.setState({pageIndex:e},(function(){return n.getList()}))},n.switchPageSize=function(e){n.setState({pageSize:e,pageIndex:1},(function(){return n.getList()}))},n.getList=function(){var e=n.refs.header.getParams(),t=n.state,r=t.projectId,o=t.keyWord,i=t.pageSize,c=t.pageIndex,l=t.sortType,s=t.sortName,d=t.sortUpdate,p=t.statusVals,m=t.selectedList,f=n.state.currPageSelectedList,h=e.filterModel;u.h.post("/connection/list",{projectId:r,pageSize:i,pageIndex:c,sortModel:{sortType:l,sortName:s,STATUS_TIME:d},name:[o],filterModel:(0,a.Z)({},h,{ucStatus:p})}).then((function(e){var t=e.data.result;n.setState({data:[]},(function(){var e,a=t.from||(n.state.pageIndex-1)*n.state.pageSize+1;e=t.to?t.to:(e=n.state.pageIndex*n.state.pageSize)>t.count?t.count:e,f=[];for(var r=t.list,o=r.length-1;o>=0;o--)m.indexOf(r[o].id)>-1?(r[o].checked=!0,f.push(r[o].id)):r[o].checked=!1;n.setState({data:t.list,currPageSelectedList:f,start:a,end:e,total:t.count},(function(){n.createTableColumns(),n.handleCheckboxStyle()}))}))}))},n.refresh=function(e){e?n.setState({pageIndex:1},(function(){return n.getList()})):n.getList(),h.t.set(h.V.connectionFilter,JSON.stringify(n.refs.header.getParams()))},n._handleBatchAdd=function(){var e=n.state,t=e.title,a=e.projectId;f.mW.push({pathname:"/account/project/connection/batchAdd",state:{title:t,projectId:a}})},n.createTableColumns=function(){var e,t=n.state,a=t.data,r=t.oriSelectMenuItem,o=[].concat(r),c=a.length>0&&a[0].configDetails.map((function(e,t){return{label:e.topicTypeValue,checked:!0,prop:e.topicTypeValue,render:function(e){return i.createElement("p",{className:"ellipse "+(e.configDetails[t]&&e.configDetails[t].topicArr&&e.configDetails[t].topicArr.length>0&&e.configDetails[t].topicArr.map((function(e){return e.name}))[0].includes("\u7a7a\u503c")?"null_count":"")},e.configDetails[t]&&e.configDetails[t].topicArr&&e.configDetails[t].topicArr.length>0?e.configDetails[t].topicArr.map((function(e){return e.name})).join("\uff0c"):"")}}})),l=n.refs.SelectableColumns.competeSelectMenuItem();o.splice.apply(o,[2,0].concat(c)),e=l.length===o.length?o.filter((function(e){return l.find((function(t){return t.label===e.label}))})):o,n.setState({selectMenuItem:e},(function(){n.refs.SelectableColumns.resize()}))},n.addConnection=function(){f.mW.push({pathname:"/account/project/connection/addLink",state:{id:n.state.projectId,projectName:n.state.projectName,type:"add",filterModel:n.refs.header.getParams()||{}}})},n._handleOnInutChange=function(e){n.inputTimeoutId&&clearTimeout(n.inputTimeoutId),n.inputTimeoutId=setTimeout((function(){n.setState({hasKey:""!==e},(function(){!e&&n.state.keyWord&&n.setState({keyWord:"",pageIndex:1},(function(){return n.getList()}))}))}),500)},n._handleInputOnKeyUp=function(e){"Enter"===e.key&&n.setState({keyWord:e.target.value,pageIndex:1},(function(){return n.getList()}))},n._handleOnInputIconClick=function(){n.refs.searchInput.refs.input.value="",n.state.keyWord&&n.setState({keyWord:"",pageIndex:1},(function(){return n.getList()}))},n._handleKeywordAdd=function(e){n.refs.editDialog.updateVisibleState("keyword-add")},n.handleSort=function(e){var t;t="createdAt"===e.prop?"CREATED_AT":"sourceName"===e.prop?"SOURCE":"statusTime"===e.prop?"STATUS_TIME":e.prop.toUpperCase(),n.setState({sortName:t,sortType:"ascending"===e.order?"ASC":"DESC",pageIndex:1},(function(){return n.getList()}))},n._handleQuickPick=function(){f.mW.push({pathname:"/account/project/connection/quickPick",state:{id:n.state.projectId,projectName:n.state.projectName}})},n._handleDeleteByGroup=function(){var e=n.state.selectedList;e.length>0?n.refs.deleDailog.updateVisibleState(e):l.Z.warning("\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u6761\u94fe\u63a5")},n.handleCheck=function(e){var t=n.state,a=t.currPageSelectedList,r=t.selectedList,o=e.length>a.length?"push":"splice",i="push"===o?e.filter((function(e){return!a.includes(e)})):a.filter((function(t){return!e.includes(t)}));if("push"===o)for(var c=i.length-1;c>=0;c--)r.includes(i[c])||r.push(i[c]);else for(var l=i.length-1;l>=0;l--){var s=r.indexOf(i[l]);s>-1&&r.splice(s,1)}n.setState({selectedList:r,currPageSelectedList:e},(function(){return n.handleCheckboxStyle()}))},n.handleCheckboxStyle=function(){var e=n.state,t=e.currPageSelectedList,a=e.data,r=e.checkAllStatus;if(t.length===a.length&&a.length>0)r.checked=!0,a.forEach((function(e){e.checked=!0}));else{0===t.length?(r.indeterminate=!1,a.forEach((function(e){return e.checked=!1}))):r.indeterminate=!0,r.checked=!1;for(var o=a.length-1;o>=0;o--){for(var i=!1,c=t.length-1;c>=0;c--)if(t[c]===a[o].id){i=!0,a[o].checked=!0;break}i||(a[o].checked=!1)}}n.setState({data:a,checkAllStatus:r})},n._handleOnStatusChange=function(e){n.setState({statusVals:e.map((function(e){return e.id}))},(function(){n.getList()}))},n.state={title:"\u7535\u5546\u8bc4\u8bba",projectId:h.t.get(h.V.backProjectConfig).id,projectName:h.t.get(h.V.backProjectConfig).name,sortType:"DESC",sortName:"CREATED_AT",sortUpdate:"DESC",data:[],statusVals:[],currPageSelectedList:[],selectedList:[],checkAllStatus:{checked:!1,indeterminate:!1},columns:[{label:"\u4efb\u52a1\u540d\u79f0",prop:"name",fixed:"left",checked:!0,sortable:!0,minWidth:280,render:function(e){return-1!==e.url.indexOf("http")?i.createElement("a",{className:"control",href:e.url,target:"_blank"},n._getLinkName(e)):i.createElement("span",{className:"control"},n._getLinkName(e))}}],selectMenuItem:[],oriSelectMenuItem:[{label:"\u6570\u636e\u6765\u6e90",prop:"sourceName",sortable:!0,width:100,checked:!0,render:function(e){return i.createElement("span",null,e.sourceName)}},{label:"\u4efb\u52a1\u7c7b\u578b",prop:"taskType",width:80,checked:!0,render:function(e){var t;return"COMMENT"===e.taskType?t="\u8bc4\u8bba":"KEYWORD"===e.taskType?t="\u5173\u952e\u8bcd":"PRICE"===e.taskType?t="\u4ef7\u683c":"QUESTION"===e.taskType&&(t="\u7535\u5546\u95ee\u7b54"),i.createElement("span",null,t)}},{label:"\u521b\u5efa\u65f6\u95f4",prop:"createdAt",checked:!1,sortable:!0,width:100,render:function(e){return i.createElement("p",null,n.getNowFormatDate(e.createdAt))}},{label:"\u552f\u4e00\u6807\u8bc6",checked:!1,prop:"syncKey",width:150,render:function(e){return i.createElement("p",null,e.syncKey)}},{label:"\u6570\u636e\u91cf\u63d0\u53d6\u8d8b\u52bf\u56fe",checked:!0,width:120,render:function(e,t,a){var r=e.dataList,o=r?r.map((function(e){return e.count})):[];return i.createElement("div",{className:"trend-graphy",style:{width:120,height:"22px",position:"relative"}},i.createElement(I.Z,{key:e.userConnectionId,ref:"data_trend"+a,data:o}),i.createElement("div",{onClick:function(){return n.toDataPage(e.id,e.name,e.syncKey,e.sourceId)},style:{position:"absolute",width:"100%",height:"100%",top:0,cursor:"pointer"}}))}},{label:"\u94fe\u63a5\u72b6\u6001",checked:!0,width:80,prop:"status",render:function(e){var t="";return"ON_SALE"===e.status?t="\u5728\u552e":"OFF_SALE"===e.status&&(t="\u4e0b\u67b6"),t}},{label:"\u72b6\u6001\u66f4\u6539\u65f6\u95f4",checked:!0,sortable:!0,width:160,prop:"statusTime",render:function(e){return z()(e.statusTime).format("YYYY-MM-DD HH:mm:ss")}},{label:"\u64cd\u4f5c",prop:"operate",width:120,fixed:"right",checked:!0,render:function(e){return i.createElement("div",{className:"operations"},m.Z.hasAuthority("PROJECT_EDIT")&&i.createElement("span",{type:"text",className:"operation_columns",onClick:function(){return n.refs.editDialog.updateVisibleState("connection-edit",e)}},"\u7f16\u8f91"),m.Z.hasAuthority("PROJECT_DELETE")&&i.createElement("span",{type:"text",className:"operation_columns",onClick:function(){return n.refs.deleDailog.updateVisibleState([e.id])}},"\u5220\u9664"))}}],handle:[],form:{name:"",projectId:""},start:0,end:0,total:0,keyWord:"",hasKey:!1,pageSize:20,pageIndex:1,taskType:[],spuList:[],skuList:[]},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this,t=this.state.projectId;u.h.post("/subproject-connection/group/list",{projectId:t}).then((function(t){var n=t.data.result,a=n.spuList,r=n.skuList;e.setState({spuList:a,skuList:r})}))},n.toDataPage=function(e,t,n,a){var r=this.state.projectId;window.open("/tab/connectionData?"+encodeURIComponent(JSON.stringify({id:e,name:t,syncKey:n,projectId:r,sourceId:a})))},n.getNowFormatDate=function(e){var t=new Date(e),n=t.getFullYear(),a=t.getMonth()+1,r=t.getDate();return a>=1&&a<=9&&(a="0"+a),r>=0&&r<=9&&(r="0"+r),n+"-"+a+"-"+r},n.render=function(){var e=this,t=this.state,n=t.projectId,a=t.data,r=t.columns,o=t.start,l=t.end,u=t.total,m=t.selectMenuItem,f=t.title,g=t.hasKey,v=t.currPageSelectedList,y=t.checkAllStatus,E=t.statusVals,S=t.spuList,k=t.skuList,I=JSON.parse(JSON.stringify(v)),_=r.concat(this.selColumns),w={label:"",fixed:"left",width:56,renderHeader:function(t){return i.createElement(i.Fragment,null,i.createElement(G,{type:"checkAll",defaultChecked:y.checked,indeterminate:y.indeterminate,onChange:e.handleCheck,selectedList:I,totalList:a.map((function(e){return e.id}))}),i.createElement("span",{style:{marginLeft:"5px"}},"\u5f53\u9875"))},render:function(t){return i.createElement(G,{type:"checkOne",defaultChecked:t.checked||!1,onChange:e.handleCheck,selectedList:I,totalList:a,uniqueId:t.id})}};_.splice(0,0,w);var O=document.documentElement.clientHeight-46-78-24;return i.createElement("div",{className:"project-connect"},i.createElement(d.Z,{title:(0,p.u)({title:f})}),i.createElement("div",{className:"project-connect-content"},i.createElement("div",{style:{minHeight:O,background:"#fff"}},i.createElement("div",{className:"operator-panel"},i.createElement("div",{className:"search-input"},i.createElement("i",{className:"icon-cem_search icon-style"}),i.createElement(c.Input,{ref:"searchInput",placeholder:"\u8bf7\u8f93\u5165\u5185\u5bb9",onKeyPress:this._handleInputOnKeyUp,icon:g?"circle-cross":"",onIconClick:this._handleOnInputIconClick,onChange:this._handleOnInutChange})),i.createElement("div",{className:"button-zone"},i.createElement(c.Button,{type:"default",onClick:this._handleDeleteByGroup},"\u6279\u91cf\u5220\u9664"),i.createElement(c.Button,{type:"default",onClick:this._handleQuickPick},"\u5feb\u901f\u91c7\u96c6Sku\u94fe\u63a5"),i.createElement(c.Button,{type:"default",onClick:this._handleBatchAdd},"\u6279\u91cf\u4e0a\u4f20\u94fe\u63a5\u4efb\u52a1"),i.createElement(c.Button,{type:"primary",onClick:this.addConnection},"\u65b0\u589e\u94fe\u63a5\u4efb\u52a1"))),i.createElement(C,{className:"mheader",ref:"header",filter:{show:!0,type:"filter",save:!0,projectId:n,filter:["connConfig","source","taskTypes"],selectConfig:h.t.get(h.V.connectionFilter)&&JSON.parse(h.t.get(h.V.connectionFilter)).filterModel?JSON.parse(h.t.get(h.V.connectionFilter)).filterModel:{},showAllConfig:!0,extraConfig:[{id:"ucStatus",list:[{id:"ON_SALE",name:"\u5728\u552e"},{id:"OFF_SALE",name:"\u4e0b\u67b6"}],name:"\u94fe\u63a5\u72b6\u6001",values:E}],onExtraChange:{ucStatus:this._handleOnStatusChange}},confirm:function(){return e.refresh(1)}}),i.createElement("div",{className:"divider"},i.createElement("div",null)),i.createElement("div",{className:"table-zone"},i.createElement(b.Z,{ref:"SelectableColumns",multiSave:{name:"connection_list"},columns:m,getShowColumns:this.getShowColumns}),i.createElement(s.Z,{className:"connection-table",columns:_,data:a||[],total:u,start:o,end:l,pageSize:this.state.pageSize,currentPage:this.state.pageIndex,pageSizeSelectorShow:!0,onPageSizeChange:this.switchPageSize,onPage:this.selPage,onSortChange:this.handleSort,rowClassName:function(e){return v.includes(e.id)?"item-active":""},notLimit:!0})))),i.createElement(N,{ref:"deleDailog",title:"\u5220\u9664\u4efb\u52a1\u63d0\u793a",body:"\u5220\u9664\u8be5\u4efb\u52a1\u540e\uff0c\u8be5\u4efb\u52a1\u63d0\u53d6\u5230\u7684\u6570\u636e\u4e0d\u4f1a\u4fdd\u7559\u5728\u9879\u76ee\u4e2d",onConfirm:this._handleDeleteConfirm,onCancel:function(e,t){}}),i.createElement(B,{ref:"editDialog",onConfirm:this.refresh,onCancel:function(e){},projectId:n,spuList:S,skuList:k}))},(0,r.Z)(t,[{key:"selColumns",get:function(){return this.state.selectMenuItem.filter((function(e){return e.checked}))}}]),t}(i.Component)},1486:(e,t,n)=>{n.d(t,{u:()=>r});var a=n(35239),r=function(e){var t=e.title,n=e.url;return[{title:a.t.get(a.V.backProjectConfig).name,url:"/account/project/preview"},{title:t,url:n}]}},17190:(e,t,n)=>{n.d(t,{Z:()=>p});var a=n(87462),r=n(94578),o=n(67294),i=void 0;const c=function(e){var t=e.data.name,n=e.onCheck,a=e.checked,r=o.useState(a),c=r[0],l=r[1];return o.useEffect((function(){l(a)}),[a]),o.createElement("label",{className:"el-checkbox yt_product_subscribe_editable-radio",onClick:function(e){i=setTimeout((function(){i&&clearTimeout(i);var e=!c;l(e),n(e)}),100)}},o.createElement("input",{value:t,className:"ec-label "+(c?"is_checked":""),title:t,maxLength:6,style:{background:"transparent"}}))};var l=n(92360),s=void 0;const u=function(e){var t=e.keyword,n=e.onCloseClick,a=e.onChange,r=o.useState(t),i=r[0],c=r[1];return o.useEffect((function(){c(t)}),[t]),o.createElement(l.Input,{placeholder:"\u8bf7\u8f93\u5165\u5173\u952e\u5b57",value:i,icon:i&&"close",onIconClick:function(){c(""),n()},onChange:function(e){c(e),s&&clearTimeout(s),s=setTimeout((function(){a(e),s=void 0}),500)}})};const d=function(e){var t=e.className,n=e.onTipClick,a=e.show,r=e.onClick,i=e.onMouseEnter,l=e.onMouseLeave,s=e.addText,d=e.data,p=e.value,m=e.trigger,f=e.defaultValue,h=e.onTagChange,g=e.getTagListRef,v=e.onAddClick,y=e.disabled,E=e.keyword,S=p&&d.find((function(e){return e.id===p}))?d.find((function(e){return e.id===p})).name:f&&d&&d.some((function(e){return e.id===f}))?d&&d.find((function(e){return e.id===f})).name:d&&d.length?"\u8bf7\u9009\u62e9":"\u8bf7\u6dfb\u52a0",k=o.useState(E||""),C=k[0],b=k[1],N=o.useState(d),I=N[0],_=N[1];return o.useEffect((function(){_(d)}),[d]),o.useEffect((function(){var e=C?d.filter((function(e){return e.name.toLowerCase().indexOf(C.toLowerCase())>=0})):d;_(e)}),[C,d]),o.useEffect((function(){E&&b(E)}),[E]),o.createElement("div",{className:"yt_product_setting_edit_input_select_wraper "+t,onClick:"click"===m&&n,onMouseEnter:"hover"===m&&n,onMouseLeave:function(){"hover"===m&&(l(),C&&b(""))}},o.createElement("div",null,o.createElement("div",{className:"ets-trigger",onClick:function(){"click"===m&&(r(),C&&b(""))},onMouseEnter:function(){"hover"===m&&!a&&i()}},o.createElement("span",{className:"ets-trigger-title",style:{color:p||!d||d.find((function(e){return e.id===p}))||f?"#262626":"#bfbfbf"}},S),o.createElement("i",{className:"icon-cem_pull-down-or-take-up",style:{transform:a?"rotate(-180deg)":""}})),o.createElement("div",{className:"ets-option-panel "+(a?"ets-show":""),onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},o.createElement("div",{className:"ets-list",ref:g},d&&d.length>0?o.createElement(o.Fragment,null,o.createElement("div",{style:{maxHeight:260}},o.createElement("div",{className:"ets-search"},o.createElement(u,{keyword:C,onChange:b,onCloseClick:function(){return b("")}})),o.createElement("div",{className:"ets-list-content"},I&&I.length>0?o.createElement(o.Fragment,null,I.slice(0,100).map((function(e){return o.createElement(c,{key:e.id,data:e,checked:p===e.id,onCheck:function(){return e.id?h({id:e.id,name:e.name,split:e.split}):h({name:e.name,split:e.split})}})})),I.length>99&&o.createElement("div",{style:{color:"#d96969",paddingLeft:"18px",fontSize:"12px"}},"\u2014 \u67e5\u770b\u66f4\u591a\u8bf7\u641c\u7d22")):o.createElement("div",{className:"no_data"},"\u6682\u65e0\u6570\u636e")))):o.createElement("div",{className:"no_data"},"\u6682\u65e0\u6570\u636e")),o.createElement("div",{className:"ets-add"},o.createElement("div",{className:"ets-add-diviver"}),o.createElement("div",{className:"add_btn "+(y?"add_disabled_btn":""),onClick:function(){y||(v(),C&&b(""),"click"===m?r():i())}},s)))))};const p=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnTagChange=function(e){n.props.onChange(e),n._setPadShowFalse()},n._setPadShowFalse=function(){n.state.show&&n.setState({show:!1})},n._setPadShowTrue=function(){!n.state.show&&n.setState({show:!0})},n._handleOnMouseEnter=function(){var e=n.state.show;setTimeout((function(){n.setState({show:!e})}),0)},n._handleOnClick=function(e){var t=n.state.show;setTimeout((function(){n.setState({show:!t})}),0)},n.tagListRef=void 0,n.state={show:!1},n.event={onClick:n._handleOnClick,onMouseEnter:n._handleOnMouseEnter,onMouseLeave:n._setPadShowFalse,onTagChange:n._handleOnTagChange,getTagListRef:function(e){return n.tagListRef=e}},n}(0,r.Z)(t,e);var n=t.prototype;return n.UNSAFE_componentWillReceiveProps=function(e){e.show!==this.props.show&&this._setPadShowTrue()},n.componentDidMount=function(){window.addEventListener("click",this._setPadShowFalse)},n.componentWillUnmount=function(){window.addEventListener("click",this._setPadShowFalse)},n.render=function(){return o.createElement(d,(0,a.Z)({},this.props,this.state,this.event))},t}(o.PureComponent)},68003:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(94578),r=n(67294),o=n(78436),i=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).buildChart=function(){var e=t.props.data;e&&e.length||(e=[]);var n=[];e.forEach((function(e){(!n.length||n[n.length-1]!==e)&&n.push(e)})),1===n.length?n.push(n[0]):0===n.length&&(n=[1,1]);var a=n.map((function(e,t){return[""+t,""+e]})),r={animation:!1,color:["#0747A6"],grid:{left:5,right:5,bottom:0,top:0,containLabel:!1},xAxis:[{show:!1,type:"category",data:a.map((function(e){return e[0]}))}],yAxis:[{show:!1,type:"category",data:n.sort((function(e,t){return e-t})).map((function(e){return""+e}))}],series:[{name:"",type:"line",step:"middle",data:a}]};t.refs.chart.setOption(r)},t}(0,a.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.width=this.refs.widget.offsetWidth,this.height=this.refs.widget.offsetHeight,this.buildChart()},n.shouldComponentUpdate=function(e,t){return JSON.stringify(e)!==JSON.stringify(this.props)},n.componentDidUpdate=function(){this.buildChart()},n.render=function(){var e=this.props.data;return r.createElement("div",{ref:"widget",className:"widget-container widget-container-wrap"},r.createElement("div",{className:"widget-body "+(e&&e.length?"middle_line":"line")},r.createElement(o.Z,{ref:"chart",className:"widget-chart",minHeight:22})))},t}(r.Component)},55815:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(94578),r=n(67294),o=n(45697),i=n.n(o),c=n(43036),l=n(61409),s=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props,a=n.title,r=n.beforeJump;e!==a.length-1&&(r?new Promise((function(e,t){return r(e,t)})).then((function(){l.mW.push({pathname:a[e].url,state:a[e].state})})):l.mW.push({pathname:a[e].url,state:a[e].state}))},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.mainTitle,o=t.rightContent,i=t.className,l=t.overlay;return r.createElement("div",{className:"breadcumb-wrapper "+i},n instanceof Array?r.createElement("div",{className:"breadcrumb-left"},r.createElement("div",null,n.map((function(t,a){return r.createElement("span",{className:t.url?"":"not_clickable",key:a,onClick:function(){return t.url&&a!==n.length-1&&e._handleBreadcrumbClick(a)}},t.title,a!==n.length-1&&" / ")}))),r.createElement("span",null,a||n[n.length-1].title,l&&r.createElement(c.Z,{placement:"top",overlay:l},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}})))):r.createElement("div",{className:"normal-title"},n,l&&r.createElement(c.Z,{placement:"top",overlay:l},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}}))),o||"")},t}(r.Component);s.propTypes={className:i().string,title:i().oneOfType([i().string,i().arrayOf(i().shape({title:i().string,url:i().string,state:i().object}))]).isRequired,overlay:i().oneOfType([i().string,i().node]),mainTitle:i().oneOfType([i().string,i().node]),beforeJump:i().func,rightContent:i().node};const u=s},26687:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(87462),r=n(94578),o=n(67294),i=n(85151),c=n(35239),l=function(e){function t(t){var n;return(n=e.call(this,t)||this).openMenu=function(){n.setState({menuState:!n.state.menuState})},n.onChange=function(e){var t,a=n.props,r=a.columns,o=a.getShowColumns,i=a.multiSave;r&&r[e]&&((t=r.slice(0))[e].checked=!t[e].checked);var l=i?i.name:"",s=c.t.get(c.V.storageColumns)?c.t.get(c.V.storageColumns):{};s[l]=t,c.t.set(c.V.storageColumns,s),o&&o(t),n.resize(),n.setState({columns:t})},n.competeSelectMenuItem=function(e){var t=n.props.multiSave,a=t?t.name:"",r=n.props.columns,i=c.t.get(c.V.storageColumns)?c.t.get(c.V.storageColumns)[a]:[];if(i&&0!==i.length)"price_check"===a?i.map((function(e,t){return e.render=r.filter((function(t){return t.label===e.label})).length>0?r.filter((function(t){return t.label===e.label}))[0].render:function(t,n,a){return o.createElement("span",null,t[e.prop])}})):i.map((function(e,t){return e.render=function(e,n,a){return o.createElement("span",null,e.configDetails[t]&&e.configDetails[t].topicValue)}})),r=i.slice(0);else if(e&&e.every((function(e){return e.label&&e.prop})))r=e;else{var l=[];e&&e.forEach((function(e,t){l.push({label:e.topicTypeValue,checked:!1,render:function(e,n,a){return o.createElement("span",null,e.configDetails[t].topicValue)}})})),r=l.slice(0)}return n.setState({columns:r}),r},n.resize=function(){var e=document.querySelector(".connection-table .is-sortable");if(e){var t=n.getStyle(e,"width"),a=document.body.offsetWidth,r=n.state.columns;if(a>800&&r.length>2&&parseInt(t)<275)for(var o=0;o<r.length-2;o++)if(r[o].checked)return void n.onChange(o)}},n.close=function(e){n.state.menuState&&n.setState({menuState:!1})},n.state={menuState:!1,multiSave:null,columns:t.columns.map((function(e){return!e.checked&&(e.checked=!1),e}))},n}(0,r.Z)(t,e);var n=t.prototype;return n.UNSAFE_componentWillReceiveProps=function(e){this.setState((0,a.Z)({},e))},n.getStyle=function(e,t){return e.style[t]?e.style[t]:e.currentStyle?e.currentStyle[t]:getComputedStyle(e,null)[t]},n.componentDidMount=function(){window.addEventListener("click",this.close),window.addEventListener("resize",this.resize,!1)},n.componentWillUnmount=function(){window.removeEventListener("resize",this.resize,!1),window.removeEventListener("click",this.close)},n.render=function(){var e=this,t=this.state.columns;return o.createElement("div",{className:"menu-wrapper",onClick:function(e){e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()}},o.createElement("span",{className:"el-dropdown-link "+(this.state.menuState?"sel":""),onClick:this.openMenu},"\u5217",o.createElement("i",{className:"icon-cem_pull-down-or-take-up",style:{transform:this.state.menuState?"rotate(-180deg)":""}})),this.state.menuState&&o.createElement("div",{className:"menuList"},o.createElement("ul",null,0===t.length?o.createElement("li",{style:{color:"#8c8c8c"}},"\u65e0\u53ef\u9009\u62e9\u5185\u5bb9"):t.map((function(t,n){return o.createElement("li",{key:n},o.createElement(i.Jg,{key:n,value:t.label,checked:t.checked,onChange:e.onChange.bind(e,n),block:!0},t.label))})))))},t}(o.Component)},91438:(e,t,n)=>{n.r(t),n.d(t,{default:()=>k});var a=n(87462),r=n(94578),o=n(67294),i=n(91751),c=n(82784),l=n.n(c),s=n(30381),u=n.n(s),d=n(5133);const p={setStorage:function(e,t){var n=e||"cem-msg";localStorage.setItem(n,JSON.stringify(t))},getStorage:function(e){var t=e||"cem-time-msg",n=JSON.parse(localStorage.getItem(t))||{};return Object.keys(n).length<=0&&(n.value=[u()().subtract(90,"days").format("YYYY-MM-DD"),u()().startOf("day").format("YYYY-MM-DD")],n.groupBy="MONTH",n.current=9),n}};var m=n(94184),f=n.n(m);n(83839),n(22243);u().locale("zh-cn");var h="YYYY-MM-DD",g=function(e){return e?e.format(h):""},v={"\u6628\u5929":0,"\u4e0a\u5468":1,"\u4eca\u5929":2,"\u672c\u5468":3,"\u8fd17\u5929":4,"\u4e0a\u6708":5,"\u8fd130\u5929":6,"\u672c\u6708":7,"\u8fd190\u5929":8,"\u81ea\u5b9a\u4e49":9},y={"\u65f6":"HOUR","\u5929":"DAY","\u5468":"WEEK","\u6708":"MONTH"},E=function(e){switch(e){case 0:return[u()().subtract(1,"days"),u()().subtract(1,"days")];case 1:return[u()().subtract(1,"weeks").startOf("week"),u()().subtract(1,"weeks").endOf("week")];case 2:return[u()().startOf("day"),u()()];case 3:return[u()().startOf("week"),u()()];case 4:return[u()().subtract(6,"days"),u()().startOf("day")];case 5:return[u()().subtract(1,"months").startOf("month"),u()().subtract(1,"months").endOf("month")];case 6:return[u()().subtract(29,"days"),u()().startOf("day")];case 7:return[u()().startOf("month"),u()()];default:return[u()().subtract(89,"days"),u()().startOf("day")]}},S=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).state={showLeft:!0,value:[u()(g(E(t.props.current)[0])),u()(g(E(t.props.current)[1]))],currentType:0==t.props.current?0:t.props.current||9,currentGroup:t.props.groupBy||"DAY",hoverValue:[],inputVal:[]},t.handleToggle=function(e){t.setState({showLeft:!t.state.showLeft})},t.onStandaloneSelect=function(e,n){var a=t.state.value;if(a[e]=n,!(a[1].diff(a[0],"days")<0)){t.setState({value:a,inputVal:[g(a[0]),g(a[1])]});var r=t.fixedGroup(a);t.setState({currentGroup:r,currentType:v["\u81ea\u5b9a\u4e49"]}),Object.keys(v).map((function(e,n){var r=E(v[e]);g(a[0])===g(r[0])&&g(a[1])===g(r[1])&&t.setState({currentType:v[e]})}))}},t.onStartChange=function(e){t.onStandaloneSelect(0,e)},t.onEndChange=function(e){t.onStandaloneSelect(1,e)},t.setDateGroup=function(e){t.setState({currentGroup:e})},t.disabledStartDate=function(e){var n=t.state.value[1];return!(!e||!n)&&n.diff(e,"days")<0},t.disabledEndDate=function(e){var n=t.state.value[0];return!(!e||!n)&&e.diff(n,"days")<0},t.fixedGroup=function(e){var t=u().duration(e[1]-e[0]).asDays();switch(!0){case t<=1:return"HOUR";case t<30:return"DAY";case t>=30:return"MONTH";default:return"HOUR"}},t.setQuickTime=function(e,n){if(9!==e){var a=E(e);t.setState({value:a,currentType:e,currentGroup:t.fixedGroup(a)},(function(e){n&&n()}))}else t.setState({currentType:e,inputVal:[g(t.state.value[0]),g(t.state.value[1])]})},t.inputStart=function(e){var n=t.state.inputVal;n[0]=e.currentTarget.value,t.setState({inputVal:n})},t.inputEnd=function(e){var n=t.state.inputVal;n[1]=e.currentTarget.value,t.setState({inputVal:n})},t.apply=function(e,n){t.props.onceShow&&p.setStorage("cem-time-"+t.props.onceShow,"");var a=t.state,r=a.value,o=a.inputVal,i=a.currentType,c=a.currentGroup,l=t.props,s=l.timeConfirm,m=(l.style,l.handlePanel);if(9===i){var f=u()(o[0]),h=u()(o[1]);if(!f.isValid()||!h.isValid())return void d.Z.error("\u975e\u6cd5\u8f93\u5165");if(h.diff(f,"days")<0)return void d.Z.error("\u975e\u6cd5\u8f93\u5165");t.setState({value:[f,h]},(function(e){return s([g(t.state.value[0]),g(t.state.value[1])],c,i)}))}else s([g(r[0]),g(r[1])],c,i);!n&&m(e)},t}return(0,r.Z)(t,e),t.prototype.render=function(){var e=this,t=this.state,n=t.showLeft,r=t.inputVal,c=t.value,s=t.currentType,u=t.currentGroup,d=this.props,p=d.style,m=d.group,E=d.onClick,S=f()("filter-date-input-from","fake-textarea",{disabled:9!==s}),k=[];return!r||r.length<2?(k.push(g(c[0])),k.push(g(c[1]))):(k.push(r[0]),k.push(r[1])),o.createElement("div",{className:"time-setting-panel",onClick:E,style:(0,a.Z)({width:n?"772px":"260px"},p)},o.createElement("div",{className:"left-panel",style:{display:n?"inline-block":"none"}},o.createElement(i.Z,{format:h,locale:l(),showDateInput:!1,showOk:!1,value:c[0],disabledDate:this.disabledStartDate,onChange:this.onStartChange}),o.createElement(i.Z,{format:h,showDateInput:!1,locale:l(),showOk:!1,value:c[1],disabledDate:this.disabledEndDate,onChange:this.onEndChange}),m&&o.createElement("div",{className:"date-group"},"\u65f6\u95f4\u5206\u7ec4\uff1a",y&&Object.keys(y).map((function(t,n){return o.createElement("li",{key:n,className:y[t]===u?"quick-btn active":"quick-btn",onClick:function(n){return e.setDateGroup(y[t])}},o.createElement("span",null,t))})))),o.createElement("div",{className:"quick-setting-panel"},o.createElement("ul",null,v&&Object.keys(v).map((function(t,n){return o.createElement("li",{key:n,className:n===s?"quick-btn active":"quick-btn",onClick:function(n){return e.setQuickTime(v[t])}},o.createElement("span",null,t))}))),o.createElement("div",{className:"left-panel-toggle quick-btn",onClick:this.handleToggle},o.createElement("span",null,n?"\u2190 \u6536\u8d77":"\u2192 \u5c55\u5f00")),9===s?o.createElement("div",{className:"filter-date-input"},o.createElement("input",{className:S,value:k[0],onChange:this.inputStart}),o.createElement("div",{className:"device"},"-"),o.createElement("input",{className:S,value:k[1],onChange:this.inputEnd})):o.createElement("div",{className:"filter-date-input"},o.createElement("input",{className:S,readOnly:!0,value:g(c[0])}),o.createElement("div",{className:"device"},"-"),o.createElement("input",{className:S,readOnly:!0,value:g(c[1])})),o.createElement("div",{className:"apply-btn",onClick:function(t){return e.apply(t)}},"\u5e94\u7528")))},t}(o.Component),k=function(e){function t(t){var n;(n=e.call(this,t)||this).state={show:!1,value:["2018-01-01","2018-08-01"],current:9,groupBy:"MONTH"},n.handlePanel=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),n.setState({show:!n.state.show})},n.stopPop=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},n.timeConfirm=function(e,t,a){n.setState({value:e,groupBy:t,current:a},(function(){p.setStorage("cem-time-"+n.props.model,n.state),n.props.confirm&&n.props.confirm()}))},n.state=p.getStorage("cem-time-"+(n.props.onceShow?n.props.onceShow:n.props.model))||{},n.state.value=n.state.value||n.state.dateRange;var a=n.state.current;if(a<9){var r=E(a);n.state.value=[g(r[0]),g(r[1])]}return n.state=Object.assign({show:!1,value:["2018-01-01","2018-08-01"],current:9,groupBy:"MONTH"},n.state),n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;this.oneHandler=function(){e.setState({show:!1})},document.addEventListener("click",this.oneHandler)},n.componentWillUnmount=function(){document.removeEventListener("click",this.oneHandler)},n.getParams=function(){var e=this.state,t=e.value,n=e.groupBy;return{from:t[0],to:t[1],dateGroupType:n,remoteName:"cTime"}},n.render=function(){var e=this,t=this.props.group,n=this.state,a=n.value,r=n.current,i=n.groupBy;return o.createElement("div",{className:"date-wrap"},o.createElement("div",null,o.createElement("div",{className:"date-filter filter-box",onClick:function(t){return e.handlePanel(t)}},o.createElement("div",null,o.createElement("span",null,a[0].replace(/-/g,"/"))," -",o.createElement("span",null,a[1].replace(/-/g,"/"))),9!==this.state.current&&o.createElement("div",{className:"date-day-info"},Object.keys(v).filter((function(t){return v[t]===e.state.current}))[0]),o.createElement("i",{className:"icon-cem_time-controller"})),o.createElement(S,{ref:"picker",timeConfirm:function(t,n,a){return e.timeConfirm(t,n,a)},value:a,handlePanel:function(t){return e.handlePanel(t)},onClick:this.stopPop,current:r,groupBy:i,group:t,style:{display:this.state.show?"block":"none"}})))},t}(o.Component)}}]);