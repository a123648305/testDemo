(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[8011],{76180:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-459a43"},78436:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});var t=a(85354),i=a.n(t),t=a(67294),r=a.n(t),l=a(94644),n=function(e){function t(){var r=e.call(this)||this;return r.isEmpty=!0,r.group=function(e){r.myChart.group=e,r.echarts.connect(e)},r.refreshChart=function(e){r.setState(e)},r.setWidth=function(e){r.refs.chart.style.width=e,r.init()},r.loading=function(){r.myChart.clear(),r.myChart.showLoading({text:"拼命加载中",color:"#20a0ff",maskColor:"rgba(255, 255, 255, 0.9)",zlevel:0})},r.setOption=function(e){if(e.textStyle={fontFamily:"'PingFang SC','Microsoft Yahei', 'Helvetica Neue', Helvetica, Tahoma, Arial, 'Hiragino Sans GB', 'WenQuanYi Micro Hei', sans-serif"},e.legend&&(e.legend.data=e.legend.data.map(function(e){return{name:e,icon:"circle"}}),e.legend.itemWidth=10,e.legend.itemHeight=10),e.tooltip&&!e.tooltip.extraCssText?(e.tooltip.backgroundColor="rgba(255,255,255,0.9)",e.tooltip.textStyle={color:"#262626"},e.tooltip.extraCssText="box-shadow: 0 0 7px rgba(0, 0, 0, 0.3);"):e.tooltip&&(e.tooltip=e.tooltip),e.series.forEach(function(e){"line"===e.type&&(e.showAllSymbol=!0,e.symbol="circle",e.symbolSize=2,e.itemStyle={normal:{borderColor:"rgba(255,255,255,0)",borderWidth:5}})}),e.hoverLayerThreshold=500,e.progressiveThreshold=500,e.animationThreshold=500,r.myChart){var t;r.myChart.clear(),r.myChart.hideLoading();for(var n=arguments.length,a=new Array(1<n?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];(t=r.myChart).setOption.apply(t,[e].concat(a)),r.isEmpty=!1}},r.setEmptyOption=function(e){var t=r.myChart.getHeight(),n=r.myChart.getWidth(),n=Math.min(t/2,n/2,20),n={type:"pie",radius:[0,0],center:["50%","50%"],silent:!0,data:[{value:0,name:"",label:{normal:{show:!0,position:"center",backgroundColor:{image:a(76180)},padding:n,formatter:function(){return""}}}},{value:0,name:"",label:{normal:{show:!0,position:"center",formatter:function(){return"{a|\n}{b|"+e+"}"},rich:{a:{height:n+60},b:{fontSize:20,color:"#999"}}}}}]};r.myChart&&(r.myChart.clear(),r.myChart.hideLoading(),r.myChart.setOption({series:n,animation:!1},!0),r.isEmpty=!0)},r.init=function(){r.echarts.getInstanceByDom(r.refs.chart)&&r.echarts.dispose(r.refs.chart);var e=r.echarts.init(r.refs.chart);r.myChart=e,r.props.myChartClick&&e.on("click",function(e){r.isEmpty||r.props.myChartClick(e)}),r.props.dataZoomChange&&e.on("dataZoom",function(e){r.isEmpty||r.props.dataZoomChange(e)})},r.downloadExcel=function(e,t){(0,l.aT)([[t].concat(e)],"")},r.echarts=a(70596),r}i()(t,e);var n=t.prototype;return n.componentDidMount=function(){this.init()},n.componentWillUnmount=function(){this.myChart.dispose()},n.render=function(){var e=this.props.minHeight,e=Object.assign({},e?{minHeight:e}:{});return r().createElement("div",{ref:"chart",className:"widget-chart",style:e})},t}(t.Component)},98011:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>O});var t=n(67294),g=n.n(t),t=n(48926),a=n.n(t),t=n(67154),f=n.n(t),t=n(85354),r=n.n(t),t=n(19155),i=n.n(t),t=n(44908),l=n.n(t),t=n(87757),c=n.n(t),y=n(43036),k=(n(76405),n(69843)),v=(n(15144),n(2307)),t=n(37316),w=n.n(t),t=n(93913),o=n.n(t),t=function(i){function e(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=i.call.apply(i,[this].concat(n))||this).formatColumns=function(e){return e.filter(function(e){return e&&!e.disable}).map(function(e){return(e=f()({},e)).align=e.align||"center",e.timestamp&&!e.render&&(e.render=function(e){return g().createElement("span",null,e)}),e.ellipsis&&!e.render&&(e.render=function(e){return g().createElement("span",null,(e=e)?Array.isArray(e)?e.join(","):"string"==typeof e?e:String(e):"")}),e})},e}return r()(e,i),e.prototype.render=function(){var e,n=this,t=this.props,a=t.topArea,i=t.bottomArea,r=(t.showPagination,t.dataSource),l=t.listSummary,c=l.current,o=l.pageSize,s=l.total,d=t.rowKey,u=t.rowSelection,m=t.columns,p=t.scroll,h=t.loading,l=t.style,t=w()(t,["topArea","bottomArea","showPagination","dataSource","listSummary","rowKey","rowSelection","columns","scroll","loading","style"]);return g().createElement("div",{className:"y-table-warp"},a?g().createElement("div",{className:"y-table-header"},a):null,g().createElement("div",{className:"y-table-body flex h-full",style:l},g().createElement(v.Z,f()({pagination:!1,className:"y-table w-full",rowSelection:u,dataSource:r,rowKey:d,scroll:p,loading:null!=h?{spinning:!!h,tip:"拼命加载中..."}:void 0,columns:this.formatColumns(m)},t))),0<(null==r?void 0:r.length)&&g().createElement("div",{className:"y-table-footer"},g().createElement("div",{className:"flex flex-1"},0<s&&g().createElement("span",{className:"mr-15 color-tip"},g().createElement("i",{className:"color-title"},this.startCount," - ",this.endCount),"项，共 ",g().createElement("i",{className:"color-title"},s)," 项",u?g().createElement(g().Fragment,null,"，已选择",g().createElement("i",{className:"color-title"},u.isSelectAll?s:(null==u||null==(e=u.selectedRowKeys)?void 0:e.length)||0),"项"):null),i),g().createElement(k.default,{className:"y-pagination",showQuickJumper:!1,pageSizeOptions:["10","20","40","100"],showSizeChanger:!1,size:"small",current:c,pageSize:o,total:s,onChange:function(e,t){n.props.onPaginationChange&&n.props.onPaginationChange(e,t||o)}})))},o()(e,[{key:"startCount",get:function(){var e=this.props.listSummary;return(e.current-1)*e.pageSize+1}},{key:"endCount",get:function(){var e=this.props.listSummary,t=e.current,n=e.pageSize,e=e.total,n=t*n;return e<n?e:n}}]),e}(g().PureComponent);t.defaultProps={size:"small",rowKey:"id",showPagination:!0,listSummary:{current:1,pageSize:10,total:0},dataSource:[]};const E=t;var C=n(19586),s=n(68003),b=n(60496),S=n(92360),u=n(5133),x=n(61193),m=n(38425),p=n(36144),N=n(23942),h=n(35239),P=n(21694),T=n(6637),t=n(30381),d=n.n(t),t=function(e){return g().createElement("div",{style:{maxWidth:300}},e)};var _={"趋势":{title:g().createElement("span",null,"趋势",g().createElement(y.Z,{overlay:"12小时内价格变化结果",placement:"top"},g().createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c"}}))),dataindex:"flag",width:58,fixed:"left",align:"left",sorter:!1,render:function(e){var t=0===e.flag?"icon-cem_line":2===e.flag?"icon-cem_three-states-down":"icon-cem_three-states-up",e=0===e.flag?"#BFBFBF":2===e.flag?"#D96969":"#15B374";return g().createElement("i",{className:t,style:{color:e,fontSize:20}})}},"商品标题":{title:"商品标题",dataindex:"title",width:227,align:"left",sorter:!0,render:function(t){return g().createElement("div",{className:"ellipisis highlight",style:{maxWidth:230},title:t.title,onClick:function(e){e.stopPropagation(),e=t,e=t.url,window.open(e,"_blank")}},t.title)}},"更新状态":{title:"更新状态",dataindex:"realtimePriceStatus",width:90,align:"left",render:function(t){var e=P.Se.find(function(e){return t.realtimePriceStatus===e.value});return g().createElement("div",{className:"ellipisis"},(null==e?void 0:e.title)||"未知")}},"数据更新时间":{title:"数据更新时间",dataindex:"ctime",align:"left",width:100,render:function(e){return g().createElement("div",{className:"ellipisis"},e.ctime?d()(e.ctime).format("YYYY/MM/DD HH:mm"):"")}},"单品到手价":{title:g().createElement("span",null,"单品到手价",g().createElement(y.Z,{overlay:t("只购买1件单品就能获得优惠对应的到手价。"),placement:"top"},g().createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c"}}))),dataindex:"takePrice",width:120,sorter:!0,align:"left",render:function(e){return g().createElement("div",{className:"ellipisis",style:{maxWidth:56}},0<=e.takePrice?e.takePrice:"已下架")}},"单品到手价今日最低":{title:"单品到手价今日最低",dataindex:"minTakePrice",width:162,sorter:!0,align:"left",render:function(e){return g().createElement("div",{className:"ellipisis",style:{maxWidth:56}},0<=e.takePrice?e.minTakePrice:"已下架")}},"单品拼单价":{title:g().createElement("span",null,"单品拼单价",g().createElement(y.Z,{overlay:t("购买多件单品时能够获得的最大优惠对应的到手价。其中，最大优惠按单品的挂牌价分摊。"),placement:"top"},g().createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c"}}))),dataindex:"groupTakePrice",width:100,align:"left",render:function(e){return g().createElement("div",{className:"ellipisis",style:{maxWidth:56}},0<=e.takePrice?e.groupTakePrice:"已下架")}},"单品拼单价今日最低":{title:"单品拼单价今日最低",dataindex:"minGroupTakePrice",align:"left",width:130,render:function(e){return g().createElement("div",{className:"ellipisis",style:{maxWidth:56}},0<=e.takePrice?e.minGroupTakePrice:"已下架")}},"完美拼单价":{title:g().createElement("span",null,"完美拼单价",g().createElement(y.Z,{overlay:t("在平台券和店铺券等基础上，与其他商品进行拼单时能够获得的最大优惠对应的到手价。其中，最大优惠按单品的挂牌价分摊。"),placement:"top"},g().createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c"}}))),dataindex:"perfectGroupTakePrice",align:"left",width:100,render:function(e){return g().createElement("div",{className:"ellipisis",style:{maxWidth:56}},0<=e.takePrice?e.perfectGroupTakePrice:"已下架")}},"完美拼单价今日最低":{title:"完美拼单价今日最低",dataindex:"minPerfectGroupTakePrice",align:"left",width:130,render:function(e){return g().createElement("div",{className:"ellipisis",style:{maxWidth:56}},0<=e.takePrice?e.minPerfectGroupTakePrice:"已下架")}},"今日最低":{title:g().createElement("span",null,"今日最低",g().createElement(y.Z,{overlay:"当天「单品到手价」、「单品拼单价」和「完美拼单价」三个中最低的价格。",placement:"top"},g().createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c"}}))),dataindex:"minPrice",align:"left",width:105,sorter:!0,render:function(e){return g().createElement("div",{className:"ellipisis",style:{maxWidth:56}},!(e.takePrice<0)&&0<=e.minPrice?e.minPrice:"已下架")}},"挂牌价":{title:g().createElement("span",null,"挂牌价",g().createElement(y.Z,{overlay:t("在各电商平台显示的价格，如京东的“京东价”、天猫聚划算的“价格”，即不包含促销优惠的价格，取的是实时价格。"),placement:"top"},g().createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c"}}))),dataindex:"listPrice",align:"left",width:93,sorter:!0,render:function(e){return g().createElement("div",{className:"ellipisis",style:{maxWidth:56}},0<=e.listPrice?e.listPrice:"已下架")}},"单品优惠券":{title:"单品优惠券",dataindex:"skuQuan",width:73,align:"left",render:function(e){return g().createElement("div",{className:"ellipisis",style:{maxWidth:84}},e.skuQuan&&g().createElement(y.Z,{placement:"topLeft",overlay:JSON.parse(e.skuQuan).map(function(e,t){return g().createElement("span",{key:t},e,g().createElement("br",null))})},g().createElement("span",null,JSON.parse(e.skuQuan).map(function(e,t){return g().createElement("span",{key:t},e," ")}))))}},"店铺优惠券":{title:"店铺优惠券",dataindex:"storeQuan",align:"left",width:87,render:function(e){return g().createElement("div",{className:"ellipisis",style:{maxWidth:84}},e.storeQuan&&g().createElement(y.Z,{placement:"topLeft",overlay:JSON.parse(e.storeQuan).map(function(e,t){return g().createElement("span",{key:t},e,g().createElement("br",null))})},g().createElement("span",null,JSON.parse(e.storeQuan).map(function(e,t){return g().createElement("span",{key:t},e," ")}))))}},"行业优惠券":{title:"行业优惠券",dataindex:"industryQuan",align:"left",width:87,render:function(e){return g().createElement("div",{className:"ellipisis",style:{maxWidth:84}},e.industryQuan&&g().createElement(y.Z,{placement:"topLeft",overlay:JSON.parse(e.industryQuan).map(function(e,t){return g().createElement("span",{key:t},e,g().createElement("br",null))})},g().createElement("span",null,JSON.parse(e.industryQuan).map(function(e,t){return g().createElement("span",{key:t},e," ")}))))}},"下架/缺货":{title:"下架/缺货",dataindex:"stock",sorter:!1,align:"left",width:87,render:function(e){return g().createElement("div",{className:"ellipisis",style:{maxWidth:84}},0<=e.takePrice?e.noStockCityList&&0<e.noStockCityList.length?g().createElement(y.Z,{placement:"top",overlay:e.noStockCityList.join("").concat("缺货")},g().createElement("span",null,e.noStockCityList.join("").concat("缺货"))):g().createElement("span",null,g().createElement("i",{className:"icon-cem_line",style:{color:"#BFBFBF",fontSize:20}})):"已下架")}},"趋势图":{title:"趋势图",width:103,align:"left",key:"chart",fixed:"right",sorter:!1,render:function(e,t,n){if(!e.data)return null;var a=e.data;return g().createElement("div",{style:{width:"100%",height:"22px"}},g().createElement(s.Z,{index:n,key:e.userConnectionId,data:a}))}},"满减":{title:"满减",dataindex:"trueReductionValue",width:73,align:"left"},"赠品":{title:"赠品",align:"left",dataindex:"gift",width:73,render:function(e){return g().createElement("div",{className:"ellipisis",title:e.gift,style:{maxWidth:70}},e.gift)}},"免息最长分期":{title:"免息最长分期",dataindex:"freeByStages",width:100,align:"left"},"定金":{title:"定金",dataindex:"deposit",width:73,align:"left"},"预定数量":{title:"预定数量",dataindex:"orderAmount",align:"left",width:73},"淘宝掌柜":{title:"淘宝掌柜",dataindex:"sellerNick",align:"left",width:83,render:function(e){return g().createElement("div",{className:"ellipisis",title:e.sellerNick,style:{maxWidth:80}},""!==e.sellerNick?e.sellerNick:"-")}},"优惠合计":{title:"优惠合计",dataindex:"rateCount",align:"left",width:73},"采纳优惠策略":{title:"采纳优惠策略",dataindex:"trueRate",align:"left",width:100,render:function(e){return g().createElement(y.Z,{overlay:g().createElement("div",{style:{maxWidth:260,wordBreak:"break-all"}},e.trueRate),placement:"top"},g().createElement("p",{className:"slogan"},e.trueRate))}},"优惠政策":{title:"优惠政策",dataindex:"rate",width:73,align:"left",render:function(e){return g().createElement(y.Z,{overlay:g().createElement("div",{style:{maxWidth:260,wordBreak:"break-all"}},e.rate),placement:"top"},g().createElement("p",{className:"slogan"},e.rate))}},"商品副标题":{title:"商品副标题",dataindex:"slogan",align:"left",width:86,render:function(e){return g().createElement(y.Z,{overlay:g().createElement("div",{style:{maxWidth:260,wordBreak:"break-all"}},e.slogan),placement:"top"},g().createElement("p",{className:"slogan"},e.slogan))}},SKU:{title:"SKU",dataindex:"sku",width:73,align:"left",render:function(e){return g().createElement(y.Z,{overlay:g().createElement("div",{style:{maxWidth:260,wordBreak:"break-all"}},e.sku),placement:"top"},g().createElement("p",{className:"slogan"},e.sku))}},"商品链接":{title:"商品链接",dataindex:"url",width:83,align:"left",ellipsis:"true",render:function(e){return g().createElement(y.Z,{overlay:g().createElement("div",{style:{maxWidth:260,wordBreak:"break-all"}},e.url),placement:"top"},g().createElement("p",{className:"slogan"},e.url))}},"优惠券金额":{title:"优惠券金额",dataindex:"trueCouponValue",width:100,align:"left"},"日期":{title:"日期",align:"left",dataindex:"ctime",width:103,render:function(e){return e.ctime?d()(e.ctime).format("YYYY-MM-DD"):""}}},A=function(t){function e(e){var d=t.call(this,e)||this;d.filter=null,d.getPriceList=function(){var e,t=d.state,n=t.sortAttr,a=t.sortType,i=t.type,r=t.pageIndex,l=t.pageSize,c=t.updateTime,o=t.updateStatus,s=h.t.get(h.V.curProject).id;s&&(e=d.filter.getValue(),d.setState({loading:!0},function(){p.h.post("/price/list",f()({type:i,id:s},e,{pageIndex:r,pageSize:l,sortAttr:n,sortType:a,realtimePriceTimeRange:c,realtimePriceStatus:o})).then(function(e){e=e.data.result;d.setState({data:e.result,from:0===e.from?1:e.from,to:e.to,count:e.count,sortAttr:n,sortType:a,loading:!1,selectedRowKeys:d.state.selectedAll?e.result.map(function(e){return e.userConnectionId}):d.state.selectedRowKeys,selectedRows:d.state.selectedAll?e.result:d.state.selectedRows},function(){var e=d.state.data;e&&0<e.length&&(d.getPriceTrend(),d.getStockInfo())})})}))},d.getPriceTrend=function(){var e=d.state.data;p.h.post("/price/bar/list",{userConnectionIds:e.map(function(e){return e.userConnectionId})}).then(function(n){e.forEach(function(t){var e=n.data.result.filter(function(e){return e.id===t.userConnectionId});e&&e.length&&(t.data=e[0].list.map(function(e){return e.takePrice}))}),d.setState({data:e})})},d.getStockInfo=function(){var e=h.t.get(h.V.curProject).id,t=d.state.data;p.h.post("/stock/list",{projectId:e,userConnectionIds:t.map(function(e){return e.userConnectionId})}).then(function(r){r.data.result&&0<r.data.result.length&&(t.forEach(function(t){t.noStockCityList=[];var e=r.data.result.filter(function(e){return e.userConnectionId===t.userConnectionId});if(e&&0<e.length)for(var n=e[0].cityStockModels.filter(function(e){return"无货"===e.stockState}).map(function(e){return e.city}),a=0;a<n.length;a++)for(var i=0;i<P.Q1.length;i++)P.Q1[i].fullName===n[a]&&t.noStockCityList.push(P.Q1[i].simplifiedName)}),d.setState({data:t}))})},d.handleSort=function(e,t,n,a){var i="ascend"===n.order?-1:"descend"===n.order?1:"";d.setState({sortAttr:n.column?n.column.dataindex:"",sortType:i},function(){return d.getPriceList()})},d.goDetail=function(e){window.windowPool=[];var t=window.open("/price/realTimePrice/priceDetail");window.windowPool.push({window:t,parameter:{source:1,data:e}})},d.getTableHeight=function(){var e=document.documentElement.clientHeight-46-48-24-62-55-40-5;d.setState({maxHeight:e})},d.refreshPrice=function(){d.setState({pageIndex:1},function(){return d.getPriceList()})},d.getPageTable=function(e){d.setState({pageIndex:e},function(){return d.getPriceList()})},d.exportData=function(){var e;2e4<d.state.count?d.setState({dialogVisible:!0}):(e=d.state.rangedColumns.filter(function(e){return!["趋势图","下架/缺货","更新状态"].includes(e.name)}),(0,T.u)({options:e,value:e.filter(function(e){return e.checked}).map(function(e){return e.id})}).then(function(e){d.handleDownload(e)}).catch(function(e){console.error(e)}))},d.handleDownload=function(e){var t,n,a,i,r=h.t.get(h.V.curProject).id;r&&(t=d.filter.getValue(),n=(i=d.state).sortAttr,a=i.sortType,i=i.type,t.id=r,m.Z.downloadPrice(f()({},t,{pageSize:1e5,pageIndex:1,sortAttr:n,sortType:a,type:i,exportFields:e}),function(e){2e4===e.code?u.Z.success(e.msg+"，请到个人中心的下载列表或者点击右上角“小铃铛”下载"):u.Z.error(e.msg)}))},d.afterChange=function(){d.getPriceList(),d.getConfigList(),d.getTableHeight(),window.addEventListener("resize",d.getTableHeight)},d.handleOnTypeChange=function(e){d.setState({type:e,pageIndex:1},d.afterChange)},d.handleUpdateTimeChange=function(e){d.setState({updateTime:e,pageIndex:1},d.afterChange)},d.handleUpdateStatusChange=function(e){d.setState({updateStatus:e,pageIndex:1},d.afterChange)},d.getRemainder=a()(c().mark(function e(){var t;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.h.get("/price/realtime/limit/remainder/get");case 2:t=e.sent,2e4===(t=t.data).code&&(t=t.result.remainder,d.setState({remainder:t}));case 5:case"end":return e.stop()}},e)})),d.updateImmediately=a()(c().mark(function e(){var t,n,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=h.t.get(h.V.curProject).id,t=d.filter.getValue(),d.setState({isFetching:!0}),n=d.state.selectedRows.map(function(e){return{connectionId:e.userConnectionId,sku:e.sku}}),e.next=6,p.h.post("/price/realtime/update",f()({},t,{connectionDataModel:n,id:a,selectedAll:d.state.selectedAll,realtimePriceTimeRange:d.state.updateTime,realtimePriceStatus:d.state.updateStatus})).catch(function(e){return e});case 6:if(a=e.sent,a=a.data,d.setState({isFetching:!1}),2e4===a.code)return u.Z.success("立即更新成功!"),d.setState({selectedRowKeys:[],selectedRows:[]}),d.getRemainder(),d.getPriceList(),e.abrupt("return");e.next=15;break;case 15:case"end":return e.stop()}},e)})),d.onSelectChange=function(e,t){var n=d.state.data.map(function(e){return e.userConnectionId}),a=d.state.selectedRowKeys.filter(function(e){return!n.includes(e)}),a=l()([].concat(a,e)),e=d.state.selectedRows.filter(function(e){return!n.includes(e.userConnectionId)}),t=i()([].concat(e,t),"userConnectionId");a.length>d.state.remainder?u.Z.error("勾选的链接数量超上限，请重新选择链接!"):(d.setState({selectedRowKeys:a,selectedRows:t,selectedAll:!1}),d.getRemainder())},d._handleSortChange=function(e,t){h.t.set(h.V.realPriceTableTitleList,e),d.setState({loading:!0}),setTimeout(function(){d.setState({rangedColumns:e,columns:e.reduce(function(e,t){return t.checked?[].concat(e,[_[t.name]]):e},[]).concat([{title:"",fixed:"right",width:"48"}])})},0),setTimeout(function(){d.setState({loading:!1})},"range"===t?500:2e3)};e=h.t.get(h.V.realPriceTableTitleList)||[{name:"趋势",checked:!0,disabled:!0,id:"flag"},{name:"商品标题",checked:!0,disabled:!1,id:"title"},{name:"更新状态",checked:!0,disabled:!1,id:"realtimePriceStatus"},{name:"数据更新时间",checked:!0,disabled:!1,id:"ctime"},{name:"单品到手价",checked:!0,disabled:!1,id:"takePrice"},{name:"单品到手价今日最低",checked:!0,disabled:!1,id:"minTakePrice"},{name:"单品拼单价",checked:!0,disabled:!1,id:"groupTakePrice"},{name:"单品拼单价今日最低",checked:!1,disabled:!1,id:"minGroupTakePrice"},{name:"完美拼单价",checked:!0,disabled:!1,id:"perfectGroupTakePrice"},{name:"完美拼单价今日最低",checked:!1,disabled:!1,id:"minPerfectGroupTakePrice"},{name:"今日最低",checked:!0,disabled:!1,id:"minPrice"},{name:"挂牌价",checked:!0,disabled:!1,id:"listPrice"},{name:"单品优惠券",checked:!1,disabled:!1,id:"skuQuan"},{name:"店铺优惠券",checked:!1,disabled:!1,id:"storeQuan"},{name:"行业优惠券",checked:!1,disabled:!1,id:"industryQuan"},{name:"下架/缺货",checked:!0,disabled:!1},{name:"满减",checked:!0,disabled:!1,id:"trueReductionValue"},{name:"赠品",checked:!0,disabled:!1,id:"gift"},{name:"免息最长分期",checked:!0,disabled:!1,id:"freeByStages"},{name:"定金",checked:!0,disabled:!1,id:"deposit"},{name:"预定数量",checked:!0,disabled:!1,id:"orderAmount"},{name:"趋势图",checked:!0,disabled:!0},{name:"淘宝掌柜",checked:!1,disabled:!1,id:"sellerNick"},{name:"优惠合计",checked:!0,disabled:!1,id:"rateCount"},{name:"采纳优惠策略",checked:!0,disabled:!1,id:"trueRate"},{name:"优惠政策",checked:!0,disabled:!1,id:"rate"},{name:"商品副标题",checked:!0,disabled:!1,id:"slogan"},{name:"SKU",checked:!0,disabled:!1,id:"sku"},{name:"商品链接",checked:!0,disabled:!1,id:"url"},{name:"优惠券金额",checked:!0,disabled:!1,id:"trueCouponValue"}];return d.state={maxHeight:0,rangedColumns:e,columns:[],data:[],type:"ALL",filter:{},pageIndex:1,pageSize:40,sortAttr:"",sortType:"",loading:!1,count:0,updateTime:12,updateStatus:"UPDATED",selectedRowKeys:[],selectedRows:[],remainder:0,dialogVisible:!1,isFetching:!1,selectedAll:!1},d}r()(e,t);var n=e.prototype;return n.UNSAFE_componentWillReceiveProps=function(e){this.setState(f()({},e))},n.componentDidMount=function(){this.getTableHeight(),window.addEventListener("resize",this.getTableHeight)},n.componentWillUnmount=function(){window.removeEventListener("resize",this.getTableHeight)},n.getConfigList=function(){var e=a()(c().mark(function e(){var a,t,n;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.state.rangedColumns.slice(),n=h.t.get(h.V.curProject).id,e.next=4,p.h.post("/projects/config/list",[n]).then(function(e){e.data.result.forEach(function(t,e){var n;switch(e){case 0:n=70;break;case 1:n=128;break;default:n=96}_[t.configName]||(_[t.configName]={title:t.configName,dataindex:t.id,checked:!0,sorter:!0,width:n,fixed:"",render:function(e){e=e.configDetailVoList.filter(function(e){return e.topicTypeId===t.id});return g().createElement("div",{className:"ellipisis",style:{maxWidth:n},title:0<e.length?e[0].topicValue:""},0<e.length?e[0].topicValue:"")}}),a.find(function(e){return e.name===t.configName})||a.splice(-2,0,{name:t.configName,checked:!1,disabled:!1,id:"config:"+t.id})})});case 4:t=function(e,t,n){return e.splice(n,0,e.splice(t,1)[0])},(n=a.findIndex(function(e){return"趋势图"===e.name}))&&t(a,n,a.length-1),this.setState({rangedColumns:a,columns:a.reduce(function(e,t){return t.checked?[].concat(e,[_[t.name]]):e},[]).concat([{title:"",fixed:"right",width:"48"}])});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),n.getRowStyle=function(){return{cursor:"pointer"}},n.render=function(){var n=this,e=this.state,t=e.columns,a=e.data,i=e.pageSize,r=e.pageIndex,l=e.count,c=e.maxHeight,o=e.loading,s=e.dialogVisible,d=e.rangedColumns,u=e.type,m=e.updateStatus,p=e.updateTime,h=e.selectedRowKeys,f=e.isFetching,e=e.remainder;return g().createElement("div",{className:0<a.length?"tableWrapper":"tableWrapper hideBottomScrollbar"},g().createElement(C.Z,{ref:function(e){return n.filter=e},showList:["condition","save"],filterCondition:{filter:["CONN_CONFIG","SOURCE","TAG"]},model:"PRICE_REAL_TIME_PRICE",onFilterReady:function(){n.getPriceList(),n.getConfigList(),n.getRemainder()},onChange:this.refreshPrice}),g().createElement("section",{className:"content"},g().createElement("div",{className:"table-zone"},g().createElement("div",{className:"top_zone flex items-center"},g().createElement("div",{className:"flex-1"},g().createElement(b.Z,{options:P.U7,onChange:this.handleOnTypeChange,preTitle:"价格趋势",divider:"none",type:"button",activeObj:u}),g().createElement(y.Z,{overlayClassName:"alert-log-tips",overlay:g().createElement("a",{href:"https://www.yuque.com/docs/share/8f83b8d5-8218-4549-8438-db411dad32ed?# 《实时价格功能说明》",target:"_blank",rel:"noopener noreferrer",style:{color:"#0847A6"}},"了解更多"),placement:"top"},g().createElement("i",{className:"icon-cem_file1",style:{marginLeft:4,color:"#979797"}})),g().createElement(b.Z,{className:"ml-10",options:P.QQ,onChange:this.handleUpdateTimeChange,preTitle:"时间范围",divider:"none",type:"button",activeObj:p}),g().createElement(y.Z,{overlayClassName:"alert-log-tips",overlay:g().createElement("span",null,"从此刻时间往前推，如果超过当前时间，查询从当天的00:00:00~当前时间的数据"),placement:"top"},g().createElement("i",{className:"icon-cem_file1",style:{marginLeft:4,color:"#979797"}})),g().createElement(b.Z,{className:"ml-10",options:P.Se,onChange:this.handleUpdateStatusChange,preTitle:"更新状态",divider:"none",type:"button",activeObj:m})),g().createElement("div",{className:"mr-10"},"您还可以更新",e,"条链接"),g().createElement(S.Button,{disabled:!h.length||f,type:"primary",onClick:this.updateImmediately},"手动更新"),g().createElement(y.Z,{overlayClassName:"alert-log-tips",overlay:g().createElement("span",null,"系统会按照更新频率自动采集价格，但如果您想了解最新价格数据，请勾选链接手动更新"),placement:"left"},g().createElement("i",{className:"icon-cem_file1",style:{marginLeft:4,color:"#979797"}}))),g().createElement(N.Z,{title:"列",options:d,onChange:this._handleSortChange,leftFixedNum:1,rightFixedNum:1}),g().createElement(E,{tableLayout:"auto",columns:t,rowKey:"userConnectionId",rowSelection:{selectedRowKeys:h,onChange:this.onSelectChange,columnWidth:80,isSelectAll:this.state.selectedAll,selections:[{key:"SELECT_All",text:"全选所有",onSelect:function(e){n.setState({selectedAll:!0,selectedRowKeys:e,selectedRows:n.state.data})}},{key:"CLEAR_ALL",text:"清空所有",onSelect:function(){n.setState({selectedRowKeys:[],selectedRows:[],selectedAll:!1})}}],getCheckboxProps:function(e){return{disabled:"UPDATING"===e.realtimePriceStatus}}},onRow:function(t){return{onClick:function(e){return n.goDetail(t)}}},onPaginationChange:function(e){return n.getPageTable(e)},listSummary:{current:r,pageSize:i,total:l},scroll:{x:!0,y:c},loading:o||f,rowClassName:"cursor-pointer",onChange:this.handleSort,dataSource:a,bottomArea:x.Z.hasAuthority("DATA_DOWNLOAD")&&0<a.length&&g().createElement("span",{className:"download",onClick:function(){return n.exportData()}},g().createElement("i",{className:"cem-icon icon-cem_download"}),"下载")}),g().createElement(S.Dialog,{title:"提示",size:"tiny",visible:s,onCancel:function(){return n.setState({dialogVisible:!1})},lockScroll:!0},g().createElement(S.Dialog.Body,null,g().createElement("span",null,"最多支持下载前20000条数据。如需下载全部，可考虑调整筛选条件后分批下载")),g().createElement(S.Dialog.Footer,{className:"dialog-footer"},g().createElement(S.Button,{type:"primary",onClick:function(){n.setState({dialogVisible:!1}),n.handleDownload()}},"确定"))))))},e}(g().Component);const O=function(e){e=e.type;return g().createElement(A,{type:e,pagePosition:"bottom"})}},6637:(e,t,n)=>{"use strict";n.d(t,{u:()=>function(i){return new Promise(function(e,t){var n=i.value||[],a=r()({},i,{titleText:"下载数据",className:"yt_modal_price_download_modal",content:d().createElement(l,r()({},i,{getValue:function(e){n=e}})),top:"50%"});a.onOk=function(){return e(n)},a.onCancel=t,(0,c.Z)(a)})}});var a=n(67154),r=n.n(a),t=n(67294),d=n.n(t),a=n(45697),t=n.n(a),u=n(92360),a=function(e){var t=e.value,a=e.options,n=e.getValue,i=a.length===t.length,r=d().useState(t),l=r[0],c=r[1],e=d().useState(i),r=e[0],o=e[1],e=d().useState(!i&&0<t.length),t=e[0],s=e[1];d().useEffect(function(){n(l)},[l]);return d().createElement("div",{className:"yt_modal_price_download_wrapper"},d().createElement("div",{className:"content"},d().createElement("span",null,"字段"),d().createElement(u.Checkbox,{checked:r,indeterminate:t,onChange:function(e){o(e),s(!1),c(e?a.map(function(e){return e.id}):[])}},"全选")),d().createElement("div",{className:"checkbox_group"},a.map(function(n,e){return d().createElement(u.Checkbox,{key:e,value:n.id,checked:l.includes(n.id),onChange:function(){return t=n.id,e=-1<(e=l).indexOf(t)?e.filter(function(e){return e!==t}):[].concat(l,[t]),c(e),o(l.length===a.length),void s(0<l.length&&!i&&l.length<a.length);var t,e}},n.name)})))};const l=a;a.propTypes={value:t().object,getValue:t().func};var c=n(57522)},21694:(e,t,n)=>{"use strict";n.d(t,{U7:()=>a,QQ:()=>i,Se:()=>r,Q1:()=>l});var a=[{title:"价格上升",value:"UP"},{title:"价格下降",value:"DOWN"},{title:"全部",value:"ALL"}],i=[{title:"1小时内",value:1},{title:"2小时内",value:2},{title:"4小时内",value:4},{title:"12小时内",value:12},{title:"当天",value:0}],r=[{title:"已更新",value:"UPDATED"},{title:"未更新",value:"UN_UPDATED"},{title:"手动更新中",value:"UPDATING"}],l=[{fullName:"北京",simplifiedName:"京"},{fullName:"上海",simplifiedName:"沪"},{fullName:"广州",simplifiedName:"穗"},{fullName:"深圳",simplifiedName:"深"}]},38425:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var a=n(36144);const i={fetchWidgetList:function(e,t){a.h.post("/widget/list",e).then(function(e){t&&t(e.data.result)})},fetchWidgetTemp:function(e,t){a.h.get("/widget/temp/find?type="+e).then(function(e){t&&t(e.data.result)})},fetchWidgetTempById:function(e,t){a.h.get("/widget/edit_temp/find?id="+e).then(function(e){t&&t(e.data.result)})},addWidget:function(e,t){a.h.post("dashboard/widget/add",e).then(function(e){t&&t(e.data.result)})},searchData:function(e,t){a.h.post("/widget/data/find",e).then(function(e){t&&t(e.data.result)},function(e){t&&t(e.data.result)})},fetchProjectTopics:function(e,t){a.h.post("/widget/project_topics/find",e).then(function(e){t&&t(e.data.result)})},editWidget:function(e,t){a.h.post("/widget/edit",e).then(function(e){t&&t(e.data.result)})},findModel:function(e,t){a.h.get("/widget/model/list?project="+e.project).then(function(e){t&&t(e.data.result)})},exportData:function(e,t){a.h.post("/data/export",e).then(function(e){t&&t(e.data)})},findMessage:function(e,t){a.h.post("/widget/aspect/find",e).then(function(e){t&&t(e.data.result)})},findAspectLabel:function(e,t){a.h.post("/widget/aspectLabel",e).then(function(e){t&&t(e.data.result)})},downloadPrice:function(e,t){a.h.post("/data/price/export",e).then(function(e){t&&t(e.data)})}}},68003:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var t=n(85354),a=n.n(t),t=n(67294),r=n.n(t),l=n(78436),i=function(i){function e(){for(var n,e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(n=i.call.apply(i,[this].concat(t))||this).buildChart=function(){var e=n.props.data;e&&e.length||(e=[]);var t=[];e.forEach(function(e){t.length&&t[t.length-1]===e||t.push(e)}),1===t.length?t.push(t[0]):0===t.length&&(t=[1,1]);e=t.map(function(e,t){return[t+"",e+""]}),e={animation:!1,color:["#0747A6"],grid:{left:5,right:5,bottom:0,top:0,containLabel:!1},xAxis:[{show:!1,type:"category",data:e.map(function(e){return e[0]})}],yAxis:[{show:!1,type:"category",data:t.sort(function(e,t){return e-t}).map(function(e){return e+""})}],series:[{name:"",type:"line",step:"middle",data:e}]};n.refs.chart.setOption(e)},n}a()(e,i);var t=e.prototype;return t.componentDidMount=function(){this.width=this.refs.widget.offsetWidth,this.height=this.refs.widget.offsetHeight,this.buildChart()},t.shouldComponentUpdate=function(e,t){return JSON.stringify(e)!==JSON.stringify(this.props)},t.componentDidUpdate=function(){this.buildChart()},t.render=function(){var e=this.props.data;return r().createElement("div",{ref:"widget",className:"widget-container widget-container-wrap"},r().createElement("div",{className:"widget-body "+(e&&e.length?"middle_line":"line")},r().createElement(l.Z,{ref:"chart",className:"widget-chart"})))},e}(t.Component)},23942:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var t=n(67154),o=n.n(t),t=n(85354),a=n.n(t),t=n(67294),s=n.n(t),d=n(92360),t=n(45697),n=n.n(t),t=function(n){function e(e){var s=n.call(this,e)||this;s._setPadShowFalse=function(){s.state.show&&s.setState({show:!1})},s._handleOnClick=function(e){var t=s.state.show;t&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()),setTimeout(function(){s.setState({show:!t})},0)},s._handleOnPanelClick=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},s._handleOnRangeClick=function(e,t,n){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();var a=s.state,e=a.checkedOpts,i=a.unCheckedOpts,a=s.props,r=a.onChange,l=a.leftFixedNum,c=e.slice(),o=c.findIndex(function(e){return e.name===n.name});switch(c.splice(o,1),t){case"top":c.splice(l,0,n);break;case"up":c.splice(o-1,0,n);break;case"down":c.splice(o+1,0,n)}s.setState({checkedOpts:c},function(){setTimeout(function(){var e=c.concat(i);r(e,"range")},0)})},s._handleOnItemChange=function(e,t){var n=s.props,a=n.onChange,i=n.rightFixedNum,r=s.state,n=r.checkedOpts,r=r.unCheckedOpts,l=n.slice(),c=r.slice();e?(l.splice(l.length-i,0,o()({},t,{checked:!0})),c=r.filter(function(e){return t.name!==e.name})):(l=n.filter(function(e){return t.name!==e.name}),c.splice(0,0,o()({},t,{checked:!1}))),s.setState({checkedOpts:l,unCheckedOpts:c},function(){setTimeout(function(){var e=l.concat(c);a(e,"check")},0)})};var t=e.options?e.options.filter(function(e){return e.checked}):[],e=e.options?e.options.filter(function(e){return!e.checked}):[];return s.state={show:!1,checkedOpts:t,unCheckedOpts:e},s}a()(e,n);var t=e.prototype;return t.componentDidMount=function(){window.addEventListener("click",this._setPadShowFalse)},t.componentWillUnmount=function(){window.removeEventListener("click",this._setPadShowFalse)},t.componentDidUpdate=function(e,t){var n=e.options,e=this.props.options;JSON.stringify(e)!==JSON.stringify(n)&&this.setState({checkedOpts:e.filter(function(e){return e.checked}),unCheckedOpts:e.filter(function(e){return!e.checked})})},t.render=function(){var n=this,e=this.state,t=e.show,a=e.checkedOpts,i=e.unCheckedOpts,r=this.props,e=r.title,l=r.leftFixedNum,c=r.rightFixedNum;return s().createElement("div",{className:"sortable-checklist-button-wrapper",onClick:this._handleOnClick},s().createElement("span",{className:"scl-button-trigger "+(t?"sel":"")},e,s().createElement("i",{className:"icon-cem_arrow-launches",style:{transform:t?"rotate(-180deg)":""}})),s().createElement("div",{className:"scl-panel",id:"sorableList",style:{display:t?"block":"none"},onClick:this._handleOnPanelClick},a.map(function(t,e){return s().createElement("div",{key:t.name,className:"scl-panel-item"},s().createElement(d.Checkbox,{style:{width:"calc(100% - "+(5===e?14:a.length-2?34:48)+"px)"},checked:t.checked,disabled:t.disabled,onChange:function(e){return n._handleOnItemChange(e,t)}},t.name),!t.disabled&&s().createElement("span",{className:"range-button-zone"},e!==l&&s().createElement("i",{className:"icon-cem_roof-placement",onClick:function(e){return n._handleOnRangeClick(e,"top",t)}}),e!==l&&s().createElement("i",{className:"icon-cem_upper",onClick:function(e){return n._handleOnRangeClick(e,"up",t)}}),e!==a.length-1-c&&s().createElement("i",{className:"icon-cem_lower",onClick:function(e){return n._handleOnRangeClick(e,"down",t)}})))}),i.reduce(function(e,t){return[].concat(e,[s().createElement("div",{key:t.name,className:"scl-panel-item"},s().createElement(d.Checkbox,{style:{width:"100%"},checked:t.checked,disabled:t.disabled,onChange:function(e){return n._handleOnItemChange(e,t)}},t.name))])},[0===i.length?null:s().createElement("div",{key:"divider",className:"h-divider"})])))},e}(s().PureComponent);t.propTypes={options:n().array,onChange:n().func,leftFixedNum:n().number,rightFixedNum:n().number};const i=t}}]);