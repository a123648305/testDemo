"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[5912],{92993:(e,t,n)=>{n.d(t,{JQ:()=>i,Cg:()=>o,ge:()=>s,lH:()=>d,G8:()=>m,xH:()=>p,Eb:()=>f});var r=n(63366),a=n(87462),l=n(30381),c=n.n(l),u=["id","name","children"];function i(e,t){return e.map((function(e){return(0,a.Z)({},e,{memberInfo:t.v2[e.key]||{},count:t.v1[e.key]||0,children:i(e.children||[],t)})}))}function o(e){return e.sort((function(e,t){return c()(e.createdAt).isBefore(c()(t.createdAt))?-1:1})).map((function(e){var t=e.id,n=e.name,l=e.children,c=(0,r.Z)(e,u);return(0,a.Z)({},c,{title:n,key:t,level:e.path.split("/").length-1,children:o(l||[])})}))}function s(e,t){if(e===t[0].key)return(0,a.Z)({},t[0],{parentNode:{key:t[0].parentId||"",title:""}});var n={};return function t(r){(r.children||[]).forEach((function(l){l.key===e&&(n=(0,a.Z)({},l,{parentNode:r})),t(l)}))}(t[0]),n}function d(e,t){return e.filter((function(e){var n;return t.includes(e.key)?(e.children&&(e.children=d(e.children,t)),!0):!(null==(n=e.children)||!n.length)&&d(e.children,t).length}))}function m(e,t){var n=[],r=[];return function t(a,l){a!==e?l.forEach((function(e){r.push(e.key),t(e.key,e.children||[]),r.pop()})):n=[].concat(r)}("",t),n}var p=function(e){return e.reduce((function(e,t){return e.concat(t)}),[])},f=function(e,t){var n=t.join("|").replace(/\+/g,"\\+"),r=new RegExp("^("+n+")\\s*(\\d+)","g"),a=e.split(r).filter(Boolean);return{phoneNumber:a.pop()||"",area:a.shift()||""}}},76295:(e,t,n)=>{n.d(t,{Z:()=>R});n(53294);var r=n(56697),a=(n(1025),n(65400)),l=(n(48145),n(40987)),c=(n(75314),n(11187)),u=n(87462),i=n(15861),o=n(87757),s=n.n(o),d=n(67294),m=n(45467);function p(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var h=function e(t,n){for(var r,a=p(t);!(r=a()).done;){var l=r.value;l.id===n.pathNode[0].id?l.childNodes=n:l.childNodes&&e(l.childNodes.depts,n)}return t},v=function(e,t){var n,r=[e],a=e.pathNode,l=!0;if(null!=a&&a.length){var c,i=t||a[0].id;if(1===a.length||i===a[e.pathNode.length-1].id)n=(0,u.Z)({},e,{pathNode:1===length?a:a.slice(null!=(c=e.pathNode.length-1)?c:1)});for(;null!=r&&r.length&&l;){var o=r.pop().depts;e:for(var s=0;s<o.length;s++){var d=o[s],m=d.id,p=d.childNodes;if(m===i){n=p,l=!1;break e}p&&r.push(p)}}}return n},y=function(e,t){var n=e&&e.replace(/ on.*?=/g," harmony=");if(n&&t.trim().length){var r=t.includes("*")?t.replaceAll("*",""):t,a=new RegExp(r,"ig");return"pre"!==t&&(n=n.replace(a,(function(e){return"<pre>"+e+"</pre>"}))),n=n.replace(/!\[\]\((.*)\)/g,(function(e,t){return'<img src="'+t+'" />'}))}return e},E=(n(58344),n(60171)),N=(n(89858),n(51024)),g=n(50361),b=n.n(g),k=n(57254),w=n(33798),j=n(92993);n(9405);var _,C=n(89552),I=n(1374),x=n(39432),S=[];n(7940);var Z,T=n(31059),D=(n(35797),n(64749)),H=n(87219),P=[];const O=function(e){var t,r,a,l,c,o,p,f,h,y,E,g,b=e.type,k=e.list,j=e.searchList,_=e.searchOptions,S=e.members,O=e.directlyUnder,A=e.keywords,L=e.searchTypes,M=e.subId,R=e.deptsLoading,U=e.onSearch,B=e.onMembersChange,K=e.onSubClick,W=(0,d.useState)({v1:{},v2:{}}),z=W[0],G=W[1],q=(0,d.useState)(S||[]),J=q[0],F=q[1],V=(0,d.useState)(A||""),Q=V[0],$=V[1],X=(0,d.useState)(L||_[0].value),Y=X[0],ee=X[1];Z=null!=A&&A.trim().length?j:v(k,M),(0,d.useEffect)((function(){$(A)}),[A]);var te=function(){var e=(0,i.Z)(s().mark((function e(){var t,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.pw)({onlyDirectly:!0});case 2:if(t=e.sent,2e4===(null==(n=t.data)?void 0:n.code)){e.next=6;break}return e.abrupt("return");case 6:G(n.result);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){te()}),[]);(0,d.useEffect)((function(){ee(L)}),[L]),(0,d.useEffect)((function(){F(S||[])}),[S]);var ne,re=function(e,t){var n=e.target,r=t.id,a=t.deptName,l=t.username,c=t.type,u=t.userHead,i=t.pathNode,o=function(e){return(0,H.ZP)(e,(function(e){e.forEach((function(e){"DEPT"===e.objType&&(e.count=z.v1[e.objId])}))}))}((0,H.ZP)(J,(function(e){if(!n.checked)return e.filter((function(e){return e.objId!==r}));e.push({objId:r,name:c===_[1].value?a:l,objType:c,directlyUnder:c===_[1].value&&O?1:0,userHead:u,pathNode:i})})));F(o),B&&B(o)};null!=(t=Z)&&null!=(r=t.pathNode)&&r.length&&(P=M===Z.pathNode[Z.pathNode.length-1].id?Z.pathNode.slice(null!=(ne=Z.pathNode.length-1)?ne:1):Z.pathNode.reduce((function(e,t){return[t].concat(e)}),[]));var ae=function(e){var t,n,r;return null==(t=e.pathNode)||null==(n=t.reduce((function(e,t){return[t].concat(e)}),[]))||null==(r=n.map((function(e){return e.deptName})))?void 0:r.join(" / ")},le=A.trim().length&&Q.trim().length&&A===Q,ce=le?0:(null==(a=document.querySelector(".member_list .menu"))?void 0:a.offsetHeight)||24;return d.createElement("div",null,d.createElement("div",{className:"top_search"},d.createElement(N.default,{placeholder:3===b&&"DEPT"===Y?"\u8bf7\u8f93\u5165\u90e8\u95e8\u540d\u79f0":"\u8bf7\u8f93\u5165\u59d3\u540d\u3001\u90ae\u7bb1\u6216\u624b\u673a\u53f7",allowClear:!0,suffix:d.createElement("i",{className:"icon-cem_small-search",onClick:function(){return U&&U({keyword:Q,searchType:3===b?Y:_[0].value})}}),onPressEnter:function(){return U&&U({keyword:Q,searchType:3===b?Y:_[0].value})},onChange:function(e){$(e.target.value),""===e.target.value&&(U&&U({keyword:"",searchType:3===b?Y:_[0].value}),Z=k)},value:Q,style:{height:28,width:3===b?"calc(100% - 98px)":"100%"}}),3===b&&d.createElement(D.default,{value:Y,options:_,onChange:function(e){ee(e),Q.trim().length&&U&&U({keyword:Q,searchType:e})},getPopupContainer:function(e){return e},suffixIcon:d.createElement("i",{className:"icon-cem_pull-down-or-take-up"}),style:{height:28}})),null!=(l=P)&&l.length&&!le?d.createElement("div",{className:"menu"},P.map((function(e,t,n){return d.createElement("span",{key:e.id},d.createElement("span",{className:"deptname",onClick:function(){t!==n.length-1&&function(e){var t=e.id;K&&K({id:t,keyword:Q},"menu"),Z=v(k,t)}(e)}},e.deptName),d.createElement("span",{className:"line"},t===n.length-1?"":"/"))}))):null,le?d.createElement("div",{className:"search_tip"},"\u5305\u542b\u201c",Q,"\u201d\u7684\u641c\u7d22\u7ed3\u679c"):null,d.createElement("div",{style:{height:"calc(100% - 40px - "+ce+"px - "+(le?"22px":"0px")+")"}},d.createElement(C.default,{spinning:R},null!=(c=Z)&&null!=(o=c.depts)&&o.length||null!=(p=Z)&&null!=(f=p.users)&&f.length?d.createElement("ul",{className:"member_list_wrapper"},null!=(h=Z)&&null!=(y=h.depts)&&y.length?Z.depts.map((function(e){return d.createElement("li",{key:e.id,className:le?"search":""},d.createElement("div",null,4===b?d.createElement(d.Fragment,null,d.createElement(w.Z,{defaultIcon:"bumen",activeIcon:"bumen"}),d.createElement("span",{className:"ellipsis less_width",title:(0,x.jD)(""+e.deptName)>328?""+e.deptName:void 0},e.deptName)):d.createElement(T.default,{checked:J.some((function(t){return t.objId===e.id})),onChange:function(t){var n;return re(t,(0,u.Z)({},e,{type:_[1].value,pathNode:(null==(n=e.pathNode)?void 0:n.reduce((function(e,t){return[t].concat(e)}),[]))||Z.pathNode.reduce((function(e,t){return[t].concat(e)}),[])}))}},d.createElement(w.Z,{defaultIcon:"bumen",activeIcon:"bumen"}),le?d.createElement("div",{className:"name_path"},d.createElement("p",{title:(0,x.jD)(""+e.deptName)>344?""+e.deptName:void 0},e.deptName),d.createElement("p",{title:(0,x.jD)(""+ae(e))>344?""+ae(e):void 0},ae(e))):d.createElement("span",{title:(0,x.jD)(""+e.deptName)>300?""+e.deptName:void 0,className:"ellipsis less_less_width"},e.deptName))),""===A.trim()?d.createElement("span",{className:J.some((function(t){return t.objId===e.id}))?"disabled":"",onClick:function(){J.find((function(t){return t.objId===e.id}))||K&&K({id:e.id,keyword:Q})}},d.createElement("i",{className:"icon-xiaji"}),"\u4e0b\u7ea7"):null)})):null,null!=(E=Z)&&null!=(g=E.users)&&g.length?Z.users.map((function(e){return d.createElement("li",{key:e.id,className:(le?"search":"")+" "},d.createElement(T.default,{onChange:function(t){var n;return re(t,(0,u.Z)({},e,{type:_[0].value,pathNode:(null==(n=e.pathNode)?void 0:n.reduce((function(e,t){return[t].concat(e)}),[]))||Z.pathNode.reduce((function(e,t){return[t].concat(e)}),[])}))},checked:J.some((function(t){return t.objId===e.id}))},d.createElement(I.Z,{src:e.userHead?e.userHead.startsWith("http")?e.userHead:location.protocol+"//"+e.userHead:n(68374),defaultImg:n(68374)}),le?d.createElement("div",{className:"name_path"},d.createElement("p",{title:(0,x.jD)(""+e.username)>344?""+e.username:void 0},e.username),d.createElement("p",{title:(0,x.jD)(""+ae(e))>344?""+ae(e):void 0},ae(e))):d.createElement("span",{className:"ellipsis",title:(0,x.jD)(""+e.username)>344?""+e.username:void 0},e.username)),d.createElement("i",{className:"iconbumen"}))})):null):d.createElement("div",{className:"empty-block"},le?("DEPT"===Y?"\u90e8\u95e8":"\u6210\u5458")+"\u4e3a\u7a7a":"\u6682\u65e0\u6570\u636e"))))};const A={1:function(e){var t=e.searchOptions,n=(e.list,e.members),r=e.onSearch,a=e.onMembersChange,l=e.searchList,c=(0,d.useState)(n||[]),u=c[0],o=c[1],p=(0,d.useState)(""),f=p[0],h=p[1],v=(0,d.useState)([]),g=v[0],_=v[1],C=(0,d.useState)([]),I=C[0],x=C[1],S=(0,d.useState)([]),Z=S[0],T=S[1],D=d.useState(0),H=(D[0],D[1]),P=function(){var e=(0,i.Z)(s().mark((function e(){var t,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.GK)({onlyDirectly:!0});case 2:t=e.sent,n=(0,j.Cg)([t.data.result]),Z.length||T(n.map((function(e){return e.key}))),_(n),x(n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){P()}),[]),(0,d.useEffect)((function(){o(n||[])}),[n]);(0,d.useEffect)((function(){if(l){var e=function(e){var t=e.map((function(e){return(0,j.G8)(e.id||"",I)})),n=(0,j.xH)(t),r=Array.from(new Set(n));return{expandedKeys:r,treeData:(0,j.lH)(b()(I),r)}}((null==l?void 0:l.depts)||[]),t=e.expandedKeys,n=e.treeData;T(t),_(n)}}),[l]);var O=function(e){var t=e.keyword;h(t),t?null==r||r({keyword:t,searchType:"DEPT"}):_(I)},A=function(){var e=document.getElementsByClassName("tree-container")[0];H((null==e?void 0:e.clientHeight)-5)};return(0,d.useEffect)((function(){return window.addEventListener("resize",A),A(),function(){return window.removeEventListener("resize",A)}}),[]),d.createElement("div",null,d.createElement("div",{className:"top_search"},d.createElement(N.default,{placeholder:"\u8bf7\u8f93\u5165\u90e8\u95e8\u540d\u79f0",allowClear:!0,suffix:d.createElement("i",{className:"icon-cem_small-search",onClick:function(){return O({keyword:f})}}),onPressEnter:function(){return O({keyword:f})},onChange:function(e){return O({keyword:e.target.value})},value:f,style:{height:28,width:"100%"}})),d.createElement("div",{className:"tree-container",style:{height:"calc(100% - 32px)"}},null!=g&&g.length?d.createElement(E.Z,{className:"dept_tree",defaultExpandAll:!0,treeData:g,switcherIcon:d.createElement(k.Z,null),onSelect:function(e,n){var r=[{objId:n.node.key,name:n.node.title,objType:t[1].value,pathNode:n.node.path.split("/").filter(Boolean).map((function(e){return{deptName:e}})),path:n.node.path}];o(r),null==a||a(r)},expandedKeys:Z,blockNode:!0,onExpand:function(e){T(e)},titleRender:function(e){return d.createElement("span",{className:"flex "+(u.find((function(t){return t.objId===e.key}))?"checked":"")},d.createElement(w.Z,{defaultIcon:"bumen",activeIcon:"bumen"}),d.createElement("span",{className:"ellipsis",dangerouslySetInnerHTML:{__html:""+y(e.title,f)}}))}}):d.createElement("div",{className:"empty-block"},"\u6682\u65e0\u6570\u636e")))},2:function(e){e.type;var t,r,a,l,c,i,o,s,m,p,f,h,y,E=e.list,g=e.searchList,b=e.searchOptions,k=e.directlyUnder,j=e.members,Z=e.keywords,T=e.subId,D=e.deptsLoading,H=e.onSearch,P=e.onMembersChange,O=e.onSubClick,A=(0,d.useState)(j||[]),L=A[0],M=A[1],R=(0,d.useState)(Z||""),U=R[0],B=R[1];_=null!=Z&&Z.trim().length?g:v(E,T),(0,d.useEffect)((function(){B(Z)}),[Z]),(0,d.useEffect)((function(){M(j||[])}),[j]);var K;null!=(t=_)&&null!=(r=t.pathNode)&&r.length&&(S=T===_.pathNode[_.pathNode.length-1].id?_.pathNode.slice(null!=(K=_.pathNode.length-1)?K:1):_.pathNode.reduce((function(e,t){return[t].concat(e)}),[]));var W=function(e){var t,n,r;return null==(t=e.pathNode)||null==(n=t.reduce((function(e,t){return[t].concat(e)}),[]))||null==(r=n.map((function(e){return e.deptName})))?void 0:r.join(" / ")},z=Z.trim().length&&U.trim().length&&Z===U,G=z?0:(null==(a=document.querySelector(".member_list .menu"))?void 0:a.offsetHeight)||24;return d.createElement("div",null,d.createElement("div",{className:"top_search"},d.createElement(N.default,{placeholder:"\u8bf7\u8f93\u5165\u59d3\u540d\u3001\u90ae\u7bb1\u6216\u624b\u673a\u53f7",allowClear:!0,suffix:d.createElement("i",{className:"icon-cem_small-search",onClick:function(){return H&&H({keyword:U,searchType:b[0].value})}}),onPressEnter:function(){return H&&H({keyword:U,searchType:b[0].value})},onChange:function(e){B(e.target.value),""===e.target.value&&(H&&H({keyword:"",searchType:b[0].value}),_=E)},value:U,style:{height:28,width:"100%"}})),null!=(l=_)&&null!=(c=l.pathNode)&&c.length&&!z?d.createElement("div",{className:"menu"},S.map((function(e,t,n){return d.createElement("span",{key:e.id},d.createElement("span",{className:"deptname",onClick:function(){t!==n.length-1&&function(e){var t=e.id;O&&O({id:t,keyword:U},"menu"),_=v(E,t)}(e)}},e.deptName),d.createElement("span",{className:"line"},t===n.length-1?"":"/"))}))):null,z?d.createElement("div",{className:"search_tip"},"\u5305\u542b\u201c",U,"\u201d\u7684\u641c\u7d22\u7ed3\u679c"):null,d.createElement("div",{style:{height:"calc(100% - 40px - "+G+"px - "+(z?"22px":"0px")+")"}},d.createElement(C.default,{spinning:D,style:{height:"calc(100% - 50px)"}},null!=(i=_)&&null!=(o=i.depts)&&o.length||null!=(s=_)&&null!=(m=s.users)&&m.length?d.createElement("ul",{className:"member_list_wrapper"},null!=(p=_)&&null!=(f=p.depts)&&f.length?_.depts.map((function(e){return d.createElement("li",{key:e.id},d.createElement("div",null,d.createElement(w.Z,{defaultIcon:"bumen",activeIcon:"bumen"}),d.createElement("span",{className:"ellipsis less_width",title:(0,x.jD)(""+e.deptName)>328?""+e.deptName:void 0},e.deptName)),""===Z.trim()?d.createElement("span",{onClick:function(){O&&O({id:e.id,keyword:U})}},d.createElement("i",{className:"icon-xiaji"}),"\u4e0b\u7ea7"):null)})):null,null!=(h=_)&&null!=(y=h.users)&&y.length?_.users.map((function(e){return d.createElement("li",{key:e.id,className:"single_choice "+(z?"search":"")+" "+(L.find((function(t){return t.objId===e.id}))?"selected":""),onClick:function(){var t;return function(e){var t=e.id,n=e.username,r=e.type,a=[{objId:t,name:n,objType:r,userHead:e.userHead,pathNode:e.pathNode,directlyUnder:r===b[1].value&&k?1:0}];M(a),P&&P(a)}((0,u.Z)({},e,{type:b[0].value,pathNode:(null==(t=e.pathNode)?void 0:t.reduce((function(e,t){return[t].concat(e)}),[]))||_.pathNode.reduce((function(e,t){return[t].concat(e)}),[])}))}},d.createElement("div",null,d.createElement(I.Z,{src:e.userHead?e.userHead.startsWith("http")?e.userHead:location.protocol+"//"+e.userHead:n(68374),defaultImg:n(68374)}),z?d.createElement("div",{className:"name_path"},d.createElement("p",{title:(0,x.jD)(""+e.username)>344?""+e.username:void 0},e.username),d.createElement("p",{title:(0,x.jD)(""+W(e))>344?""+W(e):void 0},W(e))):d.createElement("span",{className:"ellipsis",title:(0,x.jD)(""+e.username)>344?""+e.username:void 0},e.username)),d.createElement("i",{className:"iconbumen"}))})):null):d.createElement("div",{className:"empty-block"},"\u6682\u65e0\u6570\u636e"))))},3:O,4:O};const L=function(e){var t=e.type,r=e.members,a=e.searchOptions,l=e.onMembersChange,c=(0,d.useState)(r||[]),u=c[0],i=c[1];(0,d.useEffect)((function(){i(r||[])}),[r]);var o=function(e){var t=u.filter((function(t){return t.objId!==e}));i(t),l&&l(t)},s=function(e){var t,n;return e.path?e.path.slice(1).replace(/\//g," / "):null==(t=e.pathNode)||null==(n=t.map((function(e){return e.deptName})))?void 0:n.join(" / ")},m=(u||[]).filter((function(e){return e.objId&&e.objType===a[1].value})),p=(u||[]).filter((function(e){return e.objId&&e.objType===a[0].value}));return d.createElement("div",null,null!=u&&u.length?d.createElement("span",{className:"clear",onClick:function(){i([]),l&&l([])}},"\u6e05\u7a7a"):null,null!=u&&u.length?d.createElement("ul",{className:"member_list_wrapper choosed_member_list_wrapper"},m.length?m.map((function(e){return d.createElement("li",{key:e.objId,className:1===t?"tree-single-select-item":""},d.createElement("div",{className:"flex"},d.createElement(w.Z,{defaultIcon:"bumen",activeIcon:"bumen"}),d.createElement("div",{className:"name_path"},d.createElement("p",{title:(0,x.jD)(e.name)>334?e.name:void 0},e.name),d.createElement("p",{title:(0,x.jD)(""+s(e))>334?""+s(e):void 0},s(e)))),d.createElement("i",{className:3===t?"icon-cem_cancel":"",onClick:function(){return 3===t&&o(e.objId)}}))})):null,null!=p&&p.length?p.map((function(e){return d.createElement("li",{key:e.objId},d.createElement("div",null,d.createElement(I.Z,{src:e.userHead?e.userHead.startsWith("http")?e.userHead:location.protocol+"//"+e.userHead:n(68374),defaultImg:n(68374)}),d.createElement("div",{className:"name_path"},d.createElement("p",{title:(0,x.jD)(e.name)>334?e.name:void 0},e.name),d.createElement("p",{title:(0,x.jD)(""+s(e))>334?""+s(e):void 0},s(e)))),d.createElement("i",{className:t>=3?"icon-cem_cancel":"",onClick:function(){return t>=3&&o(e.objId)}}))})):null):null)};var M=function(e){var t=e.type,n=e.title,o=e.subTitle,p=e.directControl,f=e.searchList,v=e.searchOptions,y=void 0===v?[{label:"\u641c\u7d22\u6210\u5458",value:"USER"},{label:"\u641c\u7d22\u90e8\u95e8",value:"DEPT"}]:v,E=e.list,N=e.width,g=e.onCancel,b=e.onOk,k=e.members,w=A[t],j=(0,d.useState)(""),_=j[0],C=j[1],I=(0,d.useState)(!1),x=I[0],S=I[1],Z=(0,d.useState)(k||[]),T=Z[0],D=Z[1],H=(0,d.useState)(!1),P=H[0],O=H[1],M=(0,d.useState)(E||{}),R=M[0],U=M[1],B=(0,d.useState)(f||{}),K=B[0],W=B[1],z=(0,d.useState)(""),G=z[0],q=z[1],J=(0,d.useState)(y[0].value),F=J[0],V=J[1];(0,d.useEffect)((function(){Q()}),[]);var Q=function(){O(!0);try{(0,m.EP)({id:"0"}).then((function(e){var t,n,r=e.data;2e4===r.code&&(U(r.result),C(null!=(t=r.result)&&t.pathNode?null==(n=r.result.pathNode[r.result.pathNode.length-1])?void 0:n.id:""))})).finally((function(){O(!1)}))}catch(e){U({})}},$=function(){var e=(0,i.Z)(s().mark((function e(t){var n,r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.keyword,r=t.searchType,O(!0),e.prev=2,e.next=5,(0,m.Rn)({keyword:n,searchType:r});case 5:2e4===(a=e.sent).data.code&&(W(a.data.result),O(!1)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),W({}),O(!1);case 13:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){D(k)}),[k]);var X=function(){var e;W({}),C(R.pathNode?null==(e=R.pathNode[R.pathNode.length-1])?void 0:e.id:""),q(""),V(y[0].value),S(!1),D(k||[]),g&&g()},Y=function(){var e=(0,i.Z)(s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b){e.next=11;break}if(null!=T&&T.length){e.next=5;break}return n={1:"\u8bf7\u9009\u62e9\u90e8\u95e8",2:"\u8bf7\u9009\u62e9\u6210\u5458",3:"\u8bf7\u9009\u62e9\u6210\u5458/\u90e8\u95e8",4:"\u8bf7\u9009\u62e9\u6210\u5458"},e.abrupt("return",c.default.error({content:n[t]}));case 5:return e.next=7,b({members:T});case 7:e.sent,X(),S(x),D(T);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return d.createElement(r.Z,{className:"yt_choose_member_modal",title:n,width:N||960,visible:!!n,onOk:Y,onCancel:X,footer:d.createElement("div",{className:"foot_content"},d.createElement("div",null,p&&d.createElement(l.Z,{checked:x,onChange:function(e){S(e),D(T.map((function(t){return(0,u.Z)({},t,{directlyUnder:t.objType===y[0].value?0:e?1:0})})))}}),d.createElement("span",null,o)),d.createElement("div",null,d.createElement(a.default,{onClick:X},"\u53d6\u6d88"),d.createElement(a.default,{type:"primary",onClick:Y},"\u786e\u5b9a"))),zIndex:10001},d.createElement("div",{className:"member_list"},d.createElement(w,{type:t,list:R,subId:_,searchList:K,searchOptions:y,members:T,deptsLoading:P,onSearch:function(e){var t,n=e.keyword,r=e.searchType;""!==n.trim()?($({keyword:n,searchType:r}),q(n),V(r)):(q(n),C(R.pathNode?null==(t=R.pathNode[R.pathNode.length-1])?void 0:t.id:""))},onMembersChange:function(e){return D(e)},onSubClick:function(e,t){var n=e.id,r=e.keyword;!t&&function(e){var t=e.id;e.keyword,O(!0);try{(0,m.EP)({id:t}).then((function(e){var t=e.data;2e4===t.code&&U((0,u.Z)({},R,{pathNode:t.result.pathNode,depts:h(R.depts,t.result)}))})).finally((function(){O(!1)}))}catch(n){}}({id:n,keyword:r}),C(n)},directlyUnder:x,keywords:G,searchTypes:F}),d.createElement(L,{type:t,searchOptions:y,members:T,onMembersChange:function(e){return D(e)}})))};const R=d.memo((function(e){return e.title?d.createElement(M,e):null}))},45467:(e,t,n)=>{n.d(t,{zU:()=>i,Zy:()=>o,k3:()=>s,kP:()=>d,EP:()=>m,Rn:()=>p,P6:()=>f,v4:()=>h,gc:()=>v,Zs:()=>y,GK:()=>E,pw:()=>N});var r=n(87462),a=n(49722),l=n(35239),c=l.t.get(l.V.backProjectConfig).id,u="APP_NAME_SERVER";function i(e){return a.h.post("/upms/umps_role/super_role/find",(0,r.Z)({},e,{appName:u}))}function o(e){return a.h.post("/upms/project/pageMember",e)}function s(e){return a.h.post("/upms/project/removeMember",e)}function d(e){return a.h.post("/upms/umps_role/list",e)}function m(e){return a.h.post("/upms/dept/listDeptUserByPid",e)}function p(e){return a.h.post("/upms/dept/searchForSelect",e)}var f=function(){return a.h.post("/upms/permission/project/find",{projectId:c,appName:u})};function h(e){return a.h.post("/upms/permission/role/find",e)}function v(e){return a.h.post("/upms/project/addMember",e)}function y(e){return a.h.post("/upms/umps_role/grantRolesToObj",e)}var E=function(e){return a.h.post("/upms/dept/info/tree",e)},N=function(e){return a.h.post("/upms/dept/statisticalInfo",e)}},55815:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(94578),a=n(67294),l=n(45697),c=n.n(l),u=n(43036),i=n(61409),o=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this)._handleBreadcrumbClick=function(e){var n=t.props,r=n.title,a=n.beforeJump;e!==r.length-1&&(a?new Promise((function(e,t){return a(e,t)})).then((function(){i.mW.push({pathname:r[e].url,state:r[e].state})})):i.mW.push({pathname:r[e].url,state:r[e].state}))},t}return(0,r.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,r=t.mainTitle,l=t.rightContent,c=t.className,i=t.overlay;return a.createElement("div",{className:"breadcumb-wrapper "+c},n instanceof Array?a.createElement("div",{className:"breadcrumb-left"},a.createElement("div",null,n.map((function(t,r){return a.createElement("span",{className:t.url?"":"not_clickable",key:r,onClick:function(){return t.url&&r!==n.length-1&&e._handleBreadcrumbClick(r)}},t.title,r!==n.length-1&&" / ")}))),a.createElement("span",null,r||n[n.length-1].title,i&&a.createElement(u.Z,{placement:"top",overlay:i},a.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}})))):a.createElement("div",{className:"normal-title"},n,i&&a.createElement(u.Z,{placement:"top",overlay:i},a.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}}))),l||"")},t}(a.Component);o.propTypes={className:c().string,title:c().oneOfType([c().string,c().arrayOf(c().shape({title:c().string,url:c().string,state:c().object}))]).isRequired,overlay:c().oneOfType([c().string,c().node]),mainTitle:c().oneOfType([c().string,c().node]),beforeJump:c().func,rightContent:c().node};const s=o},68374:(e,t,n)=>{e.exports=n.p+"img/c51764ce4120e50d299d.png"}}]);