"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[5654],{12008:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P});var a=n(63366),r=n(87462),l=n(94578),c=n(67294);const i=function(e){var t=e.list,n=e.index,a=e.handelOnClick;return c.createElement("ul",{className:"step_button"},t&&t.map((function(e,t){return c.createElement("li",{className:(t+1===n?"sel":"")+" "+(t+1<n?"finish":""),key:t},c.createElement("section",{onClick:function(){return t+1<n?a(t+1):""}},c.createElement("span",null,t+1<n?c.createElement("i",{className:"icon-cem_big-gou"}):t+1),c.createElement("span",null,e.name)))})))};var o=n(92360),s=n(8201),u=n(55815),p=n(64814),m=n(83330),h=n(29383),d=[{label:"\u94fe\u63a5\u552f\u4e00\u6807\u5fd7",prop:"syncKey"},{label:"\u94fe\u63a5\u540d",prop:"url"},{label:"\u5546\u54c1\u6807\u9898",prop:"name",render:function(e,t,n){return React.createElement("span",null,"1")}}],f=function(e){var t=JSON.parse(JSON.stringify(d));return e.filter((function(e){return e.checked})).forEach((function(e){t.splice(t.length-1,0,e)})),t},g=n(26687);const v=function(e){var t=e.value,n=e.changeValue,a=e.nextStep,r=e.tableList,l=e.tableListTotal,i=e.clearScreening,s=e.curScreeningMap,u=e.fetchTable,p=e.changePageSize,d=e.pageSize,v=e.fetchingTable,b=[];r&&r[0]&&r[0].configDetails&&(b=r[0].configDetails);var E=c.useState(1),y=E[0],C=E[1],S=c.useState(void 0),k=S[0],N=S[1],w=c.useState([]),x=w[0],Z=w[1],_=c.useState(f(x)),T=_[0],V=_[1];return c.useEffect((function(){k&&b&&Z(k.competeSelectMenuItem(b))}),[k,r]),c.useEffect((function(){V(f(x))}),[x]),c.createElement(c.Fragment,null,t.filterValue&&c.createElement(m.Z,{className:"edit_rule_filter",pageType:"BREAK_BACK_FILTER_CONNECTION",onChange:function(e){return n({id:"filterValue",value:e})},value:t.filterValue,option:{configurable:!1,draggable:!1}}),s&&c.createElement("div",{className:"nextStep"},c.createElement("span",{onClick:i},"\u6e05\u7a7a\u9009\u9879"),c.createElement(o.Button,{onClick:a,type:"primary",style:{float:"right"}},"\u4e0b\u4e00\u6b65")),c.createElement("div",{className:"table_wrap"},s&&r&&c.createElement(g.Z,{ref:function(e){return N(e)},multiSave:{name:"priceChaos_editRule"},columns:x,getShowColumns:function(e){return Z(e)}}),s&&r&&c.createElement(h.Z,{columns:T,data:r,loading:v,currentPage:y,total:l,pageSize:d,onPage:function(e){C(e),u({currentPage:e})},pageSizeSelectorShow:!0,onPageSizeChange:function(e){p({pageSize:e}),C(1),u({currentPage:1})}})))};const b=function(e){var t=e.value,n=e.changeValue,a=(0,p.X0)(t.money);return c.createElement("div",{className:"step2"},c.createElement("div",{className:"price bottom-line"},c.createElement("span",{className:"title"},"\u91d1\u989d"),c.createElement(o.Input,{className:"input "+(a?"":"err"),placeholder:"\u8bf7\u586b\u5199\u91d1\u989d",value:t.money,onChange:function(e){n({id:"money",value:e.trim()})}}),!a&&c.createElement("span",{className:"errTip"},"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u91d1\u989d\uff080~100000\u4e4b\u95f4\uff09")),c.createElement("div",{className:"compareWay bottom-line"},c.createElement("span",{className:"title"},"\u6bd4\u4ef7\u65b9\u5f0f"),c.createElement(o.Checkbox,{checked:!0,disabled:!0},"\u4f4e\u4e8e")))};var E=n(95814);const y=function(e){var t=e.value,a=e.changeValue,r=e.teamList;return c.createElement("div",{className:"step3"},c.createElement("div",{className:"way bottom-line"},c.createElement("span",{className:"title"},"\u901a\u77e5\u65b9\u5f0f"),c.createElement("span",null,c.createElement("img",{src:n(7759),alt:""})," \u5fae\u4fe1\u901a\u77e5")),c.createElement("div",{className:"user-group bottom-line"},c.createElement("p",{className:"sel-user"},"\u9009\u62e9\u901a\u77e5\u7528\u6237\u7ec4"),c.createElement(E.Z,{checkedList:t.userList,data:r,changeState:function(e){return a({id:"userList",value:e})}})))};const C=function(e){var t=e.value,n=e.changeValue,a=c.useState(!1),r=a[0],l=a[1],i=c.useState(!1),s=i[0],u=i[1],m=(0,p.kt)(t.warningName);return c.createElement("div",{className:"step4"},c.createElement("div",{className:"warning bottom-line"},c.createElement("span",{className:"title"},"\u9884\u8b66\u540d\u79f0"),c.createElement(o.Input,{className:"input "+(r&&!m?"err":""),placeholder:"\u8bf7\u586b\u5199\u9884\u8b66\u540d\u79f0",defaultValue:t.warningName,maxLength:p.BS,onFocus:function(){return l(!0)},onBlur:function(){return l(!1)},onChange:function(e){!s&&n({id:"warningName",value:e.trim().substring(0,p.BS)})},onCompositionStart:function(){return u(!0)},onCompositionUpdate:function(){return u(!0)},onCompositionEnd:function(e){u(!1),n({id:"warningName",value:e.target.value.trim().substring(0,p.BS)})}}),r&&!m&&c.createElement("div",{className:"errTip"},"\u63d0\u793a\uff1a\u6700\u591a\u53ea\u80fd\u8f93\u5165"+p.BS+"\u4e2a\u5b57\u7b26")))};var S=[{name:"\u7b5b\u9009\u6bd4\u4ef7\u8303\u56f4"},{name:"\u8bbe\u7f6e\u9884\u8b66\u503c"},{name:"\u901a\u77e5\u7b56\u7565"},{name:"\u9884\u8b66\u540d\u79f0\uff08\u5b8c\u6210\uff09"}];const k=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).renderStep=function(){switch(t.props.step){case 1:default:return;case 2:return c.createElement(b,t.props);case 3:return c.createElement(y,t.props);case 4:return c.createElement(C,t.props)}},t}return(0,l.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.step,n=e.nextStep,a=e.preStep,r=e.submit,l=e.curScreeningMap,m=e.id,h=e.hasChange,d=e.changeStep;return c.createElement("div",{className:"eidt_rule_wrap"},c.createElement(u.Z,{title:(0,p.uT)({title:m?"\u7f16\u8f91\u89c4\u5219":"\u521b\u5efa\u89c4\u5219"})}),c.createElement("div",{className:"scroll_wrap"},c.createElement("div",{className:"buttom_wrap"},c.createElement(s.Z,{data:l}),l&&c.createElement(i,{list:S,index:t,handelOnClick:function(e){return d({step:e})}}),c.createElement("div",{style:{display:1===t?"block":"none"}},c.createElement(v,this.props)),l&&this.renderStep(),1!==t&&l&&c.createElement("div",{className:"bottom_button"},c.createElement(o.Button,{type:"primary",onClick:t===S.length?r:n,disabled:!h&&t===S.length},t===S.length?"\u5b8c\u6210":"\u4e0b\u4e00\u6b65"),c.createElement(o.Button,{onClick:a},"\u4e0a\u4e00\u6b65")))))},t}(c.Component);var N=n(64396),w=n(55609),x=n(35239),Z=n(61409),_=["loading"],T=N.Z.price.editRule,V=N.Z.screening,L=function(e){function t(t){var n;(n=e.call(this,t)||this)._handelClearScreening=function(){n.props.clearScreening()},n._handelPreStep=function(){var e=n.props.step;n.props.changeStep({step:e-1})},n._handelNextStep=function(){var e=n.props,t=e.step,a=e.tableList,r=e.value;1!==t||0!==a.length?1!==t||r.filterValue&&(!r.filterValue||0!==r.filterValue.length)?2!==t||r.money.length&&(0,p.X0)(r.money)?3!==t||0!==r.userList.length?4!==t||r.warningName?n.props.changeStep({step:t+1}):o.Message.warning("\u8bf7\u586b\u5199\u540d\u79f0\uff01"):o.Message.warning("\u8bf7\u9009\u62e9\u901a\u77e5\u7528\u6237\u7ec4\uff01"):o.Message.warning("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u91d1\u989d\uff080~100000\u4e4b\u95f4\uff09\uff01"):o.Message.warning("\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u9879\u7b5b\u9009\u6761\u4ef6\uff01"):o.Message.warning("\u8be5\u6bd4\u4ef7\u5546\u54c1\u8303\u56f4\u5185\u6ca1\u6709\u6570\u636e\uff0c\u65e0\u6cd5\u6bd4\u8f83\uff01")},n._handelSubmit=function(){var e=n.props,t=e.step,a=e.value;4!==t||a.warningName?n.props.submit().then((function(){return Z.mW.push({pathname:"/priceChaos/ruleList"})})):o.Message.warning("\u8bf7\u586b\u5199\u540d\u79f0\uff01")},n.routerWillLeave=function(){return!n.props.hasChange||"\u4fe1\u606f\u8fd8\u672a\u4fdd\u5b58\uff0c\u786e\u8ba4\u8981\u79bb\u5f00\uff1f"},t.save({projectId:x.t.get(x.V.curProject).id,id:window.ruleId||null});var a=t.fetchDefaultValue,l=t.fetchTable;return(0,t.fetchTeam)(),window.ruleId?a().then((function(){return l()})):(t.save({value:(0,r.Z)({},t.value,{filterValue:[]})}),l()),n.state={},n._event={preStep:n._handelPreStep,nextStep:n._handelNextStep,submit:n._handelSubmit,clearScreening:n._handelClearScreening},n}(0,l.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.router.setRouteLeaveHook(this.props.route,this.routerWillLeave)},n.render=function(){return c.createElement(k,(0,r.Z)({},this.props,this.state,this._event))},t}(c.Component);const P=(0,w.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,_);return(0,r.Z)({},n[T],{curScreeningMap:n[V].curScreeningMap,fetchingTable:t.effects[T+"/fetchTable"]||!1})}),(function(e){return{fetchDefaultValue:function(){return e({type:T+"/fetchDefaultValue"})},fetchTable:function(t){return e({type:T+"/fetchTable",payload:t})},fetchTeam:function(){return e({type:T+"/fetchTeam"})},changeValue:function(t){return e({type:T+"/changeValue",payload:t})},changeStep:function(t){return e({type:T+"/changeStep",payload:t})},changePageSize:function(t){return e({type:T+"/changePageSize",payload:t})},clearScreening:function(t){return e({type:T+"/clearScreening",payload:t})},submit:function(){return e({type:T+"/submit"})},save:function(t){return e({type:T+"/save",payload:t})}}}))(L)},24473:(e,t,n)=>{n.d(t,{Z:()=>h});var a=n(87462),r=n(63366),l=n(94578),c=n(67294),i=n(45697),o=n.n(i),s=n(94184),u=n.n(s),p=["prefixCls","children","className","block","indeterminate","value","checked","defaultChecked","onChange","disabled"],m=function(e){function t(){return e.apply(this,arguments)||this}return(0,l.Z)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.prefixCls,l=t.children,i=t.className,o=t.block,s=t.indeterminate,m=t.value,h=t.checked,d=t.defaultChecked,f=t.onChange,g=t.disabled,v=(0,r.Z)(t,p),b={value:m,checked:h,defaultChecked:d,onChange:f,disabled:g},E=u()(n,((e={})[n+"-disabled"]=b.disabled,e[n+"-block"]=o,e[n+"-indeterminate"]=s,e),i);return c.createElement("label",(0,a.Z)({tabIndex:b.disabled?-1:0,className:E},v),c.createElement("input",(0,a.Z)({type:"checkbox",className:n+"-input"},b)),c.createElement("span",{className:n+"-status"}),l&&c.createElement("span",{className:n+"-text",title:l},l))},t}(c.Component);m.propTypes={prefixCls:o().string,value:o().oneOfType([o().string,o().number]),checked:o().bool,defaultChecked:o().bool,onChange:o().func,indeterminate:o().bool,disabled:o().bool,block:o().bool},m.defaultProps={prefixCls:"wt-checkbox"};const h=m},85151:(e,t,n)=>{n.d(t,{Jg:()=>a.Z,CS:()=>d});var a=n(24473),r=n(87462),l=n(63366),c=n(94578),i=n(67294),o=n(45697),s=n.n(o),u=n(94184),p=n.n(u),m=["prefixCls","children","className","onChange","values","checkedList","block"],h=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).handleCheckBoxChange=function(e){var n=t.props.onChange;n&&n(e)},t}return(0,c.Z)(t,e),t.prototype.render=function(){var e,t=this,n=this.props,a=n.prefixCls,c=n.children,o=n.className,s=(n.onChange,n.values),u=n.checkedList,h=n.block,d=(0,l.Z)(n,m);return e=s?s.map((function(e,n){var a=0!==u.length&&-1!==u.indexOf(e);return i.createElement(Checkbox,{key:n,value:e,checked:a,onChange:function(e){return t.handleCheckBoxChange(e)},block:h},e)})):i.Children.map(c,(function(e,n){if(e){var a=e.props,r=a.value,l=0!==u.length&&-1!==u.indexOf(r);return i.cloneElement(e,{checked:l,key:n,block:a.block||h,onChange:function(){var e=a.value;t.handleCheckBoxChange(e)}})}})),i.createElement("div",(0,r.Z)({className:p()(a,o)},d),e)},t}(i.Component);h.defaultProps={prefixCls:"wt-checkbox-group"},h.propTypes={onChange:s().func,values:s().array,block:s().bool};const d=h;var f=function(e){var t={};return Object.keys(e).forEach((function(n){/^data\-.+$/.test(n)&&(t[n]=e[n])})),t},g=function(e){function t(){return e.apply(this,arguments)||this}return(0,c.Z)(t,e),t.prototype.render=function(){var e=this.props,t=f(e);return i.createElement("label",{className:e.className,title:e.children},i.createElement("div",{className:"checkbox"},i.createElement("input",(0,r.Z)({checked:e.checked,type:"checkbox",name:e.name,onChange:e.onChange,disabled:e.disabled},t)),i.createElement("div",{className:"checkbox-body"})),"\xa0",i.createElement("span",null,e.children))},t}(i.Component);g.defaultProps={className:"",name:"",checked:!1,disabled:!1,onChange:function(e){return e}}},55815:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(94578),r=n(67294),l=n(45697),c=n.n(l),i=n(43036),o=n(61409),s=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props,a=n.title,r=n.beforeJump;e!==a.length-1&&(r?new Promise((function(e,t){return r(e,t)})).then((function(){o.mW.push({pathname:a[e].url,state:a[e].state})})):o.mW.push({pathname:a[e].url,state:a[e].state}))},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.mainTitle,l=t.rightContent,c=t.className,o=t.overlay;return r.createElement("div",{className:"breadcumb-wrapper "+c},n instanceof Array?r.createElement("div",{className:"breadcrumb-left"},r.createElement("div",null,n.map((function(t,a){return r.createElement("span",{className:t.url?"":"not_clickable",key:a,onClick:function(){return t.url&&a!==n.length-1&&e._handleBreadcrumbClick(a)}},t.title,a!==n.length-1&&" / ")}))),r.createElement("span",null,a||n[n.length-1].title,o&&r.createElement(i.Z,{placement:"top",overlay:o},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}})))):r.createElement("div",{className:"normal-title"},n,o&&r.createElement(i.Z,{placement:"top",overlay:o},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}}))),l||"")},t}(r.Component);s.propTypes={className:c().string,title:c().oneOfType([c().string,c().arrayOf(c().shape({title:c().string,url:c().string,state:c().object}))]).isRequired,overlay:c().oneOfType([c().string,c().node]),mainTitle:c().oneOfType([c().string,c().node]),beforeJump:c().func,rightContent:c().node};const u=s},26687:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(87462),r=n(94578),l=n(67294),c=n(85151),i=n(35239),o=function(e){function t(t){var n;return(n=e.call(this,t)||this).openMenu=function(){n.setState({menuState:!n.state.menuState})},n.onChange=function(e){var t,a=n.props,r=a.columns,l=a.getShowColumns,c=a.multiSave;r&&r[e]&&((t=r.slice(0))[e].checked=!t[e].checked);var o=c?c.name:"",s=i.t.get(i.V.storageColumns)?i.t.get(i.V.storageColumns):{};s[o]=t,i.t.set(i.V.storageColumns,s),l&&l(t),n.resize(),n.setState({columns:t})},n.competeSelectMenuItem=function(e){var t=n.props.multiSave,a=t?t.name:"",r=n.props.columns,c=i.t.get(i.V.storageColumns)?i.t.get(i.V.storageColumns)[a]:[];if(c&&0!==c.length)"price_check"===a?c.map((function(e,t){return e.render=r.filter((function(t){return t.label===e.label})).length>0?r.filter((function(t){return t.label===e.label}))[0].render:function(t,n,a){return l.createElement("span",null,t[e.prop])}})):c.map((function(e,t){return e.render=function(e,n,a){return l.createElement("span",null,e.configDetails[t]&&e.configDetails[t].topicValue)}})),r=c.slice(0);else if(e&&e.every((function(e){return e.label&&e.prop})))r=e;else{var o=[];e&&e.forEach((function(e,t){o.push({label:e.topicTypeValue,checked:!1,render:function(e,n,a){return l.createElement("span",null,e.configDetails[t].topicValue)}})})),r=o.slice(0)}return n.setState({columns:r}),r},n.resize=function(){var e=document.querySelector(".connection-table .is-sortable");if(e){var t=n.getStyle(e,"width"),a=document.body.offsetWidth,r=n.state.columns;if(a>800&&r.length>2&&parseInt(t)<275)for(var l=0;l<r.length-2;l++)if(r[l].checked)return void n.onChange(l)}},n.close=function(e){n.state.menuState&&n.setState({menuState:!1})},n.state={menuState:!1,multiSave:null,columns:t.columns.map((function(e){return!e.checked&&(e.checked=!1),e}))},n}(0,r.Z)(t,e);var n=t.prototype;return n.UNSAFE_componentWillReceiveProps=function(e){this.setState((0,a.Z)({},e))},n.getStyle=function(e,t){return e.style[t]?e.style[t]:e.currentStyle?e.currentStyle[t]:getComputedStyle(e,null)[t]},n.componentDidMount=function(){window.addEventListener("click",this.close),window.addEventListener("resize",this.resize,!1)},n.componentWillUnmount=function(){window.removeEventListener("resize",this.resize,!1),window.removeEventListener("click",this.close)},n.render=function(){var e=this,t=this.state.columns;return l.createElement("div",{className:"menu-wrapper",onClick:function(e){e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()}},l.createElement("span",{className:"el-dropdown-link "+(this.state.menuState?"sel":""),onClick:this.openMenu},"\u5217",l.createElement("i",{className:"icon-cem_pull-down-or-take-up",style:{transform:this.state.menuState?"rotate(-180deg)":""}})),this.state.menuState&&l.createElement("div",{className:"menuList"},l.createElement("ul",null,0===t.length?l.createElement("li",{style:{color:"#8c8c8c"}},"\u65e0\u53ef\u9009\u62e9\u5185\u5bb9"):t.map((function(t,n){return l.createElement("li",{key:n},l.createElement(c.Jg,{key:n,value:t.label,checked:t.checked,onChange:e.onChange.bind(e,n),block:!0},t.label))})))))},t}(l.Component)},7759:(e,t,n)=>{e.exports=n.p+"img/bec210cb701235671955.png"}}]);