"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[6883],{66883:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Q});var a=n(63366),o=n(87462),r=n(94578),i=n(67294),l=n(55609),c=n(19586),s=n(50976),m=n(45697),d=n.n(m),u=n(43036),p=n(8201),f=n(39432),h=n(70715),g=function(e){if("string"===typeof e)switch(!0){case"BBS"===e:return"\u8bba\u575b";case"QUE_ANS"===e:return"\u95ee\u7b54";case"SOCIAL"===e:return"\u793e\u4ea4\u5a92\u4f53";case"SELF"===e:return"\u5185\u5bb9\u7535\u5546";case"NEWS"===e:return"\u65b0\u95fb\u5a92\u4f53";case"LEGAL"===e:return"\u6cd5\u5f8b\u7ef4\u6743"}},y=n(98191),v=function(e){var t=e.data,n=e.title,a=e.inteCount,o=e.titleOverlay,r=e.onMoreClick,l=e.loading,c=i.useState(void 0),m=c[0],d=c[1];return i.useEffect((function(){if(m)if((0,p.P)(t)){var e=function(e,t,n){return{title:{text:t},tooltip:{triger:"item",formatter:function(e){return e.marker+" "+e.name+"\uff1a"+e.value+"\uff08"+e.percent+"%\uff09"}},series:[{type:"pie",radius:74,hoverAnimation:!1,center:["75%","55%"],data:e.map((function(e){var t=e.type,n=e.count;return{name:0===n?null:g(t),value:0===n?null:n}})),label:{position:"outside",color:"#000",formatter:function(e){var t=e.data,n=t.name,a=t.value;return[""+n,"{value|"+f.ZP.getApproximateNum(a)+"}"].join("\n")},rich:{value:{fontSize:12,lineHeight:18,color:"#8c8c8c",align:"left"}}},labelLine:{smooth:!0,length:5,lineStyle:{color:"#bfbfbf"}}}],graphic:{type:"text",left:"15%",top:114,silent:!0,style:{text:""+f.ZP.getApproximateNum(e.reduce((function(e,t){return e+t.count}),0)),fill:"#000",font:"48px "+h.I8}}}}(t,n,m.getWidth());m.clear(),m.setOption(e)}else d(void 0)}),[t,m]),i.createElement(p.Z,{className:"interation-chart-wrapper",data:t,renderTitle:i.createElement(y.Z,{title:n,data:t,titleOverlay:o,onMoreClick:function(e){return function(e,t,n,a){var o=void 0;if("image"===t)o=e;else if("data"===t){var r=n.map((function(e){var t=e.type,n=e.count;return[g(t),n]}));r.splice(0,0,["\u4e92\u52a8\u6e20\u9053","\u4e92\u52a8\u91cf"]),o=[r]}a({type:t,obj:o,name:e.getOption().title[0].text})}(m,e,t,r)}})},m&&i.createElement(u.Z,{placement:"top",overlay:t&&a},i.createElement("span",{style:{position:"absolute",width:(0,f.jD)(a)+"px",height:"67px",top:"36%",left:"17%",transition:"all 0.3s",zIndex:1}})),i.createElement(s.Z,{theme:"yunting_multi_color",showloading:l,style:{width:"100%",height:"100%"},option:{},onChartReady:function(e){return d(e)}}))};v.propTypes={title:d().string,data:d().arrayOf(d().shape({type:d().string,count:d().number})),loading:d().bool.isRequired};const T=v;var C=n(10329),E=function(e){var t=e.data,n=e.count,a=e.title,o=e.titleOverlay,r=e.onMoreClick,l=e.onClick,c=e.loading,m=e.bottomContent,d=e.bottomOverlay,h=i.useState(void 0),g=h[0],v=h[1];return i.useEffect((function(){if(g)if((0,p.P)(t)){var e=(0,C.Rl)(t,a,g.getWidth(),m);g.clear(),g.setOption(e)}else v(void 0)}),[t,g]),i.createElement(p.Z,{className:"volume-chart-wrapper",data:t,renderTitle:i.createElement(y.Z,{title:a,data:t,titleOverlay:o,onMoreClick:function(e){return(0,C.kQ)(g,e,t,r)}})},g&&i.createElement(u.Z,{placement:"top",overlay:n},i.createElement("span",{style:{position:"absolute",width:(0,f.jD)(t&&t.totalCount)+"px",height:"67px",top:"36%",left:"13%",transition:"all 0.3s",zIndex:1}})),g&&i.createElement("span",{style:{position:"absolute",bottom:14,left:"30.5%",zIndex:1}},i.createElement(u.Z,{overlay:d,placement:"top",overlayClassName:"restricted-pop"},i.createElement("i",{className:"icon-cem_file1"}))),i.createElement(s.Z,{theme:"yunting_multi_color",showloading:c,style:{width:"100%",height:"100%"},option:{},onChartReady:function(e){return v(e)},onEvents:{click:l}}))};E.propTypes={title:d().string,data:d().object,loading:d().bool.isRequired};const D=E;var S=n(7802),N=n(53754),O=n(40086),_=n(53946),k=n(60496),b=function(e){var t=e.data,n=e.loading,a=e.chartType,o=e.title,r=(e.onMoreClick,e.onClick),l=i.useState(void 0),c=l[0],m=l[1],d=i.useState(a),u=d[0],f=d[1];return i.useEffect((function(){if(c)if((0,p.P)(t)){var e=(0,_.Rl)(t,o,a);c.clear(),c.setOption(e)}else m(void 0)}),[t,u,c]),i.createElement(p.Z,{data:t,className:"yt_pie_bar_chart_wrapper",loading:n,renderTitle:i.createElement(y.Z,{title:o,data:t,onMoreClick:function(e){return(0,_.kQ)(c,e,t,o)}},i.createElement(k.Z,{options:_.nF,activeObj:u,objName:"dataType",onChange:function(e){var t=e.dataType;return f(t)}}))},i.createElement(s.Z,{theme:"yunting_pos_neu_neg",option:{},style:{width:"100%",height:"100%"},onChartReady:function(e){return m(e)},onEvents:{click:r}}))};const w=b;b.propTypes={data:d().oneOfType([d().string,d().object]),timeType:d().object,title:d().string,onMoreClick:d().func};var V=n(97189),Z=n.n(V),I=function(e,t,n,a,o){return i.createElement(i.Fragment,null,i.createElement(N.Z,{type:1,title:"\u6e20\u9053",options:e,value:t,onChange:function(e){return o({channelTypeValue:e})}}),i.createElement(N.Z,{type:1,title:"\u5bf9\u6bd4",options:n,value:a,maxLength:2,onChange:function(e){return o({comparisionValue:e})}}))},L=function(e,t,n){return i.createElement(i.Fragment,null,i.createElement("div",{className:"chart-select-wrapper"},i.createElement(O.Z,{value:e,placeholder:e.name,list:[{id:"PERCENTAGE",name:"\u6bd4\u4f8b"},{id:"COUNT",name:"\u6570\u91cf"}],onChange:function(e){return n({emoTrendValType:e})}}),i.createElement(u.Z,{placement:"top",overlay:"\u6bd4\u4f8b=\u5177\u4f53\u6e20\u9053\u4e2d\u67d0\u79cd\u60c5\u611f\u7684\u6d88\u606f\u91cf\xf7\u8be5\u6e20\u9053\u7684\u6240\u6709\u60c5\u611f\u7684\u6d88\u606f\u91cf",overlayClassName:"title_desc_popup"},i.createElement("i",{className:"icon-cem_file1"}))),i.createElement(O.Z,{value:t,placeholder:t.name,list:[{id:"1",name:"\u6b63\u9762"},{id:"0",name:"\u4e2d\u6027"},{id:"-1",name:"\u8d1f\u9762"}],onChange:function(e){return n({emoTrendEmoType:e})}}))};const M=function(e){var t=e.isInitial,n=e.filterParams,a=e.curDimensionName,o=e.curDimensionValName,r=e.onMoreClick,l=e.dateRange,s=e.onVolumeClick,m=e.count,d=e.volLoading,u=e.volData,p=e.volRate,f=e.menuName,h=e.inteNumCount,g=e.inteLoading,y=e.inteData,v=e.totalTrendLoading,C=e.comparisionOptions,E=e.comparisionValue,N=e.channelTypeOptions,O=e.channelTypeValue,_=e.totalTrendDateDimension,k=e.totalTrendChartType,b=e.totalTrendData,V=e.totalTrendDiffData,M=e.onVolTrendClick,P=e.volTrendLoading,R=e.volTrendDateDimension,A=e.volTrendChartType,F=e.volTrendData,x=e.volTrendDiffData,j=e.emoTrendLoading,U=e.emoTrendEmoType,W=e.emoTrendValType,Q=e.emoTrendDateDimension,B=e.emoTrendChartType,H=e.emoTrendChartData,G=e.emoTrendChartDiffData,z=e.onFilterChange,J=e.fetchTotalTrendData,Y=e.fetchVolTrendChartData,q=e.fetchEmoTrendChartData,X=e.saveState,K=e.emotionAnalyzeData,$=e.getFilterRef;return i.createElement("div",{className:"yt_brand_analyzing_channel_wrapper"},i.createElement(c.Z,{ref:$,values:n,model:"BRAND_CHANNEL_ANALYSIS",showList:["condition","time","save"],filterCondition:{filter:["TAG","MESSAGE_RELATION","DIMENSION"],dimension:Z().getQuery("id")},onFilterReady:z,onChange:z}),i.createElement("div",{className:"ao_content"},i.createElement("div",{className:"ao_content_top"},i.createElement(D,{data:u,count:m,title:o+"\u58f0\u91cf",titleOverlay:"\u58f0\u91cf\uff1a\u58f0\u91cf\u662f\u9488\u5bf9\u5916\u90e8\u5f00\u653e\u5e73\u53f0\u7528\u6237\u58f0\u97f3\u7684\u4e00\u79cd\u7edf\u8ba1\u63cf\u8ff0\u3002\u5177\u4f53\u800c\u8a00\uff0c\u4e00\u4e2a\u535a\u6587\u3001\u4e00\u7bc7\u5a92\u4f53\u6587\u7ae0\uff08\u6807\u9898+\u6b63\u6587\uff09\u3001\u4e00\u4e2a\u5e16\u5b50\u3001\u4e00\u4e2a\u95ee\u9898\u3001\u4e00\u4e2a\u56de\u7b54\u3001\u4e00\u4e2a\u6295\u8bc9\u7b49\u5747\u8bb0\u4e3a1\u4e2a\u58f0\u91cf\u3002",loading:d,onMoreClick:r,onClick:s,bottomContent:p,bottomOverlay:"\u5173\u6ce8\u5ea6\uff1a"+o+"\u7684\u58f0\u91cf\u5360\u5168\u90e8"+f+"\u58f0\u91cf\u7684\u6bd4\u91cd"}),i.createElement("div",{className:"v-divider"}),i.createElement(T,{data:y,inteCount:h,title:o+"\u4e92\u52a8\u91cf",titleOverlay:"\u4e92\u52a8\u91cf\uff1a\u5fae\u535a\u548c\u5a92\u4f53\u6587\u7ae0\u5728\u4f20\u64ad\u7684\u8fc7\u7a0b\u4e2d\u5176\u4ed6\u7528\u6237\u7684\u201c\u6d4f\u89c8\u201d\u3001\u201c\u8f6c\u53d1\u201d\u3001\u201c\u70b9\u8d5e\u201d\u548c\u201c\u8bc4\u8bba\u201d\u7b49\u884c\u4e3a\u5373\u201c\u4e92\u52a8\u201d\u3002\u4e92\u52a8\u91cf\u662f\u57fa\u4e8e\u5404\u5e73\u53f0\u5bf9\u8fd9\u4e9b\u884c\u4e3a\u7684\u7ed9\u51fa\u7684\u5177\u4f53\u6570\u503c\u7d2f\u52a0\u800c\u6765\u3002",loading:g,onMoreClick:r})),i.createElement("div",{className:"ao_content_chart"},i.createElement(S.Z,{title:o+"\u6e20\u9053\u603b\u8d70\u52bf\u56fe",tooltipTitle:"\u58f0\u91cf",isInitial:t,loading:v,data:b,diffData:V,getTotalChartAppendix:!0,dateRange:l,dateDimension:_,onDateDimensionChange:function(e){return J({totalTrendDateDimension:e})},chartType:k,chartTypeOptions:["stack","bar","area"],onChartTypeChange:function(e){return X({totalTrendChartType:e})},appendix:I(N,O,C,E,J),dimensionName:a,onClick:M})),i.createElement("div",{className:"ao_content_chart"},i.createElement(S.Z,{title:o+"\u6e20\u9053\u58f0\u91cf\u8d70\u52bf\u5206\u6790",tooltipTitle:"\u58f0\u91cf",isInitial:t,loading:P,data:F,diffData:x,dateRange:l,dateDimension:R,onDateDimensionChange:function(e){return Y({volTrendDateDimension:e})},chartType:A,chartTypeOptions:["area","stack"],onChartTypeChange:function(e){return X({volTrendChartType:e})},dimensionName:"\u6e20\u9053\u7c7b\u578b",onClick:s})),i.createElement("div",{className:"ao_content_chart",style:{height:284}},i.createElement(w,{data:K,title:o+"\u5404\u6e20\u9053\u60c5\u611f\u5206\u6790",chartType:"NUMBER",onClick:s})),i.createElement("div",{className:"ao_content_chart"},i.createElement(S.Z,{isPercentage:"PERCENTAGE"===W.id,title:o+"\u5404\u6e20\u9053\u60c5\u611f\u8d70\u52bf",tooltipTitle:U.name+"\u58f0\u91cf"+("PERCENTAGE"===W.id?"\u5360\u6bd4":""),isInitial:t,loading:j,data:H,diffData:G,dateRange:l,dateDimension:Q,onDateDimensionChange:function(e){return q({emoTrendDateDimension:e})},chartType:B,chartTypeOptions:["area","stack"],onChartTypeChange:function(e){return X({emoTrendChartType:e})},appendix:L(W,U,q),dimensionName:"\u6e20\u9053\u7c7b\u578b"}))))};var P=n(35239),R=n(94644),A=n(87219),F=n(64396),x=["loading"],j=F.Z.brand.brandAnalysis,U=F.Z.brand.brandAnalysisSub.channel,W=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnMoreClick=function(e){"image"===e.type?(0,R._v)(e.obj,e.name):"data"===e.type&&(0,R.aT)(e.obj,e.name)},n.getVolParams=function(e,t,a){var r=n.props,i=r.filterParams,l=r.volTrendDateDimension,c=r.volTrendData,s=JSON.parse(JSON.stringify(i));return s.projectId=n.props.projectId,s.filterModel.messageType||(s.filterModel.messageType=["QUE_ANS_QUESTION","QUE_ANS_ANSWER","WEIBO","WEIBO_REPORT","COMMON_POST","NEWS_TEXT"]),e&&(s.filterModel.messageCategory=["\u793e\u4ea4\u5a92\u4f53"===e?"SOCIAL":"\u95ee\u7b54"===e?"QUE_ANS":"\u8bba\u575b"===e?"BBS":"\u65b0\u95fb\u5a92\u4f53"===e?"NEWS":"\u5185\u5bb9\u7535\u5546"===e?"SELF":"LEGAL"]),t&&(s.dateFilter=(0,o.Z)({},(0,A.ZP)(i.dateFilter,(function(e){var n=l,a=c[0].slice(1),o=(0,f.LV)(t,n),r=o.from,i=o.to;"DAY"!==n&&"HOUR"!==n&&(String(t)===String(a[0])?r=e.from:String(t)===String(a[a.length-1])&&(i=e.to)),e.from=r,e.to=i})))),a&&(s.filterModel.escore=["\u6b63\u9762"===a?"1":"\u8d1f\u9762"===a?"-1":"0"]),s},n._handleOnVolumeChartClick=function(e){if(e){var t=e.componentType,a=e.componentSubType,o=e.seriesName,r=e.name,i={};"series"===t&&(i="pie"===a?"\u4e92\u52a8\u6e20\u9053"===o?n.getVolParams(r,null,null):n.getVolParams(null,null,r):"line"===a?n.getVolParams(o,r,null):n.getVolParams(r,null,o)),window.open("/inbox/public?"+encodeURIComponent(JSON.stringify(i)))}},n.getVolTrendParams=function(e,t,a){var r=n.props,i=r.filterParams,l=r.totalTrendDateDimension,c=r.totalTrendData,s=JSON.parse(JSON.stringify(i));return s.projectId=n.props.projectId,s.filterModel.messageType||(s.filterModel.messageType=["QUE_ANS_QUESTION","QUE_ANS_ANSWER","WEIBO","WEIBO_REPORT","COMMON_POST","NEWS_TEXT"]),e&&(s.dateFilter=(0,o.Z)({},(0,A.ZP)(i.dateFilter,(function(t){var n=l,a=c[0].slice(1),o=(0,f.LV)(e,n),r=o.from,i=o.to;"DAY"!==n&&"HOUR"!==n&&(String(e)===String(a[0])?r=t.from:String(e)===String(a[a.length-1])&&(i=t.to)),t.from=r,t.to=i})))),t&&(s.filterModel.messageCategory=t),a&&(s.filterModel.dimension[0].values=[a]),s},n._handleOnVolTrendClick=function(e){var t=e.componentType,a=e.name,o=e.seriesName;if("series"===t){var r={};r=o===n.props.curDimensionValName?n.getVolTrendParams(a,n.props.channelTypeValue,null):n.getVolTrendParams(a,n.props.channelTypeValue,n.props.comparisionOptions.find((function(e){return e.name===o})).id),window.open("/inbox/public?"+encodeURIComponent(JSON.stringify(r)))}},n.handleFilterChange=function(e){var t=e.dateFilter.numOfDays;n.props.cleanChannelState(),n.getComparisionOptions(),n.props.fetchChannelDatas({menuDimension:n.state.dimensionId,filterParams:e,projectId:P.t.get(P.V.curProject).id,dateRange:t+Math.random()})},n.getComparisionOptions=function(){var e=n.props.saveState,t=[],a=[],o=[],r="",i="",l=n.filter.refs.FilterCondition.getValue(),c=n.filter.refs.FilterCondition.getFilterList(),s=l.filter((function(e){return"dimension"===e.special}))[0].values[0];if(c&&c.length>0){for(var m=0;m<c.length;m++){var d=c[m],u=d.values,p=d.name;if("dimension"===c[m].special)t=u.filter((function(e){return String(e.id)!==String(s)})),r=p,i=u.filter((function(e){return String(e.id)===String(s)}))[0].name;"messageCategory"===c[m].special&&(a=u.map((function(e){return{id:e.id,name:e.name}})),o=u.map((function(e){return e.id})))}e({comparisionOptions:t,curDimensionName:r,curDimensionValName:i,channelTypeOptions:a,channelTypeValue:o})}},n.state={dimensionId:Z().getQuery("id")},n.event={onMoreClick:n._handleOnMoreClick,onFilterChange:n.handleFilterChange,onVolumeClick:n._handleOnVolumeChartClick,onVolTrendClick:n._handleOnVolTrendClick,getFilterRef:function(e){return n.filter=e}},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){},n.componentWillUnmount=function(){var e=this.props.cleanChannelState;e&&e()},n.render=function(){return i.createElement(M,(0,o.Z)({},this.props,this.event))},t}(i.PureComponent);const Q=(0,l.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,x);return(0,o.Z)({},n[j][U],{volLoading:t.effects[j+"/fetchVolumeTypeData"]||!1,inteLoading:t.effects[j+"/fetchInterCategoryData"]||!1,totalTrendLoading:t.effects[j+"/fetchTotalTrendData"],volTrendLoading:t.effects[j+"/fetchVolTrendChartData"],emoTrendLoading:t.effects[j+"/fetchEmoTrendChartData"]})}),(function(e){return{saveState:function(t){return e({type:j+"/saveChannelState",payload:t})},cleanChannelState:function(t){return e({type:j+"/cleanChannelState",payload:t})},fetchChannelDatas:function(t){return e({type:j+"/fetchChannelDatas",payload:t})},fetchVolumeTypeData:function(t){return e({type:j+"/fetchVolumeTypeData",payload:t})},fetchInterCountData:function(t){return e({type:j+"/fetchInterCountData",payload:t})},fetchInterCategoryData:function(t){return e({type:j+"/fetchInterCategoryData",payload:t})},fetchTotalTrendData:function(t){return e({type:j+"/fetchTotalTrendData",payload:t})},fetchVolTrendChartData:function(t){return e({type:j+"/fetchVolTrendChartData",payload:t})},fetchEmoTrendChartData:function(t){return e({type:j+"/fetchEmoTrendChartData",payload:t})}}}))(W)},40086:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(87462),o=n(94578),r=n(67294),i=n(45697),l=n.n(i),c=function(e){function t(t){var n;return(n=e.call(this,t)||this).stop=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},n._setEvent=function(e){return 0===e?{onMouseEnter:function(){n.setState({firstLiHover:!0})},onMouseLeave:function(){n.setState({firstLiHover:!1})}}:{}},n.setShowSelFalse=function(){n.setState({show:!1})},n.state={show:!1,firstSelected:!1},n}(0,o.Z)(t,e);var n=t.prototype;return n.changeShow=function(e){var t=this;this.state.show&&this.stop(e),setTimeout((function(){t.setState({show:!t.state.show})}),0)},n.componentDidMount=function(){window.addEventListener("click",this.setShowSelFalse)},n.componentWillUnmount=function(){window.removeEventListener("click",this.setShowSelFalse)},n.render=function(){var e=this,t=this.state.show,n=this.props,o=n.placeholder,i=n.list,l=n.value,c=n.onChange,s=n.style,m=n.partingLine,d=i[0]&&i[0].id===l.id;return r.createElement("div",{className:"chart-select",style:s||{}},r.createElement("div",{className:"select "+(m?"line":""),onClick:function(t){return e.changeShow(t)}},r.createElement("div",{className:"infor "+(t?"sel":"")},r.createElement("span",{className:"placeholder"},o),r.createElement("i",{className:"icon icon-cem_arrow-launches",style:{transform:t?"rotate(-180deg)":"",top:t?"3px":""}}))),t&&r.createElement("div",{className:"position-wrap"},r.createElement("div",{className:"selItem "+(this.state.firstLiHover||d?"selPadHover":""),onClick:function(t){return e.stop(t)}},r.createElement("div",{className:"wrap"},r.createElement("ul",null,i.length>0?i.map((function(t,n){return r.createElement("li",(0,a.Z)({className:t.id===l.id?"sel":"",key:n,onClick:function(){e.setShowSelFalse(),c&&c(t,n)}},e._setEvent(n)),r.createElement("span",null,t.name))})):r.createElement("div",{className:"noData"},"\u65e0\u6570\u636e"))))))},t}(r.Component);c.defaultProps={placeholder:"\u8bf7\u9009\u62e9",list:[{name:"\u5468",id:"week"},{name:"\u6708",id:"month"}],value:{}},c.propTypes={placeholder:l().oneOfType([l().string,l().element]),list:l().array,value:l().object,onChange:l().func,style:l().object,partingLine:l().bool}}}]);