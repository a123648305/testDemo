"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[9481],{35235:(e,t,n)=>{n.r(t),n.d(t,{default:()=>J});var a=n(63366),r=n(87462),o=n(94578),i=n(67294),l=n(64396),c=n(55609),s=n(35239),u=n(87219),d=n(35103),p=n(94530),m=n(8201),f=function(e,t,n){return(0,m.P)(e)?[{name:t,count:e.v1,format:t.includes("\u7387")?"percent":"myriad"},{},{},{name:n,count:e.v2,format:t.includes("\u5e26\u661f")?null:"myriad"}]:e},h={width:"100%",height:"160px"},v=function(e){return i.createElement("div",{style:{maxWidth:228}},e)};const y=function(e){var t=e.fetchingCardData,n=e.cardData,a=e.onMsgClick;return i.createElement("div",{className:"yt_comment_overview_card_wrapper"},i.createElement(p.Z,{tip:function(){return v("\u8bc4\u8bba\u5206\u4e3a\u6709\u6548\u548c\u65e0\u6548\u8bc4\u8bba\uff0c\u65e0\u6548\u8bc4\u8bba\u662f\u6307\u8bc4\u8bba\u5185\u5bb9\u4e3a\u201c\u8be5\u7528\u6237\u672a\u8bc4\u8bba\uff01\u201d\u7b49\u7b49\u7684\u8bc4\u8bba\u3002")},loading:t,style:h,data:f(null==n?void 0:n.allComment,"\u5168\u90e8\u8bc4\u8bba\u6570\u91cf","\u6709\u6548\u8bc4\u8bba\u6570\u91cf"),onMsgClick:function(e){return a(e,e[0].name)}}),i.createElement(p.Z,{tip:function(){return v("\u5e73\u5747\u661f\u7ea7\u662f\u5bf9\u6240\u6709\u5e26\u661f\u7ea7\u7684\u8bc4\u8bba\u505a\u661f\u7ea7\u5e73\u5747\u5f97\u51fa\u3002")},loading:t,style:h,data:f(null==n?void 0:n.withScoreComment,"\u5e26\u661f\u8bc4\u8bba\u6570\u91cf","\u8bc4\u8bba\u5e73\u5747\u661f\u7ea7"),onMsgClick:function(e){return a(e,e[0].name)}}),i.createElement(p.Z,{tip:function(){return v("\u8bc4\u8bba\u597d\u8bc4\u7387 = \u6b63\u9762\u6709\u6548\u8bc4\u8bba\u6570\u91cf \xf7 \u6709\u6548\u8bc4\u8bba\u6570\u91cf\u3002\u8bc4\u8bba\u53ea\u8ba1\u7b97\u6d88\u606f\u7c7b\u578b\u4e3a\u8bc4\u8bba\u548c\u56de\u590d\uff0c\u4e0d\u7edf\u8ba1\u5b98\u65b9\u56de\u590d\u3002")},loading:t,style:h,data:f(null==n?void 0:n.positiveComment,"\u8bc4\u8bba\u597d\u8bc4\u7387","\u6b63\u9762\u6709\u6548\u8bc4\u8bba\u6570\u91cf"),onMsgClick:function(e){return a(e,e[0].name)}}),i.createElement(p.Z,{tip:function(){return v("\u8bc4\u8bba\u5dee\u8bc4\u7387 = \u8d1f\u9762\u6709\u6548\u8bc4\u8bba\u6570\u91cf \xf7 \u6709\u6548\u8bc4\u8bba\u6570\u91cf\u3002\u8bc4\u8bba\u53ea\u8ba1\u7b97\u6d88\u606f\u7c7b\u578b\u4e3a\u8bc4\u8bba\u548c\u56de\u590d\uff0c\u4e0d\u7edf\u8ba1\u5b98\u65b9\u56de\u590d\u3002")},loading:t,style:h,data:f(null==n?void 0:n.negativeComment,"\u8bc4\u8bba\u5dee\u8bc4\u7387","\u8d1f\u9762\u6709\u6548\u8bc4\u8bba\u6570\u91cf"),onMsgClick:function(e){return a(e,e[0].name)}}))};n(43378);var g=n(62443),E=n(98191),T=n(50361),C=n.n(T),b=n(39432),x=n(87300),_=n(70715),w=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).chartRef=void 0,t.source=void 0,t.lineSource=void 0,t.objNames=void 0,t.legendSelected=void 0,t.getChartRef=function(e){return t.chartRef=e},t.setValue=function(e,n){var a=e.map((function(e){return e.key+"\u661f"})),r=e.reduce((function(e,t){return e+t.total}),0),o=a.reduce((function(n,a){var o=e.find((function(e){return parseInt(e.key)===parseInt(a)}));return t.legendSelected?t.legendSelected[a]&&n.push([o.key+"\u661f",o.total,0===r?0:o.total/r]):n.push([o.key+"\u661f",o.total,0===r?0:o.total/r]),n}),[["\u661f\u7ea7","\u6570\u91cf","\u6bd4\u4f8b"]]),i=e.find((function(e){return e.total>0})).dataList.map((function(e){return[e.time]})),l=e.reduce((function(e,t){return t.dataList.forEach((function(t){return e.find((function(e){return e[0]===t.time})).push(t.total)})),e}),[].concat(i)),c=l.reduce((function(e,t,n){var a=t.reduce((function(e,t,n){return 0!==n?e+t:e}),0);return t.forEach((function(t,r){0!==r&&(e[n][r]=0===a?0:t/a)})),e}),C()(l)),s="ratio"===n?[["\u65e5\u671f"].concat(a)].concat(c):[["\u65e5\u671f"].concat(a)].concat(l);t.objNames=a,t.lineSource="ratio"===n?l:c,t.source=[o,s]},t.getOption=function(e,n,a,r,o,i,l,c){void 0===o&&(o="DAY"),void 0===i&&(i="count");var s=.8*l/(63*(t.source[1].length-1)),u="ratio"===i;return{graphic:[{type:"group",top:24,left:20,silent:!0,children:[{type:"text",left:10,style:{text:n,font:"bolder 14px "+_.I8,fill:"#262626"}},{type:"text",left:(0,b.jD)(n)+12,style:{text:a,font:"normal 14px "+_.I8,fill:"#8C8C8C"}}]}],dataset:t.source.map((function(e){return{source:e}})),legend:{left:16,top:52,itemWidth:10,itemHeight:10,itemGap:16,icon:"circle",data:t.objNames,selected:t.legendSelected},dataZoom:[{show:s<1,bottom:16,xAxisIndex:1,height:20,handleSize:"100%",showDetail:!1,borderColor:"transparent",dataBackground:{lineStyle:{color:"rgba(231, 243, 255, 1)",opacity:1},areaStyle:{color:"rgba(231, 243, 255, 1)",opacity:1}},fillerColor:"rgba(114, 98, 253, 0.3)",handleIcon:"path://M249.376256 0m102.4 0l0 0q102.4 0 102.4 102.4l0 819.2q0 102.4-102.4 102.4l0 0q-102.4 0-102.4-102.4l0-819.2q0-102.4 102.4-102.4Z",handleColor:"rgba(114, 98, 253, 1)"}],xAxis:[{type:"value",gridIndex:0,show:!1},{type:"category",gridIndex:1,boundaryGap:!1,axisLabel:{formatter:function(e){return(0,b.Sn)(o,e)}},axisPointer:{type:"line",label:{show:!1}},data:e.find((function(e){return e.total>0})).dataList.map((function(e){return e.time}))}],yAxis:[{type:"category",data:t.legendSelected?t.objNames.filter((function(e){return t.legendSelected[e]})):t.objNames,gridIndex:0,axisLabel:{color:"#626262"},axisPointer:{type:"none",label:{show:!1}}},{type:"value",axisLabel:{color:"#626262",formatter:function(e){return u?Math.round(100*e)+"%":(0,b.hE)(e)}},minInterval:u?void 0:1,axisLine:{show:!1,lineStyle:{type:"dashed",color:"#e5e5e5"}},splitLine:{show:!0,lineStyle:{color:["#e5e5e5"],width:1,type:"dashed"}},gridIndex:1}],grid:[{left:36,right:"70%",top:90,bottom:16,containLabel:!0},{left:"40%",right:48,top:90,bottom:s<1?52:16,containLabel:!0}],tooltip:{trigger:"axis",showDelay:20,hideDelay:10,enterable:!0,confine:!0,padding:0,backgroundColor:"#ffffff",borderColor:"#e5e5e5",borderWidth:"1",extraCssText:"border-radius: 2px;\n        box-shadow: 0px 9px 28px 8px rgba(0,0,0,0.05), 0px 6px 16px 0px rgba(0,0,0,0.08), 0px 3px 6px -4px rgba(0,0,0,0.12)",position:function(e,t,n,a,r){var o=r.contentSize,i=r.viewSize,l=e[0]<i[0]/2?0:-1,c=e[1]<i[1]/2?-.5:-1,s=e[0]<i[0]/2?12:-12;return[e[0]+l*o[0]+s,e[1]+c*o[1]]},formatter:function(e,r,i){if(e.length)return setTimeout((function(){if("bar"!==e[0].seriesType){var l=e[0].axisValue,s=e.map((function(e){var n=e.marker,a=e.seriesName,r=e.data,o=e.seriesIndex,i=e.dataIndex;return{name:n+' <span style="color: #8C8C8C;display: inline-block;width: 66px;">'+a+'</span> <span style="float: right;color: #262626;position: relative;">\n                '+(u?""+t.lineSource[i][o]:""+(0,b.hE)(r.value))+"&nbsp;"+(u?"("+(100*r.value).toFixed(2)+"%)":"("+(100*t.lineSource[i][o]).toFixed(2)+"%)")+"</span>",value:r.value}})),d=s.sort((function(e,t){return t.value-e.value})).map((function(e){return e.name})),p='<span span style = "font-size: 12px; color: #262626; font-weight: 400;" > '+(0,b.Sn)(o,l)+"</span>";i(r,(0,x.r)(p,d))}else{var m=e[0],f=m.marker,h=m.data;i(r,(0,x.r)(""+h[0],["<div style='display: flex;justify-content: space-between;align-items: center;color: #8c8c8c;'><div><span style='vertical-align: bottom'>"+f+"</span>"+(u?"\u6bd4\u4f8b":"\u6570\u91cf")+"</div><div style='color: #262626;margin-left: 10px;'>\n                     "+(u?(100*h[2]).toFixed(2)+"%":(0,b.hE)(h[1]))+"\n                  </div></div> "],[{title:"\u6d88\u606f",icon:"icon-cem_jump-message",callback:function(){c(e,""+n+a)}}],"yt_new_tooltip_wrapper"))}}),0)}},series:[{type:"bar",barMaxWidth:24,xAxisIndex:0,yAxisIndex:0,datasetIndex:0,barGap:"43%",encode:{x:1,y:0},data:t.source[0].slice(1),label:{show:!0,position:"right",fontSize:12,color:"#626262",formatter:function(e){var t=e.data;return(0,b.uf)(t[1])+" ("+(100*t[2]).toFixed(2)+"%)"}},itemStyle:{color:function(e){var n=e.dataIndex,a=e.name;if(t.legendSelected){var r=Object.keys(t.legendSelected);return _.M9[r.indexOf(a)]}return _.M9[n]}}}].concat(t.objNames.map((function(e,i){return{type:"line",xAxisIndex:1,yAxisIndex:1,name:e,smooth:!0,showSymbol:!0,symbolSize:2,stack:1,color:_.M9[i],areaStyle:{opacity:.05},data:t.source[1].slice(1).map((function(e){return{value:e[i+1],tooltip:{trigger:"item",formatter:function(e,r,i){return setTimeout((function(){var l=e.seriesName,s=e.name,d=e.data,p=e.marker,m=e.seriesIndex,f=e.dataIndex,h="\n                    <div style=\"font-size: 12px; color: #8c8c8c; font-weight: 400;position:relative;\">\n                      <span style='position:absolute;width:40px;height:150px;left:-40px;top:-30px;'></span>\n                      <span style='position:absolute;width:40px;height:150px;right:-40px;top:-30px;'></span>\n                    </div>\n                    <span style=\"font-size: 12px; color: #262626; font-weight: 400;\">"+(0,b.Sn)(o,s)+"</span>",v=["<div style='display: flex;justify-content: space-between;align-items: center;color: #8c8c8c;'><div><span style='vertical-align: bottom'>"+p+"</span>"+l+"</div><div style='color: #262626;margin-left: 10px;'>\n                        "+(u?t.lineSource[f][m]+" ("+(100*d.value).toFixed(2)+"%)":d.value+" ("+(100*t.lineSource[f][m]).toFixed(2)+"%)")+"\n                      </div></div>"];i(r,(0,x.r)(h,v,[{title:"\u6d88\u606f",icon:"icon-cem_jump-message",callback:function(){c(e,""+n+a)}}],"yt_new_tooltip_wrapper"))}),0)}},label:{show:r,position:"top",color:"#8C8C8C",formatter:function(e){var t=e.value;return u?(100*t).toFixed(2)+"%":(0,b.uf)(t)}}}}))}})))}},t}return(0,o.Z)(t,e),t.prototype.renderChart=function(e,t,n,a,r,o,i,l){this.setValue(e,o),this.chartRef.clear(),this.chartRef.setOption(this.getOption(e,t,n,a,r,o,i,l))},t}(i.PureComponent),N=n(50976),D=n(60496),M=n(94644),O=[{title:"\u6570\u91cf",value:"count"},{title:"\u6bd4\u4f8b",value:"ratio"}],F={"5\u661f":"\u4e94\u661f","4\u661f":"\u56db\u661f","3\u661f":"\u4e09\u661f","2\u661f":"\u4e8c\u661f","1\u661f":"\u4e00\u661f","0\u661f":"\u65e0\u661f","-1\u661f":"\u65e0\u661f"};const P=function(e){function t(t){var n;return(n=e.call(this,t)||this).internalId=void 0,n.chartLeaveTimeout=void 0,n.handleOnLegendChange=function(e){var t=e.selected;n.legendSelected=t,n.renderChart()},n.handleOnMoreClick=function(e){var t=n.props,a=t.title,r=t.subTitle,o=t.data;"image"===e&&n.chartRef?(0,M._v)(n.chartRef,""+a+r):"data"===e&&(0,m.P)(o)&&(0,M.aT)([n.source[0].map((function(e){return e.map((function(e){return e%1?(100*e).toFixed(2)+"%":e}))})),n.source[1].map((function(e){return e.map((function(e){return e%1?(100*e).toFixed(2)+"%":e}))}))],""+a+r)},n.state={showLabel:!1},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;this.internalId=setInterval((function(){if(e.chartRef){clearInterval(e.internalId),e.renderChart();var t=e.chartRef._dom.children,n=t[0],a=t[1];n.addEventListener("mouseleave",(function(t){e.chartLeaveTimeout=setTimeout((function(){e.chartLeaveTimeout&&(a.style.display="none")}),2e3)})),a&&a.addEventListener("mouseenter",(function(t){e.chartLeaveTimeout=void 0}))}}),200)},n.componentDidUpdate=function(e,t){var n=e.data,a=e.countType,r=e.timeType,o=this.props,i=o.data,l=o.countType,c=o.timeType,s=t.showLabel,u=this.state.showLabel;(0,m.P)(i)&&JSON.stringify(n)!==JSON.stringify(i)&&this.renderChart(),s===u&&a===l&&r===c||this.renderChart(),!(0,m.P)(i)&&this.chartRef&&(this.chartRef=void 0)},n.renderChart=function(){var t=this.props,n=t.data,a=t.title,r=t.subTitle,o=t.timeType,i=t.countType,l=t.onMsgClick,c=this.state.showLabel;(0,m.P)(n)&&this.chartRef&&0!==n.length&&e.prototype.renderChart.call(this,n,a,r,c,o,i,this.chartRef.getWidth(),l)},n.render=function(){var e=this,t=this.props,n=t.title,a=t.subTitle,r=t.loading,o=t.data,l=t.timeOptions,c=t.timeType,s=(t.fTimeType,t.countType),u=(t.fCountType,t.onChange),d=(t.onFlavorChange,this.state.showLabel);return i.createElement(m.Z,{data:o,loading:r,className:"yt_comment_overview_barline_chart_wrapper",renderTitle:i.createElement(E.Z,{title:i.createElement("span",null,n,i.createElement("span",{style:{color:"#8c8c8c",fontWeight:400}},a)),data:o},i.createElement(D.Z,{options:O,activeObj:s,rightHook:!0,onChange:function(e){return u({starTrendCountType:e})}}),i.createElement(D.Z,{options:l,activeObj:c,rightHook:!0,onChange:function(e){return u({starTrendTimeType:e})}}),i.createElement(g.default,{placement:"top",content:"\u663e\u793a\u56fe\u8868\u6807\u7b7e",mouseEnterDelay:.6,getPopupContainer:function(){return document.querySelector(".header_Filter_bar")}},i.createElement("i",{className:"icon-tubiaobiaoqian "+(d?"active":""),onClick:function(){e.setState({showLabel:!d})}})),i.createElement(g.default,{placement:"top",content:"\u5bfc\u51fa\u6570\u636e",mouseEnterDelay:.6,getPopupContainer:function(){return document.querySelector(".header_Filter_bar")}},i.createElement("i",{className:"icon-daochu",onClick:function(){return e.handleOnMoreClick("data")}})),i.createElement(g.default,{placement:"top",content:"\u5bfc\u51fa\u56fe\u7247",mouseEnterDelay:.6,getPopupContainer:function(){return document.querySelector(".header_Filter_bar")}},i.createElement("i",{className:"icon-xiazaitupian",onClick:function(){return e.handleOnMoreClick("image")}})))},i.createElement(N.Z,{theme:"yt_multi_color_10",option:{},style:{width:"100%",height:"100%"},onEvents:{legendselectchanged:this.handleOnLegendChange},onChartReady:function(t){return e.chartRef=t}}))},t}(w);var S=n(69719),k=n(83118),Z=(n(15144),n(2307)),I=n(49221),L=function(e,t,n,a){var r=void 0;"image"===t?(r=e,(0,M._v)(e,a)):"data"===t&&((r=n.map((function(e){return[e.country,e.total]}))).unshift(["\u56fd\u5bb6","\u8bc4\u8bba\u6570\u91cf"]),r=[r],(0,M.aT)(r,a))};function R(e,t,n,a,r,o){e&&t&&new Promise((function(t){var i=function(e,t,n,a,r){var o=(e=e.sort((function(e,t){return t.total-e.total}))).findIndex((function(e){return"\u5176\u4ed6"===e.country}));if(-1!==o){var i=e[o];(e=(0,I.Z)(e)).splice(o,o+1),(e=e.slice(0,9).reverse()).unshift(i)}else e=(e=(0,I.Z)(e)).slice(0,10).reverse();return{graphic:[{type:"group",top:24,left:20,silent:!0,children:[{type:"text",left:10,style:{text:t,font:"bolder 14px "+_.I8,fill:"#262626"}},{type:"text",left:(0,b.jD)(t)+12,style:{text:n,font:"normal 14px "+_.I8,fill:"#8C8C8C"}}]}],tooltip:{trigger:"item",showDelay:20,hideDelay:55,confine:!0,enterable:!0,padding:0,backgroundColor:"#ffffff",borderColor:"#e5e5e5",borderWidth:"1",extraCssText:"border-radius: 2px; box-shadow: 0px 9px 28px 8px rgba(0,0,0,0.05), 0px 6px 16px 0px rgba(0,0,0,0.08), 0px 3px 6px -4px rgba(0,0,0,0.12)",position:function(e,t,n,a,r){var o=r.contentSize,i=r.viewSize,l=e[0]<i[0]/2?0:-1,c=e[1]<i[1]/2?-.5:-1,s=e[0]<i[0]/2?12:-12;return[e[0]+l*o[0]+s,e[1]+c*o[1]]},formatter:function(e,n,a){var o=e.marker,i=e.name,l=e.value;return setTimeout((function(){a(n,(0,x.r)(i,["<div>\n                  <div style='display: flex;justify-content: space-between;align-items: center;color: #8c8c8c;'>\n                    <span style='vertical-align: bottom'>"+o+"</span><div>\u8bc4\u8bba\u6570\u91cf</div>\n                    <div style='color: #262626;margin-left: 30px;'>\n                      "+l+"\n                    </div>\n                  </div>\n                </div>"],r?[{title:"\u6d88\u606f",icon:"icon-cem_jump-message",callback:function(){return r(e,t)}}]:void 0,"yt_new_tooltip_wrapper"))}),0)}},xAxis:{type:"value",show:!1,boundaryGap:[0,.01]},yAxis:{type:"category",data:e.map((function(e){return e.country})),axisLabel:{formatter:function(e){return e.length>9?e.substring(0,5)+"...":e},color:"#626262"}},series:{type:"bar",barMaxWidth:24,xAxisIndex:0,yAxisIndex:0,datasetIndex:0,barGap:"43%",encode:{x:1,y:0},data:e.map((function(e){return{name:e.country,value:e.total,label:{show:a,position:"right",fontSize:12,color:"#262626"}}}))},grid:{left:36,right:36,top:72,bottom:36,containLabel:!0}}}(e,n,a,r,o);t(i)})).then((function(e){t.clear(),t.setOption(e)}))}function A(e){if(e&&e instanceof Array&&e.length){var t=e.findIndex((function(e){return"\u5176\u4ed6"===e.country}));if(-1!==t){var n=e[t];(e=C()(e)).splice(t,t+1),e.push(n)}}return e}const j=function(e){var t=e.data,n=e.loading,a=e.title,r=e.subTitle,o=e.onMsgClick,l=i.useState(void 0),c=l[0],s=l[1],u=i.useState(!0),d=u[0],p=u[1];return i.useEffect((function(){(0,m.P)(t)&&R(t,c,a,r,d,o)}),[t,c,d]),i.createElement(m.Z,{className:"yt_app_comment_overview_bar_chart",renderTitle:i.createElement(E.Z,{title:i.createElement("span",null,a,i.createElement("span",{style:{color:"#8c8c8c",fontWeight:400}},r)),data:t},i.createElement("div",{className:"icons"},i.createElement("div",{className:"icon"},i.createElement(g.default,{placement:"top",content:"\u663e\u793a\u56fe\u8868\u6807\u7b7e",mouseEnterDelay:.6,getPopupContainer:function(){return document.querySelector(".header_Filter_bar")}},i.createElement("i",{className:"icon-tubiaobiaoqian "+(d?"active":""),onClick:function(){return p(!d)}}))),i.createElement("div",{className:"icon"},i.createElement(g.default,{placement:"top",content:"\u5bfc\u51fa\u6570\u636e",mouseEnterDelay:.6,getPopupContainer:function(e){return e}},i.createElement("i",{className:"icon-daochu",onClick:function(){return L(c,"data",t,a)}}))),i.createElement("div",{className:"icon"},i.createElement(g.default,{placement:"top",content:"\u5bfc\u51fa\u56fe\u7247",mouseEnterDelay:.6,getPopupContainer:function(){return document.querySelector(".header_Filter_bar")}},i.createElement("i",{className:"icon-xiazaitupian",onClick:function(){return L(c,"image",t,a)}}))))),data:t,loading:n},i.createElement("div",{className:"chart"},i.createElement(N.Z,{theme:"yt_multi_color_10",option:{},style:{width:"100%",height:"100%"},onChartReady:function(e){return s(e)}})),i.createElement("div",{className:"table"},i.createElement(Z.Z,{columns:[{title:"\u56fd\u5bb6",dataIndex:"country",key:"country",align:"left"},{title:"\u8bc4\u8bba\u6570\u91cf",dataIndex:"total",key:"total",align:"left"}],dataSource:A(t),size:"small",pagination:!1,scroll:{y:400}})))};var V=n(76214),W=n(18077);const U=function(e){var t=e.pageType,n=e.filterReady,a=e.filterChange,r=e.dateOptions,o=e.onFilterChange,l=e.onFlavorChange,c=e.onMsgClick,s=e.cardData,u=e.fetchingCardData,p=e.starTrendData,m=e.fetchingStarTrendData,f=e.starTrendCountType,h=e.fStarTrendCountType,v=e.starTrendTimeType,g=e.fStarTrendTimeType,E=e.fetchingFeedbackData,T=e.feedbackData,C=e.feedbackEnablePos,b=e.fetchingHotwordData,x=e.hotwordData,_=e.hotwordEnablePos,w=e.fetchEmotionsLoading,N=e.emotionsData,D=e.emotionsTimeType,M=e.emotionsTrendCountType,O=e.fetchingCountData,F=e.countData,Z=e.fetchHotwordData,I=e.fetchFeedbackData,L=i.useState({visible:!1,word:""}),R=L[0],A=L[1],U=(0,i.useCallback)((function(e){A({visible:!0,word:e})}),[]),z=(0,i.useCallback)((function(e){A({visible:e,word:""}),Z({}),I({})}),[]);return i.createElement("div",{className:"yt_app_comment_comment_overview_wrapper"},i.createElement(d.Z,{onReady:n,onChange:a,pageType:t,advanceAuthority:!1,valueConf:["fullInfo"],hasHour:!0,showList:["fullDate","screening","save"]},i.createElement("div",{className:"content"},i.createElement(y,{cardData:s,fetchingCardData:u,onMsgClick:c}),i.createElement(P,{title:"\u5e26\u661f\u8bc4\u8bba\u5206\u5e03\u548c\u8d70\u52bf",subTitle:"\uff08\u6765\u81ea\u5168\u90e8\u8bc4\u8bba\uff09",timeOptions:r,timeType:v,fTimeType:g,countType:f,fCountType:h,data:p,loading:m,onChange:o,onFlavorChange:l,onMsgClick:c}),i.createElement(V.Z,{loading:w,chartData:N,title:"\u8bc4\u8bba\u60c5\u611f\u5206\u5e03\u548c\u8d70\u52bf",subTitle:"\uff08\u6765\u81ea\u6709\u6548\u8bc4\u8bba\uff09",cCountType:M,ctimeType:D,onTimeTypeChange:o,onMsgClick:c,dateOptions:r}),i.createElement(S.Z,{title:"\u7528\u6237\u53cd\u9988\u70ed\u8bcd",titleOverlay:i.createElement(i.Fragment,null,i.createElement("div",null,"\u6309\u6570\u91cf\u6392\u5e8f\uff1a\u7edf\u8ba1\u8ddf\u70ed\u8bcd\u76f8\u5173\u7684\u6b63\u9762/\u8d1f\u9762\u8bc4\u8bba\u6570\u91cf\u6700\u9ad8\u7684\u70ed\u8bcd\u3002"),i.createElement("div",null,"\u6309\u6bd4\u4f8b\u6392\u5e8f\uff1a\u7edf\u8ba1\u6bcf\u4e2a\u70ed\u8bcd\u76f8\u5173\u7684\u6240\u6709\u8bc4\u8bba\u4e2d\uff0c\u6b63\u9762/\u8d1f\u9762\u8bc4\u8bba\u6570\u91cf\u5360\u6bd4\u6700\u9ad8\u7684\u70ed\u8bcd\u3002")),data:T,loading:E,enablePos:C,onFilterChange:o,onWordModalView:U,onMsgClick:c,titleWords:"\u8bc4\u8bba"}),i.createElement(j,{data:F,loading:O,title:"\u5404\u56fd\u5bb6\u8bc4\u8bba\u6570\u91cf",subTitle:"\uff08\u6765\u81ea\u5168\u90e8\u8bc4\u8bba\uff09",onMsgClick:c}),i.createElement(k.Z,{title:"\u70ed\u8bcd",data:x,loading:b,enablePos:_,onFilterChange:o,onWordModalView:U,onMsgClick:c,titleWords:"\u8bc4\u8bba"}),i.createElement(W.Z,{visible:R.visible,word:R.word,onClose:z}))))};var z=n(53113),Y=n(2329),q=["loading"],H=l.Z.appComment.commentOverview,G=l.Z.IDBHeaderScreening.screening,X=function(e){function t(t){var n;return(n=e.call(this,t)||this).events=void 0,n._handleFilterReady=function(e,t){var a=(0,z.X)(e.dateFilter.numOfDays,!1),r=a.dateOptions,o=a.defaultDateType;n.props.fetchParams({projectId:s.t.get(s.V.curProject).id,headerFilterParamsNew:e.headerFilterParamsNew,dateFilter:e.dateFilter,dateOptions:r,defaultDateType:o,filterValues:t.fullInfo.filterValue})},n._handleFilterChange=function(e,t){var a=(0,z.X)(e.dateFilter.numOfDays,!1),o=a.dateOptions,i=a.defaultDateType;n.props.save({headerFilterParamsNew:e.headerFilterParamsNew,dateFilter:(0,r.Z)({},e.dateFilter,{dateGroupType:i}),defaultDateType:i,dateOptions:o,filterValues:t.fullInfo.filterValue}),n.props.save({emotionsTimeType:i,starTrendTimeType:i}),n.props.fetchDatas((0,r.Z)({},e,{dateFilter:(0,r.Z)({},e.dateFilter,{dateGroupType:i})}))},n._handleOnFilterChange=function(e){e.starTrendCountType?n.props.save(e):e.starTrendTimeType?n.props.fetchStarTrendData({starTrendTimeType:e.starTrendTimeType,dateFilter:(0,r.Z)({},n.props.dateFilter,{dateGroupType:e.starTrendTimeType})}):void 0!==e.feedbackEnablePos?n.props.fetchFeedbackData({feedbackEnablePos:e.feedbackEnablePos}):void 0!==e.hotwordEnablePos?n.props.fetchHotwordData({hotwordEnablePos:e.hotwordEnablePos}):void 0!==e.emotionsTimeType&&(n.props.save({emotionsTimeType:e.emotionsTimeType}),n.props.fetchEmotionsData({emotionsTimeType:e.emotionsTimeType,dateFilter:(0,r.Z)({},n.props.dateFilter,{dateGroupType:e.emotionsTimeType})}))},n._handleOnFlavorChange=function(e){(e.fStarTrendCountType||e.fStarTrendTimeType||e.fEmotionsTimeType)&&n.props.setDefaultValue(e)},n._handleOnMsgClick=function(e,t){var a=n.props,o=(a.curScreeningMap,a.headerFilterParamsNew),i=a.dateFilter,l=a.filterValues,c=a.projectId,s=a.starTrendTimeType,d=a.starTrendData,p=a.emotionsTimeType,m=a.emotionsData,f={dateFilter:i,projectId:c,filterModel:{project:[c],messageCategory:["APP_COMMENT"]},headerFilterParamsNew:(0,u.ZP)(o,(function(e){var t=e.find((function(e){return"DEFAULT"===e.id}));t?t.values.find((function(e){return"MESSAGE_TYPE"===e.id}))||t.values.push({id:"MESSAGE_TYPE",values:["COMMON_COMMENT","COMMON_TALK"]}):e.push({id:"DEFAULT",values:[{id:"MESSAGE_TYPE",values:["COMMON_COMMENT","COMMON_TALK"]}]})})),filterValues:l,filterTip:null};if("\u5e26\u661f\u8bc4\u8bba\u6570\u91cf"===t)f=(0,r.Z)({},f,{headerFilterParamsNew:(0,u.ZP)(f.headerFilterParamsNew,(function(e){e.push({id:"COMMENT_RELATED",values:[{id:"COMMENT_SCORE",values:["5","4","3","2","1"]}]})}))});else if("\u8bc4\u8bba\u597d\u8bc4\u7387"===t||"\u8bc4\u8bba\u5dee\u8bc4\u7387"===t)f=(0,r.Z)({},f,{headerFilterParamsNew:(0,u.ZP)(f.headerFilterParamsNew,(function(e){var n=e.find((function(e){return"DEFAULT"===e.id}));n?n.values.push({id:"EMOTION_TYPE",values:"\u8bc4\u8bba\u597d\u8bc4\u7387"===t?["positive"]:["negative"]}):e.push({id:"DEFAULT",values:[{id:"EMOTION_TYPE",values:"\u8bc4\u8bba\u597d\u8bc4\u7387"===t?["positive"]:["negative"]}]})}))});else if("\u5e26\u661f\u8bc4\u8bba\u5206\u5e03\u548c\u8d70\u52bf\uff08\u6765\u81ea\u5168\u90e8\u8bc4\u8bba\uff09"===t)if(e instanceof Array&&"bar"===e[0].seriesType){var h=e[0].axisValue;f=(0,r.Z)({},f,{filterValues:(0,u.ZP)(f.filterValues,(function(e){e.push({id:"COMMENT_RELATED",values:[{id:"COMMENT_SCORE",label:"\u8bc4\u8bba\u661f\u7ea7",values:[F[h]]}]})})),headerFilterParamsNew:(0,u.ZP)(f.headerFilterParamsNew,(function(e){e.push({id:"COMMENT_RELATED",values:[{id:"COMMENT_SCORE",values:[String(parseInt(h))]}]})}))})}else"line"===e.seriesType&&(f=(0,r.Z)({},f,{dateFilter:(0,Y.X_)("line",i,e.name,d.find((function(e){return e.total>0})).dataList.map((function(e){return e.time})),s),filterValues:(0,u.ZP)(f.filterValues,(function(t){t.push({id:"COMMENT_RELATED",values:[{id:"COMMENT_SCORE",label:"\u8bc4\u8bba\u661f\u7ea7",values:[F[e.seriesName]]}]})})),headerFilterParamsNew:(0,u.ZP)(f.headerFilterParamsNew,(function(t){t.push({id:"COMMENT_RELATED",values:[{id:"COMMENT_SCORE",values:[String(parseInt(e.seriesName))]}]})}))}));"\u7528\u6237\u53cd\u9988\u70ed\u8bcd"===t&&(f=(0,r.Z)({},f,{headerFilterParamsNew:(0,u.ZP)(f.headerFilterParamsNew,(function(t){var n=t.find((function(e){return"DEFAULT"===e.id}));n?n.values.push({id:"EMOTION_TYPE",values:[e.seriesName]}):t.push({id:"DEFAULT",values:[{id:"EMOTION_TYPE",label:"\u6570\u636e\u6709\u6548\u6027",values:[e.seriesName]}]})})),textRankWord:e.name,textRankWordPos:e.data.pos,filterModel:{project:[c]}})),"\u70ed\u8bcd\uff08\u6765\u81ea\u6709\u6548\u8bc4\u8bba\uff09"===t&&(f=(0,r.Z)({},f,{textRankWord:e.name,textRankWordPos:e.data.pos,filterModel:{project:[c]}})),"TOP10\u70ed\u8bcd\uff08\u6765\u81ea\u6709\u6548\u8bc4\u8bba\uff09"===t&&(f="label"===e.name?(0,r.Z)({},f,{textRankWord:e.seriesName,textRankWordPos:e.data.total.pos,filterModel:{project:[c]}}):(0,r.Z)({},f,{headerFilterParamsNew:(0,u.ZP)(f.headerFilterParamsNew,(function(t){var n=t.find((function(e){return"DEFAULT"===e.id}));n?n.values.push({id:"EMOTION_TYPE",values:e.data.emotion}):t.push({id:"DEFAULT",values:[{id:"EMOTION_TYPE",values:e.data.emotion}]})})),textRankWord:e.seriesName,textRankWordPos:e.data.pos,filterModel:{project:[c]}})),"\u8bc4\u8bba\u60c5\u611f\u5206\u5e03\u548c\u8d70\u52bf\uff08\u6765\u81ea\u6709\u6548\u8bc4\u8bba\uff09"===t&&("bar"===e.seriesType&&(f.dateFilter=(0,Y.X_)("line",i,e.data.originTime.replace(/\//g,"-"),m.find((function(e){return e.total>0})).dataList.map((function(e){return e.time})),p)),f=(0,r.Z)({},f,{headerFilterParamsNew:(0,u.ZP)(f.headerFilterParamsNew,(function(t){var n=t.find((function(e){return"DEFAULT"===e.id}));n?n.values.push({id:"EMOTION_TYPE",values:[e.eomtionsType]}):t.push({id:"DEFAULT",values:[{id:"EMOTION_TYPE",label:"\u6570\u636e\u6709\u6548\u6027",values:[e.eomtionsType]}]})})),filterModel:{project:[c]}})),"\u5404\u56fd\u5bb6\u8bc4\u8bba\u6570\u91cf"===t&&(f=(0,r.Z)({},f,{headerFilterParamsNew:(0,u.ZP)(f.headerFilterParamsNew,(function(t){var n=t.find((function(e){return"PRODUCT_INFO"===e.id}));n?n.values.push({id:"PRODUCT_COUNTRY",values:[e.name]}):t.push({id:"PRODUCT_INFO",values:[{id:"PRODUCT_COUNTRY",values:[e.name]}]})})),filterModel:{project:[c]}})),window.open("/inbox/app?"+encodeURIComponent(JSON.stringify(f)))},n.events={filterReady:n._handleFilterReady,filterChange:n._handleFilterChange,onFilterChange:n._handleOnFilterChange,onFlavorChange:n._handleOnFlavorChange,onMsgClick:n._handleOnMsgClick},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentWillUnmount=function(){this.props.clean()},n.render=function(){return i.createElement(U,(0,r.Z)({},this.props,this.state,this.events))},t}(i.Component);const J=(0,c.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,q);return(0,r.Z)({},n[H],{curScreeningMap:n[G].curScreeningMap,fetchingCardData:t.effects[H+"/fetchCardData"]||!1,fetchingStarTrendData:t.effects[H+"/fetchStarTrendData"]||!1,fetchingFeedbackData:t.effects[H+"/fetchFeedbackData"]||!1,fetchingHotwordData:t.effects[H+"/fetchHotwordData"]||!1,fetchingCountData:t.effects[H+"/fetchCountData"]||!1,fetchEmotionsLoading:t.effects[H+"/fetchEmotionsData"]||!1})}),(function(e){return{save:function(t){return e({type:H+"/save",payload:t})},clean:function(){return e({type:H+"/clean"})},fetchParams:function(t){return e({type:H+"/fetchParams",payload:t})},fetchDatas:function(t){return e({type:H+"/fetchDatas",payload:t})},fetchCardData:function(t){return e({type:H+"/fetchCardData",payload:t})},fetchStarTrendData:function(t){return e({type:H+"/fetchStarTrendData",payload:t})},setDefaultValue:function(t){return e({type:H+"/setDefaultValue",payload:t})},fetchFeedbackData:function(t){return e({type:H+"/fetchFeedbackData",payload:t})},fetchHotwordData:function(t){return e({type:H+"/fetchHotwordData",payload:t})},fetchCountData:function(t){return e({type:H+"/fetchCountData",payload:t})},fetchEmotionsData:function(t){return e({type:H+"/fetchEmotionsData",payload:t})}}}))(X)},94530:(e,t,n)=>{n.d(t,{Z:()=>M});var a=n(87462),r=n(63366),o=n(67294),i=n(25713),l=n(43036),c=n(45697),s=n.n(c),u=n(38263),d=n(57522),p=[{value:"WEEK",label:"\u5468"},{value:"MONTH",label:"\u6708"},{value:"QUATER",label:"\u5b63"},{value:"YEAR",label:"\u5e74"}],m=function(e){var t=e.value,n=e.getValue,a=o.useState(t),r=a[0],i=a[1];return o.createElement("div",{className:"yt_modal_dashboard_edit_wrapper"},o.createElement("div",{className:"content_item"},o.createElement("span",null,"\u540c\u6bd4\u7c7b\u578b"),o.createElement("span",null,o.createElement(u.ZP,{className:"content_item_select",value:(p.find((function(e){return e.value===r}))||{}).label,onChange:function(e){return function(e){i(e),setTimeout((function(){return n&&n(e)}),0)}(e)},inputIcon:o.createElement("i",{className:"icon-cem_arrow-launches",style:{color:"#8C8C8C"}})},p.map((function(e){return o.createElement(u.ZP.Option,{value:e.value,key:e.value},e.label)}))))))},f=function(e){return new Promise((function(t,n){var r=e.value,i=(0,a.Z)({},e,{titleText:o.createElement("div",{className:"indicator_card_comfirm"},o.createElement("span",null,"\u540c\u6bd4\u8bbe\u7f6e"),o.createElement("span",{onClick:function(){return window.open("https://www.yuque.com/docs/share/5615d490-0056-4bb9-b208-bf747c9048c0")}},"\u67e5\u770b\u66f4\u591a")),content:o.createElement(m,(0,a.Z)({},e,{getValue:function(e){r=e}}))});i.onOk=function(){return t(r)},i.onCancel=n,(0,d.Z)(i)}))};const h=f;f.propTypes={getValue:s().func,value:s().string};var v=n(8201),y=n(39432),g=n(94644),E=n(29531),T=n.n(E),C=n(93162),b=function(e){return!["",null,void 0].includes(e)},x=[{title:"\u5bfc\u51fa\u56fe\u7247",type:"image"},{title:"\u5bfc\u51fa\u6570\u636e",type:"data"}],_=[{title:"\u8bbe\u7f6e\u540c\u6bd4",type:"compare"}],w=function(e){return e&&e.length>6?String(e).substring(0,6)+"...":e},N=function(e,t,n){if("image"===e)r=t,o=(0,g.UO)(n[0]&&n[0].name),new Promise((function(e){var t=r.offsetWidth,n=r.cloneNode(!0),a=document.createElement("canvas");a.width=12*t,a.height=1920,a.style.width=t+"px",a.style.height="160px",a.className="yt_trend_list_canvas",a.getContext("2d").scale(12,12),n.style.width=t+"px",n.style.height="160px",n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.zIndex=-1,n.style.opacity=0,document.body.appendChild(n),T()(n,{allowTaint:!0,taintTest:!1,canvas:a,useCORS:!0,width:t,height:160,onrendered:function(e){document.body.appendChild(e);var t=e.toDataURL("png");(0,C.saveAs)(t,o,"image/png"),setTimeout((function(){document.body.removeChild(n),document.body.removeChild(document.querySelector(".yt_trend_list_canvas"))}),0)}})}));else if("data"===e){var a=[n.reduce((function(e,t){return[].concat(e,[[t.name,t.count]])}),[])];(0,g.aT)(a,n[0]&&n[0].name)}var r,o};var D=["data","tip","compare","onSetting","loading","paragraph","onMsgClick"];const M=function(e){var t=e.data,n=e.tip,c=e.compare,s=e.onSetting,u=e.loading,d=e.paragraph,p=e.onMsgClick,m=(0,r.Z)(e,D),f=o.useState(),g=f[0],E=f[1],T=function(e){return t&&t[e]?t[e]:{}},C=function(e){if(T(e).name){if(b(T(e).count)){var t=T(e).count;switch(T(e).format){case"myriad":t=(0,y.hE)(t);break;case"percent":n=t,t=b(null)?null:0===n?"0.00%":Math.abs(100*n).toFixed(2)+"%"}return t}return"--"}var n;return""},M=function(e){return"myriad"===T(e).format?T(e).count.toLocaleString():C(e)};return o.createElement("div",(0,a.Z)({className:"indicator_card"},m,{ref:function(e){return E(e)}}),o.createElement(v.Z,{data:t,className:"section_com",loading:u,paragraph:d},o.createElement("div",{className:"title_wrap"},o.createElement("span",{className:"chart_title"},o.createElement("span",{className:"chart_title_name"},T(0).name,n&&o.createElement(l.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:n},o.createElement("i",{className:"icon-cem_file1","data-html2canvas-ignore":!0})))),o.createElement("span",{className:"chart_title_buttons","data-html2canvas-ignore":!0},o.createElement(i.Z,{onClick:function(e){"compare"===e?h({value:c}).then((function(e){s&&s({compareValue:e})})):N(e,g,t)},options:x.concat(s?_:[])}))),o.createElement("div",{className:"section_mid"},o.createElement("p",null,o.createElement(l.Z,{placement:"top",overlay:M(0)},o.createElement("section",null,C(0)))),T(1).name||T(2).name?o.createElement("p",null,o.createElement("span",null,o.createElement("span",null,o.createElement(l.Z,{placement:"top",overlay:T(1).name},o.createElement("section",{className:"name"},T(1).name))),o.createElement("span",null,o.createElement(l.Z,{placement:"top",overlay:M(1)},o.createElement("section",null,C(1))),"boolean"===typeof T(1).rise&&o.createElement("i",{className:T(1).rise?"icon-cem_three-states-up":"icon-cem_three-states-down"}))),o.createElement("span",null,o.createElement("span",null,o.createElement(l.Z,{placement:"top",overlay:T(2).name},o.createElement("section",{className:"name"},T(2).name))),o.createElement("span",null,o.createElement(l.Z,{placement:"top",overlay:M(2)},o.createElement("section",null,C(2))),"boolean"===typeof T(2).rise&&o.createElement("i",{className:T(2).rise?"icon-cem_three-states-up":"icon-cem_three-states-down"})))):null),(T(3).name||T(4).name)&&o.createElement("div",{className:"section_bottom"},o.createElement("span",null,o.createElement("span",null,o.createElement(l.Z,{placement:"top",overlay:T(3).name},o.createElement("section",{className:"name"},T(4).name?w(T(3).name):T(3).name))),o.createElement("span",null,o.createElement(l.Z,{placement:"top",overlay:M(3)},o.createElement("section",null,C(3))))),T(4).name?o.createElement("span",null,o.createElement("span",null,o.createElement(l.Z,{placement:"top",overlay:T(4).name},o.createElement("section",{className:"name"},w(T(4).name)))),o.createElement("span",null,o.createElement(l.Z,{placement:"top",overlay:M(4)},o.createElement("section",null,C(4))))):null,p&&o.createElement("span",{className:"toMsg",onClick:function(){return p(t)}},"\u67e5\u770b\u8be6\u60c5"))))}}}]);