"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[5304],{35304:(e,t,n)=>{n.r(t),n.d(t,{default:()=>W});var a=n(63366),i=n(87462),r=n(94578),o=n(67294),l=n(55609),s=n(55815),c=n(39432),u=n(65556),d=n(70715),p=n(90126);const m=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))||this).chartRef=void 0,t.dimensions=void 0,t.source=void 0,t.chartLength=0,t.color=void 0,t.onChartReady=function(e){t.chartRef=e},t.setValue=function(e,n){t.chartLength=e.length,t.color=d.Fq.slice(),t.dimensions=["\u65e5\u671f"],t.source=JSON.parse((0,u.WZ)(e)).reduce((function(e,a,i){t.dimensions.push(a.name);var r=p.fv[a.name.toLocaleLowerCase()];return r&&t.color.splice(i,0,r[""===n?1:3===n?0:2]),a.dateList.forEach((function(t,a){0===i?e.push([t.date,3===n?t.negative:8===n?t.positive:t.count]):e[a].push(3===n?t.negative:8===n?t.positive:t.count)})),e}),[])},t.getOption=function(){return{grid:{top:80,left:20,right:40,bottom:40,containLabel:!0},color:t.color,dataset:[{source:t.source,dimensions:t.dimensions}],legend:{top:40,left:20,itemWidth:14,itemHeight:12,type:"scroll",pageIconSize:12,icon:d.W4.lineRing},dataZoom:[{show:"slider",bottom:15,xAxisIndex:0,height:15,handleSize:"100%",showDetail:!1}],tooltip:{trigger:"item",formatter:function(e){var t=e.name,n=e.marker,a=e.seriesName,i=e.seriesIndex,r=e.data[i+1];return'<span class="yt_echart_tooltip_title">\n        \u58f0\u91cf<span style="color: #8C8C8C;font-weight: 500;">\uff08'+t+"\uff09</span></span><br />"+n+" "+a+"\uff1a"+c.ZP.getApproximateNum(r)}},xAxis:{type:"category",boundaryGap:!1,axisLabel:{formatter:function(e){return(0,c.yV)(t.dateType,e)}}},yAxis:{type:"value"},series:Array.from({length:t.chartLength}).map((function(e,t){return{type:"line"}}))}},t}return(0,r.Z)(t,e),t.prototype.renderChart=function(e,t){this.setValue(e,t),this.chartRef.clear(),this.chartRef.setOption(this.getOption())},t}(o.PureComponent);var f=n(8201),g=n(98191),h=n(50976),E=n(94644),v=n(45697),y=n.n(v),_=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))||this)._handleOnMoreClick=function(e){var n=t.props.title;"image"===e&&t.chartRef?(0,E._v)(t.chartRef,n):"data"===e&&(0,E.aT)([[t.dimensions].concat(t.source)],n)},t}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){var t=e.data,n=this.props.data,a=t?t.dataList:void 0,i=n?n.dataList:void 0;(0,f.P)(n)&&JSON.stringify(a)!==JSON.stringify(i)&&this.renderChart(),!(0,f.P)(n)&&this.chartRef&&(this.chartRef=void 0)},n.renderChart=function(){var t=this.props,n=t.data,a=t.aspectEmotion;(0,f.P)(n)&&this.chartRef&&e.prototype.renderChart.call(this,n.dataList,a)},n.render=function(){var e=this.props,t=e.data,n=e.loading,a=e.title,i=e.onClick,r=e.titleOverlay;return o.createElement(f.Z,{data:t,loading:n,className:"yt_social_analysis_top_detail_trend_chart_wrapper",renderTitle:o.createElement(g.Z,{onMoreClick:this._handleOnMoreClick,title:a,titleOverlay:r,data:""})},o.createElement("div",{className:"content"},o.createElement("div",{className:"info_section"},t&&o.createElement(o.Fragment,null,o.createElement("div",{className:"info_main"},c.ZP.getApproximateNum(t.total)),!!t.near30Total&&o.createElement("div",{className:"info_bottom"},o.createElement("span",{className:"bottom_content"},"\u8fd130\u5929\u603b\u91cf ",o.createElement("span",null,c.ZP.getApproximateNum(t.near30Total))),o.createElement("span",{className:"bottom_content"},"\u8fd130\u5929\u5e73\u5747",o.createElement("span",null,c.ZP.getApproximateNum(Math.ceil(t.near30Total/30))))))),o.createElement(h.Z,{option:{},className:"chart_section yt_echarts_style",theme:"yunting_multi_color",onChartReady:this.onChartReady,style:{height:"100%"},onEvents:{click:i}})))},t}(m);const C=_;_.propTypes={data:y().any,title:y().string,loading:y().bool,total:y().number};var S=n(92360),b=n(25022),N=n(30381),T=n.n(N),R=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnShowAllContentClick=function(){n.setState({isCollapse:!n.state.isCollapse})},n.msgElm,n.state={showCollapse:!1,isCollapse:!1},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props.index;this.msgElm=document.getElementById("detail_content_"+e),this.msgElm&&this.msgElm.clientHeight>138&&this.setState({showCollapse:!0,isCollapse:!0})},n.render=function(){var e=this,t=this.props,n=t.content,a=t.index,i=t.className,r=this.state,l=r.showCollapse,s=r.isCollapse;return o.createElement("div",{className:"yt_social_detail_content_wrapper "+(i||""),style:{height:s?138:"unset"}},o.createElement("div",{id:"detail_content_"+a,dangerouslySetInnerHTML:{__html:n}}),l&&o.createElement("div",{className:"content_toggle "+(s?"collapsed":"showed"),ref:function(t){return e.showAllRef=t},onClick:this._handleOnShowAllContentClick},s?"\u70b9\u51fb\u663e\u793a\u5168\u6587":"\u6536\u8d77\u5168\u6587"))},t}(o.PureComponent);const O=R;R.propTypes={content:y().string,index:y().number,className:y().string};var P=n(7732),A=function(e){var t=e.data,n=e.loading,a=e.pageIndex,i=e.pageSize,r=e.onPageChange,l=e.onPageSizeChange,s=e.onMsgClick;return o.createElement(f.Z,{className:"yt_social_tag_messagelist_wrapper",loading:n,data:t,renderTitle:o.createElement("div",null,o.createElement("span",null,"\u6d88\u606f\u8be6\u60c5"),o.createElement(S.Button,{type:"primary",onClick:s},"\u524d\u5f80\u6d88\u606f\u6a21\u5757\u4e0b\u8f7d"))},t&&o.createElement("div",{className:"msg_content"},o.createElement("div",{className:"msg_total"},"\u5171",o.createElement("span",null,t.total),"\u6761\u6d88\u606f"),t.list&&t.list.length>0&&t.list.map((function(e,t){return o.createElement("div",{key:e.username+e.createTime,className:"msg_item"},o.createElement("div",{className:"msg_top"},o.createElement("span",{className:"user_info"},o.createElement("img",{src:e.userImage||P}),o.createElement("span",null,e.username)),o.createElement("span",{className:"msg_info"},o.createElement("span",null,T()(e.createTime).format("YYYY-MM-DD HH:MM")),o.createElement("span",null,e.type))),o.createElement(O,{className:"msg",index:t,content:e.content}))})),o.createElement(b.Z,{currLength:t.list.length,pageNum:t.list&&t.list.length,onPageChange:r,onSizeChange:l,total:t.total||0,pageIndex:a,pageSize:i})))};const M=A;function I(e){var t=e.reduce((function(e,t){return e+t.count}),0);return{datasets:[{dimensions:["\u673a\u578b","\u58f0\u91cf","\u5360\u6bd4"],source:e.map((function(e){return[e.type,e.count,e.count/t]}))}]}}A.PropTypes={data:y().any,pageIndex:y().number,pageSize:y().number,loading:y().bool,onPageChange:y().func,onPageSizeChange:y().func};var L=function(e){var t=e.title,n=e.data,a=e.otherNum,i=e.loading,r=o.useState(void 0),l=r[0],s=r[1];return o.useEffect((function(){if(l)if((0,f.P)(n)){var e=function(e,t,n){return t>0&&e.push({type:"\u5176\u4ed6",count:t}),{title:{text:n},tooltip:{triger:"item",formatter:function(e){return e.marker+" "+e.name+"\uff1a"+e.value+"\uff08"+e.percent+"%\uff09"}},series:[{type:"pie",radius:"60%",hoverAnimation:!1,center:["50%","55%"],label:{position:"outside",color:"#000",formatter:function(t){var n=t.data;return["{a|"+n.name+"}","{b|"+(n.value/e.reduce((function(e,t){return e+t.count}),0)*100).toFixed(2)+"% }"].join("\n")},rich:{a:{color:"#000000"},b:{color:"#8C8C8C",lineHeight:14,verticalAlign:"bottom"}}},labelLine:{smooth:!0,length:13,lineStyle:{color:"#bfbfbf"}},data:I(e).datasets[0].source.map((function(e,t){var n=t<8;return{value:e[1],name:e[0],label:{show:n},labelLine:{show:n},emphasis:{label:{show:n},labelLine:{show:n}}}}))}]}}(n,a,t);l.clear(),l.setOption(e)}else s(void 0)}),[n,l]),o.createElement(f.Z,{className:"yt_social_detail_pie_wrapper",data:n,loading:i,renderTitle:o.createElement(g.Z,{title:t,data:n,onMoreClick:function(e){return function(e,t,n,a){if("image"===t)(0,E._v)(e,a);else if("data"===t){var i=I(n).datasets,r=[i[0].dimensions].concat(i[0].source);(0,E.aT)([r],a)}}(l,e,n,t)}})},o.createElement(h.Z,{theme:"yunting_multi_color",className:"yt_echarts_style",option:{},style:{width:"100%",height:"100%"},onChartReady:function(e){return s(e)}}))};const w=L;L.propTypes={title:y().string,loading:y().bool,data:y().oneOfType([y().string,y().object]),onClick:y().func};const k=function(e){var t=e.trendData,n=e.fetchingTrendData,a=e.messageData,i=e.pageIndex,r=e.pageSize,l=e.fetchingMessageList,c=e.onPageChange,u=e.onPageSizeChange,d=e.pageType,p=e.aspectEmotion,m=e.params,f=e.seriesLoading,g=e.seriesData,h=e.seriesOther,E=e.onSeriesClick,v=e.onMsgClick;return o.createElement("div",{className:"yt_social_tag_detail_wrapper"},o.createElement(s.Z,{title:"\u8be6\u60c5\uff1a"+m.analyseName+"\u3001"+m.aspect+"\u3001"+m.seriesName}),o.createElement("div",{className:"content",id:"social_tag_detail_content"},o.createElement(C,{title:"\u6307\u6807\u58f0\u91cf\u8d70\u52bf",titleOverlay:"\u6307\u6807\u58f0\u91cf\u662f\u6307\u6807\u7684\u51fa\u73b0\u5728\u6d88\u606f\u4e2d\u7684\u6b21\u6570\u3002\u5982\u679c\u4e00\u4e2a\u6d88\u606f\u4e2d\u542b\u6709\u4e24\u4e2a\u4e24\u4e2a\u4e8c\u7ea7\u6307\u6807\uff0c\u5219\u5728\u7edf\u8ba1\u5bf9\u5e94\u7684\u4e00\u7ea7\u6307\u6807\u65f6\uff0c\u5219\u58f0\u91cf\u4f1a\u88ab\u7edf\u8ba1\u4e3a2\u3002",data:t,loading:n,aspectEmotion:p,onClick:E}),d.includes("brand")&&o.createElement(w,{title:"\u673a\u578b\u6307\u6807\u58f0\u91cf\u5360\u6bd4\u5206\u6790",data:g,otherNum:h,loading:f}),o.createElement(M,{data:a,loading:l,pageIndex:i,pageSize:r,onPageChange:c,onPageSizeChange:u,onMsgClick:v})))};var x=n(35239),D=n(64396),Z=n(87219),z=["loading"],U=D.Z.social.tag.detail,B=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnPageSizeChange=function(e){n.props.fetchMessageList({pageSize:e,pageIndex:1})},n._handleOnPageChange=function(e){n.props.fetchMessageList({pageIndex:e})},n._handleOnSeriesClick=function(e){e.seriesType;var t=e.name,a=e.seriesName,i=n.props,r=i.dateFilter,o=i.projectId,l=i.pageType,s=i.filterModel,c=i.aspectEmotion,d=i.label,p=i.trendData;if("\u5176\u4ed6"!==t){var m=s.some((function(e){return"TAG_RULE"===e.id}))&&s.find((function(e){return"TAG_RULE"===e.id})).values,f=s.some((function(e){return"DEFAULT"===e.id}))&&s.find((function(e){return"DEFAULT"===e.id})),g=s.some((function(e){return"BRAND_SERIES"===e.id}))&&s.find((function(e){return"BRAND_SERIES"===e.id})).values.some((function(e){return"SERIES"===e.id}))&&s.find((function(e){return"BRAND_SERIES"===e.id})).values.find((function(e){return"SERIES"===e.id})).values,h=g&&g.map((function(e){return e.split("_")[0]})),E={projectId:o,dateFilter:(0,Z.ZP)(r,(function(e){e.from=t,e.to=t})),filterModel:{label:d,emotion:(0,u.jn)(c),messageType:["QUE_ANS_QUESTION","QUE_ANS_ANSWER","WEIBO","WEIBO_REPORT","COMMON_POST","NEWS_TEXT","COMPLAINT"],filterTip:"\u8206\u60c5\u770b\u677f/\u6807\u7b7e\u5206\u6790/\u6807\u7b7eTop30\uff08"+(l.includes("brand")?"\u54c1\u724c":"\u673a\u578b")+"\uff09/\u58f0\u91cf\u8d70\u52bf"}};if(m&&(E.filterModel.tag=m.map((function(e){return{id:e.id,special:"tag",values:e.values}}))),f&&f.values.some((function(e){return"SOURCE"===e.id}))&&(E.filterModel.source=f.values.find((function(e){return"SOURCE"===e.id})).values),l.includes("brand")){var v=p.dataList.find((function(e){return e.name===a})).id;E.filterModel.brandsSeries=[{id:"brand",special:"brandsSeries",values:[v]}],g&&E.filterModel.brandsSeries.unshift({id:"series",special:"brandsSeries",values:h})}else E.filterModel.brandsSeries=[{id:"series",special:"brandsSeries",values:h}];window.open("/inbox/public?"+encodeURIComponent(JSON.stringify(E)))}},n._handleOnMsgClick=function(){var e=n.props,t=e.dateFilter,a=e.projectId,i=e.pageType,r=e.aspectEmotion,o=e.filterModel,l=e.label,s=o.some((function(e){return"VOC_ASPECT"===e.id}))&&o.find((function(e){return"VOC_ASPECT"===e.id})).values,c=o.some((function(e){return"TAG_RULE"===e.id}))&&o.find((function(e){return"TAG_RULE"===e.id})).values,d=o.some((function(e){return"DEFAULT"===e.id}))&&o.find((function(e){return"DEFAULT"===e.id})),m=o.some((function(e){return"BRAND_SERIES"===e.id}))&&o.find((function(e){return"BRAND_SERIES"===e.id})).values.some((function(e){return"BRAND"===e.id}))&&o.find((function(e){return"BRAND_SERIES"===e.id})).values.find((function(e){return"BRAND"===e.id})).values,f=m&&m.map((function(e){return e.split("_")[0]})),g=o.some((function(e){return"BRAND_SERIES"===e.id}))&&o.find((function(e){return"BRAND_SERIES"===e.id})).values.some((function(e){return"SERIES"===e.id}))&&o.find((function(e){return"BRAND_SERIES"===e.id})).values.find((function(e){return"SERIES"===e.id})).values,h=g&&g.map((function(e){return e.split("_")[0]})),E={projectId:a,dateFilter:t,filterModel:{emotion:(0,u.jn)(r),messageType:["QUE_ANS_QUESTION","QUE_ANS_ANSWER","WEIBO","WEIBO_REPORT","COMMON_POST","NEWS_TEXT","COMPLAINT"],label:l},filterTip:"\u8206\u60c5\u770b\u677f/\u6807\u7b7e\u5206\u6790/\u6807\u7b7eTop30\uff08"+(i.includes("brand")?"\u54c1\u724c":"\u673a\u578b")+"\uff09/\u6d88\u606f\u8be6\u60c5"};c&&(E.filterModel.tag=c.map((function(e){return{id:e.id,special:"tag",values:e.values}}))),d&&d.values.some((function(e){return"SOURCE"===e.id}))&&(E.filterModel.source=d.values.find((function(e){return"SOURCE"===e.id})).values),s&&(E.filterModel.vocAspect=(0,p.ou)(s)),i.includes("brand")?(E.filterModel.brandsSeries=[{id:"brand",special:"brandsSeries",values:f}],g&&E.filterModel.brandsSeries.unshift({id:"series",special:"brandsSeries",values:h})):E.filterModel.brandsSeries=[{id:"series",special:"brandsSeries",values:h}],window.open("/inbox/public?"+encodeURIComponent(JSON.stringify(E)))},n.queryParam=JSON.parse(decodeURIComponent(window.location.search.substring(1))),n.state={pageType:n.queryParam.pageType,aspectEmotion:n.queryParam.aspectEmotion,params:{analyseName:n.queryParam.name,aspect:n.queryParam.aspect,seriesName:n.queryParam.aspectEmotion?3===n.queryParam.aspectEmotion?"\u8d1f\u9762":"\u6b63\u9762":"\u5168\u90e8"}},n.event={onSeriesClick:n._handleOnSeriesClick,onPageChange:n._handleOnPageChange,onPageSizeChange:n._handleOnPageSizeChange,onMsgClick:n._handleOnMsgClick},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.fetchDatas((0,i.Z)({},this.queryParam,{projectId:x.t.get(x.V.curProject).id}))},n.render=function(){return o.createElement(k,(0,i.Z)({},this.props,this.state,this.event))},t}(o.PureComponent);const W=(0,l.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,z);return(0,i.Z)({},n[U],{seriesLoading:t.effects[U+"/fetchSeriesData"]||!1,fetchingTrendData:t.effects[U+"/fetchTrendData"]||!1,fetchingMessageList:t.effects[U+"/fetchMessageList"]||!1})}),(function(e){return{fetchDatas:function(t){return e({type:U+"/fetchDatas",payload:t})},fetchMessageList:function(t){return e({type:U+"/fetchMessageList",payload:t})},save:function(t){return e({type:U+"/save",payload:t})},clean:function(t){return e({type:U+"/clean",payload:t})}}}))(B)},55815:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(94578),i=n(67294),r=n(45697),o=n.n(r),l=n(43036),s=n(61409),c=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props,a=n.title,i=n.beforeJump;e!==a.length-1&&(i?new Promise((function(e,t){return i(e,t)})).then((function(){s.mW.push({pathname:a[e].url,state:a[e].state})})):s.mW.push({pathname:a[e].url,state:a[e].state}))},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.mainTitle,r=t.rightContent,o=t.className,s=t.overlay;return i.createElement("div",{className:"breadcumb-wrapper "+o},n instanceof Array?i.createElement("div",{className:"breadcrumb-left"},i.createElement("div",null,n.map((function(t,a){return i.createElement("span",{className:t.url?"":"not_clickable",key:a,onClick:function(){return t.url&&a!==n.length-1&&e._handleBreadcrumbClick(a)}},t.title,a!==n.length-1&&" / ")}))),i.createElement("span",null,a||n[n.length-1].title,s&&i.createElement(l.Z,{placement:"top",overlay:s},i.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}})))):i.createElement("div",{className:"normal-title"},n,s&&i.createElement(l.Z,{placement:"top",overlay:s},i.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}}))),r||"")},t}(i.Component);c.propTypes={className:o().string,title:o().oneOfType([o().string,o().arrayOf(o().shape({title:o().string,url:o().string,state:o().object}))]).isRequired,overlay:o().oneOfType([o().string,o().node]),mainTitle:o().oneOfType([o().string,o().node]),beforeJump:o().func,rightContent:o().node};const u=c},25022:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(67294),i=n(92360),r=n(35303),o=n(45697),l=n.n(o),s=[{label:"10\u9879/\u9875",value:10},{label:"20\u9879/\u9875",value:20},{label:"40\u9879/\u9875",value:40},{label:"100\u9879/\u9875",value:100}];const c=function(e){var t=e.onPageChange,n=e.onSizeChange,o=e.total,l=void 0===o?0:o,c=e.pageIndex,u=e.pageSize,d=e.layout,p=e.className,m=e.currLength,f=0===l?0:(c-1)*u+1,g=0===l?0:m?f+m-1:f+u-1;return 0===l?null:a.createElement("div",{className:"yt-awp-pagination "+(p||"")},a.createElement("span",{className:"total_num"},a.createElement("span",null,f+" - "+g+" "),"\u9879\uff0c\u5171",a.createElement("span",null," "+l+" "),"\u9879"),a.createElement("div",{style:{textAlign:"right",float:"right"},className:"new_pagination"},a.createElement(i.Pagination,{small:!0,pageSize:u,currentPage:c,pageCount:Math.ceil(l/u),layout:0===l?"":"prev, pager, next",onCurrentChange:t}),void 0===d||d.includes("sizes")?a.createElement(r.RS,{multiple:!1,tags:!1,showSearch:!1,optionFilterProp:"label",optionLabelProp:"label",animation:"slide-up",dropdownClassName:"custom-pagination-dropdown",value:u||10,onChange:n},s.map((function(e,t){return a.createElement(r.Wx,{key:t,label:e.label,value:e.value},e.label)}))):null))};l().propTypes={onPageChange:l().func,onSizeChange:l().func,total:l().number,pageIndex:l().number,pageSize:l().number,layout:l().string,className:l().string}}}]);