"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[6083],{86083:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var a=n(94578),i=n(87462),r=n(63366),c=n(67294),o=n(5133),s=n(29383),l=n(55815),u=n(13713),p=n(61193),m=n(88308),d=n(61409),h=n(35239),f=n(55609),E=n(92360),g=n(5747),v=n(49722),N=n(64396),y=["loading"],b=N.Z.public.menu,S=[{icon:"icon-cem_data-task",name:"\u6570\u636e\u94fe\u63a5",id:"userConnectionTotal",authority:["COMMENT_SMART_SUBSCRIPTION","COMMENT_CONNECTION_MANAGER","MONITORING_SMART_SUBSCRIPTION","MONITORING_CONNECTION_MANAGER"],route:p.Z.hasAuthority("COMMENT_SMART_SUBSCRIPTION")?"/account/project/comment/subscribe":p.Z.hasAuthority("COMMENT_CONNECTION_MANAGER")?"/account/project/comment/link":p.Z.hasAuthority("MONITORING_SMART_SUBSCRIPTION")?"/account/project/price/subscribe":"/account/project/price/link"},{icon:"icon-cem_theme-management",name:"\u4e3b\u9898",id:"topicTotal",authority:["THEME_COMMENT"],route:"/account/project/linkTopic"},{icon:"icon-cem_label-management",name:"\u6807\u7b7e",id:"tagTotal",authority:["TAG"],route:"/account/project/tag"},{icon:"icon-cem_private-information",name:"\u6d88\u606f\u5904\u7406\u89c4\u5219",id:"messageRuleTotal",authority:["MESSAGE_RULE"],route:"/account/project/messageRule"},{icon:"icon-cem_invalid-message",name:"\u65e0\u6548\u6d88\u606f",id:"garbageRuleTotal",authority:["SMART_USELESS_MESSAGE"],route:"/account/project/uselessMsg/smart"},{icon:"icon-cem_invalid-words",name:"\u65e0\u6548\u8bcd\u7ba1\u7406",id:"garbageWordTotal",authority:["USELESS_WORD_MANAGE"],route:"/account/project/uselessWord"},{icon:"icon-cem_index-system",name:"\u6307\u6807\u4f53\u7cfb",id:"overallAspectTotal",authority:["ASPECT_TREE_SETTING"],route:"/account/project/aspectSystem/global"},{icon:"icon-cem_words-list",name:"\u9884\u8b66\u7ba1\u7406",id:"warningTotal",authority:["WARNING_MANAGE_RULE"],route:"/account/project/warning/overview"},{icon:"icon-shujufankui",name:"\u6570\u636e\u53cd\u9988",id:"dataFeedbackTotal",authority:["DATA_FEEDBACK"],route:"/account/project/dataFeedback"}],C=function(e){function t(t){var n;return(n=e.call(this,t)||this).fetchList=function(){v.h.post("/projects/overview/find",{id:n.state.id}).then((function(e){var t=e.data.result,a=n.state.data.map((function(e){return e.count=t[e.id],e}));n.setState({data:a})}))},n.startSideCrop=function(e){var t=e.target,a=new FileReader;a.readAsDataURL(t.files[0]),a.onload=function(e){var t=e.target.result;n.setState({uploadPic:t,cropShow:!0})}},n.sideCropConfirm=function(e){n.setState({sideCropLoading:!0},(function(t){var a=window.location.hostname+"/-128_45.png",i=new FormData;i.append("base64Code",e),i.append("fileName",a);var r={base64Code:e,fileName:a,type:"PROJECT_LOGO",projectId:h.t.get(h.V.curProject).id||""};r=JSON.stringify(r),v.v.post("upload/head",r,{headers:{"Content-Type":"application/json"}}).then((function(e){var t=document.querySelector(".project-avatar img"),a=e.data.result+"?_="+(new Date).getTime();t.setAttribute("src",a),o.Z.success(e.data.msg),n.props.changePictureURLDispatch(),n.setState({cropShow:!1,uploadPic:""})}))}))},n.state={id:h.t.get(h.V.backProjectConfig).id,name:h.t.get(h.V.backProjectConfig).name,data:S.filter((function(e){var t;return!e.authority||(null==(t=e.authority)?void 0:t.some((function(e){return p.Z.hasAuthority(e)})))})),columns:[{prop:"topic",width:400,renderHeader:function(){return c.createElement("span",{style:{paddingLeft:"74px"}},"\u540d\u79f0")},render:function(e,t,a){return c.createElement("div",{className:"tableLink",key:e.id},c.createElement("i",{className:e.icon}),c.createElement("span",{onClick:function(t){"/account/project/comment/subscribe"===e.route&&h.t.set(h.V.leaveRouter,n.props.location?n.props.location:"","session"),d.mW.push({pathname:e.route,state:{titles:[{title:"\u6240\u6709\u9879\u76ee",url:"/account/project"}]}})}},e.name))}},{label:"\u6570\u91cf",prop:"count"}],cropShow:!1,uploadPic:"",cropLoading:!1},n}(0,a.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.fetchList()},n.UNSAFE_componentWillReceiveProps=function(){var e=this;h.t.get(h.V.backProjectConfig).id!==this.state.id&&this.setState({id:h.t.get(h.V.backProjectConfig).id},(function(t){return e.fetchList()}))},n.closeInput=function(e){var t=this,n=this.state.id;v.h.post("/projects/update",{id:n,name:e}).then((function(n){o.Z.success("\u4fee\u6539\u6210\u529f"),h.t.set(h.V.backProjectConfig,{id:h.t.get(h.V.backProjectConfig).id,name:e}),t.props.fetchMenuList(),t.setState({name:e})}))},n.handleBack=function(){d.mW.push("/account/project")},n.render=function(){var e=this,t=this.state,n=t.name,a=t.columns,i=t.data,r=t.uploadPic,o=t.cropShow,p=t.cropLoading,d=document.documentElement.clientHeight-46-78-24;return c.createElement("div",{className:"flex-col preview"},c.createElement("div",{className:"flex-other"},c.createElement(l.Z,{title:(0,u.u)({title:"\u9879\u76ee\u6982\u51b5"})}),c.createElement("div",{className:"common-pad-24"},c.createElement("div",{style:{minHeight:d,backgroundColor:"#fff"}},c.createElement("div",{className:"project-intro"},c.createElement("span",{className:"info-name"},"\u9879\u76ee\u540d\u79f0"),c.createElement(m.Z,{id:"editProject",value:n,name:"\u9879\u76ee\u540d\u79f0",confirm:function(t){return e.closeInput(t)}})),c.createElement("div",{className:"upload-project-logo"},c.createElement(E.Button,{type:"primary",plain:!0,className:"btn-upload-logo"},c.createElement("label",{className:"upload-btn",htmlFor:"project-logo"},c.createElement("i",{className:"icon-shangchuan"})," \u4e0a\u4f20Logo"),c.createElement("input",{type:"file",hidden:!0,id:"project-logo",accept:"images/png",onChange:this.startSideCrop})),o&&c.createElement(g.Z,{src:r,title:"\u4e0a\u4f20\u81ea\u5b9a\u4e49\u9879\u76eeLogo",loading:p,tip:"\u6587\u4ef6\u5c0f\u4e8e1M\uff0c\u5efa\u8bae\u4e3a\u6b63\u65b9\u5f62",confirm:this.sideCropConfirm.bind(this),cancel:function(t){e.setState({cropShow:!1})},borderRadius:!0})),c.createElement(s.Z,{className:"topic-table",columns:a,data:i,start:1,end:i.length,total:i.length})))))},t}(c.Component);const T=(0,f.connect)((function(e){e.loading;var t=(0,r.Z)(e,y);return(0,i.Z)({},t[b])}),(function(e){return{fetchMenuList:function(t){return e({type:b+"/fetchMenuList",payload:t})},changePictureURLDispatch:function(t){return e({type:b+"/changePictureURLDispatch",payload:t})}}}))(C)},13713:(e,t,n)=>{n.d(t,{u:()=>i});var a=n(35239),i=function(e){var t=e.title,n=e.url,i=a.t.get(a.V.backProjectConfig).name;return n&&-1!==n.indexOf("memberlist")?[{title:i,url:"/account/project/preview"},{title:"\u7528\u6237\u7ec4",url:"/account/project/usergroup"},{title:t,url:n}]:[{title:i,url:"/account/project/preview"},{title:t,url:n}]}},55815:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(94578),i=n(67294),r=n(45697),c=n.n(r),o=n(43036),s=n(61409),l=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props,a=n.title,i=n.beforeJump;e!==a.length-1&&(i?new Promise((function(e,t){return i(e,t)})).then((function(){s.mW.push({pathname:a[e].url,state:a[e].state})})):s.mW.push({pathname:a[e].url,state:a[e].state}))},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.mainTitle,r=t.rightContent,c=t.className,s=t.overlay;return i.createElement("div",{className:"breadcumb-wrapper "+c},n instanceof Array?i.createElement("div",{className:"breadcrumb-left"},i.createElement("div",null,n.map((function(t,a){return i.createElement("span",{className:t.url?"":"not_clickable",key:a,onClick:function(){return t.url&&a!==n.length-1&&e._handleBreadcrumbClick(a)}},t.title,a!==n.length-1&&" / ")}))),i.createElement("span",null,a||n[n.length-1].title,s&&i.createElement(o.Z,{placement:"top",overlay:s},i.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}})))):i.createElement("div",{className:"normal-title"},n,s&&i.createElement(o.Z,{placement:"top",overlay:s},i.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}}))),r||"")},t}(i.Component);l.propTypes={className:c().string,title:c().oneOfType([c().string,c().arrayOf(c().shape({title:c().string,url:c().string,state:c().object}))]).isRequired,overlay:c().oneOfType([c().string,c().node]),mainTitle:c().oneOfType([c().string,c().node]),beforeJump:c().func,rightContent:c().node};const u=l},5747:(e,t,n)=>{n.d(t,{Z:()=>m});var a=n(94578),i=n(67294),r=n(45697),c=n.n(r),o=n(94184),s=n.n(o),l=n(55761),u=n(92360),p=n(5133),m=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))||this).state={src:t.props.src,preCropPic:"",once:!0,fileName:t.props.fileName},t}(0,a.Z)(t,e);var n=t.prototype;return n.UNSAFE_componentWillReceiveProps=function(e,t){this.setState({uploadPic:e.uploadPic},(function(e){}))},n._crop=function(){var e=this.props.refName,t=this.refs[e].getCroppedCanvas().toDataURL();this.setState({preCropPic:t})},n.profilePicUpload=function(e){var t=this.props.reUpload,n=this,a=e.target.files[0];if(a.size/1024>1024)return p.Z.error("\u6587\u4ef6\u4e0d\u80fd\u5927\u4e8e1M"),!1;var i=new FileReader;i.readAsDataURL(a),i.onload=function(e){n.setState({src:e.target.result,fileName:a.name}),t&&t(e.target.result)}},n.render=function(){var e=this.state,t=e.src,n=e.preCropPic,a=this.props,r=a.title,c=a.tip,o=a.style,p=a.className,m=a.loading,d=a.refName,h=a.aspectRatio,f=a.accept,E=a.confirm,g=a.cancel,v=a.borderRadius,N=this.state.fileName,y="cropper-pic-wrap";p&&(y=s()("cropper-pic-wrap",p));var b=s()("pre-pic",{"border-radius":v}),S=1;return h&&"[object Number]"===Object.prototype.toString.call(S)&&(S=h),i.createElement("div",{className:y},i.createElement("div",{className:"crop-wrap"},i.createElement(u.Loading,{loading:m},i.createElement("div",{className:"crop-title"},i.createElement("span",null,r),i.createElement("i",{className:"icon-cem_cancel",onClick:function(){return g(n)}})),i.createElement("div",{className:"crop-cont"},i.createElement(l.Z,{ref:d,src:t,style:o,aspectRatio:S,guides:!1,crop:this._crop.bind(this)}),i.createElement("div",{className:"option-cont"},i.createElement("div",{className:"pre-cont"},i.createElement("img",{className:b,src:n})),i.createElement("div",{className:"pre-tip"},"\u9884\u89c8"),i.createElement("div",{className:"reupload-cont"},i.createElement(u.Button,{type:"primary",onClick:function(){return document.getElementById("reupload").click()}},"\u91cd\u65b0\u4e0a\u4f20"),i.createElement("input",{type:"file",id:"reupload",hidden:!0,accept:f,onChange:this.profilePicUpload.bind(this)})))),i.createElement("p",{className:"crop-tip"},c),i.createElement("div",{className:"crop-option"},i.createElement(u.Button,{onClick:function(){g(n)}},"\u53d6\u6d88"),i.createElement(u.Button,{type:"primary",onClick:function(){E(n,N)}},"\u786e\u5b9a")))),i.createElement("div",{className:"crop-bg"}))},t}(i.Component);m.propTypes={show:c().bool,title:c().string,tip:c().string,src:c().string,refName:c().string,accept:c().string,confirm:c().func,cancel:c().func,reUpload:c().func,borderRadius:c().bool,loading:c().bool,fileName:c().string},m.defaultProps={show:!1,src:"",title:"\u4e0a\u4f20\u56fe\u7247",accept:"images/png",tip:"\u4ec5\u652f\u6301png\u683c\u5f0f\uff0c\u6587\u4ef6\u5c0f\u4e8e1M",refName:"cropper"+(new Date).getTime(),style:{height:263,width:263},borderRadius:!1,loading:!1,fileName:""}},88308:(e,t,n)=>{n.d(t,{Z:()=>h});var a=n(94578),i=n(67294),r=n(45697),c=n.n(r),o=n(5133),s=n(43036),l=n(94184),u=n.n(l),p={value:c().string,id:c().any.isRequired,enter:c().bool,blurFun:c().func,name:c().string,empty:c().bool,placeholder:c().string,type:c().string,confirmNoChange:c().func},m={value:"",enter:!0,name:"\u540d\u79f0",empty:!1,placeholder:"",cancel:function(e,t){},confirm:function(e,t){},type:"normal"},d=function(e){function t(t){var n;(n=e.call(this,t)||this).enter=function(e){n.props.enter&&13===e.keyCode&&n.confirmEdit()};var a=n.props.value;return n.state={isEdit:!1,curValue:a||"",lastVal:a||"",hover:!1,canEdit:!1},n}(0,a.Z)(t,e);var n=t.prototype;return n.UNSAFE_componentWillReceiveProps=function(e){var t=this;e.value!==this.state.lastVal&&e.value&&this.setState({curValue:e.value,lastVal:e.value}),!0!==e.canEdit||this.state.canEdit||this.setState({canEdit:!0},(function(e){t.toEdit()}))},n.componentDidMount=function(){var e=this;document.body.addEventListener("click",(function(t){var n=t.target||window.event.srcElement,a=e.props.className,i="edit-input-wrap";a&&(i=a.split(" ")[0]);(function(e,t){for(var n=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector;e&&!n.call(e,t);)e=e.parentElement;return e})(n,"."+i)||e.cancelEdit()}))},n.changeName=function(){var e=this.props.id,t=document.getElementById(e).value;this.setState({curValue:t})},n.toEdit=function(){var e=this.state,t=e.isEdit,n=(e.canEdit,this.props.id);t||this.setState({isEdit:!0,hover:!0},(function(e){var t=document.getElementById(n);setTimeout((function(){t.focus()}))}))},n.checkEdit=function(){"normal"===this.props.type&&this.toEdit()},n.cancelEdit=function(){var e=this.state,t=e.curValue,n=e.lastVal,a=e.isEdit,i=e.canEdit,r=this.props.cancel;a&&(i&&this.setState({canEdit:!1}),this.setState({isEdit:!1,hover:!1,curValue:n},(function(e){r&&r(t,n)})))},n.borderShow=function(){var e=this.state.hover;"normal"!==this.props.type||e||this.setState({hover:!0})},n.borderHide=function(){var e=this.state,t=e.hover,n=e.isEdit;"normal"===this.props.type&&t&&!n&&this.setState({hover:!1})},n.confirmEdit=function(){var e=this.state,t=e.curValue,n=e.lastVal,a=e.canEdit,i=this.props,r=i.confirm,c=i.id,s=i.name,l=i.empty,u=i.confirmNoChange,p=i.inputType,m=document.getElementById(c);""!==String(t).replace(/\s/g,"")||l||"remark"===p?(""===String(t).replace(/\s/g,"")&&l||"remark"==p?(this.setState({isEdit:!1,hover:!1,lastVal:t},(function(e){m.blur()})),r&&r(t,n)):n===t?this.setState({isEdit:!1,hover:!1},(function(e){m.blur()})):(this.setState({isEdit:!1,hover:!1,lastVal:t},(function(e){m.blur()})),r&&r(t,n)),a&&(u&&u(t),this.setState({canEdit:!1}))):(o.Z.warning(s+"\u4e0d\u80fd\u4e3a\u7a7a"),this.setState({curValue:n},(function(e){m.focus()})))},n.render=function(){var e=this.props,t=e.id,n=e.style,a=e.className,r=e.placeholder,c=this.state,o=c.isEdit,l=c.curValue,p=c.hover,m=u()(["edit-input-wrap",a]),d=u()(["edit-input-cont",{hover:p,"is-edit":o}]),h=u()(["edit-input",{disabled:!o}]);return i.createElement("div",{className:m,style:n},i.createElement("div",{className:d,onMouseEnter:this.borderShow.bind(this),onMouseLeave:this.borderHide.bind(this),onClick:this.checkEdit.bind(this)},i.createElement("input",{id:t,className:h,type:"text",value:l,title:l,placeholder:r,style:n,disabled:!o,onInput:this.changeName.bind(this),onKeyDown:this.enter.bind(this)}),p&&!o&&i.createElement(s.Z,{placement:"top",overlay:"\u7f16\u8f91"},i.createElement("div",{className:"btn-wrap",title:"\u7f16\u8f91"},i.createElement("i",{className:"name-edit edit-btn icon-cem_edit"}))),p&&o&&i.createElement("div",{className:"btn-wrap"},i.createElement(s.Z,{placement:"top",overlay:"\u53d6\u6d88"},i.createElement("i",{className:"cancel-edit edit-btn icon-cem_delete",onClick:this.cancelEdit.bind(this),title:"\u53d6\u6d88"})),i.createElement(s.Z,{placement:"top",overlay:"\u786e\u8ba4"},i.createElement("i",{className:"confirm-edit edit-btn icon-cem_check-out",onClick:this.confirmEdit.bind(this),title:"\u786e\u8ba4"})))))},t}(i.Component);d.propTypes=p,d.defaultProps=m;const h=d}}]);