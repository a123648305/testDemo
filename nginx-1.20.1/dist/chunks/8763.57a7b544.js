"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[8763],{28763:(e,t,n)=>{n.r(t),n.d(t,{default:()=>O});var a=n(63366),i=n(87462),r=n(94578),o=n(67294),l=n(39432),s=n(30133),c=["\u9884\u8b66\u901a\u77e5\u603b\u6570","\u5df2\u8bfb\u9884\u8b66\u901a\u77e5","\u672a\u8bfb\u9884\u8b66\u901a\u77e5"];const u=function(e){var t=e.data;return e.loading?o.createElement(s.Z,{style:{height:200}}):o.createElement("div",{className:"yt_warning_statistics_card"},null==t?void 0:t.map((function(e,t){return n=e,a=c[t],o.createElement("div",{className:"card_item"},o.createElement("h2",null,n?(0,l.uf)(n):"--"),o.createElement("span",null,a));var n,a})))};var p=n(50976),d=n(70715),h=n(87300),f=function(e){var t=0;e.forEach((function(e){var n=parseFloat(e);n>t&&(t=n)})),t=Math.ceil(t);for(var n=0;n<4;n++)t%4!==0&&t++;return 0===t&&(t=4),{intVal:t/4,maxVal:t}},m=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).chartRef=void 0,t.getChartRef=function(e){return t.chartRef=e},t.transformData=function(e){return{pie:[e.highCount,e.middleCount,e.lowCount],pieText:["\u9ad8","\u4e2d","\u4f4e"],line:e.data.map((function(e){return[e.dateStr,e.totalCount,e.readCount]}))}},t.getChartValue=function(e){return{pieDimensions:["\u7ea7\u522b","\u6570\u91cf"],pieSource:e.pie.map((function(t,n){return[e.pieText[n],t]})),dimensions:["\u65e5\u671f","\u603b\u91cf","\u5df2\u8bfb"],source:e.line}},t.getOption=function(e,n,a,r){void 0===a&&(a=!1),void 0===r&&(r="DAY");var o=t.getChartValue(e),s=o.pieDimensions,c=o.pieSource,u=o.dimensions,p=o.source,m={title:{text:n,top:14},dataset:[{dimensions:s,source:c},{dimensions:u,source:p}].map((function(e){return(0,i.Z)({},e,{sourceHeader:!1})})),series:[{type:"pie",smooth:!0,datasetIndex:0,hoverOffset:0,center:["17%","60%"],radius:["25%","35%"],itemStyle:{smooth:!0,normal:{borderWidth:0,borderColor:"#fff",smooth:!0},emphasis:{borderWidth:0,shadowBlur:0,shadowOffsetX:0}},label:{show:!0,position:"outside",color:"#262626",formatter:function(e){var t=e.name,n=e.value,a=e.percent;return[t.length>8?t.substr(0,8)+"...":""+t,"{value|"+(0,l.hE)(n)+" "+a.toFixed(2)+"%}"].join("\n")},rich:{value:{fontSize:12,lineHeight:18,color:"#262626",align:"left"}}},labelLine:{show:!0,smooth:!0,length:18},avoidLabelOverlap:!0,data:c.map((function(e){return{name:e[0],value:e[1]}})),tooltip:{trigger:"item",formatter:function(e){var t=e.marker,n=e.data,a=n.value,i=n.name,r=e.percent;return'\n                <div style="padding: 12px">\n                  '+t+'\n                  <span style="margin-right:36px;color:#8c8c8c">'+i+'</span>\n                  <span style="font-weight:500;color:#262626">'+(0,l.uf)(a)+'</span>\n                  <span style="margin-left:10px;color:#8c8c8c">'+r.toFixed(2)+"%</span>\n                </div>\n              "}}}].concat(u.slice(1).map((function(e,t){return{type:"line",name:e,smooth:!0,showSymbol:!0,symbolSize:1,data:p.map((function(e){return{value:e[t+1],label:{show:a,position:"top",color:"#262626"}}})),itemStyle:{color:d.OW[t]}}}))),grid:[{top:150,bottom:16,left:"34%",right:48,containLabel:!0}],graphic:{elements:[{type:"text",top:66,left:20,silent:!0,style:{text:"\u9884\u8b66\u7d27\u6025\u7a0b\u5ea6",fill:"#262626",font:"400 14px "+d.I8}},{type:"text",top:66,left:"34%",silent:!0,style:{text:"\u9884\u8b66\u901a\u77e5\u8d70\u52bf",fill:"#262626",font:"400 14px "+d.I8}}]},legend:[{top:95,left:20,right:48,itemWidth:10,itemHeight:10,type:"scroll",itemGap:16,data:c.map((function(e){return e[0]})),icon:"circle"},{top:95,left:"34%",right:48,itemWidth:10,itemHeight:10,type:"scroll",itemGap:16,data:u.slice(1),icon:"circle"}],xAxis:{type:"category",boundaryGap:!1,data:p.map((function(e){return(0,l.Sn)(r,e[0])})),nameTextStyle:{color:"#626262"},axisPointer:{type:"line",label:{show:!1}}},yAxis:{type:"value",axisLabel:{color:"#626262",formatter:function(e){return(0,l.hE)(e)}},interval:f(p.map((function(e){return e.slice(1)})).flat()).intVal,max:f(p.map((function(e){return e.slice(1)})).flat()).maxVal,axisLine:{show:!1,lineStyle:{type:"dashed",color:"#e5e5e5"}},splitLine:{show:!0,lineStyle:{color:["#e5e5e5"],width:1,type:"dashed"}}},tooltip:{trigger:"axis",showDelay:20,hideDelay:55,confine:!0,enterable:!0,padding:0,backgroundColor:"#ffffff",borderColor:"#e5e5e5",borderWidth:"1",extraCssText:"border-radius: 2px; box-shadow: 0px 9px 28px 8px rgba(0,0,0,0.05), 0px 6px 16px 0px rgba(0,0,0,0.08), 0px 3px 6px -4px rgba(0,0,0,0.12)",formatter:function(e,t,n){if(e.length)return setTimeout((function(){var a=e[0].axisValue,i=e.map((function(e){var t=e.marker,n=e.seriesName,a=e.data;return{name:"<div style='display: flex;justify-content: space-between;align-items: center;color: #8c8c8c;'><div><span style='vertical-align: bottom'>"+t+"</span>"+n+"</div><div style='color: #262626;margin-left: 10px;'>"+(0,l.uf)(a.value)+"</div></div>",value:a.value}})),r=i.map((function(e){return e.name})),o='<span style="font-size: 12px; color: #8c8c8c; font-weight: 400;">'+a+"</span>";n(t,(0,h.r)(o,r))}),0)}}};return m},t}return(0,r.Z)(t,e),t.prototype.renderChart=function(e,t){this.chartRef.clear(),this.chartRef.setOption(this.getOption(this.transformData(e),t))},t}(o.PureComponent),v=n(8201),g=n(43036),y=function(){},C=function(e){function t(t){var n;return(n=e.call(this,t)||this).getPanelWidth=function(){var e=n.props,t=e.flavor,a=e.options,i=e.rightHook,r=Math.max.apply(null,a.map((function(e){return(0,l.jD)(e.title,14)})))+2+10+32;return r+=void 0!==t?24:0,(r+=void 0!==i?30:0)>100?r:100},n._setPadShowFalse=function(){n.state.show&&n.setState({show:!1})},n._handleParentClick=function(e){n.state.show&&n.props.showFlavor&&n.props.enable&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},n._handleTriggerOnClick=function(){var e=n.state.show;n.props.enable&&setTimeout((function(){n.setState({show:!e})}),0)},n.state={show:!1,firstLiHover:!1,panelWidth:n.getPanelWidth()},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){window.addEventListener("click",this._setPadShowFalse)},n.componentWillUnmount=function(){window.removeEventListener("click",this._setPadShowFalse)},n.componentDidUpdate=function(e){var t=e.options,n=this.props.options;JSON.stringify(t)!==JSON.stringify(n)&&this.setState({panelWidth:this.getPanelWidth()})},n.render=function(){var e=this.state,t=e.show,n=e.panelWidth,a=this.props,i=a.activeObj,r=void 0===i?"":i,l=a.onChange,s=a.options,c=a.objName,u=a.preTitle,p=a.sufTitle,d=void 0===p?"":p,h=a.showTitle,f=void 0===h||h,m=a.overlay,v=a.divider,C=void 0===v?"right":v,x=a.flavor,b=a.className,w=void 0===b?"":b,E=a.onFlavorChange,_=void 0===E?y:E,D=a.sufIcon,N=a.style,T=a.type,k=void 0===T?"text":T,S=a.enable,P=a.rightHook,O=s.find((function(e){return e.value===r})),L=""===r?d:O&&O.title,W=""===r?d:O&&O.icon;return o.createElement("div",{className:"yt-warning-statistics-single-select-button-wrapper single_select_diviver_"+C+" single-select-button_"+k+" "+w,style:N,onClick:this._handleParentClick},o.createElement("div",{className:"button_content "+(S?"":"button_content_disable")},o.createElement("span",{onClick:this._handleTriggerOnClick},o.createElement("span",{className:"button-trigger "+(t?"sel":"")},f&&o.createElement(o.Fragment,null,u&&o.createElement("span",{className:"pre-title"},u,"\uff1a"),W?o.createElement("i",{className:W+" word_icon_hover"}):o.createElement("span",{className:"button-title"},L)),o.createElement("i",{className:D||"icon-cem_pull-down-or-take-up",style:{transform:t?"rotate(-180deg)":""}})),m&&o.createElement("span",{style:{marginLeft:4}},o.createElement(g.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:m},o.createElement("i",{className:"icon-cem_file1"})))),o.createElement("div",{className:"button-panel "+(t?"active":""),style:{minWidth:n}},s.map((function(e,t){return o.createElement("div",{className:"panel-item "+(e.value===r?"sel":"")+" "+(e.disabled?"disabled":""),key:e.value,onClick:function(){var t;!e.disabled&&l(c?((t={})[c]=e.value,t):e.value)}},e.icon&&o.createElement("i",{className:e.icon+" panel-item-icon"}),o.createElement("span",{className:"ellipsis",style:{maxWidth:97.5}},e.title),void 0!==x&&o.createElement("i",{className:x===e.value?"icon-cem_star":"icon-cem_star-filling star_hide",onClick:function(t){var n,a,i;t.stopPropagation(),_(x===e.value?c?((n={})[c]="",n):"":c?((a={})[c]=e.value,a):e.value),l(c?((i={})[c]=e.value,i):e.value)}}),o.createElement("i",{className:e.value===r&&P?"icon-cem_right1 choice":""}))})))))},t}(o.PureComponent);C.defaultProps={enable:!0,activeObj:"",sufTitle:"",showTitle:!0,divider:"right",className:"",type:"text"};const x=C;var b=n(98191),w=[{title:"\u8fd17\u5929",value:"c0"},{title:"\u8fd130\u5929",value:"c1"}];const E=function(e){function t(t){var n;return(n=e.call(this,t)||this).internalId=void 0,n.chartLeaveTimeout=void 0,n.state={},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;this.internalId=setInterval((function(){if(e.chartRef){clearInterval(e.internalId),e.renderChart();var t=e.chartRef._dom.children,n=t[0],a=t[1];n.addEventListener("mouseleave",(function(t){e.chartLeaveTimeout=setTimeout((function(){e.chartLeaveTimeout&&(a.style.display="none")}),2e3)})),a&&a.addEventListener("mouseenter",(function(t){e.chartLeaveTimeout=void 0}))}}),200)},n.componentDidUpdate=function(e,t){var n=e.data,a=this.props.data;(0,v.P)(a)&&JSON.stringify(n)!==JSON.stringify(a)&&this.renderChart(),!(0,v.P)(a)&&this.chartRef&&(this.chartRef=void 0)},n.renderChart=function(){var t=this.props,n=t.data,a=t.title;(0,v.P)(n)&&this.chartRef&&0!==n.length&&e.prototype.renderChart.call(this,n,a)},n.render=function(){var e=this.props,t=e.title,n=e.loading,a=e.data,i=e.dateType,r=e.onFilterChange;return o.createElement(v.Z,{className:"yt_warning_statistics_chart",data:a,loading:n,renderTitle:o.createElement(b.Z,{title:t,data:a},o.createElement(x,{options:w,activeObj:i,rightHook:!0,preTitle:"\u65f6\u95f4\u9009\u62e9",onChange:function(e){return r({dateType:e})}}))},o.createElement(p.Z,{onChartReady:this.getChartRef,theme:"yt_multi_color_10",option:{},style:{width:"100%",height:"100%"}}))},t}(m);const _=function(e){var t=e.cardData,n=e.chartData,a=e.dateType,i=e.onFilterChange,r=e.fetchingCardData,l=e.fetchingChartData;return o.createElement("div",{className:"yt_warning_statistics_wrapper"},o.createElement(u,{data:t,loading:r}),o.createElement(E,{data:n,title:"\u6570\u636e\u6982\u51b5",loading:l,dateType:a,onFilterChange:i}))};var D=n(55609),N=n(64396),T=n(35239),k=["loading"],S=N.Z.workspace.warningStatistics,P=function(e){function t(t){var n;return(n=e.call(this,t)||this).events=void 0,n._handleOnFilterChange=function(e){e.dateType&&n.props.fetchChartData(e)},n.state={},n.events={onFilterChange:n._handleOnFilterChange},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.fetchDatas({projectId:T.t.get(T.V.curProject).id})},n.componentWillUnmount=function(){this.props.clean()},n.render=function(){return o.createElement(_,(0,i.Z)({},this.props,this.state,this.events))},t}(o.Component);const O=(0,D.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,k);return(0,i.Z)({},n[S],{fetchingCardData:t.effects[S+"/fetchCardData"]||!1,fetchingChartData:t.effects[S+"/fetchChartData"]||!1})}),(function(e){return{save:function(t){return e({type:S+"/save",payload:t})},clean:function(){return e({type:S+"/clean"})},fetchDatas:function(t){return e({type:S+"/fetchDatas",payload:t})},fetchCardData:function(t){return e({type:S+"/fetchCardData",payload:t})},fetchChartData:function(t){return e({type:S+"/fetchChartData",payload:t})}}}))(P)}}]);