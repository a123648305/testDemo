"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[9582],{13713:(e,t,n)=>{n.d(t,{u:()=>r});var a=n(35239),r=function(e){var t=e.title,n=e.url,r=a.t.get(a.V.backProjectConfig).name;return n&&-1!==n.indexOf("memberlist")?[{title:r,url:"/account/project/preview"},{title:"\u7528\u6237\u7ec4",url:"/account/project/usergroup"},{title:t,url:n}]:[{title:r,url:"/account/project/preview"},{title:t,url:n}]}},4901:(e,t,n)=>{n.d(t,{hm:()=>r,Ew:()=>l,rV:()=>i,vG:()=>c,yZ:()=>s,ms:()=>u,F1:()=>m});var a=n(53326),r=[{label:"\u5168\u90e8",value:"ALL"},{label:"\u542f\u7528",value:"ENABLE"},{label:"\u505c\u7528",value:"DISABLE"}],l=[{label:"\u5168\u90e8",value:"ALL"},{label:"\u672a\u8bfb",value:"UNREAD"},{label:"\u5df2\u8bfb",value:"READ"}],i=[{title:"\u5168\u90e8",value:"ALL"},{title:"\u9ad8",value:"HIGH"},{title:"\u4e2d",value:"MIDDLE"},{title:"\u4f4e",value:"LOW"}],o=(0,a.rO)(),c=o.reduce((function(e,t){return e[t.value]=t.label,e}),{}),s=[{title:"\u5168\u90e8",value:"ALL"}].concat(o.map((function(e){return{title:e.label,value:e.value}}))),u={UNREAD:"\u672a\u8bfb",READ:"\u5df2\u8bfb"},m=[{label:"\u5168\u90e8",value:"ALL"},{label:"\u9884\u552e",value:"PRE_SALE"},{label:"\u5728\u552e",value:"ON_SALE"},{label:"\u4e0b\u67b6",value:"OFF_SALE"}]},28690:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Q});var a=n(63366),r=n(87462),l=n(94578),i=n(67294),o=n(35239),c=(n(15267),n(64713)),s=(n(6373),n(82891)),u=(n(54214),n(12386)),m=(n(78994),n(35297)),p=(n(48145),n(40987)),d=(n(1025),n(65400)),g=(n(89858),n(51024)),h=(n(53294),n(56697)),f=n(30381),v=n.n(f),E=n(4901),y=n(55815),C=n(634),b=n(68855),w=n(5133),k=n(43036),L=n(96889),Z=(n(75314),n(11187)),x=n(15861),N=n(50361),S=n.n(N),T=n(23279),O=n.n(T),I=n(87757),_=n.n(I),W=n(49722),A=g.default.TextArea;const j=function(e){function t(t){var n;return(n=e.call(this,t)||this).descriptionInputOnChange=function(e){n.setState({description:e.target.value})},n.asyncValidtor=O()(function(){var e=(0,x.Z)(_().mark((function e(t){var a,r,l,i,o;return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props.id,e.prev=1,e.next=4,W.h.post("/warning/manage/rule/checkWarning",{id:a,title:t});case 4:if(r=e.sent,l=(r||{}).data,2e4===+(i=(l||{}).code)){e.next=9;break}throw i;case 9:e.next=16;break;case 11:e.prev=11,e.t0=e.catch(1),Z.default.destroy(),o=S()(e.t0),(49e5===+e.t0||o&&o.data&&49e5===o.data.code)&&n.setState({errorMessage:"\u6b64\u89c4\u5219\u540d\u79f0\u5df2\u88ab\u4f7f\u7528\uff0c\u8bf7\u5c1d\u8bd5\u5176\u4ed6\u89c4\u5219\u540d\u79f0"});case 16:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),1e3),n.renameInputOnChange=function(e){n.setState({title:e.target.value.trim(),errorMessage:""},(function(){n.state.title?n.state.title.length>20?n.setState({errorMessage:"\u89c4\u5219\u540d\u79f0\u4e0d\u80fd\u8d85\u8fc720\u4e2a\u5b57"}):n.asyncValidtor(n.state.title):n.setState({errorMessage:"\u8bf7\u586b\u5199\u89c4\u5219\u540d\u79f0"})}))},n._handleRenameOk=function(){var e=n.props,t=e.id,a=e.handleRenameOk,r=n.state;a({target:{id:t,description:r.description,title:r.title},typeStr:"rename"})},n.handleClear=function(){n.setState({description:"",title:""})},n.state={description:"",title:"",errorMessage:""},n}return(0,l.Z)(t,e),t.prototype.render=function(){var e=this.props,t=(e.id,e.visible),n=e.handleRenameCancel,a=this.state,r=a.description,l=a.title,o=a.errorMessage;return i.createElement(h.Z,{afterClose:this.handleClear,maskClosable:!0,visible:t,title:"\u91cd\u547d\u540d",className:"project-warging-overview-rename",footer:i.createElement(i.Fragment,null,i.createElement(d.default,{onClick:function(){return n(!1)}},"\u53d6\u6d88"),i.createElement(d.default,{disabled:Boolean(!l.length||o),type:"primary",onClick:this._handleRenameOk},"\u786e\u5b9a"))},i.createElement("div",{className:"project-warging-overview-rename-title"},i.createElement("label",null,"\u9884\u8b66\u89c4\u5219\u540d\u79f0\uff1a"),i.createElement("div",null,i.createElement(g.default,{maxLength:20,style:{width:"302px",height:"32px"},value:l,className:o.length>0?"warning-rename-error-style":"",onChange:this.renameInputOnChange,placeholder:"\u8bf7\u8f93\u5165\u9884\u8b66\u89c4\u5219\u540d\u79f0(\u4e0d\u8d85\u8fc720\u4e2a\u5b57\uff09"}),i.createElement("span",{className:"rename-message-title"},o))),i.createElement("div",{className:"project-warging-overview-rename-description"},i.createElement("label",null,"\u9884\u8b66\u89c4\u5219\u8bf4\u660e\uff1a"),i.createElement(A,{maxLength:50,className:"warning-description-style",value:r,style:{width:"302px",height:"100px",marginBottom:0},placeholder:"\u8bf7\u8f93\u5165\u9884\u8b66\u8bf4\u660e\u5185\u5bb9(\u4e0d\u8d85\u8fc750\u4e2a\u5b57\uff09",onChange:this.descriptionInputOnChange})))},t}(i.Component);var D=n(39270),R=n(61918),B=n(38064),F=n(63262),P=n(61409),U=n(13713),H=h.Z.confirm,M=h.Z.error,V=(g.default.TextArea,function(e){function t(t){var n;return(n=e.call(this,t)||this).handleRenameOk=function(e){(0,n.props.onToggleChange)({target:(0,r.Z)({},e.target),typeStr:"rename"}),n.setState({renameDialogShow:!1})},n.handleRename=function(e){n.setState({renameDialogShow:!0,id:e})},n.handleDelete=function(e,t){var a=n.props,r=a.onToggleChange,l=a.onFilterChange,o=a.warningtList,c=a.current;t>0?M({title:"\u5220\u9664",icon:i.createElement(b.Z,{style:{color:"#FF7955"}}),content:"\u5f53\u524d\u89c4\u5219\u4e2d\u6709\u5386\u53f2\u901a\u77e5\uff0c\u4e0d\u80fd\u5220\u9664\u8be5\u89c4\u5219",maskClosable:!1}):H({title:"\u5220\u9664",icon:i.createElement(b.Z,{style:{color:"#FF7955"}}),content:"\u5220\u9664\u540e\uff0c\u6b64\u9884\u8b66\u89c4\u5219\u65e0\u6cd5\u6062\u590d\uff0c\u5982\u679c\u6b64\u9884\u8b66\u89c4\u5219\u540e\u671f\u8fd8\u9700\u8981\u4f7f\u7528\uff0c\u505c\u7528\u5373\u53ef",okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",maskClosable:!1,onOk:function(){r({id:e,typeStr:"delete"}),1===o.length&&l({current:c-1})},onCancel:function(){}})},n.goEdit=function(e){P.mW.push({pathname:"/account/project/warning/edit",state:{id:e,copy:!0}})},n.resetPopupConfimIndex=function(){n.setState({visiblePopupConfirmIndex:-1})},n._renderPopupConfirm=function(e){return i.createElement("div",{onClick:function(e){return e.stopPropagation()},className:"project_warging_overview_page_view_copy_overlay"},i.createElement("div",null,i.createElement("i",{className:"icon-cem_warning",style:{color:"#D96969"}}),i.createElement("span",null,"\u786e\u5b9a\u521b\u5efa\u76f8\u4f3c\u6761\u4ef6\u9884\u8b66\uff1f")),i.createElement("div",null,i.createElement(d.default,{type:"default",size:"small",onClick:n.resetPopupConfimIndex},"\u53d6\u6d88"),i.createElement(d.default,{type:"primary",size:"small",onClick:function(){return n.goEdit(e)}},"\u786e\u5b9a")))},n.showEnableOrDisableConfirm=function(e,t){var a=n.props,r=a.onToggleChange,l=a.onFilterChange,o=a.warningtList,c=a.current;H({title:"ENABLE"===e?"\u505c\u7528\u9884\u8b66":"\u542f\u52a8\u9884\u8b66",icon:i.createElement(b.Z,{style:{color:"#FF7955"}}),content:"ENABLE"===e?"\u505c\u7528\u540e\uff0c\u5f53\u524d\u89c4\u5219\u5931\u6548\uff0c\u7cfb\u7edf\u4e0d\u518d\u7ed9\u76f8\u5173\u7528\u6237\u63a8\u9001\u8be5\u89c4\u5219\u7684\u9884\u8b66\u901a\u77e5":"\u542f\u7528\u540e\uff0c\u5f53\u524d\u89c4\u5219\u751f\u6548\uff0c\u7cfb\u7edf\u4f1a\u7ed9\u76f8\u5173\u7528\u6237\u63a8\u9001\u8be5\u89c4\u5219\u7684\u9884\u8b66\u901a\u77e5",okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",maskClosable:!0,onOk:function(){r({toggleTarget:{id:t,status:e},typeStr:"toggle"}),1===o.length&&l({current:c-1})},onCancel:function(){}})},n._renderUnsubscribeUserList=function(e){return i.createElement("div",null,e.join("\u3001"))},n.handleViewLog=function(e,t,n){P.mW.push({pathname:"/account/project/warning/log",state:{title:e,id:t,receiverUserList:n}})},n.handleRenameCancel=function(e){n.setState({renameDialogShow:e})},n.state={dialogShow:!1,renameDialogShow:!1,id:"",title:"",visiblePopupConfirmIndex:-1,targetWarning:{id:"",title:"",description:"",status:""},columns:[{title:"",width:"0.1%"},{title:"\u9884\u8b66\u89c4\u5219\u540d\u79f0",dataIndex:"title",width:"15%",render:function(e,t,n,a){var r=t.title,l=t.description;return i.createElement(k.Z,{overlay:function(){return i.createElement(D.Z,{title:r,description:l})},placement:"topLeft",overlayStyle:{maxWidth:"436px"}},i.createElement("div",{className:"warning-title"},r))}},{title:"\u7d27\u6025\u7a0b\u5ea6",width:"8%",dataIndex:"level",render:function(e){return i.createElement(F.Z,{style:{fontSize:12},level:e})}},{title:"\u6570\u636e\u7c7b\u578b",width:"8%",dataIndex:"categoryName"},{title:"\u63a8\u9001\u6210\u5458\u6570",width:"9%",dataIndex:"subscribeCount",render:function(e,t,n,a){var r=t.receiverTeamList,l=t.receiverUserList,o=t.subscribeCount;return o?i.createElement(i.Fragment,null,i.createElement(k.Z,{getPopupContainer:function(e){return e},overlay:function(){return i.createElement("div",null,i.createElement("div",{className:"teams"},i.createElement("span",null,"\u56e2\u961f | "),i.createElement("span",null,r.length>0?r.map((function(e){return e.name})).join("\u3001"):"\u65e0")),i.createElement("div",{className:"teams"},i.createElement("span",null,"\u6210\u5458 | "),i.createElement("span",null,l.length>0?l.map((function(e){return e.name})).join("\u3001"):"\u65e0")))},placement:"topLeft",overlayStyle:{maxWidth:"436px"}},i.createElement("span",{className:"remindCount"},o))):i.createElement("span",null,o)}},{title:"\u9000\u8ba2\u6210\u5458\u6570",dataIndex:"unsubscribeCount",width:"9%",render:function(e,t,n,a){var r=t.unsubscribeCount,l=t.unsubscribeUserList;return r?i.createElement(k.Z,{placement:"top",overlay:function(){return l.map((function(e,t){return i.createElement("span",{key:e.id},e.name,t+1!==l.length?"\u3001":"")}))}},i.createElement("span",{className:"remindCount"},r)):i.createElement("span",null,r)}},{title:"\u9884\u8b66\u901a\u77e5\u6570",dataIndex:"remindCount",width:"9%",render:function(e,t,a,r){var l=t.title,o=t.remindCount,c=t.id,s=t.receiverUserList;return o?i.createElement(k.Z,{placement:"top",overlay:"\u67e5\u770b\u8fd17\u5929\u7684\u63a8\u9001\u65e5\u5fd7"},i.createElement("span",{className:"remindCount remindCountLink",onClick:function(){return n.handleViewLog(l,c,s)}},o)):i.createElement("span",null,o)}},{title:"\u521b\u5efa\u4eba",width:"10%",dataIndex:"owner",render:function(e){return i.createElement("span",null,e.name)}},{title:"\u6700\u8fd1\u4fee\u6539\u65f6\u95f4",width:"10%",dataIndex:"updatedAt",render:function(e,t,n,a){var r=t.updator,l=t.updatedAt;return i.createElement(k.Z,{overlay:function(){return r.name}},i.createElement("span",null,v()(l).format("YYYY/MM/DD HH:mm")))}},{title:"\u662f\u5426\u542f\u7528",width:"8%",dataIndex:"status",render:function(e,t,a,r){var l=t.status,o=(t.title,t.description,t.id);return i.createElement(k.Z,{overlay:"ENABLE"===l?"\u5df2\u542f\u7528":"\u5df2\u505c\u7528",placement:"top",trigger:"hover"},i.createElement("span",null,i.createElement(p.Z,{size:"small",checked:"ENABLE"===l,onChange:function(){return n.showEnableOrDisableConfirm(l,o)}})))}},{title:"\u64cd\u4f5c",width:"25%",key:"operation",render:function(e,t,a,r){var l=t.id,o=t.title,c=(t.description,t.remindCount);n.state.visiblePopupConfirmIndex;return i.createElement("div",{className:"handle"},i.createElement("span",{onClick:function(){return P.mW.push({pathname:"/account/project/warning/edit",state:{id:l,copy:!1,title:o}})},style:{marginRight:"16px",display:"inline-block",cursor:"pointer"}},"\u7f16\u8f91"),i.createElement(m.Z,{title:"\u786e\u5b9a\u521b\u5efa\u76f8\u4f3c\u6761\u4ef6\u9884\u8b66\uff1f",onConfirm:function(){return n.goEdit(l)},okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},i.createElement("span",{style:{marginRight:"16px",display:"inline-block",cursor:"pointer"}},"\u590d\u5236")),i.createElement(s.default,{overlay:i.createElement(u.default,{className:"more"},i.createElement(u.default.Item,{onClick:function(){return n.handleRename(l)}},"\u91cd\u547d\u540d"),i.createElement(u.default.Item,{onClick:function(){return n.handleDelete(l,c)}},"\u5220\u9664")),placement:"bottomCenter",trigger:["click"],getPopupContainer:function(e){return e}},i.createElement("span",{className:"icon-cem_more-more",style:{marginRight:"16px",display:"inline-block",cursor:"pointer"}})))}}]},n}(0,l.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e,t){t.subDisabledDes,this.state.subDisabledDes},n.render=function(){var e=this.props,t=e.searchKey,n=e.warningStatusList,a=e.level,l=e.categoryId,o=(e.type,e.receiverTeamIdList),s=e.receiverUserIdList,u=e.onFilterChange,m=e.warningtList,p=e.warningtTotal,g=e.toggleStatusHint,h=e.deleteWarningHint,f=e.renameWarningHint,v=e.teamOptions,b=e.userOptions,k=e.current,Z=e.pageSize,x=e.fetchingWarningtList,N=this.state,S=N.columns,T=N.renameDialogShow,O=N.id;return g&&w.Z.success("\u64cd\u4f5c\u6210\u529f"),h&&w.Z.success("\u5220\u9664\u6210\u529f"),f&&w.Z.success("\u64cd\u4f5c\u6210\u529f"),this.props.save({toggleStatusHint:!1,deleteWarningHint:!1,renameWarningHint:!1}),i.createElement("div",{className:"project_warging_overview_page_view"},i.createElement(y.Z,{title:(0,U.u)({title:"\u9884\u8b66\u89c4\u5219",url:void 0})}),i.createElement("div",{className:"container"},i.createElement("div",{className:"content"},i.createElement("div",{className:"table-top"},i.createElement("div",null,i.createElement(R.Z,{placeholder:"\u8bf7\u8f93\u5165\u9884\u8b66\u89c4\u5219\u540d\u79f0",defValue:t,onSearch:function(e){return u({searchKey:e})},onClear:function(e){return u({searchKey:e})},style:{width:200,height:28,marginBottom:16}}),i.createElement(c.default.Group,{options:E.hm,onChange:function(e){return u({warningStatusList:e.target.value})},value:n,optionType:"button",style:{height:30,marginRight:"8px",marginBottom:16}}),i.createElement(C.Z,{options:E.rV,onChange:function(e){return u((0,r.Z)({},e))},objName:"level",preTitle:"\u7d27\u6025\u7a0b\u5ea6",divider:"none",type:"button",activeObj:a,sufIcon:"icon-cem_pull-down-or-take-up",style:{marginBottom:16}}),i.createElement(C.Z,{options:E.yZ,onChange:function(e){return u((0,r.Z)({},e))},objName:"categoryId",preTitle:"\u6570\u636e\u7c7b\u578b",divider:"none",type:"button",activeObj:l,sufIcon:"icon-cem_pull-down-or-take-up",style:{marginBottom:16}}),i.createElement("span",{style:{display:"inline-block",marginBottom:"10px"}},i.createElement(B.Z,{title:"\u63a8\u9001\u7528\u6237\u7ec4",options:v,showClearBtn:!0,value:o,onChange:function(e){return u({receiverTeamIdList:e})}})),i.createElement("span",{style:{display:"inline-block",marginBottom:"10px"}},i.createElement(B.Z,{title:"\u63a8\u9001\u6210\u5458",options:b,showClearBtn:!0,value:s,onChange:function(e){return u({receiverUserIdList:e})}}))),i.createElement("div",null,i.createElement(d.default,{className:"add-btn",type:"primary",onClick:function(){return P.mW.push("/account/project/warning/edit")}},"\u65b0\u5efa\u9884\u8b66"))),i.createElement(L.ZP,{loading:x,dataSource:m,columns:S,rowKey:"id",toolBarRender:!1,search:!1,pagination:{total:p,current:k,pageSize:Z},onChange:function(e){Z!==e.pageSize?u((0,r.Z)({},e,{current:1})):u((0,r.Z)({},e))}}),i.createElement(j,{id:O,visible:T,handleRenameCancel:this.handleRenameCancel,handleRenameOk:this.handleRenameOk}))))},t}(i.Component));const z=V;var K=n(55609),Y=n(64396),G=["loading"],J=Y.Z.project.warning.overview,q=function(e){function t(t){var n;return(n=e.call(this,t)||this).events=void 0,n._handleOnToggleChange=function(e){switch(e.typeStr){case"toggle":n.props.fetchToggleStatus((0,r.Z)({},e.toggleTarget));break;case"delete":n.props.deleteWarning((0,r.Z)({},e));break;case"rename":n.props.renameWarning((0,r.Z)({},e.target))}},n._handleOnFilterChange=function(e){n.props.fetchParams(e)},n.state={},n.events={onFilterChange:n._handleOnFilterChange,onToggleChange:n._handleOnToggleChange},n}(0,l.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=o.t.get(o.V.backProjectConfig).id;this.props.fetchWarningtList({projectId:e}),this.props.fetchTeamAndUserOptions({projectId:e})},n.componentWillUnmount=function(){this.props.clean()},n.render=function(){return i.createElement(z,(0,r.Z)({},this.props,this.state,this.events))},t}(i.Component);const Q=(0,K.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,G);return(0,r.Z)({},n[J],{fetchingWarningtList:t.effects[J+"/fetchWarningtList"]||!1})}),(function(e){return{save:function(t){return e({type:J+"/save",payload:t})},clean:function(){return e({type:J+"/clean"})},fetchParams:function(t){return e({type:J+"/fetchParams",payload:t})},fetchWarningtList:function(t){return e({type:J+"/fetchWarningtList",payload:t})},fetchToggleStatus:function(t){return e({type:J+"/fetchToggleStatus",payload:t})},deleteWarning:function(t){return e({type:J+"/deleteWarning",payload:t})},renameWarning:function(t){return e({type:J+"/renameWarning",payload:t})},fetchTeamAndUserOptions:function(t){return e({type:J+"/fetchTeamAndUserOptions",payload:t})}}}))(q)},55815:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(94578),r=n(67294),l=n(45697),i=n.n(l),o=n(43036),c=n(61409),s=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props,a=n.title,r=n.beforeJump;e!==a.length-1&&(r?new Promise((function(e,t){return r(e,t)})).then((function(){c.mW.push({pathname:a[e].url,state:a[e].state})})):c.mW.push({pathname:a[e].url,state:a[e].state}))},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.mainTitle,l=t.rightContent,i=t.className,c=t.overlay;return r.createElement("div",{className:"breadcumb-wrapper "+i},n instanceof Array?r.createElement("div",{className:"breadcrumb-left"},r.createElement("div",null,n.map((function(t,a){return r.createElement("span",{className:t.url?"":"not_clickable",key:a,onClick:function(){return t.url&&a!==n.length-1&&e._handleBreadcrumbClick(a)}},t.title,a!==n.length-1&&" / ")}))),r.createElement("span",null,a||n[n.length-1].title,c&&r.createElement(o.Z,{placement:"top",overlay:c},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}})))):r.createElement("div",{className:"normal-title"},n,c&&r.createElement(o.Z,{placement:"top",overlay:c},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}}))),l||"")},t}(r.Component);s.propTypes={className:i().string,title:i().oneOfType([i().string,i().arrayOf(i().shape({title:i().string,url:i().string,state:i().object}))]).isRequired,overlay:i().oneOfType([i().string,i().node]),mainTitle:i().oneOfType([i().string,i().node]),beforeJump:i().func,rightContent:i().node};const u=s}}]);