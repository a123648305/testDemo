"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[483],{40483:(e,t,a)=>{a.r(t),a.d(t,{default:()=>b});var n=a(87462),r=a(94578),i=a(67294),s=a(20899),o=a(82817),l=a(40086),c=a(92360),m=a(43036),d=a(31705),p=a(94644),u=[{name:"\u6309\u5929",id:"DAY"},{name:"\u6309\u5468",id:"WEEK"}],h=function(e){function t(t){var a;return(a=e.call(this,t)||this).resizeFontSize=function(){var e=.03*a.flexWrapper.offsetWidth;document.getElementById("flexSpan").style.fontSize=e+"px";for(var t=document.getElementsByClassName("category"),n=0;n<t.length;n++)t[n].style.marginRight="4px"},a.resize=function(){a.flexWrapper&&(a.resizeFontSize(),a.bar.resize())},a.switchDateDimension=function(e){a.setState({queryTimeType:e},(function(){a.props.onDateDimensionChange(e.id)}))},a._handleChartDownload=function(e,t){(0,p._v)(a.bar.chart,e+"-"+t)},a._handleExcelDownload=function(e,t){var n=a.state.data.map((function(e){return[e.date,e.count]}));n.splice(0,0,["\u65e5\u671f","\u53d6\u503c"]),(0,p.aT)([n],e+"-"+t)},a.handleChartClick=function(e){var t=a.state.selectedIndex,n=e.name,r=e.dataIndex,i=a.props,s=i.clickChart,o=i.handleReset;r===t?o():(a.setState({selectedIndex:r},(function(){var e=a.getChartOption();a.bar&&a.bar.setChartOption(e)})),s&&s(n))},a.handleResetChart=function(){a.setState({selectedIndex:-1},(function(){var e=a.getChartOption();a.bar&&a.bar.setChartOption(e)}))},a.state={queryTimeType:u[0],data:[],total:0,average:0,loading:!1,selectedIndex:-1,option:{}},a}(0,r.Z)(t,e);var h=t.prototype;return h.componentDidMount=function(){this.getChartOption()},h.UNSAFE_componentWillReceiveProps=function(e){this.setState((0,n.Z)({},e))},h.componentDidUpdate=function(e,t){this.flexWrapper&&this.resizeFontSize()},h.formatNum=function(e){return 0<=e&&e<1e3?e:e<1e4?(e/1e3).toFixed(2)+"\u5343":(e/1e4).toFixed(2)+"\u4e07"},h.getChartOption=function(){var e=this.state,t=e.data,a=e.selectedIndex;return{title:{text:"\u6570\u636e\u8d8b\u52bf",textStyle:{fontSize:14}},barMaxWidth:40,barGap:"30%",grid:(0,n.Z)({},o.I.grid,{top:36,left:40}),xAxis:(0,n.Z)({},o.I.xAxis,{data:t.map((function(e){return e.date}))}),yAxis:(0,n.Z)({},o.I.yAxis),tooltip:(0,n.Z)({},o.I.tooltip,{formatter:function(e){return e[0].axisValue+"\u6570\u636e<br>"+e[0].marker+" "+e[0].value}}),series:{data:t.map((function(e){return e.count})),type:"bar",itemStyle:{normal:{color:function(e){return-1===a||a===e.dataIndex?"#1574B3":"#D2D2D2"}}}}}},h.render=function(){var e=this,t=this.state,n=t.data,r=t.total,o=t.queryTimeType,p=t.loading,h="DAY"===o.id?(r/30).toFixed(2):(r/4).toFixed(2);return i.createElement("div",{className:"overviewChartWrapper"},i.createElement(c.Loading,{loading:p,text:"\u62fc\u547d\u52a0\u8f7d\u4e2d"},p?i.createElement("div",{style:{height:"167px"}}):n.length>0?i.createElement("div",null,i.createElement("div",{className:"detailChart-top",ref:function(t){return e.flexWrapper=t}},i.createElement("div",null,i.createElement("div",null,i.createElement("span",null,"\u6570\u636e\u603b\u91cf")),i.createElement("div",{style:{height:"62px"}},i.createElement(m.Z,{placement:"top",overlay:r},i.createElement("span",{id:"flexSpan",style:{fontSize:"50px"}},this.formatNum(r)))),i.createElement("div",null,i.createElement("div",null,i.createElement("span",{className:"category"},"\u5e73\u5747\u503c"),i.createElement(m.Z,{placement:"top",overlay:h},i.createElement("span",null,this.formatNum(h)))))),i.createElement("div",{className:"chart-top-wrapper"},i.createElement("div",{className:"time-btn-wrapper"},i.createElement(d.Z,{onDownChartClick:function(){return e._handleChartDownload("\u6570\u636e\u8d8b\u52bf",o.name)},onDownExcelClick:function(){return e._handleExcelDownload("\u6570\u636e\u8d8b\u52bf",o.name)}}),i.createElement(l.Z,{style:{float:"right"},list:u,onChange:this.switchDateDimension,value:o,placeholder:o.name,partingLine:!0})),i.createElement(s.Z,{ref:function(t){return e.bar=t},uniqueId:"insight",option:this.getChartOption(),height:167,clickChart:this.handleChartClick})))):i.createElement("div",{className:"noDataTips"},i.createElement("img",{src:a(3381)}),i.createElement("span",null,"\u6682\u65e0\u53ef\u7528\u6570\u636e"))))},t}(i.Component),g=a(52314),f=a(30381),v=a.n(f),E=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleReset=function(){n.props.handleReset&&n.props.handleReset()},n.renderMsgList=function(e){var t=n.state.loading,r=(document.documentElement.clientWidth-64-36-76-68-24-32-200)/2;return i.createElement(c.Loading,{loading:t,text:"\u62fc\u547d\u52a0\u8f7d\u4e2d"},i.createElement("div",{className:"message-list"},e.map((function(e,t){return i.createElement("div",{className:"blog-container",key:t},i.createElement(g.X,{className:"blog-title"},i.createElement(g.J,{className:"base-info source"},i.createElement("span",{className:"source-img"},i.createElement("img",{src:e.userImage?e.userImage.startsWith("http")?e.userImage:location.protocol+"//"+e.userImage:a(88958),"data-url":e.userImage,alt:"\u5934\u50cf"}))),i.createElement(g.J,{className:"base-info product"},e.username),i.createElement(g.J,{className:"base-info  pull-right"},i.createElement("span",{className:"time"},v()(e.createTime).format("YYYY-MM-DD HH:mm")),i.createElement("span",{className:"type"},e.type))),i.createElement(g.X,{className:"blog-body"},e.content),i.createElement("div",{className:"blog-body message-detail"},i.createElement("span",{className:"title line ellipsis",style:{maxWidth:r},title:e.title},"- "+e.title),i.createElement("div",null,i.createElement("span",{className:"source line ellipsis"},"\u6765\u6e90\uff1a",e.sourceName),i.createElement("span",{className:"connect line ellipsis",style:{maxWidth:r},title:e.title},"\u94fe\u63a5\uff1a",e.connectionName),i.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"line ellipsis"},"\u6570\u636e\u6e90"))))}))))},n.state={pageIndex:1,msgList:[],loading:!1,selectedDate:""},n}(0,r.Z)(t,e);var s=t.prototype;return s.UNSAFE_componentWillReceiveProps=function(e){this.setState((0,n.Z)({},e))},s.render=function(){var e=this.state,t=e.selectedDate,a=e.msgList,n=e.total,r=e.pageIndex,s=e.pageSize,o=this.props.onPageChange;return i.createElement("div",{className:"message-detail-wrapper"},i.createElement("div",{className:"message-top"},i.createElement("div",{className:"left"},i.createElement("span",{style:{marginLeft:5,fontSize:14}},"\u6d88\u606f\u8be6\u60c5"),t&&i.createElement("div",{style:{display:"inline-block"}},i.createElement("span",null,t),i.createElement("span",{onClick:this.handleReset},"\u6e05\u9664\u9009\u62e9"))),i.createElement("div",{className:"total"},i.createElement("span",null,"\u5171",i.createElement("i",null," ",n||0," "),"\u6761\u6d88\u606f"))),n>0&&this.renderMsgList(a),n>0&&i.createElement("div",{className:"pager-container"},i.createElement(c.Pagination,{pageSize:s,className:"pagination",small:!0,total:n,layout:"prev, pager, next",currentPage:r,onCurrentChange:o})))},t}(i.Component),y=a(12518),C=a(49722);const D=function(){return i.createElement("div",{className:"dividerWrapper"})};var x=a(35239),N="YYYY-MM-DD HH:mm:ss",b=function(e){function t(t){var a;return(a=e.call(this,t)||this).fetchData=function(e){var t=x.t.get(x.V.backProjectConfig).id,r=a.state,i=r.id,s=r.type,o=r.msgData,l=r.msgData,c=l.beginDate,m=l.endDate,d=l.pageIndex,p=l.pageSize,u=l.isInitial,h=r.dateGroupType,g=r.selectedDate,f="custom"===s?"/userConfig/invalid/detail/list":"/userConfig/default/detail/list",E="msg"===e&&g?{projectId:t,pageIndex:d,pageSize:p,start:c,end:m,dateHistogramInterval:h}:{projectId:t,pageIndex:d,pageSize:p,end:v()().format(N),start:v()().subtract(29,"days").hour(0).minute(0).second(0).format(N),dateHistogramInterval:h};"custom"===s?E.id=i:E.content=i,a.setState({chartLoading:"msg"!==e,msgListLoading:"chart"!==e},(function(){C.h.post(f,(0,n.Z)({},E)).then((function(t){var r=t.data,i=r.code,s=r.result;if(2e4===i&&s){var l=s.result,c=l.dateCountList,m=l.commentList,d=l.total;if("chart"===e)a.setState({chartLoading:!1,chartData:{total:d,data:c||[]}});else if("msg"===e){if(a.setState({msgListLoading:!1,msgData:(0,n.Z)({},o,{total:d,msgList:m||[],loading:!1})}),!u){var p=document.getElementsByClassName("content")&&document.getElementsByClassName("content")[0];p&&(p.scrollTop=210)}}else a.setState({chartLoading:!1,msgListLoading:!1,chartData:{total:d,data:c||[]},msgData:(0,n.Z)({},o,{total:d,msgList:m||[],loading:!1,isInitial:!1})})}}))}))},a.handleDateDimensionChange=function(e){a.setState({dateGroupType:e},(function(){return a.fetchData("chart")}))},a.handleChartClick=function(e){var t,r,i,s=a.state.msgData,o="YYYY-MM-DD";if(7===e.length){var l=e.split("-"),c=l[0],m=l[1],d=v()(c).week(m),p=v()(d.startOf("week").format(o),o),u=v()(d.endOf("week").format(o),o);u.hour(23).minute(59).second(59),t=p.format(N),r=u.format(N),i=p.format(o)+" - "+u.format(o)}else r=v()(e,o).add(1,"days").format(N),t=v()(e,o).format(N),i=e;a.setState({selectedDate:i,msgData:(0,n.Z)({},s,{beginDate:t,endDate:r,pageIndex:1,isInitial:!0})},(function(){return a.fetchData("msg")}))},a.handleReset=function(){var e=a.state.msgData;a.setState({selectedDate:"",msgData:(0,n.Z)({},e,{pageIndex:1,beginDate:"",endDate:""})},(function(){return a.fetchData("msg")})),a.chart&&a.chart.handleResetChart()},a.handlePageChange=function(e){var t=a.state.msgData;a.setState({msgData:(0,n.Z)({},t,{pageIndex:e,isInitial:!1})},(function(){return a.fetchData("msg")}))},a.state={id:"",type:"custom",dateGroupType:"DAY",chartData:{total:0,data:[]},chartLoading:!1,msgListLoading:!1,msgData:{beginDate:"",endDate:"",pageIndex:1,pageSize:20,total:0,msgList:[],isInitial:!0},selectedDate:""},a}(0,r.Z)(t,e);var a=t.prototype;return a.UNSAFE_componentWillMount=function(){var e=this,t=location.search,a=decodeURIComponent(t).replace(/\"/g,"");if(a.startsWith("?type")){var n=a.split("&"),r=n[0],i=n[1],s=r.split("=")[1],o=i.split("=")[1];this.setState({id:o,type:s},(function(){return e.fetchData("both")}))}},a.render=function(){var e=this,t=this.state,a=t.chartData,r=t.msgData,s=t.chartLoading,o=t.msgListLoading,l=t.selectedDate,c=(0,n.Z)({},a,{loading:s,onDateDimensionChange:this.handleDateDimensionChange,clickChart:this.handleChartClick,handleReset:this.handleReset}),m=(0,n.Z)({},r,{selectedDate:l,loading:o,onPageChange:this.handlePageChange,handleReset:this.handleReset});return i.createElement("div",{className:"useless-msg-detail-wrapper"},i.createElement(y.Z,{title:"\u8fd130\u5929\u65e0\u6548\u6d88\u606f"}),i.createElement("div",{className:"content"},i.createElement(h,(0,n.Z)({ref:function(t){return e.chart=t}},c)),i.createElement(D,null),i.createElement(E,m)))},t}(i.Component)},20899:(e,t,a)=>{a.d(t,{Z:()=>m});var n=a(94578),r=a(67294),i=a(45697),s=a.n(i),o=a(70596),l=a.n(o),c=a(67592),m=function(e){function t(t){var a;return(a=e.call(this,t)||this).setChartOption=function(e){a.chart&&a.chart.setOption(e)},a.chart="",a}(0,n.Z)(t,e);var a=t.prototype;return a.componentDidMount=function(){var e=this,t=this.props.uniqueId;this.chart=l().init(document.getElementById(t)),this.chart.on("click",(function(t){e.props.clickChart&&e.props.clickChart(t)})),this.setChartOption(this.props.option)},a.UNSAFE_componentWillReceiveProps=function(e){(0,c.d)(this.props.option,e.option)||this.setChartOption(e.option)},a.resize=function(){this.chart.resize()},a.render=function(){var e=this.props,t=e.uniqueId,a=e.height;return r.createElement("div",{className:"barchart-wrapper"},r.createElement("div",{id:t,className:"baseChart",style:{width:"100%",height:a}}))},t}(r.PureComponent);m.propTypes={uniqueId:s().string.isRequired,option:s().object,height:s().number.isRequired,clickChart:s().func}},82817:(e,t,a)=>{a.d(t,{I:()=>n,o:()=>r});var n={legend:{data:[],itemWidth:13,itemHeight:13,itemGap:12,right:10,top:0,orient:"vertical"},textStyle:{color:"#262626",fontFamily:"'PingFang SC','Microsoft Yahei', 'Helvetica Neue', Helvetica, Tahoma, Arial, 'Hiragino Sans GB', 'WenQuanYi Micro Hei', sans-serif"},grid:{tooltip:{trigger:"axis"},containLabel:!0,left:30,right:80,bottom:5,top:5,splitLine:{show:!0}},xAxis:{type:"category",axisTick:{show:!1},axisLine:{show:!0,lineStyle:{type:"solid",color:"#E5E5E5"}},axisLabel:{show:!0,color:"#999"},axisPointer:!1,data:[]},yAxis:{type:"value",splitLine:{show:!0,lineStyle:{type:"dotted",color:"#E8E8E8"}},axisTick:{show:!1},axisLine:{show:!1},axisLabel:{show:!1}},tooltip:{trigger:"axis",backgroundColor:"rgba(255,255,255,0.9)",borderWidth:1,borderColor:"#ccc",padding:10,textStyle:{color:"#262626"},extraCssText:"box-shadow: 0 0 3px rgba(0, 0, 0, 0.3);",confine:!0}},r=["#1550B3","#CC6A77","#119073","#CDB446","#D969BF","#2684FF","#C8662B","#9369D9","#0E97AD","#1BBF69","#D07B49","#61799B","#1EA082","#A9A557","#D8727F"]},84948:(e,t,a)=>{a.d(t,{Z:()=>h});var n=a(87462),r=a(63366),i=a(94578),s=a(67294),o=a(45697),l=a.n(o),c=a(94184),m=a.n(c),d=["children","className","prefixCls","col","fr"],p={prefixCls:l().string,col:l().string,fr:l().bool},u=function(e){function t(){return e.apply(this,arguments)||this}return(0,i.Z)(t,e),t.prototype.render=function(){var e,t=this.props,a=t.children,i=t.className,o=t.prefixCls,l=t.col,c=t.fr,p=(0,r.Z)(t,d),u=m()(o,l&&l.split(" ").map((function(e){return o+"-"+e})),((e={})[o+"-fr"]=c,e),i);return s.createElement("div",(0,n.Z)({className:u},p),a)},t}(s.Component);u.propTypes=p,u.defaultProps={prefixCls:"wt-col",fr:!1};const h=u},52314:(e,t,a)=>{a.d(t,{J:()=>n.Z,X:()=>g});var n=a(84948),r=a(87462),i=a(63366),s=a(94578),o=a(67294),l=a(45697),c=a.n(l),m=a(94184),d=a.n(m),p=["children","className","prefixCls","row","gutther","fluid"],u={prefixCls:c().string,row:c().string,fluid:c().bool},h=function(e){function t(){return e.apply(this,arguments)||this}return(0,s.Z)(t,e),t.prototype.render=function(){var e,t=this.props,a=t.children,n=t.className,s=t.prefixCls,l=t.row,c=t.gutther,m=t.fluid,u=(0,i.Z)(t,p),h=d()(s,l&&l.split(" ").map((function(e){return s+"-"+e})),((e={})[s+"-gutther"]=c,e[s+"-fluid"]=m,e),n);return o.createElement("div",(0,r.Z)({className:h},u),a)},t}(o.Component);h.propTypes=u,h.defaultProps={prefixCls:"wt-row",fluid:!1};const g=h},40086:(e,t,a)=>{a.d(t,{Z:()=>l});var n=a(87462),r=a(94578),i=a(67294),s=a(45697),o=a.n(s),l=function(e){function t(t){var a;return(a=e.call(this,t)||this).stop=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},a._setEvent=function(e){return 0===e?{onMouseEnter:function(){a.setState({firstLiHover:!0})},onMouseLeave:function(){a.setState({firstLiHover:!1})}}:{}},a.setShowSelFalse=function(){a.setState({show:!1})},a.state={show:!1,firstSelected:!1},a}(0,r.Z)(t,e);var a=t.prototype;return a.changeShow=function(e){var t=this;this.state.show&&this.stop(e),setTimeout((function(){t.setState({show:!t.state.show})}),0)},a.componentDidMount=function(){window.addEventListener("click",this.setShowSelFalse)},a.componentWillUnmount=function(){window.removeEventListener("click",this.setShowSelFalse)},a.render=function(){var e=this,t=this.state.show,a=this.props,r=a.placeholder,s=a.list,o=a.value,l=a.onChange,c=a.style,m=a.partingLine,d=s[0]&&s[0].id===o.id;return i.createElement("div",{className:"chart-select",style:c||{}},i.createElement("div",{className:"select "+(m?"line":""),onClick:function(t){return e.changeShow(t)}},i.createElement("div",{className:"infor "+(t?"sel":"")},i.createElement("span",{className:"placeholder"},r),i.createElement("i",{className:"icon icon-cem_arrow-launches",style:{transform:t?"rotate(-180deg)":"",top:t?"3px":""}}))),t&&i.createElement("div",{className:"position-wrap"},i.createElement("div",{className:"selItem "+(this.state.firstLiHover||d?"selPadHover":""),onClick:function(t){return e.stop(t)}},i.createElement("div",{className:"wrap"},i.createElement("ul",null,s.length>0?s.map((function(t,a){return i.createElement("li",(0,n.Z)({className:t.id===o.id?"sel":"",key:a,onClick:function(){e.setShowSelFalse(),l&&l(t,a)}},e._setEvent(a)),i.createElement("span",null,t.name))})):i.createElement("div",{className:"noData"},"\u65e0\u6570\u636e"))))))},t}(i.Component);l.defaultProps={placeholder:"\u8bf7\u9009\u62e9",list:[{name:"\u5468",id:"week"},{name:"\u6708",id:"month"}],value:{}},l.propTypes={placeholder:o().oneOfType([o().string,o().element]),list:o().array,value:o().object,onChange:o().func,style:o().object,partingLine:o().bool}},12518:(e,t,a)=>{a.d(t,{Z:()=>m});var n=a(94578),r=a(67294),i=a(45697),s=a.n(i),o=a(61409),l=a(92360),c=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this)._handleBreadcrumbClick=function(e){var a=t.props.title;e!==a.length-1&&o.mW.go(e-a.length+1)},t}return(0,n.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,a=t.title,n=t.rightContent;return r.createElement("div",{className:"secondary-header"},a instanceof Array?r.createElement(l.Breadcrumb,{className:"breadcrumb-style",separator:""},a.map((function(t,a){return r.createElement(l.Breadcrumb.Item,{key:a},r.createElement("span",{onClick:function(){return e._handleBreadcrumbClick(a)}},t))}))):r.createElement("div",{className:"normal-title"},a),n&&n)},t}(r.Component);c.propTypes={title:s().oneOfType([s().string,s().array]).isRequired,rightContent:s().node};const m=c},3381:(e,t,a)=>{e.exports=a.p+"img/459a43effdbcbdd83095.png"},88958:(e,t,a)=>{e.exports=a.p+"img/aa245f8de9f2aa549c26.png"}}]);