"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[6368],{1242:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var a=n(87462),l=n(94578),r=n(67294),s=n(92360),i=n(5133),o=n(49722),m=n(12518),c=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return(t=e.call.apply(e,[this].concat(a))||this).state={form:{host:"",username:"",password:null,subjectPrefix:""},formClone:{},disabled:!0,rules:{host:[{required:!0,message:"\u8bf7\u8f93\u5165\u53d1\u4ef6\u7bb1\u7c7b\u578b",trigger:"blur"}],username:[{required:!0,message:"\u8bf7\u8f93\u5165\u53d1\u4ef6\u4eba",trigger:"blur"},{validator:function(e,t,n){/^([a-zA-Z0-9_.-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/.test(t)?n():n(new Error("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u53d1\u4ef6\u5730\u5740"))}}],password:{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801",trigger:"blur"}},sendDialogVisible:!1,sendMailForm:{sendTo:"",subject:"",text:""},options:[{value:"smtp.exmail.qq.com",label:"\u817e\u8baf\u4f01\u4e1a\u90ae\u7bb1"},{value:"smtp.163.com",label:"163\u90ae\u7bb1"},{value:"smtp.mail.yahoo.com.cn",label:"yahoo\u90ae\u7bb1"},{value:"smtp.sohu.com",label:"sohu\u90ae\u7bb1"},{value:"smtp.qq.com",label:"QQ\u90ae\u7bb1"},{value:"smtp.gmail.com",label:"Gmail\u90ae\u7bb1"}]},t}(0,l.Z)(t,e);var n=t.prototype;return n.onChange=function(e,t){var n;this.setState({form:Object.assign(this.state.form,(n={},n[e]=t,n))})},n.sendMailOnChange=function(e,t){var n;this.setState({sendMailForm:Object.assign(this.state.sendMailForm,(n={},n[e]=t,n))})},n.handleNameSubmit=function(){var e=this;this.refs.form.validate((function(t){if(!t)return!1;o.h.post("/mail/addConfig",(0,a.Z)({},e.state.form)).then((function(t){e.setState({disabled:!0,formClone:JSON.parse(JSON.stringify(e.state.form))})}))}))},n.cancel=function(){this.refs.form.resetFields(),this.setState({disabled:!0,form:JSON.parse(JSON.stringify(this.state.formClone))})},n.edit=function(){this.setState({disabled:!1})},n.sendEmailDialog=function(){this.setState({sendDialogVisible:!0})},n.resetForm=function(){this.setState({sendDialogVisible:!1,sendMailForm:{sendTo:"",subject:"",text:""}})},n.sendMail=function(){var e=this,t=this.state.sendMailForm;for(var n in t)if(""===t[n].trim())return void i.Z.warning("\u8bf7\u586b\u5199\u5fc5\u8981\u4fe1\u606f");/^([a-zA-Z0-9_.-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/.test(t.sendTo)?o.h.post("/mail/send",(0,a.Z)({},t)).then((function(t){i.Z.success(t.data.msg),e.setState({sendDialogVisible:!1,sendMailForm:{sendTo:"",subject:"",text:""}},(function(t){return log(e.state.form)}))})):i.Z.warning("\u8bf7\u586b\u5199\u6b63\u786e\u7684\u90ae\u7bb1\u5730\u5740")},n.componentDidMount=function(){var e=this;o.h.get("/mail/loadConfig").then((function(t){var n=t.data.result;for(var l in n)null!==n[l]&&(n[l]=String(n[l]));e.setState({form:(0,a.Z)({},n,{password:null===n.password?null:""}),formClone:(0,a.Z)({},n,{password:null===n.password?null:""})})}))},n.render=function(){var e=this.state,t=e.form,n=e.disabled,a=e.sendMailForm,l=e.sendDialogVisible,i=this.state.options.filter((function(e){return e.value===t.host}))[0];i=i?i.label:"";var o=document.documentElement.clientHeight-46-48-24;return r.createElement("div",{className:"outboxSettingWrap common-wrapper"},r.createElement(m.Z,{title:"\u53d1\u4ef6\u7bb1\u914d\u7f6e"}),r.createElement("div",{className:"outboxSetting common-padding-12"},r.createElement("div",{style:{minHeight:o,backgroundColor:"#fff"}},r.createElement(s.Form,{model:t,rules:this.state.rules,className:"outboxForm",ref:"form",labelWidth:"120px",labelPosition:"left",width:"500px"},r.createElement(s.Form.Item,{label:"\u53d1\u4ef6\u7bb1\u7c7b\u578b",prop:"host"},n?r.createElement("span",null,i):r.createElement("p",null,r.createElement(s.Select,{value:t.host,onChange:this.onChange.bind(this,"host")},this.state.options.map((function(e){return r.createElement(s.Select.Option,{key:e.value,label:e.label,value:e.value})}))))),r.createElement(s.Form.Item,{label:"\u53d1\u4ef6\u4eba",prop:"username"},r.createElement(s.Input,{onChange:this.onChange.bind(this,"username"),disabled:n,value:t.username})),r.createElement(s.Form.Item,{label:"\u6388\u6743\u7801",prop:"password"},n?r.createElement("span",null,null===t.password?"":"******"):r.createElement(s.Input,{type:"password",onChange:this.onChange.bind(this,"password"),disabled:n,value:t.password})),r.createElement(s.Form.Item,{label:"\u6807\u9898\u524d\u7f00",prop:"subjectPrefix"},r.createElement(s.Input,{onChange:this.onChange.bind(this,"subjectPrefix"),disabled:n,value:t.subjectPrefix})),r.createElement("div",{className:"btn"},n?r.createElement("p",null,r.createElement(s.Button,{type:"primary",onClick:this.sendEmailDialog.bind(this)},"\u53d1\u9001\u6d4b\u8bd5\u90ae\u4ef6"),r.createElement(s.Button,{type:"primary",onClick:this.edit.bind(this)},"\u7f16\u8f91")):r.createElement("p",null,r.createElement(s.Button,{type:"primary",onClick:this.handleNameSubmit.bind(this)},"\u786e\u8ba4"),r.createElement(s.Button,{onClick:this.cancel.bind(this)},"\u53d6\u6d88"))))),r.createElement(s.Dialog,{title:"\u53d1\u9001\u90ae\u4ef6",size:"tiny",visible:l,onCancel:this.resetForm.bind(this)},r.createElement(s.Dialog.Body,null,r.createElement(s.Form,{model:a},r.createElement(s.Form.Item,{label:"\u53d1\u9001\u81f3",prop:"sendTo"},r.createElement(s.Input,{onChange:this.sendMailOnChange.bind(this,"sendTo"),value:a.sendTo}),r.createElement("i",null,"*")),r.createElement(s.Form.Item,{label:"\u4e3b\u9898",prop:"subject"},r.createElement(s.Input,{onChange:this.sendMailOnChange.bind(this,"subject"),value:a.subject}),r.createElement("i",null,"*")),r.createElement(s.Form.Item,{label:"\u5185\u5bb9",prop:"text"},r.createElement(s.Input,{placeholder:"\u8f93\u5165\u5185\u5bb9",type:"textarea",value:a.text,onChange:this.sendMailOnChange.bind(this,"text")}),r.createElement("i",null,"*")))),r.createElement(s.Dialog.Footer,{className:"dialog-footer"},r.createElement(s.Button,{onClick:this.resetForm.bind(this)},"\u53d6 \u6d88"),r.createElement(s.Button,{type:"primary",onClick:this.sendMail.bind(this)},"\u786e \u5b9a")))))},t}(r.Component)},12518:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(94578),l=n(67294),r=n(45697),s=n.n(r),i=n(61409),o=n(92360),m=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props.title;e!==n.length-1&&i.mW.go(e-n.length+1)},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.rightContent;return l.createElement("div",{className:"secondary-header"},n instanceof Array?l.createElement(o.Breadcrumb,{className:"breadcrumb-style",separator:""},n.map((function(t,n){return l.createElement(o.Breadcrumb.Item,{key:n},l.createElement("span",{onClick:function(){return e._handleBreadcrumbClick(n)}},t))}))):l.createElement("div",{className:"normal-title"},n),a&&a)},t}(l.Component);m.propTypes={title:s().oneOfType([s().string,s().array]).isRequired,rightContent:s().node};const c=m}}]);