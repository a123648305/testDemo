"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[1014],{91014:(e,t,n)=>{n.r(t),n.d(t,{default:()=>z});var a=n(94578),r=n(67294),l=n(55815),i=n(63366),o=n(87462),c=n(61918),s=n(92360),u=n(45697),p=n.n(u),h=n(94184),d=n.n(h),m=function(e){function t(t){var n;return(n=e.call(this,t)||this).togglePanel=function(e){var t=n.state.panelShow;t&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()),setTimeout((function(){return n.setState({panelShow:!t})}),0)},n.handleCheckAllStatus=function(){var e=n.state,t=e.tempValue,a=e.filteredOptions,r=n.props.options,l=a||r;n.setState({allChecked:t.length>0&&t.length===l.length,indeterminate:t.length>0&&t.length<l.length})},n.handleConfirm=function(){var e=n.state.tempValue;n.setState({value:JSON.parse(JSON.stringify(e)),panelShow:!1}),n.props.onChange(e)},n.handleCancel=function(){var e=n.state,t=e.value,a=e.filteredOptions,r=n.props.options,l=a||r;n.setState({tempValue:JSON.parse(JSON.stringify(t)),panelShow:!1,allChecked:t&&t.length>0&&t.length===l.length,indeterminate:t&&t.length>0&&t.length<l.length},(function(){return n.handleClearInput()}))},n.handleReset=function(){n.setState({tempValue:[],value:[],panelShow:!1,searchText:""},(function(){return n.handleCheckAllStatus()}))},n.handleFilter=function(e){var t=n.props.options;if(e.trim().length>0){var a=t.filter((function(t){return t.name.toUpperCase().includes(e.toUpperCase())}));n.setState({searchText:e,filteredOptions:a})}else n.setState({filteredOptions:void 0,searchText:e})},n.handleClearInput=function(){n.state.searchText.length>0&&n.setState({searchText:"",filteredOptions:void 0},(function(){return n.handleCheckAllStatus()}))},n.state={type:t.type||2,title:t.title||"",filteredOptions:void 0,tempValue:t.defaultValue||[],value:t.defaultValue||[],maxLength:t.maxLength||0,indeterminate:!1,allChecked:!1,panelShow:!1,searchText:""},n}(0,a.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){window.addEventListener("click",this.handleCancel)},t.getDerivedStateFromProps=function(e,t){var n=e.type,a=e.title,r=e.options,l=e.value;if(n!==t.type)return{type:n};if(a!==t.title)return{title:a};if(JSON.stringify(l)!==JSON.stringify(t.value)){var i=l.length>0?r.reduce((function(e,t){var n=l.indexOf(t.id);return n>-1?e[n]=t:e.splice(e.length,0,t),e}),l.slice()):void 0;return{filteredOptions:i,value:l,tempValue:l||[],allChecked:l&&l.length>0&&i&&l.length===i.length,indeterminate:l&&l.length>0&&i&&l.length<i.length}}return null},n.componentWillUnmount=function(){window.removeEventListener("click",this.handleCancel)},n.handleCheckAll=function(){var e=this,t=this.state,n=t.tempValue,a=t.filteredOptions,r=this.props.options,l=a||r;this.setState({tempValue:n.length===l.length?[]:l.map((function(e){return e.id}))},(function(){return e.handleCheckAllStatus()}))},n.handleCheckOne=function(e){var t=this,n=this.state,a=n.tempValue,r=n.maxLength;if(r>0&&(a.length>=r&&a.includes(e)||a.length<r)||0===r){var l=a.indexOf(e);l>-1?a.splice(l,1):a.push(e),this.setState({tempValue:a},(function(){return t.handleCheckAllStatus()}))}},n.render=function(){var e=this,t=this.state,n=t.type,a=t.title,l=t.filteredOptions,i=t.indeterminate,c=t.allChecked,u=t.panelShow,p=t.tempValue,h=t.value,m=t.maxLength,f=t.style,g=t.searchText,v=this.props.options,C=v.length>0?v.filter((function(e){return h.includes(e.id)})).map((function(e){return e.name})):[],y=d()({"cc_multi-select-wrapper":!0,whiteBg:1===n,sel:u}),k=n&&1===n?"\u8bf7\u9009\u62e9":"\u5168\u90e8",E=this.props.note,_=l||v;return r.createElement("div",{className:y,style:(0,o.Z)({backgroundColor:u?"rgb(97,121,155)":""},f),onClick:this.togglePanel},r.createElement("span",null,a&&a+"\uff1a"),r.createElement("span",{className:"currValue",title:C.length>0?C.length===v.length?"\u5168\u90e8":C.join("\uff0c"):k},C.length>0?C.length===v.length?"\u5168\u90e8":C.join("\uff0c"):k),r.createElement("i",{className:"icon-cem_arrow-launches",style:{transform:u?"rotate(-180deg)":"",top:u?"-2px":"3px"}}),r.createElement("div",{className:"multi-select-panel",style:{display:u?"block":"none"},onClick:function(e){return e.stopPropagation()}},r.createElement("div",{className:"multi-select-header"},!!m&&r.createElement("div",{className:"limit_info"},"\u6dfb\u52a0\u5c55\u793a",r.createElement("span",null,"\uff08\u6700\u591a"+m+"\u4e2a\uff0c\u5df2\u6dfb\u52a0"+p.length+"\u4e2a\uff09")),r.createElement(s.Input,{ref:function(t){return e.input=t},value:g,onChange:this.handleFilter,placeholder:"\u8bf7\u8f93\u5165\u641c\u7d22\u5173\u952e\u8bcd",icon:g.length>0?"close":"search",onIconClick:this.handleClearInput})),r.createElement("ul",{className:"multi-select-panel-body"},_.length>0?r.createElement(r.Fragment,null,0===m&&r.createElement("li",{className:"all_check",onClick:function(){return e.handleCheckAll()}},r.createElement("div",{className:"all_select"},r.createElement(s.Checkbox,{checked:c,indeterminate:i,onChange:function(){return e.handleCheckAll()}}),r.createElement("label",null,"\u5168\u9009"))),_.map((function(t,n){return r.createElement("li",{key:n,className:m>0&&p.length>=m&&!p.includes(t.id)?"disabled":"",onClick:function(){return e.handleCheckOne(t.id)},style:{height:E?"50px":"36px"}},r.createElement(s.Checkbox,{disabled:m>0&&p.length>=m&&!p.includes(t.id),checked:p.includes(t.id),value:t.id,onChange:function(){return e.handleCheckOne(t.id)}}),r.createElement("label",{title:t.name},t.name),E&&r.createElement("p",{className:"note"},E(t)))}))):r.createElement("li",null,r.createElement("label",null,"\u6682\u65e0\u6570\u636e"))),r.createElement("div",{className:"multi-select-panel-footer"},r.createElement(s.Button,{type:"primary",onClick:this.handleConfirm},"\u786e\u8ba4"),r.createElement(s.Button,{onClick:this.handleCancel},"\u53d6\u6d88"))))},t}(r.Component);m.propTypes={type:p().number,title:p().string.isRequired,options:p().arrayOf(p().shape({id:p().oneOfType([p().string,p().number]),name:p().string})),defaultValue:p().arrayOf(p().string),value:p().arrayOf(p().string),maxLength:p().number,onChange:p().func.isRequired,style:p().object,note:p().func};var f=n(43144),g=n(2271),v=n(43036),C=function(e){var t=e.value,n=e.onChange,a=e.options,l=r.useRef(void 0),i=a.find((function(e){return e.value===t})),o=r.useState(!1),c=o[0],s=o[1];return r.useEffect((function(){var e=function(){c&&s(!1)};return window.addEventListener("click",e),function(){return window.removeEventListener("click",e)}})),i?r.createElement("div",{className:"yt_table_item_selector_wrapper"},i.title,r.createElement(v.Z,{ref:l,visible:c,placement:"bottom",overlayClassName:"yt_table_item_selector_overlay",overlay:r.createElement(r.Fragment,null,a.map((function(e){return r.createElement("div",{className:"item "+(e.value===t?"sel":""),key:e.value,onClick:function(){return n&n(e.value)}},e.title)})))},r.createElement("i",{className:"icon-cem_pull-down-or-take-up "+(c?"active":""),style:{transform:c?"rotate(-180deg)":""},onClick:function(e){e.stopPropagation(),s(!c)}}))):"\u5dee\u4ef7\u9ad8\u4e8e"};const y=C;C.propTypes={value:p().string,onChange:p().func,options:p().shape({title:p().string,value:p().string})};var k=n(79607),E=n(87219),_={callback:void 0,visible:!1,type:"UNKNOWN"};const b=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnConfirm=function(){var e=n.state,t=e.callback,a=e.type;t&&t({type:a}),n._handleOnCancel()},n._handleOnCancel=function(){n.setState(JSON.parse(JSON.stringify(_)))},n._handleOnTypeChange=function(e){n.setState({type:e})},n.state=JSON.parse(JSON.stringify(_)),n}(0,a.Z)(t,e);var n=t.prototype;return n.show=function(e){this.setState((0,o.Z)({visible:!0},e))},n.render=function(){var e=this.state,t=e.visible,n=e.type;return r.createElement(s.Dialog,{title:"\u5ba2\u670d\u6279\u91cf\u5206\u7c7b",className:"yt_conversation_setting_edit_config_wrapper",size:"tiny",visible:t,onCancel:this._handleOnCancel},r.createElement(s.Dialog.Body,null,r.createElement("div",{className:"item"},r.createElement("span",null,"\u5ba2\u670d\u7c7b\u578b"),r.createElement(s.Radio.Group,{value:n,onChange:this._handleOnTypeChange},r.createElement(s.Radio,{value:"PRE_SALE"},"\u552e\u524d"),r.createElement(s.Radio,{value:"AFTER_SALE"},"\u552e\u540e"),r.createElement(s.Radio,{value:"UNKNOWN"},"\u672a\u5206\u7c7b")))),r.createElement(s.Dialog.Footer,null,r.createElement(s.Button,{type:"default",onClick:this._handleOnCancel},"\u53d6\u6d88"),r.createElement(s.Button,{type:"primary",onClick:this._handleOnConfirm},"\u786e\u5b9a")))},t}(r.PureComponent);const O=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnTypeChange=function(e,t){var a=n.props.onTypeChange;a&&a(e,[t.id])},n._handleOnPageChange=function(e){var t=n.props.onChange;t&&t({pageIndex:e})},n._handleOnPageSizeChange=function(e){var t=n.props.onChange;t&&t({pageSize:e,pageIndex:1})},n._handleOnBashChangeClick=function(){var e=n.state.checkedWaiters,t=n.props.onTypeChange;n.dialogRef.show({callback:function(a){var r=a.type;t&&t(r,e),n.setState({checkedWaiters:[],isAllChecked:!1,indeterminate:!1})}})},n._handleOnSelectChange=function(e,t){var a=n.state.checkedWaiters,r=n.props.allData,l=(0,E.ZP)(a,(function(n){if(!e)return n.filter((function(e){return e!==t}));n.push(t)})),i=l.length===r.length,o=!i&&l.length>0;n.setState({checkedWaiters:l,isAllChecked:i,indeterminate:o})},n._handleOnSelectAll=function(e){var t=n.props.allData;n.setState({isAllChecked:e,indeterminate:!1,checkedWaiters:e?t.map((function(e){return e.id})):[]})},n._getDialogRef=function(e){return n.dialogRef=e},n.state={isAllChecked:!1,indeterminate:!1,checkedWaiters:[]},n.columns=[{label:"\u5ba2\u670d\u540d\u79f0",prop:"waiterName",width:200,fixed:"",checked:!0},{label:"\u5e73\u53f0",prop:"platform",width:120,fixed:"",checked:!0},{label:"\u5e97\u94fa\u540d\u79f0",prop:"shopName",width:200,fixed:"",checked:!0},{label:"\u5ba2\u670d\u7c7b\u578b",prop:"waiterType",width:80,fixed:"",checked:!0}],n.prefixColumns=[{fixed:"left",label:"",width:16},{width:50,fixed:"left",prop:"selection",label:""}],n}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.data,n=e.loading,a=e.className,l=e.total,i=e.pageIndex,o=e.pageSize,c=(e.visibleChange,this.state.checkedWaiters);return r.createElement(r.Fragment,null,r.createElement(s.Button,{className:"bashTypeChangeBtn",type:"primary",onClick:this._handleOnBashChangeClick,disabled:!c.length},"\u6279\u91cf\u5206\u7c7b"),r.createElement(g.Z,{savedKey:"conversation_setting",total:l,pageIndex:i,pageSize:o,className:a,prefixColumns:this.prefixColumns,data:t,loading:n,columns:this.columns,columnRenders:this.columnRenders,headerRenders:this.headerRenders,onPageChange:this._handleOnPageChange,onPageSizeChange:this._handleOnPageSizeChange}),r.createElement(b,{ref:this._getDialogRef}))},(0,f.Z)(t,[{key:"headerRenders",get:function(){var e=this,t=this.state,n=t.isAllChecked,a=t.indeterminate;return{selection:function(){return r.createElement("span",{className:(n?"checkbox_checked":a?"checkbox_indeterminate":"")+" icon_checkbox",onClick:function(){return e._handleOnSelectAll(!n)}})}}}},{key:"columnRenders",get:function(){var e=this,t=this.state.checkedWaiters;return{selection:function(n){var a=t.includes(n.id);return r.createElement("span",{className:(a?"checkbox_checked":"")+" icon_checkbox",onClick:function(){return e._handleOnSelectChange(!a,n.id)}})},waiterType:function(t){return r.createElement(y,{value:t.waiterType,options:k.uG,onChange:function(n){return e._handleOnTypeChange(n,t)}})}}}}]),t}(r.PureComponent);const S=function(e){var t=e.onFilterChange,n=e.type,a=e.platform,l=e.store,i=e.platformOpts,o=e.storeOpts,s=e.clusterDataList,u=e.fetchingDataList,p=e.total,h=e.dataList,d=e.pageIndex,f=e.pageSize,g=e.visibleChange,v=function(e){t({keyword:e})};return r.createElement("div",{className:"yt_convasation_setting_edit_wrapper"},r.createElement("div",{className:"title"},r.createElement(c.Z,{onSearch:v,onClear:v,placeholder:"\u8bf7\u8f93\u5165\u5ba2\u670d\u540d\u79f0",style:{width:260}}),r.createElement(m,{title:"\u5ba2\u670d\u7c7b\u578b",value:n,options:k.Lh,onChange:function(e){t({type:e})}}),r.createElement(m,{title:"\u5e73\u53f0",value:a,options:i,onChange:function(e){t({platform:e})}}),r.createElement(m,{title:"\u5e97\u94fa\u540d\u79f0",value:l,options:o,onChange:function(e){t({store:e})}})),r.createElement(O,{allData:h,total:p,className:"list_content",data:s,loading:u,pageIndex:d,pageSize:f,onChange:t,onTypeChange:function(e,n){t({waiterIds:n,type:e})},visibleChange:g}))};var N=n(35239),w=n(55609),x=n(64396),P=["loading"],T=x.Z.conversation.setting,I=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnFilterChange=function(e){e.waiterIds?n.props.updateWaiterType(e):void 0!==e.keyword||e.type||e.platform||e.store?n.props.fetchDataList(e):e.pageIndex&&n.props.updateClusterDataList(e)},n.state={},n.event={onFilterChange:n._handleOnFilterChange},n}(0,a.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.fetchParams({projectId:N.t.get(N.V.curProject).id})},n.render=function(){return r.createElement(S,(0,o.Z)({},this.props,this.state,this.event))},t}(r.PureComponent);const L={Edit:(0,w.connect)((function(e){var t=e.loading,n=(0,i.Z)(e,P);return(0,o.Z)({},n[T],{fetchingDataList:t.effects[T+"/fetchDataList"]||t.effects[T+"/updateWaiterType"]||!1})}),(function(e){return{fetchParams:function(t){return e({type:T+"/fetchParams",payload:t})},fetchDataList:function(t){return e({type:T+"/fetchDataList",payload:t})},updateWaiterType:function(t){return e({type:T+"/updateWaiterType",payload:t})},updateClusterDataList:function(t){return e({type:T+"/updateClusterDataList",payload:t})},visibleChange:function(t){return e({type:"pushRule/visibleChange",payload:t})}}}))(I)};var R=n(61193),Z=[{name:"\u5ba2\u670d\u5206\u7c7b\u8bbe\u7f6e",com:"Edit",authority:"SERVICE_CLASSIFICATION"}].filter((function(e){return R.Z.hasAuthority(e.authority)})),F=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnClick=function(e){n.state.curPage.com!==e.com&&n.setState({curPage:e})},n.state={curPage:Z[0]},n}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.state.curPage,n=this.props.unknownTotal,a=t?L[t.com]:void 0;return r.createElement("div",{className:"conversation_setting_wrapper"},r.createElement(l.Z,{title:[{title:"\u914d\u7f6e"},{title:null==t?void 0:t.name}]}),r.createElement("div",{className:"setting_wrap"},r.createElement("div",{className:"left"},Z instanceof Array&&Z.length>0&&Z.map((function(a){return r.createElement("div",{className:(t.com===a.com?"sel":"")+" item",key:a.com,onClick:function(){return e._handleOnClick(a)}},a.name,!!n&&r.createElement("span",{className:"pop"},n>99?"99+":n))}))),r.createElement("div",{className:"right"},a&&r.createElement(a,null))))},t}(r.PureComponent);const z=(0,w.connect)((function(e){return{unknownTotal:e.conversationSetting.unknownTotal}}))(F)},55815:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(94578),r=n(67294),l=n(45697),i=n.n(l),o=n(43036),c=n(61409),s=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props,a=n.title,r=n.beforeJump;e!==a.length-1&&(r?new Promise((function(e,t){return r(e,t)})).then((function(){c.mW.push({pathname:a[e].url,state:a[e].state})})):c.mW.push({pathname:a[e].url,state:a[e].state}))},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.mainTitle,l=t.rightContent,i=t.className,c=t.overlay;return r.createElement("div",{className:"breadcumb-wrapper "+i},n instanceof Array?r.createElement("div",{className:"breadcrumb-left"},r.createElement("div",null,n.map((function(t,a){return r.createElement("span",{className:t.url?"":"not_clickable",key:a,onClick:function(){return t.url&&a!==n.length-1&&e._handleBreadcrumbClick(a)}},t.title,a!==n.length-1&&" / ")}))),r.createElement("span",null,a||n[n.length-1].title,c&&r.createElement(o.Z,{placement:"top",overlay:c},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}})))):r.createElement("div",{className:"normal-title"},n,c&&r.createElement(o.Z,{placement:"top",overlay:c},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}}))),l||"")},t}(r.Component);s.propTypes={className:i().string,title:i().oneOfType([i().string,i().arrayOf(i().shape({title:i().string,url:i().string,state:i().object}))]).isRequired,overlay:i().oneOfType([i().string,i().node]),mainTitle:i().oneOfType([i().string,i().node]),beforeJump:i().func,rightContent:i().node};const u=s},61918:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(67294),r=n(45697),l=n.n(r),i=function(e){var t=e.className,n=e.onClear,r=e.onSearch,l=e.placeholder,i=e.style,o=e.defValue,c=e.signal,s=a.useState(o),u=s[0],p=s[1];a.useEffect((function(){p(o)}),[o,c]);return a.createElement("div",{style:i,className:"yt_search_input_wrapper "+(t||"")},a.createElement("input",{placeholder:l,value:u,onKeyDown:function(e){13===e.keyCode&&r(u)},onChange:function(e){return p(e.target.value)},autoComplete:"off"}),u&&a.createElement("i",{className:"icon-cem_log-off",onClick:function(){p(""),n&&n("")}}),a.createElement("i",{className:"icon-cem_small-search",onClick:function(){return r(u)}}))};i.propTypes={className:l().string,onSearch:l().func.isRequired,placeholder:l().string,style:l().object,defValue:l().string,signal:l().any,onClear:l().func};const o=i},2271:(e,t,n)=>{n.d(t,{Z:()=>Z});var a=n(63366),r=n(87462),l=n(43144),i=n(94578),o=n(23279),c=n.n(o),s=n(67294),u=n(92360),p=n(35303),h=n(45697),d=n.n(h),m=[{label:"10\u9879/\u9875",value:10},{label:"20\u9879/\u9875",value:20},{label:"40\u9879/\u9875",value:40},{label:"100\u9879/\u9875",value:100}];const f=function(e){var t=e.onPageChange,n=e.onSizeChange,a=e.total,r=void 0===a?0:a,l=e.pageIndex,i=e.pageSize,o=e.currLength,c=e.layout,h=e.className,d=0===r?0:(l-1)*i+1,f=0===r?0:d+o-1;return 0===r?null:s.createElement("div",{className:"yt-awp-pagination "+(h||"")},s.createElement("span",{className:"total_num"},s.createElement("span",null,d+" - "+f+" "),"\u9879\uff0c\u5171",s.createElement("span",null," "+r+" "),"\u9879"),s.createElement("div",{style:{textAlign:"right",float:"right"},className:"new_pagination"},s.createElement(u.Pagination,{small:!0,pageSize:i,currentPage:l,pageCount:Math.ceil(r/i),layout:0===r?"":"prev, pager, next",onCurrentChange:t}),void 0===c||c.includes("sizes")?s.createElement(p.RS,{multiple:!1,tags:!1,showSearch:!1,optionFilterProp:"label",optionLabelProp:"label",animation:"slide-up",dropdownClassName:"custom-pagination-dropdown",value:i||10,onChange:n},m.map((function(e,t){return s.createElement(p.Wx,{key:t,label:e.label,value:e.value},e.label)}))):null))};d().propTypes={onPageChange:d().func,onSizeChange:d().func,total:d().number,pageIndex:d().number,pageSize:d().number,currLength:d().number,layout:d().string,className:d().string};var g=n(8201),v=n(15861),C=n(87757),y=n.n(C),k=n(49722);function E(){return(E=(0,v.Z)(y().mark((function e(t){var n,a;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectId,a=t.key,e.abrupt("return",k.h.post("/default/value/find",{projectId:n,key:a}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(){return(_=(0,v.Z)(y().mark((function e(t){var n,a,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectId,a=t.value,r=t.key,e.abrupt("return",k.h.post("/default/value/update",{projectId:n,key:r,value:a}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var b=n(39432),O=n(43036),S=n(51474),N=n(87219),w=function(e){function t(t){var n;return(n=e.call(this,t)||this)._setShowFalse=function(){n.setState({show:!1})},n._handleParentClick=function(e){n.state.show&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},n._handleOnTriggerClick=function(){setTimeout((function(){n.setState({show:!n.state.show})}),0)},n._renderOptionItem=function(e,t,a,r,l,i){var o=n.state.maxLabelWidth,c=n.props,u=c.value,p=c.savedKey,h=u.find((function(t){return t.prop===e.prop}));return s.createElement("div",{className:"opt_item "+(t?"draggable":""),key:e.prop},t&&s.createElement("i",{className:"icon-cem_move my_handle"}),s.createElement("div",{className:"opt_content",style:{width:o,marginLeft:t?0:12}},s.createElement("div",{className:"item_label",onClick:function(t){t.stopPropagation(),n._handleOnItemClick(e.prop)}},s.createElement("span",{className:"icon_checkbox "+(h&&h.checked?"checkbox_checked":"")}),s.createElement("span",null,e.label)),s.createElement("div",{className:"item_control",style:{display:"product_setting_link"===p?"none":"block"}},s.createElement(O.Z,{placement:"top",overlay:a},s.createElement("span",{onClick:function(t){return r(t,e.prop)}},s.createElement("i",{className:(t?"icon-cem_up":"icon-cem_up-and-down")+" fun_icon_a"}))),s.createElement(O.Z,{placement:"top",overlay:l},s.createElement("span",{onClick:function(t){return i(t,e.prop)},style:{marginLeft:4}},s.createElement("i",{className:"icon-cem_down fun_icon_b"}))))))},n._handleOnItemClick=function(e){var t=n.props,a=t.value,r=t.onChange;r&&r((0,N.ZP)(a,(function(t){var n=t.find((function(t){return t.prop===e}));n&&(n.checked=!n.checked)})))},n._handleOnFilxedLeftClick=function(e,t){e.stopPropagation(),n._handleOnFixedChange(t,"left")},n._handleOnCancelFixedClick=function(e,t){e.stopPropagation(),n._handleOnFixedChange(t,"")},n._handleOnFixedRightClick=function(e,t){e.stopPropagation(),n._handleOnFixedChange(t,"right")},n._handleOnFixedChange=function(e,t){var a=n.props,r=a.value,l=a.onChange;l&&l((0,N.ZP)(r,(function(n){var a=n.find((function(t){return t.prop===e}));a&&(a.fixed=t)})))},n.state={show:!1,value:[],leftOpts:[],normalOpts:[],rightOpts:[],maxLabelWidth:t.value.reduce((function(e,t){return Math.max((0,b.jD)(t.label,14)+56+16+16,e)}),0)},n}(0,i.Z)(t,e),t.getDerivedStateFromProps=function(e,t){if(JSON.stringify(e.value)!==JSON.stringify(t.value)){var n=e.value.reduce((function(t,n){var a=1;return"left"===n.fixed&&(a=0),"right"===n.fixed&&(a=2),t[a].push(e.value.find((function(e){return e.prop===n.prop}))),t}),[[],[],[]]),a=n[0],r=n[1],l=n[2];return{value:e.value,leftOpts:a,normalOpts:r,rightOpts:l,maxLabelWidth:e.value.reduce((function(e,t){return Math.max((0,b.jD)(t.label,14)+56+16+16,e)}),0)}}return null};var n=t.prototype;return n.componentDidMount=function(){var e=this;window.addEventListener("click",this._setShowFalse);var t=document.querySelectorAll("#draggable_zone");t.length&&t.forEach((function(t){S.default.create(t,{group:"draggable_zone",animation:150,filter:".undraggable",draggable:".draggable",handle:".my_handle",onEnd:function(t){var n=e.props,a=n.value,r=n.onChange,l=t.newIndex,i=t.oldIndex;if(l!==i){var o=a.filter((function(e){return"left"===e.fixed})),c=a.filter((function(e){return"right"===e.fixed})),s=(0,N.ZP)(a.filter((function(e){return!e.fixed})),(function(e){var t=e.splice(i,1)[0];e.splice(l,0,t)}));r&&r([].concat(o,s,c))}}})}))},n.componentWillUnmount=function(){window.removeEventListener("click",this._setShowFalse)},n.render=function(){var e=this,t=this.state,n=t.show,a=t.leftOpts,r=t.normalOpts,l=t.rightOpts,i=this.props,o=i.className,c=i.title;return s.createElement("div",{className:"yt_columns_selector_wrapper "+(o||""),onClick:this._handleParentClick},s.createElement("div",{className:"trigger "+(n?"sel":""),onClick:this._handleOnTriggerClick},c||"\u5217",s.createElement("i",{className:"icon-cem_arrow-launches",style:{transform:n?"rotate(-180deg)":""}})),s.createElement("div",{className:"options "+(n?"active":"")},a.length>0&&s.createElement(s.Fragment,null,s.createElement("div",{className:"opt_label"},"\u56fa\u5b9a\u5728\u5de6\u4fa7"),a.map((function(t){return e._renderOptionItem(t,!1,"\u4e0d\u56fa\u5b9a",e._handleOnCancelFixedClick,"\u56fa\u5b9a\u5728\u5217\u5c3e",e._handleOnFixedRightClick)}))),(a.length>0||l.length>0)&&s.createElement("div",{className:"opt_label"},"\u4e0d\u56fa\u5b9a"),s.createElement("div",{id:"draggable_zone",style:{visibility:r.length>0}},r.map((function(t){return e._renderOptionItem(t,!0,"\u56fa\u5b9a\u5728\u5217\u5934",e._handleOnFilxedLeftClick,"\u56fa\u5b9a\u5728\u5217\u5c3e",e._handleOnFixedRightClick)}))),l.length>0&&s.createElement(s.Fragment,null,s.createElement("div",{className:"opt_label"},"\u56fa\u5b9a\u5728\u53f3\u4fa7"),l.map((function(t){return e._renderOptionItem(t,!1,"\u4e0d\u56fa\u5b9a",e._handleOnCancelFixedClick,"\u56fa\u5b9a\u5728\u5217\u5934",e._handleOnFilxedLeftClick)})))))},t}(s.PureComponent);const x=w;w.propTypes={className:d().string,title:d().string,value:d().arrayOf(d().shape({label:d().string,prop:d().string,fixed:d().string,checked:d().bool})),onChange:d().func};var P,T,I=n(35239),L=["data","total","loading","savedKey","pageIndex","pageSize","onPageChange","onPageSizeChange","className"],R=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnResize=function(){var e=document.querySelector(".yt-listview-wrapper");e&&n.setState({tableWidth:e.clientWidth-5})},n._handleOnColumnsChange=function(e){n.setState({columns:e},(function(){n.props.savedKey&&function(e){return _.apply(this,arguments)}({projectId:I.t.get(I.V.curProject).id,key:n.props.savedKey,value:JSON.stringify(e.map((function(e){return{prop:e.prop,checked:e.checked,fixed:e.fixed}})))}).then((function(e){e.data}))}))},n.handleRoKey=function(e){var t=n.props.rowKeyProp;return t&&e&&e[t]?e[t]:JSON.stringify(e)},n.state={talbeWidth:0,columns:t.columns||[],loadingSave:!0},n}(0,i.Z)(t,e),t.getDerivedStateFromProps=function(e,t){};var n=t.prototype;return n.componentDidMount=function(){var e=this;window.addEventListener("resize",c()(this._handleOnResize,150)),this._handleOnResize();var t=this.props,n=t.savedKey,a=t.columns;n&&function(e){return E.apply(this,arguments)}({projectId:I.t.get(I.V.curProject).id,key:n}).then((function(t){var n,l=t.data;if(2e4===l.code)try{n=a.map((function(e,t){var n=JSON.parse(l.result).filter((function(t){var n=t.prop;return e.prop===n}));return n&&n.length>0?(0,r.Z)({},e,n[0]):e})).filter((function(e){return e}))}catch(i){}finally{e.setState({columns:n||e.state.columns,loadingSave:!1})}}))},n.componentWillUnmount=function(){window.removeEventListener("resize",this._handleOnResize)},n.componentDidUpdate=function(e,t){var n=this;JSON.stringify(e.columns)!==JSON.stringify(this.props.columns)&&this.props.columns.length>0&&this.setState({columns:this.props.columns.reduce((function(e,t,a){var l=n.state.columns.findIndex((function(e){var n=e.prop;return t.prop===n}));return e.splice(l>-1?l:a,0,(0,r.Z)({},t,n.state.columns[l])),e}),[]).filter((function(e){return e}))})},n.render=function(){var e=this.props,t=e.data,n=e.total,l=void 0===n?0:n,i=e.loading,o=e.savedKey,c=e.pageIndex,p=e.pageSize,h=e.onPageChange,d=e.onPageSizeChange,m=e.className,v=void 0===m?"":m,C=(0,a.Z)(e,L),y=this.state,k=y.columns,E=y.loadingSave;return s.createElement(g.Z,{data:t,className:"yt-listview-wrapper "+v,loading:o&&E||i},(0,g.P)(t)&&s.createElement(s.Fragment,null,s.createElement(u.Table,(0,r.Z)({},C,{columns:o?this.columns:this.props.columns,data:t,rowKey:this.handleRoKey})),h&&s.createElement(f,{onPageChange:h,onSizeChange:d,total:l,currLength:t.length,pageIndex:c,pageSize:p}),o&&s.createElement(x,{className:"column_selector",value:k,savedKey:o,onChange:this._handleOnColumnsChange})))},(0,l.Z)(t,[{key:"columns",get:function(){var e=this.state,t=e.tableWidth,n=e.columns,a=this.props,r=a.columnRenders,l=void 0===r?{}:r,i=a.headerRenders,o=void 0===i?{}:i,c=a.prefixColumns,s=0,u=0,p=0,h=[].concat(void 0===c?[]:c,JSON.parse(JSON.stringify(n.filter((function(e){var t=e.checked;return void 0===t||t})))));if(h.forEach((function(e){p+=e.width,e.fixed?s+=e.width:u+=e.width;var t=l[e.prop];t&&(e.render=t);var n=o[e.prop];n&&(e.renderHeader=n)})),t>p){var d=t-s;h.forEach((function(e){void 0!==e.checked&&!e.checked||e.fixed||(e.width=e.width/u*d)}))}return h}}]),t}(s.PureComponent);R.propTypes={className:d().string,savedKey:d().string.isRequired,rowKeyProp:d().string,data:d().any.isRequired,total:d().number,fixedHeight:d().bool,loading:d().bool,pageIndex:d().number,pageSize:d().number,onPageChange:d().func,onPageSizeChange:d().func,columnRenders:d().shape((P={},P[d().string]=d().func,P)),headerRenders:d().shape((T={},T[d().string]=d().func,T)),prefixColumns:d().arrayOf(d().shape({label:d().string,prop:d().string,fixed:d().oneOf(["","left","right"]),width:d().number,checked:d().bool})),columns:d().arrayOf(d().shape({label:d().string,prop:d().string,fixed:d().oneOf(["","left","right"]),width:d().number,checked:d().bool})).isRequired};const Z=R}}]);