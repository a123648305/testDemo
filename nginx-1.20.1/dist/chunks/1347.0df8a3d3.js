"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[1347],{81347:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I});var a=n(63366),r=n(87462),l=n(94578),i=n(67294),o=n(64396),c=n(55815),s=n(61918),u=n(53754),d=n(35239),p=n(92360),m=n(23570),h=n(35303),f=n(61409),g=12;const v=function(e){var t=e.name,n=e.typeName,a=e.typeNameList,r=e.treeType,l=e.treeTypeList,o=e.setParams,c=e.id,s=e.onEditTree,u=i.useState(r||l[0].id),d=u[0],p=u[1],v=i.useState(n?a.find((function(e){return e.name===n})).id:a.some((function(e){return 0===e.status}))?a.find((function(e){return 0===e.status})).id:void 0),y=v[0],E=v[1],_=i.useState(t||""),C=_[0],b=_[1],k=i.useState(!0),N=k[0],w=k[1],x=i.useState(""),O=x[0],S=x[1],P=i.useState(""),T=P[0],L=P[1],Z=function(e){if(C===t&&d===r&&y===a.find((function(e){return e.name===n})).id)return e({result:"faild"}),!1;if(!C)return S("\u8f93\u5165\u6846\u4e0d\u80fd\u4e3a\u7a7a"),w(!1),!1;if(!y)return L("\u9009\u62e9\u6846\u4e0d\u80fd\u4e3a\u7a7a"),!1;var l={id:c,name:C.substring(0,g)};return c?(s(l),e({result:"success"})):(f.mW.push({pathname:"/account/project/aspectSystem/tree/edit",state:{name:C,level:d,module:y,moduleName:a.find((function(e){return e.id===y})).name}}),e({result:"success"})),!1};i.useEffect((function(){o({tree:d,type:y,folderName:C,confirmRun:Z}),!N&&C&&C.length<=g&&w(!0)}),[C,d,y]);var z=function(e,t){"type"===e?E(t):"tree"===e&&p(t)};return i.createElement("div",{className:"yt_tree_modal_folder_wrapper"},i.createElement("div",{className:"content_item"},i.createElement("span",{className:"required"},"\u6307\u6807\u6811\u540d\u79f0"),i.createElement("span",{className:N?"":"required_error",style:{position:"relative"}},i.createElement(m.Z,{className:"content_item_input",defaultValue:C,placeholder:"\u8bf7\u8f93\u5165\u6307\u6807\u6811\u540d\u79f0",onChange:function(e){var t=e.target.value;""===t.trim()?(S("\u8f93\u5165\u6846\u4e0d\u80fd\u4e3a\u7a7a"),w(!1)):g<=t.length?(S("\u6700\u591a\u53ea\u80fd\u8f93\u516512\u4e2a\u5b57\u7b26"),w(!1)):(S(""),w(!0)),b(t)},onBlur:function(e){var t=e.target.value;""===t.trim()?(S("\u8f93\u5165\u6846\u4e0d\u80fd\u4e3a\u7a7a"),w(!1)):t.length===g&&(S(""),w(!0))},maxLength:g}),i.createElement("span",{className:"tip_text"},O))),i.createElement("div",{className:"content_item"},i.createElement("span",{className:"type_name"},"\u529f\u80fd\u6a21\u5757"),i.createElement("span",{className:"type_select"},i.createElement(h.RS,{disabled:c,className:T?"error":"",tags:!1,onChange:function(e){T&&L(""),z("type",e)},value:y,optionLabelProp:"label",optionFilterProp:"label",placeholder:"\u8bf7\u9009\u62e9"},a.map((function(e,t){return i.createElement(h.Wx,{key:t,value:e.id,label:e.name,disabled:1===e.status},e.name)}))),i.createElement("span",{className:"tip_text"},T))),i.createElement("div",{className:"content_item"},i.createElement("span",{className:"tree_name"},"\u6811\u5c42\u7ea7"),i.createElement("span",null,i.createElement(h.RS,{disabled:c,tags:!1,onChange:function(e){return z("tree",e)},value:d,optionLabelProp:"label",optionFilterProp:"label"},l.map((function(e,t){return i.createElement(h.Wx,{key:t,value:e.id,label:e.name},e.name)}))))))};var y=n(5133),E=n(49722);const _=function(e){var t=e.deleteText,n=e.module,a=e.id,r=e.projectId,l=e.setParams,o=e.fetchTreeList,c=e.keyword,s=function(e){E.h.post("/overall/aspect/tree/delete",{id:a,projectId:r}).then((function(t){2e4===t.data.code&&(e({result:"success"}),y.Z.success("\u5220\u9664\u6210\u529f"),o({keyword:c}))})).catch((function(t){420017===t.data.code&&b.delete({titleText:"\u63d0\u793a",content:"\u8be5\u6307\u6807\u6811\u662f\u300c"+n+"\u300d\u6a21\u5757\u7684\u6700\u540e\u4e00\u9897\u6307\u6807\u6811\uff0c\u4e0d\u652f\u6301\u5220\u9664",onOk:function(){},okText:"\u77e5\u9053\u4e86",className:"yt_aspect_tree_model_wrapper"}),e({result:"failed"})}))};return i.useEffect((function(){l({confirmRun:s})}),[]),i.createElement("div",{className:"aspect_tree_delete_text",style:{fontSize:14}},t)};var C=n(57522);const b={folder:function(e){var t=(0,r.Z)({},e,{titleText:(e.id?"\u91cd\u547d\u540d":"\u65b0\u5efa")+"\u6307\u6807\u6811",titleHelp:i.createElement("a",{style:{color:"#0847a6"},href:"https://www.yuque.com/docs/share/81b0f257-2352-4fa8-abc7-d63ca9167f0e?# \u300a\u300c\u6307\u6807\u6811\u300d\u529f\u80fd\u8bf4\u660e\u300b",target:"_blank",rel:"noopener noreferrer"},"\u4e86\u89e3\u66f4\u591a"),content:i.createElement(v,e)});return t.onOk?(0,C.Z)(t):new Promise((function(e,n){t.onOk=e,t.onCancel=n,(0,C.Z)(t)}))},delete:function(e){var t=(0,r.Z)({},e,{dialogType:"danger",titleText:e.titleText,showClose:!1,content:e.content||i.createElement(_,e)});return t.onCancel?new Promise((function(e,n){t.onOk=e,t.onCancel=n,(0,C.Z)(t)})):(0,C.Z)(t)}};var k=n(43144),N=n(43036),w=n(2271),x=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnControlClick=function(e,t){var a=n.props,r=a.typeNameList,l=a.treeTypeList,i=a.onEditTree,o=a.fetchTreeList,c=a.keyword;"edit"===e?f.mW.push({pathname:"/account/project/aspectSystem/tree/edit",state:{id:t.id,name:t.name}}):"delete"===e?b.delete({id:t.id,module:t.module,fetchTreeList:o,keyword:c,projectId:d.t.get(d.V.curProject).id,titleText:"\u786e\u5b9a\u8981\u5220\u9664\u300c"+t.name+"\u7684"+t.module+"\u300d\u6307\u6807\u6811\uff1f",onCancel:function(){},deleteText:"\u5982\u679c\u6709\u7528\u6237\u5728\u524d\u53f0\u4f7f\u7528\u8be5\u6307\u6807\u6811\uff0c\u4f1a\u5f71\u54cd\u5176\u4f7f\u7528\uff0c\u8bf7\u614e\u91cd\u64cd\u4f5c",onOk:function(e){e.result},okText:"\u786e\u5b9a",className:"yt_aspect_tree_model_wrapper"}):"rename"===e&&b.folder({name:t.name,id:t.id,onEditTree:i,typeNameList:r,treeType:t.level,typeName:t.module,treeTypeList:l})},n.state={},n.columns=[{label:"\u6307\u6807\u6811\u540d\u79f0",prop:"name",width:150,fixed:"",checked:!0},{label:"\u529f\u80fd\u6a21\u5757",prop:"module",width:100,fixed:"",checked:!0},{label:"\u6811\u5c42\u7ea7",prop:"level",width:100,fixed:"",checked:!0},{label:"\u64cd\u4f5c",prop:"control",width:150,fixed:"right",checked:!0}],n.prefixColumns=[{label:"",width:16,fixed:"left"}],n.headerRenders={level:function(e){return i.createElement(i.Fragment,null,"\u6811\u5c42\u7ea7",i.createElement(N.Z,{placement:"top",overlay:i.createElement("div",{style:{maxWidth:216}},"\u300c\u6811\u5c42\u7ea7\u300d\u5305\u542b\u4f5c\u4e3a\u672b\u7ea7\u7684\u300c\u5168\u5c40\u6307\u6807\u300d\uff0c\u4f46\u4e0d\u5305\u542b\u4f5c\u4e3a\u6a21\u5757\u7684\u6839\u8282\u70b9",i.createElement("div",{style:{marginTop:14,textAlign:"right"}},i.createElement(f.rU,{className:"yt-feedback-read-more",to:"https://www.yuque.com/docs/share/81b0f257-2352-4fa8-abc7-d63ca9167f0e?# \u300a\u300c\u6307\u6807\u6811\u300d\u529f\u80fd\u8bf4\u660e\u300b",target:"_blank"},"\u4e86\u89e3\u66f4\u591a")))},i.createElement("span",{style:{marginLeft:4}},i.createElement("i",{className:"icon-cem_file1"}))))}},n}return(0,l.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.data,n=(e.option.width,e.onPageChange),a=e.onPageSizeChange;return i.createElement(i.Fragment,null,i.createElement(w.Z,(0,r.Z)({},this.props,{data:t&&t.list instanceof Array?t.list:[],rowKeyProp:"id",prefixColumns:this.prefixColumns,columns:this.columns,headerReanders:this.headerRenders,columnRenders:this.columnRenders,total:t?t.total:0,onPageChange:n,onPageSizeChange:a,savedKey:"PROJECT_ASPECTSYSTEM_TREE"})))},(0,k.Z)(t,[{key:"columnRenders",get:function(){var e=this;return{control:function(t,n,a){return i.createElement(i.Fragment,null,i.createElement("span",{style:{marginRight:12},className:"col-control",onClick:function(){return e._handleOnControlClick("edit",t)}},"\u7f16\u8f91"),i.createElement("span",{style:{marginRight:12},className:"col-control",onClick:function(){return e._handleOnControlClick("rename",t)}},"\u91cd\u547d\u540d"),i.createElement("span",{className:"col-control",onClick:function(){return e._handleOnControlClick("delete",t)}},"\u5220\u9664"))}}}}]),t}(i.PureComponent);const O=x;var S=[1,2,3,4,5,6].map((function(e){return{id:e,name:e}}));const P=function(e){var t=e.name,n=e.loading,a=e.pageIndex,r=e.pageSize,l=e.moduleList,o=e.typeNameList,m=e.data,h=e.onEditTree,f=e.onPageChange,g=e.onPageSizeChange,v=e.contentWidth,y=e.onFilterChange,E=e.fetchTreeList;return i.createElement("div",{className:"yt_productExperience_aspectSystem_tree_list_wrapper"},i.createElement(c.Z,{title:[{title:d.t.get(d.V.backProjectConfig).name,url:"/account/project/preview"},{title:"\u6307\u6807\u6811",url:""}]}),i.createElement("div",{id:"content"},i.createElement("div",{className:"tree_list"},i.createElement("div",{className:"top"},i.createElement(s.Z,{placeholder:"\u641c\u7d22\u6307\u6807\u540d\u79f0",defValue:t,onSearch:function(e){return y({name:e})},onClear:function(e){return y({name:e})},style:{width:168}}),i.createElement(u.Z,{title:"\u529f\u80fd\u6a21\u5757",options:o,value:l,onChange:function(e){return y({moduleList:e})}}),i.createElement(p.Button,{type:"primary",onClick:function(){return b.folder({onEditTree:h,typeNameList:o,treeTypeList:S})}},"\u65b0\u5efa\u6307\u6807\u6811")),i.createElement(O,{keyword:t,fetchTreeList:E,onEditTree:h,typeNameList:o,treeTypeList:S,data:m,loading:n,pageIndex:a,pageSize:r,option:{width:v},onPageChange:f,onPageSizeChange:g}))))};var T=n(55609),L=["loading"],Z=o.Z.productExperience.aspectSystem.tree,z=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnEditTree=function(e){n.props.editTree(e)},n._handleOnFilterChange=function(e){var t=n.props,a=t.name,r=t.moduleList;e.moduleList?n.props.fetchTreeList({moduleList:e.moduleList,name:a}):void 0!==e.name&&n.props.fetchTreeList({name:e.name,moduleList:r})},n._handleOnPageChange=function(e){var t=n.props,a=t.name;(0,t.fetchTreeList)({pageIndex:e,name:a})},n._handleOnPageSizeChange=function(e){var t=n.props,a=t.name;(0,t.fetchTreeList)({pageSize:e,pageIndex:1,name:a})},n.state={contentWidth:0,projectId:d.t.get(d.V.backProjectConfig).id},n.event={onFilterChange:n._handleOnFilterChange,onEditTree:n._handleOnEditTree,onPageChange:n._handleOnPageChange,onPageSizeChange:n._handleOnPageSizeChange},n}(0,l.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.state.projectId;this.props.fetchTreeList({projectId:e}),this.props.fetchModuleNameList({projectId:e})},n.componentWillUnmount=function(){this.props.clean()},n.render=function(){return i.createElement(P,(0,r.Z)({},this.props,this.state,this.event))},t}(i.Component);const I=(0,T.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,L);return(0,r.Z)({},n[Z],{loading:t.effects[name+"/fetchTreeList"]||!1})}),(function(e){return{save:function(t){return e({type:Z+"/save",payload:t})},clean:function(t){return e({type:Z+"/clean",payload:t})},fetchTreeList:function(t){return e({type:Z+"/fetchTreeList",payload:t})},fetchModuleNameList:function(t){return e({type:Z+"/fetchModuleNameList",payload:t})},editTree:function(t){return e({type:Z+"/editTree",payload:t})}}}))(z)},55815:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(94578),r=n(67294),l=n(45697),i=n.n(l),o=n(43036),c=n(61409),s=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props,a=n.title,r=n.beforeJump;e!==a.length-1&&(r?new Promise((function(e,t){return r(e,t)})).then((function(){c.mW.push({pathname:a[e].url,state:a[e].state})})):c.mW.push({pathname:a[e].url,state:a[e].state}))},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.mainTitle,l=t.rightContent,i=t.className,c=t.overlay;return r.createElement("div",{className:"breadcumb-wrapper "+i},n instanceof Array?r.createElement("div",{className:"breadcrumb-left"},r.createElement("div",null,n.map((function(t,a){return r.createElement("span",{className:t.url?"":"not_clickable",key:a,onClick:function(){return t.url&&a!==n.length-1&&e._handleBreadcrumbClick(a)}},t.title,a!==n.length-1&&" / ")}))),r.createElement("span",null,a||n[n.length-1].title,c&&r.createElement(o.Z,{placement:"top",overlay:c},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}})))):r.createElement("div",{className:"normal-title"},n,c&&r.createElement(o.Z,{placement:"top",overlay:c},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}}))),l||"")},t}(r.Component);s.propTypes={className:i().string,title:i().oneOfType([i().string,i().arrayOf(i().shape({title:i().string,url:i().string,state:i().object}))]).isRequired,overlay:i().oneOfType([i().string,i().node]),mainTitle:i().oneOfType([i().string,i().node]),beforeJump:i().func,rightContent:i().node};const u=s},61918:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(67294),r=n(45697),l=n.n(r),i=function(e){var t=e.className,n=e.onClear,r=e.onSearch,l=e.placeholder,i=e.style,o=e.defValue,c=e.signal,s=a.useState(o),u=s[0],d=s[1];a.useEffect((function(){d(o)}),[o,c]);return a.createElement("div",{style:i,className:"yt_search_input_wrapper "+(t||"")},a.createElement("input",{placeholder:l,value:u,onKeyDown:function(e){13===e.keyCode&&r(u)},onChange:function(e){return d(e.target.value)},autoComplete:"off"}),u&&a.createElement("i",{className:"icon-cem_log-off",onClick:function(){d(""),n&&n("")}}),a.createElement("i",{className:"icon-cem_small-search",onClick:function(){return r(u)}}))};i.propTypes={className:l().string,onSearch:l().func.isRequired,placeholder:l().string,style:l().object,defValue:l().string,signal:l().any,onClear:l().func};const o=i},2271:(e,t,n)=>{n.d(t,{Z:()=>I});var a=n(63366),r=n(87462),l=n(43144),i=n(94578),o=n(23279),c=n.n(o),s=n(67294),u=n(92360),d=n(35303),p=n(45697),m=n.n(p),h=[{label:"10\u9879/\u9875",value:10},{label:"20\u9879/\u9875",value:20},{label:"40\u9879/\u9875",value:40},{label:"100\u9879/\u9875",value:100}];const f=function(e){var t=e.onPageChange,n=e.onSizeChange,a=e.total,r=void 0===a?0:a,l=e.pageIndex,i=e.pageSize,o=e.currLength,c=e.layout,p=e.className,m=0===r?0:(l-1)*i+1,f=0===r?0:m+o-1;return 0===r?null:s.createElement("div",{className:"yt-awp-pagination "+(p||"")},s.createElement("span",{className:"total_num"},s.createElement("span",null,m+" - "+f+" "),"\u9879\uff0c\u5171",s.createElement("span",null," "+r+" "),"\u9879"),s.createElement("div",{style:{textAlign:"right",float:"right"},className:"new_pagination"},s.createElement(u.Pagination,{small:!0,pageSize:i,currentPage:l,pageCount:Math.ceil(r/i),layout:0===r?"":"prev, pager, next",onCurrentChange:t}),void 0===c||c.includes("sizes")?s.createElement(d.RS,{multiple:!1,tags:!1,showSearch:!1,optionFilterProp:"label",optionLabelProp:"label",animation:"slide-up",dropdownClassName:"custom-pagination-dropdown",value:i||10,onChange:n},h.map((function(e,t){return s.createElement(d.Wx,{key:t,label:e.label,value:e.value},e.label)}))):null))};m().propTypes={onPageChange:m().func,onSizeChange:m().func,total:m().number,pageIndex:m().number,pageSize:m().number,currLength:m().number,layout:m().string,className:m().string};var g=n(8201),v=n(15861),y=n(87757),E=n.n(y),_=n(49722);function C(){return(C=(0,v.Z)(E().mark((function e(t){var n,a;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectId,a=t.key,e.abrupt("return",_.h.post("/default/value/find",{projectId:n,key:a}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return(b=(0,v.Z)(E().mark((function e(t){var n,a,r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectId,a=t.value,r=t.key,e.abrupt("return",_.h.post("/default/value/update",{projectId:n,key:r,value:a}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var k=n(39432),N=n(43036),w=n(51474),x=n(87219),O=function(e){function t(t){var n;return(n=e.call(this,t)||this)._setShowFalse=function(){n.setState({show:!1})},n._handleParentClick=function(e){n.state.show&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},n._handleOnTriggerClick=function(){setTimeout((function(){n.setState({show:!n.state.show})}),0)},n._renderOptionItem=function(e,t,a,r,l,i){var o=n.state.maxLabelWidth,c=n.props,u=c.value,d=c.savedKey,p=u.find((function(t){return t.prop===e.prop}));return s.createElement("div",{className:"opt_item "+(t?"draggable":""),key:e.prop},t&&s.createElement("i",{className:"icon-cem_move my_handle"}),s.createElement("div",{className:"opt_content",style:{width:o,marginLeft:t?0:12}},s.createElement("div",{className:"item_label",onClick:function(t){t.stopPropagation(),n._handleOnItemClick(e.prop)}},s.createElement("span",{className:"icon_checkbox "+(p&&p.checked?"checkbox_checked":"")}),s.createElement("span",null,e.label)),s.createElement("div",{className:"item_control",style:{display:"product_setting_link"===d?"none":"block"}},s.createElement(N.Z,{placement:"top",overlay:a},s.createElement("span",{onClick:function(t){return r(t,e.prop)}},s.createElement("i",{className:(t?"icon-cem_up":"icon-cem_up-and-down")+" fun_icon_a"}))),s.createElement(N.Z,{placement:"top",overlay:l},s.createElement("span",{onClick:function(t){return i(t,e.prop)},style:{marginLeft:4}},s.createElement("i",{className:"icon-cem_down fun_icon_b"}))))))},n._handleOnItemClick=function(e){var t=n.props,a=t.value,r=t.onChange;r&&r((0,x.ZP)(a,(function(t){var n=t.find((function(t){return t.prop===e}));n&&(n.checked=!n.checked)})))},n._handleOnFilxedLeftClick=function(e,t){e.stopPropagation(),n._handleOnFixedChange(t,"left")},n._handleOnCancelFixedClick=function(e,t){e.stopPropagation(),n._handleOnFixedChange(t,"")},n._handleOnFixedRightClick=function(e,t){e.stopPropagation(),n._handleOnFixedChange(t,"right")},n._handleOnFixedChange=function(e,t){var a=n.props,r=a.value,l=a.onChange;l&&l((0,x.ZP)(r,(function(n){var a=n.find((function(t){return t.prop===e}));a&&(a.fixed=t)})))},n.state={show:!1,value:[],leftOpts:[],normalOpts:[],rightOpts:[],maxLabelWidth:t.value.reduce((function(e,t){return Math.max((0,k.jD)(t.label,14)+56+16+16,e)}),0)},n}(0,i.Z)(t,e),t.getDerivedStateFromProps=function(e,t){if(JSON.stringify(e.value)!==JSON.stringify(t.value)){var n=e.value.reduce((function(t,n){var a=1;return"left"===n.fixed&&(a=0),"right"===n.fixed&&(a=2),t[a].push(e.value.find((function(e){return e.prop===n.prop}))),t}),[[],[],[]]),a=n[0],r=n[1],l=n[2];return{value:e.value,leftOpts:a,normalOpts:r,rightOpts:l,maxLabelWidth:e.value.reduce((function(e,t){return Math.max((0,k.jD)(t.label,14)+56+16+16,e)}),0)}}return null};var n=t.prototype;return n.componentDidMount=function(){var e=this;window.addEventListener("click",this._setShowFalse);var t=document.querySelectorAll("#draggable_zone");t.length&&t.forEach((function(t){w.default.create(t,{group:"draggable_zone",animation:150,filter:".undraggable",draggable:".draggable",handle:".my_handle",onEnd:function(t){var n=e.props,a=n.value,r=n.onChange,l=t.newIndex,i=t.oldIndex;if(l!==i){var o=a.filter((function(e){return"left"===e.fixed})),c=a.filter((function(e){return"right"===e.fixed})),s=(0,x.ZP)(a.filter((function(e){return!e.fixed})),(function(e){var t=e.splice(i,1)[0];e.splice(l,0,t)}));r&&r([].concat(o,s,c))}}})}))},n.componentWillUnmount=function(){window.removeEventListener("click",this._setShowFalse)},n.render=function(){var e=this,t=this.state,n=t.show,a=t.leftOpts,r=t.normalOpts,l=t.rightOpts,i=this.props,o=i.className,c=i.title;return s.createElement("div",{className:"yt_columns_selector_wrapper "+(o||""),onClick:this._handleParentClick},s.createElement("div",{className:"trigger "+(n?"sel":""),onClick:this._handleOnTriggerClick},c||"\u5217",s.createElement("i",{className:"icon-cem_arrow-launches",style:{transform:n?"rotate(-180deg)":""}})),s.createElement("div",{className:"options "+(n?"active":"")},a.length>0&&s.createElement(s.Fragment,null,s.createElement("div",{className:"opt_label"},"\u56fa\u5b9a\u5728\u5de6\u4fa7"),a.map((function(t){return e._renderOptionItem(t,!1,"\u4e0d\u56fa\u5b9a",e._handleOnCancelFixedClick,"\u56fa\u5b9a\u5728\u5217\u5c3e",e._handleOnFixedRightClick)}))),(a.length>0||l.length>0)&&s.createElement("div",{className:"opt_label"},"\u4e0d\u56fa\u5b9a"),s.createElement("div",{id:"draggable_zone",style:{visibility:r.length>0}},r.map((function(t){return e._renderOptionItem(t,!0,"\u56fa\u5b9a\u5728\u5217\u5934",e._handleOnFilxedLeftClick,"\u56fa\u5b9a\u5728\u5217\u5c3e",e._handleOnFixedRightClick)}))),l.length>0&&s.createElement(s.Fragment,null,s.createElement("div",{className:"opt_label"},"\u56fa\u5b9a\u5728\u53f3\u4fa7"),l.map((function(t){return e._renderOptionItem(t,!1,"\u4e0d\u56fa\u5b9a",e._handleOnCancelFixedClick,"\u56fa\u5b9a\u5728\u5217\u5934",e._handleOnFilxedLeftClick)})))))},t}(s.PureComponent);const S=O;O.propTypes={className:m().string,title:m().string,value:m().arrayOf(m().shape({label:m().string,prop:m().string,fixed:m().string,checked:m().bool})),onChange:m().func};var P,T,L=n(35239),Z=["data","total","loading","savedKey","pageIndex","pageSize","onPageChange","onPageSizeChange","className"],z=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnResize=function(){var e=document.querySelector(".yt-listview-wrapper");e&&n.setState({tableWidth:e.clientWidth-5})},n._handleOnColumnsChange=function(e){n.setState({columns:e},(function(){n.props.savedKey&&function(e){return b.apply(this,arguments)}({projectId:L.t.get(L.V.curProject).id,key:n.props.savedKey,value:JSON.stringify(e.map((function(e){return{prop:e.prop,checked:e.checked,fixed:e.fixed}})))}).then((function(e){e.data}))}))},n.handleRoKey=function(e){var t=n.props.rowKeyProp;return t&&e&&e[t]?e[t]:JSON.stringify(e)},n.state={talbeWidth:0,columns:t.columns||[],loadingSave:!0},n}(0,i.Z)(t,e),t.getDerivedStateFromProps=function(e,t){};var n=t.prototype;return n.componentDidMount=function(){var e=this;window.addEventListener("resize",c()(this._handleOnResize,150)),this._handleOnResize();var t=this.props,n=t.savedKey,a=t.columns;n&&function(e){return C.apply(this,arguments)}({projectId:L.t.get(L.V.curProject).id,key:n}).then((function(t){var n,l=t.data;if(2e4===l.code)try{n=a.map((function(e,t){var n=JSON.parse(l.result).filter((function(t){var n=t.prop;return e.prop===n}));return n&&n.length>0?(0,r.Z)({},e,n[0]):e})).filter((function(e){return e}))}catch(i){}finally{e.setState({columns:n||e.state.columns,loadingSave:!1})}}))},n.componentWillUnmount=function(){window.removeEventListener("resize",this._handleOnResize)},n.componentDidUpdate=function(e,t){var n=this;JSON.stringify(e.columns)!==JSON.stringify(this.props.columns)&&this.props.columns.length>0&&this.setState({columns:this.props.columns.reduce((function(e,t,a){var l=n.state.columns.findIndex((function(e){var n=e.prop;return t.prop===n}));return e.splice(l>-1?l:a,0,(0,r.Z)({},t,n.state.columns[l])),e}),[]).filter((function(e){return e}))})},n.render=function(){var e=this.props,t=e.data,n=e.total,l=void 0===n?0:n,i=e.loading,o=e.savedKey,c=e.pageIndex,d=e.pageSize,p=e.onPageChange,m=e.onPageSizeChange,h=e.className,v=void 0===h?"":h,y=(0,a.Z)(e,Z),E=this.state,_=E.columns,C=E.loadingSave;return s.createElement(g.Z,{data:t,className:"yt-listview-wrapper "+v,loading:o&&C||i},(0,g.P)(t)&&s.createElement(s.Fragment,null,s.createElement(u.Table,(0,r.Z)({},y,{columns:o?this.columns:this.props.columns,data:t,rowKey:this.handleRoKey})),p&&s.createElement(f,{onPageChange:p,onSizeChange:m,total:l,currLength:t.length,pageIndex:c,pageSize:d}),o&&s.createElement(S,{className:"column_selector",value:_,savedKey:o,onChange:this._handleOnColumnsChange})))},(0,l.Z)(t,[{key:"columns",get:function(){var e=this.state,t=e.tableWidth,n=e.columns,a=this.props,r=a.columnRenders,l=void 0===r?{}:r,i=a.headerRenders,o=void 0===i?{}:i,c=a.prefixColumns,s=0,u=0,d=0,p=[].concat(void 0===c?[]:c,JSON.parse(JSON.stringify(n.filter((function(e){var t=e.checked;return void 0===t||t})))));if(p.forEach((function(e){d+=e.width,e.fixed?s+=e.width:u+=e.width;var t=l[e.prop];t&&(e.render=t);var n=o[e.prop];n&&(e.renderHeader=n)})),t>d){var m=t-s;p.forEach((function(e){void 0!==e.checked&&!e.checked||e.fixed||(e.width=e.width/u*m)}))}return p}}]),t}(s.PureComponent);z.propTypes={className:m().string,savedKey:m().string.isRequired,rowKeyProp:m().string,data:m().any.isRequired,total:m().number,fixedHeight:m().bool,loading:m().bool,pageIndex:m().number,pageSize:m().number,onPageChange:m().func,onPageSizeChange:m().func,columnRenders:m().shape((P={},P[m().string]=m().func,P)),headerRenders:m().shape((T={},T[m().string]=m().func,T)),prefixColumns:m().arrayOf(m().shape({label:m().string,prop:m().string,fixed:m().oneOf(["","left","right"]),width:m().number,checked:m().bool})),columns:m().arrayOf(m().shape({label:m().string,prop:m().string,fixed:m().oneOf(["","left","right"]),width:m().number,checked:m().bool})).isRequired};const I=z}}]);