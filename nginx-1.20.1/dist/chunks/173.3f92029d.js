"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[173],{60173:(e,t,n)=>{n.r(t),n.d(t,{default:()=>L});var a=n(43144),l=n(97326),r=n(94578),i=n(87462),o=n(63366),s=n(67294),c=n(92360),d=n(5133),u=n(29383),m=n(12518),h=n(72305),p=n(35303),f=n(43036),g=n(51474),v=n(49722),E=n(61409),C=n(35239),b=n(55609),y=n(64396),k=["loading"],S=y.Z.public.menu,N=function(e){function t(){var t;return(t=e.call(this)||this).handleSort=function(e,n){var a=t.state.idList,l=a[e],r=JSON.parse(JSON.stringify(a));r.splice(e,1),r.splice(n>=1?n:0,0,l),v.h.post("/folder/sort",{idList:r}).then((function(e){2e4===e.data.code&&(t.setState({idList:r}),t.props.fetchMenuList())}))},t.initSortable=function(){var e=(0,l.Z)(t),n=e.state.idList,a=document.querySelector(".el-table table tbody");t.sortable=g.default.create(a,{sort:!0,animation:150,draggable:".sortable-row",filter:".unsortable-row",onEnd:function(t){var n=t.oldIndex,a=t.newIndex;e.handleSort(n,a)},onMove:function(e){return g.default.utils.index(e.related,".sortable-row")!==n.length-1}})},t.manualSort=function(){var e=t.state.idList;t.sortable.sort(e)},t.handleProjectChange=function(e){t.setState({projectId:e})},t.switchRemindType=function(e,n){var a=t.state.targetFolder;t.setState({dialogVisible:!0,dialogType:"toggle",targetFolder:(0,i.Z)({},a,{id:e,remindType:n?"NONE":"EMAIL"})})},t.handleNameChange=function(e){var n=t.state.targetFolder;t.setState({targetFolder:(0,i.Z)({},n,{name:e})})},t.handleAddFolder=function(){var e=t.state,n=e.targetFolder.name,a=e.projectId;0!==a.trim().length?0!==n.trim().length?v.h.post("/folder/add",{name:n,projectId:a}).then((function(e){2e4===e.data.code&&(d.Z.success("\u6dfb\u52a0\u6210\u529f"),t.getFolderList(!0,!0),t.setState({step:2}))})):d.Z.warning("\u8bf7\u8f93\u5165\u6587\u4ef6\u5939\u540d\u79f0"):d.Z.warning("\u8bf7\u9009\u62e9\u9879\u76ee")},t.handleRenameFolder=function(){var e=t.state.targetFolder,n=e.id,a=e.name;0!==a.trim().length?v.h.post("/folder/update",{id:n,name:a}).then((function(e){2e4===e.data.code&&(d.Z.success("\u66f4\u65b0\u6210\u529f"),t.getFolderList(!0,!0),t.handleCancel())})):d.Z.warning("\u8bf7\u8f93\u5165\u6587\u4ef6\u5939\u540d\u79f0")},t.handleDeleteFolder=function(){var e=t.state.targetFolder.id;v.h.post("/folder/delete",{id:e}).then((function(e){2e4===e.data.code&&(d.Z.success("\u5220\u9664\u6210\u529f"),t.getFolderList(!0,!0),t.handleCancel())}))},t.handleUpdateFolder=function(){var e=t.state.targetFolder,n=e.id,a=e.remindType;v.h.post("/folder/remind/change",{id:n,remindType:a}).then((function(e){2e4===e.data.code&&(t.getFolderList(!1,!0),t.handleCancel())}))},t.handleViewRules=function(e){var n=t.state.filterProjectId;E.mW.push({pathname:"/personalSettings/privateMessageRule",state:{projectId:n,folderName:e}})},t.handleConfirm=function(){var e=t.state,n=e.dialogType,a=e.step;switch(n){case"add":1===a?t.handleAddFolder():t.handleCancel();break;case"rename":t.handleRenameFolder();break;case"delete":t.handleDeleteFolder();break;case"toggle":t.handleUpdateFolder()}},t.handleCancel=function(){t.setState({dialogVisible:!1,targetFolder:{name:"",id:"",remindType:""}},(function(){t.setState({step:1})}))},t.state={targetFolder:{id:"",name:"",remindType:""},columns:[{label:"",prop:"paddingLeft",width:50,render:function(){return s.createElement("div",{className:"move_icon_container"},s.createElement("i",{className:"icon-cem_move"}))}},{label:"\u6587\u4ef6\u5939\u540d\u79f0",prop:"name"},{label:"\u6d88\u606f\u6570",prop:"count"},{label:"\u63d0\u9192\u65b9\u5f0f",prop:"remindType",render:function(e,t,n){var a=e.remindType;return s.createElement("span",null,"EMAIL"===a?"\u90ae\u4ef6":"\u65e0")}},{label:"\u63d0\u9192\u72b6\u6001",prop:"remindType",render:function(e,n,a){var l=e.remindType;return s.createElement(f.Z,{overlay:"EMAIL"===l?"\u5df2\u542f\u7528":"\u5df2\u505c\u7528",placement:"top"},s.createElement("span",null,s.createElement(c.Switch,{value:"EMAIL"===l,onText:"",offText:"",onColor:"#0747A6",offColor:"#CCCCCC",onChange:function(n){return t.switchRemindType(e.id,n)}})))}},{label:"\u64cd\u4f5c",width:250,render:function(e,n,a){var l=e.id,r=e.name;e.remindType;return"\u79c1\u4eba\u6d88\u606f"!==r&&s.createElement("span",null,s.createElement("span",{className:"operation_columns",onClick:function(){return t.handleViewRules(e.name)}},"\u67e5\u770b\u89c4\u5219"),s.createElement("span",{className:"operation_columns",onClick:function(){t.setState({dialogVisible:!0,dialogType:"rename",targetFolder:{id:l,name:r}})}},"\u91cd\u547d\u540d"),s.createElement("span",{className:"operation_columns",style:{marginRight:"0"},onClick:function(){t.setState({dialogVisible:!0,dialogType:"delete",targetFolder:{id:l}})}},"\u5220\u9664"))}},{label:"",prop:"paddingRight",width:50}],loading:!1,list:[],idList:[],filterProjectId:C.t.get(C.V.curProject).id,projectId:"",dialogVisible:!1,dialogType:"",step:1},t}(0,r.Z)(t,e);var n=t.prototype;return n.getFolderList=function(e,t){var n=this,a=this.state.filterProjectId;this.setState({loading:!0},(function(){v.h.post("/folder/list",{projectId:a}).then((function(e){var a=e.data.result;n.setState({list:a||[],idList:a.map((function(e){return e.id}))},(function(){t&&n.manualSort()}))})).finally((function(){n.setState({loading:!1}),n.initSortable(),e&&n.props.fetchMenuList()}))}))},n.componentDidMount=function(){this.getFolderList(!1,!1)},n.componentDidUpdate=function(){var e=this.state.list,t=document.querySelectorAll(".el-table__body tbody tr");if(t&&t.length>0)for(var n=0;n<t.length;n++)for(var a=0;a<e.length;a++){t[n].children[1].innerText===e[a].name&&t[n].setAttribute("data-id",e[a].id)}},n.render=function(){var e=this,t=this.state,n=t.columns,a=t.list,l=t.loading,r=t.dialogType,i=t.dialogVisible,o=t.targetFolder,d=t.step,f=t.projectId,g=t.filterProjectId;return s.createElement("div",{className:"personal-folder"},s.createElement(m.Z,{title:"\u4e2a\u4eba\u6587\u4ef6\u5939"}),s.createElement("div",{className:"personal-folder-header"},s.createElement(h.Z,{list:this.projectOptions,onChange:function(t){return e.projectOptions=t}}),s.createElement(c.Button,{onClick:function(){return e.setState({dialogVisible:!0,dialogType:"add",projectId:g})}},"\u6dfb\u52a0\u6587\u4ef6\u5939")),s.createElement("div",{className:"personal-folder-table"},s.createElement(c.Loading,{loading:l,text:"\u62fc\u547d\u52a0\u8f7d\u4e2d"},s.createElement(u.Z,{columns:n,data:a,rowClassName:function(e,t){return t===a.length-1?"sortable-row unsortable-row":"sortable-row"}})),s.createElement(c.Dialog,{title:"rename"===r?"\u91cd\u547d\u540d\u4e2a\u4eba\u6587\u4ef6\u5939":"add"===r&&1===d?"\u6dfb\u52a0\u4e2a\u4eba\u6587\u4ef6\u5939":"",size:"tiny",visible:i,onCancel:function(){return e.handleCancel()},customClass:"toggle"===r?"without-padding-dialogbody":"",lockScroll:!0},s.createElement(c.Dialog.Body,null,"delete"===r&&s.createElement(s.Fragment,null,s.createElement("div",{className:"dialog-title"},s.createElement("i",{className:"icon-cem_warning",style:{color:"#D96969"}}),"\u662f\u5426\u5220\u9664\u8be5\u4e2a\u4eba\u6587\u4ef6\u5939\uff1f"),s.createElement("div",{className:"delete-tips"},"\u5220\u9664\u540e\uff0c\u539f\u5c5e\u4e8e\u8be5\u6587\u4ef6\u5939\u7684\u6d88\u606f\u5c06\u79fb\u51fa\u5230",s.createElement("span",{style:{color:"#262626",fontWeight:"bold"}},"\u201c\u79c1\u4eba\u6d88\u606f\u201d"),"\u4e2d")),"toggle"===r&&s.createElement("div",{className:"dialog-title"},s.createElement("i",{className:"icon-cem_warning",style:{color:"#D96969"}}),"\u662f\u5426","EMAIL"===o.remindType?"\u542f":"\u505c","\u7528\u6d88\u606f\u63d0\u9192"),("add"===r&&1===d||"rename"===r)&&s.createElement(s.Fragment,null,"add"===r&&s.createElement("div",{className:"form-item"},s.createElement("label",null,"\u9879\u76ee"),s.createElement(p.RS,{tags:!1,multiple:!1,value:f,optionLabelProp:"label",placeholder:"\u8bf7\u9009\u62e9\u9879\u76ee",onChange:this.handleProjectChange},C.t.get(C.V.project).map((function(e,t){return s.createElement(p.Wx,{key:t,label:e.name,value:e.id},e.name)})))),s.createElement("div",{className:"form-item"},s.createElement("label",null,"\u540d\u79f0"),("add"===r||"rename"===r)&&s.createElement(c.Input,{maxLength:20,value:o.name,placeholder:"\u8bf7\u8f93\u5165\u540d\u79f0",onChange:this.handleNameChange}))),"add"===r&&2===d&&s.createElement(s.Fragment,null,s.createElement("div",{className:"dialog-title"},s.createElement("i",{className:"icon-cem_complete1",style:{color:"#00B76E",marginRight:"8px",fontSize:"20px"}}),"\u6dfb\u52a0\u4e2a\u4eba\u6587\u4ef6\u5939\u6210\u529f"),s.createElement("div",{className:"add-success"},"\u70b9\u51fb\u8fdb\u5165",s.createElement("a",{onClick:function(){return e.handleViewRules()}},"\u79c1\u4eba\u6d88\u606f\u5904\u7406\u89c4\u5219"),"\u5217\u8868\uff0c\u4e3a\u65b0\u5efa\u6587\u4ef6\u5939\u914d\u7f6e\u89c4\u5219"))),s.createElement(c.Dialog.Footer,{className:"dialog-footer"},s.createElement(c.Button,{type:"primary",onClick:this.handleConfirm},"delete"===r?"\u662f":"\u786e\u5b9a"),!("add"===r&&2===d)&&s.createElement(c.Button,{onClick:function(){return e.handleCancel()}},"delete"===r?"\u5426":"\u53d6\u6d88")))))},(0,a.Z)(t,[{key:"projectOptions",get:function(){var e=this.state.filterProjectId;return[{name:"\u9879\u76ee",list:C.t.get(C.V.project),value:e,singleSel:!0}]},set:function(e){var t=this,n=e[0].value;this.setState({filterProjectId:n[0]||""},(function(){return t.getFolderList(!1,!1)}))}}]),t}(s.Component);const L=(0,b.connect)((function(e){e.loading;var t=(0,o.Z)(e,k);return(0,i.Z)({},t[S])}),(function(e){return{fetchMenuList:function(t){return e({type:S+"/fetchMenuList",payload:t})}}}))(N)},24473:(e,t,n)=>{n.d(t,{Z:()=>h});var a=n(87462),l=n(63366),r=n(94578),i=n(67294),o=n(45697),s=n.n(o),c=n(94184),d=n.n(c),u=["prefixCls","children","className","block","indeterminate","value","checked","defaultChecked","onChange","disabled"],m=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.prefixCls,r=t.children,o=t.className,s=t.block,c=t.indeterminate,m=t.value,h=t.checked,p=t.defaultChecked,f=t.onChange,g=t.disabled,v=(0,l.Z)(t,u),E={value:m,checked:h,defaultChecked:p,onChange:f,disabled:g},C=d()(n,((e={})[n+"-disabled"]=E.disabled,e[n+"-block"]=s,e[n+"-indeterminate"]=c,e),o);return i.createElement("label",(0,a.Z)({tabIndex:E.disabled?-1:0,className:C},v),i.createElement("input",(0,a.Z)({type:"checkbox",className:n+"-input"},E)),i.createElement("span",{className:n+"-status"}),r&&i.createElement("span",{className:n+"-text",title:r},r))},t}(i.Component);m.propTypes={prefixCls:s().string,value:s().oneOfType([s().string,s().number]),checked:s().bool,defaultChecked:s().bool,onChange:s().func,indeterminate:s().bool,disabled:s().bool,block:s().bool},m.defaultProps={prefixCls:"wt-checkbox"};const h=m},85151:(e,t,n)=>{n.d(t,{Jg:()=>a.Z,CS:()=>p});var a=n(24473),l=n(87462),r=n(63366),i=n(94578),o=n(67294),s=n(45697),c=n.n(s),d=n(94184),u=n.n(d),m=["prefixCls","children","className","onChange","values","checkedList","block"],h=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return(t=e.call.apply(e,[this].concat(a))||this).handleCheckBoxChange=function(e){var n=t.props.onChange;n&&n(e)},t}return(0,i.Z)(t,e),t.prototype.render=function(){var e,t=this,n=this.props,a=n.prefixCls,i=n.children,s=n.className,c=(n.onChange,n.values),d=n.checkedList,h=n.block,p=(0,r.Z)(n,m);return e=c?c.map((function(e,n){var a=0!==d.length&&-1!==d.indexOf(e);return o.createElement(Checkbox,{key:n,value:e,checked:a,onChange:function(e){return t.handleCheckBoxChange(e)},block:h},e)})):o.Children.map(i,(function(e,n){if(e){var a=e.props,l=a.value,r=0!==d.length&&-1!==d.indexOf(l);return o.cloneElement(e,{checked:r,key:n,block:a.block||h,onChange:function(){var e=a.value;t.handleCheckBoxChange(e)}})}})),o.createElement("div",(0,l.Z)({className:u()(a,s)},p),e)},t}(o.Component);h.defaultProps={prefixCls:"wt-checkbox-group"},h.propTypes={onChange:c().func,values:c().array,block:c().bool};const p=h;var f=function(e){var t={};return Object.keys(e).forEach((function(n){/^data\-.+$/.test(n)&&(t[n]=e[n])})),t},g=function(e){function t(){return e.apply(this,arguments)||this}return(0,i.Z)(t,e),t.prototype.render=function(){var e=this.props,t=f(e);return o.createElement("label",{className:e.className,title:e.children},o.createElement("div",{className:"checkbox"},o.createElement("input",(0,l.Z)({checked:e.checked,type:"checkbox",name:e.name,onChange:e.onChange,disabled:e.disabled},t)),o.createElement("div",{className:"checkbox-body"})),"\xa0",o.createElement("span",null,e.children))},t}(o.Component);g.defaultProps={className:"",name:"",checked:!1,disabled:!1,onChange:function(e){return e}}},72305:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(36459),l=n(94578),r=n(67294),i=n(43144),o=n(85151);const s=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleClear=function(e){var t=n.state.list;t.forEach((function(e){return e.sel=!1})),n.setState({list:t},(function(e){return n.commitUserSel()}))},n.hoverDropToggle=function(e){if(e){var t=setTimeout((function(){n.setState({open:e,timeout:null})}),100);n.setState({timeout:t})}else clearTimeout(n.state.timeout),n.setState({open:e,timeout:null})},n.clickDropToggle=function(e){n.setState({open:!n.state.open})},n.stop=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},n.closeDrop=function(e){n.setState({open:!1})},n.state={list:JSON.parse(JSON.stringify(t.list||[])),searchKeyWords:"",open:!1,timeout:""},n}(0,l.Z)(t,e);var n=t.prototype;return n.search=function(){this.setState({searchKeyWords:this.refs.searchInput.value})},n.handleChecked=function(e){var t=this,n=this.state.list;this.props.singleSel?n.forEach((function(t){t.sel=t.id===e})):n.forEach((function(t){t.id===e&&(t.sel=!t.sel)})),this.setState({list:n},(function(e){return t.commitUserSel()}))},n.handleCheckedAll=function(){var e=this,t=!this.checkedAll,n=this.state.list;n.forEach((function(e){return e.sel=t})),this.setState({list:n},(function(t){return e.commitUserSel()}))},n.commitUserSel=function(){this.props.onSel(this.selList)},n.UNSAFE_componentWillReceiveProps=function(e,t){if(e.list||e.value){var n=JSON.parse(JSON.stringify(e.list));n.forEach((function(t){t.sel=-1!==e.value.indexOf(t.id)})),this.setState({list:n})}},n.componentDidMount=function(){var e=this;if(this.props.value){var t=JSON.parse(JSON.stringify(this.state.list));t.forEach((function(t){t.sel=-1!==e.props.value.indexOf(t.id)})),this.setState({list:t})}},n.render=function(){var e=this,t=this.props,n=t.classNames,a=t.style,l=t.title,i=t.selectPosition,s=t.special,c=t.singleSel,d=this.state,u=d.list,m=d.searchKeyWords,h=d.open,p=m.length>0?this.searchList:u,f=u.find((function(t){return e.props.list.value===t.id}));return r.createElement("div",{className:(n||"")+" back-search-select-wrap",onClick:function(t){e.stop(t)},style:a,onMouseEnter:function(){e.hoverDropToggle(!0)},onMouseLeave:function(){e.hoverDropToggle(!1)}},r.createElement("div",{className:h?"open sel-wrap":"sel-wrap"},r.createElement("div",{className:"span-wrap"},r.createElement("span",{className:"title"},l+(s?"":" : ")),!s&&(this.selList.length>0?this.selList.map((function(t,n){return r.createElement("span",{key:n},t.name,n===e.selList.length-1?"":" ,")})):r.createElement("span",null,c&&f?f.name:"\u5168\u90e8"))),r.createElement("i",{className:"icon-cem_pull-down-or-take-up"})),h&&r.createElement(r.Fragment,null,r.createElement("div",{className:"allSelContent",style:{left:"left"===i?"0":"",right:"right"===i?"0":""}},r.createElement("div",{className:"search"},r.createElement("p",{style:{padding:"5px"}},r.createElement("input",{value:m,placeholder:"\u8bf7\u8f93\u5165",ref:"searchInput",type:"text",onChange:function(t){return e.search()}}))),p.length>0?r.createElement("div",{className:"all"},r.createElement("div",{className:"all_check"},!c&&m.length<1&&r.createElement(o.Jg,{checked:this.checkedAll,indeterminate:this.indeterminate,onChange:function(){return e.handleCheckedAll()},block:!0},"\u5168\u9009")),p.map((function(t){return e.props.singleSel?r.createElement("p",{className:t.sel?"singleSel sel":"singleSel",key:t.id,onClick:function(){return e.handleChecked(t.id)}},t.name):r.createElement(o.Jg,{key:t.id,value:t.id,checked:t.sel,onChange:function(){return e.handleChecked(t.id)},block:!0},t.name)}))):r.createElement("div",{className:"all"},"\u65e0\u9009\u9879"),r.createElement("div",{className:"search_bottom"},r.createElement("p",null,r.createElement("span",{onClick:function(t){return e.handleClear()}},"\u6e05\u9664"))))))},(0,i.Z)(t,[{key:"selList",get:function(){return this.state.list.filter((function(e,t){return e.sel}))}},{key:"checkedAll",get:function(){return this.state.list.every((function(e){return e.sel}))}},{key:"indeterminate",get:function(){return!this.checkedAll&&this.state.list.some((function(e){return e.sel}))}},{key:"searchList",get:function(){var e=this;return this.state.list.filter((function(t){if(-1!==t.name.toLocaleLowerCase().indexOf(e.state.searchKeyWords.trim().toLocaleLowerCase()))return!0}))}}]),t}(r.Component);var c=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return(t=e.call.apply(e,[this].concat(a))||this).state={filterList:[],inputVal:""},t.inputChange=function(e){t.setState({inputVal:e.target.value})},t.keywordChange=function(e){},t}(0,l.Z)(t,e);var n=t.prototype;return n.handleSel=function(e,t){var n=this.props,a=n.list,l=n.onChange;a.forEach((function(n){n.name===e&&(n.value=t.map((function(e){return e.id})))})),l(a)},n.UNSAFE_componentWillReceiveProps=function(e,t){e&&this.setState({filterList:e.list})},n.componentDidMount=function(){},n.buildHeaderFilter=function(){var e=this;(0,a.Z)(this.props);var t=this.state,n=(t.inputVal,t.filterList);return r.createElement("div",{className:"back-end-filter"},n.map((function(t,n){return r.createElement(s,{key:n,list:t&&t.list,value:t.value||[],onSel:e.handleSel.bind(e,t.name),title:t.name,singleSel:t.singleSel})})))},n.render=function(){return this.buildHeaderFilter()},t}(r.Component)},12518:(e,t,n)=>{n.d(t,{Z:()=>d});var a=n(94578),l=n(67294),r=n(45697),i=n.n(r),o=n(61409),s=n(92360),c=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props.title;e!==n.length-1&&o.mW.go(e-n.length+1)},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.rightContent;return l.createElement("div",{className:"secondary-header"},n instanceof Array?l.createElement(s.Breadcrumb,{className:"breadcrumb-style",separator:""},n.map((function(t,n){return l.createElement(s.Breadcrumb.Item,{key:n},l.createElement("span",{onClick:function(){return e._handleBreadcrumbClick(n)}},t))}))):l.createElement("div",{className:"normal-title"},n),a&&a)},t}(l.Component);c.propTypes={title:i().oneOfType([i().string,i().array]).isRequired,rightContent:i().node};const d=c}}]);