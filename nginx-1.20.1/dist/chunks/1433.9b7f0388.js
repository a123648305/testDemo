"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[1433],{78496:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Z});var a=n(63366),o=n(87462),r=n(94578),i=n(67294),l=n(70715),c=n(39432),s=n(90126);const u=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))||this).dimensions=void 0,t.source=void 0,t.chartRef=void 0,t.mColor=l.Fq.slice(),t.chartLength=0,t.getChartRef=function(e){return t.chartRef=e},t.setValue=function(e){t.chartLength=e.length,t.dimensions=["\u65e5\u671f"],t.source=e.filter((function(e){return e})).reduce((function(e,n,a){var o=s.fv[n.name.toLocaleLowerCase()];return o&&t.mColor.splice(a,0,o[0]),t.dimensions.push(n.name),n.dateList.forEach((function(t,n){0===a?e.push([t.date,t.count]):e[n].push(t.count)})),e}),[])},t.getOption=function(e,n){return{color:t.mColor,title:{text:e},grid:{top:80,left:32,right:"4%",bottom:40,containLabel:!0},dataset:[{source:t.source,dimensions:t.dimensions}],legend:{top:40,left:20,itemWidth:14,itemHeight:12,type:"scroll",pageIconSize:12,icon:l.W4.lineRing},dataZoom:[{show:"slider",bottom:15,xAxisIndex:0,height:15,handleSize:"100%",showDetail:!1}],tooltip:{trigger:"item",formatter:function(t){var a=t.name,o=t.marker,r=t.seriesName,i=t.seriesIndex,l=t.data[i+1];return'<span class="yt_echart_tooltip_title">'+("\u8206\u60c5\u58f0\u91cf\u8d70\u52bf\u5bf9\u6bd4"===e?"\u58f0\u91cf":"\u8206\u60c5\u8d1f\u9762\u58f0\u91cf\u8d70\u52bf\u5bf9\u6bd4"===e?"\u8d1f\u9762\u58f0\u91cf":"\u6b63\u9762\u58f0\u91cf")+'<span style="color: #8C8C8C;font-weight: 500;">\uff08'+(0,c.yV)(n,a)+"\uff09</span></span><br />"+o+" "+r+"\uff1a"+c.ZP.getApproximateNum(l)}},xAxis:{type:"category",boundaryGap:!1,axisLabel:{formatter:function(e){return(0,c.yV)(n,e)}}},yAxis:{type:"value"},series:Array.from({length:t.chartLength}).map((function(e,t){return{type:"line"}}))}},t}return(0,r.Z)(t,e),t.prototype.renderChart=function(e,t,n){this.setValue(e),this.chartRef.clear(),this.chartRef.setOption(this.getOption(t,n))},t}(i.PureComponent);var p=n(8201),d=n(98191),h=n(50976),f=n(60496),g=n(94644),m=n(45697),v=n.n(m),y=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))||this).handleOnDateChange=function(e){var n,a=t.props,o=a.dateType,r=a.onFilterChange,i=Object.keys(o)[0];r&&r(((n={})[i]=e,n))},t.handleOnMoreClick=function(e){var n=t.props,a=n.title,o=n.value;"image"===e&&t.chartRef?(0,g._v)(t.chartRef,a):"data"===e&&(0,p.P)(o)&&(0,g.aT)([[t.dimensions].concat(t.source)],a)},t.handleOnFlavorChange=function(e){var n,a=t.props,o=a.dtFlavor,r=a.onFlavorChange,i=Object.keys(o)[0];r&&r(((n={})[i]=e,n))},t}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){var t=e.value,n=this.props.value;(0,p.P)(n)&&JSON.stringify(t)!==JSON.stringify(n)&&this.renderChart(),!(0,p.P)(n)&&this.chartRef&&(this.chartRef=void 0)},n.componentDidMount=function(){this.renderChart()},n.renderChart=function(){var t=this.props,n=t.value,a=t.title,o=t.dateType;if((0,p.P)(n)&&this.chartRef){var r=Object.values(o)[0];e.prototype.renderChart.call(this,n,a,r)}},n.render=function(){var e=this.props,t=e.value,n=e.loading,a=e.title,o=e.className,r=e.dtFlavor,l=e.dateType,c=e.onClick,s=e.dateOptions,u=Object.keys(r)[0],g=Object.keys(l)[0];return i.createElement(p.Z,{className:"yt_social_overview_line_chart_wrapper "+o,data:t,loading:n,renderTitle:i.createElement(d.Z,{title:a,data:t,onMoreClick:this.handleOnMoreClick},i.createElement(f.Z,{onChange:this.handleOnDateChange,onFlavorChange:this.handleOnFlavorChange,activeObj:l[g],flavor:r[u],options:s}))},i.createElement(h.Z,{onChartReady:this.getChartRef,onEvents:{click:c},theme:"yunting_multi_color",className:"yt_echarts_style",option:{},style:{height:"100%"}}))},t}(u);const C=y;y.propTypes={title:v().string,className:v().string,value:v().any,onFilterChange:v().func,dtFlavor:v().object,dateType:v().object,onFlavorChange:v().func,dateOptions:v().arrayOf({title:v().string,value:v().value})};var O=n(92360),D={positiveCount:"\u6b63\u9762",neutralCount:"\u4e2d\u6027",negativeCount:"\u8d1f\u9762"},_=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).source=void 0,t.dimensions=void 0,t.chartLength=0,t.totalCount=0,t.chartRefObj={},t.setChartRef=function(e){t.chartRefObj=(0,o.Z)({},t.chartRefObj,e)},t}(0,r.Z)(t,e);var n=t.prototype;return n.setValue=function(e){var t=this;this.totalCount=0,this.chartLength=e.length,this.dimensions=["\u65e5\u671f"],this.source=e.filter((function(e){return e})).reduce((function(e,n,a){return t.dimensions.push(n.name),0===a?(e.push(["\u6b63\u9762",n.positiveCount]),e.push(["\u4e2d\u6027",n.neutralCount]),e.push(["\u8d1f\u9762",n.negativeCount])):(e[0].push(n.positiveCount),e[1].push(n.neutralCount),e[2].push(n.negativeCount)),t.totalCount+=n.positiveCount+n.neutralCount+n.negativeCount,e}),[])},n.getOption=function(e){var t=e.positiveCount+e.neutralCount+e.negativeCount,n={title:{text:e.name+"\uff08"+(0===this.totalCount||0===t?0:(t/this.totalCount*100).toFixed(2))+"%\uff09",padding:[20,2],subtext:"{a|\u58f0\u91cf}\n{b|"+(0,c.uf)(t)+"}",subtextStyle:{rich:{a:{color:"#8C8C8C",verticalAlign:"bottom",fontSize:14,lineHeight:50},b:{color:"#262626",fontSize:14,lineHeight:30,verticalAlign:"bottom"}}}},tooltip:{formatter:function(e){var t=e.marker,n=e.name,a=e.percent;return[t+' <span style="color: #262626; font-weight: 500; font-size: 14px">'+n+"\u58f0\u91cf</span>",'<span style="font-size: 12px; margin-left: 20px">'+n+"\u58f0\u91cf\uff1a"+e.value+"</span>",'<span style="font-size: 12px; margin-left: 20px">'+n+"\u5360\u6bd4\uff1a"+a+"%</span>"].join("</br>")}},series:[{type:"pie",hoverOffset:4,center:["70%","50%"],radius:["40%","70%"],label:{show:!1},data:Object.keys(D).map((function(t){return{name:D[t],value:e[t]}}))}]},a=s.fv[e.name.toLocaleLowerCase()];return a&&(n.color=a),n},t}(i.PureComponent);var E=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))||this)._handleOnMoreClick=function(e){var n=t.props,a=n.title,o=n.data;"image"===e?(0,g.OH)(Object.values(t.chartRefObj),a,t.dimensions.slice(1)):"data"===e&&(0,p.P)(o)&&(0,g.aT)([[t.dimensions].concat(t.source)],a)},t}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){var t=e.data,n=this.props.data;(0,p.P)(n)&&JSON.stringify(t)!==JSON.stringify(n)&&(this.setValue(n),this.forceUpdate())},n.render=function(){var e=this,t=this.props,n=t.className,a=t.data,o=t.loading,r=t.title,l=t.onClick,c=(0,p.P)(a)?Math.ceil(a.length/3):0;return i.createElement(p.Z,{data:a,loading:o,className:"yt_voice_ring_chart_wrapper "+n,renderTitle:i.createElement(d.Z,{title:r,data:null,onMoreClick:this._handleOnMoreClick})},i.createElement(O.Carousel,{autoplay:!1,indicatorPosition:"none",arrow:"hover",className:1===c?"no_nav":""},a&&a instanceof Array&&Array.from({length:c}).map((function(t,n){return i.createElement(O.Carousel.Item,{key:n},i.createElement("div",{className:"ring_chart_wrapper"},Array.from({length:3}).map((function(t,o){var r=a[3*n+o];return r?i.createElement(h.Z,{onChartReady:function(t){var n;return e.setChartRef(((n={})[r.name]=t,n))},onEvents:{click:l},key:r.name,className:"ring_chart",theme:"yunting_pos_neu_neg",style:{height:"100%"},option:e.getOption(r)}):""}))))}))))},t}(_);const F=E;E.propTypes={title:v().string,loading:v().bool,className:v().string,data:v().any};var R=n(8833);const V=function(e){var t=e.allVoicData,n=e.allDateType,a=e.allDtFlavor,o=e.fetchingAllVoiceData,r=e.compareData,l=e.fetchingCompareData,c=e.negVoiceData,s=e.negDateType,u=e.negDtFlavor,p=e.fetchingNegVoiceData,d=e.posVoiceData,h=e.posDateType,f=e.posDtFlavor,g=e.fetchingPosVoiceData,m=e.dateOptions,v=e.onFilterChange,y=e.onFilterReady,O=e.onFlavorChange,D=e.onVolumeClick;return i.createElement(R.Z,{hour:!0,className:"yt_social_overview_wrapper",pageType:"SOCIAL_OVERVIEW",onReady:y,onChange:v},i.createElement("div",{className:"content"},i.createElement(C,{key:"all",title:"\u8206\u60c5\u58f0\u91cf\u8d70\u52bf\u5bf9\u6bd4",value:t,dtFlavor:{allDtFlavor:a},dateType:{allDateType:n},className:"content_chart",loading:o,onFilterChange:v,onFlavorChange:O,onClick:D,dateOptions:m}),i.createElement(F,{data:r,title:"\u8206\u60c5\u58f0\u91cf\u5bf9\u6bd4",className:"content_chart",loading:l,onClick:D}),i.createElement("div",null,i.createElement(C,{key:"neg",title:"\u8206\u60c5\u8d1f\u9762\u58f0\u91cf\u8d70\u52bf\u5bf9\u6bd4",dtFlavor:{negDtFlavor:u},value:c,className:"content_chart",dateType:{negDateType:s},loading:p,onFilterChange:v,onFlavorChange:O,onClick:D,dateOptions:m}),i.createElement(C,{key:"pos",title:"\u8206\u60c5\u6b63\u9762\u58f0\u91cf\u8d70\u52bf\u5bf9\u6bd4",value:d,loading:g,className:"content_chart",dateType:{posDateType:h},dtFlavor:{posDtFlavor:f},onFilterChange:v,onFlavorChange:O,onClick:D,dateOptions:m}))))};var T=n(35239),N=n(55609),b=n(87219),S=n(64396),A=["loading"],k=S.Z.social.overview,P=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnFilterReady=function(e,t,a){n.props.fetchParams((0,o.Z)({},e,{projectId:T.t.get(T.V.curProject).id,dateOptions:a.dateOptions,defaultDateType:a.defaultDateType}))},n._handleOnFilterChange=function(e,t,a){if(e.filterValue){var r=JSON.stringify(e.dateFilter)!==JSON.stringify(n.props.dateFilter),i=(0,o.Z)({},e,{dateOptions:a.dateOptions,defaultDateType:a.defaultDateType,filtedObjs:r?void 0:(0,s.ZT)(n.props,e)});n.props.fetchParams(i)}else e.allDateType?n.props.fetchAllVoicData((0,o.Z)({},e,{projectId:T.t.get(T.V.curProject).id})):e.negDateType?n.props.fetchNegVoicData((0,o.Z)({},e,{projectId:T.t.get(T.V.curProject).id})):e.posDateType&&n.props.fetchPosVoicData((0,o.Z)({},e,{projectId:T.t.get(T.V.curProject).id}))},n._handleOnFlavorChange=function(e){n.props.updateFlavors(e)},n._handleOnVolumeClick=function(e,t){var a=e.name,o=e.componentSubType,r=e.seriesName,i=n.props,l=i.projectId,u=i.filterValue,p=i.dateFilter,d=i.allDateType,h=i.allVoicData,f=i.negDateType,g=i.negVoiceData,m=i.posDateType,v=i.posVoiceData,y=i.compareData,C=u.some((function(e){return"VOC_ASPECT"===e.id}))&&u.find((function(e){return"VOC_ASPECT"===e.id})).values,O=t._model.option.title[0].text,D="pie"===o?O.split("\uff08")[0]:O,_="pie"===o?y.find((function(e){return e.name===D})).id:h.find((function(e){return e.name===r})).id,E=u.some((function(e){return"TAG_RULE"===e.id}))&&u.find((function(e){return"TAG_RULE"===e.id})).values,F=u.some((function(e){return"DEFAULT"===e.id}))&&u.find((function(e){return"DEFAULT"===e.id})),R=u.some((function(e){return"BRAND_SERIES"===e.id}))&&u.find((function(e){return"BRAND_SERIES"===e.id})).values.some((function(e){return"SERIES"===e.id}))&&u.find((function(e){return"BRAND_SERIES"===e.id})).values.find((function(e){return"SERIES"===e.id})).values,V=R&&R.map((function(e){return e.split("_")[0]})),T={projectId:l,dateFilter:"pie"===o?p:(0,b.ZP)(p,(function(e){var t="\u8206\u60c5\u58f0\u91cf\u8d70\u52bf\u5bf9\u6bd4"===D?d:"\u8206\u60c5\u8d1f\u9762\u58f0\u91cf\u8d70\u52bf\u5bf9\u6bd4"===D?f:m,n="\u8206\u60c5\u58f0\u91cf\u8d70\u52bf\u5bf9\u6bd4"===D?h[0].dateList.map((function(e){return e.date})):"\u8206\u60c5\u8d1f\u9762\u58f0\u91cf\u8d70\u52bf\u5bf9\u6bd4"===D?g[0].dateList.map((function(e){return e.date})):v[0].dateList.map((function(e){return e.date})),o=(0,c.LV)(a,t),r=o.from,i=o.to;"DAY"!==t&&"HOUR"!==t&&(String(a)===String(n[0])?r=e.from:String(a)===String(n[n.length-1])&&(i=e.to)),e.from=r,e.to=i})),filterModel:{brandsSeries:[{id:"brand",special:"brandsSeries",values:[_]}],escore:"\u4e2d\u6027"===a?["0"]:"\u8d1f\u9762"===a||"\u8206\u60c5\u8d1f\u9762\u58f0\u91cf\u8d70\u52bf\u5bf9\u6bd4"===D?["-1"]:"\u6b63\u9762"===a||"\u8206\u60c5\u6b63\u9762\u58f0\u91cf\u8d70\u52bf\u5bf9\u6bd4"===D?["1"]:["1","0","-1"],messageType:["QUE_ANS_QUESTION","QUE_ANS_ANSWER","WEIBO","WEIBO_REPORT","COMMON_POST","NEWS_TEXT","COMPLAINT"],project:[l]},filterTip:"pie"===o?"\u8206\u60c5\u770b\u677f/\u8206\u60c5\u6982\u89c8/\u8206\u60c5\u58f0\u91cf\u5bf9\u6bd4":"\u8206\u60c5\u770b\u677f/\u8206\u60c5\u6982\u89c8/"+D};R&&T.filterModel.brandsSeries.unshift({id:"series",special:"brandsSeries",values:V}),E&&(T.filterModel.tag=E.map((function(e){return{id:e.id,special:"tag",values:e.values}}))),F&&F.values.some((function(e){return"SOURCE"===e.id}))&&(T.filterModel.source=F.values.find((function(e){return"SOURCE"===e.id})).values),C&&(T.filterModel.vocAspect=(0,s.ou)(C)),window.open("/inbox/public?"+encodeURIComponent(JSON.stringify(T)))},n.event={onFilterReady:n._handleOnFilterReady,onFilterChange:n._handleOnFilterChange,onFlavorChange:n._handleOnFlavorChange,onVolumeClick:n._handleOnVolumeClick},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentWillUnmount=function(){},n.render=function(){return i.createElement(V,(0,o.Z)({},this.props,this.state,this.event))},t}(i.PureComponent);const Z=(0,N.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,A);return(0,o.Z)({},n[k],{fetchingAllVoiceData:t.effects[k+"/fetchAllVoicData"]||!1,fetchingCompareData:t.effects[k+"/fetchVoicCompareDate"]||!1,fetchingNegVoiceData:t.effects[k+"/fetchNegVoicData"]||!1,fetchingPosVoiceData:t.effects[k+"/fetchPosVoicData"]||!1})}),(function(e){return{save:function(t){return e({type:k+"/save",payload:t})},clean:function(){return e({type:k+"/clean"})},fetchParams:function(t){return e({type:k+"/fetchParams",payload:t})},fetchAllVoicData:function(t){return e({type:k+"/fetchAllVoicData",payload:t})},fetchNegVoicData:function(t){return e({type:k+"/fetchNegVoicData",payload:t})},fetchPosVoicData:function(t){return e({type:k+"/fetchPosVoicData",payload:t})},fetchVoicCompareDate:function(t){return e({type:k+"/fetchVoicCompareDate",payload:t})},updateFlavors:function(t){return e({type:k+"/updateFlavors",payload:t})}}}))(P)},8833:(e,t,n)=>{n.d(t,{Z:()=>d});var a=n(87462),o=n(63366),r=n(67294),i=n(26198),l=n(53113),c=n(45697),s=n.n(c),u=["getFilterRef","className","hour","children","onReady","onChange"],p=function(e){var t=e.getFilterRef,n=e.className,c=e.hour,s=e.children,p=e.onReady,d=e.onChange,h=(0,o.Z)(e,u);return r.createElement("div",{className:n},r.createElement(i.Z,(0,a.Z)({ref:t,onReady:function(){p.apply(null,[].concat(Array.prototype.slice.call(arguments),[(0,l.X)(arguments[0].dateFilter.numOfDays,c)]))},onChange:function(){d.apply(null,[].concat(Array.prototype.slice.call(arguments),[(0,l.X)(arguments[0].dateFilter.numOfDays,c)])),arguments[0].filterValue}},h)),s)};const d=p;p.propTypes={className:s().string,hour:s().bool,onReady:s().func,onChange:s().func,pageType:s().string,titles:s().shape({titel:s().string,url:s().string,state:s().object})}}}]);