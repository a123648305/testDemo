"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[9087],{80442:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ze});var n=a(87462),r=a(97326),o=a(94578),i=a(67294),l=a(92360),s=a(50228),c=a(63366),u=(a(43378),a(62443)),d=a(8201),p=a(98191),m=a(43036),f=a(39432),h=a(96889);function y(e,t,a){var n=[{title:"\u9009\u9879",dataIndex:"\u9009\u9879",key:"\u9009\u9879",ellipsis:!0,width:200}];return"SORT"===e?t[0].sortList.forEach((function(e){n.push({title:e.title,dataIndex:e.title,key:e.title,ellipsis:!0,width:200})})):n=a.map((function(e){return{title:e,dataIndex:e,key:e}})),n}function E(e,t,a,n){var r=[];if("SORT"===e){var o=a.map((function(e){return e.dataIndex}));t.forEach((function(e,t){var a={};a.key=t,o.forEach((function(t,n){a[t]="\u9009\u9879"===t?e.optionName:e.sortList[n-1].number+" ("+(100*e.sortList[n-1].proportion).toFixed(2)+"%)"})),r.push(a)}))}else t.forEach((function(e){n.forEach((function(t,a){var n={};n[t]=e[a],r.push(n)}))}));return r}function g(e,t,a){var n=y(e,t,a);return{columns:n,Bodydata:E(e,t,n,a)}}const v=function(e){var t=e.number,a=e.titles,n=e.data,r=e.type,o=e.className,l=void 0===o?"":o,s=e.answeredQuestion,c=e.answeredQuestionProportion,u=e.questionId,d=e.fetchReasonChart,p=e.fetchUserInfoChart,y=e.thirdParty,E=i.useState(1),v=E[0],I=E[1],C=i.useState(g(r,n,a)),S=C[0],T=C[1];return i.useEffect((function(){var e=g(r,n,a);T(e)}),[n]),i.createElement("div",{className:"yt_research_answer_simple_talbe_wrapper "+l},i.createElement("div",{className:"top"},i.createElement("span",{className:"name"},"\u7b54\u9898\u6570\u91cf\uff1a"),i.createElement("span",null,(0,f.hE)(s)),!y&&i.createElement(i.Fragment,null,i.createElement("span",{className:"name pecName"},"\u7b54\u9898\u7387\uff1a"),i.createElement("span",null,(100*c).toFixed(2)+"%",i.createElement(m.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:"\u7b54\u9898\u7387 = \u7b54\u9898\u6570\u91cf \xf7 \u63d0\u4ea4\u7b54\u5377\u7684\u5ba2\u6237\u6570"},i.createElement("i",{className:"icon-cem_file1",style:{marginLeft:4,fontSize:14,color:"#979797"}}))))),i.createElement("div",{className:"st_content"},"SORT"===r?i.createElement(h.ZP,{columns:S.columns,dataSource:S.Bodydata,search:!1,options:!1,tableAlertRender:!1,pagination:!1,rowClassName:function(){return"mouseTypes"}}):i.createElement(h.ZP,{rowClassName:function(){return"mouseTypes"},columns:S.columns,pagination:{pageSize:10,total:s,current:v},onChange:function(e){var a=e.current,n=e.pageSize;I(a),"reason"===r?d({number:t,pageIndex:a,pageSize:n,questionId:u}):p({pageIndex:a,pageSize:n,questionId:u})},dataSource:S.Bodydata,search:!1,options:!1,tableAlertRender:!1})))};var I=a(49722),C=a(94644);const S=function(e){var t=e.number,a=e.data,n=e.loading,r=e.title,o=e.tableTitles,l=e.answeredQuestion,s=e.answeredQuestionProportion,c=e.fetchReasonChart,m=e.fetchUserInfoChart,f=e.questionnaireId,h=e.questionId,g=e.chartType,S=e.dateFilter,T=e.filterModel,N=e.projectId,b=e.thirdParty;return i.createElement(d.Z,{className:"yt_research_answer_table_list_chart",data:a,loading:n,renderTitle:i.createElement("span",{className:"research_table_list_header"},i.createElement("span",{style:{fontWeight:"bold"}},r),i.createElement(p.Z,{data:a},i.createElement("div",{className:"icons"},i.createElement("div",{className:"icon"},i.createElement(u.default,{placement:"top",content:"\u5bfc\u51fa\u6570\u636e",mouseEnterDelay:.6,getPopupContainer:function(e){return e}},i.createElement("i",{className:"icon-daochu",onClick:function(){return function(t){var a=e.title,n=e.data,r=e.chartType;if("data"===t&&(0,d.P)(n))if("USER_INFO"===r)I.h.post("/questionnaire/chart/find/COMBINATION_INFO_CHART",{questionId:h,questionnaireId:f,dateFilter:S,filterModel:T,projectId:N}).then((function(e){var t=e.data;2e4===t.code&&t.result.infoList&&(0,C.aT)([t.result.infoList.reduce((function(e,t){return e.push([t.name,t.phoneNumber,t.email]),e}),[o]).map((function(e){return e.map((function(e){return e}))}))],a)}));else if("SORT"===r){var i=y(r,n,o),l=E(r,n,i,o),s=i.map((function(e){return e.title})),c=l.map((function(e){var t=[];return s.forEach((function(a){t.push(e[a])})),t}));(0,C.aT)([[s].concat(c)],a)}else I.h.post("/questionnaire/chart/find/QUESTION_ANSWER_CHART",{questionId:h,questionnaireId:f,dateFilter:S,filterModel:T,projectId:N}).then((function(e){var t=e.data;2e4===t.code&&t.result.reasonList&&(0,C.aT)([t.result.reasonList.reduce((function(e,t){return e.push([t]),e}),[o]).map((function(e){return e.map((function(e){return e}))}))],a)}))}("data")}}))))))},i.createElement(i.Fragment,null,(0,d.P)(a)&&i.createElement(v,{className:"research_answer_table",fetchUserInfoChart:m,fetchReasonChart:c,questionId:h,answeredQuestion:l,answeredQuestionProportion:s,data:a,number:t,type:g,titles:o,thirdParty:b})))};a(48980);var T=a(20838),N=a(50976),b=a(29306),w=a.n(b),_=a(60496),D=(a(53294),a(56697)),O=(a(15144),a(2307)),A=a(58954);const R=function(e){var t=e.tableOptions,a=t.answerRate,n=t.answerTotal,r=t.tableData,o=t.tableColumns,l=e.tableClassName,s=e.params,c=(0,i.useState)(!1),u=c[0],d=c[1],p=(0,i.useState)(!0),f=p[0],y=p[1],E=i.useState(1),g=E[0],v=E[1],I=i.useState([]),C=I[0],S=I[1],T=i.useState(""),N=T[0],b=T[1],w=i.useState(0),_=w[0],R=w[1],P=i.useState([{title:"\u7b54\u6848",dataIndex:"answer"}]),L=P[0],x=(P[1],s.projectId),Z=s.dateFilter,M=s.questionId,F=s.questionnaireId,k=s.filterModel,z=s.type;return i.createElement("div",{className:"content_table"},i.createElement("div",{className:"top"},i.createElement("span",{className:"name"},"\u7b54\u9898\u6570\u91cf\uff1a"),i.createElement("span",null,n),a&&i.createElement(i.Fragment,null,i.createElement("span",{className:"name pecName"},"\u7b54\u9898\u7387\uff1a"),i.createElement("span",null,a,i.createElement(m.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:"\u7b54\u9898\u7387 = \u7b54\u9898\u6570\u91cf \xf7 \u63d0\u4ea4\u7b54\u5377\u7684\u5ba2\u6237\u6570"},i.createElement("i",{className:"icon-cem_file1",style:{marginLeft:4,fontSize:14,color:"#979797"}}))))),i.createElement(O.Z,{size:"small",dataSource:r,columns:o,className:l,onRow:function(e){return{onClick:function(){"SINGLE_CHOICE"!==z&&"MULTIPLE_CHOICE"!==z||(d(!0),y(!0),e.textCount&&0!==e.textCount?("SINGLE_CHOICE"===z?(0,A.d5)({projectId:x,dateFilter:Z,optionName:e.optionName,pageIndex:g,pageSize:10,questionId:M,questionnaireId:F,filterModel:k},(function(e){y(!1);var t=e.data.result.reasonList,a=[];t.forEach((function(e){a.push({answer:e})})),S(a)})):(0,A.VP)({projectId:x,dateFilter:Z,optionId:e.optionId,pageIndex:g,pageSize:10,questionId:M,questionnaireId:F,filterModel:k}).then((function(e){y(!1);var t=e.data.result.reasonList,a=[];t.forEach((function(e){a.push({answer:e})})),S(a)})),b(e.optionName),R(e.textCount)):y(!1),R(e.textCount),b(e.optionName),S([]))}}},pagination:!1,scroll:{y:250},rowClassName:function(){return"SINGLE_CHOICE"===z||"MULTIPLE_CHOICE"===z?"pointTypes":"mouseTypes"}}),i.createElement(D.Z,{className:"basic_modal",title:N,visible:u,onOk:function(){d(!1)},onCancel:function(){d(!1)},width:906},i.createElement(h.ZP,{columns:L,rowKey:"id",pagination:{pageSize:10,total:_,current:g},onChange:function(e){var t=e.current,a=e.pageSize;v(t),(0,A.d5)({projectId:x,dateFilter:Z,optionName:N,pageIndex:g,pageSize:a,questionId:M,questionnaireId:F,filterModel:k},(function(e){var t=e.data.result.reasonList,a=[];t.forEach((function(e){a.push({answer:e})})),S(a)}))},dataSource:C,search:!1,options:!1,tableAlertRender:!1,loading:f})))};var P=function(){};P.getTypeResult=function(e,t,a,r,o,i,l,s,c){return"pie"===e?function(e,t,a,r,o){return(0,n.Z)({color:["#5B8FF9","#60DDA9","#F6BD15","#F08A8A","#78D3F8","#65789B","#F6903D","#9a60b4","#ea7ccc"],title:{text:t},tooltip:{trigger:"item",formatter:function(e){var t=e.marker,a=e.percent,n=e.data,r=n.value;return t+" "+n.name+"\uff1a"+(0,f.hE)(r)+"\uff08"+a+"%\uff09"}},series:[{name:"Access From",type:"pie",radius:["50%","70%"],center:["50%","45%"],top:r?85:50,data:e,avoidLabelOverlap:!0,left:"center",label:{show:a,minMargin:10,edgeDistance:20,lineHeight:17,fontFamily:"PingFangSC, PingFangSC-Regular",fontSzie:16,fontWeight:400,color:"#262626",formatter:function(e){var t=e.name,a=e.value,n=e.percent;return[t.length>8?t.slice(0,8)+"...":t,a+" ("+n.toFixed(2)+"%)"].join("\n")}},labelLine:{show:a,length:20,length2:0},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},o)}(o.answerTotal>0?a.filter((function(e){return 0!==e.value})):a,t,l,s,c):"bar"===e?function(e,t,a,r,o,i,l){return(0,n.Z)({dataset:e,title:{text:t},grid:{left:"4%",top:r?"20%":"13%",bottom:"4%",right:"20%",containLabel:!0},yAxis:{type:"category",axisTick:!1,inverse:!0,axisLabel:{color:"#e5e5e5;",fontSize:12,fontWeight:400,formatter:function(e){return e.length>8?e.substring(0,8)+"...":e}}},xAxis:{type:"value",axisLabel:!1,splitLine:!1,axisLine:!1},tooltip:{trigger:"axis",enterable:!0,hideDelay:150,formatter:function(e){var t=e[0],a=t.marker,n=t.axisValueLabel,r=t.data;return a+" "+n+"\uff1a"+(0,f.hE)(r[1])+" ("+r[2]+")"},axisPointer:{label:!1}},series:[{type:"bar",barWidth:20,itemStyle:{color:"#5b8ff9"},label:{show:a,color:"#626262",fontSize:12,fontWeight:400,position:"right",formatter:function(e){return(0,f.hE)(e.data[1])+" ("+e.data[2]+")"}}}],dataZoom:[{yAxisIndex:[0],orient:"vertical",type:"slider",show:e.source.length>11,position:"right",right:"4%",width:7,backgroundColor:"#fff",borderColor:"#fff",textStyle:!1,handleColor:"rgba(213,218,224)",handleIcon:"path://M512,512m-448,0a448,448,0,1,0,896,0a448,448,0,1,0,-896,0Z",handleSize:"65%",fillerColor:"rgba(213,218,224)",startValue:0,endValue:10,showDataShadow:!1},{type:"inside",yAxisIndex:0,zoomOnMouseWheel:!1,moveOnMouseMove:!0,moveOnMouseWheel:!0}]},l)}(r,t,l,s):"table"===e?function(e,t,a,n,r){return{tableTitle:t,tableData:e,tableColumns:a,answerTotal:(0,f.hE)(n),answerRate:(100*r).toFixed(2)+"%"}}(o.tableData,o.tableTitle,o.tableColumns,o.answerTotal,o.answerRate):("exportData"===e&&i.length&&(0,C.aT)([i],t),null)},P.SINGLE_CHOICE=function(e){var t=e.data,a=e.title,n=e.resolveType,r=e.answerTotal,o=e.answerRate,i=e.showLabel,l=e.showTab,s=t.reduce((function(e,t){return e.push([t.optionName,t.answeredQuestion,(100*t.answeredQuestionProportion).toFixed(2)+"%"]),e}),[["\u9009\u9879","\u7b54\u9898\u6570\u91cf","\u5360\u6bd4"]]),c=s.slice(1).map((function(e,t){return{value:e[1],name:e[0]}})),u={dimensions:["item","count","rate"],source:s.slice(1)},d={tableTitle:"",tableData:t,tableColumns:[{title:"\u9009\u9879",dataIndex:"optionName",key:"optionName"},{title:"\u7b54\u9898\u6570\u91cf",dataIndex:"answeredQuestion",key:"answeredQuestion"},{title:"\u5360\u6bd4",dataIndex:"answeredQuestionProportion",key:"answeredQuestionProportion",render:function(e){return(100*e).toFixed(2)+"%"}}],answerTotal:r,answerRate:o},p=[["\u9009\u9879","\u7b54\u9898\u6570\u91cf","\u5360\u6bd4"]].concat(s.slice(1));return P.getTypeResult(n,a,c,u,d,p,i,l)},P.MULTIPLE_CHOICE=P.SINGLE_CHOICE,P.SEX=P.SINGLE_CHOICE,P.SCALE=function(e){var t=e.data,a=e.title,n=e.resolveType,r=e.answerTotal,o=e.answerRate,i=e.showLabel,l=e.showTab,s=["\u9009\u9879","\u7b54\u9898\u6570\u91cf","\u5360\u6bd4"],c=JSON.parse(JSON.stringify(t)),u=c.reduce((function(e,t){return e.push([t.optionName,t.answeredQuestion,(100*t.answeredQuestionProportion).toFixed(2)+"%"]),e}),[s]),d=u.slice(1).map((function(e,t){return{value:e[1],name:e[0]}})),p={dimensions:["item","count","rate"],source:u.slice(1)},m={tableTitle:"",tableData:c.reverse(),tableColumns:[{title:"\u9009\u9879",dataIndex:"optionName",key:"optionName"},{title:"\u7b54\u9898\u6570\u91cf",dataIndex:"answeredQuestion",key:"answeredQuestion"},{title:"\u5360\u6bd4",dataIndex:"answeredQuestionProportion",key:"answeredQuestionProportion",render:function(e){return(100*e).toFixed(2)+"%"}}],answerTotal:r,answerRate:o},f=[s].concat(u.slice(1).reverse());return p.source.reverse(),P.getTypeResult(n,a,d,p,m,f,i,l)},P.MATRIX_SINGLE_CHOICE=function(e){var t,a=e.data,n=e.title,r=e.resolveType,o=e.answerTotal,i=e.answerRate,l=e.showLabel,s=e.showTab,c=e.activityTab||a[0].optionName,u=(null==(t=a.find((function(e){return e.optionName===c})))?void 0:t.analysisUnitVOS)||[],d=u.length?u.reduce((function(e,t){return e.push([t.optionName,t.count,(100*t.proportion).toFixed(2)+"%"]),e}),[["\u9009\u9879","\u7b54\u9898\u6570\u91cf","\u5360\u6bd4"]]):[],p=d.slice(1).map((function(e,t){return{value:e[1],name:e[0]}})),m={dimensions:["item","count","rate"],source:d.slice(1)},f=[{title:"\u9898\u76ee/\u9009\u9879",dataIndex:"optionName",key:"\u9898\u76ee/\u9009\u9879",width:120,ellipsis:!0,fixed:"left"}];a.length&&a[0].analysisUnitVOS.forEach((function(e){f.push({title:e.optionName,dataIndex:e.optionName,key:e.optionName,width:120,ellipsis:!0,render:function(t,a){var n=a.analysisUnitVOS.find((function(t){return t.optionName===e.optionName}));return n?n.count+"("+(100*n.proportion).toFixed(2)+"%)":""}})}));var h={tableTitle:"",tableData:a,tableColumns:f,answerTotal:o,answerRate:i},y=a.reduce((function(e,t){var a=[t.optionName];return t.analysisUnitVOS.forEach((function(e){a.push(e.count+"("+(100*e.proportion).toFixed(2)+"%)")})),e.push(a),e}),[f.map((function(e){return e.title}))]);return P.getTypeResult(r,n,p,m,h,y,l,s)},P.NPS_SCORE=P.SCALE,P.MATRIX_MULTIPLE_CHOICE=P.MATRIX_SINGLE_CHOICE,P.MATRIX_SCALE=P.MATRIX_SINGLE_CHOICE,P.SATISFACTION=P.SCALE,P.SINGLE_PULL_DOWN=P.SINGLE_CHOICE;const L=P;var x=["type","data","loading","title","answeredQuestion","answeredQuestionProportion","thirdParty","serialNumber","onMoreClick"],Z=T.default.TabPane,M=[{title:"\u6761\u5f62\u56fe",value:"bar",icon:"icon-cem_bar-chart1"},{title:"\u5706\u73af\u56fe",value:"pie",icon:"icon-cem_pie-chart"}],F=["MATRIX_SINGLE_CHOICE","MATRIX_MULTIPLE_CHOICE","MATRIX_SCALE"],k=function(e){var t,a=e.changeTabs,n=e.data,r=(0,d.P)(n)?n:[];return r?i.createElement(T.default,{defaultActiveKey:(null==r||null==(t=r[0])?void 0:t.subQuestionName)||"",onChange:a},r&&r.map((function(e){return i.createElement(Z,{tab:(t=e.subQuestionName,t.length>8?i.createElement(u.default,{placement:"top",content:t,overlayClassName:"matrx-title-popover",mouseEnterDelay:.6},i.createElement("span",null,t.slice(0,8)+"...")):t),key:e.subQuestionName});var t}))):i.createElement(i.Fragment,null)};const z=function(e){var t=e.type,a=e.data,r=e.loading,o=e.title,l=e.answeredQuestion,s=e.answeredQuestionProportion,m=(e.thirdParty,e.serialNumber),f=(e.onMoreClick,(0,c.Z)(e,x)),h=(0,i.useState)(!0),y=h[0],E=h[1],g=(0,i.useState)(null),v=g[0],I=g[1],S=(0,i.useState)("pie"),T=S[0],b=S[1],D=(0,i.useState)(""),O=D[0],A=D[1],P=(0,i.useState)(null),Z=P[0],z=P[1],Q=F.includes(t);(0,i.useEffect)((function(){var e=(0,d.P)(a)?v&&L[t]&&L[t]({data:a,title:o,resolveType:T,answerTotal:l,answerRate:s,showLabel:y,showTab:Q,activityTab:O}):null;e&&v.setOption(e)}),[a,v,y,T,O,Q]),(0,i.useEffect)((function(){var e=(0,d.P)(a)&&L[t]&&L[t]({data:a,title:o,resolveType:"table",answerTotal:l,answerRate:s,showLabel:y});z(e)}),[a]);return i.createElement(d.Z,{className:"yt_research_answer_bar_table_chart quest_box_item",data:a,loading:r,renderTitle:i.createElement(p.Z,{title:o,data:a},i.createElement(_.Z,{options:M,activeObj:T,onChange:function(e){["pie","bar"].includes(e)&&e!==T&&(v&&v.clear(),b(e))},className:"chartType-select"}),i.createElement("div",{className:"icons"},i.createElement("div",{className:"icon"},i.createElement(u.default,{placement:"top",content:"\u663e\u793a\u56fe\u8868\u6807\u7b7e",mouseEnterDelay:.6,getPopupContainer:function(e){return e}},i.createElement("i",{className:"icon-tubiaobiaoqian "+(y?"active":""),onClick:function(){return E(!y)}}))),i.createElement("div",{className:"icon"},i.createElement(u.default,{placement:"top",content:"\u5bfc\u51fa\u6570\u636e",mouseEnterDelay:.6,getPopupContainer:function(e){return e}},i.createElement("i",{className:"icon-daochu",onClick:function(){return L[t]&&L[t]({data:a,title:o,resolveType:"exportData"})}}))),i.createElement("div",{className:"icon"},i.createElement(u.default,{placement:"top",content:"\u5bfc\u51fa\u56fe\u7247",mouseEnterDelay:.6},i.createElement("i",{className:"icon-xiazaitupian",onClick:function(){Q?w().toJpeg(document.getElementById("echart_box"+m),{quality:.95}).then((function(e){var t=document.createElement("a");t.download=o+".jpeg",t.href=e,t.click()})):v&&(0,C._v)(v,o)}})))))},i.createElement("div",{className:"answer_content"},i.createElement("div",{className:"echart_box",id:"echart_box"+m},Q&&i.createElement(k,{changeTabs:function(e){if(e===O)return!1;v&&v.clear(),A(e)},data:a}),i.createElement(N.Z,{theme:"yunting_multi_color",className:"content_chart",option:{},onChartReady:function(e){return I(e)}})),Z&&i.createElement(R,{tableOptions:Z,params:(0,n.Z)({type:t},f)})))};const Q=function(e){function t(t){var a;return(a=e.call(this,t)||this).state={},a}return(0,o.Z)(t,e),t.prototype.render=function(){var e=this.props,t=(e.questionId,e.type),a=e.id,r=e.userInfoData,o=e.userInfoLoading,l=(0,n.Z)({},this.props,this.state,this.event);switch(t){case"NPS_REASON":case"SATISFACTION_REASON":case"TEXT":case"TEXTAREA":case"NAME":case"PHONE":case"EMAIL":return i.createElement(S,(0,n.Z)({},l,{chartType:"reason",key:a,number:a,tableTitles:["\u7b54\u6848"],pageIndex:1,answeredQuestion:this.props["reasonData"+a]&&this.props["reasonData"+a].answeredQuestion,answeredQuestionProportion:this.props["reasonData"+a]&&this.props["reasonData"+a].answeredQuestionProportion,data:this.props["reasonData"+a]&&this.props["reasonData"+a].reasonList}));case"SORT":return i.createElement(S,(0,n.Z)({},l,{chartType:"SORT",key:a,number:a,answeredQuestion:this.props["optionsData"+a]&&this.props["optionsData"+a].answeredQuestion,answeredQuestionProportion:this.props["optionsData"+a]&&this.props["optionsData"+a].answeredQuestionProportion,data:this.props["optionsData"+a]&&this.props["optionsData"+a].optionList}));case"USER_INFO":return i.createElement(S,(0,n.Z)({},l,{chartType:"USER_INFO",key:a,tableTitles:["\u59d3\u540d","\u624b\u673a","\u90ae\u7bb1"],loading:o,data:r&&r.infoList,answeredQuestion:r&&r.answeredQuestion,answeredQuestionProportion:r&&r.answeredQuestionProportion}));default:return i.createElement(z,(0,n.Z)({},l,{serialNumber:a,key:a,loading:this.props["optionLoading"+a],answeredQuestion:this.props["optionsData"+a]&&this.props["optionsData"+a].answeredQuestion,answeredQuestionProportion:this.props["optionsData"+a]&&this.props["optionsData"+a].answeredQuestionProportion,data:this.props["optionsData"+a]&&this.props["optionsData"+a].optionList}))}},t}(i.PureComponent);const j=function(e){var t=e.questions;return i.createElement("div",{className:"yt_research_answerAnalyze_wrapper"},t&&t.map((function(t){return i.createElement(Q,(0,n.Z)({},e,{questionId:t.id,id:t.number,key:t.number,type:t.type,title:"Q"+t.number+"\uff1a"+t.title.replace("<p>","").replace("</p>","")}))})))};var U=a(35239),W=a(64396),q=a(55609),V=["loading"],G=W.Z.research.analyze.answer,H=function(e){function t(t){var a;return(a=e.call(this,t)||this).state={},a._event={},a}(0,o.Z)(t,e);var a=t.prototype;return a.active=function(e){var t=this,a=e.filterArgs,n=(e.title,e.questionnaireId),r=e.thirdParty,o=a[0];this.props.fetchQuestions({questionnaireId:n,projectId:U.t.get(U.V.curProject).id,filterModel:o.filterValue,dateFilter:o.dateFilter,thirdParty:r}).then((function(e){e&&e.forEach((function(e){"SINGLE_CHOICE"!==e.type&&"SINGLE_PULL_DOWN"!==e.type||t.props.fetchOptionChart({number:e.number,questionId:e.id,questionType:e.type}),"MULTIPLE_CHOICE"===e.type&&t.props.fetchMultipleOptionChart({number:e.number,questionId:e.id,questionType:e.type}),"NPS_SCORE"!==e.type&&"SATISFACTION"!==e.type&&"SEX"!==e.type&&"SCALE"!==e.type||t.props.fetchScoreChart({questionType:e.type,number:e.number,questionId:e.id}),"USER_INFO"===e.type&&t.props.fetchUserInfoChart({questionId:e.id,pageIndex:1,pageSize:10}),"SORT"===e.type&&t.props.fetchSortChart({number:e.number,questionId:e.id}),"NPS_REASON"!==e.type&&"SATISFACTION_REASON"!==e.type&&"TEXT"!==e.type&&"TEXTAREA"!==e.type&&"NAME"!==e.type&&"PHONE"!==e.type&&"EMAIL"!==e.type||t.props.fetchReasonChart({number:e.number,pageIndex:1,pageSize:10,questionId:e.id}),"MATRIX_SINGLE_CHOICE"!==e.type&&"MATRIX_MULTIPLE_CHOICE"!==e.type&&"MATRIX_SCALE"!==e.type||t.props.fetchMatrixChart({number:e.number,questionId:e.id,questionType:e.type})}))}))},a.componentDidMount=function(){this.props.clean()},a.render=function(){return i.createElement(j,(0,n.Z)({},this.props,this.state,this._event))},t}(i.PureComponent);const Y=(0,q.connect)((function(e){var t=e.loading,a=(0,c.Z)(e,V);return(0,n.Z)({},a[G],{loading:t.effects[G+"/fetchQuestions"]||!1,userInfoLoading:t.effects[G+"/fetchUserInfoChart"]||!1,reasonLoading:t.effects[G+"/fetchReasonChart"]||!1})}),(function(e){return{save:function(t){return e({type:G+"/save",payload:t})},fetchQuestions:function(t){return e({type:G+"/fetchQuestions",payload:t})},fetchScoreChart:function(t){return e({type:G+"/fetchScoreChart",payload:t})},fetchOptionChart:function(t){return e({type:G+"/fetchOptionChart",payload:t})},fetchMultipleOptionChart:function(t){return e({type:G+"/fetchMultipleOptionChart",payload:t})},fetchSortChart:function(t){return e({type:G+"/fetchSortChart",payload:t})},fetchUserInfoChart:function(t){return e({type:G+"/fetchUserInfoChart",payload:t})},fetchReasonChart:function(t){return e({type:G+"/fetchReasonChart",payload:t})},fetchMatrixChart:function(t){return e({type:G+"/fetchMatrixChart",payload:t})},clean:function(t){return e({type:G+"/clean",payload:t})}}}),null,{withRef:!0})(H);var B=a(61918),X=a(71339),K=a(30381),J=a.n(K),$=a(61193),ee={SATISFACTION:["\u6ee1\u610f\u5ea6\u5206\u503c","satisfactionScore"],NPS_SCORE:["NPS\u5206\u503c","npsScore"],NPS_REASON:["NPS\u539f\u56e0\u9898","npsReason"],SATISFACTION_REASON:["\u6ee1\u610f\u5ea6\u539f\u56e0\u9898","satisfactionReason"]},te=function(e){return i.createElement("div",{style:{maxWidth:260}},e)};const ae=function(e){var t=e.save,a=e.visible,n=e.questions,r=e.keyword,o=e.reasonKeyword,s=e.data,c=e.loading,u=e.pageIndex,d=e.pageSize,p=e.onExport,h=e.onSearchChange,y=e.onKeywordChange,E=e.onPageChange,g=e.onPageSizeChange,v=e.thirdParty,I=$.Z.hasAuthority("ANSWER_DETAIL_SHOWINFO_ALL")?"showAll":$.Z.hasAuthority("ANSWER_DETAIL_SHOWINFO_PART")?"showPart":"hide",C=[{label:i.createElement("span",null,"\u5ba2\u6237\u540d\u79f0",i.createElement(m.Z,{overlay:te("\u5ba2\u6237\u59d3\u540d\u53d6\u81ea\u8054\u7cfb\u4eba\u6a21\u5757\uff0c\u53ef\u80fd\u4f1a\u4e0e\u95ee\u5377\u6536\u96c6\u56de\u6765\u7684\u4fe1\u606f\u4e00\u81f4\u3002"),placement:"top"},i.createElement("i",{className:"icon-cem_file1",style:{color:"#979797",marginLeft:"4px"}}))),prop:"contactName",minWidth:110,render:function(e){var t=e.contactName,a=e.phoneNumber,n=e.email;if(t){var r=(0,f.Nn)({username:t,phoneNumber:a,email:n},I),o=r.username,l=r.phoneNumber,s=r.email;return i.createElement(m.Z,{overlay:te(i.createElement(i.Fragment,null,i.createElement("p",null,i.createElement("span",{style:{color:"#8c8c8c"}},"\u59d3\u540d\uff1a"),o),i.createElement("p",null,i.createElement("span",{style:{color:"#8c8c8c"}},"\u624b\u673a\uff1a"),l),i.createElement("p",null,i.createElement("span",{style:{color:"#8c8c8c"}},"\u90ae\u7bb1\uff1a"),s))),placement:"top"},i.createElement("span",null,o))}return"--"}},{label:i.createElement("span",null,"\u63d0\u4ea4\u65f6\u95f4",i.createElement(m.Z,{overlay:te("\u5982\u679c\u81f3\u5b8c\u6574\u7b54\u9898\u6709\u591a\u6b21\u6784\u6210\uff0c\u5219\u63d0\u4ea4\u65f6\u95f4\u5c55\u793a\u6700\u65b0\u63d0\u4ea4\u7684\u65f6\u95f4"),placement:"top"},i.createElement("i",{className:"icon-cem_file1",style:{color:"#979797",marginLeft:"4px"}}))),prop:"cTime",minWidth:110,render:function(e){return i.createElement("span",null,J()(e.cTime).format("YYYY-MM-DD"))}},{label:i.createElement("span",null,"\u7b54\u5377\u72b6\u6001",i.createElement(m.Z,{overlay:i.createElement("a",{style:{color:"#0847a6"},href:"https://www.yuque.com/docs/share/60ce57e7-38b9-415b-90a2-67121a0278b2?# \u300a\u7b54\u5377\u72b6\u6001\u8bf4\u660e\u300b",target:"_blank",rel:"noopener noreferrer"},"\u4e86\u89e3\u66f4\u591a"),placement:"top"},i.createElement("i",{className:"icon-cem_file1",style:{color:"#979797",marginLeft:"4px"}}))),prop:"status",minWidth:90,visible:!v,render:function(e){return i.createElement("div",{className:"status"},"SUBMITTED"===e.status?"\u5df2\u63d0\u4ea4":"FULL_SUBMITTED"===e.status?"\u5b8c\u6574\u7b54\u5377":"")}}];return n&&n.forEach((function(e){"SATISFACTION"!==e.type&&"NPS_SCORE"!==e.type&&"NPS_REASON"!==e.type&&"SATISFACTION_REASON"!==e.type||C.push({label:"Q"+e.number+"\uff1a"+ee[e.type][0],prop:ee[e.type][1],minWidth:"NPS_REASON"===e.type||"SATISFACTION_REASON"===e.type?110:90,render:function(t){return"NPS_REASON"===e.type||"SATISFACTION_REASON"===e.type?i.createElement(m.Z,{placement:"top",overlay:te(t[""+ee[e.type][1]])},i.createElement("div",{className:"reason_content ellipsis"},t[""+ee[e.type][1]])):i.createElement("div",null,t[""+ee[e.type][1]])}})})),C=(C=C.concat([{label:"\u6d4f\u89c8\u5668",prop:"browser",minWidth:90},{label:"\u8bbe\u5907\u4fe1\u606f",prop:"device",minWidth:90},{label:"ip\u5730\u5740",prop:"ip",minWidth:90}])).filter((function(e){return!("visible"in e)||e.visible})),i.createElement("div",{className:"yt_research_answer_detail_wrapper"},i.createElement("div",{className:"content"},i.createElement("div",{className:"research_answer_detail_search_zone"},i.createElement(B.Z,{style:{width:200},placeholder:"\u59d3\u540d\u3001\u90ae\u7bb1\u3001\u624b\u673a",defValue:r,onSearch:h,onClear:h}),i.createElement(B.Z,{style:{width:200},placeholder:"\u539f\u56e0\u9898\u4e2d\u7684\u5173\u952e\u8bcd",defValue:o,onSearch:y,onClear:y}),i.createElement("span",null,$.Z.hasAuthority("EXPORT_ANSWER_DATA")&&i.createElement(l.Button,{type:"primary",onClick:p},"\u5bfc\u51fa"))),i.createElement(X.Z,{columns:C,data:s&&s.list instanceof Array?s.list:[],total:s?s.total:0,loading:!s||c,pageSize:d,pageIndex:u,onPageChange:E,onPageSizeChange:g}),i.createElement(l.Dialog,{className:"research_anserDetail_export_dialog",size:"tiny",title:"\u6b63\u5728\u5bfc\u51fa\u4e2d...",visible:a,lockScroll:!0,onCancel:function(){t({visible:!1})}},i.createElement(l.Dialog.Body,null,i.createElement("div",{className:"after-download-tips"},i.createElement("div",null,"\u8bf7\u7a0d\u540e\u67e5\u770b",i.createElement("a",{target:"_blank",style:{color:"#0847a6"},rel:"noopener noreferrer",href:"/personalSettings/download"},"\u5bfc\u51fa\u8bb0\u5f55")),i.createElement("div",null,"\u5bfc\u51fa\u5b8c\u6210\u540e\uff0c\u4e5f\u53ef\u4ece\u53f3\u4e0a\u89d2\u7684\u6d88\u606f\u5904\u4e0b\u8f7d\u5bfc\u51fa\u6570\u636e"))),i.createElement(l.Dialog.Footer,null,i.createElement(l.Button,{type:"primary",onClick:function(){t({visible:!1})}},"\u786e\u5b9a"),i.createElement(l.Button,{onClick:function(){t({visible:!1})}},"\u53d6\u6d88")))))};var ne=["loading"],re=W.Z.research.analyze.answerDetail,oe=function(e){function t(t){var a;return(a=e.call(this,t)||this)._handleOnExport=function(){var e=a.props,t=e.questionnaireId,n=e.reasonKeyword,r=e.keyword;a.props.exportQuestionnaire({questionnaireId:t,reasonKeyword:n,keyword:r})},a._handleOnSearchChange=function(e){var t=a.props,n=t.reasonKeyword;(0,t.fetchDetailList)({keyword:e,reasonKeyword:n,pageIndex:1})},a._handleOnKeywordChange=function(e){var t=a.props,n=t.keyword;(0,t.fetchDetailList)({keyword:n,reasonKeyword:e,pageIndex:1})},a._handleOnPageChange=function(e){var t=a.props,n=t.reasonKeyword,r=t.keyword;(0,t.fetchDetailList)({pageIndex:e,reasonKeyword:n,keyword:r})},a._handleOnPageSizeChange=function(e){var t=a.props,n=t.reasonKeyword,r=t.keyword;(0,t.fetchDetailList)({pageSize:e,pageIndex:1,reasonKeyword:n,keyword:r})},a.state={},a._event={onExport:a._handleOnExport,onSearchChange:a._handleOnSearchChange,onKeywordChange:a._handleOnKeywordChange,onPageChange:a._handleOnPageChange,onPageSizeChange:a._handleOnPageSizeChange},a}(0,o.Z)(t,e);var a=t.prototype;return a.active=function(e){var t=e.filterArgs,a=(e.title,e.questionnaireId),n=e.thirdParty,r=t[0];this.props.fetchQuestions({projectId:U.t.get(U.V.curProject).id,filterModel:r.filterValue,dateFilter:r.dateFilter,questionnaireId:a,keyword:"",reasonKeyword:"",thirdParty:n})},a.componentWillUnmount=function(){this.props.clean()},a.render=function(){return i.createElement(ae,(0,n.Z)({},this.props,this.state,this._event))},t}(i.PureComponent);const ie=(0,q.connect)((function(e){var t=e.loading,a=(0,c.Z)(e,ne);return(0,n.Z)({},a[re],{loading:t.effects[re+"/fetchDetailList"]||!1})}),(function(e){return{save:function(t){return e({type:re+"/save",payload:t})},fetchQuestions:function(t){return e({type:re+"/fetchQuestions",payload:t})},fetchDetailList:function(t){return e({type:re+"/fetchDetailList",payload:t})},exportQuestionnaire:function(t){return e({type:re+"/exportQuestionnaire",payload:t})},clean:function(t){return e({type:re+"/clean",payload:t})}}}),null,{withRef:!0})(oe);var le=a(45697),se=a.n(le),ce=function(e){var t=e.data,a=e.total,n=e.loading,r=e.pageIndex,o=e.pageSize,l=e.onPageChange,s=i.useState([]),c=s[0],u=s[1];return i.useEffect((function(){if(t){var e=[{label:"\u5206\u53d1\u65f6\u95f4",render:function(e){var t=e.sendTime;return J()(t).format("YYYY-MM-DD HH:mm")}},{label:i.createElement("span",null,"\u53d1\u9001\u95ee\u5377\u6570(\u56de\u6536\u7387)",i.createElement(m.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:"\u56de\u6536\u7387 = \u63d0\u4ea4\u95ee\u5377\u6570 \xf7 \u53d1\u9001\u95ee\u5377\u6570"},i.createElement("i",{className:"icon-cem_file1",style:{marginLeft:4}}))),render:function(e){var t=e.sendCount,a=e.recoveryRate;return i.createElement("span",null,i.createElement("span",{style:{paddingRight:8}},t),"(",(100*a).toFixed(2)+"%",")")}},{label:i.createElement("span",null,"\u53d1\u9001\u6210\u529f\u6570(\u6210\u529f\u7387)",i.createElement(m.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:"\u6210\u529f\u7387 = \u53d1\u9001\u6210\u529f\u6570 \xf7 \u53d1\u9001\u95ee\u5377\u6570"},i.createElement("i",{className:"icon-cem_file1",style:{marginLeft:4}}))),render:function(e){var t=e.successCount,a=e.successRate;return i.createElement("span",null,i.createElement("span",{style:{paddingRight:8}},t),"(",(100*a).toFixed(2)+"%",")")}},{label:i.createElement("span",null,"\u6253\u5f00\u95ee\u5377\u6570(\u6253\u5f00\u7387)",i.createElement(m.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:"\u6253\u5f00\u7387 = \u6253\u5f00\u95ee\u5377\u6570 \xf7 \u53d1\u9001\u6210\u529f\u6570"},i.createElement("i",{className:"icon-cem_file1",style:{marginLeft:4}}))),render:function(e){var t=e.openCount,a=e.openRate;return i.createElement("span",null,i.createElement("span",{style:{paddingRight:8}},t),"(",(100*a).toFixed(2)+"%",")")}},{label:i.createElement("span",null,"\u63d0\u4ea4\u95ee\u5377\u6570(\u63d0\u4ea4\u7387)",i.createElement(m.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:"\u63d0\u4ea4\u7387 = \u63d0\u4ea4\u95ee\u5377\u6570 \xf7 \u6253\u5f00\u95ee\u5377\u6570"},i.createElement("i",{className:"icon-cem_file1",style:{marginLeft:4}}))),render:function(e){var t=e.submittedCount,a=e.submittedRate;return i.createElement("span",null,i.createElement("span",{style:{paddingRight:8}},t),"(",(100*a).toFixed(2)+"%",")")}},{label:i.createElement("span",null,"\u5b8c\u6574\u7b54\u9898\u6570(\u7b54\u9898\u7387)",i.createElement(m.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:"\u7b54\u9898\u7387 = \u5b8c\u6574\u7b54\u9898\u6570 \xf7 \u63d0\u4ea4\u95ee\u5377\u6570"},i.createElement("i",{className:"icon-cem_file1",style:{marginLeft:4}}))),render:function(e){var t=e.fullSubmittedCount,a=e.fullSubmittedRate;return i.createElement("span",null,i.createElement("span",{style:{paddingRight:8}},t),"(",(100*a).toFixed(2)+"%",")")}}];t.reduce((function(e,t){return t.type&&t.type.length>e.length&&!t.type.includes("NORMAL")?t.type:e}),[]).forEach((function(t,a){e.splice(a+1,0,{label:"NPS"===t?"NPS\u5206\u503c":"\u6ee1\u610f\u5ea6",render:function(e){var a=e.npsScore,n=e.satisfactionScore;return"NPS"===t?a||"--":n?n.toFixed(2):"--"}})})),u(e)}}),[t]),i.createElement("div",{className:"yt_research_record_analysis_wrapper"},i.createElement(d.Z,{data:t,className:"record_content",loading:n},i.createElement(X.Z,{columns:c,data:(0,d.P)(t)?t:[],total:a,loading:!1,pageIndex:r,pageSize:o,onPageChange:function(e){return l({pageIndex:e})},onPageSizeChange:function(e){return l({pageSize:e})}})))};const ue=ce;ce.propTypes={data:se().any,loading:se().bool,pageIndex:se().number,pageSize:se().number,onPageChange:se().func,total:se().number};var de=["loading"],pe=W.Z.research.analyze.record,me=function(e){function t(t){var a;return(a=e.call(this,t)||this)._handleOnPageChange=function(e){a.props.fetchRecordList(e)},a.state={},a.event={onPageChange:a._handleOnPageChange},a}(0,o.Z)(t,e);var a=t.prototype;return a.active=function(e){e.filterArgs,e.title;var t=e.questionnaireId;this.props.fetchRecordList({questionnaireId:t,projectId:U.t.get(U.V.curProject).id})},a.componentWillUnmount=function(){this.props.clear()},a.render=function(){return i.createElement(ue,(0,n.Z)({},this.props,this.state,this.event))},t}(i.PureComponent);const fe=(0,q.connect)((function(e){var t=e.loading,a=(0,c.Z)(e,de);return(0,n.Z)({},a[pe],{loading:t.effects[pe+"/fetchRecordList"]||!1})}),(function(e){return{fetchRecordList:function(t){return e({type:pe+"/fetchRecordList",payload:t})},clear:function(t){return e({type:pe+"/clear",payload:t})}}}),null,{withRef:!0})(me);var he=a(15861),ye=a(87757),Ee=a.n(ye),ge=a(87219),ve=a(2329),Ie=a(69719),Ce=a(83118),Se=a(76214),Te=a(70715),Ne=10;const be=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).chartRef=void 0,t.graphData={categories:[],links:[],data:[]},t.graphData=void 0,t.sunburstData=void 0,t.title=void 0,t.getChartRef=function(e){return t.chartRef=e},t.setValue=function(e){var a=e.sort((function(e,t){return t.count-e.count})).slice(0,50).reduce((function(e,t,a){var n=e.find((function(e){return e.name===t.secondWord}));return n?(n.value+=t.count,n.children.push({id:"f"+a,name:t.firstWord,value:t.count,itemStyle:n.itemStyle})):(t.count,e.push({id:"s"+a,name:t.secondWord,value:t.count,itemStyle:{color:Te.GY[a%Te.GY.length]},children:[{id:"f"+a,name:t.firstWord,value:t.count,itemStyle:{color:Te.GY[a%Te.GY.length]}}]})),e}),[]),n=a.map((function(e){return e.value})),r=a.map((function(e){return e.name})),o=Math.max.apply(null,n),i=Math.min.apply(null,n),l=[],s=a.reduce((function(e,t,a){var n=o===i?Ne:(t.value-i)/(o-i)*40+Ne;return e.push({id:t.id,name:t.name,value:t.value,category:a,symbolSize:n,itemStyle:{color:Te.GY[0]},label:{show:!0,fontSize:10,color:"#262626"}}),t.children.forEach((function(r){l.push({source:r.id,target:t.id}),e.push({id:r.id,name:r.name,value:r.value,category:a,symbolSize:n*r.value/t.value,itemStyle:{color:Te.GY[1]},label:{show:!0,fontSize:10,color:"#262626"}})})),e}),[]);t.graphData={links:l,data:s,categories:r},t.sunburstData=a},t.getGraphOption=function(e,t,a){return{title:{text:e},tooltip:{},series:[{type:"graph",layout:a,roam:!0,draggable:!0,force:{initLayout:"circular",repulsion:100,gravity:.2,edgeLength:[50,100]},data:t.data,links:t.links,categories:t.categories,focusNodeAdjacency:!0,itemStyle:{borderColor:"#fff",borderWidth:1,shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.1)"},label:{position:"right",formatter:"{b}"},lineStyle:{curveness:"circular"===a?.3:0},emphasis:{lineStyle:{width:5}}}]}},t}(0,o.Z)(t,e);var a=t.prototype;return a.renderChart=function(e,t,a){this.setValue(e),this.title=t,this.changeChartType(a)},a.changeChartType=function(e){var t={};t="sunburst"===e?this.getSunburstOption(this.title,this.sunburstData):this.getGraphOption(this.title,this.graphData,e),this.chartRef.clear(),this.chartRef.setOption(t)},a.getSunburstOption=function(e,t){return{title:{text:e},tooltip:{},series:{type:"sunburst",highlightPolicy:"ancestor",data:t,levels:[{},{r0:"27%",r:"61%",label:{}},{r0:"62%",r:"67%",label:{position:"outside",color:"#262626"}}],emphasis:{label:{rotate:"radial",formatter:"{b}\uff08{@score}\uff09",fontSize:10}},label:{rotate:"radial",formatter:"{b}\uff08{@score}\uff09",fontSize:10},itemStyle:{color:"#ddd",borderWidth:2}}}},t}(i.PureComponent);var we=a(33798),_e=function(e){function t(t){var a;return(a=e.call(this,t)||this).handleOnMoreClick=function(e){var t=a.props,n=t.title,r=t.data;"image"===e&&a.chartRef?(0,C._v)(a.chartRef,n):"data"===e&&(0,d.P)(r)&&(0,C.aT)([r.reduce((function(e,t){return e.push([t.firstWord,t.secondWord,t.count]),e}),[["\u5173\u952e\u8bcd","\u5c5e\u6027","\u5173\u7cfb\u6570"]])],n)},a.state={chartType:"sunburst"},a}(0,o.Z)(t,e);var a=t.prototype;return a.componentDidMount=function(){this.renderChart()},a.componentDidUpdate=function(t,a){var n=t.data,r=this.props.data;(0,d.P)(r)&&JSON.stringify(n)!==JSON.stringify(r)&&this.renderChart(),!(0,d.P)(r)&&this.chartRef&&(this.chartRef=void 0),(0,d.P)(r)&&a.chartType!==this.state.chartType&&e.prototype.changeChartType.call(this,this.state.chartType)},a.renderChart=function(){var t=this.props,a=t.data,n=t.title,r=this.state.chartType;(0,d.P)(a)&&this.chartRef&&e.prototype.renderChart.call(this,a,n,r)},a.render=function(){var e=this,t=this.props,a=t.data,n=t.loading,r=t.title,o=t.titleOverlay,l=t.refreshTime,s=t.onRefresh,c=this.state.chartType;return i.createElement(d.Z,{className:"yt_research_text_analysis_relation_chart",data:a,loading:n,renderTitle:i.createElement(p.Z,{title:r,titleOverlay:o,data:a},i.createElement(m.Z,{placement:"top",overlay:i.createElement("div",null,i.createElement("div",null,"\u6570\u636e\u66f4\u65b0\u4e8e"),i.createElement("div",null,J()(l).format("YYYY-MM-DD HH:mm:ss")))},i.createElement("span",{onClick:s,className:"refresh"},i.createElement("i",{className:"icon-cem_auto-refresh "+(n?"icon_loading":"")}))),i.createElement("span",{className:"divider"}),i.createElement(m.Z,{placement:"top",overlay:"\u5173\u7cfb\u56fe"},i.createElement("span",{onClick:function(){return e.setState({chartType:"force"})}},i.createElement(we.Z,{isActive:"force"===c,defaultIcon:"cem_relation-diagram-gray",activeIcon:"cem_relation-diagram"}))),i.createElement(m.Z,{placement:"top",overlay:"\u65ed\u65e5\u56fe"},i.createElement("span",{onClick:function(){return e.setState({chartType:"sunburst"})}},i.createElement(we.Z,{isActive:"sunburst"===c,defaultIcon:"cem_asahi-chart--gray",activeIcon:"cem_asahi-chart"}))),i.createElement("span",{className:"divider"}),i.createElement("div",{className:"icons"},i.createElement("div",{className:"icon"},i.createElement(m.Z,{placement:"top",overlay:"\u5bfc\u51fa\u6570\u636e"},i.createElement("i",{className:"icon-daochu",onClick:function(){return e.handleOnMoreClick("data")}}))),i.createElement("div",{className:"icon"},i.createElement(m.Z,{placement:"top",overlay:"\u5bfc\u51fa\u56fe\u7247"},i.createElement("i",{className:"icon-xiazaitupian",onClick:function(){return e.handleOnMoreClick("image")}})))))},i.createElement(N.Z,{onChartReady:this.getChartRef,theme:"yt_multi_color_20",option:{},style:{height:"100%"}}))},t}(be);_e.propTypes={data:se().any,titleOverlay:se().oneOf([se().string,se().node]),title:se().string,loading:se().bool,onRefresh:se().func,refreshTime:se().string};const De=_e;var Oe=a(18077);const Ae=function(e){var t=e.onFilterChange,a=e.onMsgClick,n=e.fetchingFeedbackData,r=e.feedbackData,o=e.feedbackEnablePos,l=e.fetchingHotwordData,s=e.hotwordData,c=e.hotwordEnablePos,u=e.fetchEmotionsLoading,d=e.emotionsData,p=e.emotionsTimeType,m=e.emotionsTrendCountType,f=e.dateOptions,h=e.relativeData,y=e.relativeRefreshTime,E=e.relativeDataLoading,g=e.fetchHotwordData,v=e.fetchFeedbackData,I=i.useState({visible:!1,word:""}),C=I[0],S=I[1],T=(0,i.useCallback)((function(e){S({visible:!0,word:e})}),[]),N=(0,i.useCallback)((function(e){S({visible:e,word:""}),g({}),v({})}),[]);return i.createElement("div",{className:"yt_research_text_analysis_wrapper"},i.createElement("div",{className:"content"},i.createElement(Se.Z,{loading:u,chartData:d,title:"\u60c5\u611f\u5206\u5e03\u548c\u8d70\u52bf",subTitle:"\uff08\u6765\u81ea\u6709\u6548\u6d88\u606f\uff09",cCountType:m,ctimeType:p,onTimeTypeChange:t,onMsgClick:a,dateOptions:f}),i.createElement(Ie.Z,{title:"\u7528\u6237\u53cd\u9988\u70ed\u8bcd",data:r,loading:n,enablePos:o,onFilterChange:t,onWordModalView:T,onMsgClick:a,titleWords:"\u6d88\u606f"}),i.createElement(Ce.Z,{title:"\u70ed\u8bcd",data:s,loading:l,enablePos:c,onFilterChange:t,onWordModalView:T,onMsgClick:a,titleWords:"\u6d88\u606f"}),i.createElement(De,{title:"\u8bcd\u7ec4\u5173\u8054\u5173\u7cfb\u5206\u6790",data:h,loading:E,refreshTime:y}),i.createElement(Oe.Z,{visible:C.visible,word:C.word,onClose:N})))};var Re=a(90549),Pe=["loading"],Le=W.Z.research.analyze.text,xe=function(e){function t(t){var a;return(a=e.call(this,t)||this).events=void 0,a._handleOnWsMessage=function(e){var t=e.data;if(t.type&&"ws"===t.type){var n=t.payload,r=n.type,o=n.result;"QUESTIONNAIRE_TEXT_RESULT"===r&&a.props.save({relativeData:o.data.length?o.data:"empty",relativeRefreshTime:o.createdAt,relativeDataLoading:!1})}},a._handleOnFilterChange=function(e){e.starTrendCountType?a.props.save(e):e.starTrendTimeType?a.props.fetchStarTrendData(e):void 0!==e.feedbackEnablePos?a.props.fetchFeedbackData({feedbackEnablePos:e.feedbackEnablePos}):void 0!==e.hotwordEnablePos?a.props.fetchHotwordData({hotwordEnablePos:e.hotwordEnablePos}):void 0!==e.emotionsTimeType&&(a.props.save({emotionsTimeType:e.emotionsTimeType}),a.props.fetchEmotionsData({dateFilter:(0,n.Z)({},a.props.dateFilter,{dateGroupType:e.emotionsTimeType})}))},a._handleOnMsgClick=function(){var e=(0,he.Z)(Ee().mark((function e(t,r){var o,i,l,s,c,u,d,p,m,f;return Ee().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.props,o.headerFilterParamsNew,i=o.filterModel,l=o.projectId,s=o.dateFilter,o.dateGroupType,c=o.workData,o.conversationData,u=o.emotionsTimeType,d=o.emotionsData,p=o.thirdParty,m=o.questionnaireId,f={dateFilter:s,projectId:l,headerFilterParamsNew:i,filterModel:{messageCategory:["QUESTIONAIRE"]},filterTip:null},"\u5de5\u5355\u6570\u91cf"===r&&(f=(0,n.Z)({},f,{dateFilter:(0,ve.X_)("line",s,t.name,c.data.map((function(e){return e.name})),"DAY")})),"\u54a8\u8be2\u91cf"===r&&(f=(0,n.Z)({},f,{dateFilter:(0,ve.X_)("line",s,t.name,c.data.map((function(e){return e.name})),"DAY"),fromScene:"VoiceComment"})),"\u7528\u6237\u53cd\u9988\u70ed\u8bcd"===r&&(f=(0,n.Z)({},f,{headerFilterParamsNew:(0,ge.ZP)(f.headerFilterParamsNew,(function(e){var a=e.find((function(e){return"DEFAULT"===e.id}));a?a.values.push({id:"EMOTION_TYPE",values:[t.seriesName]}):e.push({id:"DEFAULT",values:[{id:"EMOTION_TYPE",label:"\u6d88\u606f\u60c5\u611f",values:[t.seriesName]}]},{values:[{values:p?["THIRD_PARTY"]:["SYSTEM"],id:"QUESTIONNAIRE_SOURCE"},{id:"QUESTION_NAME",values:[m]}],id:"QUESTIONNAIRE_RELATED"})})),textRankWord:t.name,textRankWordPos:t.data.pos,filterModel:{project:[l]}})),"\u70ed\u8bcd\uff08\u6765\u81ea\u6709\u6548\u6d88\u606f\uff09"===r&&(f=(0,n.Z)({},f,{textRankWord:t.name,textRankWordPos:t.data.pos,filterModel:{project:[l]},headerFilterParamsNew:(0,ge.ZP)(f.headerFilterParamsNew,(function(e){var a=e.find((function(e){return"DEFAULT"===e.id}));a?a.values.push({id:"EMOTION_TYPE",values:t.data.emotion}):e.push({values:[{values:p?["THIRD_PARTY"]:["SYSTEM"],id:"QUESTIONNAIRE_SOURCE"},{id:"QUESTION_NAME",values:[m]}],id:"QUESTIONNAIRE_RELATED"})}))})),"TOP10\u70ed\u8bcd\uff08\u6765\u81ea\u6709\u6548\u6d88\u606f\uff09"===r&&(f="label"===t.name?(0,n.Z)({},f,{headerFilterParamsNew:(0,ge.ZP)(f.headerFilterParamsNew,(function(e){var a=e.find((function(e){return"DEFAULT"===e.id}));a?a.values.push({id:"EMOTION_TYPE",values:t.data.emotion}):e.push({values:[{values:p?["THIRD_PARTY"]:["SYSTEM"],id:"QUESTIONNAIRE_SOURCE"},{id:"QUESTION_NAME",values:[m]}],id:"QUESTIONNAIRE_RELATED"})})),textRankWord:t.seriesName,textRankWordPos:t.data.pos,filterModel:{project:[l]}}):(0,n.Z)({},f,{headerFilterParamsNew:(0,ge.ZP)(f.headerFilterParamsNew,(function(e){var a=e.find((function(e){return"DEFAULT"===e.id}));a?a.values.push({id:"EMOTION_TYPE",values:t.data.emotion}):e.push({id:"DEFAULT",values:[{id:"EMOTION_TYPE",label:"\u6d88\u606f\u60c5\u611f",values:t.data.emotion}]},{values:[{values:p?["THIRD_PARTY"]:["SYSTEM"],id:"QUESTIONNAIRE_SOURCE"},{id:"QUESTION_NAME",values:[m]}],id:"QUESTIONNAIRE_RELATED"})})),textRankWord:t.seriesName,textRankWordPos:t.data.pos,filterModel:{project:[l]}})),"\u60c5\u611f\u5206\u5e03\u548c\u8d70\u52bf\uff08\u6765\u81ea\u6709\u6548\u6d88\u606f\uff09"===r&&("bar"===t.seriesType&&(f.dateFilter=(0,ve.X_)("line",s,t.data.originTime.replace(/\//g,"-"),d.find((function(e){return e.total>0})).dataList.map((function(e){return e.time})),u)),f=(0,n.Z)({},f,{headerFilterParamsNew:(0,ge.ZP)(f.headerFilterParamsNew,(function(e){var a=e.find((function(e){return"DEFAULT"===e.id}));a?a.values.push({id:"EMOTION_TYPE",values:[t.eomtionsType]}):e.push({id:"DEFAULT",values:[{id:"EMOTION_TYPE",label:"\u6d88\u606f\u60c5\u611f",values:[t.eomtionsType]}]},{values:[{values:p?["THIRD_PARTY"]:["SYSTEM"],id:"QUESTIONNAIRE_SOURCE"},{id:"QUESTION_NAME",values:[m]}],id:"QUESTIONNAIRE_RELATED"})})),filterModel:{project:[l]}})),e.next=11,Re.Z.delete(Re.Z.store.queryParams,"research_manage_analysis");case 11:return e.next=13,Re.Z.add(Re.Z.store.queryParams,(0,n.Z)({queryParamsId:"research_manage_analysis"},f));case 13:window.open("/inbox/questionnaire?"+encodeURIComponent(JSON.stringify({queryParamsId:"research_manage_analysis"})));case 14:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),a.events={onFilterChange:a._handleOnFilterChange,onMsgClick:a._handleOnMsgClick},a}(0,o.Z)(t,e);var a=t.prototype;return a.active=function(e){var t=e.filterArgs,a=(e.title,e.questionnaireId),n=e.questionnaireBoardId,r=t[0],o=(t[1],t[2]);this.props.fetchDatas({filterModel:r.filterValue,dateFilter:r.dateFilter,dateOptions:o.dateOptions,emotionsTimeType:o.defaultDateType,projectId:U.t.get(U.V.curProject).id,questionnaireId:a,questionnaireBoardId:n})},a.componentDidMount=function(){window.addEventListener("message",this._handleOnWsMessage)},a.componentWillUnmount=function(){window.removeEventListener("message",this._handleOnWsMessage),this.props.clean()},a.render=function(){return i.createElement(Ae,(0,n.Z)({},this.props,this.state,this.events))},t}(i.Component);const Ze=(0,q.connect)((function(e){var t=e.loading,a=(0,c.Z)(e,Pe);return(0,n.Z)({},a[Le],{fetchingWorkData:t.effects[Le+"/fetchWorkData"]||!1,fetchingConversationData:t.effects[Le+"/fetchConversationData"]||!1,fetchingFeedbackData:t.effects[Le+"/fetchFeedbackData"]||!1,fetchingHotwordData:t.effects[Le+"/fetchHotwordData"]||!1,fetchEmotionsLoading:t.effects[Le+"/fetchEmotionsData"]||!1})}),(function(e){return{save:function(t){return e({type:Le+"/save",payload:t})},clean:function(){return e({type:Le+"/clean"})},fetchDatas:function(t){return e({type:Le+"/fetchDatas",payload:t})},fetchWorkData:function(t){return e({type:Le+"/fetchWorkData",payload:t})},fetchConversationData:function(t){return e({type:Le+"/fetchConversationData",payload:t})},fetchFeedbackData:function(t){return e({type:Le+"/fetchFeedbackData",payload:t})},fetchHotwordData:function(t){return e({type:Le+"/fetchHotwordData",payload:t})},fetchEmotionsData:function(t){return e({type:Le+"/fetchEmotionsData",payload:t})}}}),void 0,{withRef:!0})(xe);var Me=a(87920),Fe=a(55363),ke=a(8833);const ze=function(e){function t(t){var a;(a=e.call(this,t)||this)._handleRefs=function(e,t){t&&(a.viewRefs[e]=t.wrappedInstance)},a._handleOnTabClick=function(e){var t=a.props.location.state,r=a.viewRefs[e.props.name];r&&r.active((0,n.Z)({filterArgs:a.filterArgs},t)),a.setState({activeView:e.props.name})};var o,i=t.location.state,l=i.questionnaireId,s=i.title,c=i.questionnaireType,u=i.thirdParty,d=i.jumpType,p=1===c.length?"RESEARCH_"+c[0]:"RESEARCH_ALL";return o=d&&"analysis"===d?"4":"RESEARCH_ALL"===p||"RESEARCH_NPS"===p?"1":"RESEARCH_SATISFACTION"===p?"2":"3",a.state={thirdParty:u,pageType:p,activeView:o,titles:[{title:"\u95ee\u5377\u7ba1\u7406",url:"/research/manage"},{title:s,url:"",state:{id:l,title:s,questionnaireType:c}},{title:"\u6570\u636e\u5206\u6790",url:""}]},a.viewRefs={},a.filterArgs=void 0,a._handleOnFilterChange=a.handleOnFilterChange.bind((0,r.Z)(a)),a}(0,o.Z)(t,e);var a=t.prototype;return a.componentWillUnmount=function(){this.viewRefs={},this.filterArgs=void 0},a.handleOnFilterChange=function(){this.filterArgs=Array.from(arguments),this.filterArgs,this._handleOnTabClick({props:{name:this.state.activeView}})},a.render=function(){var e=this,t=this.state,a=t.titles,n=t.activeView,r=t.pageType,o=t.thirdParty;return i.createElement(ke.Z,{className:"yt_research_analyasis_wrapper",pageType:r,title:i.createElement(Fe.Z,{titles:a}),onReady:this._handleOnFilterChange,onChange:this._handleOnFilterChange,noSavingFilterList:!0,expandInfo:{pageType:r}},i.createElement(l.Tabs,{activeName:n,onTabClick:this._handleOnTabClick},$.Z.hasAuthority("NPS_ANALYSIS")&&("RESEARCH_NPS"===r||"RESEARCH_ALL"===r)&&i.createElement(l.Tabs.Pane,{label:"NPS\u5206\u6790",name:"1"},i.createElement(s.Z,{ref:function(t){return e._handleRefs("1",t)}})),$.Z.hasAuthority("SATISFACTION_ANALYSIS")&&("RESEARCH_SATISFACTION"===r||"RESEARCH_ALL"===r)&&i.createElement(l.Tabs.Pane,{label:"\u6ee1\u610f\u5ea6\u5206\u6790",name:"2"},i.createElement(Me.Z,{ref:function(t){return e._handleRefs("2",t)}})),$.Z.hasAuthority("TEXT_ANALYSIS")&&i.createElement(l.Tabs.Pane,{label:"\u6587\u672c\u5206\u6790",name:"6"},i.createElement(Ze,{thirdParty:o,ref:function(t){return e._handleRefs("6",t)}})),$.Z.hasAuthority("ANSWER_ANALYSIS")&&i.createElement(l.Tabs.Pane,{label:"\u7b54\u5377\u5206\u6790",name:"3"},i.createElement(Y,{thirdParty:o,ref:function(t){return e._handleRefs("3",t)}})),$.Z.hasAuthority("ANSWER_DETAIL")&&i.createElement(l.Tabs.Pane,{label:"\u7b54\u5377\u8be6\u60c5",name:"4"},i.createElement(ie,{thirdParty:o,ref:function(t){return e._handleRefs("4",t)}})),$.Z.hasAuthority("DISTRIBUTION_RECORD")&&!o&&i.createElement(l.Tabs.Pane,{label:"\u5206\u53d1\u8bb0\u5f55",name:"5"},i.createElement(fe,{ref:function(t){return e._handleRefs("5",t)}}))))},t}(i.PureComponent)},87920:(e,t,a)=>{a.d(t,{Z:()=>R});var n=a(63366),r=a(87462),o=a(94578),i=a(67294),l=a(64396),s=a(55609),c=a(35239),u=a(10291),d=a(79260),p=(a(61210),a(50976)),m=a(8201),f=a(60496),h=a(98191),y=a(43036),E=(a(18446),a(70715)),g=a(94644),v=a(39432),I={none:{image:"data:image/svg+xml;base64,PHN2ZyBpZD0i5Zu+5bGCXzEiIGRhdGEtbmFtZT0i5Zu+5bGCIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDY0IDY0Ij48dGl0bGU+Y2VtPC90aXRsZT48cG9seWdvbiBwb2ludHM9IjMyIDUwLjQ1IDEyLjg0IDYwLjI5IDE2LjUgMzkuNDYgMSAyNC43IDIyLjQyIDIxLjY3IDMyIDIuNzEgNDEuNTggMjEuNjcgNjMgMjQuNyA0Ny41IDM5LjQ2IDUxLjE2IDYwLjI5IDMyIDUwLjQ1IiBmaWxsPSIjZTVlNWU1IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4="},harf:{image:"data:image/svg+xml;base64,PHN2ZyBpZD0i5Zu+5bGCXzEiIGRhdGEtbmFtZT0i5Zu+5bGCIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDY0IDY0Ij48dGl0bGU+Y2VtPC90aXRsZT48cGF0aCBkPSJNNjMsMjQuN2wtMjEuNDItM0wzMiwyLjcxVjUwLjQ1bDE5LjE2LDkuODNMNDcuNSwzOS40NloiIGZpbGw9IiNlNWU1ZTUiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjxwYXRoIGQ9Ik0yMi40MiwyMS42NywxLDI0LjcsMTYuNSwzOS40NiwxMi44NCw2MC4yOSwzMiw1MC40NVYyLjcxWiIgZmlsbD0iI2QwN2I0OSIgZmlsbC1ydWxlPSJldmVub2RkIi8+PC9zdmc+"},full:{image:"data:image/svg+xml;base64,PHN2ZyBpZD0i5Zu+5bGCXzEiIGRhdGEtbmFtZT0i5Zu+5bGCIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDY0IDY0Ij48dGl0bGU+Y2VtPC90aXRsZT48cG9seWdvbiBwb2ludHM9IjMyIDUwLjQ1IDEyLjg0IDYwLjI5IDE2LjUgMzkuNDYgMSAyNC43IDIyLjQyIDIxLjY3IDMyIDIuNzEgNDEuNTggMjEuNjcgNjMgMjQuNyA0Ny41IDM5LjQ2IDUxLjE2IDYwLjI5IDMyIDUwLjQ1IiBmaWxsPSIjZDA3YjQ5IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4="}},C=function(e,t){var a="";return a=e<=t?"full":"none",Math.floor(t)!==Number(t)&&Math.floor(t)+1===e&&(a="harf"),I[a].image};const S=function(e){var t=e.data,a=e.dateOptions,n=e.defaultDateType,r=e.setDefaultValue,o=e.flavorObj,l=e.className,s=e.fetchSatisAnalyzeData,c=i.useState(void 0),u=c[0],d=c[1],y=i.useState(void 0),I=y[0],S=y[1],T=i.useState(void 0),N=T[0],b=T[1];return i.useEffect((function(){I&&u&&function(e,t){t.clear(),t.setOption(e)}(I,u)}),[I,u]),i.useEffect((function(){if(t){var e=function(e,t,a){if(0===e.list.length)return"empty";var n=e.list;return{axisPointer:{link:{xAxisIndex:"all"}},title:{text:t},tooltip:{formatter:function(e){return(e||[]).map((function(e){return'<span style="font-weight: bold;font-size: 12px">'+e.name+"</span><br/>"+e.marker+e.seriesName+"\uff1a"+(null===e.data?"-":e.data)})).join("<br/><br/>")}},xAxis:[{type:"category",data:n.map((function(e){return(0,v.yV)(a,e.time)})),boundaryGap:!1},{type:"category",data:n.map((function(e){return(0,v.yV)(a,e.time)})),gridIndex:1,show:!1,boundaryGap:!1}],yAxis:[{type:"value",name:"\u6ee1\u610f\u5ea6",nameTextStyle:{color:"#262626",padding:[0,0,10,0]},minInterval:1,splitNumber:3},{type:"value",axisLine:{show:!1},axisLabel:{show:!1},gridIndex:1,name:"\u7b54\u9898\u6570\u91cf",nameTextStyle:{color:"#262626"}}],dataZoom:[{type:"slider",show:!0,realtime:!0,xAxisIndex:[0,1],height:16,top:335}],grid:[{left:470,right:50,top:80,height:"32%",tooltip:{trigger:"axis"}},{left:470,right:50,top:265,gridIndex:1,height:"15%",tooltip:{trigger:"axis"}}],graphic:[{type:"text",left:"84",top:"104",silent:!0,style:{text:e.satisfactionValue,fill:"#262626",font:"60px "+E.I8}},{type:"text",left:"84",top:268,silent:!0,style:{text:"\u7b54\u9898\u5ba2\u6237\u6570",fill:"#8C8C8C",font:"14px "+E.I8}},{type:"text",left:"178",top:268,silent:!0,style:{text:e.total,fill:"#262626",font:"14px "+E.I8}}].concat(new Array(5).fill(0).map((function(t,a){return{type:"image",left:83+36*a,top:194,scale:[2,2],style:{image:C(a+1,e.satisfactionValue),width:"14"}}})),new Array(11).fill(0).map((function(e,t){return{type:"line",shape:{x1:84+16*t,y1:244,x2:90+16*t,y2:244},style:{fill:"#E5E5E5",stroke:"#E5E5E5"},cursor:"none"}}))),series:[{data:n.map((function(e){return e.satisfactionValue})),type:"line",smooth:!0,symbol:"circle",symbolSize:2.5,markLine:{symbolSize:0,data:[{type:"average",name:"\u5e73\u5747\u7ebf"}],lineStyle:{color:"#BFBFBF"},label:{show:!1,formatter:"\u5747\u503c"}},lineStyle:{color:"#0074B8"},name:"\u6ee1\u610f\u5ea6"},{data:n.map((function(e){return e.questionnaireTotal})),type:"line",smooth:!0,symbol:"circle",symbolSize:2,xAxisIndex:1,yAxisIndex:1,areaStyle:{color:"#E7F1F7"},itemStyle:{color:"#1574B3"},lineStyle:{color:"#1574B3"},name:"\u7b54\u9898\u6570\u91cf"}]}}(t,"\u6ee1\u610f\u5ea6",N);S(e)}}),[t]),i.useEffect((function(){o&&b(a.some((function(e){return e.value===o.satisAnalyze}))?o.satisAnalyze:n)}),[o,n,a]),i.createElement(m.Z,{data:I,className:"yt_research_analyze_line_chart_wrap "+(l||""),renderTitle:i.createElement(h.Z,{data:I,onMoreClick:function(e){return function(e,t,a){var n=void 0;"image"===t?(n=e,(0,g._v)(e,"\u6ee1\u610f\u5ea6\u5206\u6790")):"data"===t&&((n=a.list.map((function(e){return[e.time,e.satisfactionValue||"",e.questionnaireTotal]}))).unshift(["\u65e5\u671f","\u6ee1\u610f\u5ea6","\u7b54\u9898\u6570\u91cf"]),n=[n],(0,g.aT)(n,"\u6ee1\u610f\u5ea6\u5206\u6790"))}(u,e,t)},title:"\u6ee1\u610f\u5ea6",titleOverlay:"\u6ee1\u610f\u5ea6\u5206\u503c\u7684\u5747\u503c"},i.createElement("div",null,i.createElement(f.Z,{onChange:function(e){b(e),s({dateGroupType:e})},activeObj:N,options:a,flavor:(o||{}).satisAnalyze,onFlavorChange:function(e){return r({key:"satisAnalyze",value:e})}})))},i.createElement(p.Z,{theme:"yunting_multi_color",loadingOption:{text:"\u52a0\u8f7d\u4e2d",color:"#20a0ff"},option:{},opts:{devicePixelRatio:2},style:{width:"100%",height:"100%"},onChartReady:function(e){return d(e)}}))};var T=a(29383);a(98245);var N=[{title:"\u6ee1\u610f\u5ea6\u5bf9\u6bd4",value:0},{title:"\u7b54\u5377\u6570\u91cf\u5bf9\u6bd4",value:1}];function b(e,t,a){e&&t&&new Promise((function(t){var n=function(e,t){var a=Math.max.apply(Math,e.map((function(e){return e[t?"questionnaireTotal":"satisfactionValue"]})));return{title:{text:"\u5404\u7701\u6ee1\u610f\u5ea6\u5bf9\u6bd4\u548c\u7b54\u9898\u6570"},tooltip:{formatter:function(e){var a=e.marker,n=e.data,r=n.name,o=n.value,i=n.other;return[a+'<span style="font-size: 16px; line-height: 30px">'+r+"</span>",(0===t?"\u6ee1\u610f\u5ea6\uff1a":"\u7b54\u5377\u6570\u91cf\uff1a")+(0===t&&.99===o?"\u65e0":o),(0===t?"\u7b54\u5377\u6570\u91cf\uff1a":"\u6ee1\u610f\u5ea6\uff1a")+(0===t?i:.99===i?"\u65e0":i)].join("<br/>")}},visualMap:{bottom:20,min:0===t?.99:0,max:0===t?5:0===a?1:a,text:0===t?["5\u5206","1\u5206"]:["\u9ad8","\u4f4e"],range:0===t?[1,5]:void 0,inRange:{color:0===t?["#D96969","#0074B8","#15B374"]:["white","#1474B3"]},outOfRange:{color:["white"]},itemWidth:10,itemHeight:80,top:350,left:40},series:[{left:70,type:"map",map:"china",label:{normal:{show:!1},emphasis:{show:!1}},itemStyle:{emphasis:{areaColor:"#CDB446"}},data:e.map((function(e){return{name:e.province.replace("\u7701",""),value:0===t?null===e.satisfactionValue?.99:e.satisfactionValue:e.questionnaireTotal,other:0===t?e.questionnaireTotal:null===e.satisfactionValue?.99:e.satisfactionValue}}))}]}}(e,a);t(n)})).then((function(e){t.clear(),t.setOption(e)}))}const w=function(e){var t=e.data,a=e.flavorObj,n=e.loading,r=e.setDefaultValue,o=i.useState(void 0),l=o[0],s=o[1],c=i.useState(0),u=c[0],d=c[1];return i.useEffect((function(){b(t,l,u)}),[t,l,u]),i.useEffect((function(){d((a||{}).mapAnalyze||0)}),[a]),i.createElement(m.Z,{className:"research_analyze_map",renderTitle:i.createElement(h.Z,{data:t,onMoreClick:function(e){return function(e,t,a,n){var r=void 0;"image"===t?(r=e,(0,g._v)(e,n)):"data"===t&&((r=a.map((function(e){return[e.province,e.satisfactionValue?e.satisfactionValue:"\u65e0",e.questionnaireTotal]}))).unshift(["\u7701\u4efd","\u6ee1\u610f\u5ea6","\u7b54\u9898\u6570\u91cf"]),r=[r],(0,g.aT)(r,"\u5404\u7701\u6ee1\u610f\u5ea6\u5bf9\u6bd4\u548c\u7b54\u9898\u6570"))}(l,e,t,0===e?"\u6ee1\u610f\u5ea6\u5bf9\u6bd4":"\u7b54\u5377\u6570\u91cf\u5bf9\u6bd4")},title:"\u5404\u7701\u6ee1\u610f\u5ea6\u5bf9\u6bd4\u548c\u7b54\u9898\u6570",titleOverlay:i.createElement("div",null,i.createElement("div",null,"\u6536\u96c6\u5230\u6ee1\u610f\u5ea6\u7684\u5206\u503c\u9898\u5c31\u7b971\u4e2a\u7b54\u9898"),i.createElement("div",null,"\u5ba2\u6237\u7684\u57ce\u5e02\u662f\u4f9d\u636e\u7b54\u9898\u8bbf\u95ee\u95ee\u5377\u65f6\u83b7\u5f97\u7684IP"),i.createElement("div",null,"\u5730\u5740\u89e3\u6790\u5f97\u51fa"))},i.createElement(f.Z,{onChange:function(e){d(e)},activeObj:u,options:N,flavor:(a||{}).mapAnalyze||null,onFlavorChange:function(e){return r({key:"mapAnalyze",value:e})}})),data:t,defTitle:"\u5404\u7701NPS\u503c\u5bf9\u6bd4",loading:n},i.createElement("div",{className:"chart"},i.createElement(p.Z,{theme:"yunting_pos_neu_neg",option:{},style:{width:"100%",height:"100%"},onChartReady:function(e){return s(e)}})),i.createElement("div",{className:"table"},i.createElement(T.Z,{columns:[{label:"\u7701\u4efd",prop:"province"},{label:i.createElement("div",{style:{background:"white"}},"\u6ee1\u610f\u5ea6",i.createElement(y.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:"\u6ee1\u610f\u5ea6\u5206\u503c\u7684\u5747\u503c"},i.createElement("i",{className:"icon-cem_file1"}))),prop:"satisfactionValue",render:function(e){return i.createElement("div",null,e.satisfactionValue?e.satisfactionValue:"\u65e0")}},{label:"\u7b54\u9898\u6570\u91cf",prop:"questionnaireTotal"}],data:t,currentPage:1,total:34})))};a(54898);const _=function(e){var t=e.fetchingSatConcerns,a=e.doubleBarChartData,n=e.graphPieChartData,r=(e.wordChartData,e.fetchSatisAnalyzeData),o=e.satisAnalyzeData,l=e.fetchingSatisCustomerData,s=e.satisCustomerData,c=e.graphicData,p=e.custDataType,m=e.custTimeType,f=e.onFilterChange,h=e.mapData,y=e.dateOptions,E=e.defaultDateType,g=e.flavorObj,v=e.setDefaultValue;e.relativeData,e.relativeRefreshTime,e.relativeDataLoading;return i.createElement("div",{className:"yt_research_satisfaction_analysis_wrapper"},i.createElement(S,{data:o,dateOptions:y,defaultDateType:E,setDefaultValue:v,flavorObj:g,fetchSatisAnalyzeData:r}),i.createElement(u.Z,{loading:l,title:"\u6ee1\u610f\u5ea6\u5ba2\u6237\u5206\u7c7b",titleOverlay:i.createElement("div",null,i.createElement("div",null,"\u597d\u8bc4\uff1a4\u5206\u548c5\u5206"),i.createElement("div",null,"\u4e2d\u8bc4\uff1a3\u5206"),i.createElement("div",null,"\u5dee\u8bc4\uff1a1\u5206\u548c2\u5206")),type:"SATISFACTION",dateOptions:y,customerData:s,graphicData:c,dataType:p,timeType:m,defaultDateType:E,defaultDataType:g&&g.fCustDataType,setDefaultValue:v,flavorObj:g&&g,onFilterChange:f}),i.createElement(w,{setDefaultValue:v,flavorObj:g,data:h}),i.createElement(d.Z,{title:"\u597d\u8bc4\u5ba2\u6237\u548c\u5dee\u8bc4\u5ba2\u6237\u5173\u6ce8\u70b9\u5bf9\u6bd4",overlay:i.createElement("div",null,i.createElement("div",null,"\u597d\u8bc4\uff1a4\u5206\u548c5\u5206"),i.createElement("div",null,"\u4e2d\u8bc4\uff1a3\u5206"),i.createElement("div",null,"\u5dee\u8bc4\uff1a1\u5206\u548c2\u5206")),positiveTitle:"\u597d\u8bc4\u5ba2\u6237",negativeTitle:"\u5dee\u8bc4\u5ba2\u6237",doubleBarChartData:a,defaultDataType:g&&g.fBarCompareType,setDefaultValue:v,graphPieChartData:n,loading:t}))};var D=["loading"],O=l.Z.research.analyze.satisfaction,A=function(e){function t(t){var a;return(a=e.call(this,t)||this)._handleOnWsMessage=function(e){var t=e.data;if(t.type&&"ws"===t.type){var n=t.payload,r=n.type,o=n.result;"QUESTIONNAIRE_TEXT_RESULT"===r&&a.props.save({relativeData:o.data.length?o.data:"empty",relativeRefreshTime:o.createdAt,relativeDataLoading:!1})}},a._handleOnFilterChange=function(e){e.dateGroupType&&a.props.fetchSatisCustomerData({dateGroupType:e.dateGroupType})},a.state={},a.event={onFilterChange:a._handleOnFilterChange},a}(0,o.Z)(t,e);var a=t.prototype;return a.active=function(e){var t=e.filterArgs,a=(e.title,e.questionnaireId),n=e.questionnaireBoardId,r=t[0],o=(t[1],t[2]);this.props.fetchDatas({filterModel:r.filterValue,dateFilter:r.dateFilter,dateOptions:o.dateOptions,defaultDateType:o.defaultDateType,projectId:c.t.get(c.V.curProject).id,questionnaireId:a,questionnaireBoardId:n,pageType:"research_satis"})},a.componentDidMount=function(){window.addEventListener("message",this._handleOnWsMessage)},a.componentWillUnmount=function(){window.removeEventListener("message",this._handleOnWsMessage),this.props.clear()},a.render=function(){return i.createElement(_,(0,r.Z)({},this.props,this.state,this.event))},t}(i.PureComponent);const R=(0,s.connect)((function(e){var t=e.loading,a=(0,n.Z)(e,D);return(0,r.Z)({},a[O],{fetchingSatConcerns:t.effects[O+"/fetchSatConcerns"]||!1,fetchSatisCustomerData:t.effects[O+"/fetchSatisCustomerData"]||!1})}),(function(e){return{save:function(t){return e({type:O+"/save",payload:t})},fetchSatisAnalyzeData:function(t){return e({type:O+"/fetchSatisAnalyzeData",payload:t})},setDefaultValue:function(t){return e({type:O+"/setDefaultValue",payload:t})},fetchDatas:function(t){return e({type:O+"/fetchDatas",payload:t})},fetchSatisCustomerData:function(t){return e({type:O+"/fetchSatisCustomerData",payload:t})},clear:function(t){return e({type:O+"/clear",payload:t})}}}),null,{withRef:!0})(A)},25022:(e,t,a)=>{a.d(t,{Z:()=>c});var n=a(67294),r=a(92360),o=a(35303),i=a(45697),l=a.n(i),s=[{label:"10\u9879/\u9875",value:10},{label:"20\u9879/\u9875",value:20},{label:"40\u9879/\u9875",value:40},{label:"100\u9879/\u9875",value:100}];const c=function(e){var t=e.onPageChange,a=e.onSizeChange,i=e.total,l=void 0===i?0:i,c=e.pageIndex,u=e.pageSize,d=e.layout,p=e.className,m=e.currLength,f=0===l?0:(c-1)*u+1,h=0===l?0:m?f+m-1:f+u-1;return 0===l?null:n.createElement("div",{className:"yt-awp-pagination "+(p||"")},n.createElement("span",{className:"total_num"},n.createElement("span",null,f+" - "+h+" "),"\u9879\uff0c\u5171",n.createElement("span",null," "+l+" "),"\u9879"),n.createElement("div",{style:{textAlign:"right",float:"right"},className:"new_pagination"},n.createElement(r.Pagination,{small:!0,pageSize:u,currentPage:c,pageCount:Math.ceil(l/u),layout:0===l?"":"prev, pager, next",onCurrentChange:t}),void 0===d||d.includes("sizes")?n.createElement(o.RS,{multiple:!1,tags:!1,showSearch:!1,optionFilterProp:"label",optionLabelProp:"label",animation:"slide-up",dropdownClassName:"custom-pagination-dropdown",value:u||10,onChange:a},s.map((function(e,t){return n.createElement(o.Wx,{key:t,label:e.label,value:e.value},e.label)}))):null))};l().propTypes={onPageChange:l().func,onSizeChange:l().func,total:l().number,pageIndex:l().number,pageSize:l().number,layout:l().string,className:l().string}},71339:(e,t,a)=>{a.d(t,{Z:()=>c});var n=a(67294),r=a(92360),o=a(25022),i=a(45697),l=a.n(i),s=function(e){var t=e.data,a=e.total,i=void 0===a?0:a,l=e.loading,s=e.pageIndex,c=e.columns,u=e.pageSize,d=e.onPageChange,p=e.onPageSizeChange,m=e.onSortChange,f=e.defaultSort,h=e.className,y=void 0===h?"":h;return n.useEffect((function(){var e=document.getElementsByClassName("is-sortable")[0];f&&e&&e.classList.add(f.order)}),[f]),n.createElement("div",{className:"yt-awp-content-list "+y},n.createElement(r.Loading,{loading:l,className:"awp-content-loading"},n.createElement(r.Table,{defaultSort:f,columns:c,style:{width:"100%"},data:t,onSortChange:function(e){return m(e)}})),d&&n.createElement(o.Z,{onPageChange:d,onSizeChange:p,total:i,currLength:t.length,pageIndex:s,pageSize:u}))};s.propTypes={data:l().array,total:l().number,loading:l().bool,pageIndex:l().number,columns:l().array,pageSize:l().number,onPageChange:l().func,onPageSizeChange:l().func,onSortChange:l().func,defaultSort:l().any,className:l().string};const c=s},61918:(e,t,a)=>{a.d(t,{Z:()=>l});var n=a(67294),r=a(45697),o=a.n(r),i=function(e){var t=e.className,a=e.onClear,r=e.onSearch,o=e.placeholder,i=e.style,l=e.defValue,s=e.signal,c=n.useState(l),u=c[0],d=c[1];n.useEffect((function(){d(l)}),[l,s]);return n.createElement("div",{style:i,className:"yt_search_input_wrapper "+(t||"")},n.createElement("input",{placeholder:o,value:u,onKeyDown:function(e){13===e.keyCode&&r(u)},onChange:function(e){return d(e.target.value)},autoComplete:"off"}),u&&n.createElement("i",{className:"icon-cem_log-off",onClick:function(){d(""),a&&a("")}}),n.createElement("i",{className:"icon-cem_small-search",onClick:function(){return r(u)}}))};i.propTypes={className:o().string,onSearch:o().func.isRequired,placeholder:o().string,style:o().object,defValue:o().string,signal:o().any,onClear:o().func};const l=i}}]);