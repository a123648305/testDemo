"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[7996],{27996:(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});var a=n(63366),r=n(87462),l=n(67294),i=(n(54277),n(74048)),c=(n(15086),n(94055)),o=(n(1025),n(65400)),s=(n(75314),n(11187)),u=n(15861),m=n(87757),d=n.n(m),f=n(55815),p=(n(48145),n(40987)),v=n(96889),h=[{label:"\u5355\u9009",value:"RADIO"},{label:"\u591a\u9009",value:"CHECKBOX"},{label:"\u65e5\u671f",value:"DATE_TIME"},{value:"TIME",label:"\u65f6\u95f4"},{label:"\u6570\u5b57",value:"NUMERIC"},{label:"\u6587\u672c",value:"TEXT"}],g=n(30381),y=n.n(g);const E=function(e){var t=e.dataSource,n=e.loading,a=e.pagination,r=e.onTableChange,o=e.onDelFiledItem,s=e.onUpdateFiledItem,u=e.onSwitchFiledItem,m=(0,l.useMemo)((function(){var e=document.querySelector(".container");return e?e.offsetHeight-222:620}),[n]),d=[{title:"\u540d\u79f0",dataIndex:"name",width:320},{title:"\u7c7b\u578b",dataIndex:"type",render:function(e){return function(e){var t=h.find((function(t){return t.value===e}));return(null==t?void 0:t.label)||""}(e)}},{title:"\u53c2\u6570\u540d\u79f0",dataIndex:"code"},{title:"\u4fee\u6539\u4eba",dataIndex:"updatorName"},{title:"\u6700\u540e\u4fee\u6539\u65f6\u95f4",dataIndex:"updatedAt",render:function(e){return e&&y()(e).format("YYYY/MM/DD HH:mm")}},{dataIndex:"isDetailVisible",title:function(){return l.createElement(l.Fragment,null,l.createElement("span",null,"\u662f\u5426\u5f00\u542f"),l.createElement(c.default,{title:"\u5173\u95ed\u540e\uff0c\u8be5\u5b57\u6bb5\u4e0d\u663e\u793a\u5728\u5ba2\u6237\u8be6\u60c5\u9875"},l.createElement("i",{className:"icon-cem_file1"})))},render:function(e,t){return l.createElement(p.Z,{checked:e,onChange:function(){return u(t)}})}},{title:"\u64cd\u4f5c",dataIndex:"address",width:120,render:function(e,t){return l.createElement(i.default,{className:"opeator-box"},l.createElement("span",{onClick:function(){return s(t)}},"\u7f16\u8f91"),l.createElement("span",{onClick:function(){return o(t)}},"\u5220\u9664"))}}];return l.createElement(v.ZP,{columns:d,loading:n,rowKey:"id",pagination:a,onChange:r,dataSource:t,search:!1,scroll:{y:m},options:!1})};var b=n(61918),S=n(35239),w=n(61409),C=(n(53294),n(56697)),N=["onOK"];const k=function(e){var t=e.onOK,n=(0,a.Z)(e,N);return l.createElement(C.Z,(0,r.Z)({className:"yt-customer-dialog-wrapper"},n,{onOk:t}),n.content||n.children)};n(35797);var I=n(64749),F=(n(89858),n(51024)),Z=(n(29809),n(97538)),_=n(51474);const x=function(e){var t=e.visible,n=e.title,a=e.fieldList,i=e.onSumbit,c=e.onCancel,o=e.formData,s=(null==o?void 0:o.sourceOptions)||[{value:"",key:""},{value:"",key:""}],u=(0,l.useState)(JSON.stringify(s)),m=u[0],d=u[1],f=(0,l.useState)({from:0,to:0}),p=(f[0],f[1]),v=(0,l.useState)((null==o?void 0:o.type)||""),g=v[0],y=v[1],E=Z.Z.useForm()[0];(0,l.useEffect)((function(){document.querySelector("#option-list")&&_.default.create(document.querySelector("#option-list"),{group:"option-list",animation:150,handle:".options-handler",fallbackOnBody:!0,invertSwap:!0,delay:5,onEnd:function(e){var t=e.newIndex,n=e.oldIndex;if(t!==n){var a=JSON.parse(m);a.splice(t,0,a.splice(n,1)[0]),p({from:n,to:t}),d(JSON.stringify(a))}}})}));var b=function(){var e=JSON.parse(m),t=document.documentElement.clientHeight-574;switch(g){case"RADIO":case"CHECKBOX":return l.createElement("div",null,l.createElement("div",{id:"option-list",style:{maxHeight:t,overflow:"auto"}},e.map((function(t,n){var a=JSON.parse(m);return l.createElement("div",{key:n,className:"option-wrapper"},l.createElement(Z.Z.Item,{label:l.createElement(l.Fragment,null,l.createElement("i",{className:"icon-cem_move options-handler",style:{marginRight:"8px",cursor:"pointer"}}),"\u9009\u9879",n+1),name:"option"+n,rules:[{type:"string",max:20,message:"\u6700\u591a\u8f93\u516520\u4e2a\u5b57"},{validator:function(e,t){return t?t&&a.some((function(e,a){return a<n&&e.value===t}))?Promise.reject(new Error("\u6b64\u9009\u9879\u540d\u79f0\u5df2\u88ab\u4f7f\u7528\uff0c\u8bf7\u5c1d\u8bd5\u5176\u4ed6\u9009\u9879\u540d\u79f0")):Promise.resolve():Promise.reject(new Error("\u8bf7\u8f93\u5165\u9009\u9879\u540d\u79f0"))}}],validateFirst:!0},l.createElement(F.default,{placeholder:"\u6700\u591a20\u4e2a\u5b57",style:{width:540},onBlur:function(e){return function(e,t){var n=e.target.value,a=JSON.parse(m).map((function(e,a){return a===t?(0,r.Z)({},e,{value:n.trim()}):e}));d(JSON.stringify(a))}(e,n)},defaultValue:t.value})),e.length>2&&l.createElement("i",{className:"icon-cem_trash",onClick:function(){return function(e){var t=JSON.parse(m);t.splice(e,1);var n=t;d(JSON.stringify(n))}(n)},style:{marginLeft:"12px"}}))}))),e.length<100&&l.createElement(Z.Z.Item,{wrapperCol:{offset:3},style:{marginBottom:0}},l.createElement("a",{onClick:function(){var e=JSON.parse(m);e.push({value:"",key:""}),d(JSON.stringify(e))}},l.createElement("i",{className:"icon-cem_add-to",style:{marginRight:"12px"}}),"\u6dfb\u52a0\u9009\u9879")));case"DATE_TIME":return l.createElement(Z.Z.Item,{label:"\u65f6\u95f4\u683c\u5f0f",style:{marginBottom:0}},"2020/12/01");case"TIME":return l.createElement(Z.Z.Item,{label:"\u65f6\u95f4\u683c\u5f0f",style:{marginBottom:0}},"2020/12/01 12:00");case"TEXT":return l.createElement(Z.Z.Item,{label:"\u5907\u6ce8",style:{marginBottom:0}},"\u6587\u672c\u6700\u591a\u8f93\u51651000\u4e2a\u5b57");case"NUMERIC":return l.createElement(Z.Z.Item,{label:"\u5907\u6ce8",style:{marginBottom:0},wrapperCol:{span:18}},"\u6700\u591a\u652f\u6301\u8f93\u5165\u5c0f\u6570\u70b9\u540e\u56db\u4f4d\uff0c\u7b26\u53f7\u4ec5\u652f\u6301\u8f93\u5165\u8d1f\u53f7\uff0c\u4f8b\u5982-13.02");default:return l.createElement(l.Fragment,null)}};return(0,l.useEffect)((function(){if(o){var e=JSON.parse(JSON.stringify(o));E.setFieldsValue(e)}}),[]),l.createElement(l.Fragment,null,l.createElement(C.Z,{title:n,visible:t,className:"yt_customer_modal",width:720,centered:!0,onOk:function(){var e=JSON.parse(m);e.forEach((function(e,t){var n;E.setFieldsValue(((n={})["option"+t]=e.value,n))})),E.validateFields().then((function(t){var n=e.filter((function(e){return e.value})),a=t.name,r=t.type,l=t.code,c={id:null==o?void 0:o.id,name:a,code:l,type:(null==o?void 0:o.type)||r,schemaList:n||[]};i(c)})).catch((function(e){}))},onCancel:function(){y(""),c()},destroyOnClose:!0,maskClosable:!1},l.createElement(Z.Z,{form:E,labelCol:{span:3},wrapperCol:{span:10},preserve:!1},l.createElement(Z.Z.Item,{label:"\u5b57\u6bb5\u540d\u79f0",name:"name",rules:[{required:!0,whitespace:!0,message:"\u8bf7\u8f93\u5165\u5b57\u6bb5\u540d\u79f0"},{type:"string",max:20,message:"\u6700\u591a\u8f93\u516520\u4e2a\u5b57"},{validator:function(e,t){return null!=a&&a.some((function(e){return e.name===t&&((null==o?void 0:o.id)!==e.id||!e.id)}))?Promise.reject(new Error("\u6b64\u5b57\u6bb5\u540d\u79f0\u5df2\u88ab\u4f7f\u7528\uff0c\u8bf7\u5c1d\u8bd5\u5176\u4ed6\u5b57\u6bb5\u540d\u79f0")):Promise.resolve()}}],validateFirst:!0},l.createElement(F.default,{style:{width:540},placeholder:"\u6700\u591a20\u4e2a\u5b57",maxLength:20,autoComplete:"off",onBlur:function(){return!o&&function(){var e="keyword"+Math.floor(1001*Math.random()+1e3);!E.getFieldValue("code")&&E.setFields([{name:"code",value:e}])}()}})),l.createElement(Z.Z.Item,{label:"\u53c2\u6570\u540d\u79f0",name:"code",rules:[{required:!0,whitespace:!0,message:"\u8bf7\u8f93\u5165\u53c2\u6570\u540d\u79f0"},{validator:function(e,t){return null!=a&&a.some((function(e){return e.code===t&&((null==o?void 0:o.id)!==e.id||!e.id)}))?Promise.reject(new Error("\u6b64\u53c2\u6570\u540d\u79f0\u5df2\u88ab\u4f7f\u7528\uff0c\u8bf7\u5c1d\u8bd5\u5176\u4ed6\u53c2\u6570\u540d\u79f0")):Promise.resolve()}}]},l.createElement(F.default,{placeholder:"\u6700\u591a50\u4e2a\u5b57\u6bcd",style:{width:540},maxLength:50,autoComplete:"off",disabled:o})),l.createElement(Z.Z.Item,{label:"\u5b57\u6bb5\u7c7b\u578b",name:"type",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5b57\u6bb5\u7c7b\u578b"}]},l.createElement(I.default,{style:{width:540},placeholder:"\u8bf7\u9009\u62e9",options:h,onChange:function(e){return y(e)},disabled:o})),l.createElement(b,null))))};var O=[{name:"\u7528\u6237\u540d"},{name:"\u59d3\u540d"},{name:"\u624b\u673a"},{name:"\u90ae\u7bb1"},{name:"\u6807\u7b7e"},{name:"\u5907\u6ce8"}];const T=function(e){var t=e.list,n=e.loading,a=e.pagination,r=e.searchList,m=e.addFieldItem,p=e.delFiledItem,v=e.updateFiledItem,h=e.onTableChange,g=e.switchFiledItem,y=e.getSecretKey,C=(0,l.useState)(""),N=(C[0],C[1],(0,l.useState)("")),I=N[0],F=N[1],Z=(0,l.useState)(""),_=Z[0],T=Z[1],L=(0,l.useState)(),J=L[0],D=L[1],P=(0,l.useState)(),R=P[0],B=P[1],K=(0,l.useState)(""),M=K[0],V=K[1],j=(0,l.useState)(),A=j[0],q=j[1],H=(0,l.useState)(""),U=H[0],X=H[1],z=(0,l.useState)(""),Y=z[0],W=z[1],G=function(){var e=(0,u.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g({id:A.id,isDetailVisible:!A.isDetailVisible});case 2:e.sent&&X("");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=(0,u.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p({id:R.id});case 2:e.sent&&F("");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$=function(){var e=(0,u.Z)(d().mark((function e(t){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!J){e.next=6;break}return e.next=3,v(t);case 3:n=e.sent,e.next=9;break;case 6:return e.next=8,m(t);case 8:n=e.sent;case 9:n&&(T(""),D(void 0));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=(0,u.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:(t=e.sent)&&V(t),setTimeout((function(){getSelection().removeAllRanges(),V("")}),5e3);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return l.createElement("div",{className:"yt_project_customer_wrapper"},l.createElement(f.Z,{title:[{title:S.t.get(S.V.backProjectConfig).name,url:"/account/project/preview"},{url:"",title:"\u81ea\u5b9a\u4e49\u5b57\u6bb5\u8bbe\u7f6e"}],overlay:l.createElement(w.rU,{className:"yt_project_customer_read_more",to:"https://skieer.feishu.cn/docs/doccnapHipX5yTULhosHKTxJzWe",target:"_blank"},"\u67e5\u770bAPI\u6587\u6863")}),l.createElement("div",{className:"container"},l.createElement("div",{className:"content"},l.createElement("div",{className:"content_top"},l.createElement(b.Z,{placeholder:"\u8bf7\u8f93\u5165",defValue:"",onSearch:function(e){return r(e)},onClear:function(e){return r(e)},style:{width:160,height:28}}),l.createElement(i.default,null,l.createElement(o.default,{type:"primary",onClick:function(){T("\u6dfb\u52a0\u5b57\u6bb5")}},"\u6dfb\u52a0\u5b57\u6bb5"),l.createElement(c.default,{placement:"topRight",title:l.createElement("div",{className:"yt_customer_serect_key"},l.createElement("span",{className:"serect_key_content"},M),l.createElement("span",{className:"serect_key_copy",onClick:function(){return function(e){var t=document.querySelector(e),n=document.createRange();getSelection().removeAllRanges(),n.selectNode(t),getSelection().addRange(n),document.execCommand("copy"),s.default.success("\u590d\u5236\u6210\u529f"),setTimeout((function(){getSelection().removeAllRanges(),V("")}),2e3)}(".serect_key_content")}},"\u590d\u5236")),visible:!!M,trigger:"click"},l.createElement(o.default,{onClick:ee},"\u67e5\u770b\u63a5\u53e3\u5bc6\u94a5")))),l.createElement(E,{dataSource:t,loading:n,onDelFiledItem:function(e){B(e);var t=e.name;F('\u5220\u9664"'+t+'"\u540e\uff0c\u6240\u6709\u5ba2\u6237\u5173\u8054\u7684\u5185\u5bb9\u4e2d\u5305\u542b"'+t+'"\u7684\u4fe1\u606f\u90fd\u5c06\u88ab\u5220\u9664\u3002')},onUpdateFiledItem:function(e){var t=e.id,n=e.name,a=e.code,r=e.type,l=e.value,i=l&&JSON.parse(l),c={id:t,name:n,code:a,type:r,schemaList:i?i.map((function(e){return e.value})):[],sourceOptions:i};D(c),T("\u7f16\u8f91\u5b57\u6bb5")},onSwitchFiledItem:function(e){q(e);var t=e.name;if(e.isDetailVisible){W("\u786e\u8ba4\u7981\u7528"),X('\u662f\u5426\u7981\u7528"'+t+'"\u5b57\u6bb5\uff0c\u7981\u7528\u540e\uff0c\u65b0\u589e\u5ba2\u6237\u5c06\u4e0d\u7528\u518d\u914d\u7f6e\u8be5\u5b57\u6bb5\uff0c\u4f46\u80fd\u7ee7\u7eed\u67e5\u8be2\u5339\u914d\u5230\u8be5\u5b57\u6bb5\u7684\u5386\u53f2\u5ba2\u6237\u3002')}else{W("\u786e\u8ba4\u542f\u7528"),X('\u662f\u5426\u542f\u7528"'+t+'"\u5b57\u6bb5\uff1f\u542f\u7528\u540e\uff0c\u65b0\u589e\u5ba2\u6237\u53ef\u4ee5\u914d\u7f6e\u8be5\u5b57\u6bb5')}},onTableChange:h,pagination:a}),l.createElement(k,{title:Y,content:U,visible:!!U,onOK:function(){return G()},onCancel:function(){return X("")},width:424,closable:!1}),l.createElement(k,{title:"\u5220\u9664",content:I,visible:!!I,onOK:function(){return Q()},onCancel:function(){return F("")},width:424,closable:!1}),_&&l.createElement(x,{fieldList:[].concat(t,O),title:_,visible:!0,formData:J,onSumbit:$,onCancel:function(){T(""),D(void 0)}}))))};var L=n(64396),J=n(55609),D=["loading"],P=L.Z.project.customerManage;const R=(0,J.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,D);return(0,r.Z)({},n[P],{loading:t.effects[P+"/fetchList"]||!1,addLoading:t.effects[P+"/addField"]||!1})}),(function(e){return{fetchList:function(){return e({type:P+"/fetchList"})},delField:function(t){return e({type:P+"/delField",payload:t})},editField:function(t){return e({type:P+"/editField",payload:t})},switchField:function(t){return e({type:P+"/switchField",payload:t})},addField:function(t){return e({type:P+"/addField",payload:t})},getSecretKey:function(){return e({type:P+"/getSecretKey"})},save:function(t){return e({type:P+"/save",payload:t})}}}))((function(e){(0,l.useEffect)((function(){e.fetchList()}),[]);var t={searchList:function(t){var n=e.fetchParams,a=e.pagination,l={fetchParams:(0,r.Z)({},n,{pageIndex:1,name:t}),pagination:(0,r.Z)({},a,{current:1})};e.save(l),e.fetchList()},addFieldItem:function(t){return e.addField(t)},delFiledItem:function(t){return e.delField(t)},updateFiledItem:function(t){return e.editField(t)},switchFiledItem:function(t){return e.switchField(t)},onTableChange:function(t){var n=t.current,a=t.pageSize,l=e.fetchParams,i=e.pagination,c={fetchParams:(0,r.Z)({},l,{pageIndex:n,pageSize:a}),pagination:(0,r.Z)({},i,{current:n,pageSize:a})};e.save(c),e.fetchList()}};return l.createElement(T,(0,r.Z)({},e,t))}))},55815:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(94578),r=n(67294),l=n(45697),i=n.n(l),c=n(43036),o=n(61409),s=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props,a=n.title,r=n.beforeJump;e!==a.length-1&&(r?new Promise((function(e,t){return r(e,t)})).then((function(){o.mW.push({pathname:a[e].url,state:a[e].state})})):o.mW.push({pathname:a[e].url,state:a[e].state}))},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.mainTitle,l=t.rightContent,i=t.className,o=t.overlay;return r.createElement("div",{className:"breadcumb-wrapper "+i},n instanceof Array?r.createElement("div",{className:"breadcrumb-left"},r.createElement("div",null,n.map((function(t,a){return r.createElement("span",{className:t.url?"":"not_clickable",key:a,onClick:function(){return t.url&&a!==n.length-1&&e._handleBreadcrumbClick(a)}},t.title,a!==n.length-1&&" / ")}))),r.createElement("span",null,a||n[n.length-1].title,o&&r.createElement(c.Z,{placement:"top",overlay:o},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}})))):r.createElement("div",{className:"normal-title"},n,o&&r.createElement(c.Z,{placement:"top",overlay:o},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}}))),l||"")},t}(r.Component);s.propTypes={className:i().string,title:i().oneOfType([i().string,i().arrayOf(i().shape({title:i().string,url:i().string,state:i().object}))]).isRequired,overlay:i().oneOfType([i().string,i().node]),mainTitle:i().oneOfType([i().string,i().node]),beforeJump:i().func,rightContent:i().node};const u=s},61918:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(67294),r=n(45697),l=n.n(r),i=function(e){var t=e.className,n=e.onClear,r=e.onSearch,l=e.placeholder,i=e.style,c=e.defValue,o=e.signal,s=a.useState(c),u=s[0],m=s[1];a.useEffect((function(){m(c)}),[c,o]);return a.createElement("div",{style:i,className:"yt_search_input_wrapper "+(t||"")},a.createElement("input",{placeholder:l,value:u,onKeyDown:function(e){13===e.keyCode&&r(u)},onChange:function(e){return m(e.target.value)},autoComplete:"off"}),u&&a.createElement("i",{className:"icon-cem_log-off",onClick:function(){m(""),n&&n("")}}),a.createElement("i",{className:"icon-cem_small-search",onClick:function(){return r(u)}}))};i.propTypes={className:l().string,onSearch:l().func.isRequired,placeholder:l().string,style:l().object,defValue:l().string,signal:l().any,onClear:l().func};const c=i}}]);