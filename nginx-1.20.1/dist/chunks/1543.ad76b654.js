"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[1543],{61543:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p});var r=n(97326),a=n(94578),i=n(67294),s=n(92360),o=n(29383),l=n(49722),c=n(12518),u=n(87462),m=n(5133),h=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={visible:!1,form:{username:"",password:""},rules:{username:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d\u79f0",trigger:"blur"}],password:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801",trigger:"blur"}]}},t.sure=function(e){e.preventDefault(),t.refs.form.validate((function(e){if(!e)return!1;var n=t.state.form;l.h.post("/thirdauth/zhihu/userpwdcheck",(0,u.Z)({},n)).then((function(e){2e4===e.data.code&&t.add()}))}))},t}(0,a.Z)(t,e);var r=t.prototype;return r.show=function(){this.setState({visible:!0})},r.onChange=function(e,t){var n;this.setState({form:Object.assign(this.state.form,(n={},n[e]=t,n))})},r.add=function(){var e=this,t=this.state.form;l.h.post("/thirdauth/add",(0,u.Z)({platformType:"ZHIHU"},t)).then((function(t){e.resetForm(),m.Z.success("\u6388\u6743\u6210\u529f"),e.props.done()}))},r.resetForm=function(){this.refs.form.resetFields(),this.setState({visible:!1,form:{username:"",password:""}})},r.componentDidMount=function(){},r.render=function(){var e=this,t=this.state.form;return i.createElement(s.Dialog,{className:"authorizationWrap",title:"",size:"tiny",style:{width:"460px"},visible:this.state.visible,onCancel:function(){return e.setState({visible:!1})}},i.createElement("div",{className:"authorization"},i.createElement("div",{className:"img"},i.createElement("img",{src:n(11380),alt:""})),i.createElement("p",null,"\u8d26\u53f7\u6388\u6743"),i.createElement("span",null,"\u8bf7\u586b\u5199\u4ee5\u4e0b\u4fe1\u606f"),i.createElement(s.Dialog.Body,null,i.createElement(s.Form,{model:t,ref:"form",rules:this.state.rules},i.createElement(s.Form.Item,{label:"",prop:"username"},i.createElement(s.Input,{value:t.username,placeholder:"\u7528\u6237\u540d",onChange:this.onChange.bind(this,"username")})),i.createElement(s.Form.Item,{label:"",prop:"password"},i.createElement(s.Input,{value:t.password,placeholder:"\u5bc6\u7801",type:"password",onChange:this.onChange.bind(this,"password")}))))),i.createElement(s.Dialog.Footer,{className:"authorizationFooter"},i.createElement(s.Button,{onClick:function(){return e.setState({visible:!1})}},"\u53d6 \u6d88"),i.createElement(s.Button,{type:"primary",onClick:this.sure},"\u786e \u5b9a")))},t}(i.Component),d=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={visible:!1,form:{username:"",smscode:""},rules:{username:[{required:!0,message:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7",trigger:"blur"},{validator:function(e,t,n){/^1[34578]\d{9}$/.test(t)?n():n(new Error("\u8bf7\u8f93\u5165\u6b63\u786e\u624b\u673a\u53f7"))},trigger:"blur"}],smscode:[{required:!0,message:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",trigger:"blur"}]},disableButton:!1,time:60,timing:""},t.sure=function(e){e.preventDefault(),t.refs.form.validate((function(e){if(!e)return!1;var n=t.state.form;l.h.post("/thirdauth/baidu/smscodecheck",(0,u.Z)({},n)).then((function(e){2e4===e.data.code&&t.add()}))}))},t}(0,a.Z)(t,e);var r=t.prototype;return r.timing=function(){var e=this,t=setInterval((function(){var t=--e.state.time;e.setState({time:t}),0===t&&(clearInterval(e.state.timing),e.setState({time:60,timing:"",disableButton:!1}))}),1e3);this.setState({timing:t})},r.show=function(){this.setState({visible:!0})},r.onChange=function(e,t){var n;this.setState({form:Object.assign(this.state.form,(n={},n[e]=t,n))})},r.getCode=function(){var e=this;this.refs.form.validateField("username",(function(t,n){if(t)return!1;var r=e.state.form;l.h.post("/thirdauth/baidu/userpwdcheck",{username:r.username}).then((function(t){2e4===t.data.code&&(m.Z.success("\u53d1\u9001\u6210\u529f"),e.setState({disableButton:!0}),e.timing())}))}))},r.add=function(){var e=this,t=this.state.form;l.h.post("/thirdauth/add",(0,u.Z)({platformType:"BAIDU"},t)).then((function(t){e.resetForm(),m.Z.success("\u6388\u6743\u6210\u529f"),e.props.done()}))},r.resetForm=function(){this.refs.form.resetFields(),this.setState({visible:!1,form:{username:"",smscode:""}})},r.componentDidMount=function(){},r.render=function(){var e=this,t=this.state.form;return i.createElement(s.Dialog,{className:"authorizationWrap",title:"",size:"tiny",style:{width:"460px"},visible:this.state.visible,onCancel:function(){return e.setState({visible:!1})}},i.createElement("div",{className:"authorization"},i.createElement("div",{className:"img"},i.createElement("img",{src:n(16586),alt:""})),i.createElement("p",null,"\u8d26\u53f7\u6388\u6743"),i.createElement("span",null,"\u8bf7\u586b\u5199\u4ee5\u4e0b\u4fe1\u606f"),i.createElement(s.Dialog.Body,{className:"tieba"},i.createElement(s.Form,{model:t,ref:"form",rules:this.state.rules},i.createElement(s.Form.Item,{label:"",prop:"username"},i.createElement(s.Input,{value:t.username,placeholder:"\u624b\u673a\u53f7",onChange:this.onChange.bind(this,"username")})),i.createElement(s.Form.Item,{label:"",prop:"smscode",className:"codeInput"},i.createElement(s.Input,{value:t.smscode,placeholder:"\u9a8c\u8bc1\u7801",onChange:this.onChange.bind(this,"smscode")})),i.createElement(s.Button,{disabled:this.state.disableButton,onClick:this.getCode.bind(this),type:"primary"},this.state.disableButton?this.state.time+"\u79d2\u540e\u53ef\u91cd\u53d1":"\u83b7\u53d6\u77ed\u4fe1\u9a8c\u8bc1\u7801")))),i.createElement(s.Dialog.Footer,{className:"authorizationFooter"},i.createElement(s.Button,{onClick:function(){return e.setState({visible:!1})}},"\u53d6 \u6d88"),i.createElement(s.Button,{type:"primary",onClick:this.sure},"\u786e \u5b9a")))},t}(i.Component),p=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(t=e.call.apply(e,[this].concat(a))||this).state={data:null,columns:[{label:"\u7b2c\u4e09\u65b9\u5e73\u53f0",prop:"platformTypeStr"},{label:"\u7b2c\u4e09\u65b9\u7528\u6237\u540d",prop:"name",render:function(e){return i.createElement("div",null,e.platformUsername||"\u6682\u65e0")}},{label:"\u6240\u6709\u8005",prop:"username"},{label:"\u6388\u6743\u65e5\u671f",render:function(e){return i.createElement("div",null,e.createdAt.replace("T"," ").substring(0,11))}},{label:"\u8fc7\u671f\u65f6\u95f4",prop:"name",render:function(e){return i.createElement("div",null,e.expiredAt&&e.expiredAt.replace("T"," ").substring(0,11))}},{label:"\u72b6\u6001",prop:"statusStr"},{label:"\u64cd\u4f5c",render:function(e,n,a){return i.createElement("div",{className:"operate"},i.createElement("a",{href:"javascript:;",className:"operation_columns",onClick:t.delete.bind((0,r.Z)(t),e.id)},"\u5220\u9664"))}}]},t.getList=function(e){l.h.post("/thirdauth/list",{projectId:t.state.id}).then((function(e){t.setState({data:null},(function(n){return t.setState({data:e.data.result})}))}))},t.handleAuthorizationWeiBo=function(e){l.h.get("/weibo/apply").then((function(e){window.open(e.data.result)}))},t.authorization=function(e){t.refs[e].show()},t}(0,a.Z)(t,e);var u=t.prototype;return u.componentDidMount=function(){this.getList()},u.delete=function(e){var t=this;s.MessageBox.confirm("\u786e\u8ba4\u5220\u9664\u7b2c\u4e09\u65b9\u6388\u6743?","\u63d0\u793a",{type:"warning"}).then((function(){l.h.post("/thirdauth/delete",{id:e}).then((function(e){t.getList()}))}))},u.finish=function(){this.getList()},u.render=function(){var e=this,t=this.state,r=t.data,a=(t.id,t.columns);t.dialogVisible,t.formZhiHu;return i.createElement("div",null,i.createElement(c.Z,{title:"\u6388\u6743\u7ba1\u7406"}),i.createElement("div",{className:"top-bar "},i.createElement("div",{className:"wrap authorization-wrap"},"\u70b9\u51fb\u56fe\u6807\u6388\u6743\u5e73\u53f0\u8d26\u53f7"),i.createElement("ul",{className:"authorization-platform"},i.createElement("li",{onClick:this.handleAuthorizationWeiBo},i.createElement("img",{src:n(59973),alt:"\u5fae\u535a",title:"\u5fae\u535a"})),i.createElement("li",{onClick:function(t){return e.authorization("zhihu")}},i.createElement("img",{src:n(11380),alt:"\u77e5\u4e4e",title:"\u77e5\u4e4e"})),i.createElement("li",{onClick:function(t){return e.authorization("tieba")}},i.createElement("img",{src:n(16586),alt:"\u8d34\u5427",title:"\u8d34\u5427"})))),i.createElement(o.Z,{columns:a,data:r}),i.createElement(h,{ref:"zhihu",done:this.finish.bind(this)}),i.createElement(d,{ref:"tieba",done:this.finish.bind(this)}))},t}(i.Component)},12518:(e,t,n)=>{n.d(t,{Z:()=>u});var r=n(94578),a=n(67294),i=n(45697),s=n.n(i),o=n(61409),l=n(92360),c=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this)._handleBreadcrumbClick=function(e){var n=t.props.title;e!==n.length-1&&o.mW.go(e-n.length+1)},t}return(0,r.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,r=t.rightContent;return a.createElement("div",{className:"secondary-header"},n instanceof Array?a.createElement(l.Breadcrumb,{className:"breadcrumb-style",separator:""},n.map((function(t,n){return a.createElement(l.Breadcrumb.Item,{key:n},a.createElement("span",{onClick:function(){return e._handleBreadcrumbClick(n)}},t))}))):a.createElement("div",{className:"normal-title"},n),r&&r)},t}(a.Component);c.propTypes={title:s().oneOfType([s().string,s().array]).isRequired,rightContent:s().node};const u=c},16586:(e,t,n)=>{e.exports=n.p+"img/065e5cbb6e8ab1afa7b4.png"},59973:(e,t,n)=>{e.exports=n.p+"img/b1e61aefbabed49f5820.png"},11380:(e,t,n)=>{e.exports=n.p+"img/b94486f5f2c2a9d8866d.png"}}]);