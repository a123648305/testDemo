"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[8651],{48651:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var a=n(87462),i=n(94578),o=n(67294),l=n(92360),c=n(5133),r=n(29383),s=n(49722),u=n(55815),d=n(61193),p=n(61409),m=n(35239),g=function(e){var t=e.title,n=e.url;return[{title:m.t.get(m.V.backProjectConfig).name,url:"/account/project/preview"},{title:"\u4e3b\u9898\u7ba1\u7406",url:"/account/project/topic"},{title:t,url:n}]},h=d.Z.hasAuthority("PROJECT_EDIT")||d.Z.hasAuthority("PROJECT_DELETE"),f=function(e){function t(t){var n;(n=e.call(this,t)||this).fetchTopicValueList=function(){var e=n.state,t=e.topicId,a=e.pageIndex,i=e.pageSize,o=e.sortName,l=e.sortType;n.setState({loading:!0},(function(){s.h.post("/project/config/value/list",{projectConfigId:t,configValueIdList:[],pageIndex:a,pageSize:i,sortModelList:[{sortName:o,sortType:l},{sortName:"CONFIG_VALUE",sortType:"DESC"}]}).then((function(e){if(2e4===e.data.code){var t=e.data.result,a=t.list,i=t.total;t.emptyCount;n.setState({data:a,total:i})}})).finally((function(){return n.setState({loading:!1})}))}))},n.handleSort=function(e){var t=e.prop,a=t?"configValue"===t?"CONFIG_VALUE":"COUNT":"CREATED_AT",i="ascending"===e.order?"ASC":"DESC";n.setState({sortName:a,sortType:i},(function(){return n.fetchTopicValueList(!0)}))},n.switchPage=function(e){n.setState({pageIndex:e},(function(){return n.fetchTopicValueList(!0)}))},n.switchPageSize=function(e){n.setState({pageSize:e,pageIndex:1},(function(){return n.fetchTopicValueList(!0)}))},n.handleNameChange=function(e){var t=n.state.targetTopicValue;n.setState({targetTopicValue:(0,a.Z)({},t,{name:e})})},n.handleConfirm=function(){switch(n.state.dialogType){case"add":n.handleAddTopicVal();break;case"rename":n.handleRenameTopicVal();break;case"delete":n.handleDeleteTopicVal()}},n.handleCancel=function(){n.setState({dialogVisible:!1,targetTopicValue:{id:"",name:""}})},n.handleAddTopicVal=function(){var e=n.state,t=e.targetTopicValue.name,a=e.topicId;0!==t.trim().length?s.h.post("/project/config/value/add",{id:a,name:t,parentId:null}).then((function(e){2e4===e.data.code&&(c.Z.success("\u6dfb\u52a0\u6210\u529f"),n.handleCancel(),n.fetchTopicValueList(!1))})):c.Z.warning("\u8bf7\u8f93\u5165\u4e3b\u9898\u503c\u540d\u79f0")},n.handleRenameTopicVal=function(){var e=n.state.targetTopicValue,t=e.id,a=e.name;0!==a.trim().length?s.h.post("/project/config/value/update",{id:t,configValue:a}).then((function(e){2e4===e.data.code&&(c.Z.success("\u66f4\u65b0\u6210\u529f"),n.fetchTopicValueList(!1),n.handleCancel())})):c.Z.warning("\u8bf7\u8f93\u5165\u4e3b\u9898\u503c\u540d\u79f0")},n.handleDeleteTopicVal=function(){var e=n.state.targetTopicValue.id;s.h.post("/project/config/value/delete",{id:e}).then((function(e){2e4===e.data.code&&(c.Z.success("\u5220\u9664\u6210\u529f"),n.fetchTopicValueList(!1),n.handleCancel())}))},n.goLinkList=function(e){if(e){var t=n.state.topicId,a=m.t.get(m.V.connectionFilter)?JSON.parse(m.t.get(m.V.connectionFilter)):{filterModel:{}};a.filterModel.connConfig=[{id:t,values:[e]}],m.t.set(m.V.connectionFilter,JSON.stringify(a)),p.mW.push({pathname:"/account/project/comment"})}};var i=t.location.state;return n.state={title:g({title:i.name}),topicId:i.id,topicName:i.name,targetTopicValue:{id:"",name:""},dialogType:"",dialogVisible:!1,pageIndex:1,pageSize:20,total:0,loading:!1,data:[],sortName:"CREATED_AT",sortType:"DESC",columns:h?[{label:"",prop:"paddingLeft",width:50},{label:"\u4e3b\u9898\u503c",prop:"configValue",sortable:"custom"},{label:"\u94fe\u63a5\u6570",sortable:"custom",prop:"userConnectionCount",render:function(e){return o.createElement("span",{className:e.id?"operation_columns":"",onClick:function(){return n.goLinkList(e.id)}},e.userConnectionCount)}},{label:"\u64cd\u4f5c",prop:"operate",render:function(e,t,a){return o.createElement("div",{className:"operations"},d.Z.hasAuthority("PROJECT_EDIT")&&e.id&&o.createElement(l.Button,{type:"text",className:"operation_columns",onClick:function(){return n.setState({dialogType:"rename",dialogVisible:!0,targetTopicValue:{id:e.id,name:e.configValue}})},disabled:e.configValue.includes("\u7a7a\u503c")},"\u91cd\u547d\u540d"),d.Z.hasAuthority("PROJECT_EDIT")&&e.id&&o.createElement(l.Button,{type:"text",className:"operation_columns",onClick:function(){return n.setState({dialogType:"delete",dialogVisible:!0,targetTopicValue:{id:e.id,name:e.configValue}})},disabled:e.configValue.includes("\u7a7a\u503c")},"\u5220\u9664"))}}]:[{label:"",prop:"paddingLeft",width:50},{label:"\u4e3b\u9898\u503c",prop:"configValue",sortable:"custom"},{label:"\u94fe\u63a5\u6570",sortable:"custom",prop:"userConnectionCount",render:function(e){return o.createElement("span",{className:"operation_columns",onClick:function(){return n.goLinkList(e.id)}},e.userConnectionCount)}}]},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.fetchTopicValueList(!0)},n.render=function(){var e=this,t=this.state,n=t.data,a=t.title,i=t.columns,c=t.total,s=t.loading,d=t.pageIndex,p=t.pageSize,m=t.dialogType,g=t.dialogVisible,h=t.targetTopicValue,f=t.topicName,E=document.documentElement.clientHeight-46-78-24;return o.createElement("div",{className:"flex-col"},o.createElement("div",{className:"flex-other container"},o.createElement(u.Z,{title:a,rightContent:o.createElement(l.Button,{type:"primary",onClick:function(){return e.setState({dialogType:"add",dialogVisible:!0})}},"\u6dfb\u52a0\u4e3b\u9898\u503c")}),o.createElement("div",{className:"topicValue"},o.createElement("div",{style:{minHeight:E}},o.createElement(l.Loading,{loading:s,text:"\u62fc\u547d\u52a0\u8f7d\u4e2d"},o.createElement(r.Z,{columns:i,data:n,total:c,pagePosition:"down",pageSize:p,currentPage:d,onPage:this.switchPage,onSortChange:this.handleSort,rowClassName:function(e){return e.id?"":"highlight-row"},pageSizeSelectorShow:!0,onPageSizeChange:this.switchPageSize,notLimit:!0}))),o.createElement(l.Dialog,{title:"rename"===m?"\u91cd\u547d\u540d\u4e3b\u9898\u503c":"add"===m?"\u6dfb\u52a0\u4e3b\u9898\u503c":"",size:"tiny",visible:g,onCancel:function(){return e.handleCancel()},customClass:"toggle"===m?"without-padding-dialogbody":"",lockScroll:!0},o.createElement(l.Dialog.Body,null,"delete"===m&&o.createElement(o.Fragment,null,o.createElement("div",{className:"dialog-title"},o.createElement("i",{className:"icon-cem_warning",style:{color:"#D96969"}}),"\u662f\u5426\u5220\u9664\u8be5\u4e3b\u9898\u503c\uff1f"),o.createElement("div",{className:"delete-tips"},"\u5220\u9664",o.createElement("span",{style:{color:"#262626",fontWeight:"bold"}},"\u201c",h.name,"\u201d"),"\u540e\uff0c\u539f\u672c\u6807\u8bb0\u4e3a",o.createElement("span",{style:{color:"#262626",fontWeight:"bold"}},"\u201c",h.name,"\u201d"),"\u7684\u63d0\u6570\u4efb\u52a1\u5c06\u5728",f,"\u8fd9\u4e2a\u4e3b\u9898\u4e0a\u9ed8\u8ba4\u81ea\u52a8\u5f52\u4e3a",o.createElement("span",{style:{color:"#262626",fontWeight:"bold"}},"\u201c\u7a7a\u503c\u201d"),"\u3002")),("add"===m||"rename"===m)&&o.createElement(o.Fragment,null,o.createElement("div",{className:"form-item"},o.createElement("label",null,"\u4e3b\u9898\u503c\u540d\u79f0"),("add"===m||"rename"===m)&&o.createElement(l.Input,{value:h.name,placeholder:"\u8bf7\u8f93\u5165\u4e3b\u9898\u503c\u540d\u79f0",onChange:this.handleNameChange})))),o.createElement(l.Dialog.Footer,{className:"dialog-footer"},o.createElement(l.Button,{type:"primary",onClick:this.handleConfirm},"delete"===m?"\u662f":"\u786e\u5b9a"),!("add"===m)&&o.createElement(l.Button,{onClick:function(){return e.handleCancel()}},"delete"===m?"\u5426":"\u53d6\u6d88"))))))},t}(o.PureComponent)},55815:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(94578),i=n(67294),o=n(45697),l=n.n(o),c=n(43036),r=n(61409),s=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props,a=n.title,i=n.beforeJump;e!==a.length-1&&(i?new Promise((function(e,t){return i(e,t)})).then((function(){r.mW.push({pathname:a[e].url,state:a[e].state})})):r.mW.push({pathname:a[e].url,state:a[e].state}))},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.mainTitle,o=t.rightContent,l=t.className,r=t.overlay;return i.createElement("div",{className:"breadcumb-wrapper "+l},n instanceof Array?i.createElement("div",{className:"breadcrumb-left"},i.createElement("div",null,n.map((function(t,a){return i.createElement("span",{className:t.url?"":"not_clickable",key:a,onClick:function(){return t.url&&a!==n.length-1&&e._handleBreadcrumbClick(a)}},t.title,a!==n.length-1&&" / ")}))),i.createElement("span",null,a||n[n.length-1].title,r&&i.createElement(c.Z,{placement:"top",overlay:r},i.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}})))):i.createElement("div",{className:"normal-title"},n,r&&i.createElement(c.Z,{placement:"top",overlay:r},i.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}}))),o||"")},t}(i.Component);s.propTypes={className:l().string,title:l().oneOfType([l().string,l().arrayOf(l().shape({title:l().string,url:l().string,state:l().object}))]).isRequired,overlay:l().oneOfType([l().string,l().node]),mainTitle:l().oneOfType([l().string,l().node]),beforeJump:l().func,rightContent:l().node};const u=s}}]);