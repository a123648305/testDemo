"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[9914],{78436:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(94578),r=n(67294),i=n(94644),l=function(e){function t(){var t;return(t=e.call(this)||this).isEmpty=!0,t.group=function(e){t.myChart.group=e,t.echarts.connect(e)},t.refreshChart=function(e){t.setState(e)},t.setWidth=function(e){t.refs.chart.style.width=e,t.init()},t.loading=function(){t.myChart.clear(),t.myChart.showLoading({text:"\u62fc\u547d\u52a0\u8f7d\u4e2d",color:"#20a0ff",maskColor:"rgba(255, 255, 255, 0.9)",zlevel:0})},t.setOption=function(e){if(e.textStyle={fontFamily:"'PingFang SC','Microsoft Yahei', 'Helvetica Neue', Helvetica, Tahoma, Arial, 'Hiragino Sans GB', 'WenQuanYi Micro Hei', sans-serif"},e.legend&&(e.legend.data=e.legend.data.map((function(e){return{name:e,icon:"circle"}})),e.legend.itemWidth=10,e.legend.itemHeight=10),e.tooltip&&!e.tooltip.extraCssText?(e.tooltip.backgroundColor="rgba(255,255,255,0.9)",e.tooltip.textStyle={color:"#262626"},e.tooltip.extraCssText="box-shadow: 0 0 7px rgba(0, 0, 0, 0.3);"):e.tooltip&&(e.tooltip=e.tooltip),e.series.forEach((function(e){"line"===e.type&&(e.showAllSymbol=!0,e.symbol="circle",e.symbolSize=2,e.itemStyle={normal:{borderColor:"rgba(255,255,255,0)",borderWidth:5}})})),e.hoverLayerThreshold=500,e.progressiveThreshold=500,e.animationThreshold=500,t.myChart){var n;t.myChart.clear(),t.myChart.hideLoading();for(var a=arguments.length,r=new Array(a>1?a-1:0),i=1;i<a;i++)r[i-1]=arguments[i];(n=t.myChart).setOption.apply(n,[e].concat(r)),t.isEmpty=!1}},t.setEmptyOption=function(e){var a=t.myChart.getHeight(),r=t.myChart.getWidth(),i=Math.min(a/2,r/2,20),l={type:"pie",radius:[0,0],center:["50%","50%"],silent:!0,data:[{value:0,name:"",label:{normal:{show:!0,position:"center",backgroundColor:{image:n(3381)},padding:i,formatter:function(){return""}}}},{value:0,name:"",label:{normal:{show:!0,position:"center",formatter:function(){return"{a|\n}{b|"+e+"}"},rich:{a:{height:i+60},b:{fontSize:20,color:"#999"}}}}}]};t.myChart&&(t.myChart.clear(),t.myChart.hideLoading(),t.myChart.setOption({series:l,animation:!1},!0),t.isEmpty=!0)},t.init=function(){t.echarts.getInstanceByDom(t.refs.chart)&&t.echarts.dispose(t.refs.chart);var e=t.echarts.init(t.refs.chart);t.myChart=e,t.props.myChartClick&&e.on("click",(function(e){t.isEmpty||t.props.myChartClick(e)})),t.props.dataZoomChange&&e.on("dataZoom",(function(e){t.isEmpty||t.props.dataZoomChange(e)}))},t.downloadExcel=function(e,t){(0,i.aT)([[t].concat(e)],"")},t.echarts=n(70596),t}(0,a.Z)(t,e);var l=t.prototype;return l.componentDidMount=function(){this.init()},l.componentWillUnmount=function(){this.myChart.dispose()},l.render=function(){var e=this.props.minHeight,t=Object.assign({},e?{minHeight:e}:{});return r.createElement("div",{ref:"chart",className:"widget-chart",style:t})},t}(r.Component)},49914:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var a=n(87462),r=n(94578),i=n(67294),l=n(92360),c=n(49722),o=n(29383),s=n(26687),u=n(35239),m=function(e){function t(t){var n;return(n=e.call(this,t)||this).getConfigList=function(){var e=(0,a.Z)({},n.state),t=n.state.columns,r=[];c.h.post("/projects/config/list",[n.projectId]).then((function(i){i.data.result.filter((function(t){return 0===e.columns.filter((function(e){return e.label===t.configName})).length})).map((function(e,t){var n,a=[0,1,2].indexOf(t)>=0;n={label:e.configName,prop:e.id,checked:a,minWidth:"\u5546\u54c1\u540d\u79f0"===e.configName?"150":"60"},r.push(n)}));var l=[],c=t.slice(0);n.props.showSelectColumns?(c.splice.apply(c,[1,0].concat(r)),l=n.refs.SelectableColumns?n.refs.SelectableColumns.competeSelectMenuItem(c):null===u.t.get(u.V.storageColumns)||""===u.t.get(u.V.storageColumns)?c:JSON.parse(u.t.get(u.V.storageColumns)).price_check):l=c,n.setState((0,a.Z)({},e,{selectMenuItem:l}))}))},n.getShowColumns=function(e){n.setState({selectMenuItem:e})},n.open=function(e){var t=n.state.data;t.forEach((function(t){t.openId===e.openId&&(t.open=!0)})),n.setState({data:t})},n.onExpand=function(e,t){var a=n.state.data;a.forEach((function(t){t.openId===e.openId&&(t.open=!1)})),n.setState({data:a})},n.state={selectMenuItem:[],defaultColumns:[],expandPannel:[{type:"expand",expandPannel:function(e){return i.createElement("div",{className:"expandPannel-wrapper"},e?i.createElement("div",null,i.createElement("div",null,i.createElement("a",{href:e.url,target:"_blank"},i.createElement("img",{src:e.image,alt:""}))),i.createElement("div",null,i.createElement("div",{className:"title"},e.title),e.slogan&&i.createElement("div",{className:"slogan"},e.slogan),i.createElement("p",{className:"price"},i.createElement("span",null,i.createElement("i",null,"\u6302\u724c\u4ef7"),i.createElement("span",null,-1===e.listPrice?"\u5df2\u4e0b\u67b6":e.listPrice)),i.createElement("span",null,i.createElement("i",null,"\u6700\u4f4e\u5230\u624b\u4ef7"),i.createElement("span",null,-1===e.takePrice?"\u5df2\u4e0b\u67b6":e.minPrice))),i.createElement("p",{className:"info"},"\u4fc3\u9500\u4fe1\u606f"),""!==e.rate[0]?i.createElement("div",{className:"rateMessage"},e.rate.length>0&&e.rate.map((function(t,n){var a=t.split(":&:");return i.createElement("div",{style:{float:e.open||1===e.rate.length?"":"left"},key:n},i.createElement("span",null,a[0]),(e.open||1===e.rate.length)&&i.createElement("span",null,a[1]))})),!e.open&&e.rate.length>1&&i.createElement("div",{className:"open",onClick:function(t){return n.open(e)}},"\u5c55\u5f00\u4fc3\u9500 ",i.createElement("i",{className:"icon-cem_pull-down-or-take-up "})," ")):i.createElement("div",{style:{color:"#262626",fontSize:"12px"}},"\u65e0\u4fc3\u9500\u4fe1\u606f"))):i.createElement("div",{className:"no-data"},"\u6682\u65e0\u6570\u636e"))}}],columns:t.columns,pageSize:20,pageIndex:1},n}(0,r.Z)(t,e);var n=t.prototype;return n.UNSAFE_componentWillReceiveProps=function(e,t){var n=(0,a.Z)({},e);this.setState((0,a.Z)({},n))},n.componentDidMount=function(){this.projectId=u.t.get(u.V.curProject).id,this.getConfigList()},n.clickHandeler=function(e,t,n){this.state.clickHandeler(e,t,n)},n.rowClick=function(e,t,n){document.querySelectorAll(".el-table__expand-icon")[e.openId].click()},n.render=function(){var e=this.state,t=e.data,n=e.count,a=e.expandPannel,r=e.selectMenuItem,l=e.showSelectColumns,c=e.columns,u=e.pagePosition;return t&&t.forEach((function(e,t){return e.openId=t})),l&&r.map((function(e,t){return e.render=c.filter((function(t){return t.label===e.label})).length>0?c.filter((function(t){return t.label===e.label}))[0].render:function(t,n,a){return i.createElement("span",null,t[e.prop])}})),i.createElement("div",{className:"priceTable-wrapper"},l&&i.createElement(s.Z,{ref:"SelectableColumns",multiSave:{name:"price_check"},columns:r||[],getShowColumns:this.getShowColumns}),i.createElement(o.Z,{ref:"table",columns:a.concat(l?r?r.filter((function(e){return e.checked})):[]:c),data:t,total:n,pagePosition:u,pageSize:this.state.pageSize,currentPage:this.state.pageIndex,onPage:this.state.getPageTable,onExpand:this.onExpand,onRowClick:this.rowClick}))},t}(i.Component),p=n(78436),d=n(45697),h=n.n(d),f=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).json=null,t.timeId=null,t.dataZoomChange=function(e){var n=e.start,a=e.end;t.timeId&&clearTimeout(t.timeId);var r=t.props,i=r.data,l=r.dataZoomChange;if(l){var c=i.map((function(e){return e[0]})),o=c[Math.floor(c.length*n/100)],s=c[Math.floor(c.length*a/100)-1];t.min=n,t.max=a,o=(o=(o=o.replace("\u5e74","-")).replace("\u6708","-")).replace("\u65e5",""),s=(s=(s=s.replace("\u5e74","-")).replace("\u6708","-")).replace("\u65e5",""),t.timeId=setTimeout((function(){l(o,s)}),500)}},t.buildChart=function(){var e,n=t.props,a=n.data,r=n.type,i=n.priceType,l=n.priceName;if(!a||!a.length)return null;var c=a.map((function(e){return e})),o=c[c.length-1].map((function(e){return e}));o[0]="\u5f53\u524d\u65f6\u95f4",(r&&"amount"!==r||!r)&&c.push(o);var s={color:["#2985ff","#A9A557"],tooltip:{trigger:"axis",formatter:function(e){return e[0].axisValue+e.map((function(e){var t=e.value[1];return"<br/>"+e.marker+e.seriesName+"\uff1a"+((r&&"amount"!==r||!r)&&0===t?"\u5df2\u4e0b\u67b6":t)})).join("")}},legend:{orient:"vertical",right:20,top:80,data:r&&"amount"===r?["\u9500\u91cf"]:[l,"\u6302\u724c\u4ef7"],selected:r&&"amount"===r?{"\u9500\u91cf":!0}:(e={"\u6302\u724c\u4ef7":!1},e[l]=!0,e)},grid:{left:64,right:95,top:0,bottom:40,containLabel:!0},xAxis:[{show:!0,type:"category",boundaryGap:!1,data:c.map((function(e){return e[0]})),axisTick:{show:!1},axisLabel:{formatter:function(e){return e.indexOf("\u65f6\u95f4")?e:e.split("\u65f6")[0]+"\u65f6"}}}],yAxis:[{type:"value",boundaryGap:["20%","20%"],axisTick:{show:!1},scale:!0,splitLine:{show:!1},axisLabel:{showMinLabel:!1,showMaxLabel:!1}}],dataZoom:{type:"slider",xAxisIndex:0,showDetail:!1,bottom:0},series:r&&"amount"===r?[{name:"\u9500\u91cf",type:"line",step:"end",data:c.map((function(e){return[e[0],-1===e[1]?0:e[1]]}))}]:[{name:l,type:"line",step:"end",data:c.map((function(e){return[e[0],-1===e[i]?0:e[i]]}))},{name:"\u6302\u724c\u4ef7",type:"line",step:"end",data:c.map((function(e){return[e[0],-1===e[1]?0:e[1]]}))}]};t.chart.myChart.getOption&&t.chart.myChart.getOption()&&t.chart.myChart.getOption().legend&&(s.legend.selected=t.chart.myChart.getOption().legend[0].selected),t.chart.setOption(s)},t}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){this.json===JSON.stringify(this.props.data)&&e.priceType===this.props.priceType||(this.json=JSON.stringify(this.props.data),this.buildChart())},n.componentDidMount=function(){this.width=this.widget.offsetWidth,this.height=this.widget.offsetHeight,this.props.data&&this.buildChart()},n.render=function(){var e=this;return i.createElement("div",{ref:function(t){return e.widget=t},className:"widget-container"},i.createElement("div",{className:"widget-body"},i.createElement(p.Z,{minHeight:255,ref:function(t){return e.chart=t},className:"widget-chart",dataZoomChange:this.dataZoomChange})))},t}(i.Component);f.propTypes={type:h().string};var g=n(50976),y=n(43036),v=n(37841),b=n(70715),C=function(e){function t(t){var n;return(n=e.call(this,t)||this).init=function(){n.setState((0,a.Z)({},n.props))},n.handleTabChange=function(e){n.setState({yAxisNum:e})},n.state={configs:[],chartList:[],yAxisNum:2},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.init()},n.UNSAFE_componentWillReceiveProps=function(e){this.setState((0,a.Z)({},e))},n.render=function(){var e=this.state,t=e.configs,n=e.chartList,a=e.yAxisNum,r=this.props.onDataZoomChange,l=n.length>0?n.map((function(e){var t=e.date,n=e.takePrice,a=e.listPrice,r=Number(a)-Number(n),i=Number.isInteger(r)?r:r.toFixed(2);return{date:t,takePrice:Number(n),listPrice:Number(a),discount:i}})):[],c=JSON.parse(JSON.stringify(l));l.sort((function(e,t){return t.takePrice-e.takePrice}));var o=n.length>0?n[n.length-1].takePrice:"",s=n.length>0?l[0]:{date:"",takePrice:""},u={date:"",takePrice:""};if(n.length>0)for(var m=l.length-1;m>=0;m--)if(l[m].takePrice>0){u=l[m];break}var p={title:{text:"\u4ef7\u683c\u8d70\u52bf",left:0,top:0},tooltip:{trigger:"axis"},legend:{left:"0",top:36,itemGap:26,itemHeight:10,icon:b.W4.lineRing,data:[{name:"\u6700\u4f4e\u5230\u624b\u4ef7"},{name:"\u6302\u724c\u4ef7"},{name:"\u4f18\u60e0\u529b\u5ea6"}]},grid:{left:10,right:10,top:100,bottom:50,containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:n.length>0?c.map((function(e){return e.date})):[]},yAxis:2===a?[{type:"value"},{type:"value"}]:[{type:"value"}],series:[{name:"\u6700\u4f4e\u5230\u624b\u4ef7",z:3,type:"line",data:n.length>0?c.map((function(e){return e.takePrice})):[],showSymbol:!1},{name:"\u6302\u724c\u4ef7",type:"line",data:n.length>0?c.map((function(e){return e.listPrice})):[],showSymbol:!1},{name:"\u4f18\u60e0\u529b\u5ea6",type:"line",data:n.length>0?c.map((function(e){return e.discount})):[],showSymbol:!1,areaStyle:{color:"#FCF5F1"},yAxisIndex:2===a?1:0}],dataZoom:{id:"dataZoomX",type:"slider",xAxisIndex:[0],filterMode:"filter",start:75,end:100}};return i.createElement("div",{className:"history-price-trend-wrapper"},i.createElement("div",null,i.createElement("div",{className:"title"},"\u5546\u54c1\uff08sku\uff09\u4ef7\u683c\u6982\u89c8"),t[0]&&t[0].configName&&i.createElement("div",{className:"item"},i.createElement("span",null,t[0].configName),i.createElement("span",null,t[0].configValue)),t[1]&&t[1].configName&&i.createElement("div",{className:"item"},i.createElement("span",null,t[1].configName),i.createElement("span",null,t[1].configValue)),i.createElement("div",{className:"item"},i.createElement("span",null,"\u6700\u4f4e\u5230\u624b\u4ef7"),i.createElement("span",null,o)),i.createElement("div",{className:"item"},i.createElement("span",null,"\u5386\u53f2\u6700\u9ad8"),i.createElement("span",null,"\uffe5",s.takePrice),i.createElement("span",null,"\uff08",s.date,"\uff09")),i.createElement("div",{className:"item"},i.createElement("span",null,"\u5386\u53f2\u6700\u4f4e"),i.createElement("span",null,"\uffe5",u.takePrice),i.createElement("span",null,"\uff08",u.date,"\uff09"))),i.createElement("div",null,i.createElement(g.Z,{theme:"yunting_price",option:p,style:{height:288,width:"100%"},onEvents:{dataZoom:r}}),i.createElement(y.Z,{placement:"top",overlay:"\u4e0e\u6700\u4f4e\u65f6\u523b\u5bf9\u5e94\u7684\u6302\u724c\u4ef7"},i.createElement("i",{className:"icon-cem_file1"})),i.createElement(y.Z,{placement:"top",overlay:"\u4e0e\u6700\u4f4e\u65f6\u523b\u5bf9\u5e94\u7684\u6302\u724c\u4ef7"},i.createElement("i",{className:"icon-cem_file1"})),i.createElement(v.Z,{activeKey:a,options:[{key:"\u5355\u8f74",value:1},{key:"\u53cc\u8f74",value:2}],onTabClick:this.handleTabChange})))},t}(i.Component),E=n(55815),k=n(30381),P=n.n(k),S=n(60496),x="YYYY-MM-DD",N=[{title:"\u5355\u54c1\u5230\u624b\u4ef7",value:2,key:"takePrice"},{title:"\u5355\u54c1\u62fc\u5355\u4ef7",value:3,key:"groupTakePrice"},{title:"\u5b8c\u7f8e\u62fc\u5355\u4ef7",value:4,key:"perfectGroupTakePrice"}],w=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(t=e.call.apply(e,[this].concat(r))||this).state={data:[],priceType:2,showPriceOnly:!0,chartData:[],minPrice:0,maxPrice:0,currentPrice:0,priceName:"\u5355\u54c1\u5230\u624b\u4ef7",count:0,pageSize:40,pageIndex:1,params:{},columns:[{label:"\u65f6\u95f4",minWidth:"170",render:function(e){return i.createElement("div",null,t.formatterTime(e.ctime))}},{label:"\u5355\u54c1\u5230\u624b\u4ef7",prop:"takePrice",minWidth:"70",render:function(e){return i.createElement("span",null,-1!==e.takePrice?e.takePrice:"\u4e0b\u67b6")}},{label:"\u5355\u54c1\u62fc\u5355\u4ef7",prop:"groupTakePrice",minWidth:"70",render:function(e){return i.createElement("span",null,-1!==e.takePrice?e.groupTakePrice:"\u4e0b\u67b6")}},{label:"\u5b8c\u7f8e\u62fc\u5355\u4ef7",prop:"perfectGroupTakePrice",minWidth:"70",render:function(e){return i.createElement("span",null,-1!==e.takePrice?e.perfectGroupTakePrice:"\u4e0b\u67b6")}},{label:"\u6700\u4f4e\u5230\u624b\u4ef7",prop:"minPrice",minWidth:"70",render:function(e){return i.createElement("span",null,-1!==e.takePrice?e.minPrice:"\u4e0b\u67b6")}},{label:"\u6302\u724c\u4ef7",prop:"listPrice",minWidth:"70",render:function(e){return i.createElement("span",null,-1!==e.minPrice?e.listPrice:"\u4e0b\u67b6")}},{label:"\u4f18\u60e0\u5408\u8ba1",prop:"rateCount",checked:!0,minWidth:"60",render:function(e){return i.createElement("span",null,0===e.rateCount?"":"-"+e.rateCount)}},{label:"\u91c7\u7eb3\u4f18\u60e0\u7b56\u7565",prop:"trueRate",checked:!0,minWidth:"150",render:function(e){return""!==e.trueRate?i.createElement("span",{className:"rate"},e.trueRate):""}}],historyPriceChartData:{configs:[],chartList:[]},historyPriceTableData:{pageIndex:1,tableList:[],total:0},source:3,selectedTabIndex:1,loading:!1},t.init=function(){var e=opener.windowPool?opener.windowPool.filter((function(e){return e.window===window}))[0].parameter:{},n=e.data,a=e.source;switch(t.params=n,t.setState({selectedTabIndex:3!==a?a:1,source:a},(function(){var e=P()().subtract(1===a?6:89,"days").format(x)+" 0\u65f60\u52060\u79d2",n=P()().format(x)+" 23\u65f659\u520659\u79d2";3!==a&&t.getPriceDetails(e,n)})),a){case 1:t.getChartData();break;case 2:t.fetchHistoryData();break;case 3:t.fetchSpuSale()}},t.getPriceDetails=function(e,n,r){var i=t.state,l=i.selectedTabIndex,o=i.pageIndex,s=i.pageSize,u=i.showPriceOnly,m=i.historyPriceTableData,p=void 0===r?t.state.priceType:r,d=(opener.windowPool?opener.windowPool.filter((function(e){return e.window===window}))[0].parameter:{}).data,h=new Date,f=h.getFullYear()+"-"+(h.getMonth()-0+1)+"-"+h.getDate()+" "+h.getHours()+":"+h.getMinutes()+":"+(h.getSeconds()<10?"0"+h.getSeconds():h.getSeconds()),g=new Date(h-6048e5),y=g.getFullYear()+"-"+(g.getMonth()+1)+"-"+g.getDate()+" "+g.getHours()+":"+g.getMinutes()+":"+(g.getSeconds()<10?"0"+g.getSeconds():g.getSeconds()),v={userConnectionId:d.userConnectionId,from:e||y,to:n||f,priceType:N[p-2].key};1===l?(v.pageIndex=o,v.pageSize=s,v.change=u):(v.pageIndex=m.pageIndex,v.pageSize=40,v.change=!0),t.setState({loading:!0},(function(){c.h.post("/price/one",v).then((function(e){e.data.result.result.map((function(e){return Object.assign.apply(Object,[e].concat(e.connectionConfig))}));var n=e.data.result.result,r=e.data.result,i=r.from,c=r.to,o=r.count;1===l?t.setState({data:n,from:i,to:c,count:o,params:v}):t.setState({historyPriceTableData:(0,a.Z)({},m,{tableList:n,total:o})})})).finally((function(){t.setState({loading:!1})}))}))},t.getChartData=function(e){var n=void 0===e?t.state.priceType:e,a={userConnectionId:t.params.userConnectionId,change:t.state.showPriceOnly,priceType:N[n-2].key,from:"2018-09-04 14:00:00",to:""};c.h.post("/price/bar",a).then((function(e){var a=[];e.data.result.forEach((function(e){var t=new Date(e.ctime),n=t.getFullYear()+"\u5e74"+(t.getMonth()+1)+"\u6708"+t.getDate()+"\u65e5 "+t.getHours()+"\u65f6"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+"\u5206"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())+"\u79d2";a.push([n,e.listPrice,e.takePrice,e.groupTakePrice,e.perfectGroupTakePrice])}));var r=a.length?a[a.length-1][n]:0,i=a.length?a.map((function(e){return e[n]})):[0],l=JSON.parse(JSON.stringify(i)).filter((function(e){return e>0})),c=Math.max.apply(Math,l),o=Math.min.apply(Math,l),s=N.find((function(e){return e.value===n})).title;t.setState({chartData:a,priceType:n,currentPrice:r,maxPrice:c,minPrice:o,priceName:s})}))},t.dataZoomChange=function(e,n){t.getPriceDetails(e,n)},t.chartClick=function(e){var n=new Date(e),a=n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate()+" "+n.getHours()+":00:00",r=new Date(a),i=new Date(r.getTime()+36e5),l=i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate()+" "+i.getHours()+":00:00";t.getPriceDetails(a,l)},t.onChangePage=function(e){var n=t.state,r=n.selectedTabIndex,i=n.historyPriceTableData;if(1===r)t.setState({pageIndex:e},(function(){return t.getPriceDetails()}));else{var l=P()().subtract(89,"days").format(x)+" 0\u65f60\u52060\u79d2",c=P()().format(x)+" 23\u65f659\u520659\u79d2";t.setState({historyPriceTableData:(0,a.Z)({},i,{pageIndex:e})},(function(){return t.getPriceDetails(l,c)}))}},t.fetchHistoryData=function(){var e=t.state.historyPriceChartData.configs,n=t.params.userConnectionId,a=u.t.get(u.V.curProject).id;c.h.post("/price/history/trend/list",{dateFilter:{from:P()().subtract(364,"days").format(x),to:P()().format(x),quickChoice:"",dateGroupType:"DAY",remoteName:"cTime"},userConnectionId:n,index:a}).then((function(n){if(2e4===n.data.code){var a=n.data.result,r=a.connConfig,i=a.data;if(r.length>0){for(var l=0;l<r.length;l++)"\u54c1\u724c"===r[l].topicTypeValue&&e.push({configName:"\u54c1\u724c",configValue:r[l].topicValue}),"\u578b\u53f7"===r[l].topicTypeValue&&e.push({configName:"\u578b\u53f7",configValue:r[l].topicValue});0===e.length&&r.length>=0&&(e.push({configName:r[0].topicTypeValue,configValue:r[0].topicValue}),r.length>1&&e.push({configName:r[1].topicTypeValue,configValue:r[1].topicValue}))}t.setState({historyPriceChartData:{configs:e,chartList:i||[]}})}}))},t.switchTab=function(e){var n=t.state,a=n.data,r=n.historyPriceChartData.chartList;if(2===e)if(0===r.length){t.fetchHistoryData();var i=P()().subtract(89,"days").format(x)+" 0\u65f60\u52060\u79d2",l=P()().format(x)+" 23\u65f659\u520659\u79d2";t.setState({selectedTabIndex:e},(function(){return t.getPriceDetails(i,l)}))}else t.setState({selectedTabIndex:e});else 0===a.length?(t.getChartData(),t.setState({selectedTabIndex:e},(function(){return t.getPriceDetails()}))):t.setState({selectedTabIndex:e})},t.onDataZoomChange=function(e){t.timer&&clearTimeout(t.timer);var n=t.state.historyPriceChartData.chartList,a=e.start,r=e.end,i=n.map((function(e){return e.date})),l=Math.ceil(a/(100/i.length)),c=Math.floor(r/(100/i.length))<i.length?Math.floor(r/(100/i.length)):i.length-1,o={min:n[l].date+" 0\u65f60\u52060\u79d2",max:n[c].date+" 23\u65f659\u520659\u79d2"};t.timer=setTimeout((function(){return t.getPriceDetails(o.min,o.max)}),500)},t.fetchSpuSale=function(){var e=t.params,n=e.spu,a=e.dateFilter;t.setState({loading:!0},(function(){c.h.post("/sales/spu/find",{projectId:u.t.get(u.V.curProject).id,spu:n,dateFilter:a}).then((function(e){var n=e.data;if(2e4===n.code){var a=n.result,r=a.currentSales,i=a.rangeData;if(i&&i.length>0){var l=i[0],c=l.data,o=l.name,s=l.sourceName,u=l.url;t.params.url=u,t.params.title=o,t.params.configDetailVoList=[{topicTypeValue:"\u54c1\u724c",topicValue:s}];var m=c.map((function(e){return e.count})),p=Math.max.apply(null,m),d=Math.min.apply(null,m);t.setState({chartData:c.map((function(e){return[e.date,e.count]})),maxPrice:p,minPrice:d,currentPrice:r})}}})).finally((function(){t.setState({loading:!1})}))}))},t._handleOnPriceChange=function(e){t.getPriceDetails(void 0,void 0,e),t.getChartData(e)},t}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.init()},n.formatterTime=function(e){var t=new Date(e);return t.getFullYear()+"\u5e74"+(t.getMonth()+1)+"\u6708"+t.getDate()+"\u65e5 "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},n.render=function(){var e=this,t=this.state,n=t.data,r=t.count,c=t.columns,o=t.chartData,s=t.currentPrice,u=t.maxPrice,p=t.minPrice,d=t.priceName,h=t.pageSize,g=t.pageIndex,y=t.showPriceOnly,b=t.source,k=t.selectedTabIndex,P=t.historyPriceChartData,x=t.historyPriceTableData,w=t.historyPriceTableData.tableList,T=t.loading,D=t.priceType,Z=this.params,I=[];if(Z)for(var M in Z.configDetailVoList)I.push(Z.configDetailVoList[M].topicValue);var O=[{title:1===b?"\u5b9e\u65f6\u4ef7\u683c":2===b?"\u6bcf\u65e5\u6700\u4f4e\u4ef7":"SPU\u5206\u6790",url:1===b?"/price/realTimePrice":2===b?"/priceHistory":"/price/spu"},{title:Z&&Z.title?Z.title:"",url:""}],L=i.createElement("div",{className:"right-content"},i.createElement("a",{className:"operation",href:Z&&Z.url,target:"_blank",rel:"noopener noreferrer"},"\u8fdb\u5165\u94fe\u63a5\u8be6\u60c5"),3!==b&&i.createElement(i.Fragment,null,i.createElement("span",{className:"line"},"|"),1===k&&i.createElement(i.Fragment,null,i.createElement(l.Checkbox,{checked:y,value:y,onChange:function(){return e.setState({showPriceOnly:!y,pageIndex:1},(function(){e.getPriceDetails(),e.getChartData()}))}},"\u53ea\u663e\u793a\u53d8\u52a8\u4ef7\u683c"),i.createElement("span",{className:"line"},"|")),i.createElement(v.Z,{activeKey:k,options:[{key:"\u8fd17\u5929\u5b9e\u65f6\u4ef7\u683c",value:1},{key:"\u5386\u53f2\u4ef7\u683c\u8d70\u52bf",value:2}],onTabClick:this.switchTab})));return i.createElement("div",{className:"priceDetail-wrapper"},i.createElement(E.Z,{title:O,rightContent:L}),i.createElement("div",{className:"priceDetail-body"},1===k?i.createElement("div",{className:"echarts-wrapper"},i.createElement("div",{className:"echarts-title"},i.createElement("div",null,i.createElement("span",null,3===b?"\u9500\u91cf":"\u4ef7\u683c","\u8d8b\u52bf\u56fe")),i.createElement("div",null,i.createElement(S.Z,{options:N,activeObj:D,onChange:this._handleOnPriceChange,type:"button"}),i.createElement("span",null,i.createElement("i",{className:"icon-cem_jingdong-shop"}),i.createElement("span",null,I[0])),I[1]&&i.createElement(i.Fragment,null,i.createElement("span",{className:"line"},"|"),i.createElement("span",null,i.createElement("i",{className:"icon-cem_shop"}),i.createElement("span",null,I[1]))))),i.createElement("div",{className:"echarts-sub-title"},i.createElement("span",null,"\u6700\u9ad8",3===b?"\u9500\u91cf":d),i.createElement("span",{className:"echarts-value"},u===-1/0?"\u5df2\u4e0b\u67b6":u),i.createElement("span",null,"\u6700\u4f4e",3===b?"\u9500\u91cf":d),i.createElement("span",{className:"echarts-value"},p===1/0?"\u5df2\u4e0b\u67b6":p),i.createElement("span",null,"\u5f53\u524d",3===b?"\u9500\u91cf":d),i.createElement("span",{className:"echarts-value"},-1===s?"\u5df2\u4e0b\u67b6":s)),i.createElement(f,{dataZoomChange:this.dataZoomChange,myChartClick:this.chartClick,data:o,type:3===b?"amount":"",priceType:D,priceName:d})):i.createElement(C,(0,a.Z)({},P,{onDataZoomChange:this.onDataZoomChange})),3!==b&&i.createElement("div",{className:"priceList",style:{marginTop:1===k?"50px":"0"}},i.createElement(l.Loading,{loading:T,text:"\u62fc\u547d\u52a0\u8f7d\u4e2d"},i.createElement(m,{key:"detail",type:"detail",data:1===k?n:w,columns:c,pageSize:h,pageIndex:1===k?g:x.pageIndex,count:1===k?r:x.total,showSelectColumns:!1,getPageTable:this.onChangePage})))))},t}(i.Component)},24473:(e,t,n)=>{n.d(t,{Z:()=>d});var a=n(87462),r=n(63366),i=n(94578),l=n(67294),c=n(45697),o=n.n(c),s=n(94184),u=n.n(s),m=["prefixCls","children","className","block","indeterminate","value","checked","defaultChecked","onChange","disabled"],p=function(e){function t(){return e.apply(this,arguments)||this}return(0,i.Z)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.prefixCls,i=t.children,c=t.className,o=t.block,s=t.indeterminate,p=t.value,d=t.checked,h=t.defaultChecked,f=t.onChange,g=t.disabled,y=(0,r.Z)(t,m),v={value:p,checked:d,defaultChecked:h,onChange:f,disabled:g},b=u()(n,((e={})[n+"-disabled"]=v.disabled,e[n+"-block"]=o,e[n+"-indeterminate"]=s,e),c);return l.createElement("label",(0,a.Z)({tabIndex:v.disabled?-1:0,className:b},y),l.createElement("input",(0,a.Z)({type:"checkbox",className:n+"-input"},v)),l.createElement("span",{className:n+"-status"}),i&&l.createElement("span",{className:n+"-text",title:i},i))},t}(l.Component);p.propTypes={prefixCls:o().string,value:o().oneOfType([o().string,o().number]),checked:o().bool,defaultChecked:o().bool,onChange:o().func,indeterminate:o().bool,disabled:o().bool,block:o().bool},p.defaultProps={prefixCls:"wt-checkbox"};const d=p},85151:(e,t,n)=>{n.d(t,{Jg:()=>a.Z,CS:()=>h});var a=n(24473),r=n(87462),i=n(63366),l=n(94578),c=n(67294),o=n(45697),s=n.n(o),u=n(94184),m=n.n(u),p=["prefixCls","children","className","onChange","values","checkedList","block"],d=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).handleCheckBoxChange=function(e){var n=t.props.onChange;n&&n(e)},t}return(0,l.Z)(t,e),t.prototype.render=function(){var e,t=this,n=this.props,a=n.prefixCls,l=n.children,o=n.className,s=(n.onChange,n.values),u=n.checkedList,d=n.block,h=(0,i.Z)(n,p);return e=s?s.map((function(e,n){var a=0!==u.length&&-1!==u.indexOf(e);return c.createElement(Checkbox,{key:n,value:e,checked:a,onChange:function(e){return t.handleCheckBoxChange(e)},block:d},e)})):c.Children.map(l,(function(e,n){if(e){var a=e.props,r=a.value,i=0!==u.length&&-1!==u.indexOf(r);return c.cloneElement(e,{checked:i,key:n,block:a.block||d,onChange:function(){var e=a.value;t.handleCheckBoxChange(e)}})}})),c.createElement("div",(0,r.Z)({className:m()(a,o)},h),e)},t}(c.Component);d.defaultProps={prefixCls:"wt-checkbox-group"},d.propTypes={onChange:s().func,values:s().array,block:s().bool};const h=d;var f=function(e){var t={};return Object.keys(e).forEach((function(n){/^data\-.+$/.test(n)&&(t[n]=e[n])})),t},g=function(e){function t(){return e.apply(this,arguments)||this}return(0,l.Z)(t,e),t.prototype.render=function(){var e=this.props,t=f(e);return c.createElement("label",{className:e.className,title:e.children},c.createElement("div",{className:"checkbox"},c.createElement("input",(0,r.Z)({checked:e.checked,type:"checkbox",name:e.name,onChange:e.onChange,disabled:e.disabled},t)),c.createElement("div",{className:"checkbox-body"})),"\xa0",c.createElement("span",null,e.children))},t}(c.Component);g.defaultProps={className:"",name:"",checked:!1,disabled:!1,onChange:function(e){return e}}},55815:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(94578),r=n(67294),i=n(45697),l=n.n(i),c=n(43036),o=n(61409),s=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props,a=n.title,r=n.beforeJump;e!==a.length-1&&(r?new Promise((function(e,t){return r(e,t)})).then((function(){o.mW.push({pathname:a[e].url,state:a[e].state})})):o.mW.push({pathname:a[e].url,state:a[e].state}))},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.mainTitle,i=t.rightContent,l=t.className,o=t.overlay;return r.createElement("div",{className:"breadcumb-wrapper "+l},n instanceof Array?r.createElement("div",{className:"breadcrumb-left"},r.createElement("div",null,n.map((function(t,a){return r.createElement("span",{className:t.url?"":"not_clickable",key:a,onClick:function(){return t.url&&a!==n.length-1&&e._handleBreadcrumbClick(a)}},t.title,a!==n.length-1&&" / ")}))),r.createElement("span",null,a||n[n.length-1].title,o&&r.createElement(c.Z,{placement:"top",overlay:o},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}})))):r.createElement("div",{className:"normal-title"},n,o&&r.createElement(c.Z,{placement:"top",overlay:o},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}}))),i||"")},t}(r.Component);s.propTypes={className:l().string,title:l().oneOfType([l().string,l().arrayOf(l().shape({title:l().string,url:l().string,state:l().object}))]).isRequired,overlay:l().oneOfType([l().string,l().node]),mainTitle:l().oneOfType([l().string,l().node]),beforeJump:l().func,rightContent:l().node};const u=s},26687:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(87462),r=n(94578),i=n(67294),l=n(85151),c=n(35239),o=function(e){function t(t){var n;return(n=e.call(this,t)||this).openMenu=function(){n.setState({menuState:!n.state.menuState})},n.onChange=function(e){var t,a=n.props,r=a.columns,i=a.getShowColumns,l=a.multiSave;r&&r[e]&&((t=r.slice(0))[e].checked=!t[e].checked);var o=l?l.name:"",s=c.t.get(c.V.storageColumns)?c.t.get(c.V.storageColumns):{};s[o]=t,c.t.set(c.V.storageColumns,s),i&&i(t),n.resize(),n.setState({columns:t})},n.competeSelectMenuItem=function(e){var t=n.props.multiSave,a=t?t.name:"",r=n.props.columns,l=c.t.get(c.V.storageColumns)?c.t.get(c.V.storageColumns)[a]:[];if(l&&0!==l.length)"price_check"===a?l.map((function(e,t){return e.render=r.filter((function(t){return t.label===e.label})).length>0?r.filter((function(t){return t.label===e.label}))[0].render:function(t,n,a){return i.createElement("span",null,t[e.prop])}})):l.map((function(e,t){return e.render=function(e,n,a){return i.createElement("span",null,e.configDetails[t]&&e.configDetails[t].topicValue)}})),r=l.slice(0);else if(e&&e.every((function(e){return e.label&&e.prop})))r=e;else{var o=[];e&&e.forEach((function(e,t){o.push({label:e.topicTypeValue,checked:!1,render:function(e,n,a){return i.createElement("span",null,e.configDetails[t].topicValue)}})})),r=o.slice(0)}return n.setState({columns:r}),r},n.resize=function(){var e=document.querySelector(".connection-table .is-sortable");if(e){var t=n.getStyle(e,"width"),a=document.body.offsetWidth,r=n.state.columns;if(a>800&&r.length>2&&parseInt(t)<275)for(var i=0;i<r.length-2;i++)if(r[i].checked)return void n.onChange(i)}},n.close=function(e){n.state.menuState&&n.setState({menuState:!1})},n.state={menuState:!1,multiSave:null,columns:t.columns.map((function(e){return!e.checked&&(e.checked=!1),e}))},n}(0,r.Z)(t,e);var n=t.prototype;return n.UNSAFE_componentWillReceiveProps=function(e){this.setState((0,a.Z)({},e))},n.getStyle=function(e,t){return e.style[t]?e.style[t]:e.currentStyle?e.currentStyle[t]:getComputedStyle(e,null)[t]},n.componentDidMount=function(){window.addEventListener("click",this.close),window.addEventListener("resize",this.resize,!1)},n.componentWillUnmount=function(){window.removeEventListener("resize",this.resize,!1),window.removeEventListener("click",this.close)},n.render=function(){var e=this,t=this.state.columns;return i.createElement("div",{className:"menu-wrapper",onClick:function(e){e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()}},i.createElement("span",{className:"el-dropdown-link "+(this.state.menuState?"sel":""),onClick:this.openMenu},"\u5217",i.createElement("i",{className:"icon-cem_pull-down-or-take-up",style:{transform:this.state.menuState?"rotate(-180deg)":""}})),this.state.menuState&&i.createElement("div",{className:"menuList"},i.createElement("ul",null,0===t.length?i.createElement("li",{style:{color:"#8c8c8c"}},"\u65e0\u53ef\u9009\u62e9\u5185\u5bb9"):t.map((function(t,n){return i.createElement("li",{key:n},i.createElement(l.Jg,{key:n,value:t.label,checked:t.checked,onChange:e.onChange.bind(e,n),block:!0},t.label))})))))},t}(i.Component)},37841:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(67294),r=n(45697),i=n.n(r),l=function(e){var t=e.activeKey,n=e.options,r=e.onTabClick;return a.createElement("div",{className:"tabs"},n.map((function(e,n){return a.createElement("div",{key:n,className:t===e.value?"active-tab":"",onClick:function(){return t!==e.value&&r(e.value,e)}},e.key||e.label)})))};l.propTypes={activeKey:i().oneOfType([i().string,i().number]),options:i().arrayOf(i().shape({key:i().string,value:i().oneOfType([i().string,i().number])})).isRequired,onTabClick:i().func.isRequired};const c=l},3381:(e,t,n)=>{e.exports=n.p+"img/459a43effdbcbdd83095.png"}}]);