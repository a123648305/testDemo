"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[9541],{69541:(e,t,a)=>{a.r(t),a.d(t,{KEY:()=>Qe,default:()=>Ke});var n=a(87462),r=a(15861),i=a(94578),o=a(50361),s=a.n(o),l=a(87757),c=a.n(l),u=a(67294),p=(a(30467),a(55673)),d=(a(58136),a(5789)),m=a(63366),f=a(35103),h=(a(43378),a(62443)),v=a(98191),y=a(8201),g=a(50976),T=a(61780),b=a(81408),C=a(70715),E=a(87300),S=a(94644),x=a(39432);var w=function(e,t,a,n,r){if("image"===t)(0,S._v)(e,n);else if("data"===t){var i=function(e,t,a){void 0===t&&(t="\u94fe\u63a5\u91c7\u96c6\u6570\u91cf");var n=["\u65e5\u671f",t],r=e&&e.map((function(e){return[e.date,e.userConnectionCount]}));return{length:e?e.length:0,datasets:{dimensions:n,source:r||[]}}}(a,n),o=i.datasets,s=[o.dimensions].concat(o.source);(0,S.aT)([s],n)}},A=a(45697),N=a.n(A),O=a(43036),k=function(e){function t(t){var a;return(a=e.call(this,t)||this).getPanelWidth=function(){var e=a.props,t=e.flavor,n=e.options,r=e.rightHook,i=Math.max.apply(null,n.map((function(e){return(0,x.jD)(e.title,14)})))+2+10+32;return i+=void 0!==t?24:0,(i+=void 0!==r?30:0)>100?i:100},a._setPadShowFalse=function(){a.state.show&&a.setState({show:!1})},a._handleParentClick=function(e){a.state.show&&a.props.showFlavor&&a.props.enable&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},a._handleTriggerOnClick=function(){var e=a.state.show;a.props.enable&&setTimeout((function(){a.setState({show:!e})}),0)},a.state={show:!1,firstLiHover:!1,panelWidth:a.getPanelWidth()},a}(0,i.Z)(t,e);var a=t.prototype;return a.componentDidMount=function(){window.addEventListener("click",this._setPadShowFalse)},a.componentWillUnmount=function(){window.removeEventListener("click",this._setPadShowFalse)},a.componentDidUpdate=function(e){var t=e.options,a=this.props.options;JSON.stringify(t)!==JSON.stringify(a)&&this.setState({panelWidth:this.getPanelWidth()})},a.render=function(){var e=this.state,t=e.show,a=e.panelWidth,n=this.props,r=n.activeObj,i=void 0===r?"":r,o=n.onChange,s=n.options,l=n.objName,c=n.preTitle,p=n.sufTitle,d=void 0===p?"":p,m=n.showTitle,f=void 0===m||m,h=n.overlay,v=n.divider,y=void 0===v?"right":v,g=n.flavor,T=n.className,b=void 0===T?"":T,C=n.onFlavorChange,E=n.sufIcon,S=n.style,x=n.type,w=void 0===x?"text":x,A=n.enable,N=n.rightHook,k=n.iconImg,P=s.find((function(e){return e.value===i})),F=""===i?d:P&&P.title,_=""===i?d:P&&P.icon;return u.createElement("div",{className:"single-select-button-wrapper single_select_diviver_"+y+" single-select-button_"+w+" "+b,style:S,onClick:this._handleParentClick},u.createElement("div",{className:"button_content "+(A?"":"button_content_disable")},u.createElement("span",{onClick:this._handleTriggerOnClick},u.createElement("span",{className:"button-trigger "+(t?"sel":"")},f&&u.createElement(u.Fragment,null,c&&u.createElement("span",{className:"pre-title"},c),!c&&((_?u.createElement("i",{className:_+" word_icon_hover"}):"")||(k?"group"===i?u.createElement("img",{src:k[0],className:"icon_img",alt:""}):u.createElement("img",{src:k[1],className:"icon_img",alt:""}):"")||(_||k?"":u.createElement("span",{className:"button-title"},F)))),u.createElement("i",{className:E||"icon-cem_pull-down-or-take-up"})),h&&u.createElement("span",{style:{marginLeft:4}},u.createElement(O.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:h},u.createElement("i",{className:"icon-cem_file1"})))),u.createElement("div",{className:"button-panel "+(t?"active":""),style:{minWidth:a}},s.map((function(e,t){return u.createElement("div",{className:"panel-item "+(e.value===i?"sel":"")+" "+(e.disabled?"disabled":""),key:e.value,onClick:function(){var t;!e.disabled&&o(l?((t={})[l]=e.value,t):e.value)}},e.icon&&u.createElement("i",{className:e.icon+" panel-item-icon"}),k&&k[t]&&u.createElement("img",{src:k[t],className:"icon_img",alt:""}),u.createElement("span",{className:"ellipsis",style:{maxWidth:97.5}},e.title),void 0!==g&&u.createElement("i",{className:g===e.value?"icon-cem_star":"icon-cem_star-filling star_hide",onClick:function(t){var a,n,r;t.stopPropagation(),C(g===e.value?l?((a={})[l]="",a):"":l?((n={})[l]=e.value,n):e.value),o(l?((r={})[l]=e.value,r):e.value)}}),u.createElement("i",{className:e.value===i&&N?"icon-cem_right1 choice":""}))})))))},t}(u.PureComponent);k.defaultProps={enable:!0,activeObj:"",sufTitle:"",showTitle:!0,divider:"right",className:"",type:"text"},k.propTypes={activeObj:N().any,onChange:N().func.isRequired,options:N().array.isRequired,objName:N().any,preTitle:N().string,sufTitle:N().string,showTitle:N().bool,overlay:N().string,divider:N().oneOf(["both","left","right","none"]),flavor:N().any,onFlavorChange:N().func,className:N().string,sufIcon:N().string,style:N().object,type:N().oneOf(["button","text"]),enable:N().bool,rightHook:N().bool,iconImg:N().array};const P=k;const F=function(e){function t(t){var a;return(a=e.call(this,t)||this).chartRef=void 0,a.chartLeaveTimeout=void 0,a.renderChart=function(){var e=a.props,t=(e.title,e.onMsgClick,e.dataSource),n=a.state,r=n.showLabel,i=n.activeObjTimeType;if((0,y.P)(t)&&a.chartRef){var o=function(e,t,a,n,r){var i=e.map((function(e){var t=[],a=e.date.split(" ");return t.push(a[0],e.userConnectionCount),t})),o=e.reduce((function(e,t){return e+t.userConnectionCount}),0);return{title:{},tooltip:{trigger:"axis",showDelay:10,hideDelay:20,enterable:!0,confine:!0,padding:0,transitionDuration:.4,backgroundColor:"#ffffff",borderColor:"#e5e5e5",borderWidth:"1",extraCssText:"border-radius: 2px;\n        box-shadow: 0px 9px 28px 8px rgba(0,0,0,0.05), 0px 6px 16px 0px rgba(0,0,0,0.08), 0px 3px 6px -4px rgba(0,0,0,0.12)",axisPointer:{type:"line",show:!0,label:{show:!1}},position:function(e,t,a,n,r){var i=r.contentSize,o=r.viewSize,s=e[1]<o[1]/2?-.5:-1;return[e[0],e[1]+s*i[1]]},formatter:function(e,t,a){if(e.length)return setTimeout((function(){var n=e[0].axisValue,r=e.map((function(e){var t=e.marker,a=(e.seriesName,e.data);return{name:"<div style='display: flex;justify-content: space-between;align-items: center;color: #8c8c8c; margin-bottom: 6px'><div><span style='vertical-align: bottom'>\n              "+t+"</span>\u94fe\u63a5\u6570\u91cf</div><div style='color: #262626;'>\n              "+(a.value?a.value:0)+"</div></div>"}})).map((function(e){return e.name})),i='<span style="font-size: 12px; color: #262626; font-weight: 400;">'+n+"</span>";a(t,(0,E.r)(i,r,[],""))}),0)}},grid:{top:123,left:16,right:46,bottom:16,containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:e.map((function(e){var t=(0,x.Sn)(a,e.date);return"Invalid date"===t?e.date:t})),nameTextStyle:{color:"#626262",Size:"12px"},axisLabel:{textStyle:{color:"#626262",fontSize:"12px"}}},yAxis:{type:"value",axisLabel:{color:"#626262",formatter:function(e){return(0,x.uf)(e)}},interval:(0,b.lQ)(i).intVal,max:(0,b.lQ)(i).maxVal,min:0,axisLine:{show:!1,lineStyle:{type:"dashed",color:"#e5e5e5"}},splitLine:{show:!0,lineStyle:{color:["#e5e5e5"],width:1,type:"dashed"}}},graphic:[{type:"group",left:16,top:74,silent:!0,children:[{type:"text",style:{text:""+(0,x.uf)(o),fill:"#262620",font:"500 24px "+C.I8}}]},{type:"text",top:48,left:16,style:{text:"\u94fe\u63a5\u6570\u91cf",fill:"#8c8c8c",font:"400 12px "+C.I8}}],series:[{type:"line",name:"\u63d0\u53ca\u6570\u91cf",showSymbol:r,emphasis:{scale:!0},color:"#5B8FF9",data:i.map((function(e,t){return{name:e[0],value:e[1],symbol:"image://"+T.N,symbolSize:16,label:{normal:{show:r,position:"top",color:"#262626"}}}}))}]}}(t,0,i,0,r);a.chartRef.clear(),a.chartRef.setOption(o)}},a.getChartRef=function(e){return a.chartRef=e},a.setTimeType=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.onDateChange({dateGroupType:t},a.props.title);case 2:return e.next=4,a.setState({activeObjTimeType:t});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.setFlavorTimeType=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.onFlavorChange({collectLinkTimeDate:t});case 2:return e.next=4,a.setState({flavorTimeType:t,activeObjTimeType:t});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.state={showLabel:!1,chartType:"c0",iconIsDisable:!1,activeObjTimeType:a.props.flavor||"",flavorTimeType:a.props.flavor||""},a}(0,i.Z)(t,e);var a=t.prototype;return a.changeActiveObjTimeType=function(){this.setState({activeObjTimeType:this.props.flavor||"DAY",flavorTimeType:this.props.flavor||""})},a.componentDidMount=function(){var e=this;if(this.chartRef){this.renderChart();var t=this.chartRef._dom.children,a=t[0],n=t[1];a.addEventListener("mouseleave",(function(t){e.chartLeaveTimeout=setTimeout((function(){e.chartLeaveTimeout&&(n.style.display="none")}),2e3)})),n&&n.addEventListener("mouseenter",(function(t){e.chartLeaveTimeout=void 0}))}},a.componentDidUpdate=function(){var e=(0,r.Z)(c().mark((function e(t,a){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.timeParams.defaultDateType===t.timeParams.defaultDateType){e.next=3;break}return e.next=3,this.updateDateType();case 3:if(t.flavor===this.props.flavor){e.next=6;break}return e.next=6,this.changeActiveObjTimeType();case 6:if(!this.checkIfRealChanged(t,a)){e.next=9;break}return e.next=9,this.renderChart();case 9:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}(),a.checkIfRealChanged=function(e,t){var a=this,n=0===e.dataSource.length&&!e.loading,r=["activeObjTimeType","flavorTimeType","showLabel"].some((function(e){return t[e]!==a.state[e]})),i=e.filterChangeBool!==this.props.filterChangeBool||JSON.stringify(e.dataSource)!==JSON.stringify(this.props.dataSource);return r||n||i},a.updateDateType=function(){this.setState({activeObjTimeType:this.props.timeParams.defaultDateType})},a.render=function(){var e=this,t=this.props,a=t.dataSource,n=t.title,r=t.loading,i=t.timeParams,o=this.state,s=o.showLabel,l=o.chartType,c=o.iconIsDisable;return u.createElement(y.Z,{data:a,loading:r,style:{height:"c0"===l?400:444},className:"yt_service_insight_line_chart_wrap",renderTitle:u.createElement(v.Z,{title:n,data:null},u.createElement(P,{rightHook:!0,onChange:this.setTimeType,options:i.dateOptions||[{title:"\u6309\u5929",value:"DAY"}],activeObj:this.state.activeObjTimeType,flavor:this.state.flavorTimeType,onFlavorChange:this.setFlavorTimeType}),u.createElement(h.default,{placement:"top",content:"\u663e\u793a\u56fe\u8868\u6807\u7b7e",mouseEnterDelay:.6,getPopupContainer:function(e){return e}},u.createElement("i",{style:{color:"c0"===l?"":"#bfbfbf"},className:"icon-tubiaobiaoqian "+(s?"active":"")+"  "+(c?"disableClass":""),onClick:function(){e.setState({showLabel:!s})}})),u.createElement(h.default,{placement:"top",content:"\u5bfc\u51fa\u6570\u636e",mouseEnterDelay:.6,getPopupContainer:function(e){return document.querySelector(".header_Filter_bar")||e}},u.createElement("i",{className:"icon-daochu",onClick:function(){return w(e.chartRef,"data",a,n,e.state.activeObjTimeType)}})),u.createElement(h.default,{placement:"top",content:"\u5bfc\u51fa\u56fe\u7247",mouseEnterDelay:.6,getPopupContainer:function(e){return document.querySelector(".header_Filter_bar")||e}},u.createElement("i",{style:{color:"c0"===l?"":"#bfbfbf"},className:"icon-xiazaitupian "+(c?"disableClass":""),onClick:function(){return w(e.chartRef,"image",a,n,e.state.activeObjTimeType)}})))},u.createElement(g.Z,{theme:"yunting_multi_color",option:{},style:{width:"100%",height:400,display:"c0"===l?"block":"none"},onChartReady:this.getChartRef}))},t}(u.Component);var _=a(35239),D=function(e){var t=0;e.forEach((function(e){var a=parseFloat(e);a>t&&(t=a)})),t=Math.ceil(t);for(var a=0;a<4;a++)t%4!==0&&t++;return 0===t&&(t=4),{intVal:t/4,maxVal:t}};var j=function(e,t,a,n){if("image"===t)(0,S._v)(e,n);else if("data"===t){var r=function(e){var t=e&&"empty"!==e&&e.datasets[0].source.map((function(e,t,a){return[t+1].concat(a[t])}));return{length:e?e.length:0,datasets:{dimensions:["\u5e8f\u53f7","\u5e73\u53f0","\u8bc4\u8bba\u6570\u91cf"],source:t}}}(a),i=r.datasets,o=[i.dimensions].concat(i.source);(0,S.aT)([o],n)}};const L=function(e){function t(t){var a;return(a=e.call(this,t)||this).chartRef=void 0,a.chartLeaveTimeout=void 0,a.updateType=function(){a.setState({flavorTimeType:a.props.flavorTimeType,activeTimeType:a.props.flavorTimeType})},a.getChartRef=function(e){return a.chartRef=e},a.renderChart=function(){var e=a.props,t=e.title,r=e.data,i=e.onMsgClick,o=a.state,s=o.showLabel,l=o.activeTimeType,c=o.activeCommentType;if((0,y.P)(r)&&a.chartRef){var u=function(e,t,a,r,i,o,s){var l=t.datasets,c=(t.length,l[0]),u=(c.dimensions,c.source,l[1]),p=u.dimensions,d=u.source;return{grid:[{left:"34%",right:48,top:90,bottom:16,containLabel:!0}],dataset:l.map((function(e){return(0,n.Z)({},e,{sourceHeader:!1})})),tooltip:{trigger:"axis",enterable:!0,hideDelay:200,padding:[8,16],backgroundColor:"#ffffff",borderColor:"#e5e5e5",borderWidth:"1",extraCssText:"\n                    border-radius: 2px 2px 2px 0px 2px;\n                    width:172px;\n                    box-shadow: 0px 9px 28px 8px rgba(0,0,0,0.05), 0px 6px 16px 0px rgba(0,0,0,0.08),\n                    0px 3px 6px -4px rgba(0,0,0,0.12)",formatter:function(e){for(var t=e[0].axisValue.replace(/-/g,"/"),a=0;a<e.length;a++)e[a].data[a+1];var n=e.map((function(e){e.marker;var t=e.seriesName,a=(e.seriesIndex,e.data,e.value);return{name:'\n                        <div class="line_chart">\n                            <span style="color: #8c8c8c">\n                            <span style="display:inline-block;margin-right:5px;border-radius:50%;width:10px;height:10px;background-color:'+e.color+';">\n                            </span> '+t+'</span>\n                            <span style="color: #262626;">'+a+"</span>\n                        </div>\n                        ",value:a}}));return(n=n.sort((function(e,t){return t.value-e.value})).map((function(e){return e.name}))).splice(0,0,'<span style="color: #8c8c8c">'+t+"</span>"),n.join('<p style="height: 8px"></p>')}},legend:{top:56,left:32,right:40,itemWidth:10,itemHeight:10,type:"scroll",icon:"circle",data:p.slice(1)},xAxis:{type:"category",boundaryGap:!1,data:d.map((function(e){return(0,x.Sn)(r,e[0])})),axisLabel:{color:"#8c8c8c",margin:16},axisPointer:{type:"line",label:{show:!1}}},yAxis:{interval:D(l[1].source.map((function(e){return e.slice(1)})).flat()).intVal,max:D(l[1].source.map((function(e){return e.slice(1)})).flat()).maxVal,minInterval:0,min:0,axisLine:{show:!1},axisLabel:{color:"#8c8c8c",formatter:function(e){return(0,x.hE)(e)}},splitLine:{show:!0,lineStyle:{type:"dashed"}}},series:[{type:"pie",smooth:!0,datasetIndex:0,hoverOffset:0,center:["18%","58%"],radius:["31%","47%"],label:{normal:{formatter:"{b}\n{c} ({d}%)",textStyle:{fontWeight:"normal",fontSize:12,color:"#262626"}}},itemStyle:{smooth:!0,normal:{borderWidth:0,borderColor:"#fff",smooth:!0},emphasis:{borderWidth:0,shadowBlur:0,shadowOffsetX:0}},tooltip:{trigger:"item",showDelay:20,hideDelay:50,enterable:!0,confine:!0,padding:0,backgroundColor:"#ffffff",borderColor:"#e5e5e5",borderWidth:"1",extraCssText:"border-radius: 2px;\n      box-shadow: 0px 9px 28px 8px rgba(0,0,0,0.05), 0px 6px 16px 0px rgba(0,0,0,0.08), 0px 3px 6px -4px rgba(0,0,0,0.12)",position:function(e,t,a,n,r){var i=r.contentSize,o=r.viewSize,s=e[0]<o[0]/2?0:-1,l=e[1]<o[1]/2?-.5:-1,c=e[0]<o[0]/2?16:-16;return[e[0]+s*i[0]+c,e[1]+l*i[1]]},formatter:function(t,r,o){var l=t.name,c=t.color,u=(t.marker,t.data,t.value),p=t.percent;return setTimeout((function(){o(r,(0,E.r)('<span style="font-size: 12px; color: #262626; font-weight: 400"> '+l+"</span>",["<div  style='display: flex;justify-content: space-between;align-items: center;color: #8c8c8c;'>\n                                        <div>\n                                            <span style='vertical-align: bottom'>\n                                            <span style=\"display:inline-block;margin-right:5px;border-radius:50%;width:10px;height:10px;background-color:"+c+";\"></span>\n                                            </span>\n                                            \u8bc4\u8bba\u6570\u91cf\n                                        </div>\n                                        <div style='color: #262626;margin-left: 10px;'>\n                                            "+u+" ("+p+"%)\n                                        </div>\n                                    </div>"],[{title:"\u6d88\u606f",icon:"icon-cem_jump-message",callback:function(){s((0,n.Z)({},t,{dataSource:e,commentType:i}),a)}}],"yt_new_tooltip_wrapper"))}),0)}},data:l[0].source.map((function(e){return{value:e[1],name:e[0],label:{show:!0},labelLine:{show:!0},emphasis:{label:{show:!0},labelLine:{show:!0}}}}))}].concat(p.slice(1).map((function(t,l){return{type:"line",name:t,smooth:!0,showSymbol:!0,symbolSize:1,data:d.map((function(t){return{value:t[l+1],label:{show:o,position:"top",color:"#262626"},tooltip:{trigger:"item",padding:0,formatter:function(o,l,c){return setTimeout((function(){var u=o.seriesName,p=o.name,d=(o.data,o.marker,o.value),m=o.color,f=t,h="\n                                        <div style=\"font-size: 12px; color: #8c8c8c; font-weight: 400;position:relative;\">\n                                            <span style='position:absolute;width:40px;height:150px;left:-40px;top:-30px;'></span>\n                                            <span style='position:absolute;width:40px;height:150px;right:-40px;top:-30px;'></span>\n                                        </div>\n                                        <span style='font-size: 12px;font-weight: 400;color:#8c8c8c;'>\n                                            "+p+"\n                                        </span>\n                                             ",v=['  <span style="display:inline-block;margin-right:5px;border-radius:50%;width:10px;height:10px;background-color:'+m+';"></span>\n                                     '+u+'\n                                     <span style="float: right; font-weight: 500; color: #000000;"> '+d+"</span>"];c(l,(0,E.r)(h,v,[{title:"\u6d88\u606f",icon:"icon-cem_jump-message",callback:function(){return s((0,n.Z)({},o,{dataSource:e,commentType:i,timeType:r,selectDate:f}),a)}}],"yt_new_tooltip_wrapper"))}),0)}}}})),itemStyle:{color:C.OW[l]}}})))}}(r,a.dataTransform(),t,l,c,s,i);a.chartRef.clear(),a.chartRef.setOption(u)}},a.setCommentType=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.onDateChange({messageType:t,dateGroupType:a.state.activeTimeType},a.props.title);case 2:a.setState({activeCommentType:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.setTimeType=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.onDateChange({messageType:a.state.activeCommentType,dateGroupType:t},a.props.title);case 2:a.setState({activeTimeType:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.setFlavorTimeType=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.onDateChange({messageType:a.state.activeCommentType,dateGroupType:t},a.props.title);case 2:a.setState({flavorTimeType:t,activeTimeType:t}),a.props.onFlavorChange({platformTimeDate:t});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.UpdateTimeType=function(e){if(0!==Object.keys(e).length){var t=a.state.flavorTimeType;e.dateOptions.map((function(e){return e.value})).includes(t)?a.setState({activeTimeType:t}):a.setState({activeTimeType:e.defaultDateType})}},a.state={activeTimeType:a.props.flavorTimeType,flavorTimeType:a.props.flavorTimeType,activeCommentType:a.props.flavorCommentType,flavorCommentType:a.props.flavorCommentType,showLabel:!1},a}(0,i.Z)(t,e);var a=t.prototype;return a.componentDidMount=function(){var e=this;if(this.chartRef){this.UpdateTimeType(this.props.timeParams),this.renderChart();var t=this.chartRef._dom.children,a=t[0],n=t[1];a.addEventListener("mouseleave",(function(t){e.chartLeaveTimeout=setTimeout((function(){e.chartLeaveTimeout&&(n.style.display="none")}),2e3)})),n&&n.addEventListener("mouseenter",(function(t){e.chartLeaveTimeout=void 0}))}},a.componentDidUpdate=function(){var e=(0,r.Z)(c().mark((function e(t,a){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.timeParams.defaultDateType===t.timeParams.defaultDateType){e.next=3;break}return e.next=3,this.UpdateTimeType(this.props.timeParams);case 3:if(t.data.length===this.props.data.length&&!this.checkIfRealChanged(t,a)){e.next=6;break}return e.next=6,this.renderChart();case 6:if(t.flavorTimeType===this.props.flavorTimeType){e.next=9;break}return e.next=9,this.updateType();case 9:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}(),a.checkIfRealChanged=function(e,t){var a=this,n=0===e.data.length&&!e.loading,r=["activeTimeType","flavorTimeType","showLabel","activeCommentType","flavorCommentType"].some((function(e){return t[e]!==a.state[e]})),i=e.filterChangeBool!==this.props.filterChangeBool||JSON.stringify(e.data)!==JSON.stringify(this.props.data);return r||i||n},a.dataTransform=function(){return function(e){var t=e.concat([]);t.forEach((function(e){e.count=e.dataList.reduce((function(e,t){return e+t.count}),0)}));var a=t.sort((function(e,t){return t.count-e.count})),n=function(e,t){var a=e.concat([]),n={name:t,count:0,dataList:[]};return n.count=a.reduce((function(e,t){return e+t.count}),0),a.length?(a[0].dataList.forEach((function(e,t){var r={time:e.time,count:a.reduce((function(t,a){var n=a.dataList.find((function(t){return t.time===e.time}));return t+(n?n.count:0)}),0)};n.dataList.push(r)})),n):[]}(a.slice(7),"\u5176\u5b83"),r=a.slice(0,7).concat(n),i=r.map((function(e){return e.name})),o=r.map((function(e){return[e.name,e.count]})),s=["\u65e5\u671f"].concat(i),l=[];r.length&&r[0].dataList.forEach((function(e,t){var a=r.map((function(e){var a;return(null==(a=e.dataList[t])?void 0:a.count)||0})),n=e.time;l.push([n].concat(a))}));var c=l;return{length:e.length,datasets:[{dimensions:i,source:o},{dimensions:s,source:c}]}}([].concat(this.props.data))},a.render=function(){var e=this,t=this.props,a=t.title,n=t.loading,r=t.data,i=t.timeParams,o=this.state.showLabel;return u.createElement(y.Z,{data:r,className:"yt_explore_pie_line_chart_wrapper",loading:n,renderTitle:u.createElement(v.Z,{title:a,data:void 0},u.createElement("div",{className:"operate_zone"},u.createElement(P,{rightHook:!0,options:[{title:"\u5168\u90e8\u8bc4\u8bba",value:"allComment"},{title:"\u6709\u6548\u8bc4\u8bba",value:"usefulComment"}],activeObj:this.state.activeCommentType,onChange:this.setCommentType}),u.createElement(P,{rightHook:!0,options:i.dateOptions||[{title:"\u6309\u5929",value:"DAY"},{title:"\u6309\u5468",value:"WEEK"},{title:"\u6309\u6708",value:"MONTH"}],activeObj:this.state.activeTimeType,flavor:this.state.flavorTimeType,onChange:this.setTimeType,onFlavorChange:this.setFlavorTimeType})),u.createElement("div",{className:"icons"},u.createElement("div",{className:"icon"},u.createElement(h.default,{placement:"top",content:"\u663e\u793a\u56fe\u8868\u6807\u7b7e",mouseEnterDelay:.6,getPopupContainer:function(e){return e}},u.createElement("i",{className:"icon-tubiaobiaoqian "+(o?"active":"")+"  ",onClick:function(){e.chartRef.getOption();e.setState({showLabel:!o})}}))),u.createElement("div",{className:"icon"},u.createElement(h.default,{placement:"top",content:"\u5bfc\u51fa\u6570\u636e",mouseEnterDelay:.6,getPopupContainer:function(e){return e}},u.createElement("i",{className:"icon-daochu",onClick:function(){return j(e.chartRef,"data",e.dataTransform(),a)}}))),u.createElement("div",{className:"icon"},u.createElement(h.default,{placement:"top",content:"\u5bfc\u51fa\u56fe\u7247",mouseEnterDelay:.6,getPopupContainer:function(e){return document.querySelector(".header_Filter_bar")||e}},u.createElement("i",{className:"icon-xiazaitupian",onClick:function(){return j(e.chartRef,"image",e.dataTransform(),a)}})))))},u.createElement(g.Z,{theme:"yt_multi_color_10",option:{},opts:{devicePixelRatio:2},style:{width:"100%",height:"100%"},onChartReady:this.getChartRef}))},t}(u.Component);function M(e,t){return e.map((function(e){var a=[],n=e.time.split(" ");return a.push(n[0],e[t]),a}))}function R(e,t){return e.reduce((function(e,a){return e+a[t]}),0)}var I=["\u5168\u90e8\u8bc4\u8bba\u6570\u91cf","\u6709\u6548\u8bc4\u8bba\u6570\u91cf","\u65e0\u6548\u8bc4\u8bba\u6570\u91cf"],Z=function(e,t){-1===I.findIndex((function(t){return e===t}))?I.push(e):I=I.filter((function(t){return e!==t})),t()},z=function(e,t,a,n,r){if("image"===t)(0,S._v)(e,n);else if("data"===t){var i=function(e){var t=e&&e.map((function(e){return[e.time,e.allCommentCount,e.usefulCommentCount,e.unusefulCommentCount]}));return{length:e?e.length:0,datasets:{dimensions:["\u65e5\u671f","\u5168\u90e8\u8bc4\u8bba\u6570\u91cf","\u6709\u6548\u8bc4\u8bba\u6570\u91cf","\u65e0\u6548\u8bc4\u8bba\u6570\u91cf"],source:t||[]}}}(a).datasets,o=[i.dimensions].concat(i.source);(0,S.aT)([o],n)}};const G=function(e){function t(t){var a;return(a=e.call(this,t)||this).chartRef=void 0,a.chartLeaveTimeout=void 0,a.renderChart=function(e){var t=a.props.dataSource,n=a.state,r=n.showLabel,i=n.activeObjTimeType;if((0,y.P)(t)&&a.chartRef){var o=function(e,t,a,n,r){return!0===r&&(I=["\u5168\u90e8\u8bc4\u8bba\u6570\u91cf","\u6709\u6548\u8bc4\u8bba\u6570\u91cf","\u65e0\u6548\u8bc4\u8bba\u6570\u91cf"]),{title:{},tooltip:{trigger:"axis",showDelay:20,hideDelay:10,enterable:!0,confine:!0,padding:0,backgroundColor:"#ffffff",borderColor:"#e5e5e5",borderWidth:"1",extraCssText:"border-radius: 2px;\n      width:172px;\n        box-shadow: 0px 9px 28px 8px rgba(0,0,0,0.05), 0px 6px 16px 0px rgba(0,0,0,0.08), 0px 3px 6px -4px rgba(0,0,0,0.12)",axisPointer:{type:"line",show:!0,label:{show:!1}},position:function(e,t,a,n,r){var i=r.contentSize,o=r.viewSize,s=e[0]<o[0]/2?0:-1,l=e[1]<o[1]/2?-.5:-1,c=e[0]<o[0]/2?12:-12;return[e[0]+s*i[0]+c,e[1]+l*i[1]]},formatter:function(e,t,a){if(e.length)return setTimeout((function(){var n=e[0].axisValue,r=e.map((function(e){var t=e.marker,a=e.seriesName,n=e.data;return{name:"<div style='display: flex;justify-content: space-between;align-items: center;color: #8c8c8c; margin-bottom: 8px'><div><span style='vertical-align: bottom'>\n              "+t+"</span>"+a+"</div><div style='color: #262626;'>\n              "+(n.value?n.value:0)+"</div></div>"}})).map((function(e){return e.name})),i='<span style="font-size: 12px; color: #262626; font-weight: 400;">'+n+"</span>";a(t,(0,E.r)(i,r,[],""))}),0)}},grid:{top:123,left:16,right:46,bottom:16,containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:e.map((function(e){return(0,x.Sn)(t,e.time)})),nameTextStyle:{color:"#626262",Size:"12px"},axisLabel:{textStyle:{color:"#626262",fontSize:"12px"}}},yAxis:{type:"value",axisLabel:{color:"#626262",formatter:function(e){return(0,x.hE)(e)}},interval:(0,b.lQ)(M(e,"allCommentCount")).intVal,max:(0,b.lQ)(M(e,"allCommentCount")).maxVal,min:0,axisLine:{show:!1,lineStyle:{type:"dashed",color:"#e5e5e5"}},splitLine:{show:!0,lineStyle:{color:["#e5e5e5"],width:1,type:"dashed"}}},graphic:[{type:"group",left:16,top:48,silent:!1,width:100,height:20,children:[{type:"line",shape:{x1:0,x2:0,y1:0,y2:52},style:{lineWidth:"2",stroke:I.includes("\u5168\u90e8\u8bc4\u8bba\u6570\u91cf")?"#5B8FF9":"#8C8C8C"}},{type:"text",left:12,top:32,style:{text:""+(0,x.hE)(R(e,"allCommentCount")),fill:I.includes("\u5168\u90e8\u8bc4\u8bba\u6570\u91cf")?"#262626":"#8C8C8C",font:"500 24px "+C.I8}},{type:"text",left:12,style:{text:"\u5168\u90e8\u8bc4\u8bba\u6570\u91cf",fill:"#8C8C8C",font:"500 14px "+C.I8}}],onclick:function(){return Z("\u5168\u90e8\u8bc4\u8bba\u6570\u91cf",n)}},{type:"group",left:162,top:57,silent:!1,children:[{type:"line",shape:{x1:0,x2:0,y1:0,y2:44},style:{lineWidth:"2",stroke:I.includes("\u6709\u6548\u8bc4\u8bba\u6570\u91cf")?"#5FDCA8":"#8C8C8C"}},{type:"text",left:12,style:{text:"\u6709\u6548\u8bc4\u8bba\u6570\u91cf",fill:"#8C8C8C",font:"500 12px "+C.I8}},{type:"text",top:26,left:12,style:{text:""+(0,x.hE)(R(e,"usefulCommentCount")),fill:"#8C8C8C",font:"500 20px "+C.I8}}],onclick:function(){return Z("\u6709\u6548\u8bc4\u8bba\u6570\u91cf",n)}},{type:"group",left:308,top:57,silent:!1,children:[{type:"line",shape:{x1:0,x2:0,y1:0,y2:44},style:{lineWidth:"2",stroke:I.includes("\u65e0\u6548\u8bc4\u8bba\u6570\u91cf")?"#F5BC14":"#8C8C8C"}},{type:"text",left:12,style:{text:"\u65e0\u6548\u8bc4\u8bba\u6570\u91cf",fill:"#8C8C8C",font:"500 12px "+C.I8}},{type:"text",top:26,left:12,style:{text:""+(0,x.hE)(R(e,"unusefulCommentCount")),fill:"#8C8C8C",font:"500 20px "+C.I8}}],onclick:function(){return Z("\u65e0\u6548\u8bc4\u8bba\u6570\u91cf",n)}}],series:[{type:"line",name:"\u5168\u90e8\u8bc4\u8bba\u6570\u91cf",showSymbol:a,emphasis:{scale:!0},color:"#5B8FF9",data:I.includes("\u5168\u90e8\u8bc4\u8bba\u6570\u91cf")?M(e,"allCommentCount").map((function(e,t){return{name:e[0],value:e[1],symbol:"image://"+T.N,symbolSize:16,label:{normal:{show:a,position:"top",color:"#262626"}}}})):[]},{type:"line",name:"\u6709\u6548\u8bc4\u8bba\u6570\u91cf",showSymbol:a,emphasis:{scale:!0},color:"#5FDCA8",data:I.includes("\u6709\u6548\u8bc4\u8bba\u6570\u91cf")?M(e,"usefulCommentCount").map((function(e,t){return{name:e[0],value:e[1],symbol:"image://"+T.N,symbolSize:16,label:{normal:{show:a,position:"top",color:"#262626"}}}})):[]},{type:"line",name:"\u65e0\u6548\u8bc4\u8bba\u6570\u91cf",showSymbol:a,emphasis:{scale:!0},color:"#F5BC14",data:I.includes("\u65e0\u6548\u8bc4\u8bba\u6570\u91cf")?M(e,"unusefulCommentCount").map((function(e,t){return{name:e[0],value:e[1],symbol:"image://"+T.N,symbolSize:16,label:{normal:{show:a,position:"top",color:"#262626"}}}})):[]}]}}(t,i,r,a.renderChart,e);a.chartRef.clear(),a.chartRef.setOption(o)}},a.getChartRef=function(e){return a.chartRef=e},a.setTimeType=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.onDateChange({dateGroupType:t},a.props.title);case 2:return e.next=4,a.setState({activeObjTimeType:t});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.setFlavorTimeType=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.onFlavorChange({collectCommentTimeDate:t});case 2:return e.next=4,a.setState({flavorTimeType:t});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.state={showLabel:!1,chartType:"c0",iconIsDisable:!1,activeObjTimeType:a.props.flavor||"",flavorTimeType:a.props.flavor||""},a}(0,i.Z)(t,e);var a=t.prototype;return a.changeActiveObjTimeType=function(){var e=this,t=this.props.timeParams.dateOptions;Array.isArray(t)&&this.props.flavor&&t.some((function(t){return t.value===e.props.flavor}))?this.setState({activeObjTimeType:this.props.flavor,flavorTimeType:this.props.flavor}):this.props.timeParams.defaultDateType?this.setState({activeObjTimeType:this.props.timeParams.defaultDateType}):this.setState({activeObjTimeType:"WEEK"})},a.componentDidMount=function(){var e=this;if(this.chartRef){this.renderChart(!0);var t=this.chartRef._dom.children,a=t[0],n=t[1];a.addEventListener("mouseleave",(function(t){e.chartLeaveTimeout=setTimeout((function(){e.chartLeaveTimeout&&(n.style.display="none")}),2e3)})),n&&n.addEventListener("mouseenter",(function(t){e.chartLeaveTimeout=void 0}))}},a.componentDidUpdate=function(){var e=(0,r.Z)(c().mark((function e(t,a){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.timeParams.defaultDateType===t.timeParams.defaultDateType){e.next=3;break}return e.next=3,this.updateDateType();case 3:if(t.flavor===this.props.flavor){e.next=6;break}return e.next=6,this.changeActiveObjTimeType();case 6:if(!this.checkIfRealChanged(t,a)){e.next=9;break}return e.next=9,this.renderChart();case 9:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}(),a.checkIfRealChanged=function(e,t){var a=this,n=0===e.dataSource.length&&!e.loading,r=["activeObjTimeType","flavorTimeType","showLabel"].some((function(e){return t[e]!==a.state[e]})),i=e.filterChangeBool!==this.props.filterChangeBool||JSON.stringify(e.dataSource)!==JSON.stringify(this.props.dataSource);return r||i||n},a.updateDateType=function(){this.setState({activeObjTimeType:this.props.timeParams.defaultDateType})},a.render=function(){var e=this,t=this.props,a=t.dataSource,n=t.title,r=t.loading,i=t.timeParams,o=this.state,s=o.showLabel,l=o.chartType,c=o.iconIsDisable;return u.createElement(y.Z,{data:a,loading:r,style:{height:"c0"===l?400:444},className:"yt_service_insight_line_chart_wrap",renderTitle:u.createElement(v.Z,{title:n,data:null},u.createElement(P,{rightHook:!0,onChange:this.setTimeType,options:i.dateOptions||[{title:"\u6309\u5468",value:"WEEK"}],activeObj:this.state.activeObjTimeType,flavor:this.state.flavorTimeType,onFlavorChange:this.setFlavorTimeType}),u.createElement(h.default,{placement:"top",content:"\u663e\u793a\u56fe\u8868\u6807\u7b7e",mouseEnterDelay:.6,getPopupContainer:function(e){return document.querySelector(".header_Filter_bar")||e}},u.createElement("i",{style:{color:"c0"===l?"":"#bfbfbf"},className:"icon-tubiaobiaoqian "+(s?"active":"")+"  "+(c?"disableClass":""),onClick:function(){e.setState({showLabel:!s})}})),u.createElement(h.default,{placement:"top",content:"\u5bfc\u51fa\u6570\u636e",mouseEnterDelay:.6,getPopupContainer:function(e){return document.querySelector(".header_Filter_bar")||e}},u.createElement("i",{className:"icon-daochu",onClick:function(){return z(e.chartRef,"data",a,n,e.state.activeObjTimeType)}})),u.createElement(h.default,{placement:"top",content:"\u5bfc\u51fa\u56fe\u7247",mouseEnterDelay:.6,getPopupContainer:function(e){return document.querySelector(".header_Filter_bar")||e}},u.createElement("i",{style:{color:"c0"===l?"":"#bfbfbf"},className:"icon-xiazaitupian "+(c?"disableClass":""),onClick:function(){return z(e.chartRef,"image",a,n,e.state.activeObjTimeType)}})))},u.createElement(g.Z,{theme:"yunting_multi_color",option:{},style:{width:"100%",height:400,display:"c0"===l?"block":"none"},onChartReady:this.getChartRef}))},t}(u.Component);var B=function(e){var t=0;e.forEach((function(e){var a=parseFloat(e);a>t&&(t=a)})),t=Math.ceil(t);for(var a=0;a<4;a++)t%4!==0&&t++;return 0===t&&(t=4),{intVal:t/4,maxVal:t}},U=function(e,t,a,r,i,o,s,l,c,u,p){var d=V(t).datasets.source;return{tooltip:{trigger:"item",showDelay:20,hideDelay:55,confine:!0,enterable:!0,padding:0,backgroundColor:"#ffffff",borderColor:"#e5e5e5",borderWidth:"1",extraCssText:"border-radius: 2px;\n      box-shadow: 0px 9px 28px 8px rgba(0,0,0,0.05), 0px 6px 16px 0px rgba(0,0,0,0.08), 0px 3px 6px -4px rgba(0,0,0,0.12)",formatter:function(t,r,i){var o=t.marker,s=t.name,c=t.value;return setTimeout((function(){i(r,(0,E.r)("                \n              <span>"+s+"</span>",["<div style='display: flex;justify-content: space-between;align-items: center;color: #8c8c8c;'><div><span style='vertical-align: bottom'>"+o+"</span>\u8bc4\u8bba\u6570\u91cf</div><div style='color: #262626;margin-left: 10px;'>"+(0,x.hE)(c)+"</div></div>"],[{title:"\u6d88\u606f",icon:"icon-cem_jump-message",callback:function(){l((0,n.Z)({},t,{barData:e,activeObjCommentType:p}),a)}}],"yt_new_tooltip_wrapper"))}),0)}},color:["#5B8FF9","#60DDA9"],grid:{top:63,left:36,right:60,bottom:56,containLabel:!0},dataZoom:{start:o,end:s,show:!0,bottom:24,xAxisIndex:0,height:20,handleSize:"100%",showDetail:!1,borderColor:"transparent",dataBackground:{lineStyle:{color:"rgba(231, 243, 255, 1)",opacity:1},areaStyle:{color:"rgba(231, 243, 255, 1)",opacity:1}},fillerColor:"rgba(114, 98, 253, 0.3)",handleIcon:"path://M249.376256 0m102.4 0l0 0q102.4 0 102.4 102.4l0 819.2q0 102.4-102.4 102.4l0 0q-102.4 0-102.4-102.4l0-819.2q0-102.4 102.4-102.4Z",handleColor:"rgba(114, 98, 253, 1)"},xAxis:[{type:"category",axisTick:{show:!1},data:d.map((function(e){return e[1]})),axisLabel:{rotate:c&&u?45:0,textStyle:{color:"#262626",fontSize:12}}}],yAxis:[{type:"value",interval:B([].concat(t.map((function(e){return e.count})),t.map((function(e){return e.prevCount})))).intVal,max:B([].concat(t.map((function(e){return e.count})),t.map((function(e){return e.prevCount})))).maxVal,axisLine:{show:!1},axisLabel:{textStyle:{color:"#8C8C8C"}},splitLine:{show:!0,lineStyle:{color:["#e5e5e5"],width:1,type:"dashed"}}}],series:[{name:"\u8bc4\u8bba\u6570\u91cf",type:"bar",barGap:0,barMaxWidth:24,label:{show:i,position:"top",color:"#262626",offset:[-5,0]},emphasis:{focus:"series"},data:d.map((function(e){return e[2]}))}]}};function V(e){var t=e&&"empty"!==e&&e.map((function(e,t){return[t+1,e.name,e.count]}));return{length:e?e.length:0,datasets:{dimensions:["\u5e8f\u53f7","\u54c1\u724c","\u8bc4\u8bba\u6570\u91cf"],source:t}}}var q=function(e,t,a,n){if("image"===t)(0,S._v)(e,n);else if("data"===t){var r=V(a).datasets,i=[r.dimensions].concat(r.source);(0,S.aT)([i],n)}};const J=function(e){function t(t){var a;return(a=e.call(this,t)||this).chartRef=void 0,a.chartLeaveTimeout=void 0,a.start=0,a.end=100,a.needRotate=!1,a.dragEnd=!1,a.renderChart=function(){var e=a.props,t=e.title,n=e.dataSource,r=e.onMsgClick,i=a.state,o=i.showLabel,s=i.data,l=i.activeObjCommentType;if((0,y.P)(n)&&a.chartRef){var c=U(n,s,t,a.chartRef.getWidth(),o,a.start,a.end,r,a.needRotate,a.dragEnd,l);a.chartRef.clear(),a.chartRef.setOption(c)}},a.getChartRef=function(e){return a.chartRef=e},a.sort=function(e,t){return e.sort((function(e,t){return t.count-e.count})),e=e.slice(0,t)},a.setTopNum=function(e){var t=e.substr(3);a.start=0,a.needRotate=!1,a.dragEnd=!1;var n=a.props.dataSource;n=a.sort(n,t),a.setState({activeObjTopNum:"TOP"+t,data:n})},a.setCommentType=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.onCommentChange({messageType:t},a.props.title);case 2:a.setState({activeObjCommentType:t});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.state={showLabel:!1,iconIsDisable:!1,activeObjTopNum:"TOP30",activeObjCommentType:"allComment",data:a.sort(a.props.dataSource,30)},a}(0,i.Z)(t,e);var a=t.prototype;return a.componentDidMount=function(){var e=this;if(this.chartRef){this.renderChart();var t=this.chartRef._dom.children,a=t[0],n=t[1];a.addEventListener("mouseleave",(function(t){e.chartLeaveTimeout=setTimeout((function(){e.chartLeaveTimeout&&(n.style.display="none")}),2e3)})),this.state.data.length>+this.state.activeObjTopNum?this.end=1e3/+this.state.activeObjTopNum:this.end=1e3/this.state.data.length,n&&n.addEventListener("mouseenter",(function(t){e.chartLeaveTimeout=void 0})),this.chartRef.on("datazoom",(function(){var t=e.chartRef.getOption();e.start=t.dataZoom[0].start,e.end=t.dataZoom[0].end,e.needRotate=(0,x.jD)(e.state.data.map((function(e){return e.name})),12)/(.5*e.chartRef.getWidth())>1,e.dragEnd=e.end-e.start>70;var a=e.props,n=a.title,r=a.dataSource,i=a.onMsgClick,o=e.state,s=o.showLabel,l=o.data,c=o.activeObjCommentType;e.chartRef.setOption(U(r,l,n,e.chartRef.getWidth(),s,e.start,e.end,i,e.needRotate,e.dragEnd,c))}))}},a.componentDidUpdate=function(e,t){if(this.checkIfRealChanged(e,t)){var a=this.sort(this.props.dataSource,30);a.length>+this.state.activeObjTopNum?this.end=1e3/+this.state.activeObjTopNum:this.end=1e3/a.length,this.renewData(a)}},a.checkIfRealChanged=function(e,t){var a=this,n=0===e.dataSource.length&&void 0===e.loading,r=["activeObjCommentType","activeObjTopNum","showLabel"].some((function(e){return t[e]!==a.state[e]})),i=JSON.stringify(e.dataSource)!==JSON.stringify(this.props.dataSource);return r||n||i},a.renewData=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState({data:this.sort(t,this.state.activeObjTopNum.substr(3))});case 2:this.renderChart();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),a.render=function(){var e=this,t=this.props,a=t.title,n=t.loading,r=t.dataSource,i=(t.onFilterChange,this.state),o=i.showLabel,s=i.iconIsDisable;return u.createElement("div",{className:"yt_productSpotManagerCommentBarChart_wrapper"},u.createElement(y.Z,{data:r,loading:n,renderTitle:u.createElement(v.Z,{title:a,data:null},u.createElement("div",{className:"operate_zone"},u.createElement(P,{rightHook:!0,onChange:this.setCommentType,options:[{title:"\u5168\u90e8\u8bc4\u8bba",value:"allComment"},{title:"\u6709\u6548\u8bc4\u8bba",value:"userfulComment"}],activeObj:this.state.activeObjCommentType}),u.createElement(P,{rightHook:!0,onChange:this.setTopNum,options:[{title:"TOP10",value:"TOP10"},{title:"TOP20",value:"TOP20"},{title:"TOP30",value:"TOP30"}],activeObj:this.state.activeObjTopNum})),u.createElement(h.default,{placement:"top",content:"\u663e\u793a\u56fe\u8868\u6807\u7b7e",mouseEnterDelay:.6,getPopupContainer:function(e){return e}},u.createElement("i",{className:"icon-tubiaobiaoqian "+(o?"active":"")+"  "+(s?"disableClass":""),onClick:function(){var t=e.chartRef.getOption();e.start=t.dataZoom[0].start,e.end=t.dataZoom[0].end,e.setState({showLabel:!o})}})),u.createElement(h.default,{placement:"top",content:"\u5bfc\u51fa\u6570\u636e",mouseEnterDelay:.6,getPopupContainer:function(e){return e}},u.createElement("i",{className:"icon-daochu",onClick:function(){return q(e.chartRef,"data",e.state.data,a)}})),u.createElement(h.default,{placement:"top",content:"\u5bfc\u51fa\u56fe\u7247",mouseEnterDelay:.6,getPopupContainer:function(e){return document.querySelector(".header_Filter_bar")||e}},u.createElement("i",{className:"icon-xiazaitupian "+(s?"disableClass":""),onClick:function(){return q(e.chartRef,"image",r,a)}})))},r&&u.createElement(u.Fragment,null,u.createElement(g.Z,{theme:"yunting_multi_color",option:{},style:{width:"100%",height:460},onChartReady:this.getChartRef}))))},t}(u.PureComponent);var W=a(55609),Y=a(64396),H=a(39184),X=a(77526),Q=a(79916),K=a(17774),$=function(e,t,a,r,i,o,s,l,c){e.map((function(e){return e[0]}));for(var u=0;u<e.length;u++)for(var p=u-1;p>=0;p--)if(e[u][0]===e[p][0].trim()){e[u][0]=e[p][0]+" ";break}var d=e.map((function(e){return e[1]})),m=Math.max.apply(Math,d),f=Array.from(new Set(e.map((function(e){return e[2]}))));return{grid:{top:100,left:36,right:60,bottom:56,containLabel:!0},xAxis:{type:"category",axisLabel:{rotate:o&&s?45:0,textStyle:{color:"#262626",fontSize:12}}},yAxis:{type:"value",axisLine:{show:!1},axisLabel:{textStyle:{color:"#8C8C8C"}},splitLine:{show:!0,lineStyle:{color:["#e5e5e5"],width:1,type:"dashed"}},interval:Math.ceil(m/4),max:4*Math.ceil(m/4)},series:[{type:"bar",barMaxWidth:24,data:e,label:{show:t,position:"top",color:"#262626",offset:[0,0]}}],visualMap:[{show:1!==f.length,type:"piecewise",top:46,left:20,itemWidth:10,itemHeight:10,orient:"horizontal",categories:f,inRange:{symbol:"circle",color:C.OW}}],dataZoom:{show:!0,bottom:24,height:20,showDetail:!1,borderColor:"transparent",dataBackground:{lineStyle:{color:"rgba(231, 243, 255, 1)",opacity:1},areaStyle:{color:"rgba(231, 243, 255, 1)",opacity:1}},fillerColor:"rgba(114, 98, 253, 0.3)",handleIcon:"path://M249.376256 0m102.4 0l0 0q102.4 0 102.4 102.4l0 819.2q0 102.4-102.4 102.4l0 0q-102.4 0-102.4-102.4l0-819.2q0-102.4 102.4-102.4Z",handleColor:"rgba(114, 98, 253, 1)",start:a,end:r},tooltip:{showDelay:20,hideDelay:50,enterable:!0,confine:!0,padding:0,backgroundColor:"#ffffff",borderColor:"#e5e5e5",borderWidth:"1",extraCssText:"border-radius: 2px;\n      box-shadow: 0px 9px 28px 8px rgba(0,0,0,0.05), 0px 6px 16px 0px rgba(0,0,0,0.08), 0px 3px 6px -4px rgba(0,0,0,0.12)",position:function(e,t,a,n,r){var i=r.contentSize,o=r.viewSize,s=e[0]<o[0]/2?0:-1,l=e[1]<o[1]/2?-.5:-1,c=e[0]<o[0]/2?16:-16;return[e[0]+s*i[0]+c,e[1]+l*i[1]]},formatter:function(e,t,a){return setTimeout((function(){a(t,(0,E.r)('<span style="font-size: 12px; color: #262626; font-weight: 400">'+e.data[0]+"</span>",["<div  style='display: flex;justify-content: space-between;align-items: center;color: #8c8c8c;'>\n                  <div>\n                    <span style='vertical-align: bottom'>\n                      <span style=\"display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:"+e.color+";\"></span>\n                    </span>\n                    \u8bc4\u8bba\u6570\u91cf\n                  </div>\n                  <div style='color: #262626;margin-left: 10px;'>\n                    "+e.data[1]+"\n                  </div>\n                </div>"],[{title:"\u6d88\u606f",icon:"icon-cem_jump-message",callback:function(){return i((0,n.Z)({},e,{topicType:l,commentType:c}),"\u8bc4\u8bba\u6570\u91cf")}}],"yt_new_tooltip_wrapper"))}),0)}}}};var ee=function(e,t,a,n){if("image"===t)(0,S._v)(e,n);else if("data"===t){var r=function(e){var t=e&&"empty"!==e&&e.map((function(e,t){return[t+1,e[0],e[1]]}));return{length:e?e.length:0,datasets:{dimensions:["\u5e8f\u53f7","\u578b\u53f7","\u8bc4\u8bba\u6570\u91cf"],source:t}}}(a),i=r.datasets,o=[i.dimensions].concat(i.source);(0,S.aT)([o],n)}},te=a(4609),ae=["loading"];function ne(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(a)return(a=a.call(e)).next.bind(a);if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"===typeof e)return re(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return re(e,t)}(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var ie=Y.Z.IDBHeaderScreening.screening,oe=function(e){function t(t){var a;return(a=e.call(this,t)||this).chartRef=void 0,a.start=0,a.end=100,a.needRotate=!1,a.dragEnd=!1,a.first=!0,a.getNumString=function(e){switch(e){case"TOP10":return"10";case"TOP20":return"20";case"TOP30":return"30"}return""},a.getComment=function(e){return""===e?e:"allComment"===e?"all":"userfulComment"},a.getSet=function(e){if(e[0]&&!e[0].commentList){for(var t={name:"temp2",commentList:[]},a=[t],n=0;n<e.length;n++)t.commentList.push({id:e[n].type,name:e[n].name,count:e[n].count});e=a}for(var r=[],i=0;i<e.length;i++)for(var o=0;o<e[i].commentList.length;o++){var s=[];s.push(e[i].commentList[o].name),s.push(e[i].commentList[o].count),s.push(e[i].name),r.push(s)}return r},a._handleOnMsgClick=function(e,t){var r,i,o=a.props,s=o.dataSource;(0,o.onMsgClick)((0,n.Z)({},e,{topicValueId:null==(r=s.find((function(t){return t.name===e.data[2]})))||null==(i=r.commentList.find((function(t){return t.name===e.data[0]})))?void 0:i.id}),t)},a.getChartRef=function(e){return a.chartRef=e},a.renewType=(0,r.Z)(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({flavorAnalyzeObj:a.props.flavor,activeObjAnalyzeObj:""===a.props.flavor?"1333":a.props.flavor});case 2:return t="all"===a.state.activeObjCommentType?"allComment":"userfulComment",n=a.props.flavor,e.next=6,a.props.onDataChange({messageType:t,analyseObject:n},"\u5404\u578b\u53f7\u8bc4\u8bba\u6570\u91cf");case 6:case"end":return e.stop()}}),e)}))),a.checkIfRealChanged=function(e,t){var n=["activeObjTopNum","activeObjCommentType","activeObjSort","activeObjAnalyzeObj","flavorAnalyzeObj"].some((function(e){return t[e]!==a.state[e]})),r=JSON.stringify(e.dataSource)!==JSON.stringify(a.props.dataSource);return n||r},a.renewData=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({dataSource:t,data:t});case 2:a.setTopNum(a.state.activeObjTopNum),a.setSort(a.state.activeObjSort);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.changeData=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({activeObjAnalyzeObj:a.props.flavor,flavorAnalyzeObj:a.props.flavor});case 2:case"end":return e.stop()}}),e)}))),a.sort=function(e,t,a){if(t=+t,e.sort((function(e,t){return t[1]-e[1]})),e=e.slice(0,t),!a)return e;for(var n=0;n<e.length;n++)for(var r=n+1;r<e.length;r++)if(e[r][2]===e[n][2]){var i=e.splice(r,1);e.splice(n+1,0,i[0]),n++}return e},a.setTopNum=function(e){a.needRotate=!1,a.start=0;var t=a.state.dataSource;t=a.sort(t,e,!0),a.setState({activeObjTopNum:e,data:t})},a.setSort=function(e){var t=a.state.dataSource;t="group"===e?a.sort(t,a.state.activeObjTopNum,!0):a.sort(t,a.state.activeObjTopNum,!1),a.setState({activeObjSort:e,data:t})},a.setCommentType=function(){var e=(0,r.Z)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="all"===t?"allComment":"userfulComment",r=a.state.activeObjAnalyzeObj,e.next=4,a.props.onDataChange({messageType:n,analyseObject:r},"\u5404\u578b\u53f7\u8bc4\u8bba\u6570\u91cf");case 4:return e.next=6,a.setState({activeObjCommentType:t});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.setAnalyzeObj=function(){var e=(0,r.Z)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="all"===a.state.activeObjCommentType?"allComment":"userfulComment",r=t,e.next=4,a.props.onDataChange({messageType:n,analyseObject:r},"\u5404\u578b\u53f7\u8bc4\u8bba\u6570\u91cf");case 4:return e.next=6,a.setState({activeObjAnalyzeObj:t});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.changeFlavor=function(){var e=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.onFlavorChange({typeAnalysisData:t});case 2:return e.next=4,a.setState({flavorAnalyzeObj:t});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.state={showLabel:!1,dataSource:a.getSet(t.dataSource),data:a.getSet(t.dataSource),activeObjTopNum:"30",activeObjSort:"group",activeObjCommentType:"all",activeObjAnalyzeObj:""===a.props.flavor?"1333":a.props.flavor,flavorAnalyzeObj:a.props.flavor||""},a}(0,i.Z)(t,e);var a=t.prototype;return a.renderChart=function(){this.chartRef&&(this.chartRef.clear(),this.chartRef.setOption($(this.state.data,this.state.showLabel,this.start,this.end,this._handleOnMsgClick,this.needRotate,this.dragEnd,this.state.activeObjAnalyzeObj,this.state.activeObjCommentType)))},a.componentDidMount=function(){var e=this;this.state.data.length>+this.state.activeObjTopNum?this.end=1e3/+this.state.activeObjTopNum:this.end=1e3/this.state.data.length,this.setTopNum(this.state.activeObjTopNum),this.setSort(this.state.activeObjSort);var t=this.props.curScreeningMap?this.props.curScreeningMap.find((function(e){return"TOPIC"===e.id})):[];t&&(t.data||[]).slice(1).map((function(e){return{title:e.label,value:e.id}}));this.chartRef&&this.chartRef.on("datazoom",(function(){var t=e.chartRef.getOption();e.start=t.dataZoom[0].start,e.end=t.dataZoom[0].end,e.needRotate=(0,x.jD)(e.state.data.map((function(e){return e[0]})).join(""),12)/(.3*e.chartRef.getWidth())>1,e.dragEnd=e.end-e.start>70,e.chartRef.setOption($(e.state.data,e.state.showLabel,e.start,e.end,e._handleOnMsgClick,e.needRotate,e.dragEnd,e.state.activeObjAnalyzeObj,e.state.activeObjCommentType))})),this.renderChart()},a.componentDidUpdate=function(){var e=(0,r.Z)(c().mark((function e(t,a){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.dataSource.length===this.props.dataSource.length&&!this.checkIfRealChanged(t,a)){e.next=7;break}return(n=this.getSet(this.props.dataSource)).length>+this.state.activeObjTopNum?this.end=1e3/+this.state.activeObjTopNum:this.end=1e3/n.length,e.next=5,this.renewData(n);case 5:return e.next=7,this.renderChart();case 7:this.props.flavor!==this.state.flavorAnalyzeObj&&this.first&&(this.first=!1,this.renewType());case 8:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}(),a.render=function(){for(var e,t=this,a=Array.from(new Set(this.state.data.map((function(e){return e[2]})))),n=this.props.curScreeningMap?this.props.curScreeningMap.find((function(e){return"TOPIC"===e.id})):[],i=n?(n.data||[]).slice(1).map((function(e){return{title:e.label,value:e.id}})):[],o="",s=ne(i);!(e=s()).done;){var l=e.value;l.value===this.state.activeObjAnalyzeObj&&(o=l.title)}var p=this.props,d=p.loading,m=p.data;return u.createElement("div",{className:"yt_product_spot_manager_comment_chart"},u.createElement(y.Z,{data:[{data:m}],loading:d,renderTitle:u.createElement(v.Z,{title:"\u5404"+o+"\u8bc4\u8bba\u6570\u91cf"},u.createElement("div",{className:"operate_zone"},u.createElement(P,{className:"set_Top_active",onChange:this.setAnalyzeObj,rightHook:!0,options:i,activeObj:this.state.activeObjAnalyzeObj,preTitle:"\u5206\u6790\u5bf9\u8c61",flavor:this.state.flavorAnalyzeObj,onFlavorChange:this.changeFlavor}),u.createElement(P,{className:"set_Top_active",onChange:this.setCommentType,rightHook:!0,options:[{title:"\u5168\u90e8\u8bc4\u8bba",value:"all"},{title:"\u6709\u6548\u8bc4\u8bba",value:"valid"}],activeObj:this.state.activeObjCommentType}),a.length>1&&u.createElement(P,{onChange:this.setSort,iconImg:[H,X,Q,K],rightHook:!0,options:[{title:"\u5206\u7ec4\u6392\u5e8f",value:"group"},{title:"\u5168\u5c40\u6392\u5e8f",value:"global"}],activeObj:this.state.activeObjSort}),u.createElement(P,{onChange:this.setTopNum,rightHook:!0,options:[{title:"TOP10",value:"10"},{title:"TOP20",value:"20"},{title:"TOP30",value:"30"}],activeObj:this.state.activeObjTopNum})),u.createElement("div",{className:"icon_zone"},u.createElement("div",{className:"icon"},u.createElement(h.default,{placement:"top",content:"\u663e\u793a\u56fe\u8868\u6807\u7b7e",mouseEnterDelay:.6},u.createElement("i",{className:"icon-tubiaobiaoqian "+(this.state.showLabel?"active":""),onClick:(0,r.Z)(c().mark((function e(){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.chartRef.getOption(),t.start=a.dataZoom[0].start,t.end=a.dataZoom[0].end,e.next=5,t.setState({showLabel:!t.state.showLabel});case 5:t.renderChart();case 6:case"end":return e.stop()}}),e)})))}))),u.createElement("div",{className:"icon"},u.createElement(h.default,{placement:"top",content:"\u5bfc\u51fa\u6570\u636e",mouseEnterDelay:.6},u.createElement("i",{className:"icon-daochu",onClick:function(){return ee(t.chartRef,"data",t.state.data,"\u5404"+o+"\u8bc4\u8bba\u6570\u91cf")}}))),u.createElement("div",{className:"icon"},u.createElement(h.default,{placement:"top",content:"\u5bfc\u51fa\u56fe\u7247",mouseEnterDelay:.6},u.createElement("i",{className:"icon-xiazaitupian",onClick:function(){return ee(t.chartRef,"image",null,"\u5404"+o+"\u8bc4\u8bba\u6570\u91cf")}})))))},this.state.data.length>0?u.createElement(g.Z,{theme:"yunting_multi_color",option:{},style:{width:"100%",height:500},onChartReady:this.getChartRef}):u.createElement("div",{className:"nodata"},u.createElement("img",{src:te,alt:""}),u.createElement("p",null,"\u6682\u65e0\u6570\u636e"))))},t}(u.Component);const se=(0,W.connect)((function(e){e.loading;return{curScreeningMap:(0,m.Z)(e,ae)[ie].curScreeningMap}}))(oe);function le(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(a)return(a=a.call(e)).next.bind(a);if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"===typeof e)return ce(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ce(e,t)}(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var ue=function(e,t){return e=function(e,t){for(var a,n=le(e);!(a=n()).done;)for(var r=a.value,i=0;i<t.length;i++)if(r.name===t[i]){r.itemStyle={color:C.OW[i]};break}return e}(e,t),{grid:{top:100},series:[{type:"treemap",data:e,roam:!1,nodeClick:!1,itemStyle:{gapWidth:5},width:"100%",height:437,top:52,breadcrumb:{show:!1},label:{formatter:function(e){},fontSize:12,overflow:"break"}}],tooltip:{trigger:"item",showDelay:10,hideDelay:50,enterable:!0,confine:!0,padding:0,backgroundColor:"#ffffff",borderColor:"#e5e5e5",borderWidth:"1",extraCssText:"border-radius: 2px;\n      box- shadow: 0px 9px 28px 8px rgba(0,0,0,0.05), 0px 6px 16px 0px rgba(0,0,0,0.08), 0px 3px 6px - 4px rgba(0,0,0,0.12)",position:function(e,t,a,n,r){var i=r.contentSize,o=r.viewSize,s=e[0]<o[0]/2?0:-1,l=e[1]<o[1]/2?-.5:-1,c=e[0]<o[0]/2?16:-16;return[e[0]+s*i[0]+c,e[1]+l*i[1]]},formatter:function(e,t,a){return setTimeout((function(){a(t,(0,E.r)('<span span style = "font-size: 12px; color: #262626; font-weight: 400" > '+e.data.name+" </span>",["<div  style='display: flex;justify-content: space-between;align-items: center;color: #8c8c8c;'>\n                  <div>\n                    <span style='vertical-align: bottom'>\n                      <span style=\"display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:"+e.color+";\"></span>\n                    </span>\n                    \u94fe\u63a5\u6570\n                  </div>\n                  <div style='color: #262626;margin-left: 10px;'>\n                    "+e.data.value+"\n                  </div>\n                </div>"],[],"yt_new_tooltip_wrapper"))}),0)}}}};var pe=function(e,t,a,n){if("image"===t)(0,S._v)(e,n);else if("data"===t){var r=function(e){for(var t=[],a=0;a<e.length;a++)for(var n=0;n<e[a].children.length;n++)t.push([e[a].name,e[a].children[n].name,e[a].children[n].value]);return{length:e?e.length:0,datasets:{dimensions:["\u54c1\u724c","\u5e97\u94fa","\u94fe\u63a5\u6570\u91cf"],source:t}}}(a),i=r.datasets,o=[i.dimensions].concat(i.source);(0,S.aT)([o],n)}};function de(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(a)return(a=a.call(e)).next.bind(a);if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"===typeof e)return me(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return me(e,t)}(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}const fe=function(e){function t(t){var a;return(a=e.call(this,t)||this).chartRef=void 0,a.getBrands=function(e){if(!e[0]||!e[0].commentList)return[];for(var t=[],a=0;a<e.length;a++)for(var n=0;n<e[a].commentList.length;n++){var r=[];r.push(e[a].commentList[n].name),r.push(e[a].commentList[n].count),r.push(e[a].name),t.push(r)}return t.sort((function(e,t){return t[1]-e[1]})),Array.from(new Set(t.map((function(e){return e[2]}))))},a.processData=function(e){for(var t=[],a=0;a<e.length;a++){for(var n={name:e[a].brand,value:0,children:[]},r=0;r<e[a].shop.length;r++){var i={name:e[a].shop[r].name,value:e[a].shop[r].count};n.value+=i.value,n.children.push(i)}t.push(n)}return t},a.getChartRef=function(e){return a.chartRef=e},a.checkIfRealChanged=function(e,t){var n=JSON.stringify(e.dataSource)!==JSON.stringify(a.props.dataSource),r=JSON.stringify(e.dataSource2)!==JSON.stringify(a.props.dataSource2);return n||r},a.renewData=function(){a.setState({dataSource:a.processData(a.props.dataSource),data:a.processData(a.props.dataSource),brands:a.getBrands(a.props.dataSource2)})},a.setTopNum=function(e){for(var t=a.state.dataSource,n=[],r=0;r<t.length;r++)for(var i=0;i<t[r].children.length;i++){var o=[t[r].children[i].name,t[r].children[i].value,t[r].name];n.push(o)}n.sort((function(e,t){return t[1]-e[1]})),n=n.slice(0,+e);for(var s=[],l=0;l<n.length;l++){for(var c=!1,u=0;u<s.length;u++)if(s[u].name===n[l][2]){s[u].children.push({name:n[l][0],value:n[l][1]}),s[u].value+=n[l][1],c=!0;break}c||s.push({name:n[l][2],value:n[l][1],children:[{name:n[l][0],value:n[l][1]}]})}a.setState({activeObjTopNum:e,data:s})},a.state={dataSource:a.processData(t.dataSource),data:a.processData(t.dataSource),brands:a.getBrands(t.dataSource2),activeObjTopNum:"30",flavorTopNum:"0"},a}(0,i.Z)(t,e);var a=t.prototype;return a.renderChart=function(){this.chartRef&&(this.chartRef.clear(),this.chartRef.setOption(ue(this.state.data,this.state.brands)))},a.componentDidMount=function(){this.renderChart()},a.componentDidUpdate=function(e,t){e.dataSource.length!==this.props.dataSource.length&&this.renewData(),this.checkIfRealChanged(e,t)&&this.renewData(),this.renderChart()},a.isHaveData=function(){if(!this.state.data)return!1;if(0===this.state.data.length)return!1;for(var e,t=de(this.state.data);!(e=t()).done;)if(e.value.value>0)return!0;return!1},a.render=function(){var e=this,t=this.props.loading;return u.createElement("div",{className:"yt_product_spot_manager_store_link_num_chart"},u.createElement(y.Z,{data:[{}],loading:t,renderTitle:u.createElement(v.Z,{title:"\u5404\u5e97\u94fa\u91c7\u96c6\u94fe\u63a5\u6570\u91cf"},u.createElement("div",{className:"operate_zone"},u.createElement(P,{className:"set_Top_active",onChange:this.setTopNum,rightHook:!0,options:[{title:"TOP10",value:"10"},{title:"TOP20",value:"20"},{title:"TOP30",value:"30"}],activeObj:this.state.activeObjTopNum})),u.createElement("div",{className:"icon_zone"},u.createElement("div",{className:"icon"},u.createElement(h.default,{placement:"top",content:"\u5bfc\u51fa\u6570\u636e",mouseEnterDelay:.6},u.createElement("i",{className:"icon-daochu",onClick:function(){pe(e.chartRef,"data",e.state.dataSource,"\u5404\u5e97\u94fa\u91c7\u96c6\u94fe\u63a5\u6570\u91cf")}}))),u.createElement("div",{className:"icon"},u.createElement(h.default,{placement:"top",content:"\u5bfc\u51fa\u56fe\u7247",mouseEnterDelay:.6},u.createElement("i",{className:"icon-xiazaitupian",onClick:function(){return pe(e.chartRef,"image",null,"\u5404\u5e97\u94fa\u91c7\u96c6\u94fe\u63a5\u6570\u91cf")}})))))},this.isHaveData()?u.createElement(g.Z,{theme:"yunting_multi_color",option:{},style:{width:"calc(100% - 32px)",margin:"0 auto",padding:"0 0 16px",height:460},onChartReady:this.getChartRef}):u.createElement("div",{className:"nodata"},u.createElement("img",{src:te,alt:""}),u.createElement("p",null,"\u6682\u65e0\u6570\u636e"))))},t}(u.PureComponent);var he=["save","onFilterChange","onFilterReady","onDateChange","onFlavorChange","onMsgClick","dataAspect1","dataAspect2","metion","positiveRate","negativeRate","setCompare","MentionRateLoading","mentionLoading","positiveRateLoading","negativeRateLoading","chartTypeValue","chartTypeChange","updateFlavors","publicResource","chartData1","chartData2","curShowAspect","timeParams","ShopLinks","LCollects","LComments","Platforms","LBrandComments","LModelComments","loading","aspectDateType","flavor","isSelectAll","headerFilterParamsNew","filterChangeBool"];const ve=function(e){e.save;var t=e.onFilterChange,a=e.onFilterReady,n=e.onDateChange,r=e.onFlavorChange,i=e.onMsgClick,o=(e.dataAspect1,e.dataAspect2,e.metion,e.positiveRate,e.negativeRate,e.setCompare,e.MentionRateLoading,e.mentionLoading,e.positiveRateLoading,e.negativeRateLoading,e.chartTypeValue,e.chartTypeChange,e.updateFlavors,e.publicResource,e.chartData1,e.chartData2,e.curShowAspect,e.timeParams),s=e.ShopLinks,l=e.LCollects,c=e.LComments,h=e.Platforms,v=e.LBrandComments,y=e.LModelComments,g=e.loading,T=(e.aspectDateType,e.flavor),b=e.isSelectAll,C=(e.headerFilterParamsNew,e.filterChangeBool),E=((0,m.Z)(e,he),(0,u.useState)(l)),S=E[0],x=E[1],w=(0,u.useState)(c),A=w[0],N=w[1],O=(0,u.useState)(h),k=O[0],P=O[1],_=(0,u.useState)(v),D=_[0],j=_[1],M=(0,u.useState)(y),R=M[0],I=M[1],Z=(0,u.useState)(s),z=Z[0],B=Z[1],U=(0,u.useState)(g),V=U[0],q=U[1];return(0,u.useEffect)((function(){x(l),N(c),B(s),P(h),j(v),I(y)}),[]),(0,u.useEffect)((function(){l&&l.length&&x(l),s&&s.length&&B(s),h&&h.length&&P(h),c&&c.length&&N(c),v&&v.length&&j(v),y&&y.length&&I(y),g&&q(g)})),u.createElement("div",{className:"yt_productAnalysis_aspectAnalysis_wrapper"},u.createElement(f.Z,{onReady:a,onChange:t,pageType:"COMMENT_CONTACT_OVERVIEW",advanceAuthority:!1,valueConf:["fullInfo"],showList:["fullDate","screening","save"],hasHour:!0},u.createElement("div",{className:"content"},u.createElement("div",{className:"site-card-wrapper"},u.createElement(p.default,{gutter:16},u.createElement(d.default,{span:12},S&&u.createElement(F,{loading:V.LCollects,dataSource:S,title:"\u94fe\u63a5\u91c7\u96c6\u6570\u91cf",onMsgClick:i,onDateChange:n,onFlavorChange:r,timeParams:o,flavor:T.collectLinkTimeDate,filterChangeBool:C})),u.createElement(d.default,{span:12},A&&u.createElement(G,{loading:V.LComments,dataSource:A,title:"\u8bc4\u8bba\u91c7\u96c6\u60c5\u51b5",onMsgClick:i,onDateChange:n,onFlavorChange:r,timeParams:o,flavor:T.collectCommentTimeDate,filterChangeBool:C})))),k&&u.createElement(L,{title:"\u5404\u5e73\u53f0\u8bc4\u8bba\u5206\u5e03\u548c\u8d70\u52bf",loading:V.Platforms,data:k,onMsgClick:i,onDateChange:n,onFlavorChange:r,timeParams:o,flavorTimeType:T.platformTimeDate,flavorCommentType:T.platformComment,filterChangeBool:C}),b&&D&&u.createElement(J,{title:"\u5404\u54c1\u724c\u8bc4\u8bba\u6570\u91cf",loading:V.LBrandComments,dataSource:D,onFilterChange:t,onMsgClick:i,onCommentChange:n}),R&&u.createElement(se,{title:"\u5404\u578b\u53f7\u8bc4\u8bba\u6570\u91cf",loading:V.LModelComments,dataSource:R,onFilterChange:t,onDataChange:n,onFlavorChange:r,onMsgClick:i,flavor:T.typeAnalysisData}),R&&z&&u.createElement(fe,{title:"\u5404\u5e97\u94fa\u94fe\u63a5\u6570\u91cf",loading:V.ShopLinks,dataSource:z,dataSource2:R}))))};var ye=a(87219),ge=a(53113),Te=a(49722);function be(e){return Ce.apply(this,arguments)}function Ce(){return(Ce=(0,r.Z)(c().mark((function e(t){var a,n,r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.headerFilterParamsNew,n=t.dateFilter,r=t.projectId,i=t.quickFilterTopicId,e.abrupt("return",Te.h.post("/comment/comment-contact/chart/connection",{headerFilterParamsNew:a,dateFilter:n,projectId:r,quickFilterTopicId:i}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ee(e){return Se.apply(this,arguments)}function Se(){return(Se=(0,r.Z)(c().mark((function e(t){var a,n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.headerFilterParamsNew,n=t.dateFilter,r=t.projectId,e.abrupt("return",Te.h.post("/comment/comment-contact/chart/find/COMMENT_COLLECT_CHART",{headerFilterParamsNew:a,dateFilter:n,projectId:r}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xe(e){return we.apply(this,arguments)}function we(){return(we=(0,r.Z)(c().mark((function e(t){var a,n,r,i,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.headerFilterParamsNew,n=t.dateFilter,r=t.projectId,i=t.messageType,o=t.analyseObject,e.abrupt("return",Te.h.post("/comment/comment-contact/chart/find/ONE_BRAND_ONE_ANALYSIS_CHART",{headerFilterParamsNew:a,dateFilter:n,projectId:r,messageType:i||"allComment",analyseObject:o||"767"}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ae(e){return Ne.apply(this,arguments)}function Ne(){return(Ne=(0,r.Z)(c().mark((function e(t){var a,n,r,i,o,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.headerFilterParamsNew,n=t.dateFilter,r=t.projectId,i=t.messageType,o=t.analyseObject,s=t.quickFilterTopicId,e.abrupt("return",Te.h.post("/comment/comment-contact/chart/find/ALL_BRAND_ONE_ANALYSIS_CHART",{headerFilterParamsNew:a,dateFilter:n,projectId:r,messageType:i||"allComment",analyseObject:o||"1333",quickFilterTopicId:s}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(e){return ke.apply(this,arguments)}function ke(){return(ke=(0,r.Z)(c().mark((function e(t){var a,n,r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.headerFilterParamsNew,n=t.dateFilter,r=t.projectId,i=t.messageType,e.abrupt("return",Te.h.post("/comment/comment-contact/chart/find/PLATFORM_COMMENT_DISTRIBUTED_TREND_CHART",{headerFilterParamsNew:a,dateFilter:n,projectId:r,messageType:i||"allComment"}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pe(e){return Fe.apply(this,arguments)}function Fe(){return(Fe=(0,r.Z)(c().mark((function e(t){var a,n,r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.headerFilterParamsNew,n=t.dateFilter,r=t.projectId,i=t.quickFilterTopicId,e.abrupt("return",Te.h.post("/comment/comment-contact/shop/connection/list",{headerFilterParamsNew:a,dateFilter:n,projectId:r,quickFilterTopicId:i}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var _e,De;function je(e){return Le.apply(this,arguments)}function Le(){return(Le=(0,r.Z)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:De=t;case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Me={flavorMap:{},set:function(e){void 0===e&&(e={}),this.flavorMap=(0,n.Z)({},this.flavorMap,e)},get:function(e){return this.flavorMap[e]},update:function(){var e;e={key:Qe,projectId:_.t.get(_.V.curProject).id,value:JSON.stringify(this.flavorMap)},Te.h.post("/default/value/update",e)}},Re={dateMap:{collectLinkTimeDate:"",collectCommentTimeDate:"",platformTimeDate:"",analyseObject:""},set:function(e,t){t&&(this.dateMap[e]=t)},get:function(e){return this.dateMap[e]}};function Ie(e){return Ze.apply(this,arguments)}function Ze(){return(Ze=(0,r.Z)(c().mark((function e(t){var a,r,i,o,s,l,u,p,d,m;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_.t.get(_.V.curProject).id,t&&(De.dateFilter.dateGroupType=t.collectLinkTimeDate?t.collectLinkTimeDate:t.dateGroupType),i=(r=De).dateFilter,o=r.headerFilterParamsNew,s=r.quickFilterTopicId,l=r.analysisModel,u=l[0].values[0].isSelectAll,p=u?(0,n.Z)({},_e,{projectId:a,dateFilter:i,headerFilterParamsNew:o,quickFilterTopicId:s}):(0,n.Z)({},_e,{projectId:a,dateFilter:i,headerFilterParamsNew:o}),t&&(p=(0,n.Z)({},p,t)),p=JSON.parse(JSON.stringify(p)),e.prev=7,e.next=10,be(p);case 10:return d=e.sent,m=d.data.result,e.abrupt("return",m);case 15:e.prev=15,e.t0=e.catch(7),e.t0;case 18:case"end":return e.stop()}}),e,null,[[7,15]])})))).apply(this,arguments)}function ze(e){return Ge.apply(this,arguments)}function Ge(){return(Ge=(0,r.Z)(c().mark((function e(t){var a,r,i,o,s,l,u,p;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_.t.get(_.V.curProject).id,t&&(De.dateFilter.dateGroupType=t.collectCommentTimeDate?t.collectCommentTimeDate:t.dateGroupType),i=(r=De).dateFilter,o=r.headerFilterParamsNew,s=r.quickFilterTopicId,l=(0,n.Z)({},_e,{projectId:a,dateFilter:i,headerFilterParamsNew:o,quickFilterTopicId:s}),t&&(l=(0,n.Z)({},l,t,{projectId:a})),l=JSON.parse(JSON.stringify(l)),e.prev=6,e.next=9,Ee(l);case 9:return u=e.sent,p=u.data.result,e.abrupt("return",p);case 14:e.prev=14,e.t0=e.catch(6),e.t0;case 17:case"end":return e.stop()}}),e,null,[[6,14]])})))).apply(this,arguments)}function Be(e){return Ue.apply(this,arguments)}function Ue(){return(Ue=(0,r.Z)(c().mark((function e(t){var a,r,i,o,s,l,u,p,d;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_.t.get(_.V.curProject).id,r="allComment",t&&(De.dateFilter.dateGroupType=t.platformTimeDate?t.platformTimeDate:t.dateGroupType,r=t.platformComment?t.platformComment:t.messageType),o=(i=De).dateFilter,s=i.headerFilterParamsNew,l=i.quickFilterTopicId,u=(0,n.Z)({},_e,{projectId:a,dateFilter:o,headerFilterParamsNew:s,quickFilterTopicId:l}),t&&(u=(0,n.Z)({},u,t,{projectId:a,messageType:r})),u=JSON.parse(JSON.stringify(u)),e.prev=7,e.next=10,Oe(u);case 10:return p=e.sent,d=p.data.result,e.abrupt("return",d);case 15:e.prev=15,e.t0=e.catch(7),e.t0;case 18:case"end":return e.stop()}}),e,null,[[7,15]])})))).apply(this,arguments)}function Ve(e){return qe.apply(this,arguments)}function qe(){return(qe=(0,r.Z)(c().mark((function e(t){var a,r,i,o,s,l,u,p;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_.t.get(_.V.curProject).id,t&&(De.dateFilter.dateGroupType=t.dateGroupType?t.dateGroupType:De.dateFilter.dateGroupType),i=(r=De).dateFilter,o=r.headerFilterParamsNew,s=r.quickFilterTopicId,l=(0,n.Z)({},_e,{projectId:a,dateFilter:i,headerFilterParamsNew:o,quickFilterTopicId:s}),t&&(l=(0,n.Z)({},l,t,{projectId:a})),l=JSON.parse(JSON.stringify(l)),e.prev=6,e.next=9,xe(l);case 9:return u=e.sent,p=u.data.result,e.abrupt("return",p);case 14:e.prev=14,e.t0=e.catch(6),e.t0;case 17:case"end":return e.stop()}}),e,null,[[6,14]])})))).apply(this,arguments)}function Je(e){return We.apply(this,arguments)}function We(){return(We=(0,r.Z)(c().mark((function e(t){var a,r,i,o,s,l,u,p,d,m,f;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="1333",t&&(a=t.typeAnalysisData||t.analyseObject),r=_.t.get(_.V.curProject).id,De.dateFilter.dateGroupType=t?t.dateGroupType:De.dateFilter.dateGroupType,o=(i=De).dateFilter,s=i.headerFilterParamsNew,l=i.quickFilterTopicId,u=i.analysisModel,p=u[0].values[0].isSelectAll,d=(0,n.Z)({},_e,{projectId:r,dateFilter:o,headerFilterParamsNew:s,quickFilterTopicId:l}),t&&(d=(0,n.Z)({},d,t,{projectId:r,analyseObject:a})),d=JSON.parse(JSON.stringify(d)),e.prev=9,!p){e.next=16;break}return e.next=13,Ae(d);case 13:m=e.sent,e.next=19;break;case 16:return e.next=18,xe(d);case 18:m=e.sent;case 19:return f=m.data.result,e.abrupt("return",f);case 23:e.prev=23,e.t0=e.catch(9),e.t0;case 26:case"end":return e.stop()}}),e,null,[[9,23]])})))).apply(this,arguments)}function Ye(e){return He.apply(this,arguments)}function He(){return(He=(0,r.Z)(c().mark((function e(t){var a,r,i,o,s,l,u,p,d,m;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_.t.get(_.V.curProject).id,t&&(De.dateFilter.dateGroupType=t.dateGroupType?t.dateGroupType:De.dateFilter.dateGroupType),i=(r=De).dateFilter,o=r.headerFilterParamsNew,s=r.quickFilterTopicId,l=r.analysisModel,u=l[0].values[0].isSelectAll,p=u?(0,n.Z)({},_e,{projectId:a,dateFilter:i,headerFilterParamsNew:o,quickFilterTopicId:s}):(0,n.Z)({},_e,{projectId:a,dateFilter:i,headerFilterParamsNew:o}),t&&(p=(0,n.Z)({},p,t,{projectId:a})),p=JSON.parse(JSON.stringify(p)),e.prev=7,e.next=10,Pe(p);case 10:return d=e.sent,m=d.data.result,e.abrupt("return",m);case 15:e.prev=15,e.t0=e.catch(7),e.t0;case 18:case"end":return e.stop()}}),e,null,[[7,15]])})))).apply(this,arguments)}var Xe=a(2329),Qe=(a(47218),"COMMENT_OVERVIEW");const Ke=function(e){function t(t){var a;return(a=e.call(this,t)||this).fetchParams=function(){var e=(0,r.Z)(c().mark((function e(t){var n,r,i,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dateOptions,r=t.defaultDateType,e.prev=1,e.next=4,s={key:Qe,projectId:_.t.get(_.V.curProject).id},Te.h.post("/default/value/find",s);case 4:if(2e4!==(i=e.sent).data.code||!i.data.result){e.next=11;break}return o=Object.assign({},a.state.flavor,JSON.parse(i.data.result)),["collectLinkTimeDate","collectCommentTimeDate","platformTimeDate"].forEach((function(e){o[e]!==r&&(n.some((function(t){return t.value===o[e]}))||(o[e]=r||n[0].value));Re.set(e,o[e])})),a.setState({flavor:o}),Me.set(o),e.abrupt("return",o);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1);case 16:case"end":return e.stop()}var s}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),a._handleFilterReady=function(){var e=(0,r.Z)(c().mark((function e(t,n){var r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,ge.X)(t.dateFilter.numOfDays,!0),e.next=3,a.setState({filterChangeBool:!a.state.filterChangeBool,isSelectAll:t.analysisModel[0].values[0].isSelectAll,timeParams:r});case 3:return e.next=5,je({headerFilterParamsNew:t.headerFilterParamsNew,dateFilter:t.dateFilter,quickFilterTopicId:Number(t.analysisModel[0].values[0].id),analysisModel:t.analysisModel});case 5:return e.next=7,a.fetchParams(r);case 7:i=e.sent,a.fetchData(i);case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),a._handleFilterChange=function(){var e=(0,r.Z)(c().mark((function e(t,n,r){var i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({filterChangeBool:!a.state.filterChangeBool}),a.setState({headerFilterParamsNew:t.headerFilterParamsNew}),a.setState({isSelectAll:t.analysisModel[0].values[0].isSelectAll}),i=(0,ge.X)(t.dateFilter.numOfDays,!0),a.checkSelected(i),a.setState({headerFilterParamsNew:t.headerFilterParamsNew,isSelectAll:t.analysisModel[0].values[0].isSelectAll,timeParams:i}),e.next=8,je({headerFilterParamsNew:t.headerFilterParamsNew,dateFilter:t.dateFilter,quickFilterTopicId:Number(t.analysisModel[0].values[0].id),analysisModel:t.analysisModel});case 8:return e.next=10,a.fetchData();case 10:a.setState({filterChangeBool:!a.state.filterChangeBool});case 11:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),a._handleMsgClick=function(e,t){var a=De,n=a.dateFilter,r=a.headerFilterParamsNew,i=_.t.get(_.V.curProject).id,o={dateFilter:n,projectId:i,filterModel:{project:[i]},filterTip:null,headerFilterParamsNew:(0,ye.ZP)(r,(function(e){var t=e.find((function(e){return"DEFAULT"===e.id}));t?t.values.find((function(e){return"MESSAGE_TYPE"===e.id}))||t.values.push({id:"MESSAGE_TYPE",label:"\u6d88\u606f\u7c7b\u578b",values:["COMMENT_APPEND","MESSAGE_COMMENT"]}):e.push({id:"DEFAULT",values:[{id:"MESSAGE_TYPE",label:"\u6d88\u606f\u7c7b\u578b",values:["COMMENT_APPEND","MESSAGE_COMMENT"]}]})}))};if("\u5404\u54c1\u724c\u8bc4\u8bba\u6570\u91cf"===t){var l=e.barData,c=e.name,u=e.activeObjCommentType,p=l.find((function(e){return e.name===c})).type;o.headerFilterParamsNew=(0,ye.ZP)(s()(o.headerFilterParamsNew),(function(e){e.find((function(e){return"TOPIC"===e.id})).values[0].isSelectAll=!1,e.find((function(e){return"TOPIC"===e.id})).values[0].values=[p];var t=e.find((function(e){return"DEFAULT"===e.id}));if(t){var a={id:"EFFECTIVENESS_TYPE",values:"userfulComment"===u?["useful"]:["unUseful","useful"]};t.values.find((function(e){return"EFFECTIVENESS_TYPE"===e.id}))?t.values.find((function(e){return"EFFECTIVENESS_TYPE"===e.id})).values=[a]:t.values.push(a)}})),window.open("/inbox/commont?"+encodeURIComponent(JSON.stringify(o)))}if("\u5404\u5e73\u53f0\u8bc4\u8bba\u5206\u5e03\u548c\u8d70\u52bf"===t){o.headerFilterParamsNew=[{values:[{id:"MESSAGE_TYPE",values:["COMMENT_APPEND","MESSAGE_COMMENT"]},{id:"EFFECTIVENESS_TYPE",values:["unUseful","useful"]},{id:"SOURCE",values:["1"]}],id:"DEFAULT"}];var d=e.dataSource,m=e.commentType,f="";if("pie"===e.seriesType){f=e.name;var h=d.find((function(e){return e.name===f})).sourceId;o.headerFilterParamsNew=(0,ye.ZP)(s()(o.headerFilterParamsNew),(function(e){e[0].values[2].values=[h],"allComment"!==m&&(e[0].values[1].values=["useful"])})),window.open("/inbox/commont?"+encodeURIComponent(JSON.stringify(o)))}else{f=e.seriesName;var v=d[0].dataList.map((function(e){return e.time})),y=e.timeType,g=e.selectDate,T=d.find((function(e){return e.name===f})).sourceId;o.headerFilterParamsNew=(0,ye.ZP)(s()(o.headerFilterParamsNew),(function(e){e[0].values[2].values=[T],"allComment"!==m&&(e[0].values[1].values=["useful"])})),o.dateFilter=(0,Xe.X_)("line",o.dateFilter,g[0],v,y),window.open("/inbox/commont?"+encodeURIComponent(JSON.stringify(o)))}}if("\u8bc4\u8bba\u6570\u91cf"===t){e.data,e.name;var b=e.topicType,C=e.commentType,E=e.topicValueId;o.headerFilterParamsNew=(0,ye.ZP)(s()(o.headerFilterParamsNew),(function(e){var t=e.find((function(e){return"TOPIC"===e.id}));t&&(t.values.find((function(e){return e.id===b}))?t.values.find((function(e){return e.id===b})).values=[E]:t.values.push({id:b,values:[E]}));var a=e.find((function(e){return"DEFAULT"===e.id}));if(a){var n={id:"EFFECTIVENESS_TYPE",values:"valid"===C?["useful"]:["unUseful","useful"]};a.values.find((function(e){return"EFFECTIVENESS_TYPE"===e.id}))?a.values.find((function(e){return"EFFECTIVENESS_TYPE"===e.id})).values=[n]:a.values.push(n)}})),window.open("/inbox/commont?"+encodeURIComponent(JSON.stringify(o)))}},a.fetchSingleData=function(){var e=(0,r.Z)(c().mark((function e(t,n,r){var i,o,s,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(n);case 2:l=e.sent,a.setState({loading:(i={},i[r]=!0,i)}),a.setState(((o={})[r]=l,o)),a.setState({loading:(s={},s[r]=!1,s)});case 6:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),a.fetchData=function(e){a.fetchSingleData(Ie,e||{dateGroupType:Re.get("collectLinkTimeDate")},"LCollects"),a.fetchSingleData(ze,e||{dateGroupType:Re.get("collectCommentTimeDate")},"LComments"),a.fetchSingleData(Be,e||{dateGroupType:Re.get("platformTimeDate")},"Platforms"),a.fetchSingleData(Ve,e,"LBrandComments"),a.fetchSingleData(Je,e||{analyseObject:Re.get("analyseObject")},"LModelComments"),a.fetchSingleData(Ye,e,"ShopLinks")},a._handleDateChange=function(){var e=(0,r.Z)(c().mark((function e(t,n){var r,i,o,s,l;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("\u94fe\u63a5\u91c7\u96c6\u6570\u91cf"!==n){e.next=10;break}return Re.set("collectLinkTimeDate",t.dateGroupType),a.setState({loading:{LCollects:!0}}),e.next=5,Ie(t);case 5:r=e.sent,a.setState({LCollects:r}),a.setState({loading:{LCollects:!1}}),e.next=47;break;case 10:if("\u8bc4\u8bba\u91c7\u96c6\u60c5\u51b5"!==n){e.next=20;break}return Re.set("collectCommentTimeDate",t.dateGroupType),a.setState({loading:{LComments:!0}}),e.next=15,ze(t);case 15:i=e.sent,a.setState({LComments:i}),a.setState({loading:{LComments:!1}}),e.next=47;break;case 20:if("\u5404\u5e73\u53f0\u8bc4\u8bba\u5206\u5e03\u548c\u8d70\u52bf"!==n){e.next=30;break}return Re.set("platformTimeDate",t.dateGroupType),a.setState({loading:{Platforms:!0}}),e.next=25,Be(t);case 25:o=e.sent,a.setState({Platforms:o}),a.setState({loading:{Platforms:!1}}),e.next=47;break;case 30:if("\u5404\u54c1\u724c\u8bc4\u8bba\u6570\u91cf"!==n){e.next=39;break}return a.setState({loading:{LBrandComments:!0}}),e.next=34,Ve(t);case 34:s=e.sent,a.setState({LBrandComments:s}),a.setState({loading:{LBrandComments:!1}}),e.next=47;break;case 39:if("\u5404\u578b\u53f7\u8bc4\u8bba\u6570\u91cf"!==n){e.next=47;break}return Re.set("analyseObject",t.analyseObject),a.setState({loading:{LModelComments:!0}}),e.next=44,Je(t);case 44:l=e.sent,a.setState({LModelComments:l}),a.setState({loading:{LModelComments:!1}});case 47:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),a._handleFlavorChange=function(e){Me.set(e),Me.update()},a.state={filterChangeBool:!1,headerFilterParamsNew:[],isSelectAll:!1,timeParams:{},loading:{ShopLinks:!0,LCollects:!0,LComments:!0,Platforms:!0,LBrandComments:!0,LModelComments:!0},ShopLinks:[],LCollects:[],Platforms:[],LComments:[],LBrandComments:[],LModelComments:[],flavor:{platformComment:"allComment",platformTimeDate:"HOUR",collectLinkTimeDate:"HOUR",collectCommentTimeDate:"HOUR",brandComment:"allComment",brandTop:"TOP30",typeComment:"allComment",typeTopData:"TOP30",typeAnalysisData:"1333",shopTopData:"TOP30"}},a.event={onFilterReady:a._handleFilterReady,onFilterChange:a._handleFilterChange,onMsgClick:a._handleMsgClick,onDateChange:a._handleDateChange,onFlavorChange:a._handleFlavorChange},a}(0,i.Z)(t,e);var a=t.prototype;return a.checkSelected=function(e){["collectLinkTimeDate","collectCommentTimeDate","platformTimeDate"].forEach((function(t){Re.get(t)!==e.defaultDateType&&(e.dateOptions.some((function(e){return e.value===Re.get(t)}))||Re.set(t,e.defaultDateType))}))},a.render=function(){return u.createElement(ve,(0,n.Z)({},this.props,this.state,this.event))},t}(u.PureComponent)},61780:(e,t,a)=>{a.d(t,{N:()=>n});var n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAJKADAAQAAAABAAAAJAAAAAAqDuP8AAAEp0lEQVRYCaWWTWtkVRCGT7f5GiUmpjERCdjLoFkk8wt6IYiguNAGSYg7F/MT/AWujFtRV2YjqAtlFqO4mE3WyZAZiRAxAx1IAsksEslXf1hP931vV5/pe7ujBypVp+qtt9577s29XQi3W4XbwVN0K40GBMMMGISJ64OG59ZjMq8/q+bzPva9fqiPszBpPoswzvu94tiLVAJiT125GKt9KKZRN9AgZbTHgy+ur6+PnZ+fV+v1+kaz2XzSarVOMWJy1MAIb95z2DZdyqeJOADgDQEvmI2YjZqNnZ2dVW3wXyYgd4EBS0/SCwdccPoZmaJiUI+YSqUycX19/UWuij5Feuj9L6K8IC+GKxy/vLxc7zNvqBS9cJjBlXVSVup/b2NhxZOTkw9mZma+b3ckf0xJePi4GR4+aYbaSedZnS8VQuWtYqgsFkOh0HsnTk9PPy6VSj9bezMxmmQJa2hxT1nqltd9Lq6uro6vrKz8YANe6UBDePZPK3z5Sz389qgZnp2H0LARGPHW363w50ErLL5RDHfGRBfCxMTE3b29vW93dnYa4jGPoC7IbZTEYwhq29HR0Uezs7Pf2b69OJnPf6qHP2qdU1E+9m/OF8JnH470nNTx8fEnc3NzPxpWp4T3p9TSSXg+iWoLm5qaet8XuU2DxIAHA9avhEszNcdDChS1BJCnVhwdHV0WAM8zM+yKsQlXm9c4NEe+TesF+TkCFW295gt6gH0uK46xCRczxf9cayxIQLyu5Lmm/5kQr5+VUnpBAFgeWGg0GkeddOcv/9rDrhibcPXwJ1wpqRdETYXUX1xcPPICeM8Mu2JswpVyJzzat7di70l6YK1We+AF8NLjX3rQAgPWL8fVj6Cd6+3w3UlcrVYf3NzcPFWJN/C9d0dyRSEGjH9bwwGXeLI8qqQWcTJ9b/jCj25tbb23tLT0jSe57adje3v70+Xl5fvGcZMYb+y6mX9J2rb7EOtnBh/BF81eNpsxmzObPzw8/GqoL2kfEL1wJFxwws0MZuni08NRwOlQ5It8x2zSjO/Xq2avT09Plw8ODr7uMy83RQ+9cCRccMLNDH39mS0daUCSU+I28fvlJbMps5IZL0eusLy5uXnv6urqaa4KK4IBS0/SCwdccMKt30g9P9pSVQZQrOcIoG4jJ5dauVwe39jYeGdhYeHtycnJRfskzFo92IN7bL8SH+/u7v6+trb26/7+/pWleU5i4/nB9PykH1iJsFp7sZcgnZjusQRJaM+VJf0iZpCG6uFFlGIvBmz60wFSFkJY3ivuVLo17fEi05VKiLwXpVg9Eu/5Wlx1vASkkeWFqYanzilSF0Z1aphEyCuPF9bC7ooFAYIcz8LT7JdyurV5giQAQYrpl8FLnC4JIumvUgCJEQFeQvzp+F5hJcB7auyFwWu1YwlSUt4DIYgHkpMgenydPf0aHHtqMrA9S0RK9tuTyzN61acL0cA8r5l49aVEvihy5bT3oqhpL5z3EkJOsYbKC9+z1zAV5eO83yuOvXo1IPbUlYux2vc9IRU1UHt5n/ex6ng/2MdZmDSfRZgCLBiEietZAsSZW4/J1JTlb4sXT64IgfD/AvtkxvH04K2oAAAAAElFTkSuQmCC"},81408:(e,t,a)=>{a.d(t,{lQ:()=>r,v1:()=>i,dR:()=>o,$x:()=>s,$5:()=>l,gt:()=>c,R5:()=>u});var n=a(87462);a(39432);var r=function(e){var t=0;e.forEach((function(e){var a=e.slice(1).sort((function(e,t){return t-e})),n=parseFloat(a[0]);n>t&&(t=n)})),t=Math.ceil(t);for(var a=0;a<4;a++)t%4!==0&&t++;return 0===t&&(t=4),{intVal:t/4,maxVal:t}},i={SCENE_SEX:"user.gender",SCENE_AGE:"user.age",SCENE_USE_SCENE:"space",SCENE_USE:"usage",SCENE_BUY_DECISION:"buy_decision",SCENE_RELATION:"relation",SCENE_MY_ADVICE:"suggestion"},o=function(e){var t=e.oLineData,a=e.oBarData,r=e.alzOptions,i=e.alzName,o=t&&t.find((function(e){return e.name===i})),s=void 0,l=r.find((function(e){return e.name===i})).idKey+":"+i,c=a.nodes.find((function(e){return e.key===l})),u=c?c.total:0;return s=a.relations.reduce((function(e,t){var r=void 0;if(t.source===l?r="target":t.target===l&&(r="source"),r){var i=a.nodes.find((function(e){return e.key===t[r]})),o=0===u?0:t.total/u;i&&e.push((0,n.Z)({},i,{relTotal:t.total,aspectCount:u,messageCount:0,trustRate:o,upRate:0}))}return e}),[]),r.find((function(e){return"relation"===e.idKey}))&&(s=s.filter((function(e){return"relation"!==e.scene&&"user.age"!==e.scene&&"user.gender"!==e.scene}))),void 0===o&&(o="empty"),void 0===s&&(s="empty"),{analyzeLineData:o,analyzeBarData:s}},s={"\u6027\u522b\u5206\u5e03":"SCENE_SEX","\u6027\u522b":"SCENE_SEX","\u4f7f\u7528\u4eba\u7684\u6027\u522b":"SCENE_SEX","\u5e74\u9f84\u6bb5\u5206\u5e03":"SCENE_AGE","\u5e74\u9f84\u6bb5":"SCENE_AGE","\u4f7f\u7528\u4eba\u7684\u5e74\u9f84\u6bb5":"SCENE_AGE","\u5173\u7cfb":"SCENE_RELATION","\u89d2\u8272\u4e0e\u5173\u7cfb":"SCENE_RELATION","\u4f7f\u7528\u573a\u5408":"SCENE_USE_SCENE","\u7528\u9014":"SCENE_USE","\u8d2d\u4e70\u51b3\u7b56":"SCENE_BUY_DECISION","\u4ee3\u8a00\u4eba":"SCENE_ENDORSER"},l={SCENE_USE_SCENE:"\u4f7f\u7528\u573a\u5408",SCENE_USE:"\u7528\u9014",SCENE_BUY_DECISION:"\u8d2d\u4e70\u51b3\u7b56",relation:"\u5173\u7cfb","user.gender":"\u6027\u522b","user.age":"\u5e74\u9f84\u6bb5"},c=function(e,t,a,r,i){var o,l=e&&e.find((function(e){return"SCENE_ASPECT"===e.id})),c=e&&e.find((function(e){return"DEFAULT"===e.id}));return t.includes("\u6027\u522b")||t.includes("\u5e74\u9f84\u6bb5")||t.includes("\u5173\u7cfb")||t.includes("\u4f7f\u7528\u573a\u5408")||t.includes("\u7528\u9014")||t.includes("\u8d2d\u4e70\u51b3\u7b56")||t.includes("\u4ee3\u8a00\u4eba")?(o=[].concat(e.filter((function(e){return"SCENE_ASPECT"!==e.id&&"DEFAULT"!==e.id})).map((function(e){return(0,n.Z)({},e)})),[{id:"SCENE_ASPECT",isSelectAll:l&&l.isSelectAll?l.isSelectAll:null,values:l?[].concat(l.values.filter((function(e){return e.id!==s[t]})).map((function(e){return(0,n.Z)({},e)})),[{id:s[t],label:t,values:[a]}]):[{id:s[t],label:t,values:[a]}]},{id:"DEFAULT",isSelectAll:c&&c.isSelectAll?c.isSelectAll:null,values:c?[].concat(c.values.filter((function(e){return"MESSAGE_TYPE"!==e.id})).map((function(e){return(0,n.Z)({},e)})),[{id:"MESSAGE_TYPE",label:"\u6d88\u606f\u7c7b\u578b",values:r?["\u7535\u5546\u8ffd\u8bc4","\u7535\u5546\u8bc4\u8bba"]:["COMMENT_APPEND","MESSAGE_COMMENT"]}]):[{id:"MESSAGE_TYPE",label:"\u6d88\u606f\u7c7b\u578b",values:r?["\u7535\u5546\u8ffd\u8bc4","\u7535\u5546\u8bc4\u8bba"]:["COMMENT_APPEND","MESSAGE_COMMENT"]}]}]),i&&o.find((function(e){return"SCENE_ASPECT"===e.id})).values.push(i),o):t?e:o=[].concat(e.filter((function(e){return"DEFAULT"!==e.id})).map((function(e){return(0,n.Z)({},e)})),[{id:"DEFAULT",isSelectAll:c&&c.isSelectAll?c.isSelectAll:null,values:c?[].concat(c.values.filter((function(e){return"MESSAGE_TYPE"!==e.id})).map((function(e){return(0,n.Z)({},e)})),[{id:"MESSAGE_TYPE",label:"\u6d88\u606f\u7c7b\u578b",values:r?["\u7535\u5546\u8ffd\u8bc4","\u7535\u5546\u8bc4\u8bba"]:["COMMENT_APPEND","MESSAGE_COMMENT"]}]):[{id:"MESSAGE_TYPE",label:"\u6d88\u606f\u7c7b\u578b",values:r?["\u7535\u5546\u8ffd\u8bc4","\u7535\u5546\u8bc4\u8bba"]:["COMMENT_APPEND","MESSAGE_COMMENT"]}]}])},u=function(e,t,a,r,i,o){var l=e&&e.find((function(e){return"SCENE_ASPECT"===e.id})),c=e&&e.find((function(e){return"DEFAULT"===e.id})),u=e&&e.find((function(e){return"TOPIC"===e.id}));return t.includes("\u6027\u522b")||t.includes("\u5e74\u9f84\u6bb5")||t.includes("\u5173\u7cfb")||t.includes("\u4f7f\u7528\u573a\u5408")||t.includes("\u7528\u9014")||t.includes("\u8d2d\u4e70\u51b3\u7b56")||t.includes("\u4ee3\u8a00\u4eba")?[].concat(e.filter((function(e){return"SCENE_ASPECT"!==e.id&&"DEFAULT"!==e.id&&"TOPIC"!==e.id})).map((function(e){return(0,n.Z)({},e)})),[{id:"SCENE_ASPECT",isSelectAll:l&&l.isSelectAll?l.isSelectAll:null,values:l?[].concat(l.values.filter((function(e){return e.id!==s[t]})).map((function(e){return(0,n.Z)({},e)})),[{id:s[t],label:t,values:[a]}]):[{id:s[t],label:t,values:[a]}]},{id:"DEFAULT",isSelectAll:c&&c.isSelectAll?c.isSelectAll:null,values:c?[].concat(c.values.filter((function(e){return"MESSAGE_TYPE"!==e.id})).map((function(e){return(0,n.Z)({},e)})),[{id:"MESSAGE_TYPE",label:"\u6d88\u606f\u7c7b\u578b",values:o?["\u7535\u5546\u8ffd\u8bc4","\u7535\u5546\u8bc4\u8bba"]:["COMMENT_APPEND","MESSAGE_COMMENT"]}]):[{id:"MESSAGE_TYPE",label:"\u6d88\u606f\u7c7b\u578b",values:o?["\u7535\u5546\u8ffd\u8bc4","\u7535\u5546\u8bc4\u8bba"]:["COMMENT_APPEND","MESSAGE_COMMENT"]}]},{id:"TOPIC",isSelectAll:u&&u.isSelectAll?u.isSelectAll:null,values:u?[].concat(u.values.filter((function(e){return e.id!==i.id})).map((function(e){return(0,n.Z)({},e)})),[{id:i.id,label:i.label,values:o?[i.name]:[r]}]):[{id:i.id,label:i.label,values:o?[i.name]:[r]}]}]):t?e:[].concat(e.filter((function(e){return"DEFAULT"!==e.id})).map((function(e){return(0,n.Z)({},e)})),[{id:"DEFAULT",isSelectAll:c&&c.isSelectAll?c.isSelectAll:null,values:c?[].concat(c.values.filter((function(e){return"MESSAGE_TYPE"!==e.id})).map((function(e){return(0,n.Z)({},e)})),[{id:"MESSAGE_TYPE",label:"\u6d88\u606f\u7c7b\u578b",values:o?["\u7535\u5546\u8ffd\u8bc4","\u7535\u5546\u8bc4\u8bba"]:["COMMENT_APPEND","MESSAGE_COMMENT"]}]):[{id:"MESSAGE_TYPE",label:"\u6d88\u606f\u7c7b\u578b",values:o?["\u7535\u5546\u8ffd\u8bc4","\u7535\u5546\u8bc4\u8bba"]:["COMMENT_APPEND","MESSAGE_COMMENT"]}]}])}},4609:(e,t,a)=>{e.exports=a.p+"img/ca022b95fd75dfac3fc4.png"},39184:(e,t,a)=>{e.exports=a.p+"font/b5be84cc581714d650d6.svg"},77526:(e,t,a)=>{e.exports=a.p+"font/3ca9da800eaefaad1349.svg"},79916:(e,t,a)=>{e.exports=a.p+"font/64b2a02785532addb983.svg"},17774:(e,t,a)=>{e.exports=a.p+"font/9e16a0830f89b248712e.svg"}}]);