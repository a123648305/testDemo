"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[1993],{11993:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var a=n(87462),i=n(97326),s=n(94578),r=n(67294),o=n(92360),l=n(5133),c=n(29383),u=n(49722),m=n(43036),d=n(12518),p=n(47508),h=function(e){function t(){var t;return(t=e.call(this)||this).changeTime=function(e){t.setState({dateRange:[e[0],e[1]]})},t.sortTime=function(e){var n="",a=t.state.selTypes.map((function(e){return e.id})),i={name:t.state.name,dateFilter:{from:t.state.param_startTime,to:t.state.param_endTime},status:a};e.target.className.indexOf("ascending")>0?n="ascending":e.target.className.indexOf("descending")>0&&(n="descending"),t.setState({sort:n},(function(){t.getFileList(i)}))},t.onPageSizeChange=function(e){t.setState({pageSize:e,pageIndex:1},(function(){return t.getFileList()}))},t.onNameSearch=function(){t.getFileList({name:t.state.name})},t.onNameChange=function(e){t.setState({name:e})},t.select=function(e){t.setState({selection:e})},t.batchDownload=function(){var e=t.state.selection,n=[];e.filter((function(e){return"EXPORTED"===e.status})).forEach((function(e){n.push({id:e.id})})),n.length?1===n.length?t.download(n[0].id):u.h.post("/data/download/batch",JSON.stringify(n)).then((function(e){if(2e4===e.data.code){var t=document.createElement("a");t.href=e.data.result.url,t.click()}})):l.Z.warning("\u8bf7\u9009\u4e2d\u53ef\u4e0b\u8f7d\u7684\u6587\u4ef6")},t.state={name:"",selection:[],timeVal:null,dateRange:[null,null],totalNumber:0,currentPage:1,pageSize:20,selTypes:[],types:[{id:"UNEXPORTED",name:"\u672a\u751f\u6210"},{id:"EXPORTING",name:"\u751f\u6210\u4e2d"},{id:"EXPORTED",name:"\u5df2\u751f\u6210"},{id:"EXPIRED",name:"\u5df2\u8fc7\u671f"},{id:"FAILED",name:"\u5931\u8d25"}],connectDialogVisible:!1,form:{name:"",tagValue:[{tagValue:""}]},columns:[{type:"selection"},{label:"\u6587\u4ef6\u540d",minWidth:360,prop:"name"},{label:"\u72b6\u6001",minWidth:180,render:function(e){return"UNEXPORTED"===e.status?r.createElement(m.Z,{overlay:"\u524d\u65b9\u8fd8\u6709"+e.queueIndex+"\u4e2a\u4efb\u52a1\u7b49\u5f85\u751f\u6210",placement:"top"},r.createElement("span",null,t.getStatus(e.status,e.expiredAt))):r.createElement("span",null,t.getStatus(e.status,e.expiredAt))}},{label:"\u521b\u5efa\u65f6\u95f4",minWidth:180,sortable:!0,render:function(e){return r.createElement("span",null,e.createdAt)}},{label:"\u8fc7\u671f\u65f6\u95f4",minWidth:180,render:function(e){return r.createElement("span",null,e.expiredAt)}},{label:"\u64cd\u4f5c",width:100,render:function(e){return r.createElement("span",{className:"operation_columns",onClick:t.download.bind((0,i.Z)(t),e.id)},"\u4e0b\u8f7d")}}],copyValues:[],tagValues:[{tagValue:""}],selId:null,sort:"descending"},t}(0,s.Z)(t,e);var n=t.prototype;return n.download=function(e){u.h.post("/data/download",{id:e}).then((function(e){if(2e4===e.data.code){var t=document.createElement("a");t.href=e.data.result.url,t.click()}}))},n.getStatus=function(e){switch(e){case"UNEXPORTED":return"\u672a\u751f\u6210";case"EXPORTING":return"\u751f\u6210\u4e2d";case"EXPORTED":return"\u5df2\u751f\u6210";case"EXPIRED":return"\u5df2\u8fc7\u671f";default:return"\u751f\u6210\u5931\u8d25"}},n.getFileList=function(e){var t=this;u.h.post("/data/list",(0,a.Z)({pageSize:this.state.pageSize,pageIndex:this.state.currentPage,sort:this.state.sort},e)).then((function(e){t.setState({tags:e.data.result.exportDataVOList,totalNumber:e.data.result.totalNumber,pageSize:e.data.result.pageSize,currentPage:e.data.result.currentPage})}))},n.enter=function(e){13===e.keyCode&&this.onNameSearch()},n.selStatus=function(e){var t=this;if(null!==e&&e instanceof Array&&0!==e.size){var n=e.map((function(e){return e.id}));this.setState({selTypes:e},(function(){t.getFileList({status:n,name:t.state.name})}))}},n.formatterTime=function(){var e=this.state.timeVal,t={from:null,to:null};return e&&(t.from=new Date(e[0]).getFullYear()+"/"+(new Date(e[0]).getMonth()+1>9?new Date(e[0]).getMonth()+1:"0"+(new Date(e[0]).getMonth()+1))+"/"+(new Date(e[0]).getDate()>9?new Date(e[0]).getDate():"0"+new Date(e[0]).getDate()),t.to=new Date(e[1]).getFullYear()+"/"+(new Date(e[1]).getMonth()+1>9?new Date(e[1]).getMonth()+1:"0"+(new Date(e[1]).getMonth()+1))+"/"+(new Date(e[1]).getDate()>9?new Date(e[1]).getDate():"0"+new Date(e[1]).getDate())),t},n.getPageTable=function(e){var t=this,n={name:this.state.name,dateFilter:this.formatterTime()};this.setState({currentPage:e,tags:[]},(function(){return t.getFileList(n)}))},n.componentDidMount=function(){this.getFileList()},n.componentDidUpdate=function(){var e=this,t=document.getElementsByClassName("sort-caret");Array.prototype.slice.call(t).map((function(t){return t.onclick=e.sortTime}))},n.render=function(){var e=this,t=this.state.timeVal;return r.createElement("div",null,r.createElement(d.Z,{title:"\u5bfc\u51fa\u8bb0\u5f55"}),r.createElement("div",{className:"download"},r.createElement("div",{className:"filter"},r.createElement("div",{className:"selWrap"},r.createElement("div",{className:"topic"},r.createElement("span",null,"\u6587\u4ef6\u540d"),r.createElement(o.Input,{icon:"search",onChange:this.onNameChange,onIconClick:this.onNameSearch,onKeyDown:this.enter.bind(this)})),r.createElement("div",{className:"source"},r.createElement("span",{style:{marginLeft:"20px"}},"\u72b6\u6001"),r.createElement(p.Z,{noSelTip:"\u5168\u90e8",value:this.state.selTypes,options:this.state.types,onChange:this.selStatus.bind(this)})),r.createElement("div",null,r.createElement("div",{className:"block"},r.createElement("span",{className:"demonstration",style:{margin:"0 20px"}},"\u521b\u5efa\u65f6\u95f4"),r.createElement(o.DateRangePicker,{value:t,placeholder:"\u9009\u62e9\u65e5\u671f\u8303\u56f4",align:"left",format:"yyyy/MM/dd",ref:function(t){return e.daterangepicker2=t},disabledDate:function(e){return e.getTime()>Date.now()+864e5-864e5},onChange:function(n){JSON.stringify(n)!==JSON.stringify(t)&&e.setState({timeVal:n},(function(t){return e.getPageTable(1)}))},shortcuts:[{text:"\u6700\u8fd1\u4e00\u5468",onClick:function(){var t=new Date,n=new Date;n.setTime(n.getTime()-6048e5),e.setState({timeVal:[n,t]},(function(t){return e.getPageTable(1)})),e.daterangepicker2.togglePickerVisible()}},{text:"\u6700\u8fd1\u4e00\u4e2a\u6708",onClick:function(){var t=new Date,n=new Date;n.setTime(n.getTime()-2592e6),e.setState({timeVal:[n,t]},(function(t){return e.getPageTable(1)})),e.daterangepicker2.togglePickerVisible()}},{text:"\u6700\u8fd1\u4e09\u4e2a\u6708",onClick:function(){var t=new Date,n=new Date;n.setTime(n.getTime()-7776e6),e.setState({timeVal:[n,t]},(function(t){return e.getPageTable(1)})),e.daterangepicker2.togglePickerVisible()}}]}))),r.createElement("div",{style:{marginLeft:"10px"}},r.createElement(o.Button,{onClick:function(){return e.batchDownload()}},"\u6279\u91cf\u4e0b\u8f7d")))),r.createElement("div",{className:"teamTable"},r.createElement(c.Z,{columns:this.state.columns,data:this.state.tags?this.state.tags:[],total:this.state.totalNumber,pageSize:this.state.pageSize,currentPage:this.state.currentPage,onPage:this.getPageTable.bind(this),onPageSizeChange:this.onPageSizeChange,onSelectChange:function(t){return e.select(t)},onSelectAll:function(t){return e.select(t)}}))))},t}(r.Component)},47508:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(87462),i=n(94578),s=n(67294),r=function(e){function t(){var t;return(t=e.call(this)||this).setShowSelFalse=function(){t.state.showSel&&t.setState({showSel:!1})},t.state={options:[{name:"",id:1,sel:""}],sel:[{name:""},{name:""}],value:"",showSel:!1},t}(0,i.Z)(t,e);var n=t.prototype;return n.selItem=function(e,t){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();var n=this.state.options;n[t].sel=!n[t].sel,this.setState({options:n}),this.onChange()},n.onChange=function(){var e=[];JSON.parse(JSON.stringify(this.state.options)).forEach((function(t){t.sel&&(delete t.sel,e.push(t))})),this.props.onChange(e)},n.changeShow=function(e){var t=this;this.state.showSel&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()),setTimeout((function(){t.setState({showSel:!t.state.showSel})}),0)},n.componentWillReceiveProps=function(e,t){if(e.options||e.value){var n=JSON.parse(JSON.stringify(e.options)),a=JSON.parse(JSON.stringify(e.value));n.map((function(e){return a.forEach((function(t){e.id===t.id&&(e.sel=!0)})),e})),this.setState({options:n,value:a})}},n.componentDidMount=function(){var e=this;this.setState({options:this.props.options,value:this.props.value?this.props.value:[]},(function(){e.state.options.map((function(t){return e.state.value.forEach((function(e){t.id===e.id&&(t.sel=!0)})),t}))})),window.addEventListener("click",this.setShowSelFalse)},n.componentWillUnmount=function(){window.removeEventListener("click",this.setShowSelFalse)},n.render=function(){var e=this;return s.createElement("div",{className:"multiSelect",onClick:function(t){return e.changeShow(t)}},s.createElement("div",{className:"infor"},s.createElement("div",{className:"infor-content"},this.props.title&&s.createElement("a",null,this.props.title,"\uff1a"),function(){var t=[];return e.state.options.forEach((function(e,n){e.sel&&t.push((0,a.Z)({},e,{index:n}))})),t.length>0?t.map((function(t,n){return s.createElement("span",{className:t.disable?"tags disable":"tags",key:n,onClick:function(n){return e.selItem(n,t.index)}},t.name)})):s.createElement("a",null,e.props.noSelTip&&e.props.noSelTip)}(),s.createElement("i",{className:"el-icon-arrow-down",style:{transform:this.state.showSel?"rotate(-180deg)":"",top:this.state.showSel?"8px":""}}))),s.createElement("div",{className:"selItem",onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},style:{display:this.state.showSel?"block":"none"}},s.createElement("ul",null,this.state.options.length>0?this.state.options.map((function(t,n){return s.createElement("li",{className:(t.sel?"sel":"")+(t.disable?" disable":""),key:n,onClick:function(t){return e.selItem(t,n)}},s.createElement("span",null,t.name),s.createElement("i",{className:"cem-icon cem-icon-zhengque"}))})):s.createElement("div",{className:"noData"},"\u65e0\u6570\u636e"))))},t}(s.Component)},12518:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(94578),i=n(67294),s=n(45697),r=n.n(s),o=n(61409),l=n(92360),c=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props.title;e!==n.length-1&&o.mW.go(e-n.length+1)},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.rightContent;return i.createElement("div",{className:"secondary-header"},n instanceof Array?i.createElement(l.Breadcrumb,{className:"breadcrumb-style",separator:""},n.map((function(t,n){return i.createElement(l.Breadcrumb.Item,{key:n},i.createElement("span",{onClick:function(){return e._handleBreadcrumbClick(n)}},t))}))):i.createElement("div",{className:"normal-title"},n),a&&a)},t}(i.Component);c.propTypes={title:r().oneOfType([r().string,r().array]).isRequired,rightContent:r().node};const u=c}}]);