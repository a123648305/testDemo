"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[4757],{92044:(e,t,n)=>{n.d(t,{Q:()=>a});var a={COMMENT:"OPINION_MSG_COMMENT",SELF:"OPINION_MSG_SELF",SERVICE:"OPINION_MSG_SERVICE"}},34757:(e,t,n)=>{n.r(t),n.d(t,{default:()=>te});var a=n(63366),r=n(87462),i=n(94578),o=n(67294),l=n(55609),c=(n(53294),n(56697)),s=(n(9405),n(89552)),u=(n(29809),n(97538)),p=(n(1025),n(65400)),m=(n(62642),n(94704)),d=n(96518),f=n(5966),h=n(86615),y=n(31199),g=n(41919),v=n(5133),C=n(30381),S=n.n(C),k=n(43036),D=n(92360),E=n(35239),T=(n(7940),n(31059)),_=(n(62713),n(14321)),N=n(72156),V=_.default.RangePicker;const F=function(e){function t(t){var n;return(n=e.call(this,t)||this).formatStr=function(){return n.state.isShowTime?"YYYY/MM/DD HH:mm:ss":"YYYY/MM/DD"},n.formatStrVal=function(){return n.state.isShowTime?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD"},n.disabledDate=function(e){return e&&e>S()().endOf("day")},n.onDateChange=function(e,t){n.setState({date:t.every((function(e){return""!==e}))?t:void 0})},n.handleCheckboxChange=function(e){var t=n.state.date,a=e.target.checked&&t&&t[0]&&!N.Sz.test(t[0])?t[0]+" 00:00:00":void 0,r=e.target.checked&&t&&t[1]&&!N.Sz.test(t[1])?t[1]+" 23:59:59":void 0;n.setState({isShowTime:e.target.checked}),a&&r&&n.setState({date:[a,r]})},n.state={isShowTime:t.isShowTime||!1,date:t.defaultDate||void 0},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){var t=e.defaultDate,n=this.props.defaultDate;JSON.stringify(t)!==JSON.stringify(n)&&n&&this.setState({date:n,isShowTime:N.Sz.test(n[0])&&N.Sz.test(n[1])})},n.getCurrDate=function(){var e=this.state.date;if(e&&e.length){var t=[S()(e[0]).format(this.formatStrVal()),S()(e[1]).format(this.formatStrVal())],n=(0,N.p6)(2,t,this.formatStrVal()),a=(0,N.vv)(t,this.formatStrVal());return{from:this.state.isShowTime?t[0]:t[0]+" 00:00:00",to:this.state.isShowTime?t[1]:t[1]+" 23:59:59",quickChoice:n,dateGroupType:"DAY",numOfDays:a,remoteName:"cTime",currSelector:1}}},n.render=function(){var e=this,t=this.state,n=t.date,a=t.isShowTime,r=this.props.className;return o.createElement("div",{className:"time_range_picker_wrapper "+r,style:{width:a?450:562}},o.createElement(V,{getPopupContainer:function(e){return e.parentNode},className:"filter_time_picker",disabledDate:this.disabledDate,format:this.formatStr(),showTime:a,onChange:this.onDateChange,value:n&&n[0]&&n[1]&&n&&n.length?[S()(n[0],this.formatStr()),S()(n[1],this.formatStr())]:null,dropdownClassName:"filter_time_picker_content_wrap",open:!0}),o.createElement("div",{className:"detail-time-select"},o.createElement(T.default,{checked:a,onChange:function(t){return e.handleCheckboxChange(t)}},"\u9009\u62e9\u65f6\u95f4")))},t}(o.PureComponent);var M=n(97189),Y=n(45697),w=n.n(Y),O=n(64396),P=["loading"],q=O.Z.opinion.timeScreening,R=function(e){function t(t){var n;return(n=e.call(this,t)||this)._resetStyle=function(){setTimeout((function(){n.dateContentRef&&(n.dateContentRef.style.display="date"!==n.state.show?"none":"block",n.dateContentRef.style.right="-1px",n.dateContentRef.style.top="30px")}),0)},n.handleClickQuickTime=function(e){n.setState({quickTime:N.A$[e]});var t=n.props,a=t.staredQuickTimeChoice,i=t.type,o=t.changeFilter,l=n.state.formatStr,c=(0,N.B9)(e,l);n.props.save({selectedQuickTimeChoice:e,selectedDateRange:c});var s={module:i,currSelector:0,selectedQuickTimeChoice:e,staredQuickTimeChoice:a,value:[]};n.props.setDefaultValue({key:"default-time-"+i,projectId:E.t.get(E.V.curProject).id,value:JSON.stringify(s)}),c.length>0?n.setState({params:null,show:null},(function(){var e;setTimeout((function(){n.props.onChange(n.getCurrDate())}),0);var t=E.t.getWidthProject(E.V.messageDateFilter);E.t.setWidthProject(E.V.messageDateFilter,(0,r.Z)({},t,((e={})[n.props.type]=n.getCurrDate(),e))),o("date"),n._resetStyle(),n.props.save({dateFilter:n.getCurrDate()})})):v.Z.error("\u8bf7\u9009\u62e9\u65f6\u95f4\u8303\u56f4")},n.getCurrDate=function(){var e=n.state,t=e.params,a=e.formatStr,r=n.props,i=r.selectedDateRange,o=r.selectedQuickTimeChoice,l=(0,N.vv)(i,a);return{from:i[0],to:i[1],quickChoice:t&&t.quickChoice.indexOf("-")>-1?t.quickChoice:N.A$[o],dateGroupType:"DAY",numOfDays:l,remoteName:"cTime",currSelector:0}},n.clickRangeConfirmBtn=function(){var e=n.props,t=e.staredQuickTimeChoice,a=e.dateFilter,i=t>-1?a:E.t.getWidthProject(E.V.messageDateFilter)&&E.t.getWidthProject(E.V.messageDateFilter)[n.props.type]?E.t.getWidthProject(E.V.messageDateFilter)[n.props.type]:void 0;if(i&&(-1===i.quickChoice.indexOf("-")?n.setState({quickTime:i.quickChoice}):n.setState({quickTime:""})),n.rangeDatePicker.getCurrDate()){var o=[n.rangeDatePicker.getCurrDate().from,n.rangeDatePicker.getCurrDate().to];n.props.save({selectedDateRange:o,selectedQuickTimeChoice:n.rangeDatePicker.getCurrDate().quickChoice}),o.length>0&&n.setState({params:null,show:null,quickTime:i?n.rangeDatePicker.state.isShowTime||!n.rangeDatePicker.state.isShowTime&&n.rangeDatePicker.getCurrDate().from.split(" ")[0]!==i.from||!n.rangeDatePicker.state.isShowTime&&n.rangeDatePicker.getCurrDate().to.split(" ")[0]!==i.to?"":i.quickChoice:""},(function(){var e;n.props.save({dateFilter:n.rangeDatePicker.getCurrDate()}),setTimeout((function(){n.props.onChange(n.rangeDatePicker.getCurrDate())}),0);var t=E.t.getWidthProject(E.V.messageDateFilter);E.t.setWidthProject(E.V.messageDateFilter,(0,r.Z)({},t,((e={})[n.props.type]=n.rangeDatePicker.getCurrDate(),e))),n.props.changeFilter("date"),n._resetStyle()}))}else v.Z.error("\u8bf7\u9009\u62e9\u65f6\u95f4\u8303\u56f4")},n.clickStarIcon=function(e,t){e.stopPropagation();var a=n.props.staredQuickTimeChoice,r=n.props,i=r.selectedQuickTimeChoice,o=r.type;if(a!==t){if(-1!==a){var l=document.querySelectorAll(".left_time ul li")[a].children[1];(0,M.removeClass)(l,"star"),l.style.display="none"}a=t,(0,M.addClass)(e.target.parentNode,"star")}else a=-1,(0,M.removeClass)(e.target.parentNode,"star");n.setState({staredQuickTimeChoice:a}),n.props.save({staredQuickTimeChoice:a});var c={module:o,currSelector:0,selectedQuickTimeChoice:i,staredQuickTimeChoice:a,value:[]};n.props.setDefaultValue({key:"default-time-"+o,projectId:E.t.get(E.V.curProject).id,value:JSON.stringify(c)})},n.state={show:t.show,currSelector:0,params:t.params,formatStr:t.useHourSelect?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD",quickTime:t.quickTime},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.dateContentRef&&(this.dateContentRef.style.display="block",this.dateContentRef.style.right="9999px",this.dateContentRef.style.top="-9999px")},n.componentDidUpdate=function(e,t){var n=e.quickTime,a=e.show,r=this.props,i=r.quickTime,o=r.show;JSON.stringify(n)!==JSON.stringify(i)&&this.setState({quickTime:i}),JSON.stringify(a)!==JSON.stringify(o)&&this._resetStyle()},n.componentWillUnmount=function(){},t.getDerivedStateFromProps=function(e,t){return e.show!==t.show?{show:e.show}:JSON.stringify(e.params)!==JSON.stringify(t.params)?{params:e.params}:null},n.fetchDefaultValue=function(){var e=this.props.type,t=this.state,n=t.params,a=t.formatStr;this.props.getDefaultValue({key:"default-time-"+e,params:n,formatStr:a,defaultValue:E.t.getWidthProject(E.V.messageDateFilter)&&E.t.getWidthProject(E.V.messageDateFilter)[e]||void 0,projectId:E.t.get(E.V.curProject).id})},n.render=function(){var e=this,t=this.state,n=t.show,a=t.quickTime,r=this.props,i=r.selectedQuickTimeChoice,l=r.staredQuickTimeChoice,c=r.save,s=r.changeFilter,u=r.dateFilter;return o.createElement("div",{className:"filter_date_picker_wrapper "+("date"!==n?"":"active"),onClick:function(e){e.stopPropagation()}},o.createElement("div",{className:"filter_date_trigger",onClick:function(){s("date"),e._resetStyle()}},o.createElement("span",{className:"filter_date_time"},o.createElement("i",{className:"icon-cem_time-controller"}),o.createElement("span",{style:{marginLeft:8,verticalAlign:"top"}},a||(u?u.quickChoice.indexOf("-")>-1?S()(u.quickChoice.split("-")[0]).format(N.Sz.test(u.quickChoice.split("-")[0].replace(/\./,"-").trim())?"YYYY/MM/DD HH:mm:ss":"YYYY/MM/DD")+"~"+S()(u.quickChoice.split("-")[1]).format(N.Sz.test(u.quickChoice.split("-")[1].replace(/\./,"-").trim())?"YYYY/MM/DD HH:mm:ss":"YYYY/MM/DD"):u.quickChoice:"")))),o.createElement("div",{style:{marginTop:8,color:"#8C8C8C",fontSize:12}},u?u.currSelector?o.createElement("div",null,S()(u.from).format("YYYY/MM/DD  HH:mm:ss")," ~"," ",S()(u.to).format("YYYY/MM/DD  HH:mm:ss")):o.createElement("div",null,S()(u.from).format("YYYY/MM/DD HH:mm:ss")," ~"," ",S()(u.to).endOf("day").format("YYYY/MM/DD HH:mm:ss")):""),o.createElement("div",{className:"time_picker_wrap",ref:function(t){return e.dateContentRef=t}},o.createElement("div",{className:"time_picker_content"},o.createElement("div",{className:"right_picker"},u?o.createElement(F,{ref:function(t){return e.rangeDatePicker=t},defaultDate:u.quickChoice.indexOf("-")>-1?[u.quickChoice.split("-")[0].replace(/\./,"-").trim(),u.quickChoice.split("-")[1].replace(/\./,"-").trim()]:[u.from,u.to],currSelector:1,save:c,isShowTime:u.quickChoice.indexOf("-")>-1&&N.Sz.test(u.quickChoice.split("-")[0].replace(/\./,"-").trim())&&N.Sz.test(u.quickChoice.split("-")[1].replace(/\./,"-").trim())}):null),o.createElement("div",{className:"left_time"},o.createElement("ul",{className:"quick_date_wrap"},N.A$.map((function(t,n){return o.createElement(o.Fragment,null,o.createElement("li",{key:n,onClick:function(){return e.handleClickQuickTime(n)},className:N.ld.includes(t)?"left_li":"right_li"},o.createElement("span",{className:i===n?"active":""},t),o.createElement(k.Z,{className:"time_picker_star_tooltip",placement:"top",overlay:l===n?"\u53d6\u6d88\u9ed8\u8ba4":"\u8bbe\u4e3a\u9ed8\u8ba4",mouseEnterDelay:.6},o.createElement("span",{className:l===n?"star":"",onClick:function(t){return e.clickStarIcon(t,n)}},o.createElement("i",{className:"icon-cem icon-cem_star"})))))}))))),o.createElement("div",{className:"time_picker_footer"},o.createElement("div",null),o.createElement("div",{style:{display:"flex"}},o.createElement(D.Button,{type:"default",onClick:function(){s("date"),e._resetStyle()}},"\u53d6\u6d88"),o.createElement(D.Button,{type:"primary",onClick:this.clickRangeConfirmBtn},"\u786e\u5b9a")))))},t}(o.PureComponent);const Z=(0,l.connect)((function(e){e.loading;var t=(0,a.Z)(e,P);return(0,r.Z)({},t[q])}),(function(e){return{save:function(t){return e({type:q+"/save",payload:t})},getDefaultValue:function(t){return e({type:q+"/getDefaultValue",payload:t})},setDefaultValue:function(t){return e({type:q+"/setDefaultValue",payload:t})},clean:function(t){return e({type:q+"/clean",payload:t})},cleanQuickTime:function(t){return e({type:q+"/cleanQuickTime",payload:t})}}}),null,{withRef:!0})(R);R.propTypes={show:w().bool,changeFilter:w().func,onChange:w().func,params:w().object};n(35797);var b=n(64749),A=n(60496),I=[{title:"\u6a21\u7cca\u641c\u7d22",value:"FUZZY_SEARCH"},{title:"\u7cbe\u786e\u641c\u7d22",value:"PRECISE_SEARCH"}],Q=function(e){function t(t){var n;return(n=e.call(this,t)||this).inputChange=function(e){n.setState({inputVal:e.target.value})},n.keywordChange=function(e){var t=n.state,a=t.inputVal,i=t.inputValMap,o=t.searchVal;"keydown"===e.type&&32===e.keyCode&&a.trim()&&(i.length<5?i.find((function(e){return e.trim()===a.trim()}))||(i.push(a.trim()),n.setState((0,r.Z)({},o,{inputValMap:i,inputVal:""}),(function(e){return n.onChange(!1)}))):v.Z.warning("\u6700\u591a\u641c\u7d225\u4e2a\u5173\u952e\u8bcd\uff0c\u8d85\u8fc7\u7684\u5173\u952e\u8bcd\u4e0d\u641c\u7d22")),"keydown"===e.type&&13===e.keyCode&&a.trim()&&(i.length<5?i.find((function(e){return e.trim()===a.trim()}))||(i.push(a.trim()),n.setState((0,r.Z)({},o,{inputValMap:i,inputVal:""}),(function(e){return n.onChange(!0)}))):v.Z.warning("\u6700\u591a\u641c\u7d225\u4e2a\u5173\u952e\u8bcd\uff0c\u8d85\u8fc7\u7684\u5173\u952e\u8bcd\u4e0d\u641c\u7d22"))},n.delKeyWords=function(e){var t=n.state,a=t.inputValMap,r=t.searchVal;a.splice(e,1),n.setState({inputValMap:a,searchVal:r},(function(e){return n.onChange(!0)}))},n.onChange=function(e){n.props.onChange&&n.props.onChange(n.state.inputValMap,n.state.searchVal,e)},n.onSearchChange=function(e){n.setState({searchVal:e},(function(){n.state.inputValMap&&n.state.inputValMap.length&&n.onChange(!0)}))},n.handleOnClose=function(){var e=n.state.searchVal;n.setState({inputValMap:[],searchVal:e},(function(e){return n.onChange(!0)}))},n.state={inputValMap:t.values?t.values:[],inputVal:"",searchVal:t.queryType||"FUZZY_SEARCH",contentWidth:0},n}(0,i.Z)(t,e);var n=t.prototype;return n.UNSAFE_componentWillReceiveProps=function(e,t){if(e.queryType&&this.setState({searchVal:e.queryType}),e.values&&e.values.length>0){var n=e.values;e.isExplore&&n.length>1&&n.pop(),this.setState({inputValMap:n})}},n.render=function(){var e=this,t=this.state,n=t.inputValMap,a=t.inputVal,r=t.searchVal,i=t.contentWidth,l=this.props,c=(l.style,l.close);l.onChange;return o.createElement("div",{className:"multi_word_input_wrap",style:{width:""+i}},c&&o.createElement("i",{className:"close",onClick:c},"\xd7"),o.createElement(A.Z,{options:I,activeObj:r,onChange:this.onSearchChange,divider:"none",sufIcon:"icon-cem_pull-down-or-take-up",className:"keyword_select"}),o.createElement("div",{className:"input-wrap"},o.createElement("input",{type:"text",className:"keyword-setting",value:a,placeholder:"\u591a\u4e2a\u5173\u952e\u8bcd\u8bf7\u7528\u7a7a\u683c\u5206\u9694\uff0c\u6309\u56de\u8f66\u641c\u7d22",onChange:this.inputChange,onBlur:this.keywordChange,onKeyDown:this.keywordChange}),n.length>0&&o.createElement("i",{className:"icon-cem_log-off",onClick:this.handleOnClose})),o.createElement("div",{style:{display:"flex",alignItems:"center"}},n.map((function(t,n){return o.createElement("span",{className:"word "+(0!==n?"FUZZY_SEARCH"===r?"word_blur":"word_exact":""),key:t+n},o.createElement("span",{title:t},t),o.createElement("i",{onClick:function(){return e.delKeyWords(n)}},"\xd7"))}))))},t}(o.Component);const H=Q;Q.propTypes={values:w().array,queryType:w().string,onChange:w().func};var L=n(35103),x=function(e){return e&&e.contain?{values:e.contain?JSON.parse(JSON.stringify(e.contain)):void 0,queryType:e.queryType}:{}},j=n(92044);const J=function(e){var t=e.currentQureyType,n=e.loading,a=e.queryTypeList,r=e.defaultFilter,i=e.content,l=e.handleFilterValueChange,c=e.handleQueryTypeChange;return o.createElement("div",{className:"opinion"},a&&a.length>0&&o.createElement("div",{className:"queryType-list"},o.createElement("i",{className:"icon-shujuyuan"}),o.createElement(b.default,{value:t,bordered:!1,onChange:function(e){c(e)},options:a,suffixIcon:o.createElement("i",{className:"icon-cem_pull-down-or-take-up"})}),o.createElement(H,{values:x(i).values||[],queryType:x(i).queryType||"FUZZY_SEARCH",onChange:function(e,t){return l("content",{contain:e,queryType:t})}})),r&&o.createElement("div",{style:{display:n?"none":"block"}},o.createElement(L.Z,{pageType:j.Q[t],expandInfo:{type:j.Q[t]},screenValue:r,advanceAuthority:!1,mainContentSearch:!0,showList:["screening"]})))};var W=m.Z.Step;const B=function(e){function t(t){var n;return(n=e.call(this,t)||this).tip=function(e){return o.createElement("span",{className:"tip"},o.createElement(k.Z,{overlay:e,placement:"top",mouseEnterDelay:.5},o.createElement("i",{className:"icon-cem_file1",style:{marginLeft:4,fontSize:14,color:"#979797",verticalAlign:"unset"}})))},n.onRadioChange=function(e){n.setState({many:"REPEATEDLY"===e.target.value})},n._handleRadioEffect=function(e,t){var a=n.state,r=a.many,i=a.resultType,l=n.props.loadingAdd,c=[o.createElement(p.default,{key:"gotoPre",onClick:function(){n.setState({currentStep:0}),e.onPre()}},"\u4e0a\u4e00\u6b65"),o.createElement(p.default,{type:"primary",key:"goToTree",loading:l&&"NOT_IMMEDIATELY"===i,onClick:function(){n.setState({resultType:"NOT_IMMEDIATELY"},(function(){return e.onSubmit()}))}},"\u751f\u6210\u79bb\u7ebf\u7ed3\u679c"),o.createElement(p.default,{type:"primary",key:"gotoTwo",loading:l&&"IMMEDIATELY"===i,onClick:function(){n.setState({resultType:"IMMEDIATELY"},(function(){return e.onSubmit()}))}},"\u7acb\u5373\u67e5\u8be2")];return(t||r)&&c.splice(2),c},n._handleModalShow=function(e){n.setState({isAddModalVisible:e})},n._handleOnHide=function(e){var t=n.props,a=t.showKind,r=t.changeShow;if(a){if("screening"===a)return;r(null)}},n.state={many:!1,isStepClick:!1,isAddModalVisible:!1,resultType:void 0,currentStep:0},n.formRef=o.createRef(),n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){if(this.props.filterParams!==e.filterParams){var t=this.props,n=t.filterParams,a=n.name,r=n.dateFilter,i=(n.headerFilterParamsNew,n.calculationType),o=n.calculationFrequency,l=t.init;this.formRef.current.setFieldsValue({name:a,dateFilter:r,calculationType:i,calculationFrequency:o}),l({dateValue:r}),this.setState({many:"REPEATEDLY"===i})}},n.componentDidMount=function(){window.addEventListener("click",this._handleOnHide)},n.componentWillUnmount=function(){window.removeEventListener("click",this._handleOnHide)},n.render=function(){var e=this,t=this.props,n=t.filterParams,a=t.changeShow,r=t.showKind,i=t.queryTypeList,l=t.dateFilter,C=t.currentQureyType,k=t.handleFilterValueChange,D=t.handleQueryTypeChange,E=t.handleFormSubmit,T=t.checkDateFormat,_=t.clearAllValues,V=t.loading,F=t.content,M=t.setDefault,Y=t.screeningValues,w=t.initDefultFilter,O=t.curScreeningMap,P=t.saveFilter,q=this.state,R=q.many,b=q.isAddModalVisible,A=q.currentStep,I=l&&l.quickChoice.indexOf("-")>-1;return o.createElement("div",{className:"screen_wrapper"},o.createElement("div",{className:"screen_box",style:{height:A?"100%":"unset",minHeight:A?"unset":"860px"}},o.createElement("div",{className:"screen_form"},o.createElement(s.default,{spinning:V,style:{height:"100%"}},o.createElement(g.ZP,{style:{height:"100%"}},o.createElement(d.Z,{style:{height:"100%"},onFinish:function(t){var n=e.state.resultType;n&&E(t,n,e._handleModalShow)},stepsRender:function(e,t){var n=t.props.children;return o.createElement(m.Z,{current:n.props.current,labelPlacement:"vertical"},e.map((function(e,t){return o.createElement(W,{key:e.key,title:0===t?"\u6761\u4ef6\u7b5b\u9009":"\u9009\u62e9\u8ba1\u7b97\u65b9\u5f0f",icon:0===t?o.createElement("span",{className:"ant-steps-icon-1"},"1"):""})})))},submitter:{render:function(t){return 0===t.step?[o.createElement("span",{key:"gotoClear",className:"clearBtn",style:{display:Y&&Y.length>0?"block":"none"},onClick:function(){return _()}},"\u6e05\u7a7a\u9009\u9879"),o.createElement(p.default,{key:"gotoCancle",onClick:function(){return history.back()}},"\u53d6\u6d88"),o.createElement(p.default,{key:"gotoNext",type:"primary",onClick:function(){e.setState({isStepClick:!0,currentStep:1});var n=O&&O.length>0?Y.filter((function(e){return O.find((function(t){return t.id===e.id}))})):Y;n.length>0&&n.map((function(e){return e.values=e.values.filter((function(t){return O.find((function(t){return t.id===e.id})).data.find((function(e){return e.id===t.id}))})),e})),M({key:"OPINION_FILTER_OBJ"+("COMMENT"===C?"":"_"+C),value:JSON.stringify({content:F,filter:n})}),P({screeningValues:n}),t.onSubmit()}},"\u4e0b\u4e00\u6b65")]:e._handleRadioEffect(t)}}},o.createElement(d.Z.StepForm,{name:"base",onFinish:function(){var t=e.state.isStepClick;return t&&e.setState({isStepClick:!1}),t}},o.createElement(J,{currentQureyType:C,loading:V,defaultFilter:w,content:F,queryTypeList:i,handleFilterValueChange:k,handleQueryTypeChange:D})),o.createElement(d.Z.StepForm,{formRef:this.formRef,name:"checkbox",layout:"horizontal",className:"steps-form",initialValues:{name:"\u4efb\u52a1"+this.props.getNameDate()},onValuesChange:function(t,n){n.dateFilter&&I&&(e.formRef.current.setFieldsValue({calculationType:"SINGLE"}),e.setState({many:!1}))}},o.createElement(f.Z,{name:"name",label:"\u4efb\u52a1\u540d\u79f0",width:"md",placeholder:"\u8bf7\u8f93\u5165\u540d\u79f0",fieldProps:{maxLength:40}}),o.createElement(u.Z.Item,{label:o.createElement("span",null,"\u65f6\u95f4\u8303\u56f4",this.tip("\u65f6\u95f4\u8303\u56f4\u7684\u65f6\u95f4\u53ea\u80fd\u9009\u62e9\u5386\u53f2\u65f6\u95f4")),name:"dateFilter"},o.createElement(Z,{changeFilter:function(e){return a(r===e?null:"date")},show:r})),o.createElement(h.Z.Group,{name:"calculationType",label:"\u8ba1\u7b97\u65b9\u5f0f",initialValue:"SINGLE",options:[{label:o.createElement("span",null,"\u5355\u6b21",this.tip("\u5355\u6b21\u4ec5\u751f\u6210\u4e00\u4e2a\u7ed3\u679c")),value:"SINGLE"},{label:o.createElement("span",null,"\u591a\u6b21",this.tip("\u6839\u636e\u91cd\u590d\u9891\u7387\uff0c\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u751f\u6210\u6ee1\u8db3\u7b5b\u9009\u6761\u4ef6\u7684\u65b0\u7ed3\u679c")),value:"REPEATEDLY",disabled:I}],onChange:function(t){return e.onRadioChange(t)}}),R&&!I&&o.createElement("div",{className:"repetition_rate"},o.createElement(y.Z,{extra:"\u5929\u751f\u6210\u4e00\u6b21\u7ed3\u679c",label:"\u91cd\u590d\u9891\u7387",name:"calculationFrequency",width:"sm",min:1,max:1e3,initialValue:7}),o.createElement("div",{style:{marginBottom:8},className:"tip"},o.createElement("div",{style:{marginBottom:8}},"\u9996\u6b21\u7ed3\u679c\u4f1a\u5728",S()().add(1,"days").format("YYYY/MM/DD"),"\u751f\u6210\uff0c\u4ec5\u5206\u6790",S()(l.from).format("YYYY/MM/DD")," ~",S()(l.to).format("YYYY/MM/DD"),"\u7684\u6570\u636e\u3002"),o.createElement("div",null,"\u7b2c\u4e8c\u6b21\u7ed3\u679c\u4f1a\u5728",S()().add((this.formRef.current.getFieldsValue("name").calculationFrequency||7)+1,"days").format("YYYY/MM/DD"),"\u751f\u6210\uff0c\u4ec5\u5206\u6790",(0,N.Dl)(l.quickChoice,this.formRef.current.getFieldsValue("name").calculationFrequency||7).from,"~",(0,N.Dl)(l.quickChoice,this.formRef.current.getFieldsValue("name").calculationFrequency||7).to,"\u7684\u6570\u636e\u3002")),o.createElement("div",{className:"tip"},"\u4efb\u52a1\u751f\u6210\u540e\uff0c\u9700\u5220\u9664\u4efb\u52a1\u624d\u80fd\u505c\u6b62\u3002")))))))),o.createElement(c.Z,{visible:b,title:o.createElement("span",{className:"confirm_title"},o.createElement("i",{className:"icon-cem_ordinary"}),"\u7ed3\u679c\u751f\u6210\u65f6\u95f4"),closable:!1,width:424,onCancel:function(){return e._handleModalShow(!1)},onOk:function(){n&&v.Z.success("\u64cd\u4f5c\u6210\u529f\uff0c\u7cfb\u7edf\u5df2\u751f\u6210\u65b0\u7684\u8ba1\u7b97\u4efb\u52a1"),history.back()},className:"opinion-modal"},o.createElement("p",{className:"confirm_body_content"},this.formRef.current&&this.formRef.current.getFieldsValue("name").name,"\u7ed3\u679c\u5c06\u5728",T((new Date).getMonth()+1)+"/"+T((new Date).getDate()+1),"01:00\u540e\u751f\u6210")))},t}(o.Component);var U=n(59934),G=["loading"],z=O.Z.opinion.opinionScreen,K=O.Z.opinion.timeScreening,$=O.Z.IDBHeaderScreening.headerScreening,X=O.Z.IDBHeaderScreening.screening,ee=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleFilterValueChange=function(e,t){var a=n.props.save;n.state.advancedFilter[e]=t,a({content:t})},n._getNameDate=function(){var e=new Date,t=n._checkDateFormat(e.getMonth()+1),a=n._checkDateFormat(e.getDate()),r=n._checkDateFormat(e.getHours()),i=n._checkDateFormat(e.getMinutes());return""+e.getFullYear()+t+a+r+i},n._checkDateFormat=function(e){return""+(e<10?0:"")+e},n._handleQueryTypeChange=function(e){n._handleGetDefault(e)},n._handleFormSubmit=function(e,t,a){var i=n.state,o=i.filterParams,l=i.currentQureyType,c=n.props,s=c.dateFilter,u=c.addOpinionTask,p=c.screeningValues,m=c.content,d=s.quickChoice.indexOf("-")>-1?s:(0,r.Z)({},s,{from:s.from+" 00:00:00",to:s.to+" 23:59:59"}),f=(0,r.Z)({},e,{content:Array.isArray(m)&&m[0].contain?m[0]:m.contain?m:null,headerFilterParamsNew:p,dateFilter:d,resultType:t,queryType:l,filterType:"OPINION_TASK"});u(o?Object.assign(o,f):f).then((function(e){e?(window.open("/opinionDetail?"+encodeURIComponent(JSON.stringify({id:e.id}))),history.back()):a(!0)}))},n._handleGetDefault=function(e){var t=e||n.state.currentQureyType,a=e?{currentQureyType:t}:{},i=n.props,o=i.getDefault,l=i.save;o({key:"OPINION_FILTER_OBJ"+("COMMENT"===t?"":"_"+t)}).then((function(e){if(e){var t=JSON.parse(e),i=Array.isArray(t)?t:Array.isArray(t.filter)?t.filter:[],o=i.find((function(e){return"ASPECT_MODEL"===e.id}))&&i.find((function(e){return"ASPECT_MODEL"===e.id})).values;o&&o.find((function(e){return"ASPECT2"===e.id}))&&(o.find((function(e){return"ASPECT2"===e.id})).values=o.find((function(e){return"ASPECT2"===e.id})).values.map((function(e){return/_/.exec(e)?e.split("_")[1]:e}))),n.setState((0,r.Z)({initDefultFilter:i},a)),t.content&&l({content:t.content})}else n.setState((0,r.Z)({initDefultFilter:[]},a))}))},n.state={currentQureyType:"COMMENT",queryTypeList:[],advancedFilter:{},filterParams:void 0,initDefultFilter:void 0},n._event={getSaveRef:function(e){return n.saveRef=e},handleFilterValueChange:n._handleFilterValueChange,getNameDate:n._getNameDate,checkDateFormat:n._checkDateFormat,handleQueryTypeChange:n._handleQueryTypeChange,handleFormSubmit:n._handleFormSubmit},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e,t=this;this.props.screenValue&&Array.isArray(this.props.screenValue)&&(e=this.props.screenValue),this.props.init({type:"opinion",screening:{value:e,noSavingFilterList:this.props.noSavingFilterList},dateValue:this.props.dateValue,contentValue:this.props.contentValue}).then((function(){t.props.onReady&&t.props.onReady(t.getValue())})),this.props.fetchOpinionTouchSpot().then((function(e){e&&t.setState({queryTypeList:e.map((function(e){return{value:e.split("_")[2],label:U.U[e.split("_")[2]]}}))})}));var n=this.props.location,a=n.query,i=n.search,o=this.props,l=o.findOpinionTask,c=o.save;a&&i?l(a).then((function(e){if(e){e.id;var n=e.name,a=e.filterParam,i=e.messageTotal,o=e.opinionTotal,l=e.status,s=JSON.parse(a);delete s.id,t.setState({filterParams:(0,r.Z)({name:n,messageTotal:i,opinionTotal:o,status:l},s),initDefultFilter:s.headerFilterParamsNew,currentQureyType:s.queryType}),s.content&&s.content.contain&&c({content:s.content})}})):this._handleGetDefault()},n.componentWillUnmount=function(){this.props.clear()},n.render=function(){return o.createElement(B,(0,r.Z)({},this.state,this._event,this.props,{saveRef:this.saveRef}))},t}(o.Component);const te=(0,l.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,G);return(0,r.Z)({},n[z],{dateFilter:n[K].dateFilter,screeningValues:n[X].screeningValues,curScreeningMap:n[X].curScreeningMap,loading:t.effects[z+"/getDefault"]||t.effects[$+"/init"]||t.effects[X+"/fetchDefaultConfig"]||!1,loadingAdd:t.effects[z+"/addOpinionTask"]||!1})}),(function(e){return{clear:function(){return e({type:z+"/clear"})},save:function(t){return e({type:z+"/save",payload:t})},saveFilter:function(t){return e({type:X+"/save",payload:t})},clearAllValues:function(t){return e({type:$+"/clearAllValues",payload:t})},changeShow:function(t){return e({type:z+"/changeShow",payload:t})},init:function(t){return e({type:z+"/init",payload:t})},fetchOpinionTouchSpot:function(t){return e({type:z+"/fetchOpinionTouchSpot",payload:t})},addOpinionTask:function(t){return e({type:z+"/addOpinionTask",payload:t})},findOpinionTask:function(t){return e({type:z+"/findOpinionTask",payload:t})},setDefault:function(t){return e({type:z+"/setDefault",payload:t})},getDefault:function(t){return e({type:z+"/getDefault",payload:t})}}}))(ee)}}]);