"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[2777],{22777:(e,t,n)=>{n.r(t),n.d(t,{default:()=>N});var a=n(63366),o=n(87462),r=n(94578),s=n(67294),i=n(55609),l=n(61193),c=n(61409),u=n(92360),m=n(15861),p=n(87757),d=n.n(p),g=n(62887),h=n(97189),f=function(e){function t(t){var n;(n=e.call(this,t)||this).handlePreSubmit=function(e){n.props.login({username:(0,h.getQuery)("username"),accessToken:(0,h.getQuery)("access_token"),source:(0,h.getQuery)("source")})},n.handleSubmit=(0,m.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=new FormData(document.getElementById("form-login"))).append("_lv","2"),n.setState({form:{username:t.get("username"),password:t.get("password")}}),n.props.login({username:t.get("username"),password:(0,g.Qo)(t.get("password")),openId:n.props.openId});case 4:case"end":return e.stop()}}),e)}))),n.onUserChange=function(e){var t=e.target.value;n.setState({showUser:t.length>0,form:(0,o.Z)({},n.state.form,{username:t})})},n.onPasswordChange=function(e){var t=e.target.value;n.setState({form:(0,o.Z)({},n.state.form,{password:t}),showClear:t.length>0})},n.handleClear=function(){n.setState({form:{password:""},showClear:!1})},n.handleEnter=function(e){"Enter"===e.key&&n.state.showUser&&n.state.showClear&&n.handleSubmit()},n.handleExp=function(e){n.setState({emialExp:e.target.value})};var a=t.location;return(0,h.getQuery)("username")&&(0,h.getQuery)("access_token")&&(0,h.getQuery)("source")&&n.handlePreSubmit(),n.state={emialExp:"",isShowEmailWarn:"hidden",error:void 0,show:!1,isFirst:!(!a.state||!a.state.isFirst)&&a.state.isFirst,showClear:!1,showUser:!1,form:{username:"",password:""}},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;this.timer=setInterval((function(){["input:-internal-autofill-selected","input:-webkit-autofill"].some((function(e){return document.querySelector(e)}))&&(e.setState({showClear:!0,showUser:!0}),clearInterval(e.timer))}),10),setTimeout((function(){return clearInterval(e.timer)}),1e4)},n.componentWillUnmount=function(){this.props.save({visible:!1})},n.render=function(){var e=this,t=this.state,n=t.show,a=t.isFirst,o=t.showClear,r=t.showUser,i=t.form,l=i.username,m=i.password,p=this.props,d=p.isBind,g=p.slogan,h=p.loginLoading,f=p.loginStatus;return s.createElement(s.Fragment,null,s.createElement("div",{className:"main-panel normal-panel"},s.createElement("form",{ref:function(t){return e.loginRef=t},id:"form-login"},s.createElement("h2",{className:"login_title"},!d&&g||!d&&"\u767b\u5f55",d&&"\u6388\u6743\u6210\u529f\uff0c\u8bf7\u7ed1\u5b9a\u8d26\u53f7",a&&s.createElement("div",{className:"title_tips"},"\u4f60\u7684\u5bc6\u7801\u5df2\u7ecf\u4fee\u6539\u6210\u529f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\uff01")),s.createElement("div",{className:"input-wrap input-top"},s.createElement("input",{type:"text",name:"username",value:l,className:h?"input_disabled":"",disabled:h,onChange:this.onUserChange,placeholder:"\u8bf7\u8f93\u5165\u4f60\u7684\u90ae\u7bb1",ref:function(t){return e.userRef=t},onKeyDown:this.handleEnter,onBlur:this.handleExp})),s.createElement("div",{className:"input-wrap input-pwd"},s.createElement("input",{type:n?"text":"password",name:"password",value:m,onChange:this.onPasswordChange,placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",required:!0,className:h?"input_disabled":"",disabled:h,autoComplete:"off",ref:function(t){return e.passwordRef=t},onKeyDown:this.handleEnter}),s.createElement("i",{className:"icon-cem_log-off",onClick:this.handleClear,style:{display:o?"inline-block":"none"}}),s.createElement("svg",{t:"1590140127784",onClick:function(){e.setState({show:!e.state.show})},id:"pw-btn",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"9122"},s.createElement("path",{d:"M640 512a128 128 0 1 0-128 128 128 128 0 0 0 128-128z m-204.8 0a76.8 76.8 0 1 1 76.8 76.8A76.8 76.8 0 0 1 435.2 512z",fill:n?"#0847a6":"#8c8c8c","p-id":"9123"}),s.createElement("path",{d:"M512 153.6Q229.376 153.6 0 512a1552.384 1552.384 0 0 0 168.96 208.896l35.84-37.376A1349.12 1349.12 0 0 1 61.952 512C201.216 307.2 350.72 204.8 512 204.8s311.808 102.4 450.56 307.2c-139.264 204.8-289.28 307.2-450.56 307.2a399.872 399.872 0 0 1-208.384-59.904l-26.112 44.032A451.072 451.072 0 0 0 512 870.4q282.624 0 512-358.4-229.376-358.4-512-358.4z",fill:n?"#0847a6":"#8c8c8c","p-id":"9124"})))),this.state.error&&s.createElement("div",{className:"error"},this.state.error),s.createElement(u.Button,{className:"login-btn "+(r&&o&&"login-btn-hover"),disabled:!r||!o,onClick:this.handleSubmit,loading:h},h?f:d?"\u7ed1\u5b9a\u5e76\u767b\u5f55":"\u767b\u5f55"),s.createElement("span",{className:"forget-psw",onClick:function(){c.mW.push("/reset")}},"\u5fd8\u8bb0\u5bc6\u7801")))},t}(s.PureComponent),w=n(79361),v=n.n(w),E=function(e){function t(t){var n;return(n=e.call(this,t)||this).checkBindState=function(e){n.props.loginCheck({token:e}).then((function(e){e.result.status,"SUCCESS"===e.result.status&&(n.timer&&(clearInterval(n.timer),n.timer=null),n.props.login({token:e.result.token,needNprogress:!0})),"NO_BINDING"===e.result.status&&(n.timer&&(clearInterval(n.timer),n.timer=null),n.props.setIsMail(!0),n.props.setIsBind(!0),n.props.setOpenId(e.result.openid)),"REFUSED"===e.result.status&&n.props.setIsMail(!0)}))},n.state={wechatUrl:""},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;this.props.getQrcode().then((function(t){2e4===t.code&&e.setState({wechatUrl:t.result.url},(function(){e.timer=setInterval((function(){e.checkBindState(t.result.token)}),3e3)}))}))},n.componentWillUnmount=function(){this.timer&&(clearInterval(this.timer),this.timer=null),this.props.setIsBind(!1),this.props.setOpenId(void 0)},n.render=function(){var e=this.state.wechatUrl;return s.createElement("div",{className:"main-panel normal-panel"},s.createElement("h2",{className:"login_title"},"\u626b\u7801\u767b\u5f55",s.createElement("div",{className:"title_tips"},"\u8bf7\u4f7f\u7528\u5fae\u4fe1\u626b\u63cf\u4e8c\u7ef4\u7801")),e?s.createElement("div",{style:{height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",marginTop:"48px"}},s.createElement(v(),{value:e,size:252})):s.createElement("div",{style:{height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",marginTop:"48px"}},"\u7f51\u7edc\u51fa\u73b0\u5f02\u5e38"))},t}(s.Component),y=n(82359),C=g.U[parseInt(6*Math.random())];const _=function(e){var t,a=e.login,o=e.loginCheck,r=e.getQrcode,i=e.logoImg,l=e.wechatUrl,c=e.qrcode,m=e.location,p=e.slogan,d=e.visible,g=e.onResetPsw,h=e.save,w=e.loginLoading,v=e.loginStatus,_=s.useState(!0),b=_[0],k=_[1],I=s.useState(!1),S=I[0],N=I[1],x=s.useState(!0),U=x[0],B=x[1],M=s.useState(void 0),Q=M[0],Z=M[1];return t=n(U?b?49634:83861:b?99278:17103),s.createElement("div",{className:"yt_dblogin_wrap",id:"particles"},s.createElement("div",{id:"login_panel_left"},s.createElement("div",{className:"yt_logo-cem"},s.createElement("img",{src:i,alt:"logo.png",id:"yt_logo_img",onClick:function(){return window.open("https://www.yuntingai.com")}})),s.createElement("div",{className:"login_panel_container"},s.createElement("div",{className:"top_login_way"},s.createElement("span",{style:{display:b?"none":"inline-block",transition:"all .3s"}},U?"\u626b\u7801\u767b\u5f55":"\u8d26\u6237\u767b\u5f55"),s.createElement("img",{src:t,onClick:function(){B(!U)},onMouseEnter:function(){k(!1)},onMouseLeave:function(){k(!0)},alt:"login.png"})),U?s.createElement(f,{login:a,location:m,openId:Q,isBind:S,slogan:p,save:h,loginLoading:w,loginStatus:v}):s.createElement(E,{login:a,loginCheck:o,getQrcode:r,setIsMail:B,setIsBind:N,setOpenId:Z,isMail:U,qrcode:c,wechatUrl:l}),-1===window.navigator.userAgent.indexOf("Chrome")&&s.createElement("p",{className:"browser_tips"},"- \u4e3a\u907f\u514d\u53ef\u89c6\u5316\u6548\u679c\u4e0d\u517c\u5bb9\uff0c\u63a8\u8350\u4f7f\u7528 Chrome \u6d4f\u89c8\u5668 -")),s.createElement("p",{className:"rights"},"\xa9 2020 \u6df1\u5733\u89c6\u754c\u4fe1\u606f\u6280\u672f\u6709\u9650\u516c\u53f8 All rights reserved.",s.createElement("a",{href:"https://beian.miit.gov.cn/",target:"_blank",rel:"noopener noreferrer"},"\u7ca4ICP\u590714092314\u53f7")),s.createElement(u.Dialog,{title:s.createElement("span",null,s.createElement("i",{className:"icon-cem_warning",style:{color:"#D96969",fontSize:"20px",paddingRight:"10px"}}),"\u4f60\u7684\u5bc6\u7801\u5df2\u8fc7\u671f\uff0c\u8bf7\u91cd\u7f6e\u5bc6\u7801"),size:"tiny",visible:d,onCancel:function(){h&&h({visible:!1})},className:"reset_dialog",top:"35%"},s.createElement(u.Dialog.Footer,null,s.createElement(u.Button,{onClick:function(){h&&h({visible:!1})}},"\u53d6\u6d88"),s.createElement(u.Button,{type:"primary",onClick:g},"\u524d\u5f80\u91cd\u7f6e\u5bc6\u7801")))),s.createElement("div",{id:"login_img_right",style:{backgroundImage:"url("+y+")"}},s.createElement("h2",{dangerouslySetInnerHTML:{__html:C.word}}),s.createElement("img",{src:C.img,width:"100%",style:{marginTop:"50px"}})))};var b=n(64396),k=["loading"],I=b.Z.userLogin,S=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnResetPsw=function(){var e=n.props,t=e.getCheckCode,a=e.email;t({email:a}),c.mW.replace({pathname:"/set",state:{email:a}})},n.state={logoImg:l.Z.getUser()&&l.Z.getUser().accountLogo?l.Z.getUser().accountLogo:"//yunting-1251101074.coscd.myqcloud.com/account_logo/"+window.location.hostname+"/130_130.png"},n.event={onResetPsw:n._handleOnResetPsw},n}(0,r.Z)(t,e);var a=t.prototype;return a.componentDidMount=function(){this.props.getSlogan({host:window.location.hostname}),document.getElementById("yt_logo_img")&&(document.getElementById("yt_logo_img").onerror=function(e){document.getElementById("yt_logo_img").src=n(48747)})},a.componentWillUnMount=function(){this.props.clean()},a.render=function(){return s.createElement(_,(0,o.Z)({},this.props,this.state,this.event))},t}(s.Component);const N=(0,i.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,k);return(0,o.Z)({},n[I],{loginLoading:t.effects[I+"/login"]||!1})}),(function(e){return{getSlogan:function(t){return e({type:I+"/getSlogan",payload:t})},login:function(t){return e({type:I+"/login",payload:t})},getCheckCode:function(t){return e({type:I+"/getCheckCode",payload:t})},getQrcode:function(){return e({type:I+"/getQrcode"})},loginCheck:function(t){return e({type:I+"/loginCheck",payload:t})},save:function(t){return e({type:I+"/save",payload:t})},clean:function(t){return e({type:I+"/clean",payload:t})}}}))(S)},82359:(e,t,n)=>{e.exports=n.p+"img/76bb61a27cc980c47c4d.png"},17103:(e,t,n)=>{e.exports=n.p+"img/01c24612b4f3c1034da8.png"},99278:(e,t,n)=>{e.exports=n.p+"img/25a64cc92e2b4ea9a9b5.png"},83861:(e,t,n)=>{e.exports=n.p+"img/b146890e5fd99ad2814f.png"},49634:(e,t,n)=>{e.exports=n.p+"img/462f02d9c3974831f99f.png"},48747:(e,t,n)=>{e.exports=n.p+"img/4d6354a771bb10a700b6.png"}}]);