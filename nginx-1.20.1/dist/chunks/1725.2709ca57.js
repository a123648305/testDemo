"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[1725],{81725:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Z});var a=n(87462),r=n(63366),i=n(94578),l=n(67294),o=n(2271),c=(n(37841),n(61918)),u=n(61409),s=n(92360);const p=function(e){function t(t){var n;return(n=e.call(this,t)||this).showDialog=function(e){n.state.visible?n.setState({visible:!1,callback:void 0},(function(){n.setState((0,a.Z)({visible:!0},e))})):n.setState((0,a.Z)({visible:!0},e))},n._handleOnCancel=function(){n.setState({visible:!1,data:void 0,type:void 0,callback:void 0})},n._handleOnConfrim=function(){var e=n.state,t=e.callback,a=e.data;t&&t(a),n.setState({visible:!1,data:void 0,type:void 0,callback:void 0})},n.state={visible:!1,data:void 0,type:void 0,callback:void 0},n}return(0,i.Z)(t,e),t.prototype.render=function(){var e=this.state,t=e.visible,n=e.name;return l.createElement(s.Dialog,{className:"yt-nps-template-delete-dialog-wrapper",size:"tiny",visible:t,title:"\u662f\u5426\u5220\u9664\u8be5\u4e3b\u9898\uff1f",closeOnClickModal:!1,onCancel:this._handleOnCancel},l.createElement(s.Dialog.Body,null,l.createElement("i",{className:"icon-cem_warning warn-tip"}),l.createElement("div",{className:"warn-txt"},"\u5220\u9664\u4e3b\u9898\u300c"+n+"\u300d\u540e\uff0c\u4e0e\u4e4b\u76f8\u5173\u7684\u4e3b\u9898\u503c\u5c06\u88ab\u5220\u9664")),l.createElement(s.Dialog.Footer,null,l.createElement(s.Button,{onClick:this._handleOnCancel},"\u53d6\u6d88"),l.createElement(s.Button,{type:"primary",onClick:this._handleOnConfrim},"\u786e\u5b9a")))},t}(l.PureComponent);var d=n(57522),m=n(45697),f=n.n(m),h=(n(38263),function(e){var t=e.value,n=e.getValue,a=e.setIsNext,r=e.show,i=l.useState(t.rotate||"0"),o=(i[0],i[1],l.useState(t.row||"1")),c=(o[0],o[1],l.useState(t.length||"12")),u=(c[0],c[1],l.useState(!0)),p=u[0],d=u[1],m=l.useState(""),f=m[0],h=m[1],g=l.useState(t.name||""),v=g[0],y=g[1],C=l.useState(!1),E=C[0],_=C[1];return l.useEffect((function(){n({name:v})}),[v]),l.createElement("div",{className:"yt_modal_product_topic_wrapper"},l.createElement("div",{className:" second"},l.createElement("span",null,"\u4e3b\u9898"),l.createElement("span",null,l.createElement("span",null,l.createElement(s.Input,{placeholder:"\u8bf7\u8f93\u5165\u540d\u79f0",maxLength:20,className:p&&!f?"":"err",defaultValue:v,onFocus:function(){f&&h("")},onBlur:function(){f&&h("")},onChange:function(e){!e.length&&h("\u8bf7\u8f93\u5165\u4e3b\u9898\u540d"),20===e.length&&h("\u6700\u591a\u8f93\u516520\u5b57"),y(e),d(!!e)}}))),l.createElement("p",{className:f?"err":""},f)),r&&l.createElement("div",{className:"check"},l.createElement(s.Checkbox,{size:"small",onChange:function(e){_(e),a(e)},checked:E},"\u518d\u5efa\u4e00\u4e2a")))});function g(e,t){return new Promise((function(n,r){var i=e.value||{},o=!0,c=!1,u=(0,a.Z)({},e,{titleText:e.value?"\u91cd\u547d\u540d":"\u65b0\u5efa\u4e3b\u9898",content:l.createElement(h,(0,a.Z)({},e,{show:!e.value,getValue:function(e){i=e,o=!!e.name},setIsNext:function(e){return c=e}})),test:function(){return new Promise((function(e,n){o?c?(t(i).then((function(){document.querySelector(".yt_modal_product_topic_wrapper .el-input .el-input__inner").value="",o=!1})).catch((function(){})),n()):t(i).then((function(){document.querySelector(".yt_modal_product_topic_wrapper .el-input .el-input__inner").value="",o=!1,e()})).catch((function(){n()})):(s.Message.error("\u8bf7\u8f93\u5165\u540d\u79f0"),n())}))}});u.onOk=function(){},u.onCancel=r,(0,d.Z)(u)}))}h.propTypes={value:f().object,getValue:f().func};var v=n(39432),y=function(e){var t=e.value,n=e.getValue,a=l.useState(!0),r=a[0],i=(a[1],l.useState("")),o=i[0],c=i[1],u=l.useState(t.naturalName||"")[0],p=l.useState(t.name||""),d=p[0],m=p[1];return l.useEffect((function(){n({alias:d})}),[d]),l.createElement("div",{className:"yt_modal_topic_alias_wrapper"},l.createElement("div",{className:"topic_name"},l.createElement("span",null,"\u4e3b\u9898\u540d\u79f0"),l.createElement("span",null,u)),l.createElement("div",{className:"second"},l.createElement("span",null,"\u522b\xa0\xa0\xa0\xa0\xa0\xa0\xa0\u540d"),l.createElement("span",null,l.createElement("span",null,l.createElement(s.Input,{placeholder:"\u8bf7\u8f93\u5165\u522b\u540d",maxLength:8,className:r&&!o?"":"err",defaultValue:d,onFocus:function(){o&&c("")},onBlur:function(){o&&c("")},onChange:function(e){8===e.length?c("\u6700\u591a\u8f93\u51658\u5b57"):c(null),m(e)}}))),l.createElement("p",{className:o?"err":""},o)))};y.propTypes={value:f().object,getValue:f().func};var C=n(61193),E={DEFAULT:"\u9ed8\u8ba4\u4e3b\u9898",SPU:"\u9ed8\u8ba4\u4e3b\u9898",SKU:"\u9ed8\u8ba4\u4e3b\u9898",USER_CUSTOMIZE:"\u81ea\u5b9a\u4e49\u4e3b\u9898",USER_GROUP:"\u884d\u751f\u4e3b\u9898",USER_SYNTHESIS:"\u884d\u751f\u4e3b\u9898",SYNTHESIS:"\u5408\u6210\u4e3b\u9898"};const _=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={},n.columns=[{label:"\u4e3b\u9898",prop:"name",width:210,fixed:"",checked:!0},{label:"\u4e3b\u9898\u503c\u6570\u91cf",prop:"topicValueCount",width:150,fixed:"",checked:!0},{label:"\u6700\u540e\u4fee\u6539",prop:"updatedAt",width:150,fixed:"",checked:!0},{label:"\u64cd\u4f5c",prop:"control",width:150,fixed:"",checked:!0}],n.prefixColumns=[{fixed:"left",label:"",width:16}],n.columnRenders={topicValueCount:function(e){return l.createElement("span",{className:C.Z.hasAuthority("TOPIC_VALUE_MANAGER")?"link":"",onClick:function(){C.Z.hasAuthority("TOPIC_VALUE_MANAGER")&&u.mW.push({pathname:"/account/project/linkTopic/value",state:{id:e.id,name:e.name,type:e.topicType}})}},e.topicValueCount)},topicType:function(e){return E[e.topicType]},updatedAt:function(e){return l.createElement("div",{className:"setting_table_last_wrap"},l.createElement("p",null,e.updaterUsername),e.updaterEmail&&l.createElement("p",null,e.updaterEmail),e.updatedAt&&l.createElement("p",null,(0,v.Go)(e.updatedAt)))},control:function(e){return l.createElement("div",{className:"control link"},C.Z.hasAuthority("TOPIC_VALUE_MANAGER")&&l.createElement("span",{onClick:function(){return u.mW.push({pathname:"/account/project/linkTopic/value",state:{id:e.id,name:e.name,type:e.topicType,valueType:e.valueType}})}},"\u7ba1\u7406\u4e3b\u9898\u503c"),("SPU"===e.topicType||"SKU"===e.topicType)&&l.createElement("span",{onClick:function(){return t={value:{name:e.name,naturalName:e.naturalName}},r=function(t){return n.props.addAlias({id:e.id,frontName:t.alias})},new Promise((function(e,n){var i=t.value||{},o=!0,c=(0,a.Z)({},t,{titleText:"\u4e3b\u9898\u522b\u540d",content:l.createElement(y,(0,a.Z)({},t,{getValue:function(e){i=e}})),test:function(){return new Promise((function(e,t){o?r(i).then((function(){document.querySelector(".yt_modal_topic_alias_wrapper .el-input .el-input__inner").value="",o=!1,e()})).catch((function(){t()})):(s.Message.error("\u8bf7\u8f93\u5165\u522b\u540d"),t())}))}});c.onOk=function(){},c.onCancel=n,(0,d.Z)(c)}));var t,r}},"\u522b\u540d"),C.Z.hasAuthority("TOPIC_UPDATE")&&l.createElement("span",{onClick:function(){return g({value:{name:e.name},onCancel:function(){}},(function(t){return n.props.editTopic({id:e.id,name:t.name})}))}},"\u7f16\u8f91"),C.Z.hasAuthority("TOPIC_DELETE")&&l.createElement("span",{onClick:function(){return n.deleteRef.showDialog({name:e.name,callback:function(){n.props.delTopic({id:e.id})}})}},"\u5220\u9664"))}},n}return(0,i.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.list,a=t.page,r=t.name,i=(t.valueFrom,t.nameChange),u=(t.valueFromChange,t.pageChange),d=t.addTopic,m=t.fetchingList,f=a.pageIndex,h=a.pageSize,v=a.count;return l.createElement("div",{className:"project_topic"},l.createElement("div",{className:"product_setting_topic"},l.createElement("div",{className:"handel"},l.createElement(c.Z,{placeholder:"\u641c\u7d22\u4e3b\u9898",value:r,onSearch:function(e){return i({name:e})},onClear:function(){return i({name:""})}}),C.Z.hasAuthority("TOPIC_ADD")&&l.createElement(s.Button,{className:"right_button",type:"primary",onClick:function(){return g({value:"",onCancel:function(){}},(function(e){return d(e)}))}},"\u65b0\u5efa\u4e3b\u9898")),l.createElement(o.Z,{savedKey:"product_setting_topic_overview",rowKeyProp:"id",total:v,pageIndex:f,pageSize:h,prefixColumns:this.prefixColumns,data:n,loading:m,columns:this.columns,columnRenders:this.columnRenders,headerRenders:this.headerRenders,onPageChange:function(e){u({pageIndex:e,pageSize:h})},onPageSizeChange:function(e){u({pageIndex:f,pageSize:e})}}),l.createElement(p,{ref:function(t){return e.deleteRef=t}})))},t}(l.Component);var b=n(55609),k=n(35239),N=n(64396),w=n(55815),S=n(13713),O=["loading"],x=N.Z.product.setting.public,T=N.Z.product.setting.topic.overview,P=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={},t.save({projectId:k.t.get(k.V.backProjectConfig).id}),t.titleChange([{title:"\u4e3b\u9898",state:{type:""}}]),n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;this.props.fetchList(),this.props.location&&this.props.location.query&&this.props.location.query.open&&(g({value:"",onCancel:function(){}},(function(t){return e.props.addTopic(t)})),u.mW.push("/account/project/linkTopic"))},n.componentWillUnmount=function(){this.props.clean()},n.render=function(){return l.createElement("div",null,l.createElement(w.Z,{title:(0,S.u)({title:"\u4e3b\u9898"})}),l.createElement(_,this.props))},t}(l.Component);const Z=(0,b.connect)((function(e){var t=e.loading,n=(0,r.Z)(e,O);return(0,a.Z)({},n[T],{fetchingList:t.effects[T+"/fetchList"]||!1})}),(function(e){return{fetchList:function(){return e({type:T+"/fetchList"})},valueFromChange:function(t){return e({type:T+"/valueFromChange",payload:t})},nameChange:function(t){return e({type:T+"/nameChange",payload:t})},addTopic:function(t){return e({type:T+"/addTopic",payload:t})},editTopic:function(t){return e({type:T+"/editTopic",payload:t})},addAlias:function(t){return e({type:T+"/addAlias",payload:t})},pageChange:function(t){return e({type:T+"/pageChange",payload:t})},delTopic:function(t){return e({type:T+"/delTopic",payload:t})},save:function(t){return e({type:T+"/save",payload:t})},clean:function(t){return e({type:T+"/clean",payload:t})},titleChange:function(t){return e({type:x+"/titleChange",payload:t})}}}))(P)},13713:(e,t,n)=>{n.d(t,{u:()=>r});var a=n(35239),r=function(e){var t=e.title,n=e.url,r=a.t.get(a.V.backProjectConfig).name;return n&&-1!==n.indexOf("memberlist")?[{title:r,url:"/account/project/preview"},{title:"\u7528\u6237\u7ec4",url:"/account/project/usergroup"},{title:t,url:n}]:[{title:r,url:"/account/project/preview"},{title:t,url:n}]}},55815:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(94578),r=n(67294),i=n(45697),l=n.n(i),o=n(43036),c=n(61409),u=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props,a=n.title,r=n.beforeJump;e!==a.length-1&&(r?new Promise((function(e,t){return r(e,t)})).then((function(){c.mW.push({pathname:a[e].url,state:a[e].state})})):c.mW.push({pathname:a[e].url,state:a[e].state}))},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.mainTitle,i=t.rightContent,l=t.className,c=t.overlay;return r.createElement("div",{className:"breadcumb-wrapper "+l},n instanceof Array?r.createElement("div",{className:"breadcrumb-left"},r.createElement("div",null,n.map((function(t,a){return r.createElement("span",{className:t.url?"":"not_clickable",key:a,onClick:function(){return t.url&&a!==n.length-1&&e._handleBreadcrumbClick(a)}},t.title,a!==n.length-1&&" / ")}))),r.createElement("span",null,a||n[n.length-1].title,c&&r.createElement(o.Z,{placement:"top",overlay:c},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}})))):r.createElement("div",{className:"normal-title"},n,c&&r.createElement(o.Z,{placement:"top",overlay:c},r.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}}))),i||"")},t}(r.Component);u.propTypes={className:l().string,title:l().oneOfType([l().string,l().arrayOf(l().shape({title:l().string,url:l().string,state:l().object}))]).isRequired,overlay:l().oneOfType([l().string,l().node]),mainTitle:l().oneOfType([l().string,l().node]),beforeJump:l().func,rightContent:l().node};const s=u},61918:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(67294),r=n(45697),i=n.n(r),l=function(e){var t=e.className,n=e.onClear,r=e.onSearch,i=e.placeholder,l=e.style,o=e.defValue,c=e.signal,u=a.useState(o),s=u[0],p=u[1];a.useEffect((function(){p(o)}),[o,c]);return a.createElement("div",{style:l,className:"yt_search_input_wrapper "+(t||"")},a.createElement("input",{placeholder:i,value:s,onKeyDown:function(e){13===e.keyCode&&r(s)},onChange:function(e){return p(e.target.value)},autoComplete:"off"}),s&&a.createElement("i",{className:"icon-cem_log-off",onClick:function(){p(""),n&&n("")}}),a.createElement("i",{className:"icon-cem_small-search",onClick:function(){return r(s)}}))};l.propTypes={className:i().string,onSearch:i().func.isRequired,placeholder:i().string,style:i().object,defValue:i().string,signal:i().any,onClear:i().func};const o=l},37841:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(67294),r=n(45697),i=n.n(r),l=function(e){var t=e.activeKey,n=e.options,r=e.onTabClick;return a.createElement("div",{className:"tabs"},n.map((function(e,n){return a.createElement("div",{key:n,className:t===e.value?"active-tab":"",onClick:function(){return t!==e.value&&r(e.value,e)}},e.key||e.label)})))};l.propTypes={activeKey:i().oneOfType([i().string,i().number]),options:i().arrayOf(i().shape({key:i().string,value:i().oneOfType([i().string,i().number])})).isRequired,onTabClick:i().func.isRequired};const o=l},2271:(e,t,n)=>{n.d(t,{Z:()=>L});var a=n(63366),r=n(87462),i=n(43144),l=n(94578),o=n(23279),c=n.n(o),u=n(67294),s=n(92360),p=n(35303),d=n(45697),m=n.n(d),f=[{label:"10\u9879/\u9875",value:10},{label:"20\u9879/\u9875",value:20},{label:"40\u9879/\u9875",value:40},{label:"100\u9879/\u9875",value:100}];const h=function(e){var t=e.onPageChange,n=e.onSizeChange,a=e.total,r=void 0===a?0:a,i=e.pageIndex,l=e.pageSize,o=e.currLength,c=e.layout,d=e.className,m=0===r?0:(i-1)*l+1,h=0===r?0:m+o-1;return 0===r?null:u.createElement("div",{className:"yt-awp-pagination "+(d||"")},u.createElement("span",{className:"total_num"},u.createElement("span",null,m+" - "+h+" "),"\u9879\uff0c\u5171",u.createElement("span",null," "+r+" "),"\u9879"),u.createElement("div",{style:{textAlign:"right",float:"right"},className:"new_pagination"},u.createElement(s.Pagination,{small:!0,pageSize:l,currentPage:i,pageCount:Math.ceil(r/l),layout:0===r?"":"prev, pager, next",onCurrentChange:t}),void 0===c||c.includes("sizes")?u.createElement(p.RS,{multiple:!1,tags:!1,showSearch:!1,optionFilterProp:"label",optionLabelProp:"label",animation:"slide-up",dropdownClassName:"custom-pagination-dropdown",value:l||10,onChange:n},f.map((function(e,t){return u.createElement(p.Wx,{key:t,label:e.label,value:e.value},e.label)}))):null))};m().propTypes={onPageChange:m().func,onSizeChange:m().func,total:m().number,pageIndex:m().number,pageSize:m().number,currLength:m().number,layout:m().string,className:m().string};var g=n(8201),v=n(15861),y=n(87757),C=n.n(y),E=n(49722);function _(){return(_=(0,v.Z)(C().mark((function e(t){var n,a;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectId,a=t.key,e.abrupt("return",E.h.post("/default/value/find",{projectId:n,key:a}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return(b=(0,v.Z)(C().mark((function e(t){var n,a,r;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectId,a=t.value,r=t.key,e.abrupt("return",E.h.post("/default/value/update",{projectId:n,key:r,value:a}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var k=n(39432),N=n(43036),w=n(51474),S=n(87219),O=function(e){function t(t){var n;return(n=e.call(this,t)||this)._setShowFalse=function(){n.setState({show:!1})},n._handleParentClick=function(e){n.state.show&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())},n._handleOnTriggerClick=function(){setTimeout((function(){n.setState({show:!n.state.show})}),0)},n._renderOptionItem=function(e,t,a,r,i,l){var o=n.state.maxLabelWidth,c=n.props,s=c.value,p=c.savedKey,d=s.find((function(t){return t.prop===e.prop}));return u.createElement("div",{className:"opt_item "+(t?"draggable":""),key:e.prop},t&&u.createElement("i",{className:"icon-cem_move my_handle"}),u.createElement("div",{className:"opt_content",style:{width:o,marginLeft:t?0:12}},u.createElement("div",{className:"item_label",onClick:function(t){t.stopPropagation(),n._handleOnItemClick(e.prop)}},u.createElement("span",{className:"icon_checkbox "+(d&&d.checked?"checkbox_checked":"")}),u.createElement("span",null,e.label)),u.createElement("div",{className:"item_control",style:{display:"product_setting_link"===p?"none":"block"}},u.createElement(N.Z,{placement:"top",overlay:a},u.createElement("span",{onClick:function(t){return r(t,e.prop)}},u.createElement("i",{className:(t?"icon-cem_up":"icon-cem_up-and-down")+" fun_icon_a"}))),u.createElement(N.Z,{placement:"top",overlay:i},u.createElement("span",{onClick:function(t){return l(t,e.prop)},style:{marginLeft:4}},u.createElement("i",{className:"icon-cem_down fun_icon_b"}))))))},n._handleOnItemClick=function(e){var t=n.props,a=t.value,r=t.onChange;r&&r((0,S.ZP)(a,(function(t){var n=t.find((function(t){return t.prop===e}));n&&(n.checked=!n.checked)})))},n._handleOnFilxedLeftClick=function(e,t){e.stopPropagation(),n._handleOnFixedChange(t,"left")},n._handleOnCancelFixedClick=function(e,t){e.stopPropagation(),n._handleOnFixedChange(t,"")},n._handleOnFixedRightClick=function(e,t){e.stopPropagation(),n._handleOnFixedChange(t,"right")},n._handleOnFixedChange=function(e,t){var a=n.props,r=a.value,i=a.onChange;i&&i((0,S.ZP)(r,(function(n){var a=n.find((function(t){return t.prop===e}));a&&(a.fixed=t)})))},n.state={show:!1,value:[],leftOpts:[],normalOpts:[],rightOpts:[],maxLabelWidth:t.value.reduce((function(e,t){return Math.max((0,k.jD)(t.label,14)+56+16+16,e)}),0)},n}(0,l.Z)(t,e),t.getDerivedStateFromProps=function(e,t){if(JSON.stringify(e.value)!==JSON.stringify(t.value)){var n=e.value.reduce((function(t,n){var a=1;return"left"===n.fixed&&(a=0),"right"===n.fixed&&(a=2),t[a].push(e.value.find((function(e){return e.prop===n.prop}))),t}),[[],[],[]]),a=n[0],r=n[1],i=n[2];return{value:e.value,leftOpts:a,normalOpts:r,rightOpts:i,maxLabelWidth:e.value.reduce((function(e,t){return Math.max((0,k.jD)(t.label,14)+56+16+16,e)}),0)}}return null};var n=t.prototype;return n.componentDidMount=function(){var e=this;window.addEventListener("click",this._setShowFalse);var t=document.querySelectorAll("#draggable_zone");t.length&&t.forEach((function(t){w.default.create(t,{group:"draggable_zone",animation:150,filter:".undraggable",draggable:".draggable",handle:".my_handle",onEnd:function(t){var n=e.props,a=n.value,r=n.onChange,i=t.newIndex,l=t.oldIndex;if(i!==l){var o=a.filter((function(e){return"left"===e.fixed})),c=a.filter((function(e){return"right"===e.fixed})),u=(0,S.ZP)(a.filter((function(e){return!e.fixed})),(function(e){var t=e.splice(l,1)[0];e.splice(i,0,t)}));r&&r([].concat(o,u,c))}}})}))},n.componentWillUnmount=function(){window.removeEventListener("click",this._setShowFalse)},n.render=function(){var e=this,t=this.state,n=t.show,a=t.leftOpts,r=t.normalOpts,i=t.rightOpts,l=this.props,o=l.className,c=l.title;return u.createElement("div",{className:"yt_columns_selector_wrapper "+(o||""),onClick:this._handleParentClick},u.createElement("div",{className:"trigger "+(n?"sel":""),onClick:this._handleOnTriggerClick},c||"\u5217",u.createElement("i",{className:"icon-cem_arrow-launches",style:{transform:n?"rotate(-180deg)":""}})),u.createElement("div",{className:"options "+(n?"active":"")},a.length>0&&u.createElement(u.Fragment,null,u.createElement("div",{className:"opt_label"},"\u56fa\u5b9a\u5728\u5de6\u4fa7"),a.map((function(t){return e._renderOptionItem(t,!1,"\u4e0d\u56fa\u5b9a",e._handleOnCancelFixedClick,"\u56fa\u5b9a\u5728\u5217\u5c3e",e._handleOnFixedRightClick)}))),(a.length>0||i.length>0)&&u.createElement("div",{className:"opt_label"},"\u4e0d\u56fa\u5b9a"),u.createElement("div",{id:"draggable_zone",style:{visibility:r.length>0}},r.map((function(t){return e._renderOptionItem(t,!0,"\u56fa\u5b9a\u5728\u5217\u5934",e._handleOnFilxedLeftClick,"\u56fa\u5b9a\u5728\u5217\u5c3e",e._handleOnFixedRightClick)}))),i.length>0&&u.createElement(u.Fragment,null,u.createElement("div",{className:"opt_label"},"\u56fa\u5b9a\u5728\u53f3\u4fa7"),i.map((function(t){return e._renderOptionItem(t,!1,"\u4e0d\u56fa\u5b9a",e._handleOnCancelFixedClick,"\u56fa\u5b9a\u5728\u5217\u5934",e._handleOnFilxedLeftClick)})))))},t}(u.PureComponent);const x=O;O.propTypes={className:m().string,title:m().string,value:m().arrayOf(m().shape({label:m().string,prop:m().string,fixed:m().string,checked:m().bool})),onChange:m().func};var T,P,Z=n(35239),I=["data","total","loading","savedKey","pageIndex","pageSize","onPageChange","onPageSizeChange","className"],R=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnResize=function(){var e=document.querySelector(".yt-listview-wrapper");e&&n.setState({tableWidth:e.clientWidth-5})},n._handleOnColumnsChange=function(e){n.setState({columns:e},(function(){n.props.savedKey&&function(e){return b.apply(this,arguments)}({projectId:Z.t.get(Z.V.curProject).id,key:n.props.savedKey,value:JSON.stringify(e.map((function(e){return{prop:e.prop,checked:e.checked,fixed:e.fixed}})))}).then((function(e){e.data}))}))},n.handleRoKey=function(e){var t=n.props.rowKeyProp;return t&&e&&e[t]?e[t]:JSON.stringify(e)},n.state={talbeWidth:0,columns:t.columns||[],loadingSave:!0},n}(0,l.Z)(t,e),t.getDerivedStateFromProps=function(e,t){};var n=t.prototype;return n.componentDidMount=function(){var e=this;window.addEventListener("resize",c()(this._handleOnResize,150)),this._handleOnResize();var t=this.props,n=t.savedKey,a=t.columns;n&&function(e){return _.apply(this,arguments)}({projectId:Z.t.get(Z.V.curProject).id,key:n}).then((function(t){var n,i=t.data;if(2e4===i.code)try{n=a.map((function(e,t){var n=JSON.parse(i.result).filter((function(t){var n=t.prop;return e.prop===n}));return n&&n.length>0?(0,r.Z)({},e,n[0]):e})).filter((function(e){return e}))}catch(l){}finally{e.setState({columns:n||e.state.columns,loadingSave:!1})}}))},n.componentWillUnmount=function(){window.removeEventListener("resize",this._handleOnResize)},n.componentDidUpdate=function(e,t){var n=this;JSON.stringify(e.columns)!==JSON.stringify(this.props.columns)&&this.props.columns.length>0&&this.setState({columns:this.props.columns.reduce((function(e,t,a){var i=n.state.columns.findIndex((function(e){var n=e.prop;return t.prop===n}));return e.splice(i>-1?i:a,0,(0,r.Z)({},t,n.state.columns[i])),e}),[]).filter((function(e){return e}))})},n.render=function(){var e=this.props,t=e.data,n=e.total,i=void 0===n?0:n,l=e.loading,o=e.savedKey,c=e.pageIndex,p=e.pageSize,d=e.onPageChange,m=e.onPageSizeChange,f=e.className,v=void 0===f?"":f,y=(0,a.Z)(e,I),C=this.state,E=C.columns,_=C.loadingSave;return u.createElement(g.Z,{data:t,className:"yt-listview-wrapper "+v,loading:o&&_||l},(0,g.P)(t)&&u.createElement(u.Fragment,null,u.createElement(s.Table,(0,r.Z)({},y,{columns:o?this.columns:this.props.columns,data:t,rowKey:this.handleRoKey})),d&&u.createElement(h,{onPageChange:d,onSizeChange:m,total:i,currLength:t.length,pageIndex:c,pageSize:p}),o&&u.createElement(x,{className:"column_selector",value:E,savedKey:o,onChange:this._handleOnColumnsChange})))},(0,i.Z)(t,[{key:"columns",get:function(){var e=this.state,t=e.tableWidth,n=e.columns,a=this.props,r=a.columnRenders,i=void 0===r?{}:r,l=a.headerRenders,o=void 0===l?{}:l,c=a.prefixColumns,u=0,s=0,p=0,d=[].concat(void 0===c?[]:c,JSON.parse(JSON.stringify(n.filter((function(e){var t=e.checked;return void 0===t||t})))));if(d.forEach((function(e){p+=e.width,e.fixed?u+=e.width:s+=e.width;var t=i[e.prop];t&&(e.render=t);var n=o[e.prop];n&&(e.renderHeader=n)})),t>p){var m=t-u;d.forEach((function(e){void 0!==e.checked&&!e.checked||e.fixed||(e.width=e.width/s*m)}))}return d}}]),t}(u.PureComponent);R.propTypes={className:m().string,savedKey:m().string.isRequired,rowKeyProp:m().string,data:m().any.isRequired,total:m().number,fixedHeight:m().bool,loading:m().bool,pageIndex:m().number,pageSize:m().number,onPageChange:m().func,onPageSizeChange:m().func,columnRenders:m().shape((T={},T[m().string]=m().func,T)),headerRenders:m().shape((P={},P[m().string]=m().func,P)),prefixColumns:m().arrayOf(m().shape({label:m().string,prop:m().string,fixed:m().oneOf(["","left","right"]),width:m().number,checked:m().bool})),columns:m().arrayOf(m().shape({label:m().string,prop:m().string,fixed:m().oneOf(["","left","right"]),width:m().number,checked:m().bool})).isRequired};const L=R}}]);