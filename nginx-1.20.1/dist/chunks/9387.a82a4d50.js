"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[9387],{87771:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Z});var a=n(63366),i=n(87462),s=n(94578),r=n(67294),o=n(55815),c=n(61918),u=n(92360),p=n(35239),l=n(23279),d=n.n(l),m=n(2271),f=n(43036);const h=function(e){var t=e.data,n=e.detailList,a=e.onChooseSpu,i=e.onChooseSku,s=e.keywordSku,o=e.keywordSpu;return r.createElement("div",{className:"product_setting_edit_left_wrap"},r.createElement("div",{className:"top"},r.createElement(f.Z,{overlay:r.createElement("div",{style:{maxWidth:260},onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},onMouseUp:function(){s&&document.querySelector(".product_setting_edit_left_wrap")&&document.querySelector(".product_setting_edit_left_wrap").click(),s&&i(""),a(window.getSelection().toString().trim())}},t.name),placement:"top"},r.createElement("div",{className:"title",onClick:function(){return window.open(""+t.url)}},t.name)),r.createElement("div",{className:"content_item"},n.map((function(e){return r.createElement("div",{className:"product",key:e.id},r.createElement("span",null,e.name),r.createElement("div",{onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},e.values.map((function(e,t){return r.createElement("span",{key:e.name,onMouseUp:function(){o&&document.querySelector(".product_setting_edit_left_wrap")&&document.querySelector(".product_setting_edit_left_wrap").click(),o&&a(""),i(window.getSelection().toString().trim())},className:(0===t&&"checked")+" "+(e.offShelf&&"closed")},e.name)}))))})))))};var g=n(17190),k=n(35303),v=n(29257);const y=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnSelectChange=function(e,t,a){var i;if(e&&e.length){var s,r=e[e.length-1];if(n.state["topicValue"+t].find((function(e){return e.value===r})))n.setState(((s={})["value"+a.id]=[r],s["id"+a.id]=n.state["topicValue"+t].find((function(e){return e.value===r})).id,s));else n.props.fetchAddTopicValue({value:r,topicId:a.id}).then((function(e){var t;2e4===e.code&&n.setState(((t={})["value"+a.id]=[r],t["id"+a.id]=e.result,t))}))}!e.length&&n.setState(((i={})["value"+a.id]=void 0,i))},n.getValue=function(){var e=n.state,t=e.spu,a=e.sku,i=e.spuName,s=e.skuName,r=e.topicList,o=e.packageType,c=[];return r.forEach((function(e){n.state["value"+e.id]&&c.push({id:e.id,name:n.state["id"+e.id]})})),{spuId:t,skuId:a,spuName:i,skuName:s,customizeConfig:c,packageType:o}},n.state={spu:t.data.spuId,spuName:null,sku:t.data.skuId,skuName:null,spuTip:t.spuTip,skuTip:t.skuTip,topicList:t.topicList,oddMaxLeng:0,evenMaxLeng:0,packageType:t.data.packageType&&"null"!==t.data.packageType?t.data.packageType:v.$[0].id},n}(0,s.Z)(t,e);var n=t.prototype;return n.setTopicList=function(e,t,n,a){var i=this;this.setState({topicList:[].concat(t.spuTitle.map((function(e,t){return{id:e,name:e,values:n&&i.props.spuList.find((function(e){return e.id===n}))?JSON.parse(i.props.spuList.find((function(e){return e.id===n})).config)[e]:""}})),t.skuTitle.map((function(e,t){return{id:e,name:e,values:a&&i.props.skuList.find((function(e){return e.id===a}))?JSON.parse(i.props.skuList.find((function(e){return e.id===a})).config)[e]:""}})),e)})},n.componentDidMount=function(){var e=this;this.props.data.spuName===this.state.spuName&&this.props.data.skuName===this.state.skuName||this.setState({spu:this.props.data.spuId,spuName:this.props.data.spuName,sku:this.props.data.skuId,skuName:this.props.data.skuName},(function(){e.setTopicList(e.props.topicList,e.props.data,e.props.data.spuId,e.props.data.skuId),setTimeout((function(){if(e.state.topicList){var t=e.state.topicList.filter((function(e,t){return t%2===0})).map((function(e){return e.name.length})),n=e.state.topicList.filter((function(e,t){return t%2!==0})).map((function(e){return e.name.length}));e.setState({oddMaxLeng:Math.max.apply(Math,t)>6?6:Math.max.apply(Math,t),evenMaxLeng:Math.max.apply(Math,n)>6?6:Math.max.apply(Math,n)})}}),0)}))},n.componentDidUpdate=function(e,t){var n=this,a=e.data,i=e.spuTip,s=e.skuTip,r=this.props,o=r.data,c=r.topicList,u=r.spuTip,p=r.skuTip,l=r.topicOpts,d=t.spuName,m=t.skuName,f=this.state,h=f.spuName,g=f.skuName,k=f.spu,y=f.sku;JSON.stringify(i)!==JSON.stringify(u)?this.setState({spuTip:u.substring(0,8)}):JSON.stringify(s)!==JSON.stringify(p)&&this.setState({skuTip:p.substring(0,8)}),JSON.stringify(d)===JSON.stringify(h)&&JSON.stringify(m)===JSON.stringify(g)||this.setTopicList([].concat(this.props.topicList.filter((function(e){return"\u5e73\u53f0"===e.id})),this.props.topicList.filter((function(e){return"\u5e97\u94fa\u7c7b\u578b"===e.id})),this.props.topicList.filter((function(e){return"\u5e97\u94fa"===e.id}))),o,k,y),JSON.stringify(a)!==JSON.stringify(o)&&this.setState({spu:o.spuId,spuName:o.spuName,sku:o.skuId,skuName:o.skuName,spuTip:"",skuTip:"",packageType:o.packageType?o.packageType:v.$[0].id},(function(){l&&l.forEach((function(e,t){var a;n.setState(((a={})["value"+e.id]=void 0,a))})),n.setTopicList(c,o,k,y)})),l&&l.forEach((function(a,i){var s;n.props["topicValue"+i]&&JSON.stringify(e["topicValue"+i]!==JSON.stringify(n.props["topicValue"+i]))&&n.setState(((s={})["topicValue"+i]=n.props["topicValue"+i],s));JSON.stringify(t["value"+a.id])===JSON.stringify(n.state["value"+a.id])&&JSON.stringify(d)===JSON.stringify(h)&&JSON.stringify(m)===JSON.stringify(g)||n.setTopicList([].concat(n.props.topicList.filter((function(e){return"\u5e73\u53f0"===e.id})),n.props.topicList.filter((function(e){return"\u5e97\u94fa\u7c7b\u578b"===e.id})),n.props.topicList.filter((function(e){return"\u5e97\u94fa"===e.id})),l.map((function(e){return{id:e.id,name:e.name,values:e.id===a.id&&n.state["value"+a.id]&&n.state["value"+e.id]?n.state["value"+a.id][0]:n.state["value"+e.id]?n.state["value"+e.id][0]:""}}))),o,k,y)}))},n.render=function(){var e=this,t=this.props,n=t.spuList,a=t.skuList,i=t.topicOpts,s=t.onFocus,o=t.keywordSpu,c=t.spuShow,u=t.keywordSku,l=t.skuShow,d=this.state,m=d.spu,f=d.spuName,h=d.sku,y=d.spuTip,S=d.skuTip,N=d.topicList,E=d.oddMaxLeng,T=d.evenMaxLeng,_=d.packageType,I=p.t.get(p.V.curProject).notShowTopicList;return r.createElement("div",{className:"product_setting_edit_right_wrap"},r.createElement("div",{className:"top"},r.createElement("div",{className:"spu_sku_base"},r.createElement("span",null,"SPU\u8bcd\u6761"),r.createElement("div",null,n&&r.createElement(g.Z,{show:c,onChange:function(t){e.setState({spu:t.id,spuName:t.name,spuSplit:t.split})},trigger:"click",data:n,value:m,onTipClick:function(){y&&e.setState({spuTip:""}),s()},addText:"\u521b\u5efaSPU\u8bcd\u6761",onAddClick:function(){window.open("/account/project/base?drawerVisible=true")},className:y?"content-error":"",keyword:o}),y&&r.createElement("span",{className:"content-error-hint"},y))),r.createElement("div",{className:"spu_sku_base"},r.createElement("span",null,"SKU\u8bcd\u6761"),r.createElement("div",null,a&&r.createElement(g.Z,{show:l,onChange:function(t){e.setState({sku:t.id,skuName:t.name,skuSplit:t.split})},trigger:"click",data:m?a.filter((function(e){return e.parentId===m})):a,value:h,onTipClick:function(){S&&e.setState({skuTip:""}),s()},addText:"\u521b\u5efaSKU\u8bcd\u6761",disabled:!m,onAddClick:function(){window.open("/account/project/base/sku?spuId="+m+"&spuName="+f+"&drawerVisible=true")},className:S?"content-error":"",keyword:u}),S&&r.createElement("span",{className:"content-error-hint"},S))),!(I&&I.includes("PACKAGE_TYPE"))&&r.createElement("div",{className:"spu_sku_base"},r.createElement("span",null,"\u9500\u552e\u7248\u672c"),r.createElement("div",null,v.$&&r.createElement(g.Z,{onChange:function(t){e.setState({packageType:t.name})},trigger:"click",data:v.$,value:_})))),r.createElement("div",{className:"middle"},r.createElement("div",{className:"title"},r.createElement("h4",null,"\u81ea\u5b9a\u4e49\u4e3b\u9898"),r.createElement("i",{className:"icon-cem_collection-settings",onClick:function(){window.open("/account/project/linkTopic?open=true")}})),r.createElement("div",{className:"topic_content"},i&&i.map((function(t,n){return r.createElement("div",{className:"item",key:t.id},r.createElement("span",{className:"ellipsis"},t.name),r.createElement(k.RS,{tags:!0,multiple:!1,onChange:function(a){e._handleOnSelectChange(a,n,t)},value:e.state["value"+t.id],optionLabelProp:"label",optionFilterProp:"label",placeholder:"\u8bf7\u9009\u62e9\u6216\u8005\u8f93\u5165"},e.state["topicValue"+n]&&e.state["topicValue"+n].map((function(e){return r.createElement(k.Wx,{key:e.id,value:e.value,label:e.value},e.value)}))))})))),r.createElement("div",{className:"bottom"},r.createElement("h4",null,"\u4e3b\u9898\u503c\u603b\u89c8"),r.createElement("div",null,r.createElement("div",{className:"topic_value_content"},N&&N.map((function(e,t){return r.createElement("span",{key:e.id},r.createElement("span",{className:"name",style:{width:t%2===0?12*E+16+"px":12*T+16+"px"}},e.name),r.createElement("span",{className:"value",style:{width:t%2===0?190-12*E-16-32+"px":190-12*T-16-32+"px"}},e.values))}))))))},t}(r.PureComponent);var S=n(55609),N=n(5133),E=n(64396),T=E.Z.product.setting.subscribe.recycling,_={visible:!1,esId:"",id:"",nextId:"",topicList:[],isNext:!0,data:{spuName:"",skuName:""},detailList:[],spuTip:"",skuTip:"",keywordSpu:"",spuShow:!1,keywordSku:"",skuShow:!1},I=function(e){function t(t){var n;return(n=e.call(this,t)||this).show=function(e){var t=e.id,a=e.esId,i=e.nextId,s=e.nextEsId,r=e.topicList,o=e.data,c=e.detailList;n.setState({visible:!0,id:t,nextId:i,nextEsId:s,topicList:r,data:o,detailList:c,esId:a})},n._handleOnOk=function(){n._handleOnCancel()},n._handleOnCancel=function(){n.setState({visible:!1})},n._handleOnAddIgnore=function(e){var t=n.state,a=(t.id,t.isNext),s=t.nextId,r=t.nextEsId,o=t.data,c=t.esId,u=n.props,p=u.dataList,l=u.total,d=u.keyword,m=u.pageIndex,f=u.pageSize,h=u.topicOpts;if("add"===e){if(!n.contentRef.getValue().spuId)return void n.setState({spuTip:"\u8bf7\u9009\u62e9SPU\u8bcd\u6761"+(new Date).getTime()});if(!n.contentRef.getValue().skuId)return void n.setState({skuTip:"\u8bf7\u9009\u62e9SKU\u8bcd\u6761"+(new Date).getTime()});n.props.fetchEdit((0,i.Z)({connectionId:o.id,esId:c,name:o.name,url:o.url,sourceId:o.sourceId},n.contentRef.getValue()))}var g=n.contentRef.getValue().spuId,k=n.contentRef.getValue().spuName;a?s?(n.setState({id:s,esId:r}),n.props.fetchDetail({connectionId:s}).then((function(t){2e4===t.data.code&&n.props.fetchLinkList({searchTitleWord:d}).then((function(a){var r=a.findIndex((function(e){return e.id===s}));a.length&&n.setState({data:(0,i.Z)({},a.find((function(e){return e.id===s})),{spuId:"add"===e&&!a.find((function(e){return e.id===s})).spuId&&g?g:a.find((function(e){return e.id===s})).spuId,spuName:"add"===e&&!a.find((function(e){return e.id===s})).spuId&&g?k:a.find((function(e){return e.id===s})).spuName}),topicList:[{id:"\u5e73\u53f0",name:"\u5e73\u53f0",values:a.find((function(e){return e.id===s})).sourceName},{id:"\u5e97\u94fa\u7c7b\u578b",name:"\u5e97\u94fa\u7c7b\u578b",values:a.find((function(e){return e.id===s})).shopType},{id:"\u5e97\u94fa",name:"\u5e97\u94fa",values:a.find((function(e){return e.id===s})).shopName}].concat(h.map((function(e){return{id:e.id,name:e.name,values:""}}))),detailList:t.data.result,nextId:r!==a.length-1?a[r+1].id:"",nextEsId:r!==a.length-1?a[r+1].esId:""})}))}))):l>p.length&&m!==Math.ceil(l/f)?n.props.fetchLinkList({searchTitleWord:d,pageIndex:m+1}).then((function(t){if(t.length){var a=t[0].id,s=t[0].esId;n.setState({id:a,esId:s}),n.props.fetchDetail({connectionId:a}).then((function(a){2e4===a.data.code&&n.setState({data:(0,i.Z)({},t[0],{spuId:"add"===e&&!t[0].spuId&&g?g:t[0].spuId,spuName:"add"===e&&!t[0].spuId&&g?k:t[0].spuName}),topicList:[{id:"\u5e73\u53f0",name:"\u5e73\u53f0",values:t[0].sourceName},{id:"\u5e97\u94fa\u7c7b\u578b",name:"\u5e97\u94fa\u7c7b\u578b",values:t[0].shopType},{id:"\u5e97\u94fa",name:"\u5e97\u94fa",values:t[0].shopName}].concat(h.map((function(e){return{id:e.id,name:e.name,values:""}}))),detailList:a.data.result,nextId:t[1]?t[1].id:"",nextEsId:t[1]?t[1].nextEsId:""})}))}})):(N.Z.error("\u5f53\u524d\u5df2\u662f\u6700\u540e\u4e00\u4e2a\u5546\u54c1"),setTimeout((function(){n.props.fetchLinkList({searchTitleWord:d}),n._handleOnCancel()}),100)):setTimeout((function(){n.props.fetchLinkList({searchTitleWord:d,pageIndex:1}),n._handleOnCancel()}),100)},n._handleOnNextChange=function(e){n.setState({isNext:e})},n._handleOnChooseSpu=function(e){var t=n.state,a=t.spuShow;t.skuShow;n.setState({keywordSpu:e,spuShow:!a,skuShow:!1})},n._handleOnChooseSku=function(e){var t=n.state,a=t.skuShow;t.spuShow;n.setState({keywordSku:e,skuShow:!a,spuShow:!1})},n.state=(0,i.Z)({},Object.assign({},_)),n}return(0,s.Z)(t,e),t.prototype.render=function(){var e=this,t=this.state,n=t.visible,a=t.isNext,s=t.topicList,o=t.data,c=t.detailList,p=t.spuTip,l=t.skuTip,d=t.keywordSpu,m=t.spuShow,f=t.keywordSku,g=t.skuShow,k=this.props,v=k.spuList,S=k.skuList,N=k.topicOpts;return n?r.createElement(u.Dialog,{className:"yt_product_setting_recycling_edit_dialog_wrapper",title:"\u5546\u54c1\u94fe\u63a5\u4e3b\u9898\u7ef4\u62a4",size:"tiny",visible:n,onCancel:function(){e.setState({visible:!1})},lockScroll:!0},r.createElement(u.Dialog.Body,null,r.createElement("div",{style:{display:"flex"}},r.createElement(h,{data:o,detailList:c,onChooseSpu:function(t){return e._handleOnChooseSpu(t)},onChooseSku:function(t){return e._handleOnChooseSku(t)},keywordSku:f,keywordSpu:d}),r.createElement(y,(0,i.Z)({ref:function(t){return e.contentRef=t},data:o,spuList:v,skuList:S,topicList:s,spuTip:p,skuTip:l,topicOpts:N,keywordSpu:d,spuShow:m,keywordSku:f,skuShow:g},this.props)))),r.createElement(u.Dialog.Footer,null,r.createElement(u.Checkbox,{checked:a,onChange:this._handleOnNextChange},"\u4e0b\u4e00\u5546\u54c1"),r.createElement(u.Button,{type:"primary",onClick:function(){return e._handleOnAddIgnore("add")}},"\u6dfb\u52a0"))):null},t}(r.PureComponent);const L=(0,S.connect)((function(e){var t=(0,i.Z)({},e),n=t[T],a=n.skuList,s=n.spuList,r=n.dataList,o=n.pageIndex,c=n.searchTitleWord,u=n.total,p=n.topicOpts;return(0,i.Z)({},t[T],{skuList:a,spuList:s,dataList:r,pageIndex:o,keyword:c,total:u,topicOpts:p})}),(function(e){return{fetchLinkList:function(t){return e({type:T+"/fetchLinkList",payload:t})},fetchDetail:function(t){return e({type:T+"/fetchDetail",payload:t})},fetchEdit:function(t){return e({type:T+"/fetchEdit",payload:t})},fetchTopicOpts:function(t){return e({type:T+"/fetchTopicOpts",payload:t})},fetchAddTopicValue:function(t){return e({type:T+"/fetchAddTopicValue",payload:t})}}}),null,{withRef:!0})(I);var w=n(97189);const C=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnAddIgnore=function(e){var t=n.state,a=t.spu,i=t.spuName,s=t.sku,r=t.skuName,o=a||e.spuId,c=s||e.skuId;o?c?(n.props.onEdit({spuName:i||e.spuName,skuName:r||e.skuName,spuId:o,skuId:c,esId:e.esId,name:e.name,url:e.url,sourceId:e.sourceId,connectionId:e.id,isList:!0}),setTimeout((function(){n.setState({spu:0,sku:0,spuName:"",skuName:""})}),0)):n.setState({skuTip:"\u8bf7\u9009\u62e9SKU\u8bcd\u6761"}):n.setState({spuTip:"\u8bf7\u9009\u62e9SPU\u8bcd\u6761"})},n._handleOnEdit=function(e){var t=n.props.data,a=t.findIndex((function(t){return t.id===e.id}));n.props.fetchDetail({connectionId:e.id}).then((function(i){2e4===i.data.code&&n.props.fetchTopicOpts().then((function(s){s.forEach((function(e,t){n.props.fetchTopicValue({topicId:e.id,projectId:p.t.get(p.V.curProject).id}).then((function(e){var a;2e4===e.data.code&&n.props.save(((a={})["topicValue"+t]=e.data.result.result,a))}))})),n.editModalRef.wrappedInstance.show({id:e.id,esId:e.esId,nextEsId:a!==t.length-1?t[a+1].esId:"",nextId:a!==t.length-1?t[a+1].id:"",data:e,topicList:[{id:"\u5e73\u53f0",name:"\u5e73\u53f0",values:e.sourceName},{id:"\u5e97\u94fa\u7c7b\u578b",name:"\u5e97\u94fa\u7c7b\u578b",values:e.shopType},{id:"\u5e97\u94fa",name:"\u5e97\u94fa",values:e.shopName}].concat(s.map((function(e){return{id:e.id,name:e.name,values:""}}))),detailList:i.data.result})}))}))},n.state={spuTip:"",skuTip:""},n.columns=[{label:"\u5546\u54c1\u8be6\u60c5\u9875\u6807\u9898",prop:"name",width:280,fixed:"",checked:!0},{label:"SPU\u8bcd\u6761",prop:"spuName",width:220,fixed:"",checked:!0},{label:"SKU\u8bcd\u6761",prop:"skuName",width:220,fixed:"",checked:!0},{label:"\u64cd\u4f5c",prop:"control",width:120,fixed:"right",checked:!0}],n.prefixColumns=[{fixed:"left",label:"",width:16}],n.columnRenders={name:function(e){return r.createElement(f.Z,{overlay:r.createElement("div",{style:{maxWidth:260}},e.name,r.createElement("div",{style:{color:"#8c8c8c"},dangerouslySetInnerHTML:{__html:""+(e.urlTopics?Object.values(JSON.parse(e.urlTopics)).join("&nbsp;"):"")}})),placement:"top"},r.createElement("div",{className:"setting_name_wrap"},r.createElement("div",{className:"name",onClick:function(){window.open(""+e.url)}},e.name),r.createElement("div",{className:"ellipsis",dangerouslySetInnerHTML:{__html:""+(e.urlTopics?Object.values(JSON.parse(e.urlTopics)).join("&nbsp;"):"")}})))},spuName:function(e){var t=n.state,a=t.spu,i=t.spuTip,s=n.props,o=s.firstId,c=s.spuList,u=s.onFocus;return e.id===o?r.createElement("div",{className:"entry_select_wrap"},r.createElement(g.Z,{onChange:function(e){n.setState({spu:e.id,spuName:e.name})},className:i?"content-error":"",trigger:"hover",data:c,value:a,onTipClick:function(){i&&n.setState({spuTip:""}),u()},defaultValue:e.spuId,addText:"\u521b\u5efaSPU\u8bcd\u6761",onAddClick:function(){window.open("/account/project/base?drawerVisible=true")}}),i&&r.createElement("span",{className:"content-error-hint"},i)):r.createElement("span",null,e.spuName)},skuName:function(e){var t=n.state,a=t.spu,i=t.spuName,s=t.sku,o=t.skuTip,c=n.props,u=c.firstId,p=c.skuList,l=c.onFocus;return e.id===u?r.createElement("div",{className:"entry_select_wrap"},r.createElement(g.Z,{onChange:function(e){n.setState({sku:e.id,skuName:e.name})},className:o?"content-error":"",trigger:"hover",data:a?p.filter((function(e){return e.parentId===a})):e.spuId?p.filter((function(t){return t.parentId===e.spuId})):p,value:s,onTipClick:function(){o&&n.setState({skuTip:""}),l()},defaultValue:e.skuId,addText:"\u521b\u5efaSKU\u8bcd\u6761",disabled:!e.spuId&&!a,onAddClick:function(){window.open("/account/project/base/sku?spuId="+(a||e.spuId)+"&spuName="+(i||e.spuName)+"&drawerVisible=true")}}),o&&r.createElement("span",{className:"content-error-hint"},o)):r.createElement("span",null,e.skuName)},control:function(e){var t=n.props.firstId;return r.createElement("div",{className:"control"},r.createElement("span",{onClick:function(){return e.id===t?n._handleOnAddIgnore(e):n._handleOnEdit(e)}},"\u6dfb\u52a0"))}},n}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){setTimeout((function(){var e=document.querySelector(".yt_product_setting_subscribe_recycling_wrapper .el-table__body-wrapper"),t=document.querySelectorAll(".yt_product_setting_subscribe_recycling_wrapper .ets-option-panel");e&&t&&e.addEventListener("mouseleave",d()((function(){t.forEach((function(e){(0,w.removeClass)(e,"ets-show")}))}),300))}),0)},n.render=function(){var e=this,t=this.props,n=t.data,a=t.total,i=t.pageIndex,s=t.pageSize,o=t.loading,c=t.className,u=t.onPageChange,p=t.onPageSizeChange,l=t.onFocus;return r.createElement(r.Fragment,null,r.createElement(m.Z,{savedKey:"product_setting_subscribe_recycling",total:a,pageIndex:i,pageSize:s,className:c,prefixColumns:this.prefixColumns,data:n,loading:o,columns:this.columns,columnRenders:this.columnRenders,onPageChange:u,onPageSizeChange:p}),r.createElement(L,{ref:function(t){return e.editModalRef=t},onFocus:l}))},t}(r.PureComponent);var O=function(e){var t=e.title;return[{title:p.t.get(p.V.backProjectConfig).name,url:"/account/project/preview"},{title:t,url:"/account/project/"+location.pathname.split("/")[3]+"/subscribe"},{title:"\u667a\u80fd\u8ba2\u9605",url:"/account/project/"+location.pathname.split("/")[3]+"/subscribe",state:{type:"SubscribeOverview"}},{title:"\u56de\u6536\u7ad9"}]};const b=function(e){var t=e.loading,n=e.searchTitleWord,a=e.skuList,i=e.spuList,s=e.dataList,p=e.pageIndex,l=e.pageSize,d=e.total,m=e.firstId,f=e.onFilterChange,h=e.onPageChange,g=e.onPageSizeChange,k=e.onEdit,v=e.fetchDetail,y=e.fetchTopicOpts,S=e.fetchTopicValue,N=e.save,E=e.onFocus,T=e.location;return r.createElement("div",{className:"yt_product_setting_subscribe_recycling_wrapper"},r.createElement(o.Z,{title:O({title:"comment"===T.pathname.split("/")[3]?"\u7535\u5546\u8bc4\u8bba":"\u7535\u5546\u76d1\u63a7"})}),r.createElement("div",{className:"content"},r.createElement("div",{className:"table_content_wrap"},r.createElement("div",{className:"top_zone"},r.createElement(c.Z,{onSearch:function(e){return f({searchTitleWord:e})},onClear:function(e){return f({searchTitleWord:e})},placeholder:"\u641c\u7d22\u5546\u54c1\u6807\u9898",defValue:n,style:{width:168}})),s?r.createElement(C,{className:"list_content_wrap",loading:t,data:s,skuList:a,spuList:i,pageIndex:p,pageSize:l,total:d,firstId:m,onChange:f,onPageChange:h,onPageSizeChange:g,onEdit:k,fetchDetail:v,fetchTopicOpts:y,fetchTopicValue:S,save:N,onFocus:E}):r.createElement(u.Loading,{loading:t,style:{height:"100%"}}))))};var x=["loading"],P=E.Z.product.setting.subscribe.recycling,V=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnFocus=function(){var e=n.props,t=e.spuList,a=e.skuList,i=p.t.get(p.V.newEntry)||{},s=i.spuName,r=i.skuName,o=i.spuId,c=i.skuId;(s&&!t.find((function(e){return s.includes(e.name.replaceAll(e.split,"").replaceAll("|",""))}))||r&&!a.find((function(e){return r.includes(e.name.replaceAll(e.split,"").replaceAll("|",""))}))||o&&!t.find((function(e){return String(e.id)===String(o)}))||c&&!a.find((function(e){return String(e.id)===String(c)})))&&n.props.fetchEntryOpts({projectId:p.t.get(p.V.curProject).id,id:1})},n._handleOnEdit=function(e){n.props.fetchEdit(e)},n._handleOnFilterChange=function(e){void 0!==e.searchTitleWord&&n.props.fetchLinkList({searchTitleWord:e.searchTitleWord,pageIndex:1})},n._handleOnPageChange=function(e){var t=n.props,a=t.searchTitleWord;(0,t.fetchLinkList)({pageIndex:e,searchTitleWord:a})},n._handleOnPageSizeChange=function(e){var t=n.props,a=t.searchTitleWord;(0,t.fetchLinkList)({pageSize:e,pageIndex:1,searchTitleWord:a})},n.state={},n.event={onFilterChange:n._handleOnFilterChange,onPageChange:n._handleOnPageChange,onPageSizeChange:n._handleOnPageSizeChange,onEdit:n._handleOnEdit,onFocus:n._handleOnFocus},t.save({connectionType:t.location.pathname.includes("/price")?"PRICE":"DEFAULT"}),n}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.fetchEntryOpts({projectId:p.t.get(p.V.curProject).id})},n.componentWillUnmount=function(){this.props.clean()},n.render=function(){return r.createElement(b,(0,i.Z)({},this.props,this.state,this.event))},t}(r.PureComponent);const Z=(0,S.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,x);return(0,i.Z)({},n[P],{loading:t.effects[P+"/fetchLinkList"]||!1})}),(function(e){return{save:function(t){return e({type:P+"/save",payload:t})},clean:function(t){return e({type:P+"/clean",payload:t})},fetchLinkList:function(t){return e({type:P+"/fetchLinkList",payload:t})},fetchDetail:function(t){return e({type:P+"/fetchDetail",payload:t})},fetchEntryOpts:function(t){return e({type:P+"/fetchEntryOpts",payload:t})},fetchEdit:function(t){return e({type:P+"/fetchEdit",payload:t})},fetchTopicOpts:function(t){return e({type:P+"/fetchTopicOpts",payload:t})},fetchTopicValue:function(t){return e({type:P+"/fetchTopicValue",payload:t})},fetchAddTopicValue:function(t){return e({type:P+"/fetchAddTopicValue",payload:t})}}}))(V)},55815:(e,t,n)=>{n.d(t,{Z:()=>p});var a=n(94578),i=n(67294),s=n(45697),r=n.n(s),o=n(43036),c=n(61409),u=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))||this)._handleBreadcrumbClick=function(e){var n=t.props,a=n.title,i=n.beforeJump;e!==a.length-1&&(i?new Promise((function(e,t){return i(e,t)})).then((function(){c.mW.push({pathname:a[e].url,state:a[e].state})})):c.mW.push({pathname:a[e].url,state:a[e].state}))},t}return(0,a.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.mainTitle,s=t.rightContent,r=t.className,c=t.overlay;return i.createElement("div",{className:"breadcumb-wrapper "+r},n instanceof Array?i.createElement("div",{className:"breadcrumb-left"},i.createElement("div",null,n.map((function(t,a){return i.createElement("span",{className:t.url?"":"not_clickable",key:a,onClick:function(){return t.url&&a!==n.length-1&&e._handleBreadcrumbClick(a)}},t.title,a!==n.length-1&&" / ")}))),i.createElement("span",null,a||n[n.length-1].title,c&&i.createElement(o.Z,{placement:"top",overlay:c},i.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}})))):i.createElement("div",{className:"normal-title"},n,c&&i.createElement(o.Z,{placement:"top",overlay:c},i.createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c",marginLeft:8}}))),s||"")},t}(i.Component);u.propTypes={className:r().string,title:r().oneOfType([r().string,r().arrayOf(r().shape({title:r().string,url:r().string,state:r().object}))]).isRequired,overlay:r().oneOfType([r().string,r().node]),mainTitle:r().oneOfType([r().string,r().node]),beforeJump:r().func,rightContent:r().node};const p=u}}]);