"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[9706],{88332:(e,t,n)=>{n.d(t,{Z:()=>y});var a=n(87462),r=n(63366),i=(n(62713),n(14321)),l=(n(15267),n(64713)),s=n(94578),c=n(64396),o=n(55609),u=n(87219),d=n(30381),p=n.n(d),f=n(67294),h=n(70339),m=["loading"],g=c.Z.IDBHeaderScreening.quickTimeScreening,v="YYYY/MM/DD",C=function(e){function t(t){var n;(n=e.call(this,t)||this)._handleOnQuickDateChange=function(e){var t,a=e.target.value,r=n.props,i=r.type,l=r.dateFilter,s=r.nowDate;if("week"!==a&&"month"!==a)n.setState({analyzeDate:(0,h.vc)(e.target.value,v,s)[0]+" ~ "+(0,h.vc)(e.target.value,v,s)[1]}),t=(0,u.ZP)(l,(function(t){t.from=(0,h.vc)(e.target.value,"YYYY-MM-DD",s)[0],t.numOfDays=(0,h.vv)((0,h.vc)(e.target.value,"YYYY-MM-DD",s),"YYYY-MM-DD"),t.quickChoice=h.YM.find((function(e){return e.value===a})).label,t.to=(0,h.vc)(e.target.value,"YYYY-MM-DD",s)[1],t.date=a}));else if("week"===a){var c=p()().format("E");n.setState({analyzeDate:p()().subtract(c-1,"days").format(v)+" ~ "+p()().add(7-c,"days").format(v)}),n.props.save({dateValue:p()()}),t=(0,u.ZP)(l,(function(e){e.from=p()().subtract(c-1,"days").format("YYYY-MM-DD"),e.numOfDays=(0,h.vv)([p()().subtract(c-1,"days").format("YYYY-MM-DD"),p()().add(7-c,"days")],"YYYY-MM-DD"),e.quickChoice=p()().subtract(c-1,"days").format("YYYY.MM.DD")+" - "+p()().add(7-c,"days").format("YYYY.MM.DD"),e.to=p()().add(7-c,"days").format("YYYY-MM-DD"),e.date=a}))}else"month"===a&&(n.setState({analyzeDate:p()().startOf("month").format(v)+" ~ "+p()().endOf("month").format(v)}),n.props.save({dateValue:p()()}),t=(0,u.ZP)(l,(function(e){e.from=p()().startOf("month").format("YYYY-MM-DD"),e.numOfDays=(0,h.vv)([p()().startOf("month").format("YYYY-MM-DD"),p()().endOf("month").format("YYYY-MM-DD")],"YYYY-MM-DD"),e.quickChoice=p()().startOf("month").format("YYYY.MM.DD")+" - "+p()().endOf("month").format("YYYY.MM.DD"),e.to=p()().endOf("month").format("YYYY-MM-DD"),e.date=a})));n.props.save({date:a,dateFilter:t}),n.props.setDefaultValue({key:"default-time-"+i,value:JSON.stringify(t)}),setTimeout((function(){n.props.onChange()}),0)},n._handleOnDateChange=function(e,t){var a,r=n.props,i=r.date,l=r.type,s=r.dateFilter;if("week"===i){var c=p()(e).format("E");n.setState({analyzeDate:p()(e).subtract(c-1,"days").format(v)+" ~ "+p()(e).add(7-c,"days").format(v)}),a=(0,u.ZP)(s,(function(t){t.from=p()(e).subtract(c-1,"days").format("YYYY-MM-DD"),t.numOfDays=(0,h.vv)([p()(e).subtract(c-1,"days").format("YYYY-MM-DD"),p()(e).add(7-c,"days").format("YYYY-MM-DD")],"YYYY-MM-DD"),t.quickChoice=p()(e).subtract(c-1,"days").format("YYYY.MM.DD")+" - "+p()(e).add(7-c,"days").format("YYYY.MM.DD"),t.to=p()(e).add(7-c,"days").format("YYYY-MM-DD")}))}else"month"===i&&(n.setState({analyzeDate:p()(t).startOf("month").format(v)+" ~ "+p()(t).endOf("month").format(v)}),a=(0,u.ZP)(s,(function(e){e.from=p()(t).startOf("month").format("YYYY-MM-DD"),e.numOfDays=(0,h.vv)([p()(t).startOf("month").format("YYYY-MM-DD"),p()(t).endOf("month").format("YYYY-MM-DD")],"YYYY-MM-DD"),e.quickChoice=p()(t).startOf("month").format("YYYY.MM.DD")+" - "+p()(t).endOf("month").format("YYYY.MM.DD"),e.to=p()(t).endOf("month").format("YYYY-MM-DD")})));n.props.setDefaultValue({key:"default-time-"+l,value:JSON.stringify(a)}),n.props.save({dateFilter:a,dateValue:p()(e)}),setTimeout((function(){n.props.onChange()}),0)};var a=t.dateFilter,r=t.nowDate;return n.state={analyzeDate:a&&a.date?"week"===a.date||"month"===a.date?p()(a.from).format(v)+" ~ "+p()(a.to).format(v):(0,h.vc)(a.date,v,r)[0]+" ~ "+(0,h.vc)(a.date,v,r)[1]:(0,h.vc)("7",v)[0]+" ~ "+(0,h.vc)("7",v,r)[1]},n}(0,s.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){var t=e.dateFilter,n=(e.date,e.dateValue,this.props),a=n.dateFilter,r=(n.date,n.dateValue,n.nowDate);JSON.stringify(t)!==JSON.stringify(a)&&a&&this.setState({analyzeDate:"week"===a.date||"month"===a.date?p()(a.from).format(v)+" ~ "+p()(a.to).format(v):(0,h.vc)(a.date,v,r)[0]+" ~ "+(0,h.vc)(a.date,v,r)[1]})},n.render=function(){var e=this.props,t=e.date,n=e.dateValue,a=this.state.analyzeDate;return f.createElement("div",{className:"filter_quick_date_wrapper"},f.createElement("span",{className:"time"},"\u7edf\u8ba1\u65f6\u95f4\uff1a ",a),f.createElement(l.default.Group,{value:t,onChange:this._handleOnQuickDateChange},h.YM.map((function(e){return f.createElement(l.default.Button,{value:e.value,key:e.value},e.label)}))),f.createElement(i.default,{allowClear:!1,value:n,onChange:this._handleOnDateChange,format:"week"===t?"YYYY/wo":"YYYY/MM",placeholder:"\u8bf7\u9009\u62e9\u65f6\u95f4",className:"filter_quick_date",size:"small",picker:"week"===t||"month"===t?t:"month",disabled:"week"!==t&&"month"!==t,suffixIcon:f.createElement("i",{className:"icon-cem_pull-down-or-take-up",style:{fontSize:"16px",color:"#8c8c8c"}})}))},t}(f.PureComponent);const y=(0,o.connect)((function(e){e.loading;var t=(0,r.Z)(e,m);return(0,a.Z)({},t[g])}),(function(e){return{save:function(t){return e({type:g+"/save",payload:t})},clean:function(){return e({type:g+"/clean"})},setDefaultValue:function(t){return e({type:g+"/setDefaultValue",payload:t})}}}))(C)},35103:(e,t,n)=>{n.d(t,{Z:()=>Re});var a=n(63366),r=n(87462),i=n(94578),l=n(55609),s=n(45697),c=n.n(s),o=n(64396),u=n(67294),d=(n(9405),n(89552)),p=(n(15267),n(64713)),f=n(84910),h=n(5133),m=n(92360),g=n(43036),v=n(35239),C=(n(7940),n(31059)),y=(n(62713),n(14321)),S=n(30381),k=n.n(S),E=n(18784),N=y.default.RangePicker;const w=function(e){function t(t){var n;return(n=e.call(this,t)||this).formatStr=function(){return n.state.isShowTime?"YYYY/MM/DD HH:mm:ss":"YYYY/MM/DD"},n.formatStrVal=function(){return n.state.isShowTime?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD"},n.disabledDate=function(e){return e&&e>k()().endOf("day")},n.onDateChange=function(e,t){n.setState({date:t.every((function(e){return""!==e}))?t:void 0})},n.handleCheckboxChange=function(e){var t=n.state.date,a=e.target.checked&&t&&t[0]&&!E.Sz.test(t[0])?t[0]+" 00:00:00":void 0,r=e.target.checked&&t&&t[1]&&!E.Sz.test(t[1])?t[1]+" 23:59:59":void 0;n.setState({isShowTime:e.target.checked}),a&&r&&n.setState({date:[a,r]})},n.state={isShowTime:t.isShowTime||!1,date:t.defaultDate||void 0},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){var t=e.defaultDate,n=this.props.defaultDate;JSON.stringify(t)!==JSON.stringify(n)&&n&&this.setState({date:n,isShowTime:E.Sz.test(n[0])&&E.Sz.test(n[1])})},n.getCurrDate=function(){var e=this.state.date;if(e&&e.length){var t=[k()(e[0]).format(this.formatStrVal()),k()(e[1]).format(this.formatStrVal())],n=(0,E.p6)(2,t,this.formatStrVal()),a=(0,E.vv)(t,this.formatStrVal());return{from:this.state.isShowTime?t[0]:t[0]+" 00:00:00",to:this.state.isShowTime?t[1]:t[1]+" 23:59:59",quickChoice:n,dateGroupType:"DAY",numOfDays:a,remoteName:"cTime",currSelector:1}}},n.render=function(){var e=this,t=this.state,n=t.date,a=t.isShowTime,r=this.props.className;return u.createElement("div",{className:"time_range_picker_wrapper "+r,style:{width:a?450:562}},u.createElement(N,{getPopupContainer:function(e){return e.parentNode},className:"filter_time_picker",disabledDate:this.disabledDate,format:this.formatStr(),showTime:a,onChange:this.onDateChange,value:n&&n[0]&&n[1]&&n&&n.length?[k()(n[0],this.formatStr()),k()(n[1],this.formatStr())]:null,dropdownClassName:"filter_time_picker_content_wrap",open:!0}),u.createElement("div",{className:"detail-time-select"},u.createElement(C.default,{checked:a,onChange:function(t){return e.handleCheckboxChange(t)}},"\u9009\u62e9\u65f6\u95f4")))},t}(u.PureComponent);var D=n(97189),F=["loading"],V=o.Z.IDBHeaderScreening.timeScreening,_=function(e){function t(t){var n;return(n=e.call(this,t)||this)._resetStyle=function(){setTimeout((function(){n.dateContentRef&&(n.dateContentRef.style.display="date"!==n.state.show?"none":"block",n.dateContentRef.style.right="-1px",n.dateContentRef.style.top="30px")}),0)},n.handleClickQuickTime=function(e){var t=n.props,a=t.staredQuickTimeChoice,i=t.type,l=t.changeFilter,s=t.hasHour;n.setState({quickTime:(0,E.A$)(s)[e]});var c=n.state.formatStr,o=(0,E.B9)(e,c,s);n.props.save({selectedQuickTimeChoice:e,selectedDateRange:o});var u={module:i,currSelector:0,selectedQuickTimeChoice:e,staredQuickTimeChoice:a,value:[]};n.props.setDefaultValue({key:"default-time-"+i,projectId:v.t.get(v.V.curProject).id,value:JSON.stringify(u)}),o.length>0?n.setState({params:null,show:null},(function(){var e;n.props.save({dateFilter:n.getCurrDate()}),setTimeout((function(){n.props.onChange(n.getCurrDate())}),0);var t=v.t.getWidthProject(v.V.messageDateFilter);v.t.setWidthProject(v.V.messageDateFilter,(0,r.Z)({},t,((e={})[n.props.type]=n.getCurrDate(),e))),l("date"),n._resetStyle()})):h.Z.error("\u8bf7\u9009\u62e9\u65f6\u95f4\u8303\u56f4")},n.getCurrDate=function(){var e=n.state,t=(e.currSelector,e.params),a=e.formatStr,r=n.props,i=r.selectedDateRange,l=r.selectedQuickTimeChoice,s=(r.changeFilter,r.hasHour),c=(0,E.vv)(i,a);return{from:i[0],to:i[1],quickChoice:t&&t.quickChoice.indexOf("-")>-1?t.quickChoice:(0,E.A$)(s)[l],dateGroupType:"DAY",numOfDays:c,remoteName:"cTime",currSelector:0}},n.clickRangeConfirmBtn=function(){var e=n.props,t=e.staredQuickTimeChoice,a=e.dateFilter,i=t>-1?a:v.t.getWidthProject(v.V.messageDateFilter)&&v.t.getWidthProject(v.V.messageDateFilter)[n.props.type]?v.t.getWidthProject(v.V.messageDateFilter)[n.props.type]:void 0;if(i&&(-1===i.quickChoice.indexOf("-")?n.setState({quickTime:i.quickChoice}):n.setState({quickTime:""})),n.rangeDatePicker.getCurrDate()){var l=[n.rangeDatePicker.getCurrDate().from,n.rangeDatePicker.getCurrDate().to];n.props.save({selectedDateRange:l,selectedQuickTimeChoice:n.rangeDatePicker.getCurrDate().quickChoice}),l.length>0&&n.setState({params:null,show:null,quickTime:i?n.rangeDatePicker.state.isShowTime||!n.rangeDatePicker.state.isShowTime&&n.rangeDatePicker.getCurrDate().from.split(" ")[0]!==i.from||!n.rangeDatePicker.state.isShowTime&&n.rangeDatePicker.getCurrDate().to.split(" ")[0]!==i.to?"":i.quickChoice:""},(function(){var e;n.props.save({dateFilter:n.rangeDatePicker.getCurrDate()}),setTimeout((function(){n.props.onChange(n.rangeDatePicker.getCurrDate())}),0);var t=v.t.getWidthProject(v.V.messageDateFilter);v.t.setWidthProject(v.V.messageDateFilter,(0,r.Z)({},t,((e={})[n.props.type]=n.rangeDatePicker.getCurrDate(),e))),n.props.changeFilter("date"),n._resetStyle()}))}else h.Z.error("\u8bf7\u9009\u62e9\u65f6\u95f4\u8303\u56f4")},n.clickStarIcon=function(e,t){e.stopPropagation();var a=n.props.staredQuickTimeChoice,r=n.props,i=r.selectedQuickTimeChoice,l=r.type;if(a!==t){if(-1!==a){var s=document.querySelectorAll(".left_time ul li")[a].children[1];(0,D.removeClass)(s,"star"),s.style.display="none"}a=t,(0,D.addClass)(e.target.parentNode,"star")}else a=-1,(0,D.removeClass)(e.target.parentNode,"star");n.setState({staredQuickTimeChoice:a}),n.props.save({staredQuickTimeChoice:a});var c={module:l,currSelector:0,selectedQuickTimeChoice:i,staredQuickTimeChoice:a,value:[]};n.props.setDefaultValue({key:"default-time-"+l,projectId:v.t.get(v.V.curProject).id,value:JSON.stringify(c)})},n.state={show:t.show,currSelector:0,params:t.params,formatStr:"YYYY-MM-DD HH:mm:ss",quickTime:t.quickTime||null},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props;(0,e.save)({selectedQuickTimeChoice:e.hasHour?11:8}),this.dateContentRef&&(this.dateContentRef.style.display="block",this.dateContentRef.style.right="9999px",this.dateContentRef.style.top="-9999px")},n.componentDidUpdate=function(e,t){var n=e.quickTime,a=e.show,r=this.props,i=r.quickTime,l=r.show;JSON.stringify(n)!==JSON.stringify(i)&&this.setState({quickTime:i}),JSON.stringify(a)!==JSON.stringify(l)&&this._resetStyle()},n.componentWillUnmount=function(){},t.getDerivedStateFromProps=function(e,t){return e.show!==t.show?{show:e.show}:JSON.stringify(e.params)!==JSON.stringify(t.params)?{params:e.params}:null},n.fetchDefaultValue=function(){var e=this.props.type,t=this.state,n=t.params,a=t.formatStr;this.props.getDefaultValue({key:"default-time-"+e,params:n,formatStr:a,defaultValue:v.t.getWidthProject(v.V.messageDateFilter)&&v.t.getWidthProject(v.V.messageDateFilter)[e]||void 0,projectId:v.t.get(v.V.curProject).id})},n.render=function(){var e=this,t=this.state,n=t.show,a=t.quickTime,r=this.props,i=(r.selectedDateRange,r.selectedQuickTimeChoice),l=r.staredQuickTimeChoice,s=r.save,c=r.changeFilter,o=r.dateFilter,d=r.hasHour,p=r.filterDateFilter,f=[],h=!0,v=o;return p&&(v=p),v&&(/\-/.test(v.quickChoice)&&(h=!1),(0,E.A$)(d).map((function(e,t){e===v.quickChoice&&(f=E.Sz.test(v.from.trim())&&E.Sz.test(v.to.trim())?[v.from.split("-").join("/"),v.to.split("-").join("/")]:(0,E.B9)(t,"YYYY/MM/DD HH:mm:ss",d))}))),u.createElement("div",{className:"filter_date_picker_wrapper "+("date"!==n?"":"active"),onClick:function(e){e.stopPropagation()}},"date"!==n?u.createElement(g.Z,{overlay:u.createElement("div",{style:{minWidth:116,textAlign:"center"}},v?h?u.createElement("div",null,f[0],u.createElement("br",null)," to ",u.createElement("br",null),f[1]):u.createElement("div",null,""+v.from.split("-").join("/")," ",u.createElement("br",null),"to ",u.createElement("br",null),""+v.to.split("-").join("/")):""),align:{offset:[1,6]},placement:"bottomRight",mouseEnterDelay:.7},u.createElement("div",{className:"filter_date_trigger",onClick:function(){c("date"),e._resetStyle()}},u.createElement("span",{className:"filter_date_time"},u.createElement("i",{className:"icon-cem_time-controller"}),u.createElement("span",{style:{marginLeft:8,verticalAlign:"top"}},a&&!d?a:o?o.quickChoice.indexOf("-")>-1?o.quickChoice.split("-")[0].trim().split(".").join("/")+"~"+o.quickChoice.split("-")[1].trim().split(".").join("/"):o.quickChoice:"")))):u.createElement("div",{className:"filter_date_trigger",onClick:function(){c("date"),e._resetStyle()}},u.createElement("span",{className:"filter_date_time"},u.createElement("i",{className:"icon-cem_time-controller"}),u.createElement("span",{style:{marginLeft:8,verticalAlign:"top"}},a&&!d?a:o?o.quickChoice.indexOf("-")>-1?o.quickChoice.split("-")[0].trim().split(".").join("/")+"~"+o.quickChoice.split("-")[1].trim().split(".").join("/"):o.quickChoice:""))),u.createElement("div",{className:"time_picker_wrap",ref:function(t){return e.dateContentRef=t}},u.createElement("div",{className:"time_picker_content"},u.createElement("div",{className:"right_picker"},o?u.createElement(w,{ref:function(t){return e.rangeDatePicker=t},defaultDate:o.quickChoice.indexOf("-")>-1?[o.quickChoice.split("-")[0].replaceAll(".","-").trim(),o.quickChoice.split("-")[1].replaceAll(".","-").trim()]:[o.from,o.to],currSelector:1,save:s,isShowTime:o.quickChoice.indexOf("-")>-1&&E.Sz.test(o.quickChoice.split("-")[0].replaceAll(".","-").trim())&&E.Sz.test(o.quickChoice.split("-")[1].replaceAll(".","-").trim())}):null),u.createElement("div",{className:"left_time"},u.createElement("ul",{className:"quick_date_wrap"},(0,E.A$)(d).map((function(t,n){return u.createElement("li",{key:n,onClick:function(){return e.handleClickQuickTime(n)},className:E.ld.includes(t)?"left_li":"right_li"},u.createElement("span",{className:i===n?"active":""},t),u.createElement(g.Z,{className:"time_picker_star_tooltip",placement:"top",overlay:l===n?"\u53d6\u6d88\u9ed8\u8ba4":"\u8bbe\u4e3a\u9ed8\u8ba4",mouseEnterDelay:.6},u.createElement("span",{className:l===n?"star":"",onClick:function(t){return e.clickStarIcon(t,n)}},u.createElement("i",{className:"icon-cem icon-cem_star"}))))}))))),u.createElement("div",{className:"time_picker_footer"},u.createElement("div",null),u.createElement("div",{style:{display:"flex"}},u.createElement(m.Button,{type:"default",onClick:function(){c("date"),e._resetStyle()}},"\u53d6\u6d88"),u.createElement(m.Button,{type:"primary",onClick:this.clickRangeConfirmBtn},"\u67e5\u8be2")))))},t}(u.PureComponent);const O=(0,l.connect)((function(e){e.loading;var t=(0,a.Z)(e,F);return(0,r.Z)({},t[V])}),(function(e){return{save:function(t){return e({type:V+"/save",payload:t})},getDefaultValue:function(t){return e({type:V+"/getDefaultValue",payload:t})},setDefaultValue:function(t){return e({type:V+"/setDefaultValue",payload:t})},clean:function(t){return e({type:V+"/clean",payload:t})},cleanQuickTime:function(t){return e({type:V+"/cleanQuickTime",payload:t})}}}),null,{withRef:!0})(_);_.propTypes={show:c().bool,changeFilter:c().func,onChange:c().func,params:c().object,filterDateFilter:c().object};var b=n(43144),Y=n(97326),M=function(e){return void 0===e&&(e=""),e.length>16?e.substring(0,15)+"...":e},T=function(e){function t(t){var n;return(n=e.call(this,t)||this).sortList=function(e,t,a){a.stopPropagation(),a.nativeEvent.stopImmediatePropagation();var r=JSON.parse(JSON.stringify(n.state.value)),i=r.splice(e,1)[0];switch(t){case"top":r.unshift(i);break;case"up":r.splice(e-1,0,i);break;case"down":r.splice(e+1,0,i)}n.setState({value:r},(function(e){return n.props.onChange&&n.props.onChange(n.getValue())}))},n.state={value:t.defaultChecks||[],searchWord:""},n}(0,i.Z)(t,e);var n=t.prototype;return n.onSel=function(e,t){var n=this.state.value;(n=JSON.parse(JSON.stringify(n))).map((function(e){return e.id})).includes(t.id)?n.splice(n.findIndex((function(e){return e.id===t.id})),1):n.push(t),this.props.maxSelect&&n.length>this.props.maxSelect?h.Z.warning("\u6700\u591a\u9009\u62e9"+this.props.maxSelect+"\u4e2a\u5bf9\u8c61\uff01"):this.setState({value:n})},n.getValue=function(){return this.state.value},n.render=function(){var e=this,t=this.props,n=t.options,a=t.defaultChecks,r=t.maxSelect,i=t.onCancel,l=t.onChange,s=t.disabledValue,c=t.showList,o=t.show,d=this.state,p=d.value,f=d.searchWord,h=a.map((function(e){return e.id})),g=p.map((function(e){return e.id})),v=n.filter((function(e){return!h.includes(e.id)})),C=a.filter((function(e){return!f||-1!==(e.label||"").toLocaleLowerCase().indexOf(f.trim().toLocaleLowerCase())})),y=v.filter((function(e){return!f||-1!==(e.label||"").toLocaleLowerCase().indexOf(f.trim().toLocaleLowerCase())}));return u.createElement("div",{className:"filter-sort-select-trend",style:{display:o?"block":"none",left:c.includes("fullDate")?0:"-214px"}},u.createElement("div",{className:"selItem "+(this.props.triangle?"triangle":""),onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},u.createElement("div",{className:"wrap"},u.createElement("div",{className:"title_name"},"\u6dfb\u52a0\u5c55\u793a",u.createElement("span",null,"\uff08\u6700\u591a"+r+"\u4e2a\uff0c\u5df2\u6dfb\u52a0"+p.length+"\u4e2a\uff09")),u.createElement("div",null,u.createElement(m.Input,{value:f,placeholder:"\u8bf7\u8f93\u5165\u5173\u952e\u8bcd",className:"search",size:"small",icon:f?"close":"search",onChange:function(t){return e.setState({searchWord:t})},onIconClick:function(){return e.setState({searchWord:""})}})),u.createElement("ul",null,C.map((function(t,n){return u.createElement("li",{className:(g.includes(t.id)?"sel":"")+(t.disable?" disable":""),key:n,onClick:function(n){!s.includes(t.id)&&e.onSel(n,t)}},u.createElement(m.Checkbox,{className:"check-all",checked:g.includes(t.id),disabled:s.includes(t.id)||!g.includes(t.id)&&p.length>=r,onChange:function(n){return s.includes(t.id)?"":e.onSel(n,t)}},u.createElement("span",null,M(t.label))))})),y.slice(0,100-C.length).map((function(t,n){return u.createElement("li",{className:(g.includes(t.id)?"sel":"")+(t.disable?" disable":""),key:n,onClick:function(n){return e.onSel(n,t)}},u.createElement(m.Checkbox,{className:"check-all",checked:g.includes(t.id),onChange:function(n){return e.onSel(n,t)},disabled:!g.includes(t.id)&&p.length>=r},u.createElement("span",{className:"dark"},M(t.label))))})),C.length+y.length>100?u.createElement("li",{style:{color:"#d96969"}},"\u6570\u503c\u5c55\u793a\u4e0d\u8d85\u8fc7100\u6761\uff0c\u67e5\u770b\u66f4\u591a\u8bf7\u641c\u7d22"):null,0===C.length&&0===y.length&&u.createElement("div",{className:"noData"},"\u6ca1\u6709\u76f8\u5173\u9009\u9879"))),u.createElement("div",{className:"line"}),u.createElement("div",{className:"control"},u.createElement("div",null,u.createElement(m.Button,{type:"",onClick:i},"\u53d6\u6d88"),u.createElement(m.Button,{type:"primary",onClick:function(){return l(p)}},"\u786e\u5b9a")))))},t}(u.Component);T.propTypes={options:c().array,value:c().array,onChange:c().func,show:c().bool,onCancel:c().func,maxSelect:c().number};var L=n(39432),I=function(e){function t(t){var n;return(n=e.call(this,t)||this).getPanelWidth=function(){var e=n.props,t=e.showFlavor,a=void 0!==t&&t,r=e.options,i=Math.max.apply(null,r.map((function(e){return(0,L.jD)(e.title,14)})))+2+24+25;return(i+=a?24:0)>100?i:100},n.setHoverDisable=function(){n.setState({disableHover:!0}),setTimeout((function(){return n.setState({disableHover:!1})}),100)},n.state={disableHover:!1,firstLiHover:!1,panelWidth:n.getPanelWidth()},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){window.addEventListener("click",this._setPadShowFalse)},n.componentWillUnmount=function(){window.removeEventListener("click",this._setPadShowFalse)},n.componentDidUpdate=function(e){var t=e.options,n=this.props.options;JSON.stringify(t)!==JSON.stringify(n)&&this.setState({panelWidth:this.getPanelWidth()})},n.render=function(){var e=this,t=this.state,n=t.panelWidth,a=t.disableHover,r=this.props,i=r.activeObj,l=void 0===i?"":i,s=r.onChange,c=r.options,o=r.objName,d=r.preTitle,p=r.sufTitle,f=void 0===p?"":p,h=r.showTitle,m=void 0===h||h,v=r.overlay,C=(r.flavor,r.onFlavorChange,r.showFlavor,r.collectValue,r.updateCollectValue,c.find((function(e){return e.value===l}))),y=""===l?f:C&&C.title;return u.createElement("div",{className:"fast-single-select-button-wrapper",onClick:this._handleParentClick,style:{pointerEvents:a?"none":""}},u.createElement("div",{className:"button_content"},u.createElement("span",{onClick:this._handleTriggerOnClick},u.createElement("span",{className:"button-trigger"},m&&u.createElement(u.Fragment,null,d&&u.createElement("span",{className:"pre-title"},d,"\uff1a"),u.createElement("span",{className:"button-title"},y)),u.createElement("i",{className:"icon-cem_arrow-launches"})),v&&u.createElement("span",{style:{marginLeft:4}},u.createElement(g.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:v},u.createElement("i",{className:"icon-cem_file1"})))),u.createElement("div",{className:"button-panel",style:{minWidth:n,top:a?"-1000px":""}},c.map((function(t,n){return u.createElement("div",{className:"panel-item "+(t.value===l?"sel":"")+" "+(t.disabled?"disabled":""),key:t.value,onClick:function(){var n;e.setHoverDisable(),!t.disabled&&t.value!==l&&s(o?((n={})[o]=t.value,n):t.value)}},t.title)})))))},t}(u.PureComponent);I.propTypes={activeObj:c().any,onChange:c().func.isRequired,options:c().array.isRequired,objName:c().any,preTitle:c().string,sufTitle:c().string,showTitle:c().bool,overlay:c().string,showFlavor:c().bool,flavor:c().string,onFlavorChange:c().func};var A=n(51474),P=n(18446),Z=n.n(P),x=function(e){return document.querySelector(e)};const R=function(e){function t(t){var n;return(n=e.call(this,t)||this).defaultIsSelectAllChange=function(){var e=JSON.parse(JSON.stringify(n.props)).defaultConfig,t=(0,Y.Z)(n).curFast;e.defaultChecked.forEach((function(n){n.id===t.id&&(e.defaultNumberChecked>1?n.isSelectAll=!n.isSelectAll:n.isSelectAll||(n.isSelectAll=!n.isSelectAll))})),n.props.defaultValueChange({value:{defaultChecked:e.defaultChecked}}).then((function(){n.props.onSearch()}))},n.defaultChecksNameChange=function(e){n.props.defaultValueChange({value:{defaultChecksName:[e]}}).then((function(){n.props.onSearch()}))},n.defaultCheckedChange=function(e,t){var a=JSON.parse(JSON.stringify(n.props)).defaultConfig,r=a.defaultNumberChecked,i=(0,Y.Z)(n),l=i.curFast,s=i.curFastShowList,c=JSON.parse(JSON.stringify(l.values)),o=l.isSelectAll;if("add"===e)if(1===r)c=[t],"boolean"===typeof o&&(o=!1);else{var u=[];c.push(t),s.forEach((function(e){return c.forEach((function(t){return t===e.id&&u.push(t)}))})),c=u}else if("del"===e){if(1===c.length)return void h.Z.warning("\u81f3\u5c11\u4fdd\u7559\u4e00\u4e2a\u9009\u9879");c.splice(c.indexOf(t),1)}a.defaultChecked.forEach((function(e){e.id===l.id&&(e.values=c,e.isSelectAll=o)})),n.props.defaultValueChange({value:{defaultChecked:a.defaultChecked}}).then((function(){n.props.onSearch()}))},n.defaultChecksChange=function(e,t){var a=JSON.parse(JSON.stringify(n.curFastShowList)),r=JSON.parse(JSON.stringify(n.props)).defaultConfig;"add"===e?a.push(t):"del"===e?a.splice(a.findIndex((function(e){return e.id===t.id})),1):"replace"===e&&(a=t),r.defaultChecks.forEach((function(e){e.id===n.curFast.id&&(e.values=a)})),n.props.defaultValueChange({value:{defaultChecks:r.defaultChecks}})},n.clickListener=function(e){n.setState({showSelector:!1})},n.getWidth=function(){if(x(".header_Filter_bar .fast_filter_aspectTrend .name")){var e=x(".header_Filter_bar").offsetWidth-Array.from(x(".header_Filter_bar").children).filter((function(e){return"fast_filter_aspectTrend"!==e.className})).reduce((function(e,t){return e+t.offsetWidth}),0)-x(".header_Filter_bar .fast_filter_aspectTrend .name").offsetWidth-40-28-32-(n.props.showList.includes("sourceSearch")?44:0)-50;n.setState({maxWidth:e})}},n.state={showSelector:!1,maxWidth:500},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;window.addEventListener("click",this.clickListener),window.addEventListener("resize",this.getWidth),this.getWidth(),setTimeout((function(){e.getWidth()}),2e3),new A.default(document.querySelector(".fast_wrap"),{sort:!0,animation:150,ghostClass:"blue-background-class",draggable:".fast_block",onEnd:function(t){var n=t.oldIndex,a=t.newIndex,r=JSON.parse(JSON.stringify(e.props)).defaultConfig,i=e.curFast,l=e.curFastShowList,s=JSON.parse(JSON.stringify(l)),c=s.splice(n,1)[0];s.splice(a,0,c),r.defaultChecks.forEach((function(e){e.id===i.id&&(e.values=s)}));var o={defaultChecks:r.defaultChecks};Z()(i.values,s.filter((function(e){return i.values.includes(e.id)})).map((function(e){return e.id})))||(r.defaultChecked.forEach((function(e){e.id===i.id&&(e.values=[],s.forEach((function(t){i.values.forEach((function(n){t.id===n&&e.values.push(n)}))})))})),o.defaultChecked=r.defaultChecked),e.props.defaultValueChange({value:o}).then((function(){return o.defaultChecked&&e.props.onSearch()}))}})},n.componentWillUnmount=function(){window.removeEventListener("click",this.clickListener),window.removeEventListener("resize",this.getWidth)},n.render=function(){var e=this,t=this.props,n=t.defaultConfig,a=t.screeningList,r=t.showList,i=t.show,l=this.state,s=l.showSelector,c=l.maxWidth,o=this.curFast,d=this.curFastShowList,p=o.isSelectAll,f=(n.defaultChecked,n.defaultChecksName),h=void 0===f?[]:f,m=n.defaultNumberChecked,g=n.defaultNumberConfig,v=a.map((function(e){return e.data})).flat(1).filter((function(e){return e.id===h[0]})).length?a.map((function(e){return e.data})).flat(1).filter((function(e){return e.id===h[0]}))[0]:{};return u.createElement("div",{className:"fast_filter_aspectTrend"},u.createElement("div",{className:"name"},"boolean"===typeof p&&u.createElement("div",{className:"select_all "+(p?"select":""),onClick:this.defaultIsSelectAllChange},u.createElement("span",null,"\u5168\u90e8"))),u.createElement("div",{className:"fast_wrap",style:{maxWidth:c,marginLeft:"boolean"===typeof p?8:0}},d.map((function(t){return u.createElement("span",{key:t.id,className:"fast_block "+(o.values.includes(t.id)&&!p?"select":"")+" "+(o.values.length>=m&&1!==m?"disabled":"")+" ",onClick:function(){return(o.values.length<m||o.values.includes(t.id)||1===m)&&e.defaultCheckedChange(o.values.includes(t.id)&&!p?"del":"add",t.id)}},u.createElement("span",{title:t.label},t.label),u.createElement("i",{className:"icon-cem_cancel",onClick:function(n){n.stopPropagation(),e.defaultChecksChange("del",t)}}))}))),u.createElement("div",{className:"add",onClick:function(t){t.stopPropagation(),e.setState({showSelector:!s}),e.props.changeFilter("fastScreening")}},u.createElement("span",null,"+"),s&&u.createElement(T,{show:i,showList:r,options:v.options,defaultChecks:d,onChange:function(t){e.setState({showSelector:!1}),e.defaultChecksChange("replace",t)},disabledValue:o.values,maxSelect:g,onCancel:function(){return e.setState({showSelector:!1})}})))},(0,b.Z)(t,[{key:"curFast",get:function(){var e=this.props.defaultConfig;return e.defaultChecked.find((function(t){return t.id===e.defaultChecksName[0]}))||{}}},{key:"curFastShowList",get:function(){var e=this.props.defaultConfig;return(e.defaultChecks.find((function(t){return t.id===e.defaultChecksName[0]}))||{}).values||[]}}]),t}(u.Component);var j=n(60496),q=function(e){return document.querySelector(e)},W=[{title:"\u6a21\u7cca\u641c\u7d22",value:"FUZZY_SEARCH"},{title:"\u7cbe\u786e\u641c\u7d22",value:"PRECISE_SEARCH"}],J=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnWindowResize=function(){if(q(".multi_word_input_wrap")){var e=q(".multi_word_input_wrap").parentNode,t=e.offsetWidth;if(q(".multi_word_input_wrap")){var a=e.childNodes,r=0,i=0;a.forEach((function(e){"multi_word_input_wrap"!==e.className&&("header_Filter_right_wrap"===e.className&&(i=e.childNodes.length),r+=e.offsetWidth)})),n.setState({contentWidth:t-r-12-8*(i-1)-48-24})}}},n.inputChange=function(e){n.setState({inputVal:e.target.value})},n.keywordChange=function(e){var t=n.state,a=t.inputVal,i=t.inputValMap,l=t.searchVal;"keydown"===e.type&&32===e.keyCode&&a.trim()&&(i.length<5?i.find((function(e){return e.trim()===a.trim()}))||(i.push(a.trim()),n.setState((0,r.Z)({},l,{inputValMap:i,inputVal:""}),(function(e){return n.onChange(!1)}))):h.Z.warning("\u6700\u591a\u641c\u7d225\u4e2a\u5173\u952e\u8bcd\uff0c\u8d85\u8fc7\u7684\u5173\u952e\u8bcd\u4e0d\u641c\u7d22")),"keydown"===e.type&&13===e.keyCode&&a.trim()&&(i.length<5?i.find((function(e){return e.trim()===a.trim()}))||(i.push(a.trim()),n.setState((0,r.Z)({},l,{inputValMap:i,inputVal:""}),(function(e){return n.onChange(!0)}))):h.Z.warning("\u6700\u591a\u641c\u7d225\u4e2a\u5173\u952e\u8bcd\uff0c\u8d85\u8fc7\u7684\u5173\u952e\u8bcd\u4e0d\u641c\u7d22")),n._handleOnWindowResize()},n.delKeyWords=function(e){var t=n.state,a=t.inputValMap,r=t.searchVal;a.splice(e,1),n.setState({inputValMap:a,searchVal:r},(function(e){return n.onChange(!0)}))},n.onChange=function(e){n.props.onChange&&n.props.onChange(n.state.inputValMap,n.state.searchVal,e)},n.onSearchChange=function(e){n.setState({searchVal:e},(function(){n.state.inputValMap&&n.state.inputValMap.length&&n.onChange(!0)}))},n.handleOnClose=function(){var e=n.state.searchVal;n.setState({inputValMap:[],searchVal:e},(function(e){return n.onChange(!0)}))},n.state={inputValMap:t.values?t.values:[],inputVal:"",searchVal:t.queryType||"FUZZY_SEARCH",contentWidth:500},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;window.addEventListener("resize",this._handleOnWindowResize),this._handleOnWindowResize(),setTimeout((function(){e._handleOnWindowResize()}),2e3)},n.componentWillUnmount=function(){window.removeEventListener("resize",this._handleOnWindowResize)},n.UNSAFE_componentWillReceiveProps=function(e,t){e.queryType&&this.setState({searchVal:e.queryType}),e.values&&this.setState({inputValMap:e.values})},n.render=function(){var e=this,t=this.state,n=t.inputValMap,a=t.inputVal,r=t.searchVal,i=t.contentWidth,l=this.props,s=(l.style,l.close);l.onChange;return u.createElement("div",{className:"multi_word_input_wrap",style:{maxWidth:i}},s&&u.createElement("i",{className:"close",onClick:s},"\xd7"),u.createElement(j.Z,{options:W,activeObj:r,onChange:this.onSearchChange,divider:"none",sufIcon:"icon-cem_pull-down-or-take-up",className:"keyword_select"}),u.createElement("div",{className:"input-wrap"},u.createElement("input",{type:"text",className:"keyword-setting",value:a,placeholder:"\u591a\u4e2a\u5173\u952e\u8bcd\u8bf7\u7528\u7a7a\u683c\u5206\u9694\uff0c\u6309\u56de\u8f66\u641c\u7d22",onChange:this.inputChange,onBlur:this.keywordChange,onKeyDown:this.keywordChange}),n.length>0&&u.createElement("i",{className:"icon-cem_log-off",onClick:this.handleOnClose})),u.createElement("div",{style:{display:"flex",maxWidth:"calc(100% - 12px - 324px)",overflowY:"hidden",alignItems:"center"}},n.map((function(t,n){return u.createElement("span",{className:"word "+(0!==n?"FUZZY_SEARCH"===r?"word_blur":"word_exact":""),key:t+n},u.createElement("span",{title:t},t),u.createElement("i",{onClick:function(){return e.delKeyWords(n)}},"\xd7"))}))))},t}(u.Component);const H=J;J.propTypes={values:c().array,queryType:c().string,onChange:c().func};var z=function(e){return e&&e[0]?{values:e[0].contain?JSON.parse(JSON.stringify(e[0].contain)):void 0,queryType:e[0].queryType}:{}},B=function(e,t){return[{contain:JSON.parse(JSON.stringify(e)),queryType:t}]},U=n(88332),Q=n(57522),K=n(23570),G=n(49722),$=120,X=function(e){var t=e.projectId,n=e.name,a=e.id,r=e.type,i=e.copy,l=e.selected,s=e.setParams,c=u.useState(n||""),o=c[0],d=c[1],p=u.useState(!0),f=p[0],m=p[1],g=u.useState(""),v=g[0],C=g[1],y=function(e,t){G.h.post("/filter/add",e).then((function(e){var n=e.data;2e4===n.code&&(t({result:"success",id:n.result.id,name:n.result.name}),h.Z.success(n.msg))})).catch((function(e){h.Z.error(e.data.msg)}))},S=function(e){if(o===n)return e({result:"faild"}),!1;if(""===o.trim())return C("\u8f93\u5165\u6846\u4e0d\u80fd\u4e3a\u7a7a"),m(!1),!1;var s={projectId:t,name:o,id:a,type:r,copy:i};return n&&!i?G.h.post("/filter/find/save",{id:a}).then((function(t){var n=t.data;2e4===n.code&&(null!=n.result.selected?(s.selected=n.result.selected,y(s,e)):console.error("/filter/find/save",n.result.selected))})):(s.selected=l,y(s,e)),!1};u.useEffect((function(){s({filterName:o,confirmRun:S}),!f&&o&&o.length<=$&&m(!0)}),[o]);return u.createElement("div",{className:"filter_saved_edit_dialog_wrapper"},u.createElement("span",null,"\u540d\u79f0"),u.createElement("span",{className:f?"":"required_error",style:{position:"relative"}},u.createElement(K.Z,{className:"content_item_input",defaultValue:o,placeholder:"\u8bf7\u8f93\u5165\u540d\u79f0",onChange:function(e){var t=e.target.value;""===t.trim()?(C("\u8f93\u5165\u6846\u4e0d\u80fd\u4e3a\u7a7a"),m(!1)):$<=t.length?(C("\u6700\u591a\u53ea\u80fd\u8f93\u5165120\u4e2a\u5b57\u7b26"),m(!1)):(C(""),m(!0)),d(t)},onBlur:function(e){var t=e.target.value;""===t.trim()?(C("\u8f93\u5165\u6846\u4e0d\u80fd\u4e3a\u7a7a"),m(!1)):t.length===$&&(C(""),m(!0))},maxLength:$}),u.createElement("span",{className:"tip_text"},v)))};const ee=X;X.propTypes={name:c().string};var te={delete:function(e){var t=(0,r.Z)({},e,{dialogType:"danger",titleText:e.titleText||"\u5220\u9664",showClose:!1,content:e.content});return t.onOk?(0,Q.Z)(t):new Promise((function(e,n){t.onOk=e,t.onCancel=n,(0,Q.Z)(t)}))},edit:function(e){var t=(0,r.Z)({},e,{titleText:e.titleText||"\u4fee\u6539\u540d\u79f0",showClose:!1,content:e.content||u.createElement(ee,e)});return t.onOk?(0,Q.Z)(t):new Promise((function(e,n){t.onOk=e,t.onCancel=n,(0,Q.Z)(t)}))}};const ne=te;var ae=n(87219),re=["loading"],ie=o.Z.IDBHeaderScreening.savedScreening,le=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleListSelect=function(e,t){var a=n.props.selFilterObj;e.stopPropagation(),t.id&&(a&&a.id&&t.id===a.id?(n.props.clearSaveFilter(),n.props.onChange({selFilterObj:{id:null,name:"",selected:[]},selFilterSelected:[]}),n.props.changeFilter("save"),n.setState({isFilter:!1}),n.filterIconRef.current.className="icon-shaixuan"):n.setState({selFilterObj:t},(function(){n.clickConfirmBtn()})))},n.getCurrFilter=function(){var e=n.props;return{selFilterObj:e.selFilterObj,selFilterSelected:e.selFilterSelected}},n.selectedChange=function(e,t,a){n.props.onSelFilterObjChange({id:e}).then((function(r){r?(n.props.onChange({selFilterObj:r,selFilterSelected:r.id?JSON.parse(r.selected):[]}),n.props.save({selFilterObj:r,selFilterSelected:r.id?JSON.parse(r.selected):[]})):a&&(n.props.save({selFilterObj:{id:e,name:t,selected:a},selFilterSelected:a?JSON.parse(a):[]}),setTimeout((function(){n.props.onChange({selFilterObj:{id:e,name:t,selected:a},selFilterSelected:a?JSON.parse(a):[]})}),200))}))},n.clickConfirmBtn=function(){n.state.selFilterObj&&n.state.selFilterObj.id?(n.selectedChange(n.state.selFilterObj.id),n.props.changeFilter("save")):(n.props.onSelFilterObjChange(),n.props.onChange({selFilterObj:n.props.filterList[0],selFilterSelected:[]}),n.props.changeFilter("save"))},n.refresh=function(){var e=n.props.type;n.props.getSavedList({type:(0,f.kY)(e),projectId:v.t.get(v.V.curProject).id})},n._handleOnDeleteConfirm=function(e,t){var a=n.props.filterList;e.stopPropagation(),n.props.deleteConfition({id:t.id}).then((function(e){2e4===e.code&&(h.Z.success("\u64cd\u4f5c\u6210\u529f"),setTimeout((function(){n.props.save({filterList:a.filter((function(e){return e.id!==t.id}))}),t.id===n.props.selFilterObj.id&&(n.props.clearSaveFilter(),n.props.onChange({selFilterObj:{id:null,name:"",selected:[]},selFilterSelected:[]}),n.props.changeFilter("save"),n.setState({isFilter:!1}),n.filterIconRef.current.className="icon-shaixuan")}),0))}))},n._handleOnDeleteClick=function(e,t){e.stopPropagation();n.props.selFilterObj;ne.delete({content:"\u662f\u5426\u5220\u9664\u201c"+t.name+"\u201d\u7b5b\u9009\u5668\uff1f",onOk:function(){return n._handleOnDeleteConfirm(e,t)},onCancel:function(){}})},n._handleOnEditClick=function(e,t){e.stopPropagation();var a=n.props,i=a.type,l=a.projectId,s=a.selFilterObj,c=a.filterList;ne.edit({name:t.name,id:t.id,copy:!1,type:(0,f.kY)(i),projectId:l,onOk:function(e){"success"===e.result&&(s.id===t.id&&n.props.save({selFilterObj:(0,r.Z)({},s,{id:e.id,name:e.name})}),setTimeout((function(){n.props.save({filterList:(0,ae.ZP)(c,(function(t){var n=t.findIndex((function(t){return t.id===e.id}));n>-1&&(t[n].name=e.name)}))})}),0))},onCancel:function(){}})},n.onAddFilter=function(e){var t=e.copy,a=e.selected,i=n.props,l=i.selFilterObj,s=i.filterList,c=i.type,o=i.projectId,u=i.maxLength,d=l?l.id:void 0;if(!d&&!t||t){if(s.length>=u)return void h.Z.error("\u7b5b\u9009\u5668\u6700\u591a\u4e0d\u8d85\u8fc7"+u+"\u4e2a");ne.edit({titleText:t?"\u7b5b\u9009\u6761\u4ef6\u53e6\u5b58\u4e3a":"\u4fdd\u5b58\u7b5b\u9009\u6761\u4ef6",name:"",id:d,copy:t,selected:a,type:(0,f.kY)(c),projectId:o,onOk:function(e){if("success"===e.result){var t={id:e.id,name:e.name,selected:a};n.setState({selFilterObj:t}),n.selectedChange(e.id,e.name,a),setTimeout((function(){n.props.save({filterList:[{id:e.id,name:e.name,selected:a,updateAt:k()().format("YYYY/MM/DD")}].concat(s)})}),0)}},onCancel:function(){}})}else n.props.saveConfition({id:d,copy:!1,name:l.name,selected:a,projectId:o,type:(0,f.kY)(c)}).then((function(e){var t=e.data;h.Z.success("\u4fee\u6539\u6210\u529f"),2e4===t.code&&(n.refresh(),n.props.save({selFilterObj:(0,r.Z)({},l,{selected:a}),selFilterSelected:JSON.parse(a)}),setTimeout((function(){n.props.save({filterList:(0,ae.ZP)(s,(function(e){var t=e.findIndex((function(e){return e.id===d}));t>-1&&(e[t].selected=a,e[t].updateAt=k()().format("YYYY/MM/DD"))}))})}),0))}))},n.filterIconRef=u.createRef(),n.state={staredFilterIndex:-1,isEditing:!1,delDialogVisible:!1,editDialogVisible:!1,selFilterObj:t.selFilterObj||{id:null,name:"\u5168\u90e8\u6570\u636e\uff08\u9ed8\u8ba4\uff09"},isFilter:!1},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){},n.componentDidUpdate=function(e){this.props.show===e.show||this.props.show||this.setState({isEditing:!1}),JSON.stringify(this.props.selFilterObj)!==JSON.stringify(e.selFilterObj)&&this.props.selFilterObj&&this.props.selFilterObj.id&&(this.setState({isFilter:!0}),this.filterIconRef.current.className="icon-xiazaiiconmianbu"),JSON.stringify(this.props.selFilterObj)!==JSON.stringify(e.selFilterObj)&&(this.props.selFilterObj&&this.props.selFilterObj.id||(this.setState({isFilter:!1}),this.filterIconRef.current.className="icon-shaixuan"))},n.render=function(){var e,t=this,n=this.state,a=(n.isEditing,n.isFilter),r=this.props,i=r.filterList,l=r.changeFilter,s=r.selFilterObj,c=r.selFilterSelected,o=r.show,d=r.defaultConfig,p=r.screeningValues,f=r.content,h=r.selectValue,m=r.changeSelectValue,v=r.comparisonItems,C=r.analyseDateFilter,y=r.showList,S=null,E=d&&d.defaultChecked&&d.defaultChecked.find((function(e){return e.id===d.defaultChecksName[0]}));(p&&p.length||f&&f[0]&&f[0].contain&&f[0].contain.length||v&&v.length)&&(S="default",s&&s.id&&(S="hasSave",Z()({content:c.content,screeningValues:c.screeningValues,selectValue:c.selectValue,comparisonItems:c.comparisonItems},{content:f,screeningValues:p,selectValue:h,comparisonItems:v})||(E?(c.fastFilterValues&&!Z()(c.fastFilterValues.defaultChecked,d.defaultChecked.filter((function(e){return e.id===E.id})))||p.length>1||c.fastFilterValues&&!Z()(c.fastFilterValues.defaultChecked.map((function(e){return{id:e.id,values:e.values,isSelectAll:e.isSelectAll||!1}})),null==(e=p.find((function(e){return e.id===d.ownerChecked[0].id})))?void 0:e.values.map((function(e){return{id:e.id,values:e.values,isSelectAll:e.isSelectAll||!1}}))))&&(S="hasSaveChange"):S="hasSaveChange")));return u.createElement("div",{className:"filter_saved_wrapper "+(a?"filter_bg":""),onClick:function(e){e.stopPropagation()}},s&&s.id?u.createElement(g.Z,{overlay:u.createElement("div",{style:{color:"#8C8C8C",fontWeight:"bold",maxWidth:160}},"\u7b5b\u9009\u5668\uff1a",u.createElement("span",{style:{color:"#262626"}},s.name)),placement:"top",mouseEnterDelay:.5},u.createElement("div",{className:"filter_save "+(o?"active":""),onClick:function(){l("save")}},u.createElement("i",{className:"icon-shaixuan",ref:this.filterIconRef}))):u.createElement(g.Z,{overlay:"\u5df2\u4fdd\u5b58\u7b5b\u9009\u5668",placement:"top",mouseEnterDelay:.5},u.createElement("div",{className:"filter_save "+(o?"active":"")+" "+(a?"filter_bg":""),onClick:function(){l("save")}},u.createElement("i",{className:"icon-shaixuan",ref:this.filterIconRef}))),i&&u.createElement("div",{className:"filter_saved_wrapper_content",style:{display:o?"block":"none",left:y.includes("fullDate")?"-172px":"-264px"}},u.createElement("div",{className:"top_wrap"},u.createElement("span",null,"\u5df2\u4fdd\u5b58\u7b5b\u9009\u5668\uff08"+i.length+"\uff09")),u.createElement("div",{className:"filter_saved_list"},i.length?u.createElement("ul",null,i.map((function(e,n){return u.createElement("li",{key:e.id,onClick:function(n){return t._handleListSelect(n,e)}},u.createElement("div",{className:"filter_names "+(s&&s.id===e.id?"active":"")},u.createElement("span",{className:"name",title:e.name},e.name),e.updateAt&&u.createElement("div",{className:"date"},k()(e.updateAt).format("YYYY/MM/DD"))),e.id&&u.createElement("div",{className:"tool "+(s&&s.id===e.id?"edt_active":"")},u.createElement(g.Z,{placement:"top",overlay:"\u91cd\u547d\u540d"},u.createElement("span",{onClick:function(n){return t._handleOnEditClick(n,e)}},u.createElement("i",{className:"icon-cem icon-cem_screening-editor"}))),u.createElement(g.Z,{placement:"top",overlay:"\u5220\u9664"},u.createElement("span",{onClick:function(n){return t._handleOnDeleteClick(n,e)}},u.createElement("i",{className:"icon-cem icon-cem_delete"}))),u.createElement("span",{style:{display:s&&s.id===e.id?"inline-block":"none"}},u.createElement("i",{className:"icon-cem_right1"}))))}))):u.createElement("div",{className:"empty_filter"},"\u6682\u65e0\u7b5b\u9009\u5668\uff0c\u8bf7\u6dfb\u52a0")),u.createElement("div",{className:"filter_saved_footer"},u.createElement("div",{className:"btn_zone"},"hasSaveChange"===S&&u.createElement("span",{onClick:function(){t.onAddFilter({copy:!1,selected:JSON.stringify({screeningValues:p,content:f,fastFilterValues:d&&d.defaultChecksName&&d.defaultChecksName.length>0&&{defaultChecksName:d.defaultChecksName,defaultChecks:d.defaultChecks.filter((function(e){return e.id===d.defaultChecksName[0]})),defaultChecked:d.defaultChecked.filter((function(e){return e.id===d.defaultChecksName[0]}))},selectValue:m||h,comparisonItems:v,analyseDateFilter:C})})}},"\u66f4\u65b0"),("hasSaveChange"===S||"hasSave"===S)&&u.createElement("span",{onClick:function(){t.onAddFilter({copy:!0,selected:JSON.stringify({screeningValues:p,content:f,fastFilterValues:d&&d.defaultChecksName&&d.defaultChecksName.length>0&&{defaultChecksName:d.defaultChecksName,defaultChecks:d.defaultChecks.filter((function(e){return e.id===d.defaultChecksName[0]})),defaultChecked:d.defaultChecked.filter((function(e){return e.id===d.defaultChecksName[0]}))},selectValue:m||h,comparisonItems:v,analyseDateFilter:C})})}},"\u53e6\u5b58\u4e3a"),"default"===S&&u.createElement("span",{onClick:function(){t.onAddFilter({copy:!1,selected:JSON.stringify({screeningValues:p,content:f,fastFilterValues:d&&d.defaultChecksName&&d.defaultChecksName.length>0&&{defaultChecksName:d.defaultChecksName,defaultChecks:d.defaultChecks.filter((function(e){return e.id===d.defaultChecksName[0]})),defaultChecked:d.defaultChecked.filter((function(e){return e.id===d.defaultChecksName[0]}))},selectValue:m||h,comparisonItems:v,analyseDateFilter:C})})}},"\u65b0\u5efa")),u.createElement("span",{className:"manage"},"\u7ba1\u7406"))))},t}(u.PureComponent);const se=(0,l.connect)((function(e){e.loading;var t=(0,a.Z)(e,re);return(0,r.Z)({},t[ie])}),(function(e){return{save:function(t){return e({type:ie+"/save",payload:t})},getSavedList:function(t){return e({type:ie+"/getSavedList",payload:t})},deleteConfition:function(t){return e({type:ie+"/deleteConfition",payload:t})},saveConfition:function(t){return e({type:ie+"/saveConfition",payload:t})},onSelFilterObjChange:function(t){return e({type:ie+"/onSelFilterObjChange",payload:t})},clearSaveFilter:function(t){return e({type:ie+"/clearSaveFilter",payload:t})},clean:function(t){return e({type:ie+"/clean",payload:t})}}}),null,{withRef:!0})(le);le.propTypes={show:c().bool,changeFilter:c().func,onChange:c().func,showList:c().array};var ce=n(61193),oe=function(e){function t(){return e.apply(this,arguments)||this}return(0,i.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.onConfirm,a=t.onCancel,r=t.style,i=t.changeAdvancedShow,l=t.showAdvanced,s=t.savedScreening,c=(t.screeningValues,t.defaultConfig,t.saveRef,t.content,t.fastFilterValues,t.advanceAuthority);t.selectValue,t.changeSelectValue,t.comparisonItems,t.analyseDateFilter,s.selFilterObj,s.selFilterSelected;return u.createElement("div",{className:"header_bottom_bar",style:r||{}},u.createElement("ul",{className:"handle"},this.props.screeningValues.length>0&&u.createElement("li",null,u.createElement("span",{className:"clear",onClick:function(){return e.props.clearAllValues()}},"\u6e05\u7a7a\u9009\u9879"))),ce.Z.hasAuthority("CONNECTION_SEARCH")&&!1!==c&&u.createElement("span",{className:"advancedFilter",onClick:function(){return i()}},u.createElement("span",null,"\u94fe\u63a5\u7b5b\u9009"),u.createElement("i",{className:"icon-cem_screening-for-more",style:{transform:l?"":"rotate(-180deg)",top:l?"3px":""}})),u.createElement(m.Button,{onClick:function(){a&&a()}},"\u53d6\u6d88"),u.createElement(m.Button,{type:"primary",onClick:function(){n&&n()}},"\u67e5\u8be2"))},t}(u.PureComponent);const ue=oe;var de=n(29383),pe=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={defaultChecked:!1},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.setState((0,r.Z)({},this.props))},n.UNSAFE_componentWillReceiveProps=function(e){this.setState((0,r.Z)({},e))},n.handleClick=function(e){var t=this.state,n=t.type,a=t.defaultChecked,r=t.selectedList,i=t.totalList;if("checkAll"===n)a?this.props.onChange([]):this.props.onChange(i);else{var l=r.indexOf(e);l>-1?r.splice(l,1):r.push(e),this.props.onChange(r)}this.setState({defaultChecked:!a})},n.render=function(){var e=this,t=this.state,n=t.type,a=t.defaultChecked,r=t.indeterminate,i=t.uniqueId,l="customized-checkobx";return a?l="customized-checkobx checked":"checkAll"===n&&r&&(l="customized-checkobx indeterminate"),u.createElement("div",{className:"header_message_customized-checkobx-wrapper"},u.createElement("div",{className:l,onClick:function(t){t.stopPropagation(),e.handleClick(i)}}))},t}(u.PureComponent);var fe=n(97753),he=!0,me=function(e){function t(t){var n;return(n=e.call(this,t)||this).init=function(){n.setState((0,r.Z)({},n.props),(function(){n.state.show&&n.fetchData()}))},n.switchPage=function(e){n.setState({pageNum:e},(function(){return n.fetchData(!0)}))},n.switchPageSize=function(e){n.setState({pageSize:e,pageNum:1},(function(){return n.fetchData(!0)}))},n.handleCheckAll=function(){var e=n.state,t=e.isCheckedAll,a=e.checkAllStatus,r=e.currPageSelectedList;n.setState({isCheckedAll:!t,checkAllStatus:{checked:!a.checked,indeterminate:!1}},(function(){n.setState({currPageSelectedList:t?[]:r},(function(){n.handleCheckboxStyle()}))}))},n.handleCheck=function(e){for(var t=n.state,a=t.currPageList,r=t.selectedList,i=t.totalRecords,l=e.length-1;l>=0;l--)-1===r.indexOf(e[l])&&r.push(e[l]);for(var s=a.length-1;s>=0;s--)if(-1===e.indexOf(a[s].id)){var c=r.indexOf(a[s].id);c>-1&&r.splice(c,1)}n.setState({currPageSelectedList:e,selectedList:r,checkAllStatus:{checked:r.length>0&&r.length===i,indeterminate:r.length>0&&r.length!==i}},(function(){n.handleCheckboxStyle()}))},n.handleCheckboxStyle=function(){var e=n.state,t=e.selectedList,a=e.currPageSelectedList,r=e.currPageList,i=e.checkAllStatus,l=e.isCheckedAll;if(l&&!i.indeterminate||!l&&i.checked)i.checked=!0,r.forEach((function(e){e.checked=!0;var t=document.getElementById(e.id);t&&t.classList.add("item-active")}));else if(l)r.forEach((function(e){if(t.includes(e.id)){e.checked=!1;var n=document.getElementById(e.id);n&&n.classList.remove("item-active")}else{e.checked=!0;var a=document.getElementById(e.id);a&&a.classList.add("item-active")}}));else{0===a.length?(i.indeterminate=!1,r.forEach((function(e){e.checked=!1;var t=document.getElementById(e.id);t&&t.classList.remove("item-active")}))):(r.forEach((function(e){t.forEach((function(t){if(e.id===t){e.checked=!1;var n=document.getElementById(e.id);n&&n.classList.remove("item-active")}}))})),i.indeterminate=!0);for(var s=r.length-1;s>=0;s--){for(var c=!1,o=a.length-1;o>=0;o--)if(a[o]===r[s].id){c=!0,r[s].checked=!0;var u=document.getElementById(r[s].id);u&&u.addClass("item-active");break}if(!c){r[s].checked=!1;var d=document.getElementById(r[s].id);d&&d.classList.remove("item-active")}}}n.setState({currPageList:r,checkAllStatus:i})},n.handleChange=function(e){n.setState({keywords:e})},n.handleKeyUp=function(e){13===e.keyCode&&n.setState({keywords:e.target.value,pageNum:1},(function(){return n.fetchData()}))},n.handleSort=function(e){var t=e.prop,a=e.order;n.setState({sortName:t||"createdAt",sortType:a||"descending",selectedList:[],pageNum:1},(function(){return n.fetchData()}))},n.state={show:!1,keywords:"",sortName:"createdAt",sortType:"descending",currPageList:[],currPageSelectedList:[],selectedList:[],pageNum:1,pageSize:20,data:[],totalRecords:0,isCheckedAll:!1,checkAllStatus:{checked:!1,indeterminate:!1},loading:!1,columns:[{label:"",width:16,prop:"paddingLeft"},{label:"",width:56,renderHeader:function(){return u.createElement(pe,{type:"checkAll",defaultChecked:n.state.checkAllStatus.checked,indeterminate:n.state.checkAllStatus.indeterminate,onChange:n.handleCheckAll,selectedList:n.state.currPageSelectedList,totalList:n.state.currPageList.map((function(e){return e.id}))})},render:function(e){return u.createElement(pe,{type:"checkOne",defaultChecked:e.checked||!1,onChange:n.handleCheck,selectedList:n.state.currPageSelectedList,totalList:n.state.currPageList.map((function(e){return e.id})),uniqueId:e.id})}},{label:"\u94fe\u63a5\u540d\u79f0",render:function(e){var t=e.name,n=e.url,a=e.imgUrl;return u.createElement("div",{className:"ellipsis",title:t,style:{cursor:"pointer",height:48},onClick:function(e){e.stopPropagation(),n.startsWith("http")&&window.open(n)}},u.createElement("img",{src:a[0]||fe,style:{width:48,height:48}}),u.createElement("span",null,t))}},{label:"\u5e73\u53f0",prop:"sourceName",width:"130px"},{label:"\u603b\u6570\u636e\u91cf",width:"130px",prop:"total",render:function(e){var t=e.total;return u.createElement("div",null,L.ZP.formatNumber(t))}},{label:"\u521b\u5efa\u65f6\u95f4",sortable:"custom",width:"120",prop:"createdAt",render:function(e){var t=e.createdAt;return u.createElement("div",null,t&&t.replace("T"," ").substring(0,t.length-3))}},{label:"",width:16,prop:"paddingRight"}]},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.init()},n.UNSAFE_componentWillReceiveProps=function(e){var t=this,n=function(){t.props.show;t.setState((0,r.Z)({},e,{pageNum:1}),(function(){t.setState({pageNum:1},(function(){return t.fetchData()}))}))};(function(e,t){var n,a,r,i;function l(e,t){var n;if(isNaN(e)&&isNaN(t)&&"number"===typeof e&&"number"===typeof t)return!0;if(e===t)return!0;if("function"===typeof e&&"function"===typeof t||e instanceof Date&&t instanceof Date||e instanceof RegExp&&t instanceof RegExp||e instanceof String&&t instanceof String||e instanceof Number&&t instanceof Number)return e.toString()===t.toString();if(!(e instanceof Object&&t instanceof Object))return!1;if(e.isPrototypeOf(t)||t.isPrototypeOf(e))return!1;if(e.constructor!==t.constructor)return!1;if(e.prototype!==t.prototype)return!1;if(r.indexOf(e)>-1||i.indexOf(t)>-1)return!1;for(n in t){if(t.hasOwnProperty(n)!==e.hasOwnProperty(n))return!1;if(typeof t[n]!==typeof e[n])return!1}for(n in e){if(t.hasOwnProperty(n)!==e.hasOwnProperty(n))return!1;if(typeof t[n]!==typeof e[n])return!1;switch(typeof e[n]){case"object":case"function":if(r.push(e),i.push(t),!l(e[n],t[n]))return!1;r.pop(),i.pop();break;default:if(e[n]!==t[n])return!1}}return!0}if(arguments.length<1)return!0;for(n=1,a=arguments.length;n<a;n++)if(r=[],i=[],!l(arguments[0],arguments[n]))return!1;return!0})(e.queryParams,this.state.queryParams)||n(),e.show!==this.state.show&&(this.setState({show:e.show}),e.show&&0===this.state.data.length&&n()),!0===e.clearAdvance&&this.setState({selectedList:[]})},n.fetchData=function(e){var t=this,n=this.state,a=n.keywords,i=n.sortName,l=n.sortType,s=n.pageNum,c=n.pageSize,o=n.defaultValue,u=this.props.queryParams,d=this.state,p=d.currPageList,f=d.currPageSelectedList,h=d.selectedList,m=d.totalRecords;he&&o[0]&&o[0].values.length>0&&(u.filterModel.connections=o[0].values);var g=void 0,C=window.location.pathname;/^\/price/.test(C)&&(g="PRICE"),this.setState({loading:!0},(function(){G.h.post("/filter/connection/search",(0,r.Z)({projectId:v.t.get(v.V.curProject).id},u,{name:a,sortName:i,sort:l,pageIndex:s,pageSize:c,queryType:g})).then((function(n){if(200===n.status||304===n.status){var a=n.data.result;p=a.list,e||(h=h.filter((function(e){return p.some((function(t){return t.id===e}))}))),f=[];for(var r=p.length-1;r>=0;r--)h.indexOf(p[r].id)>-1?(p[r].checked=!0,f.push(p[r].id)):p[r].checked=!1;m=a.count,he&&o[0]&&o[0].values.length>0&&(f=o[0].values,h=o[0].values,he=!1),t.setState({currPageList:p,currPageSelectedList:f,selectedList:h,totalRecords:m,data:a.list},(function(){return t.handleCheckboxStyle()}))}})).finally((function(){t.setState({loading:!1})}))}))},n.getValue=function(){var e=this.state,t=e.keywords,n=e.selectedList,a=e.isCheckedAll,r=e.checkAllStatus;return a&&r.indeterminate?[{notContain:n,contain:[],searchQueryName:t}]:[{notContain:[],contain:a||!a&&!r.indeterminate?[]:n,searchQueryName:r.checked?t:""}]},n.render=function(){var e=this,t=this.state,n=t.show,a=t.currPageList,r=t.currPageSelectedList,i=t.checkAllStatus,l=t.isCheckedAll,s=t.pageNum,c=t.pageSize,o=t.totalRecords,d=t.loading,p=t.columns,f=t.keywords;return u.createElement("div",{className:"advanced-header-filter-wrapper",style:{display:n?"block":"none"}},u.createElement("div",{className:"advanced-filter-body"},u.createElement("span",null,"\u94fe\u63a5\u7b5b\u9009"),u.createElement(m.Input,{ref:function(t){return e.searchInput=t},placeholder:"\u8bf7\u8f93\u5165\u94fe\u63a5\u540d\u79f0",onChange:this.handleChange,onKeyUp:this.handleKeyUp,icon:"search",onIconClick:function(){e.setState({keywords:f,pageNum:1},(function(){return e.fetchData(!0)}))}}),u.createElement(m.Loading,{loading:d},u.createElement(de.Z,{className:"connection-table",maxHeight:306,columns:p,data:a,total:o,currentPage:s,pageSize:c,pageSizeSelectorShow:!0,onPageSizeChange:this.switchPageSize,onPage:this.switchPage,onSortChange:this.handleSort,rowClassName:function(e){return!l&&r.includes(e.id)||i.checked||l&&!r.includes(e.id)?"item-active":""},notLimit:!1}))))},t}(u.Component),ge=n(94124);n(30133);const ve=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={},n}return(0,i.Z)(t,e),t.prototype.render=function(){var e=this.props,t=(e.curScreeningMap,e.children);e.defaultConfig;return!1===e.show?null:u.createElement("div",{className:"header_Filter_view",style:{height:t?"100%":""}},u.createElement(ge.Z,this.props))},t}(u.Component);var Ce=["loading"],ye=o.Z.IDBHeaderScreening.screening,Se=o.Z.global;Array.prototype.deepcopy=function(){return JSON.parse(JSON.stringify(this))};var ke=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handelOnFilterValueChange=function(e,t){n.props.screeningValuesChange({id:e,values:t}).then((function(){n.props.onChange&&n.props.onChange(n.props.screeningValues)}))},n.state={},n._event={onFilterValueChange:n._handelOnFilterValueChange},t.clear(),n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=e.onReady,n=e.fetchDefaultConfig,a=e.pageType,r={value:e.screenValue,noSavingFilterList:this.props.noSavingFilterList},i=r.value,l=r.noSavingFilterList,s=i||void 0;t&&this.props.init().then((function(e){n({type:a,value:s,noSavingFilterList:l,expandInfo:{type:a}})}))},n.componentWillUnmount=function(){this.props.clear()},n.render=function(){return u.createElement(ve,(0,r.Z)({},this.state,this._event,this.props))},t}(u.Component);ke.propTypes={onReady:c().func,onChange:c().func,pageType:c().string,value:c().array,option:c().shape({configurable:c().bool,draggable:c().bool}),className:c().string,noSavingFilterList:c().bool,transferValue:c().object};const Ee=(0,l.connect)((function(e){e.loading;var t=(0,a.Z)(e,Ce);return(0,r.Z)({},t[ye])}),(function(e){return{fetchDefaultConfig:function(t){return e({type:ye+"/fetchDefaultConfig",payload:t})},screeningValuesChange:function(t){return e({type:ye+"/screeningValuesChange",payload:t})},freshFastFilter:function(t){return e({type:ye+"/freshFastFilter",payload:t})},defaultValueChange:function(t){return e({type:ye+"/defaultValueChange",payload:t})},save:function(t){return e({type:ye+"/save",payload:t})},clear:function(){return e({type:ye+"/clear"})},init:function(){return e({type:Se+"/init"})}}}),null,{withRef:!0})(ke);n(35797);var Ne=n(64749),we=Ne.default.Option;const De=function(e){var t=e.data,n=e.selectValue,a=e.onChange;return u.createElement("div",{className:"header_screen_select_wrapper"},u.createElement("i",{className:"icon-shujuyuan"}),t&&t[0]&&u.createElement(Ne.default,{defaultValue:n||t[0].name,style:{height:28},bordered:!1,dropdownMatchSelectWidth:88,onChange:a,suffixIcon:u.createElement("i",{className:"icon-cem_pull-down-or-take-up"})},t.map((function(e){return u.createElement(we,{value:e.name,key:e.name},(0,f.mC)(e.label))}))))};n(75314);var Fe=n(11187),Ve=n(50361),_e=n.n(Ve);const Oe=function(e){function t(t){var n;return(n=e.call(this,t)||this).inputChange=function(e){n.setState({inputVal:e.target.value})},n.keywordChange=function(e){var t=n.state,a=t.inputVal,r=t.inputValMap;"keydown"===e.type&&13===e.keyCode&&a.trim()&&(r.length<5?r.find((function(e){return e.trim()===a.trim()}))||(r.push(a.trim()),n.setState({inputValMap:r,inputVal:""},(function(){return n.onChange()}))):Fe.default.warning("\u6700\u591a\u641c\u7d225\u4e2a\u5ba2\u6237\u540d\u79f0\uff0c\u8d85\u8fc7\u7684\u5ba2\u6237\u540d\u79f0\u4e0d\u641c\u7d22"))},n.handleOnClose=function(){n.setState({inputValMap:[]},(function(){return n.onChange()}))},n.delKeyWords=function(e){var t=n.state.inputValMap;t.splice(e,1),n.setState({inputValMap:t},(function(){return n.onChange()}))},n.onChange=function(){var e=n.props.screeningValues,t=(0,ae.ZP)(e,(function(e){var t=e.find((function(e){return"CUSTOMER_SERVICE"===e.id}));t?t.values=[].concat(t.values.filter((function(e){return"CUSTOMER_NAME"!==e.id})),[{id:"CUSTOMER_NAME",values:_e()(n.state.inputValMap)}]):e.push({id:"CUSTOMER_SERVICE",values:[{id:"CUSTOMER_NAME",values:_e()(n.state.inputValMap)}]})}));n.props.onFilterValueChange("CUSTOMER_SERVICE",t.find((function(e){return"CUSTOMER_SERVICE"===e.id})).values)},n.state={inputValMap:t.values?t.values:[],inputVal:""},n}(0,i.Z)(t,e);var n=t.prototype;return n.UNSAFE_componentWillReceiveProps=function(e,t){e.values&&this.setState({inputValMap:e.values})},n.render=function(){var e=this,t=this.state,n=t.inputVal,a=t.inputValMap;return u.createElement("div",{className:"multi_username_input_wrap"},u.createElement("div",{className:"input-wrap"},u.createElement("span",null,"\u5ba2\u6237\u540d\u79f0"),u.createElement("input",{type:"text",className:"keyword-setting",value:n,placeholder:"\u591a\u4e2a\u5ba2\u6237\u540d\u79f0\u8bf7\u6309\u56de\u8f66\u5206\u9694",onChange:this.inputChange,onBlur:this.keywordChange,onKeyDown:this.keywordChange}),_e()(a).length>0&&u.createElement("i",{className:"icon-cem_log-off",onClick:this.handleOnClose})),u.createElement("div",{style:{display:"flex",maxWidth:"calc(100% - 12px - 314px)",overflowY:"hidden",alignItems:"center"}},_e()(a).map((function(t,n){return u.createElement("span",{className:"word "+(0!==n?"word_blur":""),key:t+n},u.createElement("span",{title:t},t),u.createElement("i",{onClick:function(){return e.delKeyWords(n)}},"\xd7"))}))))},t}(u.Component);const be=function(e){function t(t){var n;return(n=e.call(this,t)||this).onConfirm=function(){n.props.reducedScreenValue&&n.props.changeScreenValues(n.props.reducedScreenValue);var e={};n.advancedFilter&&n.advancedFilter.getValue()[0].contain.length>0?e.connections=n.advancedFilter.getValue()[0].contain:n.advancedFilter&&n.advancedFilter.getValue()[0].notContain.length>0&&(e.advancedConnection=[{notContain:n.advancedFilter.getValue()[0].notContain}]),n.advancedFilter&&n.advancedFilter.getValue()[0].searchQueryName&&(e.searchQueryName=n.advancedFilter.getValue()[0].searchQueryName),n.props.save({advancedFilter:e}),n.props.changeScreeningShow(),n.props.onSearchButtonClick(),!n.props.screeningValues.length&&n.props.savedScreening.selFilterObj.id&&n.props.clearSaveFilter()},n.onCancel=function(){n.props.changeScreeningShow()},n.clearAllValues=function(){n.props.clearAllValues(),n.setState({clearAdvance:!0},(function(){n.setState({clearAdvance:!1})}))},n.state={clearAdvance:!1},n}return(0,i.Z)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.showList,a=t.screeningValues,i=t.screeningValuesChange,l=t.show,s=t.hideBtn,c=t.onFilterReady,o=t.type,d=t.changeAdvancedShow,p=t.showAdvanced,f=t.content,h=t.advanceAuthority,m=t.selectValue,g=t.comparisonItems,v=t.defaultConfig,C=t.contentChange,y=t.onSearch,S=(t.touchData,t.changeFilter,t.onScreenValuesChange);return u.createElement("div",{className:"header_screening_wrap_view"},l&&n.includes("nameContentSearch")&&u.createElement("div",{className:"header_source_bar"},n.includes("usernameSearch")&&u.createElement(Oe,{onFilterValueChange:function(e,t){i({id:e,values:t})},screeningValues:a,values:a.some((function(e){return"CUSTOMER_SERVICE"===e.id}))&&a.find((function(e){return"CUSTOMER_SERVICE"===e.id})).values&&a.find((function(e){return"CUSTOMER_SERVICE"===e.id})).values.some((function(e){return"CUSTOMER_NAME"===e.id}))?a.find((function(e){return"CUSTOMER_SERVICE"===e.id})).values.find((function(e){return"CUSTOMER_NAME"===e.id})).values:[]}),v&&v.defaultChecksName&&v.defaultChecksName.length>0&&n.includes("contentSearch")&&u.createElement(H,{values:z(f).values||[],queryType:z(f).queryType||"FUZZY_SEARCH",onChange:function(e,t,n){C(B(e,t)),setTimeout((function(){return n&&y()}),0)}})),u.createElement(Ee,(0,r.Z)({},this.props,{onReady:c,type:o,onChange:S})),ce.Z.hasAuthority("CONNECTION_SEARCH")&&p&&u.createElement(me,{ref:function(t){return e.advancedFilter=t},show:l&&p,queryType:this.props.type,queryParams:JSON.parse(JSON.stringify({filterModel:{content:f&&f[0]&&f[0].contain&&f[0].contain.length?f:void 0},headerFilterParamsNew:a})),defaultValue:[],advanceAuthority:h,clearAdvance:this.state.clearAdvance}),l&&!s&&u.createElement(ue,(0,r.Z)({},this.props,{onConfirm:this.onConfirm,onCancel:this.onCancel,clearAllValues:this.clearAllValues,screeningValues:a,content:f,changeAdvancedShow:d,showAdvanced:p,selectValue:m,comparisonItems:g})))},t}(u.Component);var Ye=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnHide=function(e){var t=n.props,a=t.showKind,r=t.changeShow;if(a){if("screening"===a)return;r(null)}},n.state={},n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){window.addEventListener("click",this._handleOnHide)},n.componentWillUnmount=function(){window.removeEventListener("click",this._handleOnHide)},n.render=function(){var e=this,t=this.props,n=t.isNotShowHeaderButton,a=t.changeFilter,i=t.getSaveRef,l=t.onSearchButtonClick,s=t.screeningList,c=t.curScreeningMap,o=t.children,h=(t.getTimeRef,t.defaultConfig),m=t.defaultValueChange,g=t.onSearch,v=(t.onFilterReady,t.expandInfo),C=t.noSavingFilterList,y=t.transferValue,S=t.screeningValues,k=t.updateScreeningValues,E=t.changeShow,N=t.showKind,w=t.content,D=t.contentChange,F=t.advanceAuthority,V=t.showList,_=t.title,b=t.savedFilterChange,Y=t.recordId,M=t.fetchingScreeningMap,T=t.selectValue,L=t.touchData,I=t.rightContent,A=t.filterDateFilter,P=t.changeSelectValue,Z=t.comparisonItems,x=t.analyseDateFilter,j=t.savedScreening,q=t.mainContentSearch,W=t.onScreenValuesChange,J=(h||{}).defaultChecksName,Q=void 0===J?{}:J,K=S.reduce((function(e,t){return t.values.length+e}),0),G=T&&Z?{label:"\u6570\u636e\u7c7b\u578b"}:s.map((function(e){return e.data})).flat(1).filter((function(e){return e.id===Q[0]})).length?s.map((function(e){return e.data})).flat(1).filter((function(e){return e.id===Q[0]}))[0]:{},$=!h||!h.defaultChecksName||!h.defaultChecksName.length;return u.createElement("div",{className:"yt_idb_header_Filter_view",style:{height:o?"100%":""}},!Y&&u.createElement(d.default,{spinning:void 0===c||void 0===h||M},!q&&u.createElement("div",{className:"header_Filter_bar",style:{padding:V.includes("quickDate")?"24px 24px 8px":"24px 24px 12px",marginBottom:V.includes("quickDate")?"8px":"12px"}},u.createElement("div",{className:"screening_title "+("screening"===N?"sel":""),style:{paddingTop:L&&V.includes("sourceSearch")?0:"3px"}},L&&V.includes("sourceSearch")&&u.createElement(De,{data:L&&L.map((function(e){return{name:e,label:e}})),selectValue:T,onChange:function(e){return a(e)}}),u.createElement("div",{className:"filter_btn",onClick:function(){return E("screening"===N?void 0:"screening")}},u.createElement("span",{className:"filter_name"},"\u7b5b\u9009"),K>0&&u.createElement("span",{className:"filter_count"},K),u.createElement("i",{className:"icon-cem_pull-down-or-take-up"}))),!n&&G.label&&u.createElement("div",{className:"screening_label"},G.label),!n&&T&&Z&&u.createElement(p.default.Group,{value:T,className:"result_header_button",onChange:function(e){return a(e.target.value,j.selFilterObj)}},L&&L.map((function(e){return u.createElement(p.default.Button,{value:e,key:e},(0,f.mC)(e))}))),V.includes("contentSearch")&&$&&u.createElement(H,{values:z(w).values||[],queryType:z(w).queryType||"FUZZY_SEARCH",onChange:function(e,t,n){D(B(e,t)),setTimeout((function(){return n&&g()}),0)}}),_?"string"===typeof _?u.createElement("div",{className:"filter_title"},_):u.createElement("div",{style:{cssFloat:"left"}},_):h&&h.defaultChecksName&&h.defaultChecksName.length>0&&u.createElement(R,{showList:V,ref:function(t){return e.fastRef=t},defaultConfig:h,screeningList:s,defaultValueChange:m,onSearch:g,disabled:"screening"===N,show:"fastScreening"===N,changeFilter:function(e){return E(N===e?void 0:"fastScreening")}}),u.createElement("div",{className:"header_Filter_right_wrap"},I&&I,V.includes("save")&&u.createElement(se,{ref:i,defaultConfig:h,screeningValues:S,content:w,selectValue:T,changeSelectValue:P,comparisonItems:Z,analyseDateFilter:x,show:"save"===N,showList:V,changeFilter:function(e){E(N===e?void 0:"save")},onChange:function(t){t&&t.selFilterObj.id&&t.selFilterSelected.comparisonItems&&e.props.save({comparisonItemsSave:t.selFilterSelected.comparisonItems}),t&&t.selFilterObj.id&&t.selFilterSelected.selectValue!==T?a(t.selFilterSelected.selectValue,t.selFilterObj).then((function(){k(t&&t.selFilterObj.id?t.selFilterSelected.screeningValues:[]),b(t)})):b(t).then((function(){g()}))},maxLength:T&&Z?50:10}),V.includes("fullDate")&&u.createElement(O,{ref:function(t){return e.timePicker=t},changeFilter:function(e){return E(N===e?null:"date")},show:N,onChange:function(){return g()},filterDateFilter:A}))),u.createElement("div",null,V.includes("screening")&&u.createElement(be,(0,r.Z)({},this.props,{show:q||"screening"===N,hideBtn:q,changeScreeningShow:function(){return E("screening"===N?void 0:"screening")},onSearchButtonClick:l,expandInfo:v,noSavingFilterList:C,transferValue:y,advanceAuthority:F,onScreenValuesChange:W}))),u.createElement("div",null,V.includes("quickDate")&&u.createElement(U.Z,{onChange:function(){return g()}}))),o&&u.createElement("div",{className:"contentWrap"},o))},t}(u.Component);const Me=Ye;var Te=["loading"],Le=o.Z.IDBHeaderScreening.headerScreening,Ie=o.Z.IDBHeaderScreening.screening,Ae=o.Z.IDBHeaderScreening.savedScreening,Pe=o.Z.IDBHeaderScreening.timeScreening,Ze=o.Z.IDBHeaderScreening.quickTimeScreening;Array.prototype.deepcopy=function(){return JSON.parse(JSON.stringify(this))};var xe=function(e){function t(t){var n,a;return(n=e.call(this,t)||this).getValue=function(){var e=n.props,t=e.screeningValues,a=e.defaultConfig,i=e.fullDateFilter,l=e.quickDateFilter,s=e.showList,c=e.content,o=e.advancedFilter,u=e.curScreeningMap,d=t.deepcopy().filter((function(e){return e.values.length>0})),p=JSON.parse(JSON.stringify(a)),f=u.filter((function(e){return e.data.some((function(e){return e.id===p.defaultChecksName[0]}))}))[0],h=p.defaultChecked&&p.defaultChecked.find((function(e){return e.id===p.defaultChecksName[0]}))||{};return h.isSelectAll&&d.forEach((function(e){e.values.some((function(e){return e.id===p.defaultChecksName[0]}))&&e.values.forEach((function(e){e.id===p.defaultChecksName[0]&&(e.values=[])}))})),d.forEach((function(e){["PRODUCT_INFO"].includes(e.id)&&e.values.forEach((function(e){["PRODUCT_NAME","PRODUCT_VERSION","PRODUCT_LINE"].includes(e.id)&&e.valid&&(e.values=[])}))})),JSON.parse(JSON.stringify({dateFilter:s.includes("quickDate")?l:i,filterModel:(0,r.Z)({content:c&&c[0]&&c[0].contain&&c[0].contain.length?c:void 0},o),headerFilterParamsNew:d,analysisModel:f?[{id:f.id,values:p.defaultChecked.filter((function(e){return e.id===p.defaultChecksName[0]&&(e.values=h.isSelectAll?[]:e.values,!0)}))}]:void 0}))},n.getTransferValue=function(){var e=n.props,t=e.screeningList,a=e.curScreeningMap,r=e.screeningValues,i=e.defaultConfig,l=e.fullDateFilter,s=e.quickDateFilter;return{defaultConfig:i,screeningList:t,curScreeningMap:a,screeningValues:r,dateFilter:e.showList.includes("quickDate")?s:l}},n.getFullValue=function(){var e={screeningValues:n.props.screeningValues,defaultConfig:n.props.defaultConfig,curScreeningMap:n.props.curScreeningMap},t=JSON.parse(JSON.stringify(e)),a=t.screeningValues,r=t.defaultConfig,i=t.curScreeningMap;return(0,f.Z8)(a,r,i)},n._handelSearch=function(){var e=n.props.valueConf,t=void 0===e?[]:e,a=n.getValue(),r={categoryId:(0,f.WN)(n.props.selectValue),selectValue:n.props.selectValue,comparisonItems:n.props.comparisonItemsSave};t.includes("fullInfo")&&(r.fullInfo=n.getFullValue()),n.props.onChange&&n.props.onChange(a,r)},n._changeFilter=function(e,t){n.props.showList.includes("sourceSearch")&&n.props.touchData.length<=1||n.props.init({showList:n.props.showList,type:n.props.showList.includes("sourceSearch")||n.props.selectValue&&n.props.comparisonItems?e:n.props.type,screening:{noSavingFilterList:n.props.noSavingFilterList},resourceKeys:n.props.resourceKeys,hasHour:n.props.hasHour,dateValue:n.props.dateValue,filterId:t?t.id:n.props.filterId,projectId:n.props.projectId}).then((function(){var t=n.props.valueConf,a=void 0===t?[]:t,r=n.getValue(),i={categoryId:(0,f.WN)(e),selectValue:e,comparisonItems:n.props.comparisonItemsSave};a.includes("fullInfo")&&(i.fullInfo=n.getFullValue()),n.props.onChange&&n.props.onChange(r,i)}))},n._handelSearchButtonClick=function(){return n.props.freshFastFilter().then((function(){return n._handelSearch()}))},t.transferValue&&t.transferValue.dateFilter&&t.save({dateFilter:t.transferValue.dateFilter}),n.state={},n._event={onFilterReady:n._handelOnFilterReady,onSearchButtonClick:n._handelSearchButtonClick,onSearch:n._handelSearch,changeFilter:n._changeFilter,getSaveRef:function(e){return n.saveRef=e}},t.clear(),t.selectValue&&t.comparisonItems&&t.findTouchSpotByAccountId(),t.screenValue&&Array.isArray(t.screenValue)&&(a=t.screenValue),t.init({showList:t.showList,type:t.pageType,resourceKeys:t.resourceKeys,hasHour:t.hasHour,screening:{value:a,noSavingFilterList:t.noSavingFilterList},dateValue:t.dateValue,contentValue:t.contentValue,filterId:t.filterId,projectId:t.projectId}).then((function(){var e=n.props.valueConf,a=void 0===e?[]:e,r=n.getValue(),i={categoryId:(0,f.WN)(n.props.selectValue),selectValue:n.props.selectValue,comparisonItems:n.props.comparisonItemsSave};a.includes("fullInfo")&&(i.fullInfo=n.getFullValue()),t.onReady&&t.onReady(r,i)})),n}(0,i.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){},n.componentDidUpdate=function(e){var t=e.screenValue,n=e.pageType,a=this.props,r=a.screenValue,i=a.pageType;(JSON.stringify(t)!==JSON.stringify(r)&&r&&Array.isArray(r)||JSON.stringify(n)!==JSON.stringify(i))&&this.props.init({showList:this.props.showList,type:i,resourceKeys:this.props.resourceKeys,hasHour:this.props.hasHour,screening:{value:r,noSavingFilterList:this.props.noSavingFilterList},dateValue:this.props.dateValue,contentValue:this.props.contentValue,filterId:this.props.filterId,projectId:this.props.projectId})},n.componentWillUnmount=function(){this.props.clear()},n.render=function(){return u.createElement(Me,(0,r.Z)({},this.state,this._event,this.props,{saveRef:this.saveRef}))},t}(u.Component);xe.propTypes={title:c().oneOfType([c().string,c().node]),onChange:c().func,onScreenValuesChange:c().func,pageType:c().string,resourceKeys:c().string,onReady:c().func,valueConf:c().array,expandInfo:c().object,noSavingFilterList:c().bool,transferValue:c().object,advanceAuthority:c().bool,showList:c().array,mainContentSearch:c().bool,hasHour:c().bool,rightContent:c().node,filterId:c().string,filterDateFilter:c().object,recordId:c().string,selectValue:c().string,touchData:c().arrayOf(c().string),findTouchSpotByAccountId:c().func,projectId:c().string};const Re=(0,l.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,Te);return(0,r.Z)({},n[Le],n[Ie],{savedScreening:(0,r.Z)({},n[Ae]),fullDateFilter:n[Pe].dateFilter,quickDateFilter:n[Ze].dateFilter,fetchingScreeningMap:t.effects[Le+"/init"]||!1})}),(function(e){return{freshFastFilter:function(t){return e({type:Le+"/freshFastFilter",payload:t})},defaultValueChange:function(t){return e({type:Le+"/defaultValueChange",payload:t})},dateValueChange:function(t){return e({type:Le+"/dateValueChange",payload:t})},clearAllValues:function(t){return e({type:Le+"/clearAllValues",payload:t})},changeScreenValues:function(t){return e({type:Le+"/changeScreenValues",payload:t})},clear:function(){return e({type:Le+"/clear"})},save:function(t){return e({type:Le+"/save",payload:t})},changeShow:function(t){return e({type:Le+"/changeShow",payload:t})},changeAdvancedShow:function(t){return e({type:Le+"/changeAdvancedShow",payload:t})},updateScreeningValues:function(t){return e({type:Ie+"/updateScreeningValues",payload:t})},screeningValuesChange:function(t){return e({type:Ie+"/screeningValuesChange",payload:t})},contentChange:function(t){return e({type:Le+"/contentChange",payload:t})},savedFilterChange:function(t){return e({type:Le+"/savedFilterChange",payload:t})},clearSaveFilter:function(t){return e({type:Le+"/clearSaveFilter",payload:t})},init:function(t){return e({type:Le+"/init",payload:t})}}}),null,{withRef:!0})(xe)},97753:(e,t,n)=>{e.exports=n.p+"img/910a95789a4767e8719c.png"}}]);