"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[1438],{91438:(e,t,a)=>{a.r(t),a.d(t,{default:()=>S});var n=a(87462),r=a(94578),s=a(67294),u=a(91751),o=a(82784),c=a.n(o),l=a(30381),i=a.n(l),p=a(5133);const m={setStorage:function(e,t){var a=e||"cem-msg";localStorage.setItem(a,JSON.stringify(t))},getStorage:function(e){var t=e||"cem-time-msg",a=JSON.parse(localStorage.getItem(t))||{};return Object.keys(a).length<=0&&(a.value=[i()().subtract(90,"days").format("YYYY-MM-DD"),i()().startOf("day").format("YYYY-MM-DD")],a.groupBy="MONTH",a.current=9),a}};var d=a(94184),f=a.n(d);a(83839),a(22243);i().locale("zh-cn");var v="YYYY-MM-DD",h=function(e){return e?e.format(v):""},y={"\u6628\u5929":0,"\u4e0a\u5468":1,"\u4eca\u5929":2,"\u672c\u5468":3,"\u8fd17\u5929":4,"\u4e0a\u6708":5,"\u8fd130\u5929":6,"\u672c\u6708":7,"\u8fd190\u5929":8,"\u81ea\u5b9a\u4e49":9},g={"\u65f6":"HOUR","\u5929":"DAY","\u5468":"WEEK","\u6708":"MONTH"},E=function(e){switch(e){case 0:return[i()().subtract(1,"days"),i()().subtract(1,"days")];case 1:return[i()().subtract(1,"weeks").startOf("week"),i()().subtract(1,"weeks").endOf("week")];case 2:return[i()().startOf("day"),i()()];case 3:return[i()().startOf("week"),i()()];case 4:return[i()().subtract(6,"days"),i()().startOf("day")];case 5:return[i()().subtract(1,"months").startOf("month"),i()().subtract(1,"months").endOf("month")];case 6:return[i()().subtract(29,"days"),i()().startOf("day")];case 7:return[i()().startOf("month"),i()()];default:return[i()().subtract(89,"days"),i()().startOf("day")]}},k=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).state={showLeft:!0,value:[i()(h(E(t.props.current)[0])),i()(h(E(t.props.current)[1]))],currentType:0==t.props.current?0:t.props.current||9,currentGroup:t.props.groupBy||"DAY",hoverValue:[],inputVal:[]},t.handleToggle=function(e){t.setState({showLeft:!t.state.showLeft})},t.onStandaloneSelect=function(e,a){var n=t.state.value;if(n[e]=a,!(n[1].diff(n[0],"days")<0)){t.setState({value:n,inputVal:[h(n[0]),h(n[1])]});var r=t.fixedGroup(n);t.setState({currentGroup:r,currentType:y["\u81ea\u5b9a\u4e49"]}),Object.keys(y).map((function(e,a){var r=E(y[e]);h(n[0])===h(r[0])&&h(n[1])===h(r[1])&&t.setState({currentType:y[e]})}))}},t.onStartChange=function(e){t.onStandaloneSelect(0,e)},t.onEndChange=function(e){t.onStandaloneSelect(1,e)},t.setDateGroup=function(e){t.setState({currentGroup:e})},t.disabledStartDate=function(e){var a=t.state.value[1];return!(!e||!a)&&a.diff(e,"days")<0},t.disabledEndDate=function(e){var a=t.state.value[0];return!(!e||!a)&&e.diff(a,"days")<0},t.fixedGroup=function(e){var t=i().duration(e[1]-e[0]).asDays();switch(!0){case t<=1:return"HOUR";case t<30:return"DAY";case t>=30:return"MONTH";default:return"HOUR"}},t.setQuickTime=function(e,a){if(9!==e){var n=E(e);t.setState({value:n,currentType:e,currentGroup:t.fixedGroup(n)},(function(e){a&&a()}))}else t.setState({currentType:e,inputVal:[h(t.state.value[0]),h(t.state.value[1])]})},t.inputStart=function(e){var a=t.state.inputVal;a[0]=e.currentTarget.value,t.setState({inputVal:a})},t.inputEnd=function(e){var a=t.state.inputVal;a[1]=e.currentTarget.value,t.setState({inputVal:a})},t.apply=function(e,a){t.props.onceShow&&m.setStorage("cem-time-"+t.props.onceShow,"");var n=t.state,r=n.value,s=n.inputVal,u=n.currentType,o=n.currentGroup,c=t.props,l=c.timeConfirm,d=(c.style,c.handlePanel);if(9===u){var f=i()(s[0]),v=i()(s[1]);if(!f.isValid()||!v.isValid())return void p.Z.error("\u975e\u6cd5\u8f93\u5165");if(v.diff(f,"days")<0)return void p.Z.error("\u975e\u6cd5\u8f93\u5165");t.setState({value:[f,v]},(function(e){return l([h(t.state.value[0]),h(t.state.value[1])],o,u)}))}else l([h(r[0]),h(r[1])],o,u);!a&&d(e)},t}return(0,r.Z)(t,e),t.prototype.render=function(){var e=this,t=this.state,a=t.showLeft,r=t.inputVal,o=t.value,l=t.currentType,i=t.currentGroup,p=this.props,m=p.style,d=p.group,E=p.onClick,k=f()("filter-date-input-from","fake-textarea",{disabled:9!==l}),S=[];return!r||r.length<2?(S.push(h(o[0])),S.push(h(o[1]))):(S.push(r[0]),S.push(r[1])),s.createElement("div",{className:"time-setting-panel",onClick:E,style:(0,n.Z)({width:a?"772px":"260px"},m)},s.createElement("div",{className:"left-panel",style:{display:a?"inline-block":"none"}},s.createElement(u.Z,{format:v,locale:c(),showDateInput:!1,showOk:!1,value:o[0],disabledDate:this.disabledStartDate,onChange:this.onStartChange}),s.createElement(u.Z,{format:v,showDateInput:!1,locale:c(),showOk:!1,value:o[1],disabledDate:this.disabledEndDate,onChange:this.onEndChange}),d&&s.createElement("div",{className:"date-group"},"\u65f6\u95f4\u5206\u7ec4\uff1a",g&&Object.keys(g).map((function(t,a){return s.createElement("li",{key:a,className:g[t]===i?"quick-btn active":"quick-btn",onClick:function(a){return e.setDateGroup(g[t])}},s.createElement("span",null,t))})))),s.createElement("div",{className:"quick-setting-panel"},s.createElement("ul",null,y&&Object.keys(y).map((function(t,a){return s.createElement("li",{key:a,className:a===l?"quick-btn active":"quick-btn",onClick:function(a){return e.setQuickTime(y[t])}},s.createElement("span",null,t))}))),s.createElement("div",{className:"left-panel-toggle quick-btn",onClick:this.handleToggle},s.createElement("span",null,a?"\u2190 \u6536\u8d77":"\u2192 \u5c55\u5f00")),9===l?s.createElement("div",{className:"filter-date-input"},s.createElement("input",{className:k,value:S[0],onChange:this.inputStart}),s.createElement("div",{className:"device"},"-"),s.createElement("input",{className:k,value:S[1],onChange:this.inputEnd})):s.createElement("div",{className:"filter-date-input"},s.createElement("input",{className:k,readOnly:!0,value:h(o[0])}),s.createElement("div",{className:"device"},"-"),s.createElement("input",{className:k,readOnly:!0,value:h(o[1])})),s.createElement("div",{className:"apply-btn",onClick:function(t){return e.apply(t)}},"\u5e94\u7528")))},t}(s.Component),S=function(e){function t(t){var a;(a=e.call(this,t)||this).state={show:!1,value:["2018-01-01","2018-08-01"],current:9,groupBy:"MONTH"},a.handlePanel=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),a.setState({show:!a.state.show})},a.stopPop=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},a.timeConfirm=function(e,t,n){a.setState({value:e,groupBy:t,current:n},(function(){m.setStorage("cem-time-"+a.props.model,a.state),a.props.confirm&&a.props.confirm()}))},a.state=m.getStorage("cem-time-"+(a.props.onceShow?a.props.onceShow:a.props.model))||{},a.state.value=a.state.value||a.state.dateRange;var n=a.state.current;if(n<9){var r=E(n);a.state.value=[h(r[0]),h(r[1])]}return a.state=Object.assign({show:!1,value:["2018-01-01","2018-08-01"],current:9,groupBy:"MONTH"},a.state),a}(0,r.Z)(t,e);var a=t.prototype;return a.componentDidMount=function(){var e=this;this.oneHandler=function(){e.setState({show:!1})},document.addEventListener("click",this.oneHandler)},a.componentWillUnmount=function(){document.removeEventListener("click",this.oneHandler)},a.getParams=function(){var e=this.state,t=e.value,a=e.groupBy;return{from:t[0],to:t[1],dateGroupType:a,remoteName:"cTime"}},a.render=function(){var e=this,t=this.props.group,a=this.state,n=a.value,r=a.current,u=a.groupBy;return s.createElement("div",{className:"date-wrap"},s.createElement("div",null,s.createElement("div",{className:"date-filter filter-box",onClick:function(t){return e.handlePanel(t)}},s.createElement("div",null,s.createElement("span",null,n[0].replace(/-/g,"/"))," -",s.createElement("span",null,n[1].replace(/-/g,"/"))),9!==this.state.current&&s.createElement("div",{className:"date-day-info"},Object.keys(y).filter((function(t){return y[t]===e.state.current}))[0]),s.createElement("i",{className:"icon-cem_time-controller"})),s.createElement(k,{ref:"picker",timeConfirm:function(t,a,n){return e.timeConfirm(t,a,n)},value:n,handlePanel:function(t){return e.handlePanel(t)},onClick:this.stopPop,current:r,groupBy:u,group:t,style:{display:this.state.show?"block":"none"}})))},t}(s.Component)}}]);