"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[9280],{77361:(e,t,a)=>{a.r(t),a.d(t,{default:()=>D});var n=a(63366),i=a(87462),r=a(94578),l=a(18446),o=a.n(l),c=a(64396),d=a(55609),s=a(87219),u=a(35239),p=a(67294),f=(a(15086),a(94055)),h=a(35103),m=a(7566),y=a(76893),C=a(39432),T=a(89212);const g=function(e){var t,a,n=e.pageType,i=e.outsideFilter,r=e.filterReady,l=e.filterChange,o=e.onChange,c=e.onChartTypeChange,d=e.onMsgClick,s=e.lineData,u=e.fetchingLineData,g=e.onClickGoods,v=e.pagination,E=e.aspectData,I=e.aspectLoading,D=e.totalAspectCount,_=e.totalAspectPreCount,A=e.aspectTableData,F=e.aspectTableLoading,O=e.chartType,R=e.topicData,k=e.topicLoading,L=e.totalTopicCount,b=e.totalTopicPreCount,w=e.topicTableData,M=e.topicTableLoading,P=e.onSessionMsgClick,S=e.dateGroupType;return p.createElement("div",{className:"yt_service_sku_wrapper"},p.createElement(h.Z,{onReady:r,onChange:l,pageType:n,advanceAuthority:!1,screenValue:i&&i.headerFilterParamsNew,dateValue:i&&i.dateFilter,valueConf:["fullInfo"],showList:["quickDate","screening","save"]},p.createElement("div",{className:"content"},p.createElement(m.Z,{title:"\u4f1a\u8bdd\u91cf",titleOverlay:"\u4e00\u4e2a\u7528\u6237\u5355\u6b21\u4f1a\u8bdd\u7b97\u4f5c1\u4e2a\u4f1a\u8bdd\u91cf\u3002",dataSource:s,loading:u,columns:(t=g,a=S,[{titlie:"",width:"0.1%"},{title:"\u65e5\u671f",dataIndex:"name",key:"name",width:"24%",render:function(e){return p.createElement("span",null,(0,C.Sn)(a,e))}},{title:"\u4f1a\u8bdd\u91cf",dataIndex:"count",key:"count",width:"24%",render:function(e){return p.createElement("span",null,(0,C.hE)(e))}},{title:function(e){return p.createElement("span",{style:{paddingLeft:20}},"\u73af\u6bd4",p.createElement(f.default,{overlay:"\u73af\u6bd4 = (\u5f53\u671f\u5173\u6ce8\u70b9\u58f0\u91cf\uff0d\u5f80\u671f\u5173\u6ce8\u70b9\u58f0\u91cf\uff09\xf7 \u5f80\u671f\u5173\u6ce8\u70b9\u58f0\u91cf \xd7 100%"},p.createElement("i",{style:{marginLeft:4},className:"icon-cem_file1"})))},dataIndex:"linkIndex",key:"linkIndex",width:"28%",render:function(e){return"--"===(0,T.Sv)(e.icon)?p.createElement("div",{style:{marginLeft:"40px"}},"--"):p.createElement("div",{style:{display:"inline-block",width:100,textAlign:"right"}},e.text,(0,T.Sv)(e.icon))}},{title:"\u64cd\u4f5c",key:"operator",width:"15%",render:function(e){return p.createElement("span",{style:{color:"#1890FF",cursor:"pointer"},onClick:function(){return t(e)}},"\u67e5\u770b\u6d88\u606f")}}]),pagination:v,tooltipText:"\u4f1a\u8bdd\u91cf",onMsgClick:P,timeType:S}),p.createElement(y.Z,{data:E,tableData:A,totalCount:D,totalPreCount:_,pageType:n,title:"\u5173\u6ce8\u70b9\u5206\u6790",loading:I,tableLoading:F,onChange:o,onMsgClick:d}),p.createElement(y.Z,{pageType:n,data:R,tableData:w,totalPreCount:b,totalCount:L,title:"\u8bdd\u9898\u5206\u6790",titleOverlay:p.createElement("div",{style:{maxWidth:324}},"\u6839\u636e\u6587\u672c\u76f8\u4f3c\u5ea6\u805a\u7c7b\u8bdd\u9898\uff0c\u5982\u679c2\u4e2a\u6587\u672c\u7684\u76f8\u4f3c\u5ea6\u9ad8\uff0c\u4f1a\u5224\u65ad\u4e3a\u540c\u4e00\u4e2a\u8bdd\u9898\u3002\u8bdd\u9898\u91cf\u8ba1\u7b97\u65b9\u5f0f\uff1a\u5982\u679c\u4e00\u6761\u4f1a\u8bdd\u4e2d\u51fa\u73b0\u5b8c\u5168\u4e00\u6837\u7684\u8bdd\u9898\u65f6\uff0c\u8bdd\u9898\u91cf\u53ea\u8ba11\uff0c\u4f46\u591a\u6b21\u4f1a\u8bdd\u4e2d\u51fa\u73b0\u76f8\u540c\u8bdd\u9898\u65f6\uff0c\u8bdd\u9898\u91cf\u8ba1\u591a\u6b21\u3002"),loading:k,tableLoading:M,onChange:o,onChartTypeChange:c,chartType:O,onMsgClick:d}))))};var v=["loading"],E=c.Z.service.spu,I=function(e){function t(t){var a,n;((a=e.call(this,t)||this).events=void 0,a.chartRef=p.createRef(),a._handleFilterReady=function(e,t){var n=a.state.outsideFilter;a.props.fetchData({position:n&&n.position?n.position:[],projectId:u.t.get(u.V.curProject).id,headerFilterParamsNew:e.headerFilterParamsNew,dateFilter:e.dateFilter,filterValues:t.fullInfo.filterValue,dateGroupType:o()(e.dateFilter.from,e.dateFilter.to)?"HOUR":"DAY"})},a._handleFilterChange=function(e,t,n){var r=a.state.chartType;a.props.fetchData((0,i.Z)({},e,{aspect1:"c1"===r?["\u54a8\u8be2/\u6c42\u52a9"]:void 0,filterValues:t.fullInfo.filterValue,dateGroupType:o()(e.dateFilter.from,e.dateFilter.to)?"HOUR":"DAY"}))},a._handleOnClickGoods=function(e){var t=a.props,n=t.headerFilterParamsNew,r=t.filterValues,l=t.dateFilter,o=t.projectId,c=t.dateGroupType,d=(0,T.LV)(e.name.replaceAll("/","-"),c),s=d.from,u=d.to,p={dateFilter:(0,i.Z)({},l,{numOfDays:1,dateGroupType:c,from:s,to:u,quickChoice:s.replace(/-/g,".")+" - "+u.replace(/-/g,".")}),filterModel:{project:[o]},projectId:o,filterTip:null,headerFilterParamsNew:n,filterValues:r};window.open("/inbox/service?"+encodeURIComponent(JSON.stringify(p)))},a._handelOnSessionMsgClick=function(e){var t=a.props,n=t.headerFilterParamsNew,r=t.filterValues,l=t.dateFilter,o=t.projectId,c=t.dateGroupType,d=(0,T.LV)(e[0].data.name.replaceAll("/","-"),c),s=d.from,u=d.to,p={dateFilter:(0,i.Z)({},l,{numOfDays:1,dateGroupType:c,from:s,to:u,quickChoice:s.replace(/-/g,".")+" - "+u.replace(/-/g,".")}),filterModel:{project:[o]},projectId:o,filterTip:null,headerFilterParamsNew:n,filterValues:r};window.open("/inbox/service?"+encodeURIComponent(JSON.stringify(p)))},a._handleOnMsgClick=function(e,t,n){var i=a.props,r=i.headerFilterParamsNew,l=i.filterValues,o=i.dateFilter,c=i.projectId;if("card"===t||"bar"===t){var d={dateFilter:"\u5f80\u671f"===e.seriesName?(0,T.yz)(o):o,filterModel:{project:[c]},projectId:c,filterTip:null,headerFilterParamsNew:n.includes("\u5173\u6ce8\u70b9")?(0,s.ZP)(r,(function(a){a.find((function(e){return"WAITER_MODEL"===e.id}))?a.find((function(e){return"WAITER_MODEL"===e.id})).values=[{id:"WAITER_ASPECT1",values:"card"===t?e:[e.name]}]:a.push({id:"WAITER_MODEL",values:[{id:"WAITER_ASPECT1",values:"card"===t?e:[e.name]}]})})):r,filterValues:n.includes("\u5173\u6ce8\u70b9")?(0,s.ZP)(l,(function(a){a.find((function(e){return"WAITER_MODEL"===e.id}))?a.find((function(e){return"WAITER_MODEL"===e.id})).values=[{id:"WAITER_ASPECT1",label:"\u4e00\u7ea7\u5173\u6ce8\u70b9",values:"card"===t?e:[e.name]}]:a.push({id:"WAITER_MODEL",label:"\u6a21\u578b",values:[{id:"WAITER_ASPECT1",label:"\u4e00\u7ea7\u5173\u6ce8\u70b9",values:"card"===t?e:[e.name]}]})})):l,topic1Names:n.includes("\u8bdd\u9898")?"card"===t?e:[e.name]:void 0};window.open("/inbox/service?"+encodeURIComponent(JSON.stringify(d)))}else if("table"===t){var u={dateFilter:"\u5f80\u671f"===e.barType?(0,T.yz)(o):o,filterModel:{project:[c]},projectId:c,filterTip:null,headerFilterParamsNew:n.includes("\u5173\u6ce8\u70b9")?(0,s.ZP)(r,(function(t){t.find((function(e){return"WAITER_MODEL"===e.id}))?t.find((function(e){return"WAITER_MODEL"===e.id})).values=[{id:"WAITER_ASPECT2",values:[e.name]}]:t.push({id:"WAITER_MODEL",values:[{id:"WAITER_ASPECT2",values:[e.name]}]})})):r,filterValues:n.includes("\u5173\u6ce8\u70b9")?(0,s.ZP)(l,(function(t){t.find((function(e){return"WAITER_MODEL"===e.id}))?t.find((function(e){return"WAITER_MODEL"===e.id})).values=[{id:"WAITER_ASPECT2",label:"\u4e8c\u7ea7\u5173\u6ce8\u70b9",values:[e.name]}]:t.push({id:"WAITER_MODEL",label:"\u6a21\u578b",values:[{id:"WAITER_ASPECT2",label:"\u4e8c\u7ea7\u5173\u6ce8\u70b9",values:[e.name]}]})})):l,topic2Names:n.includes("\u8bdd\u9898")?[e.name]:void 0};window.open("/inbox/service?"+encodeURIComponent(JSON.stringify(u)))}},a._handleOnChange=function(e,t,n){var i=n.includes("\u5173\u6ce8\u70b9")?"FOCUS":"TOPIC";a.props.fetchTableData({queryType:i,aspect1:e})},a._handleChartTypeChange=function(e){a.setState({chartType:e})},-1!==location.href.indexOf("/service/spu")&&location.search)&&(n=JSON.parse(decodeURIComponent(location.search.substring(1))));return a.state={outsideFilter:n,chartType:"c1"},a.events={onChange:a._handleOnChange,filterReady:a._handleFilterReady,filterChange:a._handleFilterChange,onClickGoods:a._handleOnClickGoods,onChartTypeChange:a._handleChartTypeChange,onMsgClick:a._handleOnMsgClick,onSessionMsgClick:a._handelOnSessionMsgClick},a}(0,r.Z)(t,e);var a=t.prototype;return a.componentDidMount=function(){},a.componentWillUnmount=function(){this.props.clean()},a.render=function(){return p.createElement(g,(0,i.Z)({},this.props,this.state,this.events))},t}(p.Component);const D=(0,d.connect)((function(e){var t=e.loading,a=(0,n.Z)(e,v);return(0,i.Z)({},a[E],{fetchingLineData:t.effects[E+"/fetchLineData"]||!1})}),(function(e){return{save:function(t){return e({type:E+"/save",payload:t})},clean:function(){return e({type:E+"/clean"})},fetchData:function(t){return e({type:E+"/fetchData",payload:t})},fetchLineData:function(t){return e({type:E+"/fetchLineData",payload:t})},fetchChartData:function(t){return e({type:E+"/fetchChartData",payload:t})},fetchTableData:function(t){return e({type:E+"/fetchTableData",payload:t})}}}))(I)}}]);