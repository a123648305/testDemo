"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[2934],{2402:(e,t,n)=>{n.r(t),n.d(t,{default:()=>C});var a=n(63366),o=n(87462),r=n(94578),i=n(67294),l=n(55609),c=n(26198),u=n(50976),s=n(8201),d=n(98191),f=n(70715),p=n(94644);const v=function(e){var t=e.data,n=e.loading,a=e.title,o=e.onClick,r=e.volType,l=i.useState(void 0),c=l[0],v=l[1];return i.useEffect((function(){if(c)if((0,s.P)(t)){var e=function(e,t,n){var a="negative"===n?"#D96969":"#1574B3";return{title:{text:t},color:a,dataset:{dimensions:"negative"===n?["\u673a\u578bID","\u673a\u578b","\u8d1f\u9762\u58f0\u91cf"]:["\u673a\u578bID","\u673a\u578b","\u58f0\u91cf"],source:e.map((function(e){return[e.id,e.type,e.count]})),sourceHeader:!1},tooltip:{trigger:"item",formatter:function(e){return""+e.marker+e.name+" \uff1a"+e.value[2]}},grid:{top:69,left:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value",boundaryGap:[0,.01],axisLabel:{color:"#262626",font:"12px "+f.I8+" 400"}},yAxis:{type:"category",data:e.map((function(e){return e.type})),inverse:!0,axisLabel:{color:"#262626",font:"12px "+f.I8+" 400",formatter:function(e){return e.length>16?e.substring(0,16)+"...":e}}},series:[{type:"bar",encode:{x:"negative"===n?"\u8d1f\u9762\u58f0\u91cf":"\u58f0\u91cf",y:"\u673a\u578b"},barMaxWidth:"22",large:!0,largeThreshold:400,progressive:0,itemStyle:a}]}}(t,a,r);c.clear(),c.setOption(e)}else v(void 0)}),[t,c]),i.createElement(s.Z,{loading:n,data:t,renderTitle:i.createElement(d.Z,{title:a,data:t,onMoreClick:function(e){return function(e,t,n,a,o){if("image"===t)(0,p._v)(e,a);else if("data"===t){var r=[n.reduce((function(e,t){return[].concat(e,[[t.id,t.type,t.count]])}),["negative"===o?["\u673a\u578bID","\u673a\u578b","\u8d1f\u9762\u58f0\u91cf\u603b\u6570"]:["\u673a\u578bID","\u673a\u578b","\u58f0\u91cf\u603b\u6570"]])];(0,p.aT)(r,a)}}(c,e,t,a,r)}})},i.createElement(u.Z,{theme:"yunting_neg_pos",option:{},style:{width:"100%",height:"100%"},onChartReady:function(e){return v(e)},onEvents:{click:o}}))};const m=function(e){var t=e.brand,n=e.loading,a=e.volumeData,o=e.negativeVolData,r=e.onFilterChange,l=e.onVolumeClick;return i.createElement("div",{className:"yt_social_modelsTop_wrapper"},i.createElement(c.Z,{onReady:r,onChange:r,pageType:"SOCIAL_SERIES_TOP10"}),i.createElement("div",{className:"content",id:"social_modelsTop_content"},i.createElement("div",{className:"social_top10_volume_chart"},i.createElement(v,{loading:n,data:a,title:t+"\u673a\u578b\u58f0\u91cfTop10",volType:"normal",onClick:function(e,t){return l(e,t,"all")}}),i.createElement(v,{loading:n,data:o,title:t+"\u673a\u578b\u8d1f\u9762\u58f0\u91cfTop10",volType:"negative",onClick:function(e,t){return l(e,t,"negative")}}))))};var g=n(35239),y=n(90126),h=n(64396),E=["loading"],T=h.Z.social.models.top,_=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleOnVolumeClick=function(e,t,a){var o=e.componentType,r=e.seriesType,i=e.value,l=n.props,c=l.dateFilter,u=l.filterValue,s=l.projectId,d=l.brand,f=u.some((function(e){return"VOC_ASPECT"===e.id}))&&u.find((function(e){return"VOC_ASPECT"===e.id})).values,p=u.some((function(e){return"TAG_RULE"===e.id}))&&u.find((function(e){return"TAG_RULE"===e.id})).values,v=u.some((function(e){return"DEFAULT"===e.id}))&&u.find((function(e){return"DEFAULT"===e.id}));if("series"===o&&"bar"===r){var m={dateFilter:c,projectId:s,filterModel:{project:[s],brandsSeries:[{id:"series",special:"brandsSeries",values:[i[0]]}],messageType:["QUE_ANS_QUESTION","QUE_ANS_ANSWER","WEIBO","WEIBO_REPORT","COMMON_POST","NEWS_TEXT","COMPLAINT"],escore:"all"===a?["1","0","-1"]:["-1"]},filterTip:"\u8206\u60c5\u770b\u677f/\u673a\u578b\u5206\u6790/\u673a\u578bTop10/"+("all"===a?d+"\u673a\u578b\u58f0\u91cfTop10":d+"\u673a\u578b\u8d1f\u9762\u58f0\u91cfTop10")};p&&(m.filterModel.tag=p.map((function(e){return{id:e.id,special:"tag",values:e.values}}))),v&&v.values.some((function(e){return"SOURCE"===e.id}))&&(m.filterModel.source=v.values.find((function(e){return"SOURCE"===e.id})).values),f&&(m.filterModel.vocAspect=(0,y.ou)(f)),window.open("/inbox/public?"+encodeURIComponent(JSON.stringify(m)))}},n._handleOnFilterChange=function(e){n.props.fetchDatas((0,o.Z)({},e,{projectId:g.t.get(g.V.curProject).id}))},n.state={},n.event={onVolumeClick:n._handleOnVolumeClick,onFilterChange:n._handleOnFilterChange},n}return(0,r.Z)(t,e),t.prototype.render=function(){return i.createElement(m,(0,o.Z)({},this.props,this.state,this.event))},t}(i.PureComponent);const C=(0,l.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,E);return(0,o.Z)({},n[T],{loading:t.effects[T+"/fetchVolumeData"]||!1,negativeLoading:t.effects[T+"/fetchNegativeVolumeData"]||!1})}),(function(e){return{fetchDatas:function(t){return e({type:T+"/fetchDatas",payload:t})},fetchVolumeData:function(t){return e({type:T+"/fetchVolumeData",payload:t})},fetchNegativeVolumeData:function(t){return e({type:T+"/fetchNegativeVolumeData",payload:t})},save:function(t){return e({type:T+"/save",payload:t})},clean:function(t){return e({type:T+"/clean",payload:t})}}}))(_)}}]);