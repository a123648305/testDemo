(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[1433],{78496:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>y});var a=n(37316),o=n.n(a),t=n(67154),r=n.n(t),a=n(85354),i=n.n(a),t=n(67294),C=n.n(t),l=n(70715),O=n(39432),D=n(90126),a=function(a){function e(){for(var o,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(o=a.call.apply(a,[this].concat(t))||this).dimensions=void 0,o.source=void 0,o.chartRef=void 0,o.mColor=l.Fq.slice(),o.chartLength=0,o.getChartRef=function(e){return o.chartRef=e},o.setValue=function(e){o.chartLength=e.length,o.dimensions=["日期"],o.source=e.filter(function(e){return e}).reduce(function(n,e,a){var t=D.fv[e.name.toLocaleLowerCase()];return t&&o.mColor.splice(a,0,t[0]),o.dimensions.push(e.name),e.dateList.forEach(function(e,t){0===a?n.push([e.date,e.count]):n[t].push(e.count)}),n},[])},o.getOption=function(r,i){return{color:o.mColor,title:{text:r},grid:{top:80,left:32,right:"4%",bottom:40,containLabel:!0},dataset:[{source:o.source,dimensions:o.dimensions}],legend:{top:40,left:20,itemWidth:14,itemHeight:12,type:"scroll",pageIconSize:12,icon:l.W4.lineRing},dataZoom:[{show:"slider",bottom:15,xAxisIndex:0,height:15,handleSize:"100%",showDetail:!1}],tooltip:{trigger:"item",formatter:function(e){var t=e.name,n=e.marker,a=e.seriesName,o=e.seriesIndex,o=e.data[o+1];return'<span class="yt_echart_tooltip_title">'+("舆情声量走势对比"===r?"声量":"舆情负面声量走势对比"===r?"负面声量":"正面声量")+'<span style="color: #8C8C8C;font-weight: 500;">（'+(0,O.yV)(i,t)+"）</span></span><br />"+n+" "+a+"："+O.ZP.getApproximateNum(o)}},xAxis:{type:"category",boundaryGap:!1,axisLabel:{formatter:function(e){return(0,O.yV)(i,e)}}},yAxis:{type:"value"},series:Array.from({length:o.chartLength}).map(function(e,t){return{type:"line"}})}},o}return i()(e,a),e.prototype.renderChart=function(e,t,n){this.setValue(e),this.chartRef.clear(),this.chartRef.setOption(this.getOption(t,n))},e}(C().PureComponent),u=n(8201),p=n(98191),h=n(50976),d=n(60496),c=n(94644),t=n(45697),t=n.n(t),a=function(o){function e(){for(var a,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(a=o.call.apply(o,[this].concat(t))||this).handleOnDateChange=function(e){var t=a.props,n=t.dateType,t=t.onFilterChange,n=Object.keys(n)[0];t&&t(((t={})[n]=e,t))},a.handleOnMoreClick=function(e){var t=a.props,n=t.title,t=t.value;"image"===e&&a.chartRef?(0,c._v)(a.chartRef,n):"data"===e&&(0,u.P)(t)&&(0,c.aT)([[a.dimensions].concat(a.source)],n)},a.handleOnFlavorChange=function(e){var t=a.props,n=t.dtFlavor,t=t.onFlavorChange,n=Object.keys(n)[0];t&&t(((t={})[n]=e,t))},a}i()(e,o);var t=e.prototype;return t.componentDidUpdate=function(e){var t=e.value,e=this.props.value;(0,u.P)(e)&&JSON.stringify(t)!==JSON.stringify(e)&&this.renderChart(),!(0,u.P)(e)&&this.chartRef&&(this.chartRef=void 0)},t.componentDidMount=function(){this.renderChart()},t.renderChart=function(){var e=this.props,t=e.value,n=e.title,e=e.dateType;(0,u.P)(t)&&this.chartRef&&(e=Object.values(e)[0],o.prototype.renderChart.call(this,t,n,e))},t.render=function(){var e=this.props,t=e.value,n=e.loading,a=e.title,o=e.className,r=e.dtFlavor,i=e.dateType,l=e.onClick,c=e.dateOptions,s=Object.keys(r)[0],e=Object.keys(i)[0];return C().createElement(u.Z,{className:"yt_social_overview_line_chart_wrapper "+o,data:t,loading:n,renderTitle:C().createElement(p.Z,{title:a,data:t,onMoreClick:this.handleOnMoreClick},C().createElement(d.Z,{onChange:this.handleOnDateChange,onFlavorChange:this.handleOnFlavorChange,activeObj:i[e],flavor:r[s],options:c}))},C().createElement(h.Z,{onChartReady:this.getChartRef,onEvents:{click:l},theme:"yunting_multi_color",className:"yt_echarts_style",option:{},style:{height:"100%"}}))},e}(a);const _=a;a.propTypes={title:t().string,className:t().string,value:t().any,onFilterChange:t().func,dtFlavor:t().object,dateType:t().object,onFlavorChange:t().func,dateOptions:t().arrayOf({title:t().string,value:t().value})};var s=n(92360),f={positiveCount:"正面",neutralCount:"中性",negativeCount:"负面"},a=function(o){function e(){for(var a,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(a=o.call.apply(o,[this].concat(t))||this)._handleOnMoreClick=function(e){var t=a.props,n=t.title,t=t.data;"image"===e?(0,c.OH)(Object.values(a.chartRefObj),n,a.dimensions.slice(1)):"data"===e&&(0,u.P)(t)&&(0,c.aT)([[a.dimensions].concat(a.source)],n)},a}i()(e,o);var t=e.prototype;return t.componentDidUpdate=function(e){var t=e.data,e=this.props.data;(0,u.P)(e)&&JSON.stringify(t)!==JSON.stringify(e)&&(this.setValue(e),this.forceUpdate())},t.render=function(){var o=this,e=this.props,t=e.className,r=e.data,n=e.loading,a=e.title,i=e.onClick,e=(0,u.P)(r)?Math.ceil(r.length/3):0;return C().createElement(u.Z,{data:r,loading:n,className:"yt_voice_ring_chart_wrapper "+t,renderTitle:C().createElement(p.Z,{title:a,data:null,onMoreClick:this._handleOnMoreClick})},C().createElement(s.Carousel,{autoplay:!1,indicatorPosition:"none",arrow:"hover",className:1===e?"no_nav":""},r&&r instanceof Array&&Array.from({length:e}).map(function(e,a){return C().createElement(s.Carousel.Item,{key:a},C().createElement("div",{className:"ring_chart_wrapper"},Array.from({length:3}).map(function(e,t){var n=r[3*a+t];return n?C().createElement(h.Z,{onChartReady:function(e){var t;return o.setChartRef(((t={})[n.name]=e,t))},onEvents:{click:i},key:n.name,className:"ring_chart",theme:"yunting_pos_neu_neg",style:{height:"100%"},option:o.getOption(n)}):""})))})))},e}(function(o){function e(){for(var t,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(t=o.call.apply(o,[this].concat(n))||this).source=void 0,t.dimensions=void 0,t.chartLength=0,t.totalCount=0,t.chartRefObj={},t.setChartRef=function(e){t.chartRefObj=r()({},t.chartRefObj,e)},t}i()(e,o);var t=e.prototype;return t.setValue=function(e){var a=this;this.totalCount=0,this.chartLength=e.length,this.dimensions=["日期"],this.source=e.filter(function(e){return e}).reduce(function(e,t,n){return a.dimensions.push(t.name),0===n?(e.push(["正面",t.positiveCount]),e.push(["中性",t.neutralCount]),e.push(["负面",t.negativeCount])):(e[0].push(t.positiveCount),e[1].push(t.neutralCount),e[2].push(t.negativeCount)),a.totalCount+=t.positiveCount+t.neutralCount+t.negativeCount,e},[])},t.getOption=function(t){var e=t.positiveCount+t.neutralCount+t.negativeCount,n={title:{text:t.name+"（"+(0===this.totalCount||0===e?0:(e/this.totalCount*100).toFixed(2))+"%）",padding:[20,2],subtext:"{a|声量}\n{b|"+(0,O.uf)(e)+"}",subtextStyle:{rich:{a:{color:"#8C8C8C",verticalAlign:"bottom",fontSize:14,lineHeight:50},b:{color:"#262626",fontSize:14,lineHeight:30,verticalAlign:"bottom"}}}},tooltip:{formatter:function(e){var t=e.marker,n=e.name,a=e.percent;return[t+' <span style="color: #262626; font-weight: 500; font-size: 14px">'+n+"声量</span>",'<span style="font-size: 12px; margin-left: 20px">'+n+"声量："+e.value+"</span>",'<span style="font-size: 12px; margin-left: 20px">'+n+"占比："+a+"%</span>"].join("</br>")}},series:[{type:"pie",hoverOffset:4,center:["70%","50%"],radius:["40%","70%"],label:{show:!1},data:Object.keys(f).map(function(e){return{name:f[e],value:t[e]}})}]},e=D.fv[t.name.toLocaleLowerCase()];return e&&(n.color=e),n},e}(C().PureComponent));const E=a;a.propTypes={title:t().string,loading:t().bool,className:t().string,data:t().any};var F=n(8833);const g=function(e){var t=e.allVoicData,n=e.allDateType,a=e.allDtFlavor,o=e.fetchingAllVoiceData,r=e.compareData,i=e.fetchingCompareData,l=e.negVoiceData,c=e.negDateType,s=e.negDtFlavor,u=e.fetchingNegVoiceData,p=e.posVoiceData,h=e.posDateType,d=e.posDtFlavor,f=e.fetchingPosVoiceData,g=e.dateOptions,m=e.onFilterChange,v=e.onFilterReady,y=e.onFlavorChange,e=e.onVolumeClick;return C().createElement(F.Z,{hour:!0,className:"yt_social_overview_wrapper",pageType:"SOCIAL_OVERVIEW",onReady:v,onChange:m},C().createElement("div",{className:"content"},C().createElement(_,{key:"all",title:"舆情声量走势对比",value:t,dtFlavor:{allDtFlavor:a},dateType:{allDateType:n},className:"content_chart",loading:o,onFilterChange:m,onFlavorChange:y,onClick:e,dateOptions:g}),C().createElement(E,{data:r,title:"舆情声量对比",className:"content_chart",loading:i,onClick:e}),C().createElement("div",null,C().createElement(_,{key:"neg",title:"舆情负面声量走势对比",dtFlavor:{negDtFlavor:s},value:l,className:"content_chart",dateType:{negDateType:c},loading:u,onFilterChange:m,onFlavorChange:y,onClick:e,dateOptions:g}),C().createElement(_,{key:"pos",title:"舆情正面声量走势对比",value:p,loading:f,className:"content_chart",dateType:{posDateType:h},dtFlavor:{posDtFlavor:d},onFilterChange:m,onFlavorChange:y,onClick:e,dateOptions:g}))))};var m=n(35239),t=n(55609),R=n(87219),v=n(64396).Z.social.overview,n=function(t){function e(e){var y=t.call(this,e)||this;return y._handleOnFilterReady=function(e,t,n){y.props.fetchParams(r()({},e,{projectId:m.t.get(m.V.curProject).id,dateOptions:n.dateOptions,defaultDateType:n.defaultDateType}))},y._handleOnFilterChange=function(e,t,n){var a;e.filterValue?(a=JSON.stringify(e.dateFilter)!==JSON.stringify(y.props.dateFilter),a=r()({},e,{dateOptions:n.dateOptions,defaultDateType:n.defaultDateType,filtedObjs:a?void 0:(0,D.ZT)(y.props,e)}),y.props.fetchParams(a)):e.allDateType?y.props.fetchAllVoicData(r()({},e,{projectId:m.t.get(m.V.curProject).id})):e.negDateType?y.props.fetchNegVoicData(r()({},e,{projectId:m.t.get(m.V.curProject).id})):e.posDateType&&y.props.fetchPosVoicData(r()({},e,{projectId:m.t.get(m.V.curProject).id}))},y._handleOnFlavorChange=function(e){y.props.updateFlavors(e)},y._handleOnVolumeClick=function(e,t){var r=e.name,n=e.componentSubType,a=e.seriesName,o=y.props,i=o.projectId,l=o.filterValue,c=o.dateFilter,s=o.allDateType,u=o.allVoicData,p=o.negDateType,h=o.negVoiceData,d=o.posDateType,f=o.posVoiceData,g=o.compareData,m=l.some(function(e){return"VOC_ASPECT"===e.id})&&l.find(function(e){return"VOC_ASPECT"===e.id}).values,e=t._model.option.title[0].text,v="pie"===n?e.split("（")[0]:e,o=("pie"===n?g.find(function(e){return e.name===v}):u.find(function(e){return e.name===a})).id,t=l.some(function(e){return"TAG_RULE"===e.id})&&l.find(function(e){return"TAG_RULE"===e.id}).values,e=l.some(function(e){return"DEFAULT"===e.id})&&l.find(function(e){return"DEFAULT"===e.id}),g=l.some(function(e){return"BRAND_SERIES"===e.id})&&l.find(function(e){return"BRAND_SERIES"===e.id}).values.some(function(e){return"SERIES"===e.id})&&l.find(function(e){return"BRAND_SERIES"===e.id}).values.find(function(e){return"SERIES"===e.id}).values,l=g&&g.map(function(e){return e.split("_")[0]}),n={projectId:i,dateFilter:"pie"===n?c:(0,R.ZP)(c,function(e){var t="舆情声量走势对比"===v?s:"舆情负面声量走势对比"===v?p:d,n="舆情声量走势对比"===v?u[0].dateList.map(function(e){return e.date}):"舆情负面声量走势对比"===v?h[0].dateList.map(function(e){return e.date}):f[0].dateList.map(function(e){return e.date}),a=(0,O.LV)(r,t),o=a.from,a=a.to;"DAY"!==t&&"HOUR"!==t&&(String(r)===String(n[0])?o=e.from:String(r)===String(n[n.length-1])&&(a=e.to)),e.from=o,e.to=a}),filterModel:{brandsSeries:[{id:"brand",special:"brandsSeries",values:[o]}],escore:"中性"===r?["0"]:"负面"===r||"舆情负面声量走势对比"===v?["-1"]:"正面"===r||"舆情正面声量走势对比"===v?["1"]:["1","0","-1"],messageType:["QUE_ANS_QUESTION","QUE_ANS_ANSWER","WEIBO","WEIBO_REPORT","COMMON_POST","NEWS_TEXT","COMPLAINT"],project:[i]},filterTip:"pie"===n?"舆情看板/舆情概览/舆情声量对比":"舆情看板/舆情概览/"+v};g&&n.filterModel.brandsSeries.unshift({id:"series",special:"brandsSeries",values:l}),t&&(n.filterModel.tag=t.map(function(e){return{id:e.id,special:"tag",values:e.values}})),e&&e.values.some(function(e){return"SOURCE"===e.id})&&(n.filterModel.source=e.values.find(function(e){return"SOURCE"===e.id}).values),m&&(n.filterModel.vocAspect=(0,D.ou)(m)),window.open("/inbox/public?"+encodeURIComponent(JSON.stringify(n)))},y.event={onFilterReady:y._handleOnFilterReady,onFilterChange:y._handleOnFilterChange,onFlavorChange:y._handleOnFlavorChange,onVolumeClick:y._handleOnVolumeClick},y}i()(e,t);var n=e.prototype;return n.componentWillUnmount=function(){},n.render=function(){return C().createElement(g,r()({},this.props,this.state,this.event))},e}(C().PureComponent);const y=(0,t.connect)(function(e){var t=e.loading,e=o()(e,["loading"]);return r()({},e[v],{fetchingAllVoiceData:t.effects[v+"/fetchAllVoicData"]||!1,fetchingCompareData:t.effects[v+"/fetchVoicCompareDate"]||!1,fetchingNegVoiceData:t.effects[v+"/fetchNegVoicData"]||!1,fetchingPosVoiceData:t.effects[v+"/fetchPosVoicData"]||!1})},function(t){return{save:function(e){return t({type:v+"/save",payload:e})},clean:function(){return t({type:v+"/clean"})},fetchParams:function(e){return t({type:v+"/fetchParams",payload:e})},fetchAllVoicData:function(e){return t({type:v+"/fetchAllVoicData",payload:e})},fetchNegVoicData:function(e){return t({type:v+"/fetchNegVoicData",payload:e})},fetchPosVoicData:function(e){return t({type:v+"/fetchPosVoicData",payload:e})},fetchVoicCompareDate:function(e){return t({type:v+"/fetchVoicCompareDate",payload:e})},updateFlavors:function(e){return t({type:v+"/updateFlavors",payload:e})}}})(n)},8833:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var t=n(67154),l=n.n(t),t=n(37316),c=n.n(t),t=n(67294),s=n.n(t),u=n(26198),p=n(97194),t=n(45697),n=n.n(t),t=function(e){var t=e.getFilterRef,n=e.className,a=e.hour,o=e.children,r=e.onReady,i=e.onChange,e=c()(e,["getFilterRef","className","hour","children","onReady","onChange"]);return s().createElement("div",{className:n},s().createElement(u.Z,l()({ref:t,onReady:function(){r.apply(null,[].concat(Array.prototype.slice.call(arguments),[(0,p.X)(arguments[0].dateFilter.numOfDays,a)]))},onChange:function(){i.apply(null,[].concat(Array.prototype.slice.call(arguments),[(0,p.X)(arguments[0].dateFilter.numOfDays,a)]))}},e)),o)};const a=t;t.propTypes={className:n().string,hour:n().bool,onReady:n().func,onChange:n().func,pageType:n().string,titles:n().shape({titel:n().string,url:n().string,state:n().object})}}}]);