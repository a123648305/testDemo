"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[994],{40994:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Je});var a=n(63366),i=n(87462),o=n(94578),r=n(67294),l=n(55609),s=n(19586);const c=function(e){e.getRef;var t=e.onChange,n=e.title,a=e.showList,i=r.useState(void 0),o=i[0],l=i[1];return r.createElement(s.Z,{ref:function(e){l(e)},title:n,showList:a,onChange:t,onFilterReady:function(){return t(o.getValue())}})};var u=n(50976),p=n(25713),m=n(39432),d=n(43036),f=n(70715),h=function(e){return e>70?"\u5353\u8d8a":e>50&&e<=70?"\u4f18\u79c0":e>10&&e<=50?"\u826f\u597d":e>5&&e<=10?"\u7cdf\u7cd5":"\u7cdf\u7cd5\u900f\u9876"},v=["\u4e0a\u5468","\u4e0a\u6708"],g=["#D96969","#D07B49","#CDB446","#15B374"],y={true:{image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAKCAYAAAHgCR+lAAAAAXNSR0IArs4c6QAAAHxJREFUGBljYMAHRLeWJjAx/Ps/nwmkilHqTAPX7+dfvjIyMlwDaxPdXPIfrh+kGMRhFNtScvX/fwYtVkkebrAsTBnYFLAIkEDhMIJEJbZVav37++c0iM3EzGL6wqv9GsiwBUDD4kGCMAC0fyGMzQAyHGYBSBDFXLgqfBIASAUmOCx5HngAAAAASUVORK5CYII=",color:"#15B374"},false:{image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAKCAYAAAHgCR+lAAAAAXNSR0IArs4c6QAAAHVJREFUGBljYEAFt3NztRAiNzMz/zOBuEyMDAzfwOIgIRCD8VZm5gIgKx4sCiJgMmANMFEUDiNMCdC0hUxMLCzaIGPVpk9PgCkHGwJTBRJE0Q9XhU+C8VlDA9eXly9PAx0H9grQjms84uKmcN23srISQBgmAAAj0yYcgW4zAgAAAABJRU5ErkJggg==",color:"#D96969"}},x=function(e,t){return 0===t?[]:[{type:"line",left:"60%",top:"50%",silent:!0,shape:{x1:0,y1:0,x2:160,y2:0},style:{fill:"#E5E5E5",stroke:"#E5E5E5"}}].concat(v.map((function(t,n){var a=e.lastWeek,i=e.incWeek;return 1===n&&(a=e.lastMonth,i=e.incMonth),E(n,a,i)})))},E=function(e,t,n){return{type:"group",left:"60%",top:0===e?"58%":"66%",silent:!0,children:[{type:"text",style:{text:v[e],fill:"#8C8C8C",font:"14px "+f.I8}},{type:"line",shape:{x1:45,y1:2,x2:45,y2:12},style:{fill:"#E5E5E5",stroke:"#E5E5E5"}}].concat(C(t,n))}},C=function(e,t){var n=62+(0,m.jD)(e.toString())+16;return e?[{type:"text",left:62,style:{text:e,fill:"#262626",font:"14px "+f.I8}},{type:"image",left:n,top:2,style:{image:y[t>=0].image}},{type:"text",left:n+10,style:{text:Math.abs(t),fill:y[t>=0].color,font:"14px "+f.I8}}]:[{type:"text",left:62,style:{text:"\u65e0",fill:"#262626",font:"14px "+f.I8}}]},N=[{title:"\u5bfc\u51fa\u56fe\u7247",type:"image"},{title:"\u5bfc\u51fa\u6570\u636e",type:"data"}],b=function(e){return(100*e).toFixed(0)-0},T=n(30133),A=n(94184),S=n.n(A),w=n(45697),k=n.n(w),D=n(92360);var P=function(e){return r.createElement("div",{className:S()("yt_section_rate_component_wrapper",e.className),id:e.id},r.createElement("div",{className:"section_content"},function(e){var t=e.data,n=e.emptyHint,a=void 0===n?"\u6682\u65e0\u6570\u636e":n,i=e.errorHint,o=void 0===i?"\u52a0\u8f7d\u5931\u8d25":i,l=e.defTitle,s=e.loading,c=void 0!==s&&s;switch(t){case void 0:return r.createElement(T.Z,null);case"error":return r.createElement(r.Fragment,null,r.createElement("div",{className:"title empty-title",style:{fontWeight:"bold"}},l),r.createElement("div",{className:"error-block"},o));case null:case"empty":return r.createElement(r.Fragment,null,r.createElement("div",{className:"title empty-title",style:{fontWeight:"bold"}},l),r.createElement("div",{className:"empty-block"},a));default:return r.createElement(D.Loading,{loading:c,style:{height:"100%"}},e.children)}}(e)))};const W=P;P.propTypes={className:k().string,emptyHint:k().string,defTitle:k().string,loading:k().bool};var M="NPS\u503c",I=void 0;function R(e,t,n,a,i){e&&t&&new Promise((function(o){var r=function(e,t,n,a){var i={npsValue:(100*e.npsValue).toFixed(0)-0,lastWeek:(100*e.lastWeekNpsValue).toFixed(0)-0,incWeek:(100*(e.thisWeekNpsValue-e.lastWeekNpsValue)).toFixed(0)-0,lastMonth:(100*e.lastMonthNpsValue).toFixed(0)-0,incMonth:(100*(e.thisMonthNpsValue-e.lastMonthNpsValue)).toFixed(0)-0};return{title:{text:t},tooltip:{formatter:function(e){var t=e.seriesName,n=e.data.value,a="";return n<-50?a=g[0]:-50<=n&&n<0?a=g[1]:0<=n&&n<50?a=g[2]:n<=100&&(a=g[3]),['<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:'+a+';"></span><span style="font-size: 16px; line-height: 30px">'+t+"</span>","NPS\u503c\uff1a"+n].join("<br/>")}},graphic:[{type:"text",left:"60%",top:0===n?"35%":"25%",silent:!0,style:{text:h(i.npsValue),fill:"#262626",font:"30px "+f.I8}},{type:"text",left:"60%",top:0===n?"50%":"38%",silent:!0,style:{text:"\u5f53\u524d\u8868\u73b0",fill:"#8C8C8C",font:"20px "+f.I8}}].concat(x(i,n)),series:[{name:"NPS",type:"gauge",min:-100,max:100,center:["30%","52%"],splitNumber:4,radius:"60%",axisLine:{show:!0,lineStyle:{color:[[.25,"#D96969"],[.5,"#D07B49"],[.75,"#CDB446"],[1,"#15B374"]],width:20}},splitLine:{show:!0,length:20},axisTick:{show:!1},axisLabel:{color:"#262626",fontWeight:"bold"},detail:{offsetCenter:[0,"90%"],formatter:["{a|"+i.npsValue+"}","{b|NPS}"].join("\n"),rich:{a:{color:"#262626",fontSize:40,lineHeight:60,fontFamily:f.I8},b:{color:"#262626",fontSize:12,fontFamily:f.I8}}},title:{show:!1},pointer:{length:"80%",width:6},itemStyle:{color:"#1574B3"},data:[{value:i.npsValue}]}]}}(e,n,a,t.getWidth());i(t.getWidth()),o(r)})).then((function(e){t.clear(),t.setOption(e)}))}const j=function(e){var t=e.data,n=e.onMoreClick,a=e.loading,i=e.chartType,o=void 0===i?0:i,l=e.resizeTime,s=r.useState(void 0),c=s[0],f=s[1],v=r.useState(0),g=v[0],y=v[1];return r.useEffect((function(){R(t,c,M,o,y)}),[t,c]),r.useEffect((function(){I&&clearTimeout(I),I=setTimeout((function(){I=void 0,R(t,c,M,o,y)}),500)}),[l]),r.createElement(W,{className:"nc-npsvalue",data:t,defTitle:M,loading:a},r.createElement("div",{className:"title"},r.createElement("span",{style:{marginLeft:(0,m.jD)(M,14)+8}},r.createElement(d.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:r.createElement("div",null,r.createElement("div",null,"\u51c0\u63a8\u8350\u503c(NPS)=(\u63a8\u8350\u8005\u6570/\u603b\u6837\u672c\u6570)x100%-(\u8d2c\u635f\u8005\u6570/\u603b\u6837\u672c\u6570)x100%."),r.createElement("div",null,"NPS\u7684\u5f97\u5206\u503c\u572850%\u4ee5\u4e0a\u88ab\u8ba4\u4e3a\u662f\u4e0d\u9519\u7684\u3002\u5982\u679cNPS\u7684\u5f97\u5206\u503c\u572870%-80%\u4e4b\u95f4\u5219\u8bc1\u660e\u60a8\u4eec\u516c\u53f8\u62e5\u6709\u4e00\u6279\u9ad8\u5fe0\u8bda\u5ea6\u7684\u597d\u5ba2\u6237\u3002\u8c03\u67e5\u663e\u793a\u5927\u90e8\u5206\u516c\u53f8\u7684NPS\u503c\u57285%-10%\u4e4b\u95f4\u5f98\u5f8a\u3002\u5176\u4e2d2005\u5e74\u5de6\u53f3\u7edf\u8ba1\u5206\u6790\uff1a\u4e9a\u9a6c\u900a\u7684NPS\u503c\u662f73%\uff1bebay\u662f71%\uff1b\u82f9\u679c\u662f66%\uff1b\u8054\u90a6\u5feb\u9012\u662f56%\uff1b\u6234\u5c14\u662f50%"))},r.createElement("i",{className:"icon-cem_file1"}))),r.createElement(p.Z,{onClick:function(e){return function(e,t,n,a,i){var o=void 0;if("image"===t)o=e;else if("data"===t){var r,l,s=b(n.npsValue),c=[["NPS\u503c","\u5f53\u524d\u8868\u73b0"],[s,h(s)]];1===i&&((r=c[0]).push.apply(r,["\u4e0a\u5468NPS\u503c","\u672c\u5468NPS\u503c","\u4e0a\u6708NPS\u503c","\u672c\u6708NPS\u503c"]),(l=c[1]).push.apply(l,[b(n.lastWeekNpsValue),b(n.thisWeekNpsValue),b(n.lastMonthNpsValue),b(n.thisMonthNpsValue)])),o=[c]}a({type:t,obj:o,name:e.getOption().title[0].text})}(c,e,t,n,o)},options:N,style:{float:"right"}})),c&&r.createElement("span",{style:{position:"absolute",top:0===o?"50%":"38%",left:.6*g+84,transition:"all 0.3s",zIndex:1}},r.createElement(d.Z,{placement:"top",overlayClassName:"yt-nps-popover-layout-wrapper",overlay:r.createElement("div",{className:"overlay"},r.createElement("span",null,"\u5f53\u524d\u8868\u73b0"),r.createElement("div",null,r.createElement("span",null,"\u5353\u8d8a"),r.createElement("span",null,"NPS\u503c\u5927\u4e8e70%\u3002\u5982\u4e9a\u9a6c\u900a\uff0c\u5b83\u62e5\u6709\u5927\u91cf\u5fe0\u8bda\u5ba2\u6237\u3002")),r.createElement("div",null,r.createElement("span",null,"\u4f18\u79c0"),r.createElement("span",null,"NPS\u7684\u5f97\u5206\u503c\u572850%\u4ee5\u4e0a\u88ab\u8ba4\u4e3a\u662f\u4e0d\u9519\u7684\u3002")),r.createElement("div",null,r.createElement("span",null,"\u826f\u597d"),r.createElement("span",null,"NPS\u503c\u5927\u4e8e10%\uff0c\u6b64\u65f6\u5df2\u7ecf\u5f00\u59cb\u8131\u79bb\u5e73\u5eb8\u516c\u53f8\u7684\u8303\u7574")),r.createElement("div",null,r.createElement("span",null,"\u7cdf\u7cd5"),r.createElement("span",null,"\u5927\u90e8\u5206\u516c\u53f8\u7684NPS\u503c\u8fd8\u662f\u57285%-10%\u4e4b\u95f4\u5f98\u5f8a\u3002\u6240\u4ee5\u6211\u4eec\u5c06\u5904\u4e8e\u8fd9\u4e00\u533a\u95f4\u7684\u503c\u5b9a\u4e49\u4e3a\u7cdf\u7cd5\u3002")),r.createElement("div",null,r.createElement("span",null,"\u7cdf\u7cd5\u900f\u9876"),r.createElement("span",null,"NPS\u503c\u5c0f\u4e8e5%\u65f6\uff0c\u6211\u4eec\u53ea\u80fd\u7528\u8fd9\u6837\u7684\u8bcd\u6765\u5f62\u5bb9\u4e86\u3002")))},r.createElement("i",{className:"icon-cem_file1"}))),r.createElement(u.Z,{theme:"yunting_pos_neu_neg",option:{},style:{width:"100%",height:"100%"},onChartReady:function(e){return f(e)}}))};var O={client:"\u5ba2\u6237\u5206\u7c7b",score:"\u5177\u4f53\u5206\u503c"},V=function(e,t,n){return[e.positiveCount,e.neutralCount,e.negativeCount].map((function(a,i){var o=(0===e.total?0:(a/e.total*100).toFixed(2))+"%",r=(0,m.jD)(o,14)-2;return{type:"group",silent:!0,left:.6*t+30,top:(.3+.15*i)*n+16*(i+1),children:[{type:"text",style:{text:o}},{type:"text",left:r,style:{text:"\uff08"+a+"\uff09",fill:"#8C8C8C"}}]}}))},F=function(e,t){return{type:"group",silent:!0,top:74,left:16,children:[{type:"text",style:{text:m.ZP.formatNumber(e.total),font:"12px "+f.I8}}].concat([e.posTotal,e.neuTotal,e.negTotal].map((function(n,a){var i=(0===e.total?0:(n/e.total*100).toFixed(2))+"%";return{type:"group",left:98*t+30*(a+1)+(52+70*t)*a,children:[{type:"text",style:{x:0,text:i,font:"12px "+f.I8}},{type:"text",style:{x:(0,m.jD)(i,12),text:"\uff08"+m.ZP.formatNumber(n)+"\uff09",font:"12px "+f.I8,fill:"#8c8c8c"}}]}})))}},z=function(e,t,n){var a=0,i=0,o=0,r=0,l=0,s=e.scoreQuestionnaireCount.map((function(e,t){return l=Math.max(l,e),a+=e,t<7?r+=e:7===t||8===t?o+=e:9!==t&&10!==t||(i+=e),e})),c={total:a,posTotal:i,neuTotal:o,negTotal:r,maxCount:l,seriesData:[{data:s.slice(0,7).map((function(e,t){return{value:e,score:t,total:a,itemStyle:{color:"#D96969"}}})),name:"\u8d2c\u635f\u8005"},{data:s.slice(7,9).map((function(e,t){return{value:e,score:t+7,total:a,itemStyle:{color:"#1574B3"}}})),name:"\u88ab\u52a8\u8005"},{data:s.slice(9).map((function(e,t){return{value:e,score:t+9,total:a,itemStyle:{color:"#15B374"}}})),name:"\u63a8\u8350\u8005"}]},u=n/700;return{title:{text:t},grid:[{top:130,left:"6%",right:"38%"},{top:130,left:"62%",right:"22%"},{top:130,left:"78%",right:"6%"}],tooltip:{formatter:function(e){var t=e.marker,n=e.data,a=n.value,i=n.score,o=n.total;return[t+" \u5206\u503c "+i,"\u4eba\u6b21\uff1a"+m.ZP.formatNumber(a),"\u5360\u6bd4\uff1a"+(a/o*100).toFixed(2)+"%"].join("<br/>")}},legend:{itemWidth:12,itemHeight:12,top:50,left:16+98*u,itemGap:70*u,padding:0,data:[{name:"\u63a8\u8350\u8005",icon:f.W4.square},{name:"\u88ab\u52a8\u8005",icon:f.W4.square},{name:"\u8d2c\u635f\u8005",icon:f.W4.square}],textStyle:{fontSize:14,padding:[0,10]}},graphic:[{type:"text",silent:!0,top:50,left:16,style:{text:"\u5171\u8ba1",font:"14px "+f.I8}},{type:"line",left:16+70*u,top:56,silent:!0,shape:{x1:0,y1:0,x2:0,y2:18},style:{stroke:"#E5E5E5"}},F(c,u)],xAxis:c.seriesData.map((function(e,t){var n=e.data;return{type:"category",gridIndex:t,data:n.map((function(e,n){return 1===t?n+7:2===t?n+9:n}))}})),yAxis:c.seriesData.map((function(e,t){return{type:"value",show:!1,min:0,max:c.maxCount,gridIndex:t}})),series:c.seriesData.map((function(e,t){var n=e.data;return{type:"bar",name:e.name,xAxisIndex:t,yAxisIndex:t,data:n}}))}},_=function(e,t,n,a){var i={total:e.questionnaireTotal,neutralCount:e.passiveCount,positiveCount:e.promoterCount,negativeCount:e.detractorCount};return{title:{text:t},tooltip:{formatter:function(e){var t=e.marker,n=e.data,a=n.value,i=n.name,o=n.total;return"label"!==i?[t+" "+i,"\u58f0\u91cf\uff1a"+a,"\u5360\u6bd4\uff1a"+(0===o?0:(a/o*100).toFixed(2))+"%"].join("<br>"):["\u7d2f\u8ba1\u4eba\u6570\uff1a"+o.total,'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:#00B76E;"></span> \u63a8\u8350\u8005\uff1a'+o.positiveCount+'<span style="color: #8c8c8c">\uff08'+(0===o.total?0:(o.positiveCount/o.total*100).toFixed(2))+"%\uff09</span>",'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:#0074B8;"></span> \u88ab\u52a8\u8005\uff1a'+o.neutralCount+'<span style="color: #8c8c8c">\uff08'+(0===o.total?0:(o.neutralCount/o.total*100).toFixed(2))+"%\uff09</span>",'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:#D96969;"></span> \u8d2c\u635f\u8005\uff1a'+o.negativeCount+'<span style="color: #8c8c8c">\uff08'+(0===o.total?0:(o.negativeCount/o.total*100).toFixed(2))+"%\uff09</span>"].join("<br>")}},legend:{itemWidth:12,itemHeight:12,left:"60%",top:"25%",orient:"vertical",itemGap:.15*a,data:[{name:"\u63a8\u8350\u8005",icon:f.W4.square},{name:"\u88ab\u52a8\u8005",icon:f.W4.square},{name:"\u8d2c\u635f\u8005",icon:f.W4.square}],textStyle:{fontSize:14,padding:[0,6]}},graphic:V(i,n,a),series:[{type:"pie",center:["30%","52%"],radius:["48%","60%"],hoverOffset:4,label:{show:!0,position:"center",formatter:["{a|"+i.total+"}","{b|\u7d2f\u8ba1\u4eba\u6570}"].join("\n"),rich:{a:{color:"#262626",fontSize:30,padding:[10,0,0,0],fontFamily:f.I8},b:{color:"#8C8C8C",fontSize:16,fontFamily:f.I8}}},data:[{value:i.positiveCount,name:"\u63a8\u8350\u8005",total:i.total,itemStyle:{color:"#15B374"}},{value:i.neutralCount,name:"\u88ab\u52a8\u8005",total:i.total,itemStyle:{color:"#1574B3"}},{value:i.negativeCount,name:"\u8d2c\u635f\u8005",total:i.total,itemStyle:{color:"#D96969"}},{value:0,name:"label",total:i,itemStyle:{color:"#ffffffff"}}]}]}},Z=[{title:"\u5bfc\u51fa\u56fe\u7247",type:"image"},{title:"\u5bfc\u51fa\u6570\u636e",type:"data"}],B=[{title:"\u5ba2\u6237\u5206\u7c7b",value:"client"},{title:"\u5177\u4f53\u5206\u503c",value:"score"}],L=n(60496),q=void 0,H=function(e,t,n,a){e&&t&&new Promise((function(i){var o=function(e,t,n,a){var i=O[t];return"client"===t?_(e,i,n,a):"score"===t?z(e,i,n):void 0}(e,n,t.getWidth(),t.getHeight());a(o.title.text),i(o)})).then((function(e){t.clear(),t.setOption(e)}))};const G=function(e){var t=e.data,n=e.onMoreClick,a=e.loading,i=e.chartType,o=void 0===i?0:i,l=e.resizeTime,s=r.useState(void 0),c=s[0],f=s[1],h=r.useState("client"),v=h[0],g=h[1],y=r.useState(""),x=y[0],E=y[1];return r.useEffect((function(){H(t,c,v,E)}),[t,c,v]),r.useEffect((function(){q&&clearTimeout(q),q=setTimeout((function(){q=void 0,H(t,c,v,E)}),500)}),[l]),r.createElement(W,{className:"nc-invest",defTitle:"\u5ba2\u6237\u5206\u7c7b",data:t,loading:a},r.createElement("div",{className:"title"},r.createElement("span",{style:{marginLeft:(0,m.jD)(x,14)+8}},r.createElement(d.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:r.createElement("div",null,r.createElement("div",null,"\u63a8\u8350\u8005(Promoter)\uff1a\u5177\u6709\u72c2\u70ed\u5fe0\u8bda\u5ea6\uff0c\u94c1\u6746\u7c89\u4e1d\uff0c\u53cd\u590d\u5149\u987e\uff0c\u5411\u670b\u53cb\u63a8\u8350\u3002"),r.createElement("div",null,"\u88ab\u52a8\u8005(Passive)\uff1a\u603b\u4f53\u6ee1\u610f\u4f46\u4e0d\u5fe0\u8bda\uff0c\u5bb9\u6613\u8f6c\u5411\u7ade\u4e89\u5bf9\u624b\u3002"),r.createElement("div",null,"\u8d2c\u635f\u8005(Detractors)\uff1a\u4f7f\u7528\u4e0d\u6ee1\u610f\u4e0d\u5fe0\u8bda\uff0c\u4e0d\u65ad\u62b1\u6028\u6216\u6295\u8bc9\u3002"))},r.createElement("i",{className:"icon-cem_file1"}))),r.createElement("span",null,1===o&&r.createElement(L.Z,{options:B,activeObj:v,objName:"valueType",onChange:function(e){var t=e.valueType;return g(t)}}),r.createElement(p.Z,{onClick:function(e){return function(e,t,n,a,i){var o=void 0;if("image"===t)o=e;else if("data"===t){var r,l,s=[["\u95ee\u5377\u56de\u6536\u603b\u6570","\u63a8\u8350\u8005","\u88ab\u52a8\u8005","\u8d2c\u635f\u8005"],[n.questionnaireTotal,n.promoterCount,n.passiveCount,n.detractorCount]];1===i&&((r=s[0]).push.apply(r,n.scoreQuestionnaireCount.map((function(e,t){return"\u5206\u503c"+t}))),(l=s[1]).push.apply(l,n.scoreQuestionnaireCount)),o=[s]}a({type:t,obj:o,name:e.getOption().title[0].text})}(c,e,t,n,o)},options:Z,style:{float:"right"}}))),r.createElement(u.Z,{theme:"yunting_neg_neu_pos",option:{},style:{width:"100%",height:"100%"},onChartReady:function(e){return f(e)}}))};var U=.2,Y=[{color:"#61799B",name:"\u53d1\u9001\u95ee\u5377",vName:"",hint:""},{color:"#D07B49",name:"\u53d1\u9001\u6210\u529f",vName:"\u6210\u529f\u7387",hint:"\u6210\u529f\u7387 = \u53d1\u9001\u6210\u529f\u6570 \xf7 \u53d1\u9001\u95ee\u5377\u6570"},{color:"#CDB446",name:"\u6253\u5f00\u95ee\u5377",vName:"\u6253\u5f00\u7387",hint:"\u6253\u5f00\u7387 = \u6253\u5f00\u95ee\u5377\u6570 \xf7 \u53d1\u9001\u6210\u529f\u6570"},{color:"#1EA082",name:"\u63d0\u4ea4\u95ee\u5377",vName:"\u63d0\u4ea4\u7387",hint:"\u63d0\u4ea4\u7387 = \u63d0\u4ea4\u95ee\u5377\u6570 \xf7 \u6253\u5f00\u95ee\u5377\u6570"},{color:"#3D85FF",name:"\u5b8c\u6574\u7b54\u9898",vName:"\u7b54\u9898\u7387",hint:"\u7b54\u9898\u7387 = \u5b8c\u6574\u7b54\u9898\u6570 \xf7 \u63d0\u4ea4\u95ee\u5377\u6570"}],J=function(e,t,n){return Object.values(Y).reduce((function(a,i,o){return 0===o?a:[].concat(a,[{type:"group",left:t-152,top:.2*(.8*n-32)*o+U*n+.08*(.8*n-32),children:[{type:"text",silent:!0,style:{text:i.vName,font:"12px "+f.I8}},{type:"text",silent:!0,left:68,style:{text:"("+(0===e[o-1]?0:(e[o]/e[o-1]*100).toFixed(2))+"%)",font:"12px "+f.I8,fill:"#8c8c8c"}}]}])}),[])},K=[{title:"\u5bfc\u51fa\u56fe\u7247",type:"image"},{title:"\u5bfc\u51fa\u6570\u636e",type:"data"}],Q=[{title:"\u5168\u90e8",value:"\u5168\u90e8"},{title:"\u77ed\u4fe1",value:"\u77ed\u4fe1"},{title:"\u90ae\u4ef6",value:"\u90ae\u4ef6"},{title:"\u5206\u4eab",value:"\u5206\u4eab"}],X=void 0,$=function(e,t,n,a,i){e&&t&&new Promise((function(o){var r=function(e,t,n,a){var i=[e.sendTotal,e.sendSuccessTotal,e.openedTotal,e.summitTotal,e.completeAnswerTotal],o=.13*(.8*a-32);return{title:{text:t},grid:[{show:!1,left:32,bottom:32,top:"20%",right:160}],tooltip:{formatter:function(e){var t=e.data,n=t.name,a=t.value;return""+e.marker+n+" "+a}},xAxis:{show:!1},yAxis:{type:"category",inverse:!0,axisLabel:{show:!1}},graphic:[].concat(J(i,n,a)),series:[{type:"bar",barWidth:o,barCategoryGap:"20%",label:{show:!0,formatter:"{b}",position:"insideLeft"},data:i.map((function(e,t){return{value:e,name:Y[t].name,itemStyle:{color:Y[t].color}}}))}]}}(e.find((function(e){return e.dispatchWay===n})).executiveEfficiencyVO,a,t.getWidth(),t.getHeight());i(t.getHeight()),o(r)})).then((function(e){t.clear(),t.setOption(e)}))};const ee=function(e){var t=e.data,n=e.onMoreClick,a=e.loading,i=e.chartType,o=void 0===i?0:i,l=e.resizeTime,s=e.title,c=r.useState(void 0),m=c[0],f=c[1],h=r.useState("\u5168\u90e8"),v=h[0],g=h[1],y=r.useState(0),x=y[0],E=y[1];return r.useEffect((function(){$(t,m,v,s,E)}),[t,m,v]),r.useEffect((function(){X&&clearTimeout(X),X=setTimeout((function(){X=void 0,$(t,m,v,s,E)}),500)}),[l]),r.createElement(W,{className:"yt-ratio-chart",data:t,defTitle:s,loading:a},r.createElement("div",{className:"title"},r.createElement("span",null,1===o&&r.createElement(L.Z,{options:Q,activeObj:v,objName:"valueType",onChange:function(e){var t=e.valueType;return g(t)}}),r.createElement(p.Z,{onClick:function(e){return function(e,t,n,a,i){var o=void 0;if("image"===t)o=e;else if("data"===t){var r=[["\u5206\u53d1\u6e20\u9053","\u53d1\u9001\u95ee\u5377","\u53d1\u9001\u6210\u529f","\u6253\u5f00\u95ee\u5377","\u63d0\u4ea4\u95ee\u5377","\u5b8c\u6574\u7b54\u9898"]];if(0===i){var l=n.find((function(e){return"\u5168\u90e8"===e.dispatchWay})).executiveEfficiencyVO;r.push(["\u5168\u90e8",l.sendTotal,l.sendSuccessTotal,l.openedTotal,l.summitTotal,l.completeAnswerTotal])}else 1===i&&n.forEach((function(e){var t=e.executiveEfficiencyVO;r.push([e.dispatchWay,t.sendTotal,t.sendSuccessTotal,t.openedTotal,t.summitTotal,t.completeAnswerTotal])}));o=[r]}a({type:t,obj:o,name:e.getOption().title[0].text})}(m,e,t,n,o)},options:K,style:{float:"right"}}))),m&&function(e,t,n){return[0,1,2,3].map((function(a){var i=.2*(e*(1-t)-n)*(a+1)+t*e+.08*(e*(1-t)-n)-.5*a;return r.createElement(d.Z,{placement:"top",overlay:Y[a+1].hint,key:a},r.createElement("span",{className:"hint-icon-wrapper",style:{top:i,transition:"all 0.3s"}},r.createElement("i",{className:"icon-cem_file1"})))}))}(x,U,32),r.createElement(u.Z,{theme:"yunting_pos_neu_neg",option:{},style:{width:"100%",height:"100%"},onChartReady:function(e){return f(e)}}))};var te=["positive","negative"],ne=[{title:"\u5bfc\u51fa\u56fe\u7247",type:"image"},{title:"\u5bfc\u51fa\u6570\u636e",type:"data"}],ae=[{title:"\u6bd4\u4f8b",value:"ratio"},{title:"\u6570\u91cf",value:"count"}],ie="\u63a8\u8350\u8005\u548c\u8d2c\u635f\u8005\u5173\u6ce8\u70b9\u5bf9\u6bd4",oe=void 0;function re(e,t,n,a){e&&t&&new Promise((function(t){var o=function(e,t,n){var a={positiveData:"count"===n?e.sort((function(e,t){return t.positiveCount-e.positiveCount})).slice(0,10).filter((function(e){return e.positiveCount>0})):e.sort((function(e,t){return t.posRate-e.posRate})).slice(0,10).filter((function(e){return e.posRate>0})),negativeData:"count"===n?e.sort((function(e,t){return t.negativeCount-e.negativeCount})).slice(0,10).filter((function(e){return e.negativeCount>0})):e.sort((function(e,t){return t.negRate-e.negRate})).slice(0,10).filter((function(e){return e.negRate>0}))};return{title:{text:t},grid:[{x:"5%",y:"20%",width:"90%",height:"25%"},{x:"5%",y2:"8%",width:"90%",height:"25%"}],tooltip:{formatter:function(e){var t=e.seriesName,n=e.marker,a=e.data;return[n+" "+a.name,("positive"===t?"\u63a8\u8350\u8005":"\u8d2c\u635f\u8005")+"\u58f0\u91cf\uff1a"+a[t+"Count"],"\u58f0\u91cf\u5360\u6bd4\uff1a"+(100*a[t.substring(0,3)+"Rate"]).toFixed(2)+"%"].join("<br>")}},graphic:[{type:"group",top:"13%",silent:!0,children:[{type:"text",left:22,style:{text:"\u63a8\u8350\u8005\u63d0\u53ca"+("count"===n?"\u6570\u91cf":"\u6bd4\u4f8b")+"\u6700\u591a\u7684\u8bcd",font:"bolder 12px "+f.I8,fill:"#262626"}}]},{type:"group",top:"58%",silent:!0,children:[{type:"text",left:22,style:{text:"\u8d2c\u635f\u8005\u63d0\u53ca"+("count"===n?"\u6570\u91cf":"\u6bd4\u4f8b")+"\u6700\u591a\u7684\u8bcd",font:"bolder 12px "+f.I8,fill:"#262626"}}]}],xAxis:te.map((function(e,t){return{gridIndex:t,axisTick:{show:!0,alignWithLabel:!0},axisLabel:{interval:0},data:a[e+"Data"].map((function(e){return e.name}))}})),yAxis:te.map((function(e,t){return{gridIndex:t,axisLabel:{show:!1},axisLine:{show:!1}}})),series:te.map((function(e,t){var o="positive"===e?"PROMOTER":"DETRACTOR";return{type:"bar",name:e,barWidth:30,xAxisIndex:t,yAxisIndex:t,data:a[e+"Data"].map((function(t){return(0,i.Z)({},t,{value:"count"===n?t[e+"Count"]:t[e.substring(0,3)+"Rate"],selEmotion:[o],type:"bar",selName:t.name})}))}}))}}(e,a,n);t(o)})).then((function(e){t.clear(),t.setOption(e)}))}const le=function(e){var t=e.data,n=e.onMoreClick,a=e.loading,i=e.resizeTime,o=r.useState("count"),l=o[0],s=o[1],c=r.useState(void 0),m=c[0],f=c[1];return r.useEffect((function(){re(t,m,l,ie)}),[t,l,m]),r.useEffect((function(){oe&&clearTimeout(oe),oe=setTimeout((function(){oe=void 0,re(t,m,l,ie)}),500)}),[i]),r.createElement(W,{className:"yt-focus-chart",data:t,defTitle:ie,loading:a},r.createElement("div",{className:"title"},r.createElement("span",null,"ratio"===l&&r.createElement(d.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:"\u4e00\u822c\u800c\u8a00\uff0c\u4efb\u4f55\u4e00\u4e2a\u8bcd\u90fd\u6709\u53ef\u80fd\u88ab\u63a8\u8350\u8005\u3001\u4e2d\u7acb\u8005\u548c\u8d2c\u635f\u8005\u63d0\u53ca\u3002\u201c\u6bd4\u4f8b\u201d\u516c\u5f0f\u662f\u8ba1\u7b97\u5177\u4f53\u8bcd\u88ab\u63a8\u8350\u8005\u6216\u8005\u8d2c\u635f\u8005\u63d0\u53ca\u7684\u58f0\u91cf\u5360\u8be5\u8bcd\u5168\u90e8\u58f0\u91cf\u6bd4\u91cd\u3002"},r.createElement("i",{className:"icon-cem_file1"})),r.createElement(L.Z,{options:ae,activeObj:l,objName:"formula",onChange:function(e){return s(e.formula)}}),r.createElement(p.Z,{onClick:function(e){return function(e,t,n,a){var i=void 0;"image"===t?i=e:"data"===t&&(i=[n.reduce((function(e,t){return[].concat(e,[[t.name,t.total,t.positiveCount,t.neutralCount,t.negativeCount]])}),[["\u5173\u952e\u8bcd","\u56de\u6536\u95ee\u5377\u603b\u6570","\u63a8\u8350\u8005","\u88ab\u52a8\u8005","\u8d2c\u635f\u8005"]])]),a({type:t,obj:i,name:e.getOption().title[0].text})}(m,e,t,n)},options:ne,style:{float:"right"}}))),r.createElement(u.Z,{theme:"yunting_pos_neg",option:{},style:{width:"100%",height:"100%"},onChartReady:function(e){return f(e)}}))};var se=n(98117),ce="\u5ba2\u6237\u7efc\u5408\u5173\u6ce8\u70b9",ue=void 0,pe=0,me=function(e,t,n,a,i,o,r){if(e&&n){var l=n.getHeight()-60,s=n.getWidth()-60,c=s>l?l:s;a&&pe===o?new Promise((function(n){n((0,se.p9)(e,t,a,c,r))})).then((function(e){n.clear(),n.setOption(e)})):(pe=o,new Promise((function(t){t((0,se.Oq)(e,c))})).then((function(e){n.clear(),n.setOption(e);var t=n._zr.storage._displayList.map((function(e){return n.convertToPixel({seriesIndex:0},[e.transform[4]+30,e.transform[5]+30])}));i(t)})))}};const de=function(e){var t=e.data,n=e.onMoreClick,a=e.loading,i=e.onClick,o=e.selObj,l=e.resizeTime,s=r.useState(void 0),c=s[0],m=s[1],d=r.useState(void 0),f=d[0],h=d[1];return r.useEffect((function(){me(t,ce,c,f,h,l,o)}),[t,c,f,o]),r.useEffect((function(){ue&&clearTimeout(ue),ue=setTimeout((function(){ue=void 0,me(t,ce,c,f,h,l,o)}),500)}),[l]),r.createElement(W,{className:"yt-focuspoint-chart",data:t,defTitle:ce,loading:a},r.createElement("div",{className:"title"},r.createElement(p.Z,{onClick:function(e){return(0,se.kQ)(c,e,t,n)},options:se.am,style:{float:"right"}})),r.createElement(u.Z,{theme:"yunting_pos_neu_neg",option:{},style:{width:"100%",height:"100%"},onChartReady:function(e){return m(e)},onEvents:{click:i}}))};var fe={promoter:{name:"\u63a8\u8350\u8005",marker:'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:#15B374;"></span>',color:"#15B374"},passive:{name:"\u88ab\u52a8\u8005",marker:'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:#1574B3;"></span>',color:"#1574B3"},detractor:{name:"\u8d2c\u635f\u8005",marker:'<span style="display:inline-block;margin-right:5px;border-radius:10px;width:10px;height:10px;background-color:#D96969;"></span>',color:"#D96969"}};function he(e,t){if("WEEK"===t){var n=e.split("-");return n[0].substring(2)+"\u5e74\u7b2c"+n[1]+"\u5468"}return e}var ve=[{title:"\u5bfc\u51fa\u56fe\u7247",type:"image"},{title:"\u5bfc\u51fa\u6570\u636e",type:"data"}],ge=[{title:"\u6bcf\u5929",value:"DAY"},{title:"\u6bcf\u5468",value:"WEEK"},{title:"\u6bcf\u6708",value:"MONTH"}],ye="NPS\u503c\u8d70\u52bf\u56fe",xe=void 0;function Ee(e,t,n,a){e&&t&&new Promise((function(t){var i=function(e,t,n){return{title:{text:t},grid:[{left:32,right:32,top:"20%",bottom:"10%"},{left:32,right:32,top:"20%",bottom:"27.5%"}],xAxis:[0,1,2].map((function(t){return{type:"category",gridIndex:2===t?0:t,zlevel:1,axisLabel:{show:1!==t},axisTick:{show:2===t,alignWithLabel:!0},position:2===t&&"bottom",data:e.map((function(e){return he(e.time,n)}))}})),yAxis:[{min:-100,max:300,splitNumber:4,show:!1,gridIndex:0},{show:!1,gridIndex:1}],tooltip:{formatter:function(e){var t=e.componentSubType,a=e.data,i=a.value,o=a.name,r=a.totalData,l=e.marker,s=e.seriesName;if("line"===t)return[""+l+s,o+"\uff1a"+i].join("<br/>");if("bar"===t){var c=r.questionnaireTotal,u='<span style="font-size: 16px">'+he(r.time,n)+"</span>",p='<span style="font-size: 16px; line-height: 30px">\u7b54\u5377\u6570\u91cf\uff1a'+c+"</span>",m=["promoter","passive","detractor"].map((function(e){var t=fe[e],n=t.name,a=t.marker,i=r[e+"Count"];return""+a+n+"\uff1a"+(0===c?0:(i/c*100).toFixed(2)+"%")+' <span style="color: #8c8c8c">('+i+")</span>"}));return[u,p].concat(m).join("<br/>")}}},legend:{itemWidth:12,itemHeight:12,data:[{name:"\u63a8\u8350\u8005",icon:f.W4.square},{name:"\u88ab\u52a8\u8005",icon:f.W4.square},{name:"\u8d2c\u635f\u8005",icon:f.W4.square},{name:"NPS\u503c",icon:f.W4.square}],top:50,left:16,textStyle:{padding:[0,8]}},series:[].concat(["detractor","passive","promoter"].map((function(t){return{type:"bar",name:fe[t].name,xAxisIndex:1,yAxisIndex:1,barMaxWidth:30,stack:"nps",itemStyle:{borderWidth:2,borderColor:"#fff"},data:e.map((function(e){return{value:e[t+"Count"],totalData:e,itemStyle:{color:fe[t].color}}}))}})),[{type:"line",name:"NPS\u503c",zlevel:1,symbol:"circle",xAxisIndex:0,yAxisIndex:0,smooth:0,itemStyle:{color:"#CDB446"},data:e.map((function(e){return{value:(100*e.npsValue).toFixed(0)-0,name:"NPS\u503c"}}))}])}}(e,n,a);t(i)})).then((function(e){t.clear(),t.setOption(e)}))}const Ce=function(e){var t=e.data,n=e.onMoreClick,a=e.loading,i=e.dateGroupType,o=e.onDateTypeChange,l=e.resizeTime,s=r.useState(void 0),c=s[0],m=s[1];return r.useEffect((function(){Ee(t,c,ye,i)}),[t,c]),r.useEffect((function(){xe&&clearTimeout(xe),xe=setTimeout((function(){xe=void 0,Ee(t,c,ye,i)}),500)}),[l]),r.createElement(W,{className:"yt-trend-chart",data:t,defTitle:ye,loading:a},r.createElement("div",{className:"title"},r.createElement("span",null,r.createElement(L.Z,{options:ge,activeObj:i,objName:"dateGroupType",onChange:o}),r.createElement(p.Z,{onClick:function(e){return function(e,t,n,a,i){var o=void 0;"image"===t?o=e:"data"===t&&(o=[n.reduce((function(e,t){var n=t.time;if("WEEK"===i){var a=n.split("-");n=a[0].substring(2)+"\u5e74\u7b2c"+a[1]+"\u5468"}return[].concat(e,[[n,(100*t.npsValue).toFixed(0),t.questionnaireTotal,t.promoterCount,t.passiveCount,t.detractorCount]])}),[["\u65f6\u95f4","NPS\u503c","\u95ee\u5377\u56de\u6536\u6570","\u63a8\u8350\u8005","\u88ab\u52a8\u8005","\u8d2c\u635f\u8005"]])]),a({type:t,obj:o,name:e.getOption().title[0].text})}(c,e,t,n,i)},options:ve,style:{float:"right"}}))),r.createElement(u.Z,{theme:"yunting_neg_neu_pos",option:{},style:{width:"100%",height:"100%"},onChartReady:function(e){return m(e)}}))};var Ne=["\u5404\u7701NPS\u503c\u5bf9\u6bd4","\u5404\u7701\u7b54\u5377\u6570\u91cf\u5bf9\u6bd4"],be=[{title:"\u5bfc\u51fa\u56fe\u7247",type:"image"},{title:"\u5bfc\u51fa\u6570\u636e",type:"data"}],Te=[{title:"\u5404\u7701NPS\u503c\u5bf9\u6bd4",value:"npsValue"},{title:"\u5404\u7701\u7b54\u5377\u6570\u91cf\u5bf9\u6bd4",value:"ansCount"}];n(98245);var Ae=void 0;function Se(e,t,n,a){e&&t&&new Promise((function(t){var i=function(e,t){var n=Math.max.apply(Math,e.map((function(e){return e.questionnaireTotal})));return{title:{text:Ne[t]},tooltip:{formatter:function(e){var n=e.marker,a=e.data,i=a.name,o=a.value;return[n+'<span style="font-size: 16px; line-height: 30px">'+i+"</span>",(0===t?"NPS\u503c\uff1a":"\u7b54\u5377\u6570\u91cf\uff1a")+o].join("<br/>")}},visualMap:{left:"10%",bottom:20,min:0===t?-100:0,max:0===t?100:0===n?1:n,text:["\u9ad8","\u4f4e"],inRange:{color:0===t?["#D96969","#ffffff","#0847A6"]:["#ffffff","#0847A6"]},itemWidth:10,itemHeight:80},series:[{type:"map",map:"china",label:{normal:{show:!1},emphasis:{show:!1}},itemStyle:{emphasis:{areaColor:"#CDB446"}},data:e.map((function(e){return{name:e.province.replace("\u7701",""),value:0===t?(100*e.npsValue).toFixed(0)-0:e.questionnaireTotal}}))}]}}(e,"npsValue"===n?0:1);a(i.title.text),t(i)})).then((function(e){t.clear(),t.setOption(e)}))}const we=function(e){var t=e.data,n=e.onMoreClick,a=e.loading,i=e.resizeTime,o=r.useState(void 0),l=o[0],s=o[1],c=r.useState("npsValue"),f=c[0],h=c[1],v=r.useState(""),g=v[0],y=v[1];return r.useEffect((function(){Se(t,l,f,y)}),[t,l,f]),r.useEffect((function(){Ae&&clearTimeout(Ae),Ae=setTimeout((function(){Ae=void 0,Se(t,l,f,y)}),500)}),[i]),r.createElement(W,{className:"nc-map",data:t,defTitle:"\u5404\u7701NPS\u503c\u5bf9\u6bd4",loading:a},r.createElement("div",{className:"title"},r.createElement("span",{style:{marginLeft:(0,m.jD)(g,14)+4}},r.createElement(L.Z,{showTitle:!1,options:Te,activeObj:f,objName:"npsValueType",onChange:function(e){var t=e.npsValueType;return h(t)}}),r.createElement(d.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:"\u6bcf\u4e00\u4e2a\u5ba2\u6237\u5b8c\u6210\u95ee\u5377\u65f6\uff0c\u7cfb\u7edf\u53ef\u4ee5\u83b7\u5f97\u5176\u4e0a\u7f51IP\uff0c\u57fa\u4e8eIP\u53ef\u4ee5\u63a8\u7b97\u51fa\u5176\u5730\u7406\u4f4d\u7f6e\u4fe1\u606f\u3002\u6b64\u56fe\u4ece\u5730\u7406\u4f4d\u7f6e\u7684\u89d2\u5ea6\u4e3a\u4f60\u5c55\u793a\u5ba2\u6237\u7684"+("npsValue"===f?"NPS\u503c":"\u7b54\u5377\u6570\u91cf")+"\u5bf9\u6bd4\u60c5\u51b5\u3002"},r.createElement("i",{className:"icon-cem_file1"}))),r.createElement(p.Z,{onClick:function(e){return function(e,t,n,a){var i=void 0;"image"===t?i=e:"data"===t&&(i=[n.reduce((function(e,t){return[].concat(e,[[t.province,(100*t.npsValue).toFixed(0),t.questionnaireTotal,t.promoterCount,t.passiveCount,t.detractorCount]])}),[["\u5730\u533a","NPS\u503c","\u95ee\u5377\u56de\u6536\u6570","\u63a8\u8350\u8005","\u88ab\u52a8\u8005","\u8d2c\u635f\u8005"]])]),a({type:t,obj:i,name:e.getOption().title[0].text})}(l,e,t,n)},options:be,style:{float:"right"}})),r.createElement(u.Z,{theme:"yunting_pos_neu_neg",option:{},style:{width:"100%",height:"100%"},onChartReady:function(e){return s(e)}}))};var ke={EMAIL:"\u90ae\u4ef6",SMS:"\u77ed\u4fe1",SHARE:"\u94fe\u63a5\u5206\u4eab"},De=[{title:"\u5bfc\u51fa\u56fe\u7247",type:"image"},{title:"\u5bfc\u51fa\u6570\u636e",type:"data"}],Pe="\u5404\u5206\u53d1\u65b9\u5f0f\u7b54\u5377\u56de\u6536\u6570\u91cf\u53caNPS\u503c",We=void 0;function Me(e,t,n){e&&t&&new Promise((function(t){var a=function(e,t){return{title:{text:t},grid:[{left:18,right:18,top:"30%",bottom:"10%",show:!1},{left:18,right:18,top:"30%",bottom:"25%",show:!1}],xAxis:[0,1,2].map((function(e){return{type:"category",gridIndex:2===e?0:e,axisLabel:{show:1!==e},axisTick:{show:2===e,alignWithLabel:!0},position:2===e&&"bottom",data:["\u77ed\u4fe1","\u90ae\u4ef6","\u94fe\u63a5\u5206\u4eab"]}})),yAxis:[{min:-100,max:300,splitNumber:4,show:!1,gridIndex:0},{show:!1,gridIndex:1}],tooltip:{formatter:function(e){var t=e.seriesName,n=e.marker,a=e.data,i=a.value;return[n+" "+t,("nps"===a.type?"\u6570\u503c\uff1a":"\u6570\u91cf\uff1a")+i].join("<br/>")}},legend:{itemWidth:12,itemHeight:12,data:[{name:"NPS\u503c",icon:f.W4.square},{name:"\u7b54\u5377\u56de\u6536\u6570\u91cf",icon:f.W4.square}],top:50,left:18,textStyle:{padding:[0,8]}},series:[].concat([0,1].map((function(t){return{type:"bar",name:"NPS\u503c",xAxisIndex:0,yAxisIndex:0,barWidth:50,barGap:0,barCategoryGap:0===t?0:"-100%",data:1===t?0:["SMS","EMAIL","SHARE"].map((function(t){return{type:"nps",name:ke[t],value:(100*e.find((function(e){return e.dispatchWay===t})).npsValue).toFixed(0)}}))}})),[0,1].map((function(t){return{type:"bar",xAxisIndex:1,yAxisIndex:1,barWidth:50,barGap:0,barCategoryGap:0===t?"-100%":0,name:"\u7b54\u5377\u56de\u6536\u6570\u91cf",data:0===t?0:["SMS","EMAIL","SHARE"].map((function(t){return{type:"nps",name:ke[t],value:e.find((function(e){return e.dispatchWay===t})).questionnaireTotal}}))}})))}}(e,n);t(a)})).then((function(e){t.clear(),t.setOption(e)}))}const Ie=function(e){var t=e.data,n=e.onMoreClick,a=e.loading,i=e.resizeTime,o=r.useState(void 0),l=o[0],s=o[1];return r.useEffect((function(){Me(t,l,Pe)}),[t,l,i]),r.useEffect((function(){We&&clearTimeout(We),We=setTimeout((function(){We=void 0,Me(t,l,Pe)}),500)}),[i]),r.createElement(W,{className:"nc-recycle",data:t,defTitle:Pe,loading:a},r.createElement("div",{className:"title"},r.createElement("span",{style:{marginLeft:(0,m.jD)(Pe,14)+8}},r.createElement(d.Z,{placement:"top",overlayClassName:"alert-log-tips",overlay:r.createElement("div",null,r.createElement("div",null,"\u7cfb\u7edf\u9664\u4e86\u63d0\u4f9b\u90ae\u4ef6\u548c\u77ed\u4fe1\u5206\u53d1\u7684\u6e20\u9053\u4e4b\u5916\uff0c\u4f60\u8fd8\u53ef\u4ee5\u901a\u8fc7\u590d\u5236\u94fe\u63a5\u7684\u65b9\u5f0f\u56de\u6536\u95ee\u5377\u3002"),r.createElement("div",null,"\u6ce8\uff1a\u901a\u8fc7\u590d\u5236\u94fe\u63a5\u7684\u65b9\u5f0f\u83b7\u5f97\u56de\u6536\u95ee\u5377\uff0c\u65e0\u6cd5\u7edf\u8ba1\u5206\u53d1\u548c\u5206\u53d1\u6210\u529f\u4e0e\u5426\u4e24\u79cd\u72b6\u6001\uff1b\u4e14\u4f1a\u4f7f\u5f97\u4e00\u4e2a\u95ee\u5377\u94fe\u63a5\u56de\u6536\u591a\u4e2a\u7b54\u5377\u7684\u60c5\u51b5\u53d1\u751f\uff0c\u5728\u89e3\u8bfb\u6570\u636e\u65f6\u9700\u8981\u6ce8\u610f\u3002"))},r.createElement("i",{className:"icon-cem_file1"}))),r.createElement(p.Z,{onClick:function(e){return function(e,t,n,a){var i=void 0;"image"===t?i=e:"data"===t&&(i=[n.reduce((function(e,t){var n="EMAIL"===t.dispatchWay?"\u90ae\u4ef6":"SMS"===t.dispatchWay?"\u77ed\u4fe1":"\u94fe\u63a5\u5206\u4eab";return[].concat(e,[[n,(100*t.npsValue).toFixed(0),t.questionnaireTotal,t.promoterCount,t.passiveCount,t.detractorCount]])}),[["\u5206\u53d1\u6e20\u9053","NPS\u503c","\u95ee\u5377\u56de\u6536\u6570","\u63a8\u8350\u8005","\u88ab\u52a8\u8005","\u8d2c\u635f\u8005"]])]),a({type:t,obj:i,name:e.getOption().title[0].text})}(l,e,t,n)},options:De,style:{float:"right"}})),r.createElement(u.Z,{theme:"yunting_blue_yellow",option:{},style:{width:"100%",height:"100%"},onChartReady:function(e){return s(e)}}))};var Re={MOBILE:"\u79fb\u52a8\u7aef",SHARE:"\u7535\u8111\u7aef"},je={client:"\u5ba2\u6237\u4f7f\u7528\u7684\u4e0a\u7f51\u8bbe\u5907",browser:"\u5ba2\u6237\u4f7f\u7528\u7684\u6d4f\u89c8\u5668"},Oe=[{title:"\u5bfc\u51fa\u56fe\u7247",type:"image"},{title:"\u5bfc\u51fa\u6570\u636e",type:"data"}],Ve=[{title:"\u5ba2\u6237\u4f7f\u7528\u7684\u4e0a\u7f51\u8bbe\u5907",value:"client"},{title:"\u5ba2\u6237\u4f7f\u7528\u7684\u6d4f\u89c8\u5668",value:"browser"}],Fe=[{title:"NPS\u503c",value:"nps"},{title:"\u7b54\u5377\u6570\u91cf",value:"count"}],ze=void 0;function _e(e,t,n,a,i){e&&t&&new Promise((function(t){var o=function(e,t,n){var a=e[t],i=a.map((function(e){return Re[e.dispatchWay]||e.dispatchWay}));return{title:{text:je[t]},grid:{left:18,right:18,top:"30%",bottom:"10%",show:!1},xAxis:[0,1].map((function(e){return{type:"category",axisLabel:{show:1===e},axisTick:{show:1===e,alignWithLabel:!0},position:1===e&&"bottom",data:i}})),yAxis:{min:"nps"===n?-100:0,max:"nps"===n?300:Math.max.apply(Math,a.map((function(e){return e.questionnaireTotal}))),splitNumber:"nps"===n&&2,show:!1},tooltip:{formatter:function(e){var t=e.marker,a=e.data,i=a.name,o=a.value;return[t+" "+i,("nps"===n?"NPS\u503c":"\u7b54\u5377\u6570\u91cf")+"\uff1a"+o].join("<br/>")}},legend:{itemWidth:12,itemHeight:12,data:i.map((function(e){return{name:e,icon:f.W4.square}})),top:50,left:18,textStyle:{padding:[0,8]}},series:a.map((function(e,t){var i=Re[e.dispatchWay];return{type:"bar",name:i=i||e.dispatchWay,barMaxWidth:50,stack:"name",borderWidth:50,data:a.map((function(a,o){return{value:o===t?"nps"===n?(100*e.npsValue).toFixed(0)-0:e.questionnaireTotal:0,name:i}}))}}))}}(e,n,a);i(o.title.text),t(o)})).then((function(e){t.clear(),t.setOption(e)}))}const Ze=function(e){var t=e.data,n=e.onMoreClick,a=e.loading,i=e.resizeTime,o=r.useState("nps"),l=o[0],s=o[1],c=r.useState("client"),d=c[0],f=c[1],h=r.useState(void 0),v=h[0],g=h[1],y=r.useState(""),x=y[0],E=y[1];return r.useEffect((function(){_e(t,v,d,l,E)}),[t,v,l,d]),r.useEffect((function(){ze&&clearTimeout(ze),ze=setTimeout((function(){ze=void 0,_e(t,v,d,l,E)}),500)}),[i]),r.createElement(W,{className:"nc-device",data:t,defTitle:"\u5ba2\u6237\u4f7f\u7528\u7684\u4e0a\u7f51\u8bbe\u5907",loading:a},r.createElement("div",{className:"title"},r.createElement("span",{style:{marginLeft:(0,m.jD)(x,14)+4}},r.createElement(L.Z,{showTitle:!1,options:Ve,activeObj:d,objName:"deviceType",onChange:function(e){var t=e.deviceType;return f(t)}})),r.createElement("span",null,r.createElement(L.Z,{options:Fe,activeObj:l,objName:"npsValueType",onChange:function(e){var t=e.npsValueType;return s(t)}}),r.createElement(p.Z,{onClick:function(e){return function(e,t,n,a){var i=void 0;if("image"===t)i=e;else if("data"===t){var o=n.client.reduce((function(e,t){return[].concat(e,[[t.dispatchWay,(100*t.npsValue).toFixed(0),t.questionnaireTotal,t.promoterCount,t.passiveCount,t.detractorCount]])}),[["\u8bbe\u5907","NPS\u503c","\u95ee\u5377\u56de\u6536\u6570","\u63a8\u8350\u8005","\u88ab\u52a8\u8005","\u8d2c\u635f\u8005"]]),r=n.browser.reduce((function(e,t){return[].concat(e,[[t.dispatchWay,(100*t.npsValue).toFixed(0),t.questionnaireTotal,t.promoterCount,t.passiveCount,t.detractorCount]])}),[["\u6d4f\u89c8\u5668","NPS\u503c","\u95ee\u5377\u56de\u6536\u6570","\u63a8\u8350\u8005","\u88ab\u52a8\u8005","\u8d2c\u635f\u8005"]]);i=[[].concat(o,[["","","","","",""]],r)]}a({type:t,obj:i,name:e.getOption().title[0].text})}(v,e,t,n)},options:Oe,style:{float:"right"}}))),r.createElement(u.Z,{theme:"yunting_multi_color",option:{},style:{width:"100%",height:"100%"},onChartReady:function(e){return g(e)}}))};const Be=function(e){var t=e.npsValChartData,n=e.invRatChartData,a=e.npsRatChartData,i=e.fosDisChartData,o=e.fosPoiChartData,l=e.npsTreChartData,s=e.npsTrendDateGroupType,u=e.npsMapChartData,p=e.npsRecChartData,m=e.npsDevChartData,d=e.onMoreClick,f=e.onFilterChange,h=e.onChartParamChange,v=e.resizeTime,g=e.fetchingNpsValue,y=e.fetchingInvestRatio,x=e.fetchingNpsRatio,E=e.fetchingFocusData,C=e.fetchingNpsTrend,N=e.fetchingNpsMap,b=e.fetchingNpsRecycle,T=e.fetchingNpsDevices;return r.createElement("div",{className:"yt-npx-overview-wrapper"},r.createElement("div",{className:"top-header"},r.createElement(c,{title:"NPS\u770b\u677f",showList:["time"],onChange:f})),r.createElement("div",{className:"content"},r.createElement("div",{className:"no-col-3"},r.createElement(j,{data:t,onMoreClick:d,loading:g,chartType:0,resizeTime:v}),r.createElement("div",{className:"v-divider"}),r.createElement(G,{data:n,onMoreClick:d,loading:y,chartType:0,resizeTime:v}),r.createElement("div",{className:"v-divider"}),r.createElement(ee,{data:a,onMoreClick:d,loading:x,chartType:0,resizeTime:v,title:"NPS\u6267\u884c\u6548\u7387"})),r.createElement("div",{className:"h-divider"}),r.createElement("div",{className:"no-col-2"},r.createElement(le,{data:i,onMoreClick:d,loading:E,resizeTime:v}),r.createElement("div",{className:"v-divider"}),r.createElement(de,{data:o,onMoreClick:d,loading:E,resizeTime:v})),r.createElement("div",{className:"h-divider"}),r.createElement("div",{className:"no-col-2"},r.createElement(Ce,{data:l,onMoreClick:d,loading:C,dateGroupType:s,onDateTypeChange:h,resizeTime:v}),r.createElement("div",{className:"v-divider"}),r.createElement(we,{data:u,onMoreClick:d,loading:N,resizeTime:v})),r.createElement("div",{className:"h-divider"}),r.createElement("div",{className:"no-col-2"},r.createElement(Ie,{data:p,onMoreClick:d,loading:b,resizeTime:v}),r.createElement("div",{className:"v-divider"}),r.createElement(Ze,{data:m,onMoreClick:d,loading:T,resizeTime:v}))))};var Le=n(35239),qe=n(94644),He=n(64396),Ge=["loading"],Ue=He.Z.research.npsOverview,Ye=function(e){function t(t){var n;return(n=e.call(this,t)||this)._handleWindowResize=function(){n.setState({resizeTime:(new Date).getTime()})},n._handleOnMoreClick=function(e){"image"===e.type?(0,qe._v)(e.obj,e.name):"data"===e.type&&(0,qe.aT)(e.obj,e.name)},n._handleOnFilterChange=function(e){var t=e.dateFilter;n.props.fetchChartData({dateFilter:(0,i.Z)({},t,{remoteName:"updatedAt"}),timeOut:500,projectId:Le.t.get(Le.V.curProject).id})},n._handleOnChartParamChange=function(e){e.dateGroupType&&n.props.fetchNpsTrend((0,i.Z)({},e,{timeOut:0}))},n.state={resizeTime:(new Date).getTime()},n.event={onMoreClick:n._handleOnMoreClick,onFilterChange:n._handleOnFilterChange,onChartParamChange:n._handleOnChartParamChange},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){window.addEventListener("resize",this._handleWindowResize)},n.componentWillUnmount=function(){window.removeEventListener("resize",this._handleWindowResize)},n.render=function(){return r.createElement(Be,(0,i.Z)({},this.props,this.state,this.event))},t}(r.Component);const Je=(0,l.connect)((function(e){var t=e.loading,n=(0,a.Z)(e,Ge);return(0,i.Z)({},n[Ue],{fetchingNpsValue:t.effects[Ue+"/fetchNpsValue"]||!1,fetchingInvestRatio:t.effects[Ue+"/fetchInvestRatio"]||!1,fetchingNpsRatio:t.effects[Ue+"/fetchNpsRatio"]||!1,fetchingFocusData:t.effects[Ue+"/fetchFocusData"]||!1,fetchingNpsTrend:t.effects[Ue+"/fetchNpsTrend"]||!1,fetchingNpsMap:t.effects[Ue+"/fetchNpsMap"]||!1,fetchingNpsRecycle:t.effects[Ue+"/fetchNpsRecycle"]||!1,fetchingNpsDevices:t.effects[Ue+"/fetchNpsDevices"]||!1})}),(function(e){return{fetchChartData:function(t){return e({type:Ue+"/fetchChartData",payload:t})},fetchNpsTrend:function(t){return e({type:Ue+"/fetchNpsTrend",payload:t})}}}))(Ye)}}]);