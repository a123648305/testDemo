(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[949],{70949:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>u});var t=n(67154),i=n.n(t),t=n(81506),s=n.n(t),t=n(85354),a=n.n(t),t=n(67294),o=n.n(t),l=n(92360),r=n(5133),c=n(29383),m=n(36144),d=n(12518),u=function(e){function t(){var a=e.call(this)||this;return a.addTopic=function(e){e.preventDefault(),""!==a.state.form.name?m.h.post("/topics/add",a.state.form).then(function(e){r.Z.success("添加成功"),a.setState({connectDialogVisible:!1,form:{projectId:a.state.projects[0].id,name:""}}),a.getMessageList()}):r.Z.warning("请输入消息路由名称")},a.showDialog=function(){var e=a.state,t=e.form,e=e.selectItem;a.setState({form:i()({},t,{projectId:e.id})},function(e){return a.setState({connectDialogVisible:!0})})},a.state={connectDialogVisible:!1,all:"",used:"",form:{name:"",projectId:""},users:[],columns:[{label:"开启",prop:"name",render:function(e,t,n){return o().createElement("div",null,o().createElement(l.Switch,{value:e.openRemind,onChange:a.handleSwitch.bind(s()(a),e),onColor:"#0747A6",offColor:"#CCCCCC",onText:"",offText:"",width:40}))}},{label:"文件夹",render:function(e,t,n){return o().createElement("span",null,e.idNameVO.name)}},{label:"推送方式",width:180,render:function(e,t,n){return o().createElement("span",null,o().createElement(l.Checkbox,{disabled:!e.openRemind,checked:"EMAIL"===e.remindType,onChange:a.changeRemindWay.bind(s()(a),e,"EMAIL"),label:"邮件"}))}}],messagesRoutes:[]},a}a()(t,e);var n=t.prototype;return n.onChange=function(e,t){var n;this.setState({form:Object.assign(this.state.form,((n={})[e]=t,n))})},n.getMessageList=function(){var t=this;m.h.get("/folder/message/remind/list").then(function(e){e=e.data.result;t.setState({messagesRoutes:e})})},n.handleSwitch=function(e){var t=this;m.h.post("/folder/message/remind/update",{id:e.idNameVO.id,openRemind:!e.openRemind,remindType:"EMAIL"}).then(function(e){t.getMessageList()})},n.changeRemindWay=function(e,t){var n=this;m.h.post("/folder/message/remind/update",{id:e.idNameVO.id,openRemind:!0,remindType:e.remindType===t?"NONE":t}).then(function(e){n.getMessageList()})},n.componentDidMount=function(){this.getMessageList()},n.render=function(){var e=this,t=this.state;t.used,t.all;return o().createElement("div",null,o().createElement(d.Z,{title:"消息提醒"}),o().createElement("div",{className:"messageRemind"},o().createElement("div",{className:"topicTable"},o().createElement(c.Z,{columns:this.state.columns,data:this.state.messagesRoutes||[]})),o().createElement(l.Dialog,{title:"规则",size:"tiny",visible:this.state.connectDialogVisible,onCancel:function(){return e.setState({connectDialogVisible:!1})}},o().createElement(l.Dialog.Body,null,o().createElement(l.Form,{model:this.state.form},o().createElement(l.Form.Item,{label:"规则名",prop:"name"},o().createElement(l.Input,{value:this.state.form.name,onChange:this.onChange.bind(this,"name")}),o().createElement("i",null,"*")))),o().createElement(l.Dialog.Footer,{className:"dialog-footer"},o().createElement(l.Button,{onClick:function(){return e.setState({connectDialogVisible:!1})}},"取 消"),o().createElement(l.Button,{type:"primary",onClick:this.addTopic},"确 定")))))},t}(t.Component)}}]);