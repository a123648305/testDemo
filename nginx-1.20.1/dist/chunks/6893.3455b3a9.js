"use strict";(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[6893],{76893:(e,t,n)=>{n.d(t,{Z:()=>I});n(43378);var a=n(62443),r=n(87462),o=n(94578),i=n(67294),c=n(8201),u=n(98191),l=n(39432),s=n(89212);const p=function(e){var t=e.data,n=e.title,r=e.onChange,o=e.onMsgClick,c=t?t.reduce((function(e,t){return e+t.count}),0):0,u=t?t.reduce((function(e,t){return e+t.preCount}),0):0,p=n.includes("\u5173\u6ce8\u70b9")?[{name:"\u5168\u90e8",count:c,preCount:u}].concat(t):t,d=i.useState(n.includes("\u5173\u6ce8\u70b9")?"\u5168\u90e8":"\u54a8\u8be2/\u6c42\u52a9"),m=d[0],f=d[1];return i.useEffect((function(){f(n.includes("\u5173\u6ce8\u70b9")?"\u5168\u90e8":"\u54a8\u8be2/\u6c42\u52a9")}),[t]),i.createElement("div",{className:"yt_service_card",style:{padding:n.includes("\u5173\u6ce8\u70b9")?"68px 0 0 16px":"56px 0 0 16px"}},n.includes("\u5173\u6ce8\u70b9")&&i.createElement("p",null,"\u4e00\u7ea7\u5173\u6ce8\u70b9"),i.createElement("div",{className:"card_wrap"},p&&p.map((function(e,u){return i.createElement("div",{key:e.name,className:"card_item "+(e.name===m?"card_item_checked":""),onClick:function(){var a;e.name!==m&&(a=e.name,f(a),r("\u5168\u90e8"===a?null==t?void 0:t.map((function(e){return e.name})):[a],"name",n))}},i.createElement("div",{className:"top"},i.createElement("span",{className:"name"},e.name),i.createElement("span",{className:"toMsg",onClick:function(){return o("\u5168\u90e8"===e.name?null==t?void 0:t.map((function(e){return e.name})):[e.name],"card",n)}},"\u67e5\u770b\u6d88\u606f")),i.createElement("div",{className:"middle"},e.count>1e4?i.createElement(a.default,{placement:"top",content:i.createElement("div",{style:{fontSize:12}},(0,l.uf)(e.count)),mouseEnterDelay:.4,getPopupContainer:function(){return document.querySelector(".yt_service_card_bar_table")}},i.createElement("span",{className:"count"},(0,l.hE)(e.count))):i.createElement("span",{className:"count"},(0,l.hE)(e.count)),"\u5168\u90e8"!==e.name&&i.createElement("span",{className:"percent"},"\u5360\u6bd4 ",i.createElement("span",null,(0===c?"--":(e.count/c*100).toFixed(2))+"%"))),i.createElement("div",{className:"bottom"},i.createElement("span",{className:"chain"},"\u73af\u6bd4"),e.count-e.preCount!==0&&0!==e.preCount?i.createElement("span",null,i.createElement("span",null,Math.abs(100*(e.count-e.preCount)/e.preCount).toFixed(2)+"%"),(0,s.Sv)(e.count-e.preCount)):"--"))}))))};var d=n(50976),m=n(70715),f=n(87300),h=function(e,t){var n=0;"WAITER_SESSION_PRODUCT_COMPARE"===t?e.forEach((function(e){e.forEach((function(e){var t=parseFloat(e);t>n&&(n=t)}))})):e.forEach((function(e){var t=parseFloat(e);t>n&&(n=t)})),n=Math.ceil(n);for(var a=0;a<4;a++)n%4!==0&&n++;return 0===n&&(n=4),{intVal:n/4,maxVal:n}},C=function(e){function t(t){var n;return(n=e.call(this,t)||this).chartRef=i.createRef(),n.chartLeaveTimeout=void 0,n.renderChart=function(){var e=n.props,t=e.title,a=e.dataSource,r=e.showLabel,o=e.totalCount,i=e.totalPreCount,u=e.pageType,s=e.compareData,p=e.onMsgClick,d=n.state,C=d.clickedIndex,x=d.clickedSeriesName;d.clickedName;if((0,c.P)(a)&&n.chartRef){var g=function(e,t,n,a,r,o,i,c,u,s,p){var d="WAITER_SESSION_PRODUCT_COMPARE"===u?s.map((function(e){return e.name})):["\u5f53\u671f","\u5f80\u671f"];return{title:{text:t,subtext:t.includes("\u5173\u6ce8\u70b9")?"\u4e00\u7ea7\u5173\u6ce8\u70b9":null,subtextStyle:{color:"#262626",fontSize:14,fontWeight:600,lineHeight:66}},tooltip:{trigger:"axis",showDelay:250,hideDelay:0,enterable:!0,confine:!0,padding:0,backgroundColor:"#ffffff",borderColor:"#e5e5e5",borderWidth:"1",extraCssText:"border-radius: 2px;\n        box-shadow: 0px 9px 28px 8px rgba(0,0,0,0.05), 0px 6px 16px 0px rgba(0,0,0,0.08), 0px 3px 6px -4px rgba(0,0,0,0.12)",axisPointer:{type:"none",label:{show:!1}},formatter:function(e,n,a){if(e.length)return setTimeout((function(){var r=e.map((function(e){var n=e.marker,a=e.seriesName;return e.data,{name:"<div style='display: flex;justify-content: space-between;align-items: center;color: #8c8c8c;'><div><span style='vertical-align: bottom'>"+n+"</span>"+a+(t.includes("\u5173\u6ce8\u70b9")?"\u5173\u6ce8\u70b9\u58f0\u91cf":"\u8bdd\u9898\u91cf")+"</div><div style='color: #262626;font-weight: 500;margin-left: 16px;'>"+(0,l.hE)(e.value)+"</div>"+("WAITER_SESSION_PRODUCT_COMPARE"===u?"":"<div style='color: #8C8C8C;margin-left: 8px;'>"+("\u5f80\u671f"===a?0===c?"--":(100*e.value/c).toFixed(2)+"%":0===i?"--":(100*e.value/i).toFixed(2)+"%")+"</div>")+"</div>"}})).map((function(e){return e.name})),o='<span style="font-size: 12px; color: #262626; font-weight: 400">'+e[0].name+"</span>";a(n,(0,f.r)(o,r))}),0)}},legend:{left:16,top:t.includes("\u5173\u6ce8\u70b9")?96:66,itemWidth:10,itemHeight:10,itemGap:16,data:d.map((function(e){return{name:e,icon:"circle"}}))},grid:{left:60,right:40,top:t.includes("\u5173\u6ce8\u70b9")?140:110,bottom:e.length>6?52:24},dataZoom:{show:e.length>6,bottom:0,xAxisIndex:0,height:20,handleSize:"100%",showDetail:!1,borderColor:"transparent",dataBackground:{lineStyle:{color:"rgba(231, 243, 255, 1)",opacity:1},areaStyle:{color:"rgba(231, 243, 255, 1)",opacity:1}},fillerColor:"rgba(114, 98, 253, 0.3)",handleIcon:"path://M249.376256 0m102.4 0l0 0q102.4 0 102.4 102.4l0 819.2q0 102.4-102.4 102.4l0 0q-102.4 0-102.4-102.4l0-819.2q0-102.4 102.4-102.4Z",handleColor:"rgba(114, 98, 253, 1)",startValue:0,endValue:5},xAxis:[{type:"category",axisTick:{show:!1},data:"WAITER_SESSION_PRODUCT_COMPARE"===u?["\u54a8\u8be2/\u6c42\u52a9","\u8d5e\u626c","\u4e0d\u6ee1/\u8fb1\u9a82"]:e.map((function(e){return e.name})),axisLabel:{color:"#626262",formatter:function(e){return e.length>6?e.substring(0,6)+"...":e}}}],yAxis:{type:"value",axisLabel:{color:"#626262",formatter:function(e){return(0,l.hE)(e)}},interval:"WAITER_SESSION_PRODUCT_COMPARE"===u?h(e.map((function(e){return e.list})).map((function(e){return e.map((function(e){return e.count}))})),u).intVal:h([].concat(e.map((function(e){return e.count})),e.map((function(e){return e.preCount}))),u).intVal,max:"WAITER_SESSION_PRODUCT_COMPARE"===u?h(e.map((function(e){return e.list})).map((function(e){return e.map((function(e){return e.count}))})),u).maxVal:h([].concat(e.map((function(e){return e.count})),e.map((function(e){return e.preCount}))),u).maxVal,axisLine:{show:!1,lineStyle:{type:"dashed",color:"#e5e5e5"}},splitLine:{show:!0,lineStyle:{color:["#e5e5e5"],width:1,type:"dashed"}}},series:"WAITER_SESSION_PRODUCT_COMPARE"===u?s.map((function(o,i){return{name:o.name,type:"bar",barGap:0,barMaxWidth:24,label:{show:n,position:"top",color:"#262626",offset:0===i&&s.length>1||4===s.length&&1===i?[-5,0]:i===s.length-1&&s.length>1||4===s.length&&2===i?[5,0]:[0,0]},emphasis:{focus:"series"},z:3===s.length&&1===i||4===s.length&&1===i||4===s.length&&2===i?3:2,data:e&&e.some((function(e){return e.name===o.name}))?e.find((function(e){return e.name===o.name})).list.map((function(e,n){return{value:e.count,itemStyle:{color:-1===a||a===n&&r===o.name?m.OW[i]:"#bfbfbf"},tooltip:{trigger:"item",hideDelay:150,confine:!0,enterable:!0,padding:0,backgroundColor:"#ffffff",borderColor:"#e5e5e5",borderWidth:"1",extraCssText:"border-radius: 2px;\n        box-shadow: 0px 9px 28px 8px rgba(0,0,0,0.05), 0px 6px 16px 0px rgba(0,0,0,0.08), 0px 3px 6px -4px rgba(0,0,0,0.12)",position:function(e,t,n,a,r){var o=r.contentSize,i=r.viewSize,c=e[0]<i[0]/2?0:-1,u=e[1]<i[1]/2?-.5:-1,l=e[0]<i[0]/2?12:-12;return[e[0]+c*o[0]+l,e[1]+u*o[1]]},formatter:function(e,n,a){return setTimeout((function(){var r=e.seriesName,o=e.name,i=e.value,c="\n                <span style='font-size: 12px;font-weight: 400;color:#262626;'>\n                  "+o+"\n                </span>\n                ",u=[e.marker+" "+r+'\u8bdd\u9898\u91cf\n                        <span style="float: right; font-weight: 500; color: #262626; margin-left: 16px;">\n                  '+(0,l.hE)(i)+"</span>"];a(n,(0,f.r)(c,u,[{title:"\u6d88\u606f",icon:"icon-cem_jump-message",callback:function(){return p(e,"bar",t)}}],"yt_new_tooltip_wrapper"))}),0)}}}})):[]}})):[{name:"\u5f53\u671f",type:"bar",barGap:0,barMaxWidth:24,label:{show:n,position:"top",color:"#262626",offset:[-5,0]},emphasis:{focus:"series"},data:e.map((function(e,n){return{value:e.count,itemStyle:{color:-1===a||a===n&&"\u5f53\u671f"===r?"#1890ff":"#bfbfbf"},tooltip:{trigger:"item",hideDelay:200,confine:!0,enterable:!0,padding:0,backgroundColor:"#ffffff",borderColor:"#e5e5e5",borderWidth:"1",extraCssText:"border-radius: 2px;\n        box-shadow: 0px 9px 28px 8px rgba(0,0,0,0.05), 0px 6px 16px 0px rgba(0,0,0,0.08), 0px 3px 6px -4px rgba(0,0,0,0.12)",position:function(e,t,n,a,r){var o=r.contentSize,i=r.viewSize,c=e[0]<i[0]/2?0:-1,u=e[1]<i[1]/2?-.5:-1,l=e[0]<i[0]/2?12:-12;return[e[0]+c*o[0]+l,e[1]+u*o[1]]},formatter:function(e,n,a){return setTimeout((function(){var r=e.seriesName,o=e.name,c=e.value,u="\n                <span style='font-size: 12px;font-weight: 400;color:#262626;'>\n                  "+o+"\n                </span>\n                ",s=[e.marker+" "+r+(t.includes("\u5173\u6ce8\u70b9")?"\u5173\u6ce8\u70b9\u58f0\u91cf":"\u8bdd\u9898\u91cf")+'<span style="float: right; font-weight: 500; color: #262626; margin-left: 16px;">\n                  '+(0,l.hE)(c)+'<span style="color: #8C8C8C; margin-left: 8px;">\n                  '+(0===i?"--":(c/i*100).toFixed(2)+"%")+"</span></span>"];a(n,(0,f.r)(u,s,[{title:"\u6d88\u606f",icon:"icon-cem_jump-message",callback:function(){return p(e,"bar",t)}}],"yt_new_tooltip_wrapper"))}),0)}}}}))},{name:"\u5f80\u671f",type:"bar",label:{show:n,position:"top",color:"#262626",offset:[5,0]},barMaxWidth:24,emphasis:{focus:"series"},data:e.map((function(e,n){return{value:e.preCount,itemStyle:{color:-1===a||a===n&&"\u5f80\u671f"===r?"#60DDA9":"#bfbfbf"},tooltip:{trigger:"item",hideDelay:200,confine:!0,enterable:!0,padding:0,backgroundColor:"#ffffff",borderColor:"#e5e5e5",borderWidth:"1",extraCssText:"border-radius: 2px;\n        box-shadow: 0px 9px 28px 8px rgba(0,0,0,0.05), 0px 6px 16px 0px rgba(0,0,0,0.08), 0px 3px 6px -4px rgba(0,0,0,0.12)",position:function(e,t,n,a,r){var o=r.contentSize,i=r.viewSize,c=e[0]<i[0]/2?0:-1,u=e[1]<i[1]/2?-.5:-1,l=e[0]<i[0]/2?12:-12;return[e[0]+c*o[0]+l,e[1]+u*o[1]]},formatter:function(e,n,a){return setTimeout((function(){var r=e.seriesName,o=e.name,i=e.value,u="\n                <span style='font-size: 12px;font-weight: 400;color:#262626;'>\n                  "+o+"\n                </span>\n                ",s=[e.marker+" "+r+(t.includes("\u5173\u6ce8\u70b9")?"\u5173\u6ce8\u70b9\u58f0\u91cf":"\u8bdd\u9898\u91cf")+'<span style="float: right; font-weight: 500; color: #262626; margin-left: 16px;">\n                  '+(0,l.hE)(i)+'<span style="color: #8C8C8C; margin-left: 8px;">\n                  '+(0===c?"--":(i/c*100).toFixed(2)+"%")+"</span></span>"];a(n,(0,f.r)(u,s,[{title:"\u6d88\u606f",icon:"icon-cem_jump-message",callback:function(){return p(e,"bar",t)}}],"yt_new_tooltip_wrapper"))}),0)}}}}))}]}}(a,t,r,C,x,0,o,i,u,s,p);n.chartRef.clear(),n.chartRef.setOption(g)}},n._handleOnChartClick=function(e){var t=n.props,a=t.dataSource,r=t.onChange,o=t.onBarTypeChange,i=t.title,c=t.pageType,u=t.compareData,l=t.oriCompareData,s=e.seriesName,p=(e.value,e.dataIndex),d=e.name,m=e.seriesIndex,f=n.state,h=f.clickedName,C=f.clickedIndex,x=f.clickedSeriesName;n.setState({clickedSeriesName:p===C&&s===x?"":s,clickedIndex:p===C&&s===x?-1:p,clickedName:d},(function(){if("WAITER_SESSION_PRODUCT_COMPARE"===c){var e=l&&u?null!=l&&l.some((function(e){return e.name===s}))?s:l[null==u?void 0:u.findIndex((function(e){return e.name===s}))]:s;d===h&&n.state.clickedSeriesName?r([d],"name",i,m,n.state.clickedSeriesName?s:null):r(n.state.clickedSeriesName?[d]:["\u54a8\u8be2/\u6c42\u52a9","\u8d5e\u626c","\u4e0d\u6ee1/\u8fb1\u9a82"],"name",i,n.state.clickedSeriesName?m:0,n.state.clickedSeriesName?e:null)}else d===h&&n.state.clickedSeriesName?(d===h&&!x&&r([d],"name",i),o("\u5f53\u671f"!==s&&n.state.clickedSeriesName?"preCount":"count")):(r(n.state.clickedSeriesName?[d]:null==a?void 0:a.map((function(e){return e.name})),"name",i),o("\u5f53\u671f"!==s&&n.state.clickedSeriesName?"preCount":"count"))}))},n.state={clickedIndex:-1,clickedSeriesName:"",clickedName:t.data&&t.data[0].name},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;if(this.chartRef){this.renderChart();var t=this.chartRef._dom.children,n=t[0],a=t[1];n.addEventListener("mouseleave",(function(t){e.chartLeaveTimeout=setTimeout((function(){e.chartLeaveTimeout&&(a.style.display="none")}),2e3)})),a&&a.addEventListener("mouseenter",(function(t){e.chartLeaveTimeout=void 0}))}},n.componentDidUpdate=function(e,t){var n=e.dataSource,a=e.showLabel,r=e.compareData,o=this.props,i=o.dataSource,u=o.showLabel,l=o.compareData,s=t.clickedIndex,p=t.clickedSeriesName,d=this.state,m=d.clickedIndex,f=d.clickedSeriesName;(0,c.P)(i)&&JSON.stringify(n)!==JSON.stringify(i)&&(this.renderChart(),this.setState({clickedName:i[0].name,clickedIndex:-1,clickedSeriesName:""})),a===u&&s===m&&p===f&&JSON.stringify(r)===JSON.stringify(l)||this.renderChart(),!(0,c.P)(i)&&this.chartRef&&(this.chartRef=void 0)},n.render=function(){var e=this,t=this.props;t.title,t.showLabel;return i.createElement("div",{className:"yt_service_bar_chart"},i.createElement(d.Z,{theme:"yt_multi_color_10",option:{},style:{width:"100%",height:"100%"},onEvents:{click:this._handleOnChartClick},onChartReady:function(t){return e.chartRef=t}}))},t}(i.Component);const x=C;n(15267);var g=n(64713),b=(n(35797),n(64749)),y=n(96889),E=n(43036),S=[{label:"\u73af\u6bd4\uff08\u6309\u6570\u91cf\uff09",value:"Count"},{label:"\u73af\u6bd4\uff08\u6309\u5360\u6bd4\uff09",value:"Percent"}],v=[{label:"\u73af\u6bd4\uff08\u6309\u58f0\u91cf\uff09",value:"Count"},{label:"\u73af\u6bd4\uff08\u6309\u5360\u6bd4\uff09",value:"Percent"}],_=[{title:"\u56fe\u8868",value:"c0",icon:"icon-zhuzhuangtu"},{title:"\u8868\u683c",value:"c1",icon:"icon-biaoge1"}],N=[{name:"\u8d60\u54c1",count:15456,preCount:14924},{name:"\u8fd4\u73b0",count:1904,preCount:3198},{name:"\u9884\u5b9a",count:1721,preCount:2158},{name:"\u6652\u5355",count:1625,preCount:1847},{name:"\u7ea2\u5305",count:1424,preCount:2156},{name:"\u4f18\u60e0\u5238",count:1352,preCount:1039},{name:"\u9996\u53d1",count:838,preCount:944},{name:"\u4fdd\u4ef7",count:674,preCount:548},{name:"\u4e2d\u5956",count:433,preCount:457},{name:"\u5206\u671f\u514d\u606f",count:398,preCount:363},{name:"\u6ee1\u51cf\u9001",count:288,preCount:330},{name:"\u4f1a\u5458",count:239,preCount:221},{name:"\u5305\u90ae",count:222,preCount:244},{name:"\u5f00\u552e",count:123,preCount:101},{name:"\u79d2\u6740",count:112,preCount:92}];N.reduce((function(e,t){return e+t.count}),0),N.reduce((function(e,t){return e+t.preCount}),0);const w=function(e){var t=e.pageType,n=e.title,a=e.data,o=e.totalCount,c=e.totalPreCount,u=e.loading,p=e.onChange,d=e.chainValue,m=e.onChainValueChange,f=e.compareSpu,h=e.compareData,C=e.oriCompareData,x=e.barType,_=e.pageIndex,N=e.pageSize,w=e.onPageChange,T=e.onMsgClick,D=i.useState(f||h&&h.length?h[0].name:void 0),k=D[0],I=D[1],O=function(e){m(e)},P=function(e){T((0,r.Z)({},e,{barType:"count"===x?"\u5f53\u671f":"\u5f80\u671f",compareIndex:null==h?void 0:h.findIndex((function(e){return e.name===k}))}),"table",n)};i.useEffect((function(){void 0!==f&&I(f||h[0].name)}),[f]),i.useEffect((function(){h&&I(h[0].name)}),[C]);var R="WAITER_SESSION_PRODUCT_COMPARE"===t?[{title:"",width:"0.1%"},{title:"\u5e8f\u53f7",dataIndex:"num",width:"15%",render:function(e,t,n){return t.index}},{title:"\u8bdd\u9898\u5185\u5bb9",dataIndex:"name",width:"50%",render:function(e,t){return i.createElement("span",{className:"allipsis"},t.name)}},{title:"\u8bdd\u9898\u91cf",dataIndex:"count",width:"20%",render:function(e,t){return(0,l.uf)(t[x])}},{title:"\u64cd\u4f5c",width:"15%",dataIndex:"operate",render:function(e,t){return i.createElement("span",{onClick:function(){return P(t)},className:"toMsg"},"\u67e5\u770b\u6d88\u606f")}}]:n.includes("\u5173\u6ce8\u70b9")?[{title:"",width:"0.1%"},{title:"\u5e8f\u53f7",dataIndex:"num",width:"10%",render:function(e,t,n){return t.index}},{title:"\u5173\u6ce8\u70b9",width:"20%",dataIndex:"name"},{title:"\u58f0\u91cf",width:"20%",dataIndex:"count",render:function(e,t){return(0,l.uf)(t[x])}},{title:i.createElement("span",null,"\u5360\u6bd4",i.createElement(E.Z,{placement:"top",overlay:"\u5360\u6bd4 = \u5355\u4e2a\u5173\u6ce8\u70b9\u7684\u5173\u6ce8\u70b9\u58f0\u91cf\xf7\u6240\u6709\u5173\u6ce8\u70b9\u7684\u5173\u6ce8\u70b9\u58f0\u91cf\u603b\u548c"},i.createElement("i",{className:"icon-cem_file1",style:{marginLeft:8}}))),dataIndex:"percent",width:"20%",render:function(e,t){return i.createElement("span",{style:{display:"inline-block",textAlign:"right"}},"preCount"===x?0===t.prePercent?"--":1===t.prePercent?"100%":(100*t.prePercent).toFixed(2)+"%":0===t.percent?"--":1===t.percent?"100%":(100*t.percent).toFixed(2)+"%")}},{title:i.createElement(b.default,{dropdownClassName:"chain_ratio_dropdown",bordered:!1,value:d,onChange:O,suffixIcon:i.createElement("i",{className:"icon-cem_pull-down-or-take-up",style:{fontSize:"16px",color:"#8c8c8c"}})},v.map((function(e){return i.createElement(b.default.Option,{value:e.value,key:e.value},e.label)}))),dataIndex:"chainRatio",width:"20%",render:function(e,t){return i.createElement("span",null,"preCount"===x||0===Number(t["pre"+d].toFixed(4))||Number(t[""+d.toLowerCase()].toFixed(4))-Number(t["pre"+d].toFixed(4))===0?i.createElement("span",{style:{display:"inline-block",width:102,textAlign:"center"}},"--"):i.createElement("span",null,i.createElement("span",{style:{display:"inline-block",width:68,textAlign:"right"}},Math.abs(100*(t[""+d.toLowerCase()].toFixed(4)-t["pre"+d].toFixed(4))/t["pre"+d].toFixed(4)).toFixed(2)+"%"),(0,s.Sv)(t[""+d.toLowerCase()]-t["pre"+d])))}},{title:"\u64cd\u4f5c",width:"15%",dataIndex:"operate",render:function(e,t){return i.createElement("span",{onClick:function(){return P(t)},className:"toMsg"},"\u67e5\u770b\u6d88\u606f")}}]:n.includes("\u8bdd\u9898")?[{title:"",width:"0.1%"},{title:"\u5e8f\u53f7",width:"10%",dataIndex:"num",render:function(e,t,n){return t.index}},{title:"\u8bdd\u9898",width:"30%",dataIndex:"name",render:function(e,t){return i.createElement("span",{className:"topic_content ellipsis"},t.name)}},{title:"\u6570\u91cf",width:"15%",dataIndex:"count",render:function(e,t){return(0,l.uf)(t[x])}},{title:i.createElement("span",null,"\u5360\u6bd4",i.createElement(E.Z,{placement:"top",overlay:"\u5360\u6bd4 = \u5355\u4e2a\u8bdd\u9898\u7684\u8bdd\u9898\u91cf\xf7\u6240\u6709\u8bdd\u9898\u7684\u8bdd\u9898\u91cf\u603b\u548c"},i.createElement("i",{className:"icon-cem_file1",style:{marginLeft:8}}))),dataIndex:"percent",width:"15%",render:function(e,t){return i.createElement("span",{style:{display:"inline-block",textAlign:"right"}},"preCount"===x?0===t.prePercent?"--":1===t.prePercent?"100%":(100*t.prePercent).toFixed(2)+"%":0===t.percent?"--":1===t.percent?"100%":(100*t.percent).toFixed(2)+"%")}},{title:i.createElement(b.default,{dropdownClassName:"chain_ratio_dropdown",bordered:!1,value:d,onChange:O,suffixIcon:i.createElement("i",{className:"icon-cem_pull-down-or-take-up",style:{fontSize:"16px",color:"#8c8c8c"}})},S.map((function(e){return i.createElement(b.default.Option,{value:e.value,key:e.value},e.label)}))),dataIndex:"chainRatio",width:"15%",render:function(e,t){return i.createElement("span",null,"preCount"===x||0===Number(t["pre"+d].toFixed(4))||Number(t[""+d.toLowerCase()].toFixed(4))-Number(t["pre"+d].toFixed(4))===0?i.createElement("span",{style:{display:"inline-block",width:102,textAlign:"center"}},"--"):i.createElement("span",null,i.createElement("span",{style:{display:"inline-block",width:68,textAlign:"right"}},Math.abs(100*(t[""+d.toLowerCase()].toFixed(4)-t["pre"+d].toFixed(4))/t["pre"+d].toFixed(4)).toFixed(2)+"%"),(0,s.Sv)(t[""+d.toLowerCase()]-t["pre"+d])))}},{title:"\u64cd\u4f5c",dataIndex:"operate",width:"15%",render:function(e,t){return i.createElement("span",{className:"toMsg",onClick:function(){return P(t)}},"\u67e5\u770b\u6d88\u606f")}}]:[],M=n.includes("\u8bdd\u9898")?a&&a.sort((function(e,t){return t[x]-e[x]})).filter((function(e){return e[x]>0})).map((function(e,t){return(0,r.Z)({},e,{index:t+1,percent:0!==o&&o?e.count/o:0,prePercent:0!==c&&c?e.preCount/c:0})})):a&&a.sort((function(e,t){return t[x]-e[x]})).map((function(e,t){return(0,r.Z)({},e,{index:t+1,percent:0!==o&&o?e.count/o:0,prePercent:0!==c&&c?e.preCount/c:0})}));return i.createElement(y.ZP,{columns:R,loading:u,rowKey:"name",className:"yt_service_common_table_wrapper "+("WAITER_SESSION_PRODUCT_COMPARE"===t?"service_compare_table":"")+" "+(null!=M&&M.length&&void 0!==M?"":"empty_data"),pagination:{pageSizeOptions:["10","20","50"],defaultPageSize:N,total:M instanceof Array?M.length:0,onChange:w,current:_,pageSize:N},dataSource:M,search:!1,style:{wordBreak:"break-all"},scroll:{y:470},headerTitle:i.createElement(i.Fragment,null,n.includes("\u5173\u6ce8\u70b9")&&i.createElement("p",{className:"aspect_title"},"\u4e8c\u7ea7\u5173\u6ce8\u70b9"),"WAITER_SESSION_PRODUCT_COMPARE"===t&&h&&i.createElement(g.default.Group,{value:k,onChange:function(e){var t=e.target.value;setTimeout((function(){I(t)}),0),C&&h&&p(C[null==h?void 0:h.findIndex((function(e){return e.name===t}))],"sku",n)}},h.map((function(e){return i.createElement(g.default.Button,{value:e.name,key:e.name,disabled:f&&e.name!==f},e.name)})))),options:!1})};var T=n(60496),D=n(94644),k=function(e){function t(t){var n;(n=e.call(this,t)||this).barChartRef=i.createRef(),n.onExportExcel=function(){var e=n.state,t=e.newData,a=(e.chainValue,e.barType),o=e.chartType,i=e.compareSpu,u=n.props,l=u.data,s=u.pageType,p=u.title,d=u.totalCount,m=u.totalPreCount,f=u.compareData;if((0,c.P)(l)){var h="WAITER_SESSION_PRODUCT_COMPARE"===s?["\u5546\u54c1","\u8bdd\u9898\u5206\u7c7b","\u8bdd\u9898\u91cf"]:p.includes("\u5173\u6ce8\u70b9")?"c1"===o?["\u5173\u6ce8\u70b9","\u58f0\u91cf","\u73af\u6bd4","\u5360\u6bd4","\u8d8b\u52bf"]:["\u5173\u6ce8\u70b9","\u5f53\u671f\u58f0\u91cf","\u5f80\u671f\u58f0\u91cf"]:p.includes("\u8bdd\u9898")?"c1"===o?["\u8bdd\u9898\u5206\u7c7b","\u6570\u91cf","\u73af\u6bd4","\u5360\u6bd4","\u8d8b\u52bf"]:["\u8bdd\u9898\u5206\u7c7b","\u5f53\u671f\u6570\u91cf","\u5f80\u671f\u6570\u91cf"]:[],C="WAITER_SESSION_PRODUCT_COMPARE"===s?l&&function(e){var t=[];return e&&e instanceof Array?(e.forEach((function(e){e.list.forEach((function(n){t.push((0,r.Z)({spu:e.name},n))}))})),t):e}(l).reduce((function(e,t){return[].concat(e,[[t.spu,t.aspectName,t.count]])}),[h]):"c1"===o&&p.includes("\u5173\u6ce8\u70b9")?l&&[{name:"\u5168\u90e8",count:d,preCount:m}].concat(l).reduce((function(e,t){return[].concat(e,[[t.name,t.count,0===t.preCount?"--":(100*(t.count-t.preCount)/t.preCount).toFixed(2)+"%",0!==d&&d?"\u5168\u90e8"===t.name?"":(100*t.count/d).toFixed(2)+"%":"--",0===t.preCount?"--":t.count>t.preCount?"\u4e0a\u5347":"\u4e0b\u964d"]])}),[h]):l&&l.reduce((function(e,t){return[].concat(e,["c1"===o?[t.name,t.count,0===t.preCount?"--":(100*(t.count-t.preCount)/t.preCount).toFixed(2)+"%",0!==d&&d?(100*t.count/d).toFixed(2)+"%":"--",0===t.preCount?"--":t.count>t.preCount?"\u4e0a\u5347":"\u4e0b\u964d"]:[t.name,t.count,t.preCount]])}),[h]),x="WAITER_SESSION_PRODUCT_COMPARE"===s?["\u5e8f\u53f7","\u8bdd\u9898\u5206\u7c7b","\u8bdd\u9898\u5185\u5bb9","\u8bdd\u9898\u91cf"]:p.includes("\u5173\u6ce8\u70b9")?["\u5e8f\u53f7","\u4e00\u7ea7\u5173\u6ce8\u70b9","\u4e8c\u7ea7\u5173\u6ce8\u70b9","\u58f0\u91cf","\u5360\u6bd4","\u73af\u6bd4\uff08\u6309\u58f0\u91cf\uff09","\u73af\u6bd4\uff08\u6309\u5360\u6bd4\uff09"]:p.includes("\u8bdd\u9898")?["\u5e8f\u53f7","\u8bdd\u9898\u5206\u7c7b","\u8bdd\u9898","\u6570\u91cf","\u5360\u6bd4","\u73af\u6bd4\uff08\u6309\u6570\u91cf\uff09","\u73af\u6bd4\uff08\u6309\u5360\u6bd4\uff09"]:[],g=p.includes("\u8bdd\u9898")?t&&t.sort((function(e,t){return t[a]-e[a]})).filter((function(e){return e[a]>0})):t&&t.sort((function(e,t){return t[a]-e[a]})),b="WAITER_SESSION_PRODUCT_COMPARE"===s?t&&t.filter((function(e){return e.count>0})).reduce((function(e,t){return[].concat(e,[[t.index,t.aspectName,t.name,t.count]])}),[x]):g.reduce((function(e,t){return[].concat(e,[[t.index,t.aspectName,t.name,t[a],"preCount"===a?0===t.prePercent?"--":Number(100*t.prePercent).toFixed(2)+"%":0===t.percent?"--":Number(100*t.percent).toFixed(2)+"%","preCount"===a||0===t.preCount||t.count-t.preCount===0?"--":(100*(t.count.toFixed(4)-t.preCount.toFixed(4))/t.preCount.toFixed(4)).toFixed(2)+"%","preCount"===a||0===Number(t.prePercent.toFixed(4))||Number(t.percent.toFixed(4))-Number(t.prePercent.toFixed(4))===0?"--":(100*(t.percent.toFixed(4)-t.prePercent.toFixed(4))/t.prePercent.toFixed(4)).toFixed(2)+"%"]])}),[x]);(0,D.aT)([C,b],p,["\u6570\u636e\u7edf\u8ba1","WAITER_SESSION_PRODUCT_COMPARE"===s?(i||f[0].name)+"\u8bdd\u9898\u5185\u5bb9":p.includes("\u8bdd\u9898")?"\u8bdd\u9898\u5185\u5bb9":"\u5173\u6ce8\u70b9"])}},n.onExportImage=function(){var e=n.state.chartType,t=n.props.title;"c1"!==e&&(0,D._v)(n.barChartRef.chartRef,t)},n.onPageChange=function(e,t){n.setState({pageIndex:e,pageSize:t})},n.onChange=function(e,t,a,r,o){n.props.onChange(e,t,a,r),n.setState({pageIndex:1,compareSpu:o})},n.onChartTypeChange=function(e){var t=n.props,a=t.title,r=t.onChartTypeChange,o=t.data;"c1"===e?n.onChange(a.includes("\u5173\u6ce8\u70b9")?o&&o instanceof Array&&o.map((function(e){return e.name})):[o&&o[0]&&o[0].name],"name",a):n.onChange(o&&o instanceof Array&&o.map((function(e){return e.name})),"name",a),n.setState({chartType:e,barType:"count"}),r&&r(e)};var a=t.pageType,o=(t.data,t.tableData),u=t.totalCount,l=t.totalPreCount,s=t.chartType;t.title;return n.state={pageIndex:1,pageSize:10,chartType:s||"WAITER_SESSION_PRODUCT_COMPARE"!==a?"c1":void 0,barType:"count",showLabel:!1,chainValue:"Count",newData:o&&o instanceof Array?o.map((function(e,t){return(0,r.Z)({},e,{index:t+1,percent:0!==u&&u?e.count/u:0,prePercent:0===l||!e.preCount||l?0:e.preCount/l})})):o,compareSpu:void 0},n}(0,o.Z)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e,t){var n=e.tableData,a=e.chartType,o=e.compareData,i=this.props,c=i.tableData,u=i.totalCount,l=i.totalPreCount,s=i.chartType,p=i.compareData;i.title,this.state.barType;JSON.stringify(n)!==JSON.stringify(c)&&this.setState({newData:c&&c instanceof Array?c.map((function(e,t){return(0,r.Z)({},e,{index:t+1,percent:0!==u&&u?e.count/u:0,prePercent:0!==l&&e.preCount&&l?e.preCount/l:0})})):c,pageIndex:1}),JSON.stringify(a)!==JSON.stringify(s)&&s&&this.setState({chartType:s,barType:"count",pageIndex:1}),JSON.stringify(o)!==JSON.stringify(p)&&p&&this.setState({compareSpu:void 0})},n.render=function(){var e=this,t=this.props,n=t.title,r=t.titleOverlay,o=t.loading,l=t.tableLoading,s=t.data,d=t.pageType,m=t.totalCount,f=t.totalPreCount,h=t.compareData,C=t.oriCompareData,g=t.emptyFilterHint,b=t.onChange,y=t.onMsgClick,E=this.state,S=E.chartType,v=E.showLabel,N=E.barType,D=E.chainValue,k=E.newData,I=E.pageIndex,O=E.pageSize,P=E.compareSpu;return i.createElement(c.Z,{className:"yt_service_card_bar_table",loading:o,data:s,emptyFilterHint:g,renderTitle:i.createElement(u.Z,{title:n,titleOverlay:r,data:"c1"===S?void 0:s},S&&i.createElement(T.Z,{options:_,activeObj:S,rightHook:!0,onChange:this.onChartTypeChange}),i.createElement(a.default,{placement:"top",content:"\u663e\u793a\u56fe\u8868\u6807\u7b7e",mouseEnterDelay:.6,getPopupContainer:function(e){return e}},i.createElement("i",{className:"icon-tubiaobiaoqian "+(v?"active":"")+" "+("c1"===S?"disabled":""),onClick:function(){"c1"!==S&&e.setState({showLabel:!v})}})),i.createElement(a.default,{placement:"top",content:"\u5bfc\u51fa\u6570\u636e",mouseEnterDelay:.6,getPopupContainer:function(e){return e}},i.createElement("i",{className:"icon-daochu",onClick:this.onExportExcel})),i.createElement(a.default,{placement:"top",content:"\u5bfc\u51fa\u56fe\u7247",mouseEnterDelay:.6,getPopupContainer:function(){return document.querySelector(".header_Filter_bar")}},i.createElement("i",{className:"icon-xiazaitupian  "+("c1"===S?"disabled":""),onClick:this.onExportImage})))},i.createElement(i.Fragment,null,("c0"===S||!S)&&i.createElement(x,{dataSource:s,title:n,showLabel:v,onChange:this.onChange,onBarTypeChange:function(t){e.setState({barType:t})},compareData:h,pageType:d,totalCount:m,totalPreCount:f,ref:function(t){return e.barChartRef=t},onMsgClick:y}),"c1"===S&&i.createElement(p,{onChange:this.onChange,data:s,title:n,onMsgClick:y})),i.createElement(w,{pageType:d,compareData:h,oriCompareData:C,data:k,totalCount:m,totalPreCount:f,compareSpu:P,title:n,loading:l,barType:N,onChange:b,pageIndex:I,pageSize:O,chainValue:D,onChainValueChange:function(t){e.setState({chainValue:t})},onPageChange:this.onPageChange,onMsgClick:y}))},t}(i.Component);const I=k},89212:(e,t,n)=>{n.d(t,{Sv:()=>u,yz:()=>l,LV:()=>s});var a=n(87462),r=n(67294),o=n(33798),i=n(30381),c=n.n(i),u=function(e){return"number"===typeof e&&e?r.createElement(o.Z,{style:{fontSize:"12px",margin:"0 10px",cursor:"default"},defaultIcon:e>0?"shangsheng":"xiajiang",activeIcon:e>0?"shangsheng":"xiajiang"}):"--"},l=function(e){if(e){var t=e.numOfDays,n=e.from,r=(e.to,e.date);return(0,a.Z)({},e,{from:"month"===r?c()(n).subtract(1,"months").startOf("month").format("YYYY-MM-DD"):"1"===r?c()(n).subtract(1,"days").startOf("day").format("YYYY-MM-DD"):c()(n).subtract(1,"days").subtract(t,"days").format("YYYY-MM-DD"),to:"month"===r?c()(n).subtract(1,"months").endOf("month").format("YYYY-MM-DD"):"1"===r?c()(n).subtract(1,"days").endOf("day").format("YYYY-MM-DD"):c()(n).subtract(1,"days").format("YYYY-MM-DD"),quickChoice:"month"===r?c()(n).subtract(1,"months").startOf("month").format("YYYY-MM-DD")+" - "+c()(n).subtract(1,"months").endOf("month").format("YYYY-MM-DD"):c()(n).subtract(1,"days").subtract(t,"days").format("YYYY.MM.DD")+" - "+c()(n).subtract(1,"days").format("YYYY.MM.DD")})}return e};function s(e,t){return"HOUR"===t?{from:c()(e).format("YYYY-MM-DD HH:00:00"),to:c()(e).format("YYYY-MM-DD HH:59:59")}:{from:c()(e).format("YYYY-MM-DD HH:00:00"),to:c()(e).format("YYYY-MM-DD 23:59:59")}}}}]);