(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[8625],{89125:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-35ee9e"},57471:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-4eaaf9"},47426:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-70af35"},58476:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-c6a1e8"},13192:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});const a=n.p+"html-aa245f"},38625:(e,t,U)=>{"use strict";U.r(t),U.d(t,{default:()=>pt});var n=U(37316),a=U.n(n),r=U(67154),j=U.n(r),s=U(85354),i=U.n(s),k=U(19586),T=U(48577),L=U(30133),I=U(35239),J=U(67294),Y=U.n(J),z=U(73098),l=(U(75314),U(11187)),t=U(45697),n=U.n(t),f=U(36144),G=U(92360),d=U(12234),K=U(43036),r=U(30381),Z=U.n(r),Q=U(39432),s=U(55609),u={"正面":1,"中性":0,"负面":-1},t=function(a){function e(e){var o=a.call(this,e)||this;o.switchEmotion=function(t){var e=o.props,n=e.id,a=e.index,e=e.routing;f.h.post("/inbox/messages/update",{flag:"message",id:n,index:a,routing:e,score:t}).then(function(e){2e4===e.data.code&&o.setState({emotion:t},function(){return o.props.changeMessage({id:n,escore:t})})})},o.handleImgError=function(){o.setState({userHead:U(13192)})},o.renderAvatarOverlay=function(e){var t=e.userName,n=e.userDescription,a=e.userFocusCount,r=e.userFollowerCount,s=e.userBlogCount,i=e.userVerifyLevel,l=e.userGender,e=o.state.userHead;return Y().createElement("div",{className:"msg_userHead_overlay_wrap"},Y().createElement("div",{className:"msg_top_userHead_overlay"},Y().createElement("img",{src:e,onError:o.handleImgError}),Y().createElement("div",null,Y().createElement("div",null,t),Y().createElement("div",{className:"introduction"},n))),Y().createElement("div",{className:"msg_middle_userHead_overlay"},Y().createElement("ul",null,Y().createElement("li",null,Y().createElement("div",null,Q.ZP.getApproximateNum(a)),Y().createElement("span",null,"关注")),Y().createElement("li",null,Y().createElement("div",null,Q.ZP.getApproximateNum(r)),Y().createElement("span",null,"粉丝")),Y().createElement("li",null,Y().createElement("div",null,Q.ZP.getApproximateNum(s)),Y().createElement("span",null,"微博")))),Y().createElement("div",{className:"msg_bottom_userHead_overlay"},Y().createElement("ul",null,""!==i&&Y().createElement("li",null,Y().createElement("span",null,"认证等级"),i),""!==l&&Y().createElement("li",null,Y().createElement("span",null,"性别"),"f"===l?"女":"男"))))};var t=e.emotionScore,n=e.avatar,e=e.msgType;return o.state={emotion:t,userHead:"官"===e?U(47426):n?n.startsWith("http")?n:"http://"+n:U(13192)},o}return i()(e,a),e.prototype.render=function(){var n=this,e=this.props,t=e.userName,a=e.score,r=e.time,s=e.msgType,i=e.alignDirection,l=e.isWeibo,o=this.state,e=o.userHead,c=o.emotion;return Y().createElement("div",{className:"msg-header-wrapper"},Y().createElement("div",{className:"msg-header-left"},!i||i&&"right"!==i?Y().createElement(J.Fragment,null,l?Y().createElement(K.Z,{overlayClassName:"yt_msg_userHead_overlay_tips",overlay:this.renderAvatarOverlay(this.props),placement:"bottomLeft",mouseEnterDelay:.6},Y().createElement("div",{style:{display:"inline"}},Y().createElement("img",{src:e,onError:this.handleImgError}),Y().createElement("span",null,t||""))):Y().createElement("div",null,Y().createElement("img",{src:e,onError:this.handleImgError}),Y().createElement("span",null,t))):null),Object.values(u).includes(c)&&"官"!==s&&Y().createElement("div",{className:"msg-header-center"},Y().createElement("div",{className:"msg-center-icon"},Y().createElement("i",{className:"cem-icon icon-cem_"+(-1===c?"negative":0===c?"neutral":"positive")}),Y().createElement("ul",{className:"popup-list"},["正面","中性","负面"].filter(function(e){return u[e]!==c}).map(function(e,t){return Y().createElement("li",{key:t,onClick:function(){return n.switchEmotion(u[e])}},Y().createElement(d.l,{className:"normal-state",name:"负面"===e?"negative-no-hover":"中性"===e?"neutral-no-hover":"positive-no-hover"}),Y().createElement(d.l,{className:"hover-state",name:"负面"===e?"negative-hover":"中性"===e?"neutral-hover":"positive-hover"})," ",e)})))),Y().createElement("div",{className:i&&"right"===i?"msg-header-right avatar-right":"msg-header-right"},!i||i&&"right"!==i&&a&&Y().createElement(G.Rate,{disabled:!0,key:a,value:a,colors:["#FF8373","#FF8373","#FF8373"],showText:!1}),i&&"right"===i&&Y().createElement("div",{className:"avatar-username"},Y().createElement("span",null,t),Y().createElement("img",{src:e,onError:this.handleImgError})),Y().createElement("span",{className:"time"},Z()(r).format("YYYY/MM/DD HH:mm:ss")),s&&Y().createElement("span",{className:"msg-type"},s.substring(0,1))))},e}(Y().PureComponent);t.propTypes={isWeibo:n().boolean,avatar:n().string,userName:n().string.isRequired,emotionScore:n().number,score:n().number,time:n().string.isRequired,msgType:n().string,id:n().string,index:n().string,routing:n().string,alignDirection:n().string};const q=(0,s.connect)(null,function(t){return{changeMessage:function(e){return t({type:"inbox/changeMessage",payload:e})}}})(t);var r=U(93913),o=U.n(r),t=function(e){function t(){var c=e.call(this)||this;return c.replaceImgSrc=function(){for(var e=document.querySelectorAll(".msg-reply figure img"),t=0;t<e.length;t++){var n=e[t].getAttribute("data-actualsrc");n&&(e[t].src=n)}},c.fetchReplyList=function(){var e=c.state,t=e.pageIndex,n=e.list,e=c.props,a=e.projectId,r=e.categoryId,s=e.group,i=e.oid,l=e.suboid,o=e.sourceId;c.setState({loading:!0},function(){f.h.post("/message/talk/list",{projectId:a,categoryId:r,group:s,oid:i,suboid:l,sourceId:o,pageIndex:t,pageSize:15}).then(function(e){var t=e.data;2e4===t.code&&(t=(e=t.result).total,e=e.list,c.setState({total:t,list:n.concat(e)}))}).finally(function(){c.setState({loading:!1,isInitial:!1})})})},c.handleCollapse=function(){var e=c.state.collapsed;c.setState({collapsed:!e})},c.handleClickMoreBtn=function(){var e=c.state,t=e.pageIndex,n=e.collapsed,e=e.moreBtnClickTimes;c.setState({pageIndex:n?t:t+1,moreBtnClickTimes:e+1},function(){return!n&&c.fetchReplyList()})},c.state={pageIndex:1,total:0,list:[],isInitial:!0,loading:!1,collapsed:!0,moreBtnClickTimes:0},c}i()(t,e);var n=t.prototype;return n.componentDidMount=function(){this.fetchReplyList()},n.componentDidUpdate=function(e,t){var n=this.state,a=n.list,n=n.moreBtnClickTimes;(0===n||0<n&&t.list.length!==a.length)&&this.replaceImgSrc()},n.render=function(){var e=this.state,t=e.total,n=e.list,a=e.loading,r=(e.isInitial,e.pageIndex),s=e.collapsed,e=15<t?t-15*r:0,i=0<n.length?function(e){var t=document.createElement("canvas");document.body.appendChild(t);var n=t.getContext("2d");n.font="12px Arial";e=n.measureText(e).width;return document.body.removeChild(t),Math.ceil(e)}(Math.max.apply(null,n.map(function(e){return e.likes})))+14+24+119:0;return Y().createElement("div",{className:"msg-reply-wrapper",style:{display:t?"block":"none"}},s?Y().createElement("div",null,Y().createElement("span",{className:"username"},0<n.length&&n[0].username," 等人 "),Y().createElement("span",{className:"operation",onClick:this.handleCollapse},"共",t,"条回复",Y().createElement("i",{className:"icon-cem_show-more"}))):n.map(function(e,t){return Y().createElement("div",{className:"msg-reply",key:e.cTime+"-"+t},Y().createElement("div",{className:"msg-reply-left",style:{width:"calc(100% - "+(i+24)+"px)"}},Y().createElement("span",{className:"username"},e.username,"："),Y().createElement("span",{className:"content",dangerouslySetInnerHTML:{__html:e.content}})),Y().createElement("div",{className:"msg-reply-right fade",style:{width:i+10}},Y().createElement("i",{className:"icon-cem_weibo-fabulous"}),Y().createElement("span",null,Q.ZP.getApproximateNum(e.likes)),Y().createElement("span",null,e.cTime)))}),a&&Y().createElement(G.Loading,null),1<=r&&Y().createElement("div",{className:s?"msg-reply-footer":"msg-reply-footer expand"},0<e&&!s&&Y().createElement("span",{className:"operation",onClick:this.handleClickMoreBtn},"更多",e,"条回复",Y().createElement("i",{className:"icon-cem_arrow-launches"})),!s&&Y().createElement("span",{className:"operation collapse",onClick:this.handleCollapse},"收起全部")))},t}(J.Component);t.propTypes={projectId:n().string.isRequired,categoryId:n().number.isRequired,group:n().string.isRequired,oid:n().string.isRequired,suboid:n().string.isRequired,sourceId:n().string.isRequired};const X=t;var $=U(29030),c=U(66982),m=function(t){function e(e){return t.call(this,e)||this}i()(e,t);var n=e.prototype;return n.componentDidMount=function(){},n.render=function(){var e=this.props,t=e.images,n=e.isShow,a=e.startIndex,e=e.closeDialog;return Y().createElement(G.Dialog,{visible:n,className:"imgpreview-dialog",onCancel:e,lockScroll:!1},Y().createElement(G.Dialog.Body,null,Y().createElement(c.Z,{items:t,startIndex:a})))},e}(Y().Component);m.propTypes={images:n().array.isRequired,isShow:n().bool.isRequired,closeDialog:n().func.isRequired,startIndex:n().number.isRequired};var r=U(94184),ee=U.n(r),t=function(r){function e(e){var s=r.call(this,e)||this;s._processContent=function(){var e;0<s.contentRef.getElementsByTagName("img").length?(e=2,s.intToken=setInterval(function(){0<e?s.contentRef&&s.contentRef.scrollHeight>s.contentMaxHeight?(s.setState({loading:!1,showCollapse:!0}),clearInterval(s.intToken)):e--:(s.setState({loading:!1}),clearInterval(s.intToken))},200)):s.contentRef&&s.contentRef.scrollHeight>s.contentMaxHeight?s.setState({showCollapse:!0,loading:!1}):s.setState({loading:!1})},s._getImg=function(r,t){new Promise(function(e,t){var n=document.getElementById("imgframe").contentWindow.document.createElement("img"),a=r.getAttribute("data-original")||r.getAttribute("data-actualsrc")||r.getAttribute("src")||null;n.src=a,n.onload=function(){e(a)}}).then(function(e){r.src=e,t&&t(e)})},s._isShouldContentAlignRight=function(e,t,n){var a=s.props.data,r=a.showDetailType,a=a.type,a=r||a;return!(!n||"回"!==a&&"备"!==a||!(0<t))&&(0,Q.jD)(e,14)<t-24-32-32-180},s._handleImgPreview=function(e,t,n){n=n.map(function(e){return{thumbnail:e,original:e}});s.setState({isShowPreview:!0,sourcePicArr:n,startIndex:t})},s._renderPictures=function(e){var t=e.pictures,n=e.vimg,a=e.video,e=(e.messageCategory,e.sourceId),r=[];try{r=JSON.parse(t),"1"===e&&r.forEach(function(e,t){return r[t]=e.replace(/s\d{2,3}x\d{2,3}/,"s960x960")})}catch(e){}return(n||0<r.length)&&Y().createElement("div",{className:"picture_weibo"},n&&Y().createElement("a",{href:a,target:"_blank",rel:"noopener noreferrer"},Y().createElement("span",{className:"video_cover",style:{backgroundImage:"url("+n+")"}},Y().createElement("i",{className:"icon-shipinbofang"}))),0<r.length&&r.reduce(function(e,t,n){return n<9?[].concat(e,[Y().createElement("span",{data_count:"+"+(r.length-9),className:"pic_cover "+(9<r.length&&8===n?"pic_end":""),key:n,style:{backgroundImage:"url("+t+")"},onClick:function(e){s._handleImgPreview(e,n,r)}},Y().createElement(G.Icon,{name:"view",className:"big"}))]):e},[]),Y().createElement(m,{startIndex:s.state.startIndex,images:s.state.sourcePicArr,closeDialog:function(){s.setState({isShowPreview:!1})},isShow:s.state.isShowPreview}))},s._handleOnShowAllContentClick=function(){s.setState({isCollapse:!s.state.isCollapse})},s.contentRef=void 0;var t=e.data.content,n=e.contentWidth,a=e.options,e=e.detailParams.messageCategory,a=a.includes("alignRight");return s.state={shouldContentAlignRight:s._isShouldContentAlignRight(t,n,a),shouldAlignRight:a,showCollapse:!1,loading:!0,isCollapse:"COMMENT"!==e,isShowPreview:!1,startIndex:0,sourcePicArr:[]},s}i()(e,r);var t=e.prototype;return t.componentDidMount=function(){this._processContent()},t.componentDidUpdate=function(e,t){var n=e.contentWidth,a=this.props,r=a.contentWidth,e=a.data.content,a=this.state.shouldAlignRight;n!==r&&this.setState({shouldContentAlignRight:this._isShouldContentAlignRight(e,r,a)})},t.render=function(){var t=this,e=this.state,n=e.shouldContentAlignRight,a=e.shouldAlignRight,r=e.showCollapse,s=e.isCollapse,i=e.loading,l=this.props,o=l.data,c=o.id,d=o.content,u=o.pictures,m=o.originSource,p=o.repostsCount,h=o.commentsCount,g=o.attitudesCount,f=o.viewsCount,v=o.categoryId,E=o.oid,y=o.group,S=o.suboid,C=o.sourceId,N=o.sourceName,w=o.aspectVos,_=o.tagVos,k=o.score,T=o.dataLevel,L=o.title,I=o.code,b=o.target,O=o.question,D=o.requirement,M=o.money,x=o.url,R=o.progress,V=o.questionnaireName,P=o.highLightInfoList,F=o.messageId,W=o.video,A=o.vimg,B=o.type,H=l.detailParams,U=H.messageCategory,j=H.projectId,J=l.options,z=l.isTagClicked,e=l.fetchedTag,Z=l.handleTagClick,o=l.harmonyEvent,q=l.onFeedbackClick,H=!(!z||z.id!==c),l=T&&/^COMMENT/.exec(T);return Y().createElement("div",{className:"yt_message_detail_content"},Y().createElement("div",{className:"content_wrapper "+("COMMENT"===U?"comment_content_wrapper":"")},("QUE_ANS_QUESTION"===T||"POST"===T||"NEWS"===T||"COMPLAINT"===T||"SELF_POST"===T||"VIDEO"===T||"OFFICIAL_ACCOUNT"===T)&&Y().createElement("div",{className:"sub_title",dangerouslySetInnerHTML:{__html:o(L)}}),"VIDEO"===T&&Y().createElement("a",{href:x,target:"_blank",rel:"noopener noreferrer",style:{color:"#0847a6"}},"查看原链接"),"COMPLAINT"===T&&Y().createElement("div",{className:"complaint_wrapper"},Y().createElement("div",null,Y().createElement("span",null,"投诉编号：",I),Y().createElement("span",null,"投诉对象：",b)),Y().createElement("div",null,Y().createElement("span",null,"投诉问题：",O),Y().createElement("span",null,"投诉要求：",D)),Y().createElement("div",null,Y().createElement("span",null,"涉诉金额：",Q.ZP.getApproximateNum(parseInt(M)),"元"),Y().createElement("span",null,"投诉进度：",R))),Y().createElement(G.Loading,{loading:i,className:"content_loading"},Y().createElement("div",{className:"content_card_titlte"},Y().createElement("span",null,V||"")),Y().createElement("div",{ref:function(e){return t.contentRef=e},className:ee()("content",{content_text:s}),style:{maxHeight:s?this.contentMaxHeight:"unset",textAlign:n?"right":"left",marginRight:a?180:"COMMENT"===U?90:60,lineHeight:"COMMENT"===U?"28px":"unset"}},Y().createElement("div",{dangerouslySetInnerHTML:{__html:o(d,P,H)}}),"COMMENT"===U&&"COMMENT_REPLY"!==T&&"备"!==B&&e?Y().createElement("span",{className:"feedback",onClick:function(){return q({messageContent:d,messageId:F,aspectVos:w})}},Y().createElement("i",{className:"icon-fankui"}),"反馈"):null)),(u||A)&&this._renderPictures({pictures:u,vimg:A,video:W,messageCategory:U,sourceId:C}),r&&"COMMENT"!==U&&Y().createElement("div",{className:"content_search",onClick:this._handleOnShowAllContentClick},s?"显示全文":"收起全文")),!["bdtb","bd"].includes($.z[N])&&J.includes("property")&&Y().createElement("div",{className:"property"},m&&Y().createElement("span",{className:"tail"},m),Y().createElement("span",{className:"social"},void 0!==p&&Y().createElement("span",{className:"repost"},Q.ZP.getApproximateNum(p)),void 0!==h&&Y().createElement("span",{className:"comment"},Q.ZP.getApproximateNum(h)),void 0!==f&&Y().createElement("span",{className:"views"},Q.ZP.getApproximateNum(f)),void 0!==g&&Y().createElement("span",{className:"attitude"},Q.ZP.getApproximateNum(g)))),J.includes("score")&&Y().createElement("div",{className:"score"},"净推荐值：",k,"分"),J.includes("reply")&&Y().createElement(X,{categoryId:v,oid:E,group:y,projectId:j,suboid:S,sourceId:C}),!l&&(_&&_.length||w&&w.length)?Y().createElement("div",{className:"line_message"}):null,_&&_.length?Y().createElement("div",{className:"tags"},Y().createElement("span",{className:"name"},"标签"),_.map(function(e){return Y().createElement("span",{key:e.tagId,className:z&&z.tagId===e.tagId&&z.id===c?"active":"",onClick:function(){return Z(e.tagId,c)}},e.tagValue)})):null,w&&w.length?Y().createElement("div",{className:"aspects",style:{paddingTop:_&&_.length?"10px":""}},Y().createElement("span",{className:"name"},"指标"),w.map(function(e,t){return Y().createElement(K.Z,{key:"aspects_"+t,mouseEnterDelay:.6,overlay:Y().createElement("div",{className:"aspects_tip"},Y().createElement("p",null,Y().createElement("span",null,"一级指标"),Y().createElement("span",null,e.aspect1Name)),Y().createElement("p",null,Y().createElement("span",null,"二级指标"),Y().createElement("span",null,e.aspect2Name)),"COMMENT"!==U&&Y().createElement(Y().Fragment,null,Y().createElement("p",null,Y().createElement("span",null,"三级指标"),Y().createElement("span",null,e.aspect3Name)),Y().createElement("p",null,Y().createElement("span",null,"四级指标"),Y().createElement("span",null,e.aspect4Name))),Y().createElement("p",null,Y().createElement("span",null,"指标情感"),Y().createElement("span",null,3===e.escore?"负面":8===e.escore?"正面":"--"))),placement:"top"},Y().createElement("span",{className:"escore"+e.escore},"COMMENT"===U?e.aspect2Name:e.aspect4Name))})):null)},o()(e,[{key:"contentMaxHeight",get:function(){switch(this.props.detailParams.messageCategory){case"QUE_ANS":case"NEWS":case"SELF":return 168;case"COMPLAINT":case"QUESTIONAIRE":return 56;case"COMMENT":default:return 48}}}]),e}(Y().PureComponent);const te=t;t.proTypes={data:n().object,contentWidth:n().number,options:n().array.isRequired,detailParams:n().object.isRequired};U(1025);var p=U(65400),h=(U(54067),U(64713)),v=U(5133);var g={username:"",userHeadUrl:"",email:"",id:"",userId:""};const E=function(t){function e(e){var p=t.call(this,e)||this;return p.showDialog=function(e){var t=e.data,n=e.callback;p.state.visible?p.setState({visible:!0,data:t,callback:n}):p.setState({visible:!1,data:void 0,callback:void 0},function(){return p.setState({visible:!0,data:t,callback:n})})},p.handleSelectUsers=function(e){var t=p.state.data.id,n=e.id;p.setState({data:j()({},p.state.data,e,{id:t,userId:n})})},p.submitTransform=function(){var e,t,n,a,r,s,i,l,o,c=p.transTextarea.value,d=p.state,u=d.data,m=d.callback;e=j()({},u,{id:u.userId,remark:c,type:u.MESSAGE_TYPE}),t=e.detailId,n=e.id,a=e.connectionId,r=e.remark,s=e.content,i=e.url,l=e.index,o=e.messageId,d=e.escore,c=e.score,u=e.mid,e=e.type,f.h.post("/message/forward/add",{id:t,connectionId:a,remark:r,content:s,url:i,index:l,userIds:[n],messageId:o,escore:d,score:c,mid:u,type:e}).then(function(e){e=e.data;2e4===e.code&&(v.Z.success(e.msg),m&&m(p.state.data)),p.setState({visible:!1,data:void 0,callback:void 0,searchKeyword:""})})},p._handleOnCancel=function(){p.setState({visible:!1,data:void 0,callback:void 0})},p._handleOnChange=function(e){return p.setState({searchKeyword:e.target.value})},p.state={visible:!1,data:void 0,callback:void 0,searchKeyword:""},p}i()(e,t);var n=e.prototype;return n.componentDidMount=function(){},n.render=function(){var n=this,e=this.state,t=e.visible,a=e.data,r=void 0===a?g:a,s=e.searchKeyword,i=r.username,a=r.userHeadUrl,e=r.email,l=r.id,o=r.userId;return Y().createElement(G.Dialog,{customClass:"yt_inbox_dialog",visible:t,onCancel:function(){return n.setState({dialogVisible:!1})},closeOnClickModal:!1},Y().createElement(G.Dialog.Body,{className:"body"},Y().createElement("p",{className:"top"},"当前经办人"),i?Y().createElement("div",{className:"user-list"},Y().createElement("img",{src:a||U(13192)}),Y().createElement("span",{className:"name"},i),Y().createElement("span",{className:"email"},"-"+e)):Y().createElement("div",{className:"user-list"},Y().createElement("img",{src:U(13192)}),Y().createElement("span",{className:"name"},"暂未选择")),Y().createElement("div",{className:"line"}),Y().createElement("input",{onChange:this._handleOnChange,type:"text",placeholder:"搜索"}),Y().createElement("p",null,s.trim()?"搜索结果":"推荐"),Y().createElement("ul",null,this.showUserList.map(function(e,t){return Y().createElement("li",{className:"user-list "+(l===e.id||o===e.id?"sel":""),key:t,onClick:function(){return n.handleSelectUsers(e)}},Y().createElement("img",{src:e.userHeadUrl||U(13192)}),Y().createElement("span",{className:"name"},e.username),Y().createElement("span",{className:"email"},"-"+e.email))})),Y().createElement("div",{className:"line"}),Y().createElement("textarea",{ref:function(e){return n.transTextarea=e},placeholder:"说明备注",autoFocus:!0})),Y().createElement(G.Dialog.Footer,{className:"dialog-footer"},Y().createElement(G.Button,{type:"primary",disabled:!i,onClick:this.submitTransform},"确 定"),Y().createElement(G.Button,{onClick:this._handleOnCancel},"取 消")))},o()(e,[{key:"showUserList",get:function(){var t=this.state.searchKeyword,e=this.props.operatorList;return t.trim()?e.filter(function(e){return-1!==e.username.toLocaleLowerCase().indexOf(t.trim().toLocaleLowerCase())||-1!==e.email.toLocaleLowerCase().indexOf(t.trim().toLocaleLowerCase())}):e}}]),e}(Y().PureComponent);var y=U(61193);var S=U(84122),r=U(64396),C=r.Z.global,N=r.Z.message.inboxDetail,w=r.Z.public.menu,_={reply:"回复",remark:"备注"},b={0:"未解决",1:"未解决",2:"已解决",3:"解决中"},t=function(n){function e(e){var g=n.call(this,e)||this;g._getPageRef=function(e){return g.pageRef=e},g._handleOnWsMessage=function(e){var t,n=e.data;n.type&&"ws"===n.type&&(n=(e=n.payload).type,t=e.result,"MESSAGE_HANDLE_RESULT"===n&&g.props.data.id===t.id&&setTimeout(function(){g.props.updateRuleSeetingList({ruleSettingList:g.props.ruleSettingList.filter(function(e){return e.id!==t.id})})},100))},g._handleOnRemarkClick=function(){var e=g.props.onEditBoxOpen;g.setState({editType:"remark"},function(){return e&&e(!0)})},g._handleOnReplyClick=function(){var e=g.props.onEditBoxOpen;g.setState({editType:"reply"},function(){return e&&e(!0)})},g._handleOnCancel=function(){var e=g.props.onEditBoxOpen;g.setState({editType:""},function(){return e&&e(!1)})},g._handleOnConfirm=function(){var e,n=g.state.editType,t=g.props,a=t.data,r=t.projectId,s=t.onEditBoxOpen,i=t.MESSAGE_TYPE,l=t.curSelectMessage,o=a.id,c=a.connectionId,d=a.routing,u=a.sourceName,m=a.mid,p=a.index,h=g.textareaRef.value;h?"remark"===n?(e={id:o,connectionId:c,mid:m,routing:d,content:h,projectId:r,type:i||l.messageCategory},t=e.id,c=e.connectionId,m=e.mid,d=e.routing,i=e.content,l=e.projectId,e=e.type,f.h.post("/message/remark/add",{id:t,mid:m,routing:d,content:i,connectionId:c,projectId:l,type:e}).then(function(e){2e4===e.data.code&&g.setState({editType:""},function(){g._handleRefreshDetail(o,p),s&&s(!1)})})):"reply"===n&&(0,S.YG)(function(e){var t=$.z[u];"xl"===t?(0,S.Pl)(e,a,h,function(e){return e=j()({},e,{projectId:r}),f.h.post("/message/weibo/reply/add",{id:e.id,projectId:e.projectId,insertTimestamp:e.timestamp,img:e.profile_image_url,uid:e.uid,username:e.screen_name,content:e.content}).then(function(){v.Z.success("回复成功"),g.setState({editType:""},function(){g._handleRefreshDetail(o,p,n),s&&s(!1)})}).catch(function(){return v.Z.error("回复失败")})}):"bd"===t||"bdtb"===t?(0,S.VG)(e,a,h,function(e){return e=j()({},e,{projectId:r}),f.h.post("/message/baidu/reply/add",{id:e.id,projectId:e.projectId,insertTimestamp:e.timestamp,img:e.headImg,uid:e.id,username:e.username,content:e.content}).then(function(){v.Z.success("回复成功"),g.setState({editType:""},function(){g._handleRefreshDetail(o,p,n),s&&s(!1)})}).catch(function(){return v.Z.error("回复失败")})}):"zh"===t&&(0,S.Rr)(e,a,h,function(e){return e=j()({},e,{projectId:r}),f.h.post("/message/zhihu/reply/add",{projectId:e.projectId,id:e.id,answerId:e.id,insertTimestamp:e.created_time,img:e.avatar_url,uid:e.uid,username:e.name,userDesc:e.headline,userHome:e.url,content:e.content}).then(function(){v.Z.success("回复成功"),g.setState({editType:""},function(){g._handleRefreshDetail(o,p,n),s&&s(!1)})}).catch(function(){return v.Z.error("回复失败")})})}):v.Z.error("请输入内容")},g._handleOnStatusChange=function(t){var e=g.props,n=e.data,a=n.id,r=n.routing,s=n.index,i=e.projectId,l=e.MESSAGE_TYPE;e=(n={id:a,routing:r,status:t,projectId:i,type:l}).id,r=n.routing,i=n.projectId,l=n.status,n=n.type,f.h.post("/message/private/operate",{id:e,routing:r,projectId:i,status:l,type:n}).then(function(e){2e4===e.data.code&&g.setState({status:t},function(){return g._handleRefreshDetail(a,s)})})},g._handleOnOperatorClick=function(){var e=g.props,t=e.data,n=e.fetchPersonalCount,e=e.MESSAGE_TYPE;g.opeDialogRef&&g.opeDialogRef.showDialog({data:j()({},t.messageVO,{connectionId:t.connectionId,mid:t.mid,content:t.content,routing:t.routing,url:t.url,detailId:t.id,index:t.index,messageId:t.messageId,escore:t.escore,score:t.score,MESSAGE_TYPE:e}),callback:function(e){g._handleRefreshDetail(t.id,t.index),e.userId===y.Z.getUser().userId&&n()}})},g._handleRefreshDetail=function(e,t,n){var a=g.props.data.messageCategory;"reply"===n?(g.props.resetPageIndex(),g.props.fetchMsgDetail()):"SERVICE"===a?(g.props.resetPageIndex(),g.props.fetchCustomerServiceDetail()):g.props.fetchSpecifyMsg({id:e,index:t})},g._renderValidateOverlay=function(){var e=g.props,s=e.data,t=e.settingMessageInvalidate,n=e.settingMessageValidate,a=g.props.ruleSettingList.find(function(e){return e.id===g.props.data.id}),i=s.tagVos&&s.tagVos.find(function(e){return"无效数据"===e.tagName})||!1,r=a||t||n,l=y.Z.getUser(),o="",e="";return r?(a?e="系统正在将此消息按规则处理...":t?e="系统正在将此消息标记为无效数据...":n&&(e="系统正在将此消息标记为有效数据..."),o=Y().createElement("div",{className:"history_content"},a&&a.msgHistory||g.msgHistory)):(e=i?"将此消息"+(s.msgHistory?"重":"")+"设为有效数据？":"将此消息"+(s.msgHistory?"重":"")+"设为无效数据？",s.msgHistory&&(o="GARBAGE_BY_RULE"===s.msgType?Y().createElement("div",{className:"history_content"},"此消息被无效数据规则「"+s.msgHistory+"」自动标记为无效数据"):Y().createElement(Y().Fragment,null,Y().createElement("div",{className:"history_content"},s.msgHistory),Y().createElement(h.default.Group,{className:"history_content_radio",value:g.state.validateRuleType,onChange:function(e){g.setState({validateRuleType:e.target.value})}},Y().createElement(h.default,{value:"validate"},'设为"'+(i?"有":"无")+'效数据"'),Y().createElement(h.default,{value:"rule"},"按规则处理"))))),Y().createElement("div",{className:"validate_status_overlay"},Y().createElement("div",{className:"validate_status_title"},e),Y().createElement("div",{className:"validate_status_content"},o),!r&&Y().createElement("div",{className:"validate_status_bottom"},Y().createElement(p.default,{className:"btn_confirm",size:"small",type:"primary",onClick:function(){var e=g.props,t=e.setMessageHandleByRule,n=e.setMessageValidate,a=e.setMessageInvalidate,e=g.state.validateRuleType,r={id:s.id,index:s.index};g.msgHistory="此消息被 "+l.username+"（"+l.email+"）于"+Z()().format("YYYY-MM-DD HH:mm")+"设为","rule"===e?(g.msgHistory+="按规则处理",g.setState({validateRuleType:"validate"},function(){return t(j()({},r,{msgHistory:g.msgHistory}))})):i?(g.msgHistory+="有效数据",n(j()({},r,{msgHistory:g.msgHistory}))):(g.msgHistory+="无效数据",a(j()({},r,{msgHistory:g.msgHistory})))}},"确定")))};var t=Object.keys(b).map(function(e){return{title:b[e],value:parseInt(e)}});return g.state={editType:"",status:e.data.status,statusOptions:t,validateRuleType:"validate"},g.msgHistory="",g.textareaRef=void 0,g}i()(e,n);var t=e.prototype;return t.componentDidMount=function(){window.addEventListener("message",this._handleOnWsMessage)},t.componentWillUnmount=function(){window.removeEventListener("message",this._handleOnWsMessage)},t.render=function(){var t=this,e=this.props,n=e.data,a=e.modelType,r=e.operatorList,s=e.notContain,i=void 0===s?[]:s,l=(e.messageStatus,this.state),s=l.editType,e=l.statusOptions,o=l.status,l=n.messageVO,l=void 0===l?{userHeadUrl:"",username:""}:l;return Y().createElement("div",{className:"yt_message_detail_footer"},s?Y().createElement("div",{className:"edit_view"},Y().createElement("textarea",{ref:function(e){return t.textareaRef=e},placeholder:"请输入...",autoFocus:!0}),Y().createElement("div",null,Y().createElement(p.default,{onClick:this._handleOnCancel},"取消"),Y().createElement(p.default,{type:"primary",onClick:this._handleOnConfirm},_[s]))):Y().createElement("div",{className:"button_view"},Y().createElement("span",{className:"btn_item btn_remark",onClick:this._handleOnRemarkClick},"备注"),!i.includes("reply")&&["xl","bd","zh","bdtb","jts","hmts","dy"].includes($.z[n.sourceName])&&"答"!==n.showDetailType&&Y().createElement("span",{className:"btn_item btn_reply",onClick:this._handleOnReplyClick},"回复"),!i.includes("source")&&Y().createElement("a",{className:"btn_item btn_source",href:n.url,target:"_blank",rel:"noopener noreferrer"},"数据源"),!i.includes("operator")&&Y().createElement("span",{className:"operator"},"经办人：",Y().createElement("span",{onClick:this._handleOnOperatorClick},l.username&&Y().createElement("img",{src:l.userHeadUrl||U(13192)}),l.username||"请选择",Y().createElement("i",{className:"icon-cem_show-more"}))),(void 0!==o||""!==o)&&a&&l.username&&Y().createElement("span",{className:"operator_status"},Y().createElement("span",{className:"status_"+o},b[o]),Y().createElement("div",{className:"status_panel"},e.reduce(function(e,t,n){return!(0!==n&&1!==n||0!==o&&1!==o)||n===o||1===n&&e.find(function(e){return 0===e.value})?e:[].concat(e,[t])},[]).map(function(e){return Y().createElement("div",{className:"status_panel_item",key:e.value,onClick:function(){return t._handleOnStatusChange(e.value)}},e.title)}))),n.tagVos&&Y().createElement("span",{className:"validate_status"},Y().createElement(K.Z,{placement:"top",overlayClassName:"validate_message_tips",overlay:this._renderValidateOverlay(),mouseEnterDelay:.6},Y().createElement("i",{className:"icon-cem_invalid-data-modification"})))),r&&Y().createElement(E,{ref:function(e){return t.opeDialogRef=e},operatorList:r}))},e}(Y().PureComponent);const ne=(0,s.connect)(function(e){var t=e.inbox,n=e.loading,e=a()(e,["inbox","loading"]);return{operatorList:e[N].operatorList,MESSAGE_TYPE:t.MESSAGE_TYPE,curSelectMessage:t.curSelectMessage,ruleSettingList:e[""+C].ruleSettingList,settingMessageInvalidate:n.effects[N+"/setMessageInvalidate"]||!1,settingMessageValidate:n.effects[N+"/setMessageValidate"]||!1}},function(t){return{updateRuleSeetingList:function(e){return t({type:C+"/save",payload:e})},resetPageIndex:function(){return t({type:N+"/save",payload:{pageIndex:0,resetTime:(new Date).getTime()}})},fetchMsgDetail:function(e){return t({type:N+"/fetchMsgDetail",payload:e})},fetchCustomerServiceDetail:function(e){return t({type:N+"/fetchCustomerServiceDetail",payload:e})},fetchSpecifyMsg:function(e){return t({type:N+"/fetchSpecifyMsg",payload:e})},fetchPersonalCount:function(){return t({type:w+"/fetchPersonalCount"})},setMessageInvalidate:function(e){return t({type:N+"/setMessageInvalidate",payload:e})},setMessageValidate:function(e){return t({type:N+"/setMessageValidate",payload:e})},setMessageHandleByRule:function(e){return t({type:N+"/setMessageHandleByRule",payload:e})}}})(t);t.propTypes={projectId:n().string.isRequired,data:n().object.isRequired,modelType:n().string,notContain:n().array.isRequired,onEditBoxOpen:n().func};const O=function(e){function n(n,e,t,a,r,s,i,l,o){return Y().createElement("div",{className:e?"msg-wrapper":"msg-wrapper not-first-msg",key:n.id},Y().createElement("div",{className:n.remarkVos&&0<n.remarkVos.length?"time-line":""},Y().createElement(q,{avatar:n.uimg,userName:n.username||"匿名用户",emotionScore:n.escore,score:n.score,time:n.ctime,msgType:n.showDetailType||n.type,flag:n.status,id:n.id,index:n.index,routing:n.routing}),Y().createElement(te,{options:["property"],data:n,contentWidth:a,detailParams:r,harmonyEvent:i,isTagClicked:l,handleTagClick:o})),n.remarkVos&&0<n.remarkVos.length&&n.remarkVos.map(function(e,t){return Y().createElement("div",{className:t===n.remarkVos.length-1?"":"time-line",key:e.id},Y().createElement(q,{avatar:e.userHeadUrl,userName:e.username||"匿名用户",time:e.ctime,msgType:e.showDetailType||e.type,alignDirection:"right"}),Y().createElement(te,{options:["property","alignRight"],data:e,contentWidth:a,detailParams:r,harmonyEvent:i,isTagClicked:l,handleTagClick:o}))}),Y().createElement(ne,{projectId:t,data:n,modelType:s,notContain:["reply"]}))}var t,a,r,s,i,l,o,c,d=e.messageType,u=e.messageList,m=e.loading,p=e.detailParams,h=e.onMoreClick,g=e.projectId,f=e.contentWidth,v=e.modelType,E=e.harmonyEvent,y=e.handleTagsClick,S=Y().useState(!0),e=S[0],C=S[1],S=Y().useState(""),N=S[0],w=S[1],S=function(e,t){N&&e===N.tagId?N&&w(""):(w({tagId:e,id:t}),y(e))};return m&&u&&0===u.length?Y().createElement(L.Z,null):d&&"QUE_ANS_TALK"===d&&e?Y().createElement("div",{className:"news_list_wrapper"},u&&u[0]&&n(u[0],!0,g,f,p,v,E,N,S),Y().createElement("div",{className:"expand-more"},Y().createElement("span",{onClick:function(){C(!1),h(p)}},"查看更多",Y().createElement("i",{className:"icon-cem_cross-page"}))),u&&u[1]&&n(u[1],!1,g,f,p,v,E,N,S)):Y().createElement("div",{className:"news_list_wrapper"},(a=g,r=f,s=p,i=v,l=E,o=N,c=S,(t=u)&&0<t.length&&t.map(function(e,t){return n(e,0===t,a,r,s,i,l,o,c)})))};function D(n,e,t,a,r,s,i,l,o,c,d){return Y().createElement("div",{className:e?"msg-wrapper":"msg-wrapper not-first-msg",key:n.id},Y().createElement("div",{className:n.remarkVos&&0<n.remarkVos.length?"time-line":""},Y().createElement(q,{avatar:n.uimg,userName:n.username||"匿名用户",userDescription:n.userDescription,userFocusCount:n.userFocusCount,userFollowerCount:n.userFollowerCount,userBlogCount:n.userBlogCount,userVerifyLevel:n.userVerifyLevel,userGender:n.userGender,emotionScore:n.escore,score:n.score,time:n.ctime,msgType:n.showDetailType||n.type,flag:n.status,id:n.id,index:n.index,routing:n.routing,isWeibo:"WEIBO"===n.messageCategory}),0===s&&i?Y().createElement(J.Fragment,null,Y().createElement(te,{options:["property"],data:n,contentWidth:a,detailParams:r,harmonyEvent:o,isTagClicked:c,handleTagClick:d}),Y().createElement("div",{className:"original-blog"},n.originName&&Y().createElement("span",{className:"original-username"},"@",n.originName),Y().createElement(te,{options:["property"],data:j()({},n,{content:n.originText,pictures:n.originPics,originSource:"",tagVos:void 0,aspectVos:void 0}),contentWidth:a,detailParams:r,harmonyEvent:o,isTagClicked:c,handleTagClick:d})),Y().createElement(X,{projectId:t,categoryId:n.categoryId,group:n.group,oid:n.oid,suboid:n.suboid,sourceId:n.sourceId})):Y().createElement(te,{options:["property","reply"],data:n,contentWidth:a,detailParams:r,harmonyEvent:o,isTagClicked:c,handleTagClick:d})),n.remarkVos&&0<n.remarkVos.length&&n.remarkVos.map(function(e,t){return Y().createElement("div",{className:t===n.remarkVos.length-1?"":"time-line",key:e.id},Y().createElement(q,{avatar:e.userHeadUrl,userName:e.username||"匿名用户",time:e.ctime,msgType:e.showDetailType||e.type,alignDirection:"right"}),Y().createElement(te,{options:["alignRight"],data:e,contentWidth:a,detailParams:r,harmonyEvent:o,isTagClicked:c,handleTagClick:d}))}),Y().createElement(ne,{projectId:t,data:n,modelType:l,notContain:e?[]:["reply"]}))}var M=function(t){function e(e){var r=t.call(this,e)||this;return r.getPageData=function(){return r.state.messageList},r.handleScroll=function(){var a=r.props.onScrollRefresh;r.timer&&clearTimeout(r.timer),r.timer=setTimeout(function(){var e=r.scrollContainer,t=e.scrollTop,n=e.offsetHeight,n=e.scrollHeight-t-n;r.setState({bottomDistance:n}),n<100&&a()},500)},r.handleOnWindowResize=function(){document.querySelector(".news_list_wrapper")&&r.setState({contentWidth:document.querySelector(".news_list_wrapper").offsetWidth})},r.handleOnMoreClick=function(e){r.props.fetchMsgDetail(e),r.scrollContainer.scrollTo({top:0,behavior:"auto"})},r.state={id:"",contentWidth:0,bottomDistance:0,messageList:[],addedMessageList:[],willBeUpdatedData:[]},r.event={},r}i()(e,t),e.getDerivedStateFromProps=function(e,t){var n=t.id,a=t.addedMessageList,r=t.willBeUpdatedData,s=t.resetTime,i=e.detailData,l=e.data,o=e.data.id,c=e.specifyData,e=e.resetTime;if(n===o&&a&&i&&JSON.stringify(a)!==JSON.stringify(i))return{messageList:l.dataLevel&&"NEWS"===l.dataLevel&&2===t.messageList.length?i:t.messageList.concat(i),addedMessageList:JSON.parse(JSON.stringify(i))};if(r&&c&&JSON.stringify(r)!==JSON.stringify(c)){for(var d=JSON.parse(JSON.stringify(t.messageList)),u=0;u<d.length;u++)for(var m=0;m<c.length;m++)d[u]&&c[m]&&d[u].id===c[m].id&&(d[u]=c[m]);return{messageList:d,willBeUpdatedData:c}}return n!==o?{id:o,bottomDistance:0,messageList:[],addedMessageList:[],willBeUpdatedData:[]}:s<e?{resetTime:e,bottomDistance:0,messageList:[],addedMessageList:[],willBeUpdatedData:[]}:null};var n=e.prototype;return n.componentDidMount=function(){this.handleOnWindowResize(),window.addEventListener("resize",this.handleOnWindowResize),this.scrollContainer=document.querySelector(".inbox_wrap .msg_detail_wrap"),this.scrollContainer&&this.scrollContainer.addEventListener("scroll",this.handleScroll)},n.componentWillUnmount=function(){this.scrollContainer&&this.scrollContainer.removeEventListener("resize",this.handleScroll)},n.render=function(){var e=this.props,t=e.data,n=e.loading,a=e.projectId,r=e.detailParams,s=e.modelType,i=e.harmonyEvent,l=e.handleTagsClick,o=this.state,e=o.messageList,o=o.contentWidth;return Y().createElement(O,{contentWidth:o,detailParams:r,modelType:s,projectId:a,messageList:e,loading:n,messageType:t.dataLevel,harmonyEvent:i,onMoreClick:this.handleOnMoreClick,handleTagsClick:l})},e}(Y().PureComponent);const x=function(e){var n,a,r,s,i,l,o,t=e.messageType,c=e.messageList,d=e.loading,u=e.projectId,m=e.contentWidth,p=e.detailParams,h=e.harmonyEvent,g=e.onMoreClick,f=e.modelType,v=e.handleTagsClick,E=Y().useState(!0),e=E[0],y=E[1],E=Y().useState(""),S=E[0],C=E[1],E=function(e,t){S&&e===S.tagId?S&&C(""):(C({tagId:e,id:t}),v(e))};return d&&c&&0===c.length?Y().createElement(L.Z,null):e&&t&&"WEIBO_TALK"===t||e&&t&&"COMMENT_REPLY"===t?Y().createElement("div",{className:"msg-list-wrapper"},c&&c[0]&&D(c[0],!0,u,m,p,0,c[0].dataLevel&&"WEIBO_REPORT"===c[0].dataLevel,f,h,S,E),Y().createElement("div",{className:"expand-more"},Y().createElement("span",{onClick:function(){y(!1),g(p)}},"查看更多",Y().createElement("i",{className:"icon-cem_cross-page"}))),c&&c[1]&&D(c[1],!1,u,m,p,1,c[1].dataLevel&&"WEIBO_REPORT"===c[1].dataLevel,f,h,S,E)):Y().createElement("div",{className:"msg-list-wrapper"},(n=u,a=m,r=p,s=f,i=h,l=S,o=E,(c=c)&&0<c.length&&c.map(function(e,t){return D(e,0===t,n,a,r,t,e.dataLevel&&"WEIBO_REPORT"===e.dataLevel,s,i,l,o)})))};var R=function(t){function e(e){var r=t.call(this,e)||this;return r.getPageData=function(){return r.state.messageList},r.handleScroll=function(){var a=r.props.onScrollRefresh;r.timer&&clearTimeout(r.timer),r.timer=setTimeout(function(){var e=r.scrollContainer,t=e.scrollTop,n=e.offsetHeight,n=e.scrollHeight-t-n;r.setState({bottomDistance:n}),n<100&&a()},500)},r.handleOnWindowResize=function(){document.querySelector(".msg-list-wrapper")&&r.setState({contentWidth:document.querySelector(".msg-list-wrapper").offsetWidth})},r.handleOnMoreClick=function(e){r.setState({messageList:[]},function(){r.props.resetIndex({pageIndex:0}),r.props.fetchMsgDetail(e),r.scrollContainer.scrollTo({top:0,behavior:"auto"})})},r.state={id:"",contentWidth:0,bottomDistance:0,resetTime:0,messageList:[],addedMessageList:[],willBeUpdatedData:[]},r}i()(e,t);var n=e.prototype;return n.componentDidMount=function(){this.handleOnWindowResize(),window.addEventListener("resize",this.handleOnWindowResize),this.scrollContainer=document.querySelector(".inbox_wrap .msg_detail_wrap"),this.scrollContainer&&this.scrollContainer.addEventListener("scroll",this.handleScroll)},e.getDerivedStateFromProps=function(e,t){var n=t.id,a=t.addedMessageList,r=t.willBeUpdatedData,s=t.resetTime,i=e.detailData,l=e.data,o=e.data.id,c=e.specifyData,e=e.resetTime;if(n===o&&a&&i&&JSON.stringify(a)!==JSON.stringify(i))return{messageList:l.dataLevel&&"WEIBO_TALK"===l.dataLevel&&2===t.messageList.length?i:t.messageList.concat(i),addedMessageList:JSON.parse(JSON.stringify(i))};if(r&&c&&JSON.stringify(r)!==JSON.stringify(c)){for(var d=JSON.parse(JSON.stringify(t.messageList)),u=0;u<d.length;u++)for(var m=0;m<c.length;m++)d[u]&&c[m]&&d[u].id===c[m].id&&(d[u]=c[m]);return{messageList:d,willBeUpdatedData:c}}return n!==o?{id:o,bottomDistance:0,messageList:[],addedMessageList:[],willBeUpdatedData:[]}:s<e?{resetTime:e,bottomDistance:0,messageList:[],addedMessageList:[],willBeUpdatedData:[]}:null},n.componentWillUnmount=function(){this.scrollContainer.removeEventListener("resize",this.handleScroll)},n.render=function(){var e=this.props,t=e.data,n=e.loading,a=e.projectId,r=e.detailParams,s=e.modelType,i=e.harmonyEvent,l=e.handleTagsClick,o=this.state,e=o.messageList,o=o.contentWidth;return Y().createElement(x,{contentWidth:o,detailParams:r,projectId:a,messageList:e,loading:n,modelType:s,messageType:t.dataLevel,harmonyEvent:i,onMoreClick:this.handleOnMoreClick,handleTagsClick:l})},e}(Y().PureComponent),t=U(23279),V=U.n(t),ae=U(8201),re=U(70715),se=function(e){function t(){return e.apply(this,arguments)||this}return i()(t,e),t.prototype.render=function(){var e=this.props,t=e.images,n=e.isShow,a=e.startIndex,e=e.closeDialog;return Y().createElement(G.Dialog,{visible:n,className:"img-preview-dialog",onCancel:e,lockScroll:!1},Y().createElement(G.Dialog.Body,null,Y().createElement(c.Z,{items:t,startIndex:a,showThumbnails:!1})))},t}(Y().Component);se.propTypes={images:n().array.isRequired,isShow:n().bool.isRequired,closeDialog:n().func.isRequired,startIndex:n().number.isRequired};const P=function(e){function t(e){if(e&&"UL"!==e.nodeName)return"LI"===e.nodeName?e:t(e.parentNode)}var n=e.data,a=e.detailParams,r=e.detailProduct,l=e.detailAspect,o=e.detailTopic,s=e.modelType,i=e.contentWidth,c=e.formatContent,d=e.handleScroll,u=e.handleScrollToOrBottom,m=e.getScrollBtnText,p=e.highLightWordList,h=e.harmonyEvent,g=e.serviceCustomerType,f=e.filterValue,v=(0,J.useState)(!1),E=v[0],e=v[1],v=(0,J.useState)(""),y=v[0],S=v[1],v=(0,J.useState)(""),C=v[0],N=v[1],v=(0,J.useState)(""),w=v[0],_=v[1],v=(0,J.useState)(""),k=v[0],T=v[1],L=["咨询/求助","赞扬","不满/辱骂"],v=(0,J.useState)(""),I=v[0],b=v[1],v=(0,J.useState)(!0),O=v[0],D=v[1],v=(0,J.useState)(!1),M=v[0],x=v[1],v=(0,J.useState)(0),R=v[0],V=v[1],P=(0,J.useRef)(null);(0,J.useEffect)(function(){var e;y&&(e=document.getElementById(y),(e=t(e))&&(P.current.scrollTop=e.offsetTop))},[y]),(0,J.useEffect)(function(){var e;w&&(e=document.getElementById(w),(e=t(e))&&(P.current.scrollTop=e.offsetTop))},[w]),(0,J.useEffect)(function(){var t;w&&0<(t=document.getElementsByClassName("topic-high-light-words")).length&&function(){for(var e=0;e<=t.length;e++)t[e]&&t[e].parentNode&&[t[e].parentNode,t[e].parentNode.parentNode,t[e].parentNode.parentNode.parentNode].some(function(e){return!!e.className.includes("msg")&&(function(e){switch(w){case L[0]:e.classList.add("ask");break;case L[1]:e.classList.add("positive");break;case L[2]:e.classList.add("negative")}}(e),!0)})}()},[w]);var F=[];function W(e,t,n){var a;"aspect"===n&&(S(y===e?"":e),N(t),b(y===e?k:t)),"topic"===n&&(0<(a=document.getElementsByClassName("topic-high-light-words")).length&&function(){for(var e=0;e<=a.length;e++)a[e]&&a[e].parentNode&&[a[e].parentNode,a[e].parentNode.parentNode,a[e].parentNode.parentNode.parentNode].some(function(e){return!!e.className.includes("msg")&&(function(e){switch(w){case L[0]:e.classList.remove("ask");break;case L[1]:e.classList.remove("positive");break;case L[2]:e.classList.remove("negative")}}(e),!0)})}(),_(w===e?"":e),T(t),b(w===e?C:t))}function A(e,r){var n=e.type,t=e.imgUrl;if(t)return'<div style="font-size: 0; margin: 0 -3px 0 -5px; cursor: pointer;">\n        <img class="message-service-images" src="'+t+'" style="max-width: 200px; max-height: 200px"/>\n      </div>';var a,s=c(e.content)||"",e=p,i=[];return f&&f.headerFilterParamsNew.forEach(function(e){"CUSTOMER_SERVICE"===e.id&&e.values.length&&e.values.forEach(function(e){"WAITER_ROLE"===e.id&&(i=e.values)})}),e&&e.forEach(function(e){var t=e.includes("*")?e.replaceAll("*",""):e,e=new RegExp(t,"ig");g&&!i.includes(n)&&!["CUSTOMER","SERVER"].includes(g)||(s=s.replace(e,'<span style="background: #D2CE77">'+t+"</span>"))}),!y||"CUSTOMER"!==n||(a=l.find(function(e){return e.aspectId===y}))&&(e=e.concat(a.aspectList),a.aspectList&&a.aspectList.forEach(function(e){var t=e.highLightWord.includes("*")?e.highLightWord.replaceAll("*",""):e.highLightWord,e=new RegExp(t,"ig");s=s.replace(e,'<span id="'+y+'" index="'+r+'" style="background: '+C+'; color: #f0f2f5;">'+t+"</span>")})),!w||"CUSTOMER"!==n||(a=o.find(function(e){return e.aspect1===w}))&&(e=e.concat(a.aspectList),a.aspectList&&a.aspectList.forEach(function(e){var t=e.highLightWord.includes("*")?e.highLightWord.replaceAll("*",""):e.highLightWord,n=new RegExp(t,"ig"),a=k;I===k||(e=l.find(function(e){return e.aspectId===y}))&&e.aspectList&&e.aspectList.forEach(function(e){(e.highLightWord.includes("*")?e.highLightWord.replaceAll("*",""):e.highLightWord)===t&&(a=I)}),s=s.replace(n,'<span id="'+w+'" index="'+r+'" class="topic-high-light-words" style="background: '+a+'; color: #f0f2f5;">'+t+"</span>")})),s}l&&l.forEach(function(e){e.aspect1&&!F.includes(e.aspect1)&&F.push(e.aspect1)});var B,H,v=(0,J.useMemo)(function(){return n&&n.contentList&&n.contentList},[n]);return Y().createElement(ae.Z,{data:n,className:"detail_part"},n&&Y().createElement(Y().Fragment,null,Y().createElement("div",{className:"detail_header"},Y().createElement("div",{className:"chat_title"},Y().createElement("div",{className:"shop_info"},Y().createElement("img",{className:"logo",src:(0,z.Pk)($.z[n.sourceName]),alt:n.sourceName}),Y().createElement("h4",{className:"shop_name"},n.shopName)),(r&&0<r.length||l&&0<l.length||o&&0<o.length)&&Y().createElement("div",null,Y().createElement(K.Z,{overlay:O?"收起":"展开",placement:"top",mouseEnterDelay:.6},Y().createElement("i",{className:(O?"icon-cem_reduce":"icon-cem_enlarge")+" enlarge",onClick:function(){return D(!O)}})))),O&&r&&0<r.length&&Y().createElement("div",{className:"commodity"},Y().createElement("div",{className:"name"},"商品"),Y().createElement("div",{className:"content"},r.filter(function(e){return e.name===n.shopName}).map(function(e){return Y().createElement(K.Z,{key:e.name,mouseEnterDelay:.6,overlay:Y().createElement("div",{style:{lineHeight:"26px"}},Y().createElement("span",{style:{color:"#262626",fontWeight:"bold"}},"会话提及商品"),Y().createElement("br",null),"所属品牌：",e.brand),placement:"top"},Y().createElement("span",null,e.name))}),r.some(function(e){return e.name===n.shopName})&&r.some(function(e){return e.name!==n.shopName})&&Y().createElement("span",{className:"line"}),r.filter(function(e){return e.name!==n.shopName}).map(function(e){return Y().createElement(K.Z,{key:e.name,mouseEnterDelay:.6,overlay:Y().createElement("div",{style:{lineHeight:"26px"}},Y().createElement("span",{style:{color:"#262626",fontWeight:"bold"}},"会话提及商品"),Y().createElement("br",null),"所属品牌：",e.brand),placement:"top"},Y().createElement("span",{className:"compare_product"},e.name,Y().createElement("i",{className:"separator"})))}))),O&&l&&0<l.length&&Y().createElement("div",{className:"concern"},Y().createElement("div",{className:"name"},"关注点"),Y().createElement("div",{className:"content"},l.map(function(e){var t=re.fX[F.indexOf(e.aspect1)%20],n=e.aspectId===y;return Y().createElement(K.Z,{key:e.aspect2,mouseEnterDelay:.6,overlay:Y().createElement("div",{style:{lineHeight:"26px",color:"#8c8c8c"}},Y().createElement("span",null,"一级：",Y().createElement("span",{style:{color:"#262626",fontWeight:"bold"}},e.aspect1)),Y().createElement("br",null),"二级：",Y().createElement("span",{style:{color:"#262626",fontWeight:"bold"}},e.aspect2)),placement:"top"},Y().createElement("span",{style:{borderColor:t,background:n?t:"#fff",color:n?"#f7f8fa":"#262626"},onClick:function(){return W(e.aspectId,t,"aspect")}},e.aspect2))}))),O&&o&&0<o.length&&Y().createElement("div",{className:"concern"},Y().createElement("div",{className:"name"},"话题分类"),Y().createElement("div",{className:"content"},L.map(function(t,e){var n=re.TJ[e],e=t===w;return Y().createElement("span",{key:t,style:{borderColor:n,background:e?n:"#fff",color:e?"#f7f8fa":"#262626",display:o.find(function(e){return e.aspect1===t})?"inline-block":"none"},onClick:function(){return W(t,n,"topic")}},t)})))),Y().createElement("div",{className:"card",style:{paddingBottom:E?76:0},onScroll:d,ref:P},Y().createElement("div",{className:"date"},Z()(n.startTime).format("YYYY-MM-DD")),Y().createElement("div",{className:"content_yy"},Y().createElement("ul",null,v&&v.map(function(e,t){return"CUSTOMER"===e.type?Y().createElement("li",{key:e.id,id:t},Y().createElement("div",{className:"left"},Y().createElement("div",{className:"icon"},Y().createElement("img",{src:U(57471),alt:"头像"})),Y().createElement("div",{className:"users"},Y().createElement("div",{className:"user_left"},Y().createElement("span",{className:"user_name_left"},e.name),Y().createElement("span",{className:"user_time"},"("+Z()(e.ctime).format("HH:mm:ss")+")")),Y().createElement("p",{className:"msg msg_left",dangerouslySetInnerHTML:{__html:A(e,t)}})))):Y().createElement("li",{key:e.id,id:t},Y().createElement("div",{className:"right"},Y().createElement("div",{className:"users"},Y().createElement("div",{className:"user_right"},Y().createElement("span",{className:"user_time"},"("+Z()(e.ctime).format("HH:mm:ss")+")"),Y().createElement("span",{className:"user_name_right"},e.name)),Y().createElement("p",{className:"msg msg_right",dangerouslySetInnerHTML:{__html:A(e,t)}})),Y().createElement("div",{className:"icon"},Y().createElement("img",{src:U(89125),alt:"头像"}),Y().createElement("div",{className:"waiter_type"},e.saleType))))})),v&&(B=document.getElementsByClassName("message-service-images"),H=[],0<B.length&&(H=Array.from(B).map(function(e,t){return e.parentNode.onclick=function(){x(!0),V(t)},{thumbnail:e.currentSrc,original:e.currentSrc}})),Y().createElement(se,{startIndex:R,images:H,closeDialog:function(){x(!1)},isShow:M}))),Y().createElement("div",{className:"date date_btm"},"- 已到底部 -"),n.remark&&0<n.remark.length&&Y().createElement("div",{className:"line"}),n.remark&&n.remark.map(function(e){return Y().createElement("div",{className:"remark_wrap",key:e.id},Y().createElement(q,{avatar:e.userHeadUrl,userName:e.username||"匿名用户",time:Z()(e.ctime).format("YYYY-MM-DD HH:mm:ss"),msgType:e.type,alignDirection:"right"}),Y().createElement(te,{data:j()({},e,{pictures:"",showDetailType:"备",originSource:"",repostsCount:null,commentCount:null,attitudesCount:null,categoryId:"",oid:"",suboid:"",sourceId:"",sourceName:"",score:"",tagsVos:null}),contentWidth:i,options:["alignRight"],detailParams:a,harmonyEvent:h,highLightWordList:p}))})),Y().createElement(K.Z,{overlay:m,placement:"left",mouseEnterDelay:.6},Y().createElement("div",{className:"up_down_btn",onClick:u},Y().createElement("i",{className:"scroll_icon_down"}))),Y().createElement(ne,{data:j()({sourceName:"",mid:n.mid,status:"",url:"",showDetailType:"",escore:"",score:""},n,{messageId:n.id,index:a.projectId,connectionId:"",routing:a.projectId}),projectId:a.projectId,modelType:s,notContain:["source"],onEditBoxOpen:e})))};function F(e,t,n,a,r,s,i,l,o){var c=void 0===e.userHeadUrl?e.uimg:e.userHeadUrl;return Y().createElement(Y().Fragment,null,Y().createElement(q,{avatar:c,userName:e.username||"匿名用户",emotionScore:e.escore,score:e.score,time:e.ctime,msgType:e.showDetailType||e.type,id:e.id,index:e.index,routing:e.routing,alignDirection:a,type:e.type}),Y().createElement(te,{options:"right"===a?["alignRight"]:[],data:e,contentWidth:t,detailParams:n,harmonyEvent:r,isTagClicked:s,handleTagClick:l,onFeedbackClick:o,fetchedTag:i}))}var W=function(t){function e(e){var l=t.call(this,e)||this;return l._handleScroll=function(e){var t=e.target,n=t.scrollHeight,e=t.scrollTop,t=t.clientHeight,a=document.getElementsByClassName("up_down_btn")[0],r=a.querySelector("i").classList,s="icon-zhiding",i="icon-zhidi";e+t===n?(a.style.display="none",setTimeout(function(){a.style.display="block",r.contains(s)||(l.upOrDown="up",r.add(s),r.remove(i))},150)):0===e?a.style.display="none":setTimeout(function(){a.style.display="block",r.contains(i)||(l.upOrDown="down",r.add(i),r.remove(s))})},l.handleScroll=function(e){e.persist(),l._handleScroll(e)},l.getScrollBtnText=function(){return"up"===l.upOrDown?"回到顶部":"前往底部"},l.handleScrollToOrBottom=function(e){var t=document.getElementsByClassName("card")[0],n=document.getElementsByClassName("scroll_icon_down")[0],a=t.scrollHeight,r=t.clientHeight;t.scrollTop=n.classList.contains("icon-zhiding")?0:a-r},l.handleFormatContent=function(e){var t=l.escape2Html(l.escape2Html(e)),e=document.createElement("div");return e.innerHTML=t,e.innerText},l.escape2Html=function(e){var n={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return e&&e.replace(/&(lt|gt|nbsp|amp|quot);/gi,function(e,t){return n[t]})},l._handleWindowResize=V()(function(){l.setState({contentWidth:document.getElementsByClassName("detail_part")[0].offsetWidth})},150),l.state={contentWidth:0,data:void 0,dataList:[]},l.event={formatContent:l.handleFormatContent,handleScroll:l.handleScroll,handleScrollToOrBottom:l.handleScrollToOrBottom,getScrollBtnText:l.getScrollBtnText},l.upOrDown="",l}i()(e,t);var n=e.prototype;return n.scrollToBottom=function(){var e,t=document.getElementsByClassName("section_content")[0];!t||(e=t.getElementsByClassName("card")[0])&&(t=e.scrollHeight-e.clientHeight,e.scrollTop=0<t?t:0)},n.componentDidMount=function(){this._handleWindowResize(),window.addEventListener("resize",this._handleWindowResize)},n.componentDidUpdate=function(e,t){var n=e.specifyData,a=e.detailData,r=this.props,e=r.specifyData,r=r.detailData;JSON.stringify(a)!==JSON.stringify(r)&&this.setState({data:r}),JSON.stringify(n)!==JSON.stringify(e)&&this.setState({data:e})},n.componentWillUnmount=function(){window.removeEventListener("resize",this._handleWindowResize)},n.render=function(){return Y().createElement(P,j()({},this.props,this.state,this.event))},e}(Y().PureComponent),A=U(66746);const B=function(e){function t(e,t){u&&e===u.tagId?u&&m(""):(m({tagId:e,id:t}),l(e))}var n=e.data,a=e.detailParams,r=e.modelType,s=e.contentWidth,i=e.harmonyEvent,l=e.handleTagsClick,o=e.fetchedTag,c=e.getDrawerRef,d=e.onFeedbackClick,e=Y().useState(""),u=e[0],m=e[1];return Y().createElement(ae.Z,{data:n,className:"yt_message_template_ecommerce"},n&&n instanceof Array&&0<n.length&&Y().createElement(Y().Fragment,null,Y().createElement("div",{className:"message_detail"},Y().createElement("div",{className:"message_title"},Y().createElement("img",{src:(0,z.Pk)($.z[n[0].sourceName]),alt:n[0].sourceName}),Y().createElement("span",null,n[0].title)),Y().createElement("div",{className:"messge_content"},n[0].connectionName),!!n[0].detail&&3===Number(n[0].sourceId)&&Y().createElement("div",null,Y().createElement("div",{className:"message_tail"},n[0].detail,!!n[0].oids&&Y().createElement("span",{className:"message_tail_number"},"订单编号:",Y().createElement("span",{className:"copyValue",onClick:function(){return(0,Q.zp)("copyValue")}},n[0].oids),Y().createElement("i",{className:"icon-fuzhi",onClick:function(){return(0,Q.zp)("copyValue")},style:{color:"#7262FD",cursor:"pointer"}}))))),Y().createElement("div",{className:"message_commond"},n.map(function(e){return Y().createElement("div",{className:"官"===e.showDetailType?"customer":"",key:e.id},F(e,s,a,["备","回"].includes(e.showDetailType)?"right":"left",i,u,o,t,d))}),n[0].remarkVos&&n[0].remarkVos.map(function(e){return Y().createElement("div",{key:e.id},F(e,s,a,"right",i,u,o,t,d))})),Y().createElement(ne,{notContain:[],projectId:a.projectId,data:n[0],modelType:r}),Y().createElement(A.Z,{ref:c})))};function H(n,e,t,a,r,s,i,l,o){return Y().createElement("div",{className:e?"msg-wrapper":"msg-wrapper not-first-msg",key:n.id},Y().createElement("div",{className:n.remarkVos&&0<n.remarkVos.length?"time-line":""},Y().createElement(q,{avatar:n.uimg,userName:n.username||"匿名用户",emotionScore:n.escore,score:n.score,time:n.ctime,msgType:n.showDetailType||n.type,flag:n.status,id:n.id,index:n.index,routing:n.routing}),Y().createElement(te,{options:["reply","property"],data:n,contentWidth:a,detailParams:r,harmonyEvent:i,isTagClicked:l,handleTagClick:o})),n.remarkVos&&0<n.remarkVos.length&&n.remarkVos.map(function(e,t){return Y().createElement("div",{className:t===n.remarkVos.length-1?"":"time-line",key:e.id},Y().createElement(q,{avatar:e.userHeadUrl,userName:e.username||"匿名用户",time:e.ctime,msgType:e.showDetailType||e.type,alignDirection:"right"}),Y().createElement(te,{options:["alignRight"],data:e,contentWidth:a,detailParams:r,harmonyEvent:i,isTagClicked:l,handleTagClick:o}))}),Y().createElement(ne,{projectId:t,data:n,modelType:s,notContain:e?[]:["reply"]}))}var ie=U(87219),le=function(n){function e(e){var t=n.call(this,e)||this;return t.getPageData=function(){return t.state.data},t._drawCommentLine=function(){var e=document.getElementsByClassName("message_commond")[0],t=document.getElementsByClassName("msg-type"),n=t.length;if(1<n){var a=e.getBoundingClientRect(),r=document.getElementById("lineCanvas");r.width=18,r.height=e.offsetHeight-32;var s=r.getContext("2d");s.beginPath();for(var i=0;i<n-1;i++)s.moveTo(9,2+t[i].getBoundingClientRect().y-a.y),s.lineTo(9,2+t[i+1].getBoundingClientRect().y-a.y-18);s.strokeStyle="#DFE3E8",s.lineWidth=1,s.stroke()}},t._handleWindowResize=function(){t.setState({contentWidth:document.getElementsByClassName("yt_section_component_wrapper")[0].offsetWidth})},t.state={contentWidth:0,data:void 0},t.event={},t}i()(e,n);var t=e.prototype;return t.componentDidMount=function(){this._handleWindowResize(),window.addEventListener("resize",this._handleWindowResize)},t.componentDidUpdate=function(e,t){var n=e.specifyData,a=e.detailData,r=this.props,e=r.specifyData,s=r.detailData;JSON.stringify(a)!==JSON.stringify(s)&&this.setState({data:s}),JSON.stringify(n)!==JSON.stringify(e)&&this.setState({data:(0,ie.ZP)(e,function(e){s&&s.forEach(function(t){-1===e.findIndex(function(e){return e.id===t.id})&&e.push(t)})})})},t.componentWillUnmount=function(){window.removeEventListener("resize",this._handleWindowResize)},t.render=function(){return Y().createElement(B,j()({},this.props,this.state,this.event))},e}(Y().PureComponent);const oe=function(e){var n,a,r,s,i,l,o,t=e.messageType,c=e.messageList,d=e.loading,u=e.projectId,m=e.contentWidth,p=e.detailParams,h=e.onMoreClick,g=e.modelType,f=e.harmonyEvent,v=e.handleTagsClick,E=Y().useState(!0),e=E[0],y=E[1],E=Y().useState(""),S=E[0],C=E[1],E=function(e,t){S&&e===S.tagId&&t===S.id?S&&C(""):(C({tagId:e,id:t}),v(e))};return d&&c&&0===c.length?Y().createElement(L.Z,null):t&&"COMMENT_REPLY"===t&&e?Y().createElement("div",{className:"msg-list-wrapper"},c&&c[0]&&H(c[0],!0,u,m,p,g,f,S,E),Y().createElement("div",{className:"expand-more"},Y().createElement("span",{onClick:function(){y(!1),h(p)}},"查看更多",Y().createElement("i",{className:"icon-cem_cross-page"}))),c&&c[1]&&H(c[1],!1,u,m,p,g,f,S,E)):Y().createElement("div",{className:"msg-list-wrapper"},(n=u,a=m,r=p,s=g,i=f,l=S,o=E,(c=c)&&0<c.length&&c.map(function(e,t){return H(e,0===t,n,a,r,s,i,l,o)})))};var ce=function(t){function e(e){var r=t.call(this,e)||this;return r.getPageData=function(){return r.state.messageList},r.handleScroll=function(){var a=r.props.onScrollRefresh;r.timer&&clearTimeout(r.timer),r.timer=setTimeout(function(){var e=r.scrollContainer,t=e.scrollTop,n=e.offsetHeight,n=e.scrollHeight-t-n;r.setState({bottomDistance:n}),n<100&&a()},500)},r.handleOnWindowResize=function(){document.querySelector(".msg-list-wrapper")&&r.setState({contentWidth:document.querySelector(".msg-list-wrapper").offsetWidth})},r.handleOnMoreClick=function(e){r.setState({messageList:[]},function(){r.props.resetIndex({pageIndex:0}),r.props.fetchMsgDetail(e),r.scrollContainer.scrollTo({top:0,behavior:"auto"})})},r.state={id:"",resetTime:0,contentWidth:0,bottomDistance:0,messageList:[],addedMessageList:[],willBeUpdatedData:[]},r}i()(e,t);var n=e.prototype;return n.componentDidMount=function(){this.handleOnWindowResize(),window.addEventListener("resize",this.handleOnWindowResize),this.scrollContainer=document.querySelector(".inbox_wrap .msg_detail_wrap"),this.scrollContainer&&this.scrollContainer.addEventListener("scroll",this.handleScroll)},e.getDerivedStateFromProps=function(e,t){var n=t.id,a=t.addedMessageList,r=t.willBeUpdatedData,s=t.resetTime,i=e.detailData,l=e.data,o=e.data.id,c=e.specifyData,e=e.resetTime;if(n===o&&a&&i&&JSON.stringify(a)!==JSON.stringify(i))return{messageList:l.dataLevel&&"COMMENT_REPLY"===l.dataLevel&&2===t.messageList.length?i:t.messageList.concat(i),addedMessageList:JSON.parse(JSON.stringify(i))};if(r&&c&&JSON.stringify(r)!==JSON.stringify(c)){for(var d=JSON.parse(JSON.stringify(t.messageList)),u=0;u<d.length;u++)for(var m=0;m<c.length;m++)d[u]&&c[m]&&d[u].id===c[m].id&&(d[u]=c[m]);return{messageList:d,willBeUpdatedData:c}}return n!==o?{id:o,bottomDistance:0,messageList:[],addedMessageList:[],willBeUpdatedData:[]}:s<e?{resetTime:e,bottomDistance:0,messageList:[],addedMessageList:[],willBeUpdatedData:[]}:null},n.componentWillUnmount=function(){this.scrollContainer&&this.scrollContainer.removeEventListener("resize",this.handleScroll)},n.render=function(){var e=this.props,t=e.data,n=e.loading,a=e.projectId,r=e.detailParams,s=e.modelType,i=e.harmonyEvent,l=e.handleTagsClick,o=this.state,e=o.messageList,o=o.contentWidth;return Y().createElement(oe,{contentWidth:o,detailParams:r,modelType:s,projectId:a,messageList:e,loading:n,messageType:t.dataLevel,harmonyEvent:i,onMoreClick:this.handleOnMoreClick,handleTagsClick:l})},e}(Y().PureComponent);const de=function(e){var t=e.surveryData,a=e.highLightWordList,r=e.harmonyEvent,n=function(e){return Y().createElement("div",{className:"radio_content common_card_style"},Y().createElement("div",{className:"title"},e.title),Y().createElement(G.Radio.Group,{value:e.choosed},e.opinion&&e.opinion.map(function(e,t){return Y().createElement(G.Radio,{value:e,key:t,disabled:!0},e)})))},s=function(e){return Y().createElement("div",{className:"checkbox_content common_card_style"},Y().createElement("div",{className:"title"},e.title),Y().createElement(G.Checkbox.Group,{value:e.choosed},e.opinion&&e.opinion.map(function(e,t){return Y().createElement(G.Checkbox,{key:t,label:e,disabled:!0})})))},i=function(e){if("USER_INFO"!==e.type)return Y().createElement("div",{className:"single_text common_card_style"},Y().createElement("div",{className:"title"},e.title),Y().createElement("div",{className:"single_text_reason"},Y().createElement("span",{dangerouslySetInnerHTML:{__html:r(e.answer||"",a)}})));var t=JSON.parse(e.answer)||"";return Y().createElement("div",{className:"single_text common_card_style"},Y().createElement("div",{className:"title"},e.title),Y().createElement("div",{className:"single_text_reason"},Y().createElement("p",{dangerouslySetInnerHTML:{__html:r(t.id||"",a)}}),Y().createElement("p",{dangerouslySetInnerHTML:{__html:r(t.name||"",a)}}),Y().createElement("p",{dangerouslySetInnerHTML:{__html:r(t.value||"",a)}})))},l=function(n){return Y().createElement("div",{className:"nps_score_content common_card_style"},Y().createElement("div",{className:"content"},Y().createElement("div",{className:"title"},n.title),Y().createElement("div",{className:"score"},Y().createElement("ul",null,new Array(11).fill(0).map(function(e,t){return Y().createElement("li",{className:parseInt(n.answer)===t?"sel":"",key:t},t)})),Y().createElement("p",null,Y().createElement("span",{dangerouslySetInnerHTML:{__html:r("0：不可能",a)}}),Y().createElement("span",{dangerouslySetInnerHTML:{__html:r("10：极有可能",a)}})))))},o=function(e){return Y().createElement("div",{className:"rate_content common_card_style"},Y().createElement("div",{className:"rate_content_tips"},Y().createElement("div",{className:"title",dangerouslySetInnerHTML:{__html:r(e.title||"",a)}}),Y().createElement("div",{className:"rate_box"},Y().createElement(G.Rate,{allowHalf:!0,disabled:!0,value:e.answer}),Y().createElement("div",{className:"rate_score"},Y().createElement("span",{dangerouslySetInnerHTML:{__html:r("很不满意",a)}}),Y().createElement("span",{dangerouslySetInnerHTML:{__html:r("一般",a)}}),Y().createElement("span",{dangerouslySetInnerHTML:{__html:r("很满意",a)}})))))};return Y().createElement("div",{className:"result_card"},t.map(function(e){return Y().createElement(Y().Fragment,{key:e.id},function(e){switch(e.type){case"SINGLE_CHOICE":return n(e);case"TEXT":case"TEXTAREA":case"USER_INFO":case"PHONE":case"NAME":case"EMAIL":case"SATISFACTION_REASON":case"NPS_REASON":case"SEX":return i(e);case"MULTIPLE_CHOICE":return s(e);case"NPS_SCORE":return l(e);case"SATISFACTION":return o(e)}}(e))}))},ue=function(a){function e(){for(var s,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(s=a.call.apply(a,[this].concat(t))||this)._drawCommentLine=function(){var e=s.contentRef.getElementsByClassName("msg-type"),t=e.length;if(1<t){var n=s.contentRef.getBoundingClientRect();s.canvasRef.setAttribute("width","18px"),s.canvasRef.setAttribute("height",s.contentRef.offsetHeight-32+"px");var a=s.canvasRef.getContext("2d");a.beginPath();for(var r=1;r<t-1;r++)a.moveTo(9,2+e[r].getBoundingClientRect().y-n.y),a.lineTo(9,2+e[r+1].getBoundingClientRect().y-n.y-18);a.strokeStyle="#DFE3E8",a.lineWidth=1,a.stroke()}},s}i()(e,a);var t=e.prototype;return t.componentDidUpdate=function(){this._drawCommentLine()},t.render=function(){var t=this,e=this.props,n=e.obj,a=e.detailParams,r=e.contentWidth,s=e.modelType,i=e.surveryData,l=e.highLightWordList,o=e.harmonyEvent;return Y().createElement("div",{className:"NPs_content",ref:function(e){return t.contentRef=e}},Y().createElement(q,{avatar:n.uimg,userName:n.username||"匿名用户",time:n.ctime,msgType:"卷",id:a.id,index:a.index,routing:n.routing}),Y().createElement(te,{data:j()({},n,{showDetailType:"",pictures:"",originSource:"",repostsCount:null,commentCount:null,attitudesCount:null,categoryId:"",oid:"",suboid:"",sourceId:"",sourceName:""}),options:[],detailParams:a,contentWidth:r,harmonyEvent:o}),Y().createElement(de,{surveryData:i,highLightWordList:l,harmonyEvent:o}),n.remarkVos&&n.remarkVos.map(function(e){return Y().createElement("div",{key:e.id},Y().createElement(q,{avatar:e.userHeadUrl,userName:e.username||"匿名用户",time:e.ctime,msgType:e.showDetailType||e.type,alignDirection:"right"}),Y().createElement(te,{data:j()({},e,{pictures:"",showDetailType:"备",originSource:"",repostsCount:null,commentCount:null,attitudesCount:null,categoryId:"",oid:"",suboid:"",sourceId:"",sourceName:"",score:"",tagsVos:null}),contentWidth:r,options:["alignRight"],detailParams:a,harmonyEvent:o}))}),Y().createElement("canvas",{id:"lineCanvas",ref:function(e){return t.canvasRef=e}}),Y().createElement(ne,{projectId:a.index,data:j()({},n,{connectionId:a.group,sourceName:"",mid:n.mid,url:"",escore:"",showDetailType:"",index:a.index}),modelType:s,notContain:["source"]}))},e}(Y().Component);const me=function(e){var t=e.detailData,n=e.dataList,a=e.detailParams,r=e.contentWidth,s=e.modelType,i=e.highLightWordList,e=e.harmonyEvent,t=0<n.length||("string"==typeof t?t:void 0);return Y().createElement(ae.Z,{data:t,className:"detail_part_yy"},t&&Y().createElement(Y().Fragment,null,Y().createElement("div",{className:"survey_wrap"},Y().createElement("div",{className:"card_yy"},Y().createElement("ul",{id:"inboxListWrap"},Y().createElement("li",{className:"card_wrap"},Y().createElement(ue,{obj:n[0],detailParams:a,contentWidth:r,modelType:s,surveryData:n,highLightWordList:i,harmonyEvent:e})))))))};function pe(n,e,t,a,r,s,i,l,o){return Y().createElement("div",{className:e?"msg-wrapper":"msg-wrapper not-first-msg",key:n.id},Y().createElement("div",{className:n.remarkVos&&0<n.remarkVos.length?"time-line":""},Y().createElement(q,{avatar:n.uimg,userName:n.username||"匿名用户",emotionScore:n.escore,score:n.score,time:n.ctime,msgType:n.showDetailType||n.type,flag:n.status,id:n.id,index:n.index,routing:n.routing}),Y().createElement(te,{options:["reply","property"],data:n,contentWidth:a,detailParams:r,harmonyEvent:i,isTagClicked:l,handleTagClick:o})),n.remarkVos&&0<n.remarkVos.length&&n.remarkVos.map(function(e,t){return Y().createElement("div",{className:t===n.remarkVos.length-1?"":"time-line",key:e.id},Y().createElement(q,{avatar:e.userHeadUrl,userName:e.username||"匿名用户",time:e.ctime,msgType:e.showDetailType||e.type,alignDirection:"right"}),Y().createElement(te,{options:["alignRight"],data:e,contentWidth:a,detailParams:r,harmonyEvent:i,isTagClicked:l,handleTagClick:o}))}),Y().createElement(ne,{projectId:t,data:n,modelType:s,notContain:e?[]:["reply"]}))}var he=function(t){function e(e){var r=t.call(this,e)||this;return r.getPageData=function(){return r.state.dataList},r._handleWindowResize=function(){r.setState({contentWidth:document.getElementsByClassName("yt_section_component_wrapper")[0].offsetWidth})},r._handleEndReached=function(){var a=r.props.onScrollRefresh;r.timer&&clearTimeout(r.timer),r.timer=setTimeout(function(){var e,t,n=document.querySelector(".survey_wrap");n&&(e=n.scrollTop,t=n.offsetHeight,t=n.scrollHeight-e-t,r.setState({bottomDistance:t}),t<40&&a())},500)},r.state={dataList:[],bottomDistance:0,contentWidth:0},r.event={onEndReached:r._handleEndReached()},r}i()(e,t);var n=e.prototype;return n.componentDidUpdate=function(e){var t=e.detailData,n=e.specifyData,a=this.props,e=a.detailData,r=a.specifyData;JSON.stringify(t)!==JSON.stringify(e)&&e instanceof Array&&this.setState({dataList:e}),JSON.stringify(r)===JSON.stringify(n)||(n=(e=this.state.dataList).find(function(e){return e.id===r[0].id}))&&(n.remarkVos=r[0].remarkVos,n.messageVO=r[0].messageVO,this.setState({dataList:JSON.parse(JSON.stringify(e))}))},n.componentWillUnmount=function(){this.setState({dataList:[]}),window.removeEventListener("resize",this._handleWindowResize)},n.componentDidMount=function(){this._handleWindowResize(),window.addEventListener("resize",this._handleWindowResize)},n.render=function(){return Y().createElement(me,j()({},this.props,this.state,this.event))},e}(Y().PureComponent);const ge=function(e){var n,a,r,s,i,l,o,t=e.messageType,c=e.messageList,d=e.loading,u=e.projectId,m=e.contentWidth,p=e.detailParams,h=e.harmonyEvent,g=e.onMoreClick,f=e.modelType,v=e.handleTagsClick,E=Y().useState(!0),e=E[0],y=E[1],E=Y().useState(""),S=E[0],C=E[1],E=function(e,t){S&&e===S.tagId?S&&C(""):(C({tagId:e,id:t}),v(e))};return d&&c&&0===c.length?Y().createElement(L.Z,null):t&&"QUE_ANS_TALK"===t&&e?Y().createElement("div",{className:"msg-list-wrapper"},c&&c[0]&&pe(c[0],!0,u,m,p,f,h,S,E),Y().createElement("div",{className:"expand-more"},Y().createElement("span",{onClick:function(){y(!1),g(p)}},"查看更多",Y().createElement("i",{className:"icon-cem_cross-page"}))),c&&c[1]&&pe(c[1],!1,u,m,p,f,h,S,E)):Y().createElement("div",{className:"msg-list-wrapper"},(n=u,a=m,r=p,s=f,i=h,l=S,o=E,(c=c)&&0<c.length&&c.map(function(e,t){return pe(e,0===t,n,a,r,s,i,l,o)})))};function fe(n,e,t,a,r,s,i){return Y().createElement("div",{className:e?"msg-wrapper":"msg-wrapper not-first-msg",key:n.id},Y().createElement("div",{className:n.remarkVos&&0<n.remarkVos.length?"time-line":""},Y().createElement(q,{avatar:n.uimg,userName:n.username||"匿名用户",emotionScore:n.escore,score:n.score,time:n.ctime,msgType:"投"===n.showDetailType?"诉":n.showDetailType,flag:n.status,id:n.id,index:n.index,routing:n.routing}),Y().createElement(te,{options:e?["property"]:["reply","property"],data:n,contentWidth:a,detailParams:r,harmonyEvent:s})),n.remarkVos&&0<n.remarkVos.length&&n.remarkVos.map(function(e,t){return Y().createElement("div",{className:t===n.remarkVos.length-1?"":"time-line",key:e.id},Y().createElement(q,{avatar:e.userHeadUrl,userName:e.username||"匿名用户",time:e.ctime,msgType:e.showDetailType||e.type,alignDirection:"right"}),Y().createElement(te,{options:["alignRight"],data:e,contentWidth:a,detailParams:r,harmonyEvent:s}))}),Y().createElement(ne,{projectId:t,data:n,modelType:i,notContain:e?[]:["reply"]}))}var ve=function(t){function e(e){var r=t.call(this,e)||this;return r.getPageData=function(){return r.state.messageList},r.handleScroll=function(){var a=r.props.onScrollRefresh;r.timer&&clearTimeout(r.timer),r.timer=setTimeout(function(){var e=r.scrollContainer,t=e.scrollTop,n=e.offsetHeight,n=e.scrollHeight-t-n;r.setState({bottomDistance:n}),n<100&&a()},500)},r.handleOnWindowResize=function(){document.querySelector(".msg-list-wrapper")&&r.setState({contentWidth:document.querySelector(".msg-list-wrapper").offsetWidth})},r.handleOnMoreClick=function(e){r.setState({messageList:[]},function(){r.props.resetIndex({pageIndex:0}),r.props.fetchMsgDetail(e),r.scrollContainer.scrollTo({top:0,behavior:"auto"})})},r.state={id:"",resetTime:0,contentWidth:0,bottomDistance:0,messageList:[],addedMessageList:[],willBeUpdatedData:[]},r}i()(e,t);var n=e.prototype;return n.componentDidMount=function(){this.handleOnWindowResize(),window.addEventListener("resize",this.handleOnWindowResize),this.scrollContainer=document.querySelector(".inbox_wrap .msg_detail_wrap"),this.scrollContainer&&this.scrollContainer.addEventListener("scroll",this.handleScroll)},e.getDerivedStateFromProps=function(e,t){var n=t.id,a=t.addedMessageList,r=t.willBeUpdatedData,s=t.resetTime,i=e.detailData,l=e.data,o=e.data.id,c=e.specifyData,e=e.resetTime;if(n===o&&a&&i&&JSON.stringify(a)!==JSON.stringify(i))return{messageList:l.dataLevel&&"QUE_ANS_TALK"===l.dataLevel&&2===t.messageList.length?i:t.messageList.concat(i),addedMessageList:JSON.parse(JSON.stringify(i))};if(r&&c&&JSON.stringify(r)!==JSON.stringify(c)){for(var d=JSON.parse(JSON.stringify(t.messageList)),u=0;u<d.length;u++)for(var m=0;m<c.length;m++)d[u]&&c[m]&&d[u].id===c[m].id&&(d[u]=c[m]);return{messageList:d,willBeUpdatedData:c}}return n!==o?{id:o,bottomDistance:0,messageList:[],addedMessageList:[],willBeUpdatedData:[]}:s<e?{resetTime:e,bottomDistance:0,messageList:[],addedMessageList:[],willBeUpdatedData:[]}:null},n.componentWillUnmount=function(){this.scrollContainer&&this.scrollContainer.removeEventListener("resize",this.handleScroll)},n.render=function(){var e=this.props,t=e.data,n=e.loading,a=e.projectId,r=e.detailParams,s=e.modelType,i=e.harmonyEvent,l=e.handleTagsClick,o=this.state,e=o.messageList,o=o.contentWidth;return Y().createElement(ge,{contentWidth:o,detailParams:r,modelType:s,projectId:a,messageList:e,loading:n,messageType:t.dataLevel,harmonyEvent:i,onMoreClick:this.handleOnMoreClick,handleTagsClick:l})},e}(Y().PureComponent);const Ee=function(e){var n,a,r,s,i,t=e.messageType,l=e.messageList,o=e.loading,c=e.projectId,d=e.contentWidth,u=e.detailParams,m=e.harmonyEvent,p=e.onMoreClick,h=e.modelType,g=Y().useState(!0),e=g[0],f=g[1];return o&&l&&0===l.length?Y().createElement(L.Z,null):e&&t&&"COMPLAINT_REPLY"===t?Y().createElement("div",{className:"msg-list-wrapper"},l&&l[0]&&fe(l[0],!0,c,d,u,m,h),Y().createElement("div",{className:"expand-more"},Y().createElement("span",{onClick:function(){f(!1),p(u)}},"查看更多",Y().createElement("i",{className:"icon-cem_cross-page"}))),l&&l[1]&&fe(l[1],!1,c,d,u,m,h)):Y().createElement("div",{className:"msg-list-wrapper"},(n=c,a=d,r=u,s=m,i=h,(l=l)&&0<l.length&&l.map(function(e,t){return fe(e,0===t,n,a,r,s,i)})))};function ye(n,e,t,a,r,s,i,l,o,c,d){return Y().createElement("div",{className:e?"msg-wrapper":"msg-wrapper not-first-msg",key:n.id},Y().createElement("div",{className:n.remarkVos&&0<n.remarkVos.length?"time-line":""},Y().createElement(q,{avatar:n.uimg,userName:n.username||"匿名用户",emotionScore:n.escore,score:n.score,time:n.ctime,msgType:n.showDetailType||n.type,flag:n.status,id:n.id,index:n.index,routing:n.routing}),0===s&&i?Y().createElement(J.Fragment,null,Y().createElement(te,{options:["property"],data:n,contentWidth:a,detailParams:r,harmonyEvent:o,isTagClicked:c,handleTagClick:d}),Y().createElement("div",{className:"original-blog"},n.originName&&Y().createElement("span",{className:"original-username"},"@",n.originName),Y().createElement(te,{options:["property"],data:j()({},n,{content:n.originText,pictures:n.originPics,originSource:"",tagVos:void 0}),contentWidth:a,detailParams:r,harmonyEvent:o,isTagClicked:c,handleTagClick:d})),Y().createElement(X,{projectId:t,categoryId:n.categoryId,group:n.group,oid:n.oid,suboid:n.suboid,sourceId:n.sourceId})):Y().createElement(te,{options:["property","reply"],data:n,contentWidth:a,detailParams:r,harmonyEvent:o,isTagClicked:c,handleTagClick:d})),n.remarkVos&&0<n.remarkVos.length&&n.remarkVos.map(function(e,t){return Y().createElement("div",{className:t===n.remarkVos.length-1?"":"time-line",key:e.id},Y().createElement(q,{avatar:e.userHeadUrl,userName:e.username||"匿名用户",time:e.ctime,msgType:e.showDetailType||e.type,alignDirection:"right"}),Y().createElement(te,{options:["alignRight"],data:e,contentWidth:a,detailParams:r,harmonyEvent:o,isTagClicked:c,handleTagClick:d}))}),Y().createElement(ne,{projectId:t,data:n,modelType:l,notContain:e?[]:["reply"]}))}var Se=function(t){function e(e){var r=t.call(this,e)||this;return r.getPageData=function(){return r.state.messageList},r.handleScroll=function(){var a=r.props.onScrollRefresh;r.timer&&clearTimeout(r.timer),r.timer=setTimeout(function(){var e=r.scrollContainer,t=e.scrollTop,n=e.offsetHeight,n=e.scrollHeight-t-n;r.setState({bottomDistance:n}),n<100&&a()},500)},r.handleOnWindowResize=function(){document.querySelector(".msg-list-wrapper")&&r.setState({contentWidth:document.querySelector(".msg-list-wrapper").offsetWidth})},r.handleOnMoreClick=function(e){r.setState({messageList:[]},function(){r.props.resetIndex({pageIndex:0}),r.props.fetchMsgDetail(e),r.scrollContainer.scrollTo({top:0,behavior:"auto"})})},r.state={id:"",resetTime:0,contentWidth:0,bottomDistance:0,messageList:[],addedMessageList:[],willBeUpdatedData:[]},r}i()(e,t);var n=e.prototype;return n.componentDidMount=function(){this.handleOnWindowResize(),window.addEventListener("resize",this.handleOnWindowResize),this.scrollContainer=document.querySelector(".inbox_wrap .msg_detail_wrap"),this.scrollContainer&&this.scrollContainer.addEventListener("scroll",this.handleScroll)},e.getDerivedStateFromProps=function(e,t){var n=t.id,a=t.addedMessageList,r=t.willBeUpdatedData,s=t.resetTime,i=e.detailData,l=e.data,o=e.data.id,c=e.specifyData,e=e.resetTime;if(n===o&&a&&i&&JSON.stringify(a)!==JSON.stringify(i))return{messageList:l.dataLevel&&"QUE_ANS_TALK"===l.dataLevel&&2===t.messageList.length?i:t.messageList.concat(i),addedMessageList:JSON.parse(JSON.stringify(i))};if(r&&c&&JSON.stringify(r)!==JSON.stringify(c)){for(var d=JSON.parse(JSON.stringify(t.messageList)),u=0;u<d.length;u++)for(var m=0;m<c.length;m++)d[u]&&c[m]&&d[u].id===c[m].id&&(d[u]=c[m]);return{messageList:d,willBeUpdatedData:c}}return n!==o?{id:o,bottomDistance:0,messageList:[],addedMessageList:[],willBeUpdatedData:[]}:s<e?{resetTime:e,bottomDistance:0,messageList:[],addedMessageList:[],willBeUpdatedData:[]}:null},n.componentWillUnmount=function(){this.scrollContainer&&this.scrollContainer.removeEventListener("resize",this.handleScroll)},n.render=function(){var e=this.props,t=e.data,n=e.loading,a=e.projectId,r=e.detailParams,s=e.modelType,i=e.harmonyEvent,l=this.state,e=l.messageList,l=l.contentWidth;return Y().createElement(Ee,{contentWidth:l,detailParams:r,modelType:s,projectId:a,messageList:e,loading:n,messageType:t.dataLevel,onMoreClick:this.handleOnMoreClick,harmonyEvent:i})},e}(Y().PureComponent);const Ce=function(e){var n,a,r,s,i,l,o,t=e.messageType,c=e.messageList,d=e.loading,u=e.projectId,m=e.contentWidth,p=e.detailParams,h=e.onMoreClick,g=e.modelType,f=e.harmonyEvent,v=e.handleTagsClick,E=Y().useState(!0),e=E[0],y=E[1],E=Y().useState(""),S=E[0],C=E[1],E=function(e,t){S&&e===S.tagId?S&&C(""):(C({tagId:e,id:t}),v(e))};return d&&c&&0===c.length?Y().createElement(L.Z,null):e&&t&&"VIDEO_REPLY"===t?Y().createElement("div",{className:"msg-list-wrapper"},c&&c[0]&&ye(c[0],!0,u,m,p,0,c[0].dataLevel&&"WEIBO_REPORT"===c[0].dataLevel,g,f,S,E),Y().createElement("div",{className:"expand-more"},Y().createElement("span",{onClick:function(){y(!1),h(p)}},"查看更多",Y().createElement("i",{className:"icon-cem_cross-page"}))),c&&c[1]&&ye(c[1],!1,u,m,p,1,c[1].dataLevel&&"WEIBO_REPORT"===c[1].dataLevel,g,f,S,E)):Y().createElement("div",{className:"msg-list-wrapper"},(n=u,a=m,r=p,s=g,i=f,l=S,o=E,(c=c)&&0<c.length&&c.map(function(e,t){return ye(e,0===t,n,a,r,t,e.dataLevel&&"WEIBO_REPORT"===e.dataLevel,s,i,l,o)})))};var Ne=function(t){function e(e){var r=t.call(this,e)||this;return r.getPageData=function(){return r.state.messageList},r.handleScroll=function(){var a=r.props.onScrollRefresh;r.timer&&clearTimeout(r.timer),r.timer=setTimeout(function(){var e=r.scrollContainer,t=e.scrollTop,n=e.offsetHeight,n=e.scrollHeight-t-n;r.setState({bottomDistance:n}),n<100&&a()},500)},r.handleOnWindowResize=function(){document.querySelector(".msg-list-wrapper")&&r.setState({contentWidth:document.querySelector(".msg-list-wrapper").offsetWidth})},r.handleOnMoreClick=function(e){r.setState({messageList:[]},function(){r.props.resetIndex({pageIndex:0}),r.props.fetchMsgDetail(e),r.scrollContainer.scrollTo({top:0,behavior:"auto"})})},r.state={id:"",contentWidth:0,bottomDistance:0,resetTime:0,messageList:[],addedMessageList:[],willBeUpdatedData:[]},r}i()(e,t);var n=e.prototype;return n.componentDidMount=function(){this.handleOnWindowResize(),window.addEventListener("resize",this.handleOnWindowResize),this.scrollContainer=document.querySelector(".inbox_wrap .msg_detail_wrap"),this.scrollContainer&&this.scrollContainer.addEventListener("scroll",this.handleScroll)},e.getDerivedStateFromProps=function(e,t){var n=t.id,a=t.addedMessageList,r=t.willBeUpdatedData,s=t.resetTime,i=e.detailData,l=e.data,o=e.data.id,c=e.specifyData,e=e.resetTime;if(n===o&&a&&i&&JSON.stringify(a)!==JSON.stringify(i))return{messageList:l.dataLevel&&"WEIBO_TALK"===l.dataLevel&&2===t.messageList.length?i:t.messageList.concat(i),addedMessageList:JSON.parse(JSON.stringify(i))};if(r&&c&&JSON.stringify(r)!==JSON.stringify(c)){for(var d=JSON.parse(JSON.stringify(t.messageList)),u=0;u<d.length;u++)for(var m=0;m<c.length;m++)d[u]&&c[m]&&d[u].id===c[m].id&&(d[u]=c[m]);return{messageList:d,willBeUpdatedData:c}}return n!==o?{id:o,bottomDistance:0,messageList:[],addedMessageList:[],willBeUpdatedData:[]}:s<e?{resetTime:e,bottomDistance:0,messageList:[],addedMessageList:[],willBeUpdatedData:[]}:null},n.componentWillUnmount=function(){this.scrollContainer.removeEventListener("resize",this.handleScroll)},n.render=function(){var e=this.props,t=e.data,n=e.loading,a=e.projectId,r=e.detailParams,s=e.modelType,i=e.harmonyEvent,l=e.handleTagsClick,o=this.state,e=o.messageList,o=o.contentWidth;return Y().createElement(Ce,{contentWidth:o,detailParams:r,projectId:a,messageList:e,loading:n,modelType:s,messageType:t.dataLevel,harmonyEvent:i,onMoreClick:this.handleOnMoreClick,handleTagsClick:l})},e}(Y().PureComponent),we=r.Z.message.inboxDetail,t=function(t){function e(e){var a=t.call(this,e)||this;return a._handleOnScrollRefresh=function(){var e=a.props,t=e.data,n=e.noMoreData,e=e.detailParams;!n&&e&&("SERVICE"===t.messageCategory?a.props.fetchCustomerServiceDetail():a.props.fetchMsgDetail(),setTimeout(function(){a.props.fetchEnableOperatorList()},0))},a._handleOnFeedbackClick=function(t){var n=a.state.projectId;a.drawerRef.show({aspectList:t.aspectVos.map(function(e){return j()({},e,{aspect2:e.aspect2Name})}),callback:function(e){a.props.feedbackCommentTags({feedbackDetails:e,messageId:t.messageId,projectId:n,messageContent:t.messageContent,historyTag:t.aspectVos&&t.aspectVos.length?JSON.stringify(t.aspectVos.filter(function(e){return e.escore}).map(function(e){return{aspect:e.aspect2Name,escore:e.escore}})):""}).then(function(e){2e4===e.data.code&&l.default.success({style:{marginTop:"85px"},className:"feedback_success_message",content:Y().createElement("div",{className:"feedback_success_tip"},Y().createElement("img",{src:U(58476)}),Y().createElement("p",null,"指标反馈成功，感谢您的反馈！"))})})}})},a.state={projectId:I.t.get(I.V.curProject).id},a.event={onScrollRefresh:a._handleOnScrollRefresh,onFeedbackClick:a._handleOnFeedbackClick,getDrawerRef:function(e){return a.drawerRef=e}},a}i()(e,t);var n=e.prototype;return n.componentDidUpdate=function(e,t){var n=this,a=e.data,e=this.props.data;JSON.stringify(a)!==JSON.stringify(e)&&e&&e.messageCategory&&(this.props.clean(),a=j()({},e,{parent:"",projectId:this.state.projectId,id:"QUESTIONAIRE"===e.messageCategory?e.messageId:e.id}),"SERVICE"===e.messageCategory?this.props.fetchCustomerServiceDetail(a):this.props.fetchMsgDetail(a),setTimeout(function(){n.props.fetchEnableOperatorList()},0))},n.render=function(){var e=this.props,t=e.isEmpty,n=e.data,a=e.detailData,e=n&&n.messageCategory||"",r=n&&n.id||"";if(t)return Y().createElement("div",{style:{background:"white",height:"100%"}},Y().createElement("div",{className:"empty-block"},"没有数据..."));var s=j()({},this.props,this.state,this.event,{detailParams:j()({},this.props.data,{projectId:this.state.projectId})});switch(e){case"QUE_ANS":return Y().createElement(ve,j()({},s,{data:n||a,key:r,ref:this._getPageRef}));case"COMPLAINT":return Y().createElement(Se,j()({},s,{data:n||a,key:r,ref:this._getPageRef}));case"NEWS":case"SELF":return Y().createElement(M,j()({},s,{data:n||a,key:r}));case"QUESTION":case"COMMENT":return Y().createElement(le,j()({},s,{data:n||a,key:r}));case"SERVICE":return Y().createElement(W,j()({},s,{data:n||a,key:r}));case"BBS":case"COMMENT_REPLY":return Y().createElement(ce,j()({},s,{data:n||a,key:r}));case"WEIBO":case"SOCIAL":return Y().createElement(R,j()({},s,{data:n||a,key:r}));case"QUESTIONAIRE":return Y().createElement(he,j()({},s,{data:n||a,key:r}));case"VIDEO":return Y().createElement(Ne,j()({},s,{data:n||a,key:r}));default:return Y().createElement(L.Z,null)}},e}(Y().PureComponent);const _e=(0,s.connect)(function(e){var t=e.loading,e=a()(e,["loading"]);return j()({},e[we],{loading:t.effects[we+"/fetchMsgDetail"]||!1})},function(t){return{fetchMsgDetail:function(e){return t({type:we+"/fetchMsgDetail",payload:e})},fetchEnableOperatorList:function(e){return t({type:we+"/fetchEnableOperatorList",payload:e})},fetchCustomerServiceDetail:function(e){return t({type:we+"/fetchCustomerServiceDetail",payload:e})},clean:function(e){return t({type:we+"/clean",payload:e})},resetIndex:function(e){return t({type:we+"/save",payload:e})},feedbackCommentTags:function(e){return t({type:we+"/feedbackCommentTags",payload:e})}}})(t);U(47811);var ke=U(91633),Te=["项目主题","消息","情感类型","用户","指标模型"],Le=["消息","用户","互动量","情感类型","备注","实体模型","指标模型","规则标签"],Ie=["会话内容","提及商品","店铺名称","客户名称","客服信息","关注点模型"];const be=function(t){function e(e){var r=t.call(this,e)||this;return r.closeDownloadModal=function(){r.setState({step:1,show:!1,fields:[0,1,2,3],newFields:[0,1],serviceFields:[0]}),r.props.close()},r.renderFieldsDetail=function(){return Y().createElement("div",{className:"download_fileds_detail"},Y().createElement("div",{className:"title"},"下载字段"),Y().createElement("div",null,Y().createElement("span",null,"消息"),Y().createElement("div",null,"数据源链接，消息类型，消息ID，父消息ID，消息内容，创建时间，评价等级，评论有效性")),Y().createElement("div",null,Y().createElement("span",null,"情感类型"),Y().createElement("div",null,"情感类型")),Y().createElement("div",null,Y().createElement("span",null,"用户"),Y().createElement("div",null,"用户昵称，用户等级（暂不提供）")),Y().createElement("div",null,Y().createElement("span",null,"指标模型"),Y().createElement("div",null,"一级指标，二级指标，方面情感...")),Y().createElement("a",{onClick:r.goWiki},"查看更详细说明"))},r.renderServiceFieldsDetail=function(){return Y().createElement("div",{className:"download_fileds_detail"},Y().createElement("div",{className:"title"},"下载字段"),Y().createElement("div",null,Y().createElement("span",null,"会话内容"),Y().createElement("div",null,"会话Id，平台，会话内容，会话时间")),Y().createElement("div",null,Y().createElement("span",null,"提及商品"),Y().createElement("div",null,"品牌，型号")),Y().createElement("div",null,Y().createElement("span",null,"店铺名称"),Y().createElement("div",null,"店铺名称")),Y().createElement("div",null,Y().createElement("span",null,"客户名称"),Y().createElement("div",null,"客户名称")),Y().createElement("div",null,Y().createElement("span",null,"客服信息"),Y().createElement("div",null,"客服名称")),Y().createElement("div",null,Y().createElement("span",null,"关注点模型"),Y().createElement("div",null,"一级关注点，二级关注点")))},r.handleFieldsChange=function(e){var t=r.state.fields,n=t.indexOf(e);-1<n?t.splice(n,1):t.push(e),r.setState({fields:t})},r.handleNewFieldsChange=function(e){var t=r.state.newFields,n=t.indexOf(e);-1<n?t.splice(n,1):t.push(e),r.setState({newFields:t})},r.handleServiceFieldsChange=function(e){var t=r.state.serviceFields,n=t.indexOf(e);-1<n?t.splice(n,1):t.push(e),r.setState({serviceFields:t})},r.handleServiceDownloadMsg=function(){var e=r.state,t=e.serviceFields,n=e.step;r.props.messageType;0!==t.length?(e=[],t.includes(0)&&(e=e.concat(["SESSIONID","PLATFORM","CONTENT","TIME"])),t.includes(1)&&e.push("PRODUCT"),t.includes(2)&&e.push("SHOP"),t.includes(3)&&e.push("CUSTOMER"),t.includes(4)&&e.push("SELLER"),t.includes(5)&&e.push("FOCUS"),r.props.onServiceMessageDownload({exportTypes:e,category:"select",messageCategory:"WAITER_SESSION"}).then(function(e){2e4===e.data.code&&r.setState({step:n+1,category:"select"})})):G.Message.warning("请至少选择一个下载字段")},r.handleNewDownloadMsg=function(){var e=r.state,t=e.newFields,n=e.step,a=e.category;r.props.messageType;0!==t.length?(e=[],t.includes(0)&&(e=e.concat(["TEXT_MSG"])),t.includes(1)&&(e=e.concat(["TEXT_USER"])),t.includes(2)&&e.push("TEXT_INTERACTION"),t.includes(3)&&e.push("TEXT_ESCORE"),t.includes(4)&&e.push("TEXT_REMARK"),t.includes(5)&&e.push("TEXT_ENTITY"),t.includes(6)&&e.push("TEXT_ASPECT"),t.includes(7)&&e.push("TEXT_TAG"),r.props.onDownload({exportTypes:e,category:a}).then(function(e){2e4===e.data.code&&r.setState({step:n+1,category:"select"})})):G.Message.warning("请至少选择一个下载字段")},r.handleDownloadMsg=function(){var e=r.state,t=e.fields,n=e.step,a=e.category;r.props.messageType;0!==t.length?(e=[],t.includes(0)&&(e=e.concat(["SOURCE","TITLE","TOPIC"])),t.includes(1)&&(e=e.concat(["URL","MESSAGE_TYPE","ID","PARENT_ID","MESSAGE_CONTENT","MESSAGE_TIME","MESSAGE_SCORE","MESSAGE_EFFECTIVENESS"])),t.includes(2)&&e.push("MESSAGE_ESCORE"),t.includes(3)&&e.push("MESSAGE_USER"),t.includes(4)&&e.push("ASPECT"),r.props.onDownload({exportTypes:e,category:a}).then(function(e){2e4===e.data.code&&r.setState({step:n+1,category:"select"})})):G.Message.warning("请至少选择一个下载字段")},r.setStep=function(e){r.setState({step:e})},r.state={show:!1,step:1,fields:[0,1,2,3],category:"select",newFields:[0,1],serviceFields:[0]},r}i()(e,t);var n=e.prototype;return n.goWiki=function(){window.open("http://wiki.yuntingai.com/pages/viewpage.action?pageId=65609&os_username=yuntingguest&os_password=skieer@2019&os_cookie=true&login=%E7%99%BB%E5%BD%95&os_destination=")},n.componentDidUpdate=function(e){var t=this,n=this.props,a=n.show;n.messageType;e.show!==a&&this.setState({show:a},function(){a&&t.setStep(5e4<t.props.total?1:2)})},n.render=function(){var n=this,e=this.props,t=e.total,a=e.messageType,r=this.state,s=r.step,i=r.fields,l=r.newFields,o=r.serviceFields,e=r.show,r="QUESTIONAIRE"===a?"1条消息有对应多个标签、指标或实体时候，是否只导出筛选面板中选中的选项对应的值":"说明：一条消息会被打上多个规则标签或指标，是否只导出筛选面板中的选项对应的规则标签";return Y().createElement(G.Dialog,{title:"",size:"tiny",visible:e,onCancel:function(){return n.closeDownloadModal()},lockScroll:!0,className:"message_download_dialog_wrapper "+(2===s?"message_download_dialog_check_wrapper":"")},Y().createElement(G.Dialog.Body,null,1===s&&Y().createElement("div",{className:"download-tips"},Y().createElement("div",{className:"mock-dialog-tilte"},Y().createElement("i",{className:"icon-cem_warning",style:{color:"#D96969"}}),"消息数量超过上限，是否继续导出"),Y().createElement("div",null,"当前页面消息数为",Y().createElement("span",{style:{color:"#262626"}},0<=(t=t)&&t<1e3?t:t<1e4?(t/1e3).toFixed(2)+"千":(t/1e4).toFixed(2)+"万","条"),"，单次导出",Y().createElement("span",{style:{color:"#262626"}},"上限5万条")),Y().createElement("div",null,"点击确定后会按照时间排序导出最新的消息，或者点击取消进行更精准的筛选")),2===s&&Y().createElement("div",{className:"fields-select"},Y().createElement("div",{className:"mock-dialog-tilte"},Y().createElement("h4",null,"请选择下载字段",Y().createElement(K.Z,{placement:"bottom",overlayClassName:"alert-log-tips message_download_tips_wrap",overlay:"SERVICE"===a?this.renderServiceFieldsDetail():this.renderFieldsDetail(),mouseEnterDelay:.6},Y().createElement("i",{className:"icon-cem_file1",style:{marginLeft:4,fontSize:14,color:"#979797",verticalAlign:"unset"}})))),Y().createElement("div",{style:{display:"flex",padding:"0 16px 16px 16px"}},a&&Y().createElement("div",{className:"fields-select-title"},(0,z.Gt)(a)),Y().createElement("div",{style:{flex:3}},a&&"COMMENT"!==a&&"QUESTION"!==a?a&&"SERVICE"!==a?Y().createElement(Y().Fragment,null,Le.map(function(e,t){return Y().createElement(G.Checkbox,{key:t,value:t,checked:l.includes(t),disabled:0===t,onChange:function(){return n.handleNewFieldsChange(t)}},e)})):Y().createElement(Y().Fragment,null,Ie.map(function(e,t){return Y().createElement(G.Checkbox,{key:t,value:t,checked:o.includes(t),disabled:0===t,onChange:function(){return n.handleServiceFieldsChange(t)}},e)})):Y().createElement(Y().Fragment,null,Te.map(function(e,t){return Y().createElement(G.Checkbox,{key:t,value:t,checked:i.includes(t),disabled:0===t||1===t,onChange:function(){return n.handleFieldsChange(t)}},e)})))),Y().createElement("div",null,a&&"SERVICE"!==a&&Y().createElement(Y().Fragment,null,Y().createElement("p",null,r),Y().createElement(G.Radio.Group,{value:this.state.category,onChange:function(e){return n.setState({category:e})}},Y().createElement(G.Radio,{value:"select"},"只导出选中"),Y().createElement(G.Radio,{value:"all"},"导出全部"))))),3===s&&Y().createElement("div",{className:"after-download-tips"},Y().createElement("div",{className:"mock-dialog-tilte"},Y().createElement("i",{className:"icon-cem_complete1",style:{color:"#00B76E"}}),"正在导出中..."),Y().createElement("div",null,"请稍后查看",Y().createElement("a",{target:"_blank",style:{color:"#0847a6"},rel:"noopener noreferrer",href:"/personalSettings/download"},"导出记录")),Y().createElement("div",null,"导出完成后，也可从右上角的消息处下载导出数据"))),Y().createElement(G.Dialog.Footer,{className:"dialog-footer"},Y().createElement(G.Button,{type:"primary",onClick:function(){var e=n.state.step;1===e?n.setStep(e+1):2===e?a&&"COMMENT"!==a&&"QUESTION"!==a?a&&"SERVICE"!==a?n.handleNewDownloadMsg():n.handleServiceDownloadMsg():n.handleDownloadMsg():n.closeDownloadModal()}},1===s?"继续导出":"确定"),2!==s&&Y().createElement(G.Button,{onClick:function(){return n.closeDownloadModal()}},"取消")))},e}(J.Component);var Oe=U(60496);Array.prototype.duplicator=function(e){var t=this,n=[];return new Array(e).fill(0).forEach(function(){return n.push.apply(n,t)}),n};var De=["40%","60%","80%","60%","0"].duplicator(4),Me=[{title:"按发布时间最新",value:"cTime|DESC"},{title:"按发布时间最早",value:"cTime|ASC"},{title:"按点赞数量最大",value:"attitudesCount|DESC"},{title:"按转发数量最大",value:"repostsCount|DESC"},{title:"按评论数量最大",value:"commentsCount|DESC"}],xe=[{title:"按答题时间最新",value:"cTime|DESC"},{title:"按答题时间最早",value:"cTime|ASC"}],Re={PROMOTER:"推荐者",PASSIVE:"被动者",DETRACTOR:"贬损者"},Ve={TEXT:"普通题型问卷",TEXTAREA:"普通题型问卷",NPS_REASON:"NPS问卷",SATISFACTION_REASON:"满意度问卷"},Pe=function(e){function t(){var o=e.call(this)||this;return o.fixedTime=function(e){o.state.serverTime;var t=new Date,n=new Date(e.substring(0,19).replace(/-/g,"/").replace(/T/," ")),a=t.getTime()-n.getTime(),r=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime(),e=new Date(r-864e5).getTime();switch(!0){case a<36e5:var s=Math.abs(Math.floor(a/6e4));return s?s+"分钟前":"刚刚";case a<864e5:return Math.floor(a/36e5)+"小时前";case n.getTime()>=e&&n.getTime()<r:return"昨天 "+o.formatterNum(new Date(+n-864e5).getHours())+" : "+o.formatterNum(new Date(+n-864e5).getMinutes());case n.getFullYear()===t.getFullYear():return o.formatterNum(n.getMonth()+1)+"月"+o.formatterNum(n.getDate())+"日";default:return n.getFullYear()+"年"+o.formatterNum(n.getMonth()+1)+"月"+o.formatterNum(n.getDate())+"日"}},o.formatterNum=function(e){return e<10?"0"+e:e},o.loadMore=function(){var e=o.inboxListWrap,t=e.scrollTop,n=e.offsetHeight,a=e.scrollHeight,r=o.props,s=r.messageList,e=r.total,r=r.messageListFetching;o.setState({leftListScrollBottom:a-t-n}),r||s.length>=e||30<a-t-n||o.setState({leftListScrollBottom:100},function(){o.props.fetchMessageList({pageIndex:o.props.pageIndex+1})})},o.closeDownload=function(){o.setState({downloadModalShow:!1})},o.downhandler=function(e){var t,n,a,r,s,i,l;o.inboxListWrap&&(t=e.keyCode,s=(r=o.props).messageList,l=r.total,n=r.messageListFetching,a=(i=o.inboxListWrap).clientHeight,r=i.scrollTop,i=i.scrollHeight,n||s.length>l||!a||40!==t&&38!==t||(e.preventDefault(),o.currentId=o.currentId||0,40===t?o.currentId+1!==l&&o.currentId++:0<o.currentId&&o.currentId--,(s=s[o.currentId])&&o.currentId+1!==l||(o.inboxListWrap.scrollTop=i-a),0<=o.currentId&&s&&(i=(l=o.inboxListWrap.children[o.currentId]).offsetHeight,r+a<(l=l.offsetTop)+i&&(o.inboxListWrap.scrollTop=l-a+i),0<r-l&&(o.inboxListWrap.scrollTop=l),o.props.onInboxClick(s))))},o.handleFormatContent=function(e){var t=o.escape2Html(o.escape2Html(e)),e=document.createElement("div");return e.innerHTML=t,e.innerText},o.escape2Html=function(e){var n={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return e&&e.replace(/&(lt|gt|nbsp|amp|quot);/gi,function(e,t){return n[t]})},o.state={leftListScrollBottom:100,downloadModalShow:!1},o.myRef=Y().createRef(),o.currentId=null,o}i()(t,e);var n=t.prototype;return n.handleTimeFormat=function(e){if("string"==typeof e&&e)return e.replace(/(\s\d+)$/g,"").replace(/[a-z]/gi," ").replace(/-/g,"/")},n.hightLightWord=function(e,t){var n=this.handleFormatContent(e)||"",e=this.props.highLightWordList;return Array.isArray(t)&&(e=(e&&0<e.length?e:[]).concat(t)),n&&e&&e.forEach(function(e){var t=e.includes("*")?e.replaceAll("*",""):e,e=new RegExp(t,"ig");n=n.replace(e,'<span style="background: #D2CE77">'+t+"</span>")}),n},n.componentDidMount=function(){window.addEventListener("keydown",this.downhandler)},n.componentWillUnmount=function(){window.removeEventListener("keydown",this.downhandler)},n.render=function(){var n=this,e=this.state,t=(e.leftListScrollBottom,e.downloadModalShow),a=this.props,r=a.MODEL,s=a.MESSAGE_TYPE,i=a.messageList,l=a.total,o=a.questionnaireCount,c=a.curSelectMessage,d=a.garbageTotal,u=a.messageListFetching,m=a.onInboxClick,p=a.onMessageDownload,h=a.onServiceMessageDownload,g=a.onSortTypeChange,e=a.sortName,f=c?c.id:null,a=c?c.messageCategory:null,c=!s||"COMMENT"===s||"WEIBO"===s||"SOCIAL"===s||"BBS"===s||"SELF"===s||"QUE_ANS"===s||"COMPLAINT"===s||"NEWS"===s||"VIDEO"===s||"QUESTIONAIRE"===s||"QUESTION"===s||"SERVICE"===s,v="QUESTIONAIRE"===s||"QUESTIONAIRE"===a,E="SERVICE"===s||"SERVICE"===a,a=!s||"COMMENT"===s||"SERVICE"===s||"WEIBO"===s?Me.slice(0,2):v?xe:Me,o=o||l;return Y().createElement("div",{style:{height:"100%"}},void 0===i&&Y().createElement(L.Z,{paragraph:De}),void 0!==i&&Y().createElement("div",{className:"list-part"},Y().createElement("div",{className:"sort-bar"},Y().createElement("div",{className:"total"},Y().createElement("span",null,"共",Y().createElement("span",null,o&&new String(o).replace(/(?=(\B)(\d{3})+$)/g,","))," ",v?"份问卷":"项"),0!==d&&!v&&Y().createElement("div",{className:"tip"},Y().createElement(K.Z,{overlay:"共"+l+"项，其中被自定义规则标记为用户可见的无效数据消息数为"+d+"项",placement:"top",mouseEnterDelay:.2},Y().createElement("i",{className:"icon-cem_file1",style:{color:"#8c8c8c"}})))),Y().createElement("div",{className:"sort"},Y().createElement("span",null,"排序 "),Y().createElement(Oe.Z,{onChange:g,activeObj:e,options:a,sufIcon:"icon-cem_show-more"})),c&&!r&&Y().createElement("div",{className:"download hoverColor",onClick:function(){return n.setState({downloadModalShow:!0})}},Y().createElement(K.Z,{overlay:"导出当前页数据",placement:"top",mouseEnterDelay:.6},Y().createElement("i",{className:"icon-xiazai"})))),!!l&&Y().createElement("ul",{className:"inbox-list-wrap",ref:function(e){return n.inboxListWrap=e},onScroll:this.loadMore},i.map(function(e,t){return Y().createElement("li",{key:e.id,className:"list-inbox "+("PERSONAL"!==r&&"FOLDER"!==r||0===e.status?"":"read")+" "+(f&&e.id===f?"current":""),onClick:function(){n.currentId=t,m(e)}},Y().createElement("div",{className:"wrap"},Y().createElement("div",{className:"title"},Y().createElement("div",{className:"message-user"},Y().createElement("span",{className:"source-img"},Y().createElement(ke.Z,{src:(0,z.Pk)($.z[e.sourceName]),alt:e.sourceName})),Y().createElement("span",{className:"name"},e.username)),Y().createElement(K.Z,{overlay:""+n.handleTimeFormat(e.ctime),placement:"top",mouseEnterDelay:.6},Y().createElement("span",{className:"time-to-now fade-color"},n.fixedTime(e.ctime)))),e.title&&!E&&Y().createElement("div",{className:"content-header-wrap"},Y().createElement("p",{className:"content-header fade-color ",dangerouslySetInnerHTML:{__html:n.hightLightWord(e.title,e.highLightInfoList)},title:e.title})),Y().createElement("div",{className:"msg_list_content_wrap",dangerouslySetInnerHTML:{__html:n.hightLightWord(e.hasOwnProperty("summary")?e.summary:e.answerOrReason,e.highLightInfoList)}}),Y().createElement("p",{className:"connection-name"},Y().createElement("span",null,e.answerListType?Ve[e.answerListType]:""+e.type),Y().createElement("span",{className:"space"}," | "),Y().createElement(K.Z,{overlay:e.sourceName+"-"+e.connectionName,placement:"topLeft",mouseEnterDelay:.6,overlayStyle:{maxWidth:424}},Y().createElement("span",{className:"survery_Type"},e.sourceName+"-"+e.connectionName)),Y().createElement("span",{className:"escore-type"},v?e.answerListType&&"NPS_REASON"===e.answerListType?Re[e.scoreLevel]:"SATISFACTION_REASON"===e.answerListType?-1===e.escore?"差评":0===e.escore?"中评":"好评":"":[-1,0,1].includes(e.escore)&&Y().createElement(K.Z,{overlay:-1===e.escore?"负面":0===e.escore?"中性":"正面",placement:"top",mouseEnterDelay:.6},Y().createElement("i",{className:"cem-icon icon-cem_"+(-1===e.escore?"negative":0===e.escore?"neutral":"positive")}))))))}),0!==l&&null!==l&&Y().createElement("li",{className:"more"},Y().createElement("p",{style:{display:u?"block":"none"}},"加载更多数据中..."),Y().createElement("p",{style:{display:i.length>=l&&!u?"block":"none"}},"没有更多数据..."))),0===l&&Y().createElement("li",{className:"empty-block"},"没有数据...")),c&&!r&&Y().createElement(be,{total:l,messageType:s,show:t,close:this.closeDownload,onDownload:p,onServiceMessageDownload:h}))},t}(J.Component);const Fe=function(t){function e(e){e=t.call(this,e)||this;return e.state={filterRef:{}},e}i()(e,t);var n=e.prototype;return n.handleFilterShow=function(e,t){var n=this.state.filterRef;n[e]?n[e]=Object.assign(n[e],t):n[e]=t,this.setState({filterRef:j()({},n)})},n.render=function(){var n=this,a=this.state.filterRef,e=this.props.unreducedFilter;return Y().createElement("div",{className:"not_restored_wrapper"},Y().createElement("div",{className:"title"},"未还原筛选条件"),e&&e.map(function(t){return Y().createElement("dl",{key:t.id},Y().createElement("dt",null,t.label),Y().createElement("dd",{ref:function(e){return!a[t.id]&&n.handleFilterShow(t.id,{ref:e,clientHeight:e.clientHeight,class:22<e.clientHeight?"collaspe":"",isShow:!1})},className:a[t.id]&&a[t.id].class?"showItem "+(a[t.id].isShow?"":a[t.id].class):""},Y().createElement("span",null,t.values.join("、")),a[t.id]&&a[t.id].class?Y().createElement("span",{onClick:function(){return n.handleFilterShow(t.id,{isShow:!a[t.id].isShow})}},a[t.id].isShow?"收起":"展开"):""))}))},e}(J.Component),We=function(e){function t(){return e.apply(this,arguments)||this}return i()(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.onConfirm,a=t.onCancel,t=t.style;return Y().createElement("div",{className:"bottom_bar",style:t||{}},Y().createElement("ul",{className:"handle"},0<this.props.screeningValues.length&&Y().createElement("li",null,Y().createElement("span",{className:"clear",onClick:function(){return e.props.clearAllValues()}},"清空选项"))),Y().createElement(G.Button,{type:"primary",onClick:function(){n&&n()}},"查询"),Y().createElement(G.Button,{onClick:function(){a&&a()}},"取消"))},t}(Y().PureComponent);var Ae=U(85151),Be=function(t){function e(e){var i=t.call(this,e)||this;return i.handleCheckedAll=function(e){var t,n=i.props,a=n.data,r=n.changeState,s=n.allListLength,n=i.state.checkedList;a=100<s?(t=a.slice(0,100).map(function(e){return e.id}),e.target.checked?Array.from(new Set(t.concat(n))):n.filter(function(e){return!t.includes(e)})):e.target.checked?a.map(function(e){return e.id}):[],i.setState({newCheckedList:a}),r&&r(a,i.props.secondValue)},i.handleChange=function(e){Array.prototype.remove=function(e){e=this.indexOf(e);-1<e&&this.splice(e,1)};var t=i.state.checkedList,n=i.props.changeState;-1===t.indexOf(e)?t.push(e):t.remove(e),i.setState({checkedList:t}),n&&n(t,i.props.secondValue)},i.handleSecondChange=function(t,n){var e=i.props,a=(e.data,e.secondValue),e=e.changeState;Array.prototype.remove=function(e){e=this.indexOf(e);-1<e&&this.splice(e,1)},a.some(function(e){return e.id===t&&(-1<e.values.indexOf(n)?e.values.remove(n):e.values.push(n),!0)})||a.push({id:t,values:[n]}),e&&e(i.props.checkedList,a.filter(function(e){return 0<e.values.length}))},i.competeOpen=function(){45<i.checkBox.offsetHeight?i.setState({showOpen:!0}):i.setState({showOpen:!1})},i.renderSecondList=function(e){var t=i.props,r=t.secondValue,n=t.secondInfo,t=i.state,a=t.showSecond,s=t.searchKeywords;return Y().createElement("div",{className:"second-list"},Y().createElement("span",{className:"name",onClick:function(e){return i.setState({showSecond:!a})}},Y().createElement("i",{className:a?"icon-cem_data-collection":"icon-cem_unfolding-data"}),Y().createElement("span",null,n.name)),a&&e.filter(function(e){return-1!==e.name.toLowerCase().indexOf(s.toLowerCase())}).map(function(n,e){var a=0<r.filter(function(e){return e.id===n.id}).length?r.filter(function(e){return e.id===n.id})[0].values:[];return Y().createElement("div",{key:e,className:"second-wrap"},Y().createElement("span",{className:"title-second"},n.name),Y().createElement("div",{className:"check-wrap"},n.child.map(function(e,t){return Y().createElement(Ae.Jg,{className:"checkbox-yt",onChange:function(){return i.handleSecondChange(n.id,e.id)},key:e.id,value:e.id,checked:-1!==a.indexOf(e.id)},e.name)})))}))},i.state={checkedList:e.checkedList||[],open:!1,showOpen:!1,showSecond:!0,searchKeywords:e.searchKeywords},i}i()(e,t);var n=e.prototype;return n.UNSAFE_componentWillReceiveProps=function(e){var t=this;(e.checkedList||e.searchKeywords)&&this.setState({checkedList:e.checkedList,searchKeywords:e.searchKeywords},function(){return t.competeOpen()})},n.componentDidMount=function(){this.competeOpen(),window.addEventListener("resize",this.competeOpen)},n.componentWillUnmount=function(){window.removeEventListener("resize",this.competeOpen)},n.render=function(){var t=this,e=this.state,n=e.checkedList,a=e.open,r=e.showOpen,s=e.searchKeywords,i=this.props,l=i.data,o=i.categoryTitle,c=i.title,d=i.close,u=i.onSearch,m=l.map(function(e){return e.id}),p=n.filter(function(e){return 0<=m.indexOf(e)}),e=!!p.length&&l.slice(0,100).every(function(e){return n.includes(e.id)}),i=!e&&!!p.length&&l.slice(0,100).some(function(e){return n.includes(e.id)}),p=l.filter(function(e){return n.includes(e.id)&&e.child&&0<e.child.length});return Y().createElement("div",{className:"checkbox-panel-yt"},Y().createElement("span",{className:"title"},c,u&&Y().createElement(K.Z,{overlay:"按主题值搜索",placement:"top",mouseEnterDelay:.6},Y().createElement("i",{className:"icon-cem_search search",onClick:function(e){return u()}}))),Y().createElement(Ae.Jg,{className:"check-all",checked:e,indeterminate:i,onChange:this.handleCheckedAll,disabled:this.props.disabled},o||"全选"),Y().createElement("div",{className:"all-checkbox",style:{height:a?"":"38px"}},Y().createElement("span",{className:"more"},r&&Y().createElement("i",{className:"open",onClick:function(e){return t.setState({open:!a})}},a?"收起":"更多",Y().createElement("i",{className:a?"icon-cem_pull-or-take-up":"icon-cem_pull-down-or-take-up"})),d&&Y().createElement("i",{className:"close",onClick:d},"×")),Y().createElement("div",{className:"check-box",ref:function(e){return t.checkBox=e}},l&&l.filter(function(e){return!s||-1!==e.name.toLowerCase().indexOf(s.toLowerCase())}).slice(0,100).map(function(e){return Y().createElement(Ae.Jg,{className:"checkbox-yt",onChange:function(){return t.handleChange(e.id)},key:e.id,value:e.id,checked:-1!==n.indexOf(e.id),disabled:t.props.disabled},e.name)}),l&&100<l.length&&Y().createElement("div",{className:"tip"},"— 该数值展示不会超过",100,"条,需要查看更多请搜索"))),0<p.length&&this.renderSecondList(p))},e}(J.Component);Be.propTypes={checkedList:n().array,secondInfo:n().array,secondValue:n().array,data:n().array,allListLength:n().oneOfType([n().number,n().string]),changeState:n().func,searchKeywords:n().string,onSearch:n().func,title:n().oneOfType([n().number,n().string]),close:n().func};var He=function(t){function e(e){var n=t.call(this,e)||this;return n._setEvent=function(e){return 0===e?{onMouseEnter:function(){n.setState({firstLiHover:!0})},onMouseLeave:function(){n.setState({firstLiHover:!1})}}:{}},n.setDefaultValue=function(){var t=n.getValue();f.h.post("/default/value/update",{projectId:I.t.get(I.V.curProject).id,key:"PRODUCT_ANALYSIS_OBJ",value:JSON.stringify(t)}).then(function(e){n.setState({defaultSelectValue:t,shouldUpdataDefaultSelectValue:!1})})},n.state={options:[{}],sel:[{name:""},{name:""}],defaultSelectValue:n.props.defaultSelectValue,shouldUpdataDefaultSelectValue:!0,value:{},firstLiHover:!1},n}i()(e,t);var n=e.prototype;return n.onSel=function(e,t){var n=this,a=this.state.options;a.forEach(function(e){return e.sel=!1}),a[t].sel=!0,this.setState({options:a},function(e){return n.props.onChange&&n.props.onChange(n.getValue())})},n.getValue=function(){return JSON.parse(JSON.stringify(this.state.options)).filter(function(e){return e.sel})[0]},n.UNSAFE_componentWillReceiveProps=function(e){var t,n;(e.options||e.value)&&(t=JSON.parse(JSON.stringify(e.options)),n=JSON.parse(JSON.stringify(e.value)),t.forEach(function(e){e.id===n.id&&(e.sel=!0)}),this.setState({options:t,value:n}),this.state.shouldUpdataDefaultSelectValue&&this.setState({defaultSelectValue:e.defaultSelectValue}))},n.UNSAFE_componentWillMount=function(){var e=this.props.options,t=this.props.value||{};e.forEach(function(e){e.id===t.id&&(e.sel=!0)}),this.setState({options:e,value:t})},n.componentWillUnmount=function(){},n.render=function(){var n=this,e=this.state,t=e.options,a=e.defaultSelectValue,e=t[0]&&t[0].sel;return Y().createElement("div",{className:"selItem "+(this.props.triangle?"triangle":"")+" "+(this.state.firstLiHover||e?"selPadHover":""),onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},Y().createElement("div",{className:"wrap"},Y().createElement("ul",null,0<t.length?t.map(function(e,t){return Y().createElement("li",j()({className:(e.sel?"sel":"")+(e.disable?" disable":""),key:t,onClick:function(e){return n.onSel(e,t)}},n._setEvent(t)),Y().createElement("span",null,e.name),!n.props.noCollect&&e.sel&&Y().createElement("i",{className:"default icon-cem_star",style:{color:a.id===e.id?"#D5B437":"#8C8C8C",opacity:a.id===e.id?"1":""},onClick:a.id===e.id?null:n.setDefaultValue}),Y().createElement("i",{className:"check cem-icon icon-cem_arrow-thick"}))}):Y().createElement("div",{className:"noData"},"无数据"))))},e}(J.Component);He.propTypes={noCollect:n().bool,options:n().array,value:n().object,onChange:n().func};var Ue=function(e){function t(){var s=e.call(this)||this;return s.sortList=function(e,t,n){n.stopPropagation(),n.nativeEvent.stopImmediatePropagation();var a=JSON.parse(JSON.stringify(s.state.value)),r=a.splice(e,1)[0];switch(t){case"top":a.unshift(r);break;case"up":a.splice(e-1,0,r);break;case"down":a.splice(e+1,0,r)}s.setState({value:a},function(e){return s.props.onChange&&s.props.onChange(s.getValue())})},s._setEvent=function(e){return 0===e?{onMouseEnter:function(){s.setState({firstLiHover:!0})},onMouseLeave:function(){s.setState({firstLiHover:!1})}}:{}},s.state={options:[],value:[],showSel:!1,firstLiHover:!1,searchWord:""},s}i()(t,e);var n=t.prototype;return n.onSel=function(e,n){var t=this,a=this.state.options,r=this.state.value;!n.sel&&this.props.limit&&r.length>=this.props.limit?v.Z.warning("最多选择"+this.props.limit+"个对象！"):(a.forEach(function(e){e.id===n.id&&(t.props.singelSel?(e.sel=!0,r=[e]):(e.sel=!e.sel,e.sel?r.push(e):r.some(function(e,t){return e.id===n.id&&(r.splice(t,1),!0)})))}),this.setState({options:a,value:r},function(e){return t.props.onChange&&t.props.onChange(t.getValue())}))},n.getValue=function(){return this.state.value},n.UNSAFE_componentWillReceiveProps=function(e){var t,n;(e.options||e.value)&&(t=JSON.parse(JSON.stringify(e.options)),n=JSON.parse(JSON.stringify(e.value)),t.forEach(function(e){n.map(function(e){return e.id}).includes(e.id)?e.sel=!0:e.sel=!1}),this.setState({options:t,value:n}))},n.UNSAFE_componentWillMount=function(){var e=this.props,t=e.options,e=e.value,n=void 0===e?[]:e;t.forEach(function(e){n.map(function(e){return e.id}).includes(e.id)&&(e.sel=!0)}),this.setState({options:t,value:n})},n.componentWillUnmount=function(){},n.render=function(){var a=this,e=this.state,n=e.options,t=e.value,r=e.searchWord,s=[];return 0<t.length&&0<n.filter(function(e){return e.sel}).length&&t.forEach(function(t){n.filter(function(e){return e.id===t.id})[0]&&s.push(n.filter(function(e){return e.id===t.id})[0])}),Y().createElement("div",{className:"analyze-object-sort-select"},Y().createElement("div",{className:"selItem "+(this.props.triangle?"triangle":"")+" "+(this.state.firstLiHover?"selPadHover":""),onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},Y().createElement("div",{className:"wrap"},Y().createElement("div",null,Y().createElement(G.Input,{value:r,placeholder:"输入搜索关键词",className:"search",icon:"close",onChange:function(e){return a.setState({searchWord:e})},onIconClick:function(){return a.setState({searchWord:""})}})),Y().createElement("ul",null,0<s.length&&s.filter(function(e){return!r||-1!==e.name.toLocaleLowerCase().indexOf(r.trim().toLocaleLowerCase())}).map(function(t,n){return Y().createElement("li",j()({className:(t.sel?"sel":"")+(t.disable?" disable":""),key:n,onClick:function(e){return a.props.singelSel?"":a.onSel(e,t)}},a._setEvent(n)),!a.props.singelSel&&Y().createElement(Ae.Jg,{className:"check-all",checked:t.sel,onChange:function(e){}}),Y().createElement("span",null,t.name),!a.props.singelSel&&Y().createElement("div",{className:"handle"},0!==n&&Y().createElement("i",{title:"置顶",onClick:function(e){a.sortList(n,"top",e)},className:"icon-cem_roof-placement"}),0!==n&&Y().createElement("i",{title:"上一位",onClick:function(e){a.sortList(n,"up",e)},className:"icon-cem_upper"}),n!==s.length-1&&Y().createElement("i",{title:"下一位",onClick:function(e){a.sortList(n,"down",e)},className:"icon-cem_lower"})))}),0<s.length&&0<n.filter(function(e){return!e.sel}).length&&Y().createElement("div",{className:"line"}),0<n.filter(function(e){return!e.sel}).length&&n.filter(function(e){return!e.sel}).filter(function(e){return!r||-1!==e.name.toLocaleLowerCase().indexOf(r.trim().toLocaleLowerCase())}).map(function(t,e){return Y().createElement("li",{className:(t.sel?"sel":"")+(t.disable?" disable":""),key:e,onClick:function(e){return a.onSel(e,t)}},!a.props.singelSel&&Y().createElement(Ae.Jg,{className:"check-all",checked:t.sel,onChange:function(e){}}),Y().createElement("span",{className:"dark"},t.name))}),0===n.length&&Y().createElement("div",{className:"noData"},"无数据")))))},t}(J.Component);Ue.propTypes={options:n().array,value:n().array,onChange:n().func,singelSel:n().bool};var je=function(t){function e(e){var a=t.call(this,e)||this;return a.stop=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},a.getPropsValue=function(){var e=a.props.value;e&&e[0]&&e[0].id&&(a.setState({selectValue:{id:e[0].id,name:e[0].name}},function(){return a.copyVal=a.getValue()}),e[0].values&&a.setState({sortSelectValue:e[0].values},function(){return a.copyVal=a.getValue()}))},a.setShowSelFalse=function(){a.state.show&&(a.setState({selectValue:a.copyVal?{id:a.copyVal[0].id,name:a.copyVal[0].name}:{},sortSelectValue:a.copyVal&&a.copyVal[0].values?a.copyVal[0].values:[]}),a.cancel()),a.state.show&&a.setState({show:!1})},a.cancel=function(){a.setState({show:!1})},a.onSelChange=function(e,t){var n;a.setState(((n={})[e]=t,n)),"selectValue"===e&&a.setState({sortSelectValue:[]})},a.state={list:e.list||[],selectValue:{},sortSelectValue:[],show:!1,triangle:"select"},a}i()(e,t);var n=e.prototype;return n.UNSAFE_componentWillMount=function(){var e;this.props.left&&this.props.left<-200&&this.setState({triangle:"sortSelect"}),this.props.value&&(e=this.props.value,this.setState({selectValue:{id:e.id,name:e.name},sortSelectValue:e.values}))},n.componentDidMount=function(){var t=this;this.getPropsValue(),window.addEventListener("click",this.setShowSelFalse),this.props.left&&document.querySelectorAll(".analyze-object").forEach(function(e){return e.style.setProperty("--x",t.props.left+"px")})},n.UNSAFE_componentWillUpdate=function(e){this.state.show||"{}"===JSON.stringify(this.state.selectValue)||"[]"!==JSON.stringify(e.value)||this.setState({selectValue:{},sortSelectValue:[]})},n.componentWillUnmount=function(){window.removeEventListener("click",this.setShowSelFalse)},n.getValue=function(){return this.state.selectValue.id?[{id:this.state.selectValue.id,values:this.state.sortSelectValue,name:this.state.selectValue.name}]:{}},n.changeShow=function(e){var t=this;this.state.show&&this.stop(e),setTimeout(function(){t.setState({show:!t.state.show})},0)},n.render=function(){var t=this,e=this.state,n=e.list,a=e.selectValue,r=e.sortSelectValue,s=e.defaultSelectValue,i=e.show,l=e.triangle,o=n.map(function(e){return{id:e.id,name:e.name}}),c=this.props.close,e=n.filter(function(e){return e.id===a.id})[0]?n.filter(function(e){return e.id===a.id})[0].values.map(function(e){return delete e.sel,e}):[],n=a.name?a.name+(r.map(function(e){return e.name}).filter(function(e){return e}).length?" | "+r.map(function(e){return e.name}).filter(function(e){return e}).join(","):""):"请选择";return Y().createElement("div",{className:"checkbox-panel-yt-point"},Y().createElement("span",{className:"title"},this.props.name),Y().createElement("div",{className:"all-checkbox",style:{height:open?"":"38px"}},Y().createElement("span",{className:"more"},c&&Y().createElement("i",{className:"close",onClick:c},"×")),Y().createElement("div",{className:"check-box",ref:function(e){return t.checkBox=e}},Y().createElement("div",{className:"service-analyze-object"},Y().createElement("div",{className:"analyze-object-select",onClick:function(e){return t.changeShow(e)}},Y().createElement("div",{className:"infor "+(i?"sel":"")},Y().createElement("span",null,n),Y().createElement("i",{className:"icon-cem_pull-down-or-take-up",style:{transform:i?"rotate(-180deg)":""}})),i&&Y().createElement(He,{noCollect:!0,options:o,defaultSelectValue:s,value:a,onChange:function(e){return t.onSelChange("selectValue",e)},triangle:"select"===l})),i&&Y().createElement(Ue,{options:e,limit:this.props.limit,value:r,onChange:function(e){return t.onSelChange("sortSelectValue",e)},triangle:"sortSelect"===l}),i&&Y().createElement("div",{className:"footer",onClick:function(e){return t.stop(e)}},0<o.length&&Y().createElement("div",{className:"control"},Y().createElement(G.Button,{type:"primary",disabled:!o.length||!e.length||!a.id,onClick:function(){t.copyVal=t.getValue(),t.cancel(),t.props.onChange&&t.props.onChange(t.getValue())}},"确定"),Y().createElement("span",{className:"cancel",onClick:function(){t.setState({selectValue:t.copyVal?{id:t.copyVal[0].id,name:t.copyVal[0].name}:{},sortSelectValue:t.copyVal&&t.copyVal[0].values?t.copyVal[0].values:[]}),t.cancel()}},"取消")))))))},e}(J.Component);const Je=function(e){var t=e.searchInfo,n=e.onInput,a=e.onClose,e=Y().useState(!0),r=e[0];e[1];return Y().createElement("div",{className:"filter-search-wrap"},Y().createElement("div",{className:"search"},Y().createElement("span",null,Y().createElement("i",{className:"icon-cem_search"}),Y().createElement("span",null,t.name+":")),Y().createElement("input",{placeholder:"请输入搜索词",autoFocus:!0,value:t.keyword,onInput:function(e){return r&&n(e)}})),Y().createElement("i",{className:"icon-cem_delete del",onClick:a}))},ze=function(t){function e(e){var a=t.call(this,e)||this;return a.inputChange=function(e){a.setState({inputVal:e.target.value})},a.keywordChange=function(e){var t=a.state,n=t.inputVal,t=t.inputValMap;"keydown"===e.type&&13===e.keyCode||"keydown"===e.type&&32===e.keyCode||"blur"===e.type?n.trim()&&(t.push(n.trim()),a.setState({inputValMap:t,inputVal:""}),a.onChange()):"keydown"===e.type&&8===e.keyCode||e.type},a.delKeyWords=function(e){var t=a.state.inputValMap;t.splice(e,1),a.setState({inputValMap:t},function(e){return a.onChange()})},a.onChange=function(){a.props.onChange&&a.props.onChange(a.state.inputValMap)},a.state={inputValMap:e.values||[],inputVal:""},a}i()(e,t);var n=e.prototype;return n.UNSAFE_componentWillReceiveProps=function(e,t){e.values&&this.setState({inputValMap:e.values})},n.render=function(){var n=this,e=this.state,t=e.inputValMap,a=e.inputVal,r=this.props,e=r.style,r=r.close;return Y().createElement("div",{className:"word-segmentation",style:e||{}},r&&Y().createElement("i",{className:"close",onClick:r},"×"),Y().createElement("div",{className:"input-wrap"},Y().createElement("input",{type:"text",className:"keyword-setting",value:a,placeholder:"关键词(输入空格键或回车以分词)",onChange:this.inputChange,onBlur:this.keywordChange,onKeyDown:this.keywordChange})),t.map(function(e,t){return Y().createElement("span",{className:"word",key:e+t},e,Y().createElement("i",{onClick:function(){return n.delKeyWords(t)}},"×"))}))},e}(J.Component),Ze=function(t){function e(e){var r=t.call(this,e)||this;return r.handleChangeSel=function(e,t){r.props.screeningValuesChange({values:[{listDetail:e,values:t}],type:r.props.type})},r.renderCheckBox=function(t,e,n){var a=r.state.searchInfo;return Y().createElement(Be,{key:e,checkedList:n,data:t.list,changeState:function(e){return r.handleChangeSel(t,e)},searchKeywords:a.id===t.id?a.keyword:"",onSearch:function(){r.setState({searchInfo:{isSearching:!0,id:t.id,name:t.name,keyword:""}})},title:t.name})},r._handelKeywordChange=function(e){var t=r.state.searchInfo;r.setState({searchInfo:{isSearching:!0,id:t.id,name:t.name,keyword:e.target.value}})},r._handelKeywordClose=function(){return r.setState({searchInfo:{isSearching:!1,id:"",name:"",keyword:""}})},r.state={searchInfo:{isSearching:!1,id:"",name:"",keyword:""}},r}i()(e,t);var n=e.prototype;return n.renderRadio=function(t,e,n){var a=this;return Y().createElement(RadioPanel,{key:e,value:n,data:t.list,changeState:function(e){return a.handleChangeSel(t,e)},onSearch:function(e){},title:t.name})},n.renderCascade=function(t,e,n){var a=this;return Y().createElement(je,{left:-66,key:e,list:t.list,value:n,onChange:function(e){return a.handleChangeSel(t,e)},name:t.name})},n.renderWordSegmentation=function(t,e,n){var a=this;return Y().createElement("div",{className:"key-word-wrap",key:e},Y().createElement("span",{className:"title"},t.name),Y().createElement(ze,{style:{width:"calc(100% - 108px)"},values:n,onChange:function(e){return a.handleChangeSel(t,e)}}))},n.componentDidMount=function(){},n.render=function(){var a=this,e=this.props.screeningList,t=this.state.searchInfo;return Y().createElement("div",{className:"screening_view"},Y().createElement("div",{className:"screening"},t.isSearching&&Y().createElement(Je,{searchInfo:t,onInput:this._handelKeywordChange,onClose:this._handelKeywordClose}),e.map(function(t,e){var n=a.props.screeningValues.filter(function(e){return e.id===t.id})[0]?a.props.screeningValues.filter(function(e){return e.id===t.id})[0].values:[];switch(t.type){case"checkbox":return a.renderCheckBox(t,e,n);case"cascade":return a.renderCascade(t,e,n);case"keywords":return a.renderWordSegmentation(t,e,n);default:return null}})))},e}(Y().Component),qe=function(n){function e(e){var t=n.call(this,e)||this;return t.onConfirm=function(){t.props.handelChange(),t.props.handelChangeShow(!1)},t.onCancel=function(){t.props.handelChangeShow(!1)},t.clearAllValues=function(){t.props.clearAllValues({type:t.props.type})},t.state={},t}return i()(e,n),e.prototype.render=function(){var e=this.props,e=(e.handelChangeShow,e.screeningValues);return Y().createElement("div",{className:"screening_wrap_view"},Y().createElement(Ze,this.props),Y().createElement(We,{onConfirm:this.onConfirm,onCancel:this.onCancel,clearAllValues:this.clearAllValues,screeningValues:e}))},e}(Y().Component),Ye=function(e){function t(){return e.apply(this,arguments)||this}return i()(t,e),t.prototype.render=function(){var e=this.props,t=e._handelClick,n=e.select,a=e.name,e=e.style;return Y().createElement("div",{className:"HeaderButton",style:e||{}},Y().createElement("div",{className:n?"sel wrap":"wrap",onClick:function(){return t()}},Y().createElement("i",{className:"icon-cem_screen"}),Y().createElement("span",null,a),Y().createElement("i",{className:"icon-cem_pull-down-or-take-up",style:{transform:n?"rotate(180deg) translateY(-1px)":""}})))},t}(Y().PureComponent);var Ge=U(77131);function Ke(e,t,n){return f.h.post("/default/value/update",{key:e,projectId:t,value:n})}var Qe=U(97189),Xe="empty";const $e=function(t){function e(e){var c=t.call(this,e)||this;return c.getSelectedFilterObj=function(){return c.state.selFilterObj},c._handleListSelect=function(e,t){e.stopPropagation(),c.props.onFilterChange(t),c.setState({selFilterObj:t})},c._handleListStar=function(e,t,n){e.stopPropagation(),c.lastStaredSaveId=t;var a=c.state,r=a.staredFilterId,s=a.savedKey,i=a.projectId,a=a.staredFilterIndex;r!==t?(-1!==a&&(a=document.querySelectorAll(".saved-condition-list .star")[a].children[1],(0,Qe.removeClass)(a,"star-active")),(0,Qe.addClass)(e.target.parentNode,"star-active")):(0,Qe.removeClass)(e.target.parentNode,"star-active"),c.setState({staredFilterIndex:n,staredFilterId:r===t?Xe:t},function(){Ke(s,i,c.state.staredFilterId).then(function(e){2e4!==e.data.code&&c.setState({staredFilterId:c.lastStaredSaveId})})})},c._handleOnEditClick=function(e,t){e.stopPropagation(),c.refs.saveNameInput.refs.input.value=t.name,c.setState({targetFilterObj:t,editDialogVisible:!0})},c._handleConfitionSaveConfirm=function(){var e=c.state,r=e.selFilterObj,s=e.projectId,i=e.targetFilterObj,e=c.props,l=e.model,o=e.onFilterRename;e=i.id,f.h.post("/filter/find/save",{id:e}).then(function(e){var t,n,a=e.data;2e4===a.code&&(t=c.refs.saveNameInput.refs.input.value,i.id===r.id&&o&&o(t),n=!1,e=i.id,a=a.result.selected,f.h.post("/filter/add",{name:t,copy:n,type:l,id:e,projectId:s,selected:a}).then(function(e){2e4===e.data.code&&(v.Z.success("修改成功"),c.setState({editDialogVisible:!1}),c.refresh(r.id))}))})},c._handleOnDeleteClick=function(e,t){e.stopPropagation(),c.setState({targetFilterObj:t,delDialogVisible:!0})},c._handleOnDeleteConfirm=function(e){e.stopPropagation();var t=c.state,n=t.targetFilterObj,a=t.savedKey,r=t.projectId,s=t.staredFilterId,e=t.filterList,i=t.selFilterObj,t=[(t=n.id,f.h.post("/filter/delete",{id:t,menuModel:{}}))];s===n.id&&t.push(Ke(a,r,Xe)),Promise.all(t).then(function(e){2e4===e[0].data.code&&c.refresh(n.id===i.id?void 0:i.id)}),n.id===i.id&&c.props.onFilterChange(e[0])},c.renderDeleteDialog=function(){var e=c.state,t=e.selFilterObj,e=e.targetFilterObj;return Y().createElement("div",{onMouseLeave:function(e){return e.stopPropagation()}},Y().createElement(G.Dialog,{title:"删除",className:"delete-saved-confition-dialog",size:"tiny",modal:!1,visible:c.state.delDialogVisible,onMouseLeave:function(e){return e.stopPropagation()},onCancel:function(e){return c.setState({delDialogVisible:!1})}},Y().createElement(G.Dialog.Body,null,Y().createElement("span",null,e&&t&&t.id===e.id?"删除该筛选器后，当前页面的筛选器将自动切换为”全部数据（默认）”筛选器，是否删除？":'是否删除"'+e.name+'"筛选器？')),Y().createElement(G.Dialog.Footer,null,Y().createElement(G.Button,{type:"primary",onClick:c._handleOnDeleteConfirm},"确定"),Y().createElement(G.Button,{type:"default",onClick:function(e){return c.setState({delDialogVisible:!1})}},"取消"))))},c.renderEditDialog=function(){return Y().createElement("div",{onMouseLeave:function(e){return e.stopPropagation()}},Y().createElement(G.Dialog,{title:"修改名称",className:"filter-save-name-dialog",size:"tiny",modal:!1,visible:c.state.editDialogVisible,onCancel:function(e){return c.setState({editDialogVisible:!1})}},Y().createElement(G.Dialog.Body,null,Y().createElement(G.Input,{className:"name-input",placeholder:"请输入名称",ref:"saveNameInput"})),Y().createElement(G.Dialog.Footer,null,Y().createElement(G.Button,{type:"primary",onClick:c._handleConfitionSaveConfirm},"确定"),Y().createElement(G.Button,{type:"default",onClick:function(e){return c.setState({editDialogVisible:!1})}},"取消"))))},c.state={projectId:I.t.get(I.V.curProject).id,savedKey:e.model+"_SAVED_OBJ",filterList:void 0,selFilterObj:void 0,targetFilterObj:{},staredFilterId:Xe,staredFilterIndex:-1,isEditing:!1,delDialogVisible:!1,editDialogVisible:!1},c}i()(e,t);var n=e.prototype;return n.componentDidMount=function(){},n.componentDidUpdate=function(e,t){this.state.filterList;this.props.show===e.show||this.props.show||this.setState({isEditing:!1,fullListShow:!1})},n.componentWillUnmount=function(){},n.refresh=function(i){var l=this,e=this.state,t=e.savedKey,n=e.projectId,a=(e.staredFilterId,this.props),e=a.model,o=(a.onFilterChange,a.shouldShowDefault),c=void 0,e=f.h.post("/filter/list",{type:e,projectId:n}),n=f.h.post("/default/value/find",{key:t,projectId:n});return Promise.all([e,n]).then(function(e){var t,n,a,r,s=e[0].data;2e4===s.code&&(t=s.result.all).unshift({id:"default",name:"全部数据（默认）"});e=e[1].data;return 2e4===e.code&&(n=e.result||Xe,a=o?-1:t.findIndex(function(e){return e.id===n}),i&&(r=t.findIndex(function(e){return e.id===i})),c=r?t[r]:-1===a?t[0]:t[a]),l.setState({delDialogVisible:!1,selFilterObj:c,staredFilterIndex:a,filterList:t,staredFilterId:n,fullListShow:15<t.length&&l.state.fullListShow}),c})},n.render=function(){var a=this,e=this.state,t=e.filterList,r=e.selFilterObj,s=e.staredFilterId,i=e.isEditing,e=this.props,e=(e.onFilterChange,e.show),t=t?JSON.parse(JSON.stringify(t)):[];return Y().createElement("div",{className:"saved-condition-wrapper",style:{display:e?"block":"none",width:2<t.length?"728px":1<t.length?"486px":"278px"}},Y().createElement("div",{className:"saved-condition-list"},Y().createElement("p",{className:"saved-condition-tip"},"提示：通过筛选器可提高图表查看效率"),Y().createElement("ul",null,t.map(function(t,n){return Y().createElement("li",{className:i?"editing":"star",key:i?"edit"+n:"star"+n,onClick:function(e){return a._handleListSelect(e,t)}},Y().createElement("span",{className:r&&r.id===t.id?"active":""},Y().createElement("i",{className:"radio"}),Y().createElement("span",null,t.name)),"default"!==t.id&&Y().createElement("span",{className:"edt-active tool"},Y().createElement(K.Z,{placement:"top",overlay:s===t.id?"取消默认":"设为默认"},Y().createElement("span",{className:s===t.id?"star-active":"",onClick:function(e){return a._handleListStar(e,t.id,n)}},Y().createElement("i",{className:s===t.id?"icon-cem_star":"icon-cem_star-line"}))),Y().createElement(K.Z,{placement:"top",overlay:"重命名"},Y().createElement("span",{onClick:function(e){return a._handleOnEditClick(e,t)}},Y().createElement("i",{className:"icon-cem icon-cem_screening-editor"}))),Y().createElement(K.Z,{placement:"top",overlay:"删除"},Y().createElement("span",{onClick:function(e){return a._handleOnDeleteClick(e,t)}},Y().createElement("i",{className:"icon-cem icon-cem_delete"})))))}))),this.renderDeleteDialog(),this.renderEditDialog())},e}(Y().Component),et=function(n){function e(e){var t=n.call(this,e)||this;return t.showSaveDialog=function(e){return t.setState({saveVisible:!0,dialogType:e})},t.hideSaveDialog=function(){return t.setState({saveVisible:!1})},t.state={saveVisible:!1,nameValue:"",dialogType:""},t}return i()(e,n),e.prototype.render=function(){var t=this,e=this.props,n=e.selSaveInfo,a=e.handleSaveScreen,r=this.state,e=r.saveVisible,s=r.nameValue,i=r.dialogType;return Y().createElement("div",{className:"button-zone"},Y().createElement("div",null,Y().createElement("span",{className:"modified"},"已修改"),"default"===n.id?Y().createElement("a",null,Y().createElement("span",{className:"save",onClick:function(){return t.showSaveDialog("save")}},"保存为筛选器")):Y().createElement("span",{className:"save",onClick:function(){return a({type:"update"})}},"更新筛选器"),n&&"default"!==n.id&&Y().createElement("div",{className:"more-zone"},Y().createElement("span",{className:"more"},Y().createElement("i",{className:"icon-cem icon-cem_more"})),Y().createElement("div",{className:"more-list"},Y().createElement("div",{className:"li-item",onClick:function(){return t.showSaveDialog("saveOther")}},"另存为筛选器")))),Y().createElement(G.Dialog,{title:"save"===this.state.dialogType?"保存筛选条件":"筛选条件另存为",className:"filter-save-name-dialog",size:"tiny",modal:!1,visible:e,onCancel:this.hideSaveDialog},Y().createElement(G.Dialog.Body,null,Y().createElement(G.Input,{className:"name-input",placeholder:"请输入名称",value:s,onChange:function(e){return t.setState({nameValue:e})}})),Y().createElement(G.Dialog.Footer,null,Y().createElement(G.Button,{type:"primary",onClick:function(){return a({type:i,name:s})}},"确定"),Y().createElement(G.Button,{type:"default",onClick:this.hideSaveDialog},"取消"))))},e}(Y().Component);var t=U(18446),tt=U.n(t),nt=function(t){function e(e){var a=t.call(this,e)||this;return a.handleDetailShow=function(){a.setState({isShow:!a.state.isShow})},a.competeInfoWidth=function(){var t,e,n;a.info&&(a.info.style.whiteSpace="nowrap",t=[],Array.from(a.info.getElementsByClassName("detail-info")).forEach(function(e){e.style.width="unset",t.push(e.clientWidth),e.style.width="calc(100% - 88px)"}),n=122,n+=700<(e=Math.max.apply(null,t))?700:e,a.info.style.whiteSpace="normal",a.info.style.width=n+"px")},a.state={isShow:!1},a}i()(e,t);var n=e.prototype;return n.componentDidMount=function(){var e=this;setTimeout(function(){e.competeInfoWidth()},0)},n.componentWillUnmount=function(){var e=this;setTimeout(function(){e.competeInfoWidth()},0)},n.render=function(){var t=this,e=this.props.value;return Y().createElement("div",{id:"info"},Y().createElement("span",{className:"detail",onMouseEnter:this.handelDetailShow},"详情"),!this.state.isShow&&Y().createElement("div",{className:"info-wrap",onMouseLeave:this.handelDetailShow},Y().createElement("div",null,"当前页面筛选条件"),e&&0<e.length?Y().createElement("ul",{ref:function(e){return t.info=e},id:"yt_info_ul"},e.map(function(n,e){return Y().createElement("li",{key:e},Y().createElement("div",{className:"name"},n.name),"aspect"===n.id?Y().createElement("div",{className:"detail-info"},0<n.values.length&&n.values.map(function(e,t){return Y().createElement("span",{key:t},e.id,0<e.values.length&&e.values.map(function(e,t){return Y().createElement("span",{key:t}," | ",e.name)}))})):Y().createElement("div",{className:"detail-info"},0<n.values.length&&n.values instanceof Array?n.values.slice(0,100).map(function(e,t){return Y().createElement("span",{key:t},e+(t===n.values.length-1?"":"，"))}):Y().createElement("span",null,n.values)))})):Y().createElement("div",{className:"noData"},"暂无筛选内容")))},e}(Y().Component),at={overview:"WAITER_SESSION_OVERVIEW",commodityAnalyze:"WAITER_SESSION_ASPECT",concernAnalyze:"WAITER_SESSION_PRODUCT",all:"MSG_WAITER_SESSION"};const rt=function(n){function e(e){var t=n.call(this,e)||this;return t.handelChangeShow=function(e){return t.setState({show:e===t.state.show?null:e})},t.handelTimeChange=function(e){t.props.dateValueChange({value:e}).then(function(){t.handelChangeShow(null),t.props.handelValueChange()})},t.state={show:e.defaultShow||null,saveFilterVisible:!1},t}i()(e,n);var t=e.prototype;return t.handleShowSave=function(e){this.saveScreen.setAttribute("class","enter"===e?"title sel":"title"),this.setState({saveFilterVisible:"enter"===e})},t.render=function(){var t=this,e=this.state.show,n=this.props,a=(n.title,n.dateFilter),r=n.handelValueChange,s=n.screeningMap,i=n.children,l=n.selSaveInfo,o=n.handleOnSaveBoxChange,c=n.handleSaveScreen,d=n.getsaveBoxRef,u=n.getTimeRef,m=n.getControlRef,p=n.type,h=n.detailInfo,n=this.state.saveFilterVisible;return Y().createElement("div",{className:"service_Filter_view",style:{height:i?"100%":""}},Y().createElement(G.Loading,{loading:void 0===s},Y().createElement("div",{className:"header_Filter_bar"},Y().createElement("div",{className:"title",ref:function(e){return t.saveScreen=e},onMouseEnter:function(){return t.handleShowSave("enter")},onMouseLeave:function(){return t.handleShowSave("leave")}},Y().createElement("span",null,"筛选器: "),Y().createElement("span",{className:"save_name"},l.name),Y().createElement("i",{className:"icon-cem_arrow-launches"}),Y().createElement($e,{ref:d,show:n,model:at[p],onFilterChange:o,onFilterRename:function(e){return o(e,"name")}})),"screening"===e&&l&&this.isScreeningChanged&&Y().createElement(et,{ref:m,selSaveInfo:l,handleSaveScreen:c}),Y().createElement(nt,{value:h}),Y().createElement(Ye,{name:this.time,_handelClick:function(){return t.handelChangeShow("time")},select:"time"===e}),Y().createElement(Ye,{name:"筛选",_handelClick:function(){return t.handelChangeShow("screening")},select:"screening"===e})),Y().createElement("div",null,"screening"===e&&Y().createElement(qe,j()({},this.props,{handelChangeShow:this.handelChangeShow,handelChange:r})),Y().createElement(Ge.Z,{ref:u,onChange:function(e){return t.handelTimeChange(e)},show:"time"===e,onCancel:function(){return t.handelChangeShow("time")},params:a}))),i&&Y().createElement("div",{className:"contentWrap"},void 0===s?Y().createElement(L.Z,null):i))},o()(e,[{key:"time",get:function(){var e="时间";return e=this.props.dateFilter&&this.props.dateFilter.from?this.props.dateFilter.quickChoice||this.props.dateFilter.from.replace(/-/g,"/")+"-"+this.props.dateFilter.to.replace(/-/g,"/"):e}},{key:"isScreeningChanged",get:function(){var e=this.props,t=e.selSaveInfo,e=e.screeningValues;return!tt()(t.screeningValues,e)}}]),e}(Y().Component);var st=U(51797),it=r.Z.serviceFilter,t=function(t){function e(e){var l=t.call(this,e)||this;return l.getAspect1=function(t){var n,e=l.props.screeningMap,a=null,r=null;return e.aspect&&(n=JSON.parse(e.aspect)[0],Object.keys(n).forEach(function(e){n[e].includes(t)&&(r=a=e)})),{id:a,name:r}},l.setDefaultValue=function(e){var t=l.props,n=t.screeningMap,a=(t.screeningList,t.type),r=[];if(e)return l.props.saveBoxChange({value:e,type:l.props.type}).then(function(){return l._handelValueChange()});function s(){r.push({id:"product",name:"分析商品",serverKey:"product",type:"radio",values:n.maxSessionProduct})}function i(){r.push({id:"aspect",name:"关注点",serverKey:"aspect",type:"cascade",values:[{id:n.maxSessionAspect,name:n.maxSessionAspect,values:[]}]})}l.props.value&&l.props.value.length?(r=JSON.parse(JSON.stringify(l.props.value)),l.props.value.some(function(e){return"product"===e.id})||"commodityAnalyze"!==a||s(),l.props.value.some(function(e){return"aspect"===e.id})||"concernAnalyze"!==a?l.props.value.some(function(e){return"aspect"===e.id})&&!l.props.value.filter(function(e){return"aspect"===e.id})[0].values[0].id&&l.props.value.filter(function(e){return"aspect"===e.id})[0].values[0].values[0].id&&(r=r.filter(function(e){return"aspect"!==e.id}),t=l.props.value.filter(function(e){return"aspect"===e.id})[0].values[0].values[0].id,t=(e=l.getAspect1(t)).id,e=e.name,r.push({id:"aspect",name:"关注点",serverKey:"aspect",type:"cascade",values:[{id:t,name:e,values:l.props.value.filter(function(e){return"aspect"===e.id})[0].values[0].values}]})):i()):("commodityAnalyze"===a&&s(),"concernAnalyze"===a&&i()),l.props.saveValue({value:r,type:l.props.type}).then(function(){l._handelValueChange(l.props.onFilterReady)})},l._handleOnSaveBoxChange=function(e,t){l.props.saveBoxChange({value:e,type:l.props.type,key:t}).then(function(){return t!==it&&l._handelValueChange()})},l.competeInfoWidth=function(){var t,e,n;document.getElementById("yt_info_ul")&&(document.getElementById("yt_info_ul").style.whiteSpace="nowrap",t=[],Array.from(document.getElementById("yt_info_ul").getElementsByClassName("detail-info")).forEach(function(e){e.style.width="unset",t.push(e.clientWidth),e.style.width="calc(100% - 88px)"}),n=122,n+=700<(e=Math.max.apply(null,t))?700:e,document.getElementById("yt_info_ul").style.whiteSpace="normal",document.getElementById("yt_info_ul").style.width=n+"px")},l._handelValueChange=function(e){l.props.saveDetailInfoValue({value:JSON.parse(JSON.stringify(l.props.screeningValues))});var t=[{filterModel:j()({},(0,st.bp)(l.props.screeningValues)),dateFilter:l.props.dateFilter},l.props.screeningValues];e?e(t[0],t[1]):l.props.onChange&&l.props.onChange(t[0],t[1]),setTimeout(function(){l.competeInfoWidth()},0)},l._handleSaveScreen=function(e){var t=e.type,e=e.name;l.props.saveScreening({type:t,name:e,model:l.props.type}).then(function(e){l.saveBoxRef.refresh(e.id)})},l.state={},l._event={handelValueChange:l._handelValueChange,handleOnSaveBoxChange:l._handleOnSaveBoxChange,handleSaveScreen:l._handleSaveScreen,getsaveBoxRef:function(e){return l.saveBoxRef=e},getTimeRef:function(e){return l.timeRef=e},getControlRef:function(e){return l.controlRef=e}},l}i()(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;this.props.screeningMap?(this.props.clearAllValues({type:this.props.type}),Promise.all([this.timeRef.fetchDefaultValue(),this.saveBoxRef.refresh()]).then(function(e){t.setDefaultValue("default"===e[1].id?"":e[1])})):Promise.all([this.props.fetchScreeningMap({type:this.props.type}),this.timeRef.fetchDefaultValue(),this.saveBoxRef.refresh()]).then(function(e){t.props.dateValueChange({value:e[1]}).then(function(){return t.setDefaultValue("default"===e[2].id?"":e[2])})})},n.render=function(){return Y().createElement(rt,j()({},this.state,this._event,this.props))},e}(Y().Component);t.propTypes={onChange:n().func,onFilterReady:n().func,type:n().string,value:n().array};const lt=(0,s.connect)(function(e){var t=e.loading,e=a()(e,["loading"]);return j()({},e[it],{fetchingScreeningMap:t.effects[it+"/fetchScreeningMap"]||!1})},function(t){return{fetchScreeningMap:function(e){return t({type:it+"/fetchScreeningMap",payload:e})},saveBoxChange:function(e){return t({type:it+"/saveBoxChange",payload:e})},saveScreening:function(e){return t({type:it+"/saveScreening",payload:e})},screeningValuesChange:function(e){return t({type:it+"/screeningValuesChange",payload:e})},dateValueChange:function(e){return t({type:it+"/dateValueChange",payload:e})},clearAllValues:function(e){return t({type:it+"/clearAllValues",payload:e})},saveValue:function(e){return t({type:it+"/saveValue",payload:e})},saveDetailInfoValue:function(e){return t({type:it+"/saveDetailInfoValue",payload:e})}}},null,{withRef:!0})(t),ot=function(e){function t(){return e.apply(this,arguments)||this}return i()(t,e),t.prototype.render=function(){var e=this.props,t=e.canRenderFilter,n=e.filterReady,a=e.filterValue,r=e.onFilterReady,s=e.onFilterChange,i=e.curSelectMessage,l=e.onInboxClick,o=e.onMessageDownload,c=e.onServiceMessageDownload,d=e.MODEL,u=void 0===d?"":d,m=e.total,p=e.messageType,h=e.filterTip,g=e.outsideFilter,f=e.model,v=e.highLightWordList,E=e.hightLightTagsList,y=e.handleTagsClick,S=e.harmonyEvent,C=e.serviceCustomerType,N=e.unreducedFilter,w=e.reducedFilter,_=e.showKind,d=["CONN_CONFIG","MESSAGE_RELATION","TAG","DIMENSION","BRAND_SERIES"],e=["fullDate","screening","save","contentSearch"];return"SERVICE"===p&&e.push("sourceSearch","usernameSearch"),"SOCIAL"===p&&d.push("MESSAGE_USER"),(!p||"QUE_ANS"===p||"BBS"===p||"SOCIAL"===p||"SELF"===p||"NEWS"===p||"COMPLAINT"===p||g&&g.filterModel.vocAspect)&&d.push("ALL_ASPECT","VOC_ASPECT"),"PERSONAL"!==f&&"ARCHIVE"!==f&&"FOLDER"!==f&&(0,z.PM)(p)?Y().createElement("div",{className:"inbox_wrap"},Y().createElement(T.Z,{onReady:r,onChange:s,pageType:(0,z.PM)(p),noSavingFilterList:!0,reducedScreenValue:w,screenValue:g&&g.headerFilterParamsNew,dateValue:g&&g.dateFilter,advanceAuthority:!["QUESTIONAIRE","SERVICE"].includes(p),contentValue:g&&g.filterModel.content&&g.filterModel.queryType&&[{contain:g.filterModel.content[0].contain,queryType:g.filterModel.queryType}],isExplore:!(!h||"数据探索/自由探索/热词"!==h),showList:e,hasHour:!0},h&&!N||h&&!N.length&&Y().createElement("div",{className:"msg_filter_tip"},Y().createElement("i",{className:"icon-cem_warning"}),"依据「",h,"」查看原文功能查询出以下内容"),!h&&null!==h&&location&&location.search&&!N&&Y().createElement("div",{className:"msg_filter_tip"},Y().createElement("i",{className:"icon-cem_warning"}),"由图表数据点下钻查出以下内容"),"screening"===_&&N&&N.length?Y().createElement(Fe,{unreducedFilter:N}):null,n&&Y().createElement("div",{className:"msg_list_wrap "+(h||!h&&null!==h&&location&&location.search&&!N?"with_tip":"")},Y().createElement(Pe,j()({},this.props,{onMessageDownload:o,onInboxClick:l}))),n&&Y().createElement("div",{className:"msg_detail_wrap "+(h||!h&&null!==h&&location&&location.search&&!N?"with_tip":"")},Y().createElement(_e,{data:i,modelType:u,isEmpty:0===m,highLightWordList:v,hightLightTagsList:E,handleTagsClick:y,harmonyEvent:S,serviceCustomerType:C})),!n&&Y().createElement(L.Z,null))):Y().createElement("div",{className:"inbox_wrap"},t&&"SERVICE"===p?Y().createElement(lt,{onChange:s,type:"all",value:a,onFilterReady:r}):t&&Y().createElement(k.Z,{values:a,model:"INBOX",showList:["condition","time","save"],filterCondition:{filter:d,filterConfig:["EMOTION","ESCORE","WEIBA","CHAOHUA","TOPICS","MULTI_KEY_WORD","USEFUL_DATA","BUSINESS_TYPE"],messageRelationConfig:{unshow:p?["messageCategory"]:[]}},onFilterReady:r,onChange:s,saveFilterListShow:I.V.messageFilterListSave,useHourSelect:!0}),h&&Y().createElement("div",{className:"msg_filter_tip"},Y().createElement("i",{className:"icon-cem_warning"}),"依据「",h,"」查看原文功能查询出以下内容"),n&&Y().createElement("div",{className:"msg_list_wrap del_old_msg "+(h?"with_tip":"")},Y().createElement(Pe,j()({},this.props,{onMessageDownload:o,onServiceMessageDownload:c,onInboxClick:l}))),n&&Y().createElement("div",{className:"msg_detail_wrap del_old_msg "+(h?"with_tip":"")},Y().createElement(_e,{data:i,modelType:u,isEmpty:0===m,highLightWordList:v,hightLightTagsList:E,handleTagsClick:y,harmonyEvent:S,serviceCustomerType:C,filterValue:a})),!n&&Y().createElement(L.Z,null))},t}(J.Component);var ct=r.Z.inbox,dt=r.Z.IDBHeaderScreening.screening,ut=r.Z.IDBHeaderScreening.headerScreening,mt=r.Z.public.menu,r=function(r){function e(e){var i=r.call(this,e)||this;i._handelFilterReady=function(e){var t,n,a=i.state.outsideFilter,r=i.props.curScreeningMap,s=[];a&&(a&&a.filterValues&&a.filterValues.length&&a.filterValues.forEach(function(a){r.find(function(e){return e.id===a.id})?r.filter(function(e){return e.id===a.id}).forEach(function(n){a.values.forEach(function(t){var e;n.data.find(function(e){return e.id===t.id})?(e=n.data.find(function(e){return e.id===t.id}).options,t.values.forEach(function(t){(t.label?e.find(function(e){return e.label===t.label}):e.find(function(e){return e.label===t}))||s.push.apply(s,a.values)})):s.push.apply(s,a.values)})}):s.push.apply(s,a.values)}),(a&&a.topic1Names&&a.topic1Names.length||a&&a.topic2Names&&a.topic2Names.length)&&(t=a.topic1Names,n=a.topic2Names,t&&s.push({id:"话题分类",label:"话题分类",values:t}),n&&s.push({id:"话题",label:"话题",values:n})),i.setState({unreducedFilter:s.map(function(e){return{id:e.id,label:e.label,values:e.values.some(function(e){return e.label})?e.values.map(function(e){return e.label}):e.values}})},function(){var e;i.state.unreducedFilter&&i.state.unreducedFilter.length&&a&&a.headerFilterParamsNew&&a.headerFilterParamsNew.length&&((e=JSON.parse(JSON.stringify(a.headerFilterParamsNew)).filter(function(e){return-1<r.map(function(e){return e.id}).indexOf(e.id)})).length&&(e=e.map(function(t){return j()({},t,{values:t.values.filter(function(e){return-1<r.find(function(e){return e.id===t.id}).data.map(function(e){return e.id}).indexOf(e.id)})})})).length&&i.setState({reducedFilter:e.map(function(n){return j()({},n,{values:n.values.map(function(t){return j()({},t,{values:t.values.filter(function(e){return-1<r.find(function(e){return e.id===n.id}).data.find(function(e){return e.id===t.id}).options.map(function(e){return e.id}).indexOf(e.id||e)})})})})})}))})),i.props.filterReady({filterValue:i.state.outsideFilter||e,messageType:i.props.messageType,model:i.props.model,smartFolderId:i.props.folderId})},i._handelFilterChange=function(e){i.props.filterChange({filterValue:e})},i._handelSortTypeChange=function(e){i.props.sortTypeChange({value:e})},i._handelMessageDownload=function(e){return i.props.downloadMessage(e)},i._handleServiceMessageDownload=function(e){return i.props.downloadServiceMessage(e)},i._handelInboxClick=function(e){var t=i.props,n=t.inboxClick,a=t.MODEL,t=t.fetchPersonalCount;n(e),"PERSONAL"!==a&&"FOLDER"!==a||0!==e.status||t()},i._harmonyEvent=function(e,t,n){var a=i.props,r=a.hightLightTagsList,a=a.highLightWordList,a=n&&r&&0<r.length?r:a;Array.isArray(a)&&t&&0<t.length&&(a=a.concat(t));var s=e&&e.replace(/ on.*?=/g," harmony=");return s&&a&&a.forEach(function(e){var t=e.includes("*")?e.replaceAll("*",""):e,e=new RegExp(t,"ig");s=s.replace(e,'<span style="background: #D2CE77">'+t+"</span>")}),s},i._handleTagsClick=function(e){i.props.getHightLightTags({tagId:e})};var t,n,a={};return-1===location.href.indexOf("/inbox/public")&&-1===location.href.indexOf("/inbox/service")||!location.search?-1!==location.href.indexOf("/inbox/public")||-1!==location.href.indexOf("/inbox/service")?a=I.t.getWidthProject(I.V.messageFilterValue,"session")||{}:void 0===e.model&&(a.filterModel={},a.filterModel.messageCategory=[e.messageType]):((t=JSON.parse(decodeURIComponent(location.search.substring(1)))).filterModel.project=[t.projectId],t.dateFilter&&(t.dateFilter.quickChoice=t.dateFilter.currSelector&&1===t.dateFilter.currSelector&&-1<t.dateFilter.quickChoice.indexOf("-")?t.dateFilter.quickChoice:t.dateFilter.from.replaceAll("-",".")+" - "+t.dateFilter.to.replaceAll("-",".")),t.projectId&&(n=I.t.get(I.V.project).filter(function(e){return e.id===t.projectId})[0],I.t.set(I.V.curProject,n)),delete t.projectId,n=a=t),i.state={outsideFilter:n,unreducedFilter:null,reducedFilter:null},setTimeout(function(){e.saveStorageFilterValue(a)},0),i._event={onFilterReady:i._handelFilterReady,onFilterChange:i._handelFilterChange,onSortTypeChange:i._handelSortTypeChange,onMessageDownload:i._handelMessageDownload,onServiceMessageDownload:i._handleServiceMessageDownload,onInboxClick:i._handelInboxClick,handleTagsClick:i._handleTagsClick,harmonyEvent:i._harmonyEvent},i}i()(e,r);var t=e.prototype;return t.componentDidUpdate=function(e,t){var n=e.screeningValues,a=this.props,e=a.screeningValues,r=a.curScreeningMap;JSON.stringify(n)!==JSON.stringify(e)&&(this.state.unreducedFilter&&this.state.unreducedFilter.length&&(e.length&&v.Z.error("不支持包含未还原的筛选条件查询"),this.setState({unreducedFilter:null})),e&&e.length?n||(e=e.filter(function(e){return-1<r.map(function(e){return e.id}).indexOf(e.id)})).length&&(e=e.map(function(t){return j()({},t,{values:t.values.filter(function(e){return"CUSTOMER_NAME"===e.id?e:-1<r.find(function(e){return e.id===t.id}).data.map(function(e){return e.id}).indexOf(e.id)})})})).length&&this.setState({reducedFilter:e.map(function(n){return j()({},n,{values:n.values.map(function(t){return j()({},t,{values:"COMMENT_LENGTH"===t.id||"CUSTOMER_NAME"===t.id?t.values:t.values.filter(function(e){return-1<r.find(function(e){return e.id===n.id}).data.find(function(e){return e.id===t.id}).options.map(function(e){return e.id}).indexOf(e.id||e)})})})})})}):this.state.reducedFilter&&this.setState({reducedFilter:null}))},t.componentWillUnmount=function(){this.props.clearData()},t.render=function(){return Y().createElement(ot,j()({},this.state,this.props,this._event))},e}(J.Component);const pt=(0,s.connect)(function(e){var t=e.loading,e=a()(e,["loading"]);return j()({},e[ct],{messageListFetching:t.effects[ct+"/fetchMessageList"]||!1,curScreeningMap:e[dt].curScreeningMap,screeningValues:e[dt].screeningValues,showKind:e[ut].showKind})},function(t){return{filterReady:function(e){return t({type:ct+"/filterReady",payload:e})},filterChange:function(e){return t({type:ct+"/filterChange",payload:e})},sortTypeChange:function(e){return t({type:ct+"/sortTypeChange",payload:e})},fetchMessageList:function(e){return t({type:ct+"/fetchMessageList",payload:e})},downloadMessage:function(e){return t({type:ct+"/downloadMessage",payload:e})},downloadServiceMessage:function(e){return t({type:ct+"/downloadServiceMessage",payload:e})},inboxClick:function(e){return t({type:ct+"/inboxClick",payload:e})},saveStorageFilterValue:function(e){return t({type:ct+"/saveStorageFilterValue",payload:e})},clearData:function(){return t({type:ct+"/clearData"})},fetchPersonalCount:function(){return t({type:mt+"/fetchPersonalCount"})},getHightLightTags:function(e){return t({type:ct+"/getHightLightTags",payload:e})}}})(r)},24473:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var a=n(67154),u=n.n(a),r=n(37316),m=n.n(r),t=n(85354),s=n.n(t),a=n(67294),p=n.n(a),r=n(45697),t=n.n(r),r=n(94184),h=n.n(r),a=function(e){function t(){return e.apply(this,arguments)||this}return s()(t,e),t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.children,a=e.className,r=e.block,s=e.indeterminate,i=e.value,l=e.checked,o=e.defaultChecked,c=e.onChange,d=e.disabled,e=m()(e,["prefixCls","children","className","block","indeterminate","value","checked","defaultChecked","onChange","disabled"]),c={value:i,checked:l,defaultChecked:o,onChange:c,disabled:d},a=h()(t,((d={})[t+"-disabled"]=c.disabled,d[t+"-block"]=r,d[t+"-indeterminate"]=s,d),a);return p().createElement("label",u()({tabIndex:c.disabled?-1:0,className:a},e),p().createElement("input",u()({type:"checkbox",className:t+"-input"},c)),p().createElement("span",{className:t+"-status"}),n&&p().createElement("span",{className:t+"-text",title:n},n))},t}(a.Component);a.propTypes={prefixCls:t().string,value:t().oneOfType([t().string,t().number]),checked:t().bool,defaultChecked:t().bool,onChange:t().func,indeterminate:t().bool,disabled:t().bool,block:t().bool},a.defaultProps={prefixCls:"wt-checkbox"};const i=a},85151:(e,t,n)=>{"use strict";n.d(t,{Jg:()=>a.Z,CS:()=>l});var a=n(24473),r=n(67154),o=n.n(r),s=n(37316),c=n.n(s),t=n(85354),i=n.n(t),r=n(67294),d=n.n(r),s=n(45697),t=n.n(s),s=n(94184),u=n.n(s),s=function(r){function e(){for(var n,e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(n=r.call.apply(r,[this].concat(t))||this).handleCheckBoxChange=function(e){var t=n.props.onChange;t&&t(e)},n}return i()(e,r),e.prototype.render=function(){var r=this,e=this.props,t=e.prefixCls,n=e.children,a=e.className,s=(e.onChange,e.values),i=e.checkedList,l=e.block,e=c()(e,["prefixCls","children","className","onChange","values","checkedList","block"]),n=s?s.map(function(e,t){var n=0!==i.length&&-1!==i.indexOf(e);return d().createElement(Checkbox,{key:t,value:e,checked:n,onChange:function(e){return r.handleCheckBoxChange(e)},block:l},e)}):d().Children.map(n,function(e,t){if(e){var n=e.props,a=n.value,a=0!==i.length&&-1!==i.indexOf(a);return d().cloneElement(e,{checked:a,key:t,block:n.block||l,onChange:function(){var e=n.value;r.handleCheckBoxChange(e)}})}});return d().createElement("div",o()({className:u()(t,a)},e),n)},e}(r.Component);s.defaultProps={prefixCls:"wt-checkbox-group"},s.propTypes={onChange:t().func,values:t().array,block:t().bool};const l=s;var m=function(t){var n={};return Object.keys(t).forEach(function(e){/^data\-.+$/.test(e)&&(n[e]=t[e])}),n},r=function(e){function t(){return e.apply(this,arguments)||this}return i()(t,e),t.prototype.render=function(){var e=this.props,t=m(e);return d().createElement("label",{className:e.className,title:e.children},d().createElement("div",{className:"checkbox"},d().createElement("input",o()({checked:e.checked,type:"checkbox",name:e.name,onChange:e.onChange,disabled:e.disabled},t)),d().createElement("div",{className:"checkbox-body"}))," ",d().createElement("span",null,e.children))},t}(r.Component);r.defaultProps={className:"",name:"",checked:!1,disabled:!1,onChange:function(e){return e}}},12234:(e,t,n)=>{"use strict";n.d(t,{l:()=>c});var a=n(67154),r=n.n(a),t=n(37316),s=n.n(t),a=n(85354),i=n.n(a),t=n(67294),l=n.n(t),a=n(94184),o=n.n(a),c=function(e){function t(){return e.apply(this,arguments)||this}return i()(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.name,e=s()(e,["className","name"]),t=o()("icon",["cem-"+n],t);return l().createElement("svg",r()({className:t},e),l().createElement("use",{xlinkHref:"#icon-cem-"+n}))},t}(t.Component)},66746:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var t=n(16049),u=n(1825),t=n(89858),m=n(51024),t=n(7940),p=n(31059),t=n(1025),h=n(65400),t=n(75314),i=n(11187),t=n(85354),a=n.n(t),t=n(67294),g=n.n(t),o=n(87219);const r=function(t){function e(e){var l=t.call(this,e)||this;return l.show=function(e){var t=e.aspectList,e=e.callback;l.setState({visible:!0,aspectList:t}),l.callback=e},l._handleOnClose=function(){l.setState({visible:!1,aspectList:void 0,moreChecked:!1,moreContent:[],errorChecked:!1,errorContent:[],lessChecked:!1,lessContent:"",lessTips:""},function(){l.callback=void 0})},l._handleOnConfigConfirm=function(){var e=l.state,t=e.moreChecked,n=e.moreContent,a=e.errorChecked,r=e.errorContent,s=e.lessChecked,i=e.lessContent,e=[];t&&n.length?e.push({feedbackType:"ASPECT_TOO_MANY",feedbackContent:JSON.stringify(n.filter(function(e){return e.escore}))}):e.filter(function(e){return"ASPECT_TOO_MANY"!==e.feedbackType}),a&&r.length?e.push({feedbackType:"EMOTION_WRONG",feedbackContent:JSON.stringify(r.filter(function(e){return e.escore}))}):e.filter(function(e){return"EMOTION_WRONG"!==e.feedbackType}),s?e.push({feedbackType:"ASPECT_NOT_ENOUGH",feedbackContent:i}):e.filter(function(e){return"ASPECT_NOT_ENOUGH"!==e.feedbackType}),l.callback&&l.callback(e),l._handleOnClose()},l._handleOnChange=function(e,t){var n;l.setState(((n={})[t+"Checked"]=e,n)),(t.includes("more")&&!e||t.includes("error")&&!e)&&l.state[t+"Content"]&&l.state[t+"Content"].length&&l.setState(((e={})[t+"Content"]=[],e))},l._handleOnInputChange=function(e){1e3===e.target.value.trim().length&&l.setState({lessTips:"最多输入1000字"}),l.setState({lessContent:e.target.value.trim().substring(0,1e3)})},l._handleOnClickAspect=function(t,n,e){var a=l.state,r=a.moreContent,a=a.errorContent,s="more"===e?r:a,r=(0,o.ZP)(s,function(e){return s.find(function(e){return JSON.stringify(e)===JSON.stringify({aspect:t,escore:n})})?(1===s.length&&i.default.warning("至少保留一个指标选项"),e.filter(function(e){return JSON.stringify(e)!==JSON.stringify({aspect:t,escore:n})})):void e.push({aspect:t,escore:n})});l.setState(((a={})[e+"Content"]=r,a))},l.callback=void 0,l.state={visible:!1,moreChecked:!1,moreContent:[],errorChecked:!1,errorContent:[],lessChecked:!1,lessContent:"",lessTips:"",aspectList:void 0},l}return a()(e,t),e.prototype.render=function(){var n=this,e=this.state,t=e.visible,a=e.moreChecked,r=e.moreContent,s=e.errorChecked,i=e.errorContent,l=e.lessChecked,o=e.aspectList,c=e.lessContent,d=e.lessTips;return g().createElement(u.Z,{title:"我要反馈",placement:"right",width:372,onClose:this._handleOnClose,visible:t,footer:g().createElement("div",{style:{float:"right"}},g().createElement(h.default,{onClick:this._handleOnClose},"取消"),g().createElement(h.default,{disabled:a&&s&&!l&&!r.length&&!i.length||a&&!s&&!l&&!r.length||s&&!a&&!l&&!i.length||!a&&!s&&!l,type:"primary",onClick:this._handleOnConfigConfirm},"确定"))},g().createElement("div",{className:"yt_aspect_feedback_drawer"},o&&o.length?g().createElement("div",{className:"item"},g().createElement(p.default,{checked:a,onChange:function(e){return n._handleOnChange(e.target.checked,"more")}},"多了指标"),g().createElement("div",{className:"feedback_content"},a&&o.map(function(t,e){return g().createElement("span",{key:e,className:8===t.escore?"positive":"negative",onClick:function(){return n._handleOnClickAspect(t.aspect2,t.escore,"more")}},g().createElement("i",{className:"icon-cem_big-gou",style:{display:r.find(function(e){return JSON.stringify(e)===JSON.stringify({aspect:t.aspect2,escore:t.escore})})?"inline":"none"}}),t.aspect2)}))):null,o&&o.length?g().createElement("div",{className:"item"},g().createElement(p.default,{checked:s,onChange:function(e){return n._handleOnChange(e.target.checked,"error")}},"情感有误"),g().createElement("div",{className:"feedback_content"},s&&o.map(function(t,e){return g().createElement("span",{key:e,className:8===t.escore?"positive":"negative",onClick:function(){return n._handleOnClickAspect(t.aspect2,t.escore,"error")}},g().createElement("i",{className:"icon-cem_big-gou",style:{display:i.find(function(e){return JSON.stringify(e)===JSON.stringify({aspect:t.aspect2,escore:t.escore})})?"inline":"none"}}),t.aspect2)}))):null,g().createElement(p.default,{checked:l,onChange:function(e){return n._handleOnChange(e.target.checked,"less")}},"少了指标"),l&&g().createElement("div",{className:"item"},g().createElement("p",null,"对应的文本或缺失指标说明"),g().createElement(m.default.TextArea,{className:d?"border_err":"",autoSize:{minRows:3,maxRows:13},placeholder:"请输入",onFocus:function(e){d&&n.setState({lessTips:""})},onBlur:function(e){d&&n.setState({lessTips:""})},maxLength:1e3,value:c,onChange:this._handleOnInputChange}),d&&g().createElement("div",{className:"tips"},d))))},e}(g().PureComponent)},84122:(e,t,n)=>{"use strict";n.d(t,{Ln:()=>r,YG:()=>d,Pl:()=>u,VG:()=>m,Rr:()=>p});var t=n(67154),s=n.n(t),t=n(67294),i=n.n(t),l=n(92360),o=n(5133);function a(e){l.MessageBox.confirm(i().createElement("span",null,"请先下载云听插件并安装，再进行操作!",i().createElement("br",null),"下载后刷新此页，",i().createElement("a",{href:e,target:"_black",style:{color:"#0747a6",textDecoration:"underline"}},"点这去下载"),"（",i().createElement("a",{href:"http://wiki.yuntingai.com/x/lgAB",target:"_black",style:{color:"#0747a6",textDecoration:"underline"}},"安装说明"),"）",i().createElement("br",null)),"提示",{type:"warning",confirmButtonText:"已完成下载"}).then(function(){window.location.reload()})}function c(n,e,a,r){(function t(){l.MessageBox.confirm(i().createElement("span",null,"请登录",e,"平台，再进行回复!",i().createElement("br",null),i().createElement("a",{href:a,target:"_black",style:{color:"#0747a6",textDecoration:"underline"}},"点这去登录")),"提示",{type:"warning",confirmButtonText:"已完成登录"}).then(function(e){n[r]().then(function(e){e.status||(t(),o.Z.warning("未检测到登录，请重新登录或联系管理员。"))})})})()}var r=function(t){new Promise(function(e,t){try{e(new YUNTING_OP_LOGIN)}catch(e){t(e)}}).then(function(e){t&&t(e)}).catch(function(e){a("https://yunting-1251101074.coscd.myqcloud.com/plugin/yunting-store.zip")})},d=function(t){new Promise(function(e,t){try{e(new YUNTINGPLUGIN)}catch(e){t(e)}}).then(function(e){t&&t(e)}).catch(function(e){a("https://yunting-1251101074.file.myqcloud.com/plugin/yunting.zip")})},u=function(t,n,a,r){return t.weibo.check().then(function(e){return e.status?t.weibo.reply(n.url,a).then(function(e){return e.status?r(s()({},e,{content:a,id:n.id,uid:n.uid})):o.Z.error(e.msg||"回复失败，请联系管理员")}):c(t,"微博","https://passport.weibo.cn/signin/login?entry=mweibo&yuntinglogin","weiboCheckLogin")})},m=function(t,n,a,r){return t.tieba.check().then(function(e){return e.status?t.tieba.reply(n.group,a).then(function(e){return e.status?r(s()({},e,{id:n.id,content:a})):o.Z.error(e.msg||"回复失败，请联系管理员")}):c(t,"百度贴吧","https://passport.baidu.com/v2/?login&yuntinglogin","tiebaCheckLogin")})},p=function(e,n,a,r){return e.zhihu.check().then(function(t){return t.status?e.zhihu.reply(n.zhihuId,a).then(function(e){return e.status?r(s()({},e,{id:n.id,img:t.avatar_url,uid:t.uid,username:t.name,userDesc:t.headline,userHome:t.url,content:a})):o.Z.error(e.message||"回复失败，请联系管理员")}):c(e,"知乎","https://www.zhihu.com/signin?yuntinglogin","zhihuCheckLogin")})}},29030:(e,t,n)=>{"use strict";n.d(t,{z:()=>a});var a={"百度知道":"bdzd","百度贴吧":"bdtb","八爪鱼":"bzy","nps问卷":"nps","科沃斯":"ecovacs","科沃斯官网":"ecovacs","科沃斯商城":"ecovacs","国美":"gm","京东":"jd","苏宁易购":"snyg","苏宁":"snyg","天猫":"tm","淘宝":"tb","唯品会":"wph","微信":"wx","公众号":"wx","微信公众号":"wx","新浪":"xl","新浪微博":"xl","微博":"xl","新浪新闻":"xlxw","小米商城":"xm","小米社区":"xm_bbs","亚马逊":"ymx","米家有品":"yp","知乎":"zh","百度":"bd","VIVO官网":"vivo","海信":"haixin","1号店":"yhd","创维":"chuangwei","欢太商城":"htsc","自定义":"custom","云听CEM":"nps","花粉俱乐部":"huawei","vivo社区":"vivo_bbs","coloros社区":"coloros_bbs","酒仙":"jx","一点资讯":"yd","小红书":"xhs","什么值得买":"smzdm",bilibili:"bilibili","今日头条":"jrtt","网易新闻":"wyxw","百度新闻":"bdxw","腾讯新闻":"txxw","抖音":"dy","新闻":"xw","聚投诉":"jts","黑猫投诉":"hmts","拼多多":"pdd","OPPO社区":"opposq","大众点评":"dzdp","微博评论":"xl","抖音小店":"douyin"}}}]);