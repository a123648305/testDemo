(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[4261],{68889:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>O});var t=n(37316),a=n.n(t),t=n(67154),l=n.n(t),t=n(85354),r=n.n(t),t=n(23279),i=n.n(t),t=n(67294),m=n.n(t),t=n(55609),c=n(61409),o=n(30133);const s=function(){return m().createElement("div",{className:"yt-aspect-warning-page-skeleton-wrapper"},m().createElement(o.Z,{paragraph:["30%","80%"]}),m().createElement("div",{className:"awp-skeleton-content"},m().createElement("div",{className:"awp-card-wrapper"},m().createElement("span",null,m().createElement(o.Z,null)),m().createElement("span",null,m().createElement(o.Z,null)),m().createElement("span",null,m().createElement(o.Z,null))),m().createElement("div",{className:"awp-list-warpper"},m().createElement("span",null,m().createElement(o.Z,null)),m().createElement("span",null,m().createElement(o.Z,null)),m().createElement("span",null,m().createElement(o.Z,null)))))};var h=n(55815),E=n(61918),f=n(33097),v=n(59762),u=n(92360),p=[{title:"全部",value:"READ_UNREAD"},{title:"待处理",value:"UNREAD"},{title:"已处理",value:"READ"}];const y=function(e){var t=e.onChange,n=m().useState(p[0].value),e=n[0],a=n[1];return m().createElement(u.Radio.Group,{value:e,onChange:function(e){a(e),t(e.split("_"))},className:"yt-radio-group-wrapper"},p.map(function(e){return m().createElement(u.Radio.Button,{value:e.value,key:e.value},e.title)}))};const C=function(e){return m().createElement("div",{className:"content-card-wrapper"},m().createElement("span",null,e.value),m().createElement("span",null,e.hint))};function d(e,t){var n=e-5-24-44-32-100;return console.log({lineWidth:n,contentWidth:e}),[{label:"",width:16},{label:"预警名称",prop:"title",width:.25*n,render:function(e,t,n){return m().createElement(g.Z,{overlay:(a=e,m().createElement("div",{style:{width:300,minHeight:180}},m().createElement("h3",null,"预警名称"),m().createElement("div",{style:{margin:"8px 0"}},a.title),m().createElement("h3",null,"预警说明"),m().createElement("div",{style:{margin:"8px 0"}},a.description),m().createElement("h3",null,"创建者"),m().createElement("div",{style:{margin:"8px 0"}},a.owner))),placement:"top"},m().createElement("span",{style:{cursor:"pointer"}},e.title));var a}},{label:"监测指标",width:.3*n,render:function(e,t,n){return m().createElement("span",null,""+e.analysisName+S[e.dateRangeType]+e.aspectName+N[e.calType])}},{label:"阈值",width:.125*n,prop:"warningData"},{label:"触发时间",width:.2*n,prop:"createdAt"},{label:"处理状态",width:.125*n,prop:"status",render:function(e,t,n){return m().createElement("span",{className:"READ"===e.status?"col-status-read":"col-status-unread"},b[e.status])}},{label:"操作",width:100,render:function(e){return m().createElement("span",{className:"col-control",onClick:function(){return t(e.warningLogId)}},"立即查看")}},{label:"",width:16}]}var g=n(43036),w=n(71339),N={PERCENT:"负面声量占比",NUMBER:"负面声量"},S={LAST_THREE_DAYS:"近3天",LAST_SENVEN_DAYS:"近7天",LAST_THIRTY_DAYS:"近30天",CURRENT_DAY:"当天",CURRENT_WEEK:"当周",CURRENT_MONTH:"当月"},b={READ:"已处理",UNREAD:"待处理"};const R=function(e){var t=e.option,n=t.width,a=t.height,t=e.onClick;return m().createElement("div",{className:"awp-warning-list",style:{height:a}},m().createElement(w.Z,l()({},e,{columns:d(n,t)})))};const W=function(e){var t=e.loading,n=e.contentWidth,a=e.data,l=a.unReadCount,r=a.readCount,i=a.total,c=a.list,o=e.analysis,s=e.aspect,u=e.pageIndex,p=e.pageSize,d=e.onListItemClick,g=e.onFilterObjectChange,a=e.projectId,e=e.statusList;return m().createElement("div",{className:"yt-aspect-warning-page-warpper"},m().createElement(h.Z,{title:"指标预警"}),m().createElement("div",{className:"page_content"},m().createElement("div",{className:"yt-awp-title-button-wrapper"},m().createElement(E.Z,{placeholder:"请输入预警名称",onSearch:function(e){return g({searchKey:e,pageIndex:1})}}),m().createElement(v.Z,{projectId:a,type:"OVERVIEW",defaultValue:JSON.parse(JSON.stringify(o)),onChange:function(e){JSON.stringify(e)!==JSON.stringify(o)&&g({analysis:JSON.parse(JSON.stringify(e))})}}),m().createElement(f.Z,{defaultValue:JSON.parse(JSON.stringify(s)),projectId:a,onChange:function(e){JSON.stringify(e)!==JSON.stringify(s)&&g({aspect:JSON.parse(JSON.stringify(e))})}}),m().createElement(y,{onChange:function(e){return g({statusList:e,pageIndex:1})}})),m().createElement("div",{className:"yt-awp-content-wrapper"},m().createElement("div",{className:"content-cards"},m().createElement(C,{value:l,hint:"近7天待处理预警"}),m().createElement(C,{value:r,hint:"近7天已处理预警"}),m().createElement(C,{value:i,hint:"近7天全部预警"})),m().createElement(R,{data:c,total:2===e.length?i:1===e.length&&e.includes("READ")?r:l,pageIndex:u,pageSize:p,loading:t,onClick:d,option:{width:n},onPageSizeChange:function(e){return g({pageSize:e,pageIndex:1})},onPageChange:function(e){return g({pageIndex:e})}}))))};const _=function(e){var t=e.initLoading,n=e.data;return m().createElement("div",{id:"awp-content",style:{height:"100%"}},t||!n?m().createElement(s,null):m().createElement(W,e))};var I=n(35239),n=n(64396),L=n.Z.aspectWarning,z=n.Z.public.menu,n=function(t){function e(e){var r=t.call(this,e)||this;return r._handleWindowResize=i()(function(){var e=document.getElementById("awp-content").clientWidth;r.setState({contentWidth:e})},150),r._handleOnListItemClick=function(t){var e=r.props,n=e.fetchaSpectWarningCount,a=e.aspectWarningCount,l=!1;"UNREAD"===e.data.list.find(function(e){return e.warningLogId===t}).status&&(n({aspectWarningCount:a-1}),l=!0),c.mW.push({pathname:"/aspectWarning/detail",state:{id:t,isRefreshUserState:l}})},r._handleOnFilterObjectChange=function(e){r.props.fetchWarningList(l()({},e))},r.aspectRef=void 0,r.state={contentWidth:0},r.event={onListItemClick:r._handleOnListItemClick,onFilterObjectChange:r._handleOnFilterObjectChange},r}r()(e,t);var n=e.prototype;return n.componentDidMount=function(){this.props.fetchWarningList({projectId:I.t.get(I.V.curProject).id}),window.addEventListener("resize",this._handleWindowResize),this._handleWindowResize()},n.componentWillUnmount=function(){window.removeEventListener("resize",this._handleWindowResize)},n.render=function(){return m().createElement(_,l()({},this.props,this.state,this.event))},e}(m().PureComponent);const O=(0,t.connect)(function(e){var t=e.loading,e=a()(e,["loading"]);return l()({},e[L].warningData.fetchParams,{projectId:e[L].projectId,data:e[L].warningData.data,initLoading:e[L].initLoading,loading:t.effects[L+"/fetchWarningList"]||!1,aspectWarningCount:e[z].aspectWarningCount})},function(t){return{fetchWarningList:function(e){return t({type:L+"/fetchWarningList",payload:e})},fetchaSpectWarningCount:function(e){return t({type:z+"/save",payload:e})}}})(n)},25022:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var t=n(67294),s=n.n(t),u=n(92360),p=n(35303),t=n(45697),t=n.n(t),d=[{label:"10项/页",value:10},{label:"20项/页",value:20},{label:"40项/页",value:40},{label:"100项/页",value:100}];const a=function(e){var t=e.onPageChange,n=e.onSizeChange,a=e.total,l=void 0===a?0:a,r=e.pageIndex,i=e.pageSize,c=e.layout,o=e.className,a=e.currLength,e=0===l?0:(r-1)*i+1,a=0===l?0:a?e+a-1:e+i-1;return 0===l?null:s().createElement("div",{className:"yt-awp-pagination "+(o||"")},s().createElement("span",{className:"total_num"},s().createElement("span",null,e+" - "+a+" "),"项，共",s().createElement("span",null," "+l+" "),"项"),s().createElement("div",{style:{textAlign:"right",float:"right"},className:"new_pagination"},s().createElement(u.Pagination,{small:!0,pageSize:i,currentPage:r,pageCount:Math.ceil(l/i),layout:0===l?"":"prev, pager, next",onCurrentChange:t}),void 0===c||c.includes("sizes")?s().createElement(p.RS,{multiple:!1,tags:!1,showSearch:!1,optionFilterProp:"label",optionLabelProp:"label",animation:"slide-up",dropdownClassName:"custom-pagination-dropdown",value:i||10,onChange:n},d.map(function(e,t){return s().createElement(p.Wx,{key:t,label:e.label,value:e.value},e.label)})):null))};t().propTypes={onPageChange:t().func,onSizeChange:t().func,total:t().number,pageIndex:t().number,pageSize:t().number,layout:t().string,className:t().string}},71339:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var t=n(67294),p=n.n(t),d=n(92360),g=n(25022),t=n(45697),n=n.n(t),t=function(e){var t=e.data,n=e.total,a=void 0===n?0:n,l=e.loading,r=e.pageIndex,i=e.columns,c=e.pageSize,o=e.onPageChange,n=e.onPageSizeChange,s=e.onSortChange,u=e.defaultSort,e=e.className,e=void 0===e?"":e;return p().useEffect(function(){var e=document.getElementsByClassName("is-sortable")[0];u&&e&&e.classList.add(u.order)},[u]),p().createElement("div",{className:"yt-awp-content-list "+e},p().createElement(d.Loading,{loading:l,className:"awp-content-loading"},p().createElement(d.Table,{defaultSort:u,columns:i,style:{width:"100%"},data:t,onSortChange:function(e){return s(e)}})),o&&p().createElement(g.Z,{onPageChange:o,onSizeChange:n,total:a,currLength:t.length,pageIndex:r,pageSize:c}))};t.propTypes={data:n().array,total:n().number,loading:n().bool,pageIndex:n().number,columns:n().array,pageSize:n().number,onPageChange:n().func,onPageSizeChange:n().func,onSortChange:n().func,defaultSort:n().any,className:n().string};const a=t},61918:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var t=n(67294),u=n.n(t),t=n(45697),n=n.n(t),t=function(e){var t=e.className,n=e.onClear,a=e.onSearch,l=e.placeholder,r=e.style,i=e.defValue,c=e.signal,e=u().useState(i),o=e[0],s=e[1];u().useEffect(function(){s(i)},[i,c]);return u().createElement("div",{style:r,className:"yt_search_input_wrapper "+(t||"")},u().createElement("input",{placeholder:l,value:o,onKeyDown:function(e){13===e.keyCode&&a(o)},onChange:function(e){return s(e.target.value)},autoComplete:"off"}),o&&u().createElement("i",{className:"icon-cem_log-off",onClick:function(){s(""),n&&n("")}}),u().createElement("i",{className:"icon-cem_small-search",onClick:function(){return a(o)}}))};t.propTypes={className:n().string,onSearch:n().func.isRequired,placeholder:n().string,style:n().object,defValue:n().string,signal:n().any,onClear:n().func};const a=t}}]);