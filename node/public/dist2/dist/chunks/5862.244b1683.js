(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[5862],{75862:(e,t,g)=>{"use strict";g.r(t),g.d(t,{default:()=>a});var t=g(85354),n=g.n(t),t=g(67294),f=g.n(t),h=g(92360),o=g(5133),r=g(36144),E=g(12518),v=g(12234),N=g(88308),S=g(5747),l=g(61193),a=function(i){function e(){for(var a,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(a=i.call.apply(i,[this].concat(t))||this).state={form:{title:"",slogan:""},rules:{slogan:{trigger:"blur"},title:{message:"请输入网页title",trigger:"blur"}},sideLogo:"images/yun_ting",loginLogo:"images/yunting_no_text",uploadPic:"",sideCropShow:!1,sideCropLoading:!1,loginCropShow:!1,loginCropLoading:!1,NPSCropShow:!1,NPSCropLoading:!1},a.loginCropConfirm=function(n){a.setState({loginCropLoading:!0},function(e){var t=window.location.hostname+"/-130_130.png",t={base64Code:n,fileName:t,type:"Account_Logo"},t=JSON.stringify(t);r.v.post("upload/head",t,{headers:{"Content-Type":"application/json"}}).then(function(e){var t=e.data.result+"?_="+(new Date).getTime(),n=l.Z.getUser();n.accountLogo=t,l.Z.register(n),o.Z.success(e.data.msg),a.setState({loginCropShow:!1,uploadPic:"",loginCropLoading:!1})})})},a.NPSCropConfirm=function(n){a.setState({NPSCropLoading:!0},function(e){var t=window.location.hostname+"/-130_130.png",t={base64Code:n,fileName:t,type:"NPS_LOGO"},t=JSON.stringify(t);r.v.post("upload/head",t,{headers:{"Content-Type":"application/json"}}).then(function(e){e.data.result,(new Date).getTime();o.Z.success(e.data.msg),a.setState({NPSCropShow:!1,uploadPic:"",NPSCropLoading:!1})})})},a.uploadIco=function(e){var a=e.target,e=new FileReader;e.readAsDataURL(a.files[0]),e.onload=function(e){var t=e.target.result,n=window.location.hostname+"/-64_64.ico",e=new FormData;e.append("base64Code",t),e.append("fileName",n);n={base64Code:t,fileName:n},n=JSON.stringify(n);a.value="",r.v.post("upload/web_title",n,{headers:{"Content-Type":"application/json"}}).then(function(e){document.querySelector("link[rel='shortcut icon']").setAttribute("href",e.data.result+"?_="+(new Date).getTime()),o.Z.success(e.data.msg)})}},a.faciconUploadFn=function(e){a.refs.faciconUpload.click()},a.sideLogoUploadFn=function(e){a.refs.sideLogoUpload.click()},a.loginLogoUploadFn=function(e){a.refs.loginLogoUpload.click()},a.NPSLogoUploadFn=function(e){a.refs.NPSLogoUpload.click()},a}n()(e,i);var t=e.prototype;return t.componentDidMount=function(){var n=this;r.h.get("/account/basic_info/list").then(function(e){var t={},e=e.data.result;e.slogan&&(t.slogan=e.slogan),n.setState({form:t}),n.onChange("title",e.webTitle)})},t.onChange=function(e,t){var n;this.setState({form:Object.assign(this.state.form,((n={})[e]=t,n))})},t.handleNameSubmit=function(t,n){var a=this,i=this.state.form;this.refs.form.validate(function(e){return!!e&&void a.setState({form:Object.assign(i,((e={})[t]=n,e))},function(e){"slogan"===t?r.h.post("/account/slogan/update",{slogan:i.slogan}).then(function(e){a.setState({sloganEditable:!1}),o.Z.info(e.data.msg)}):"title"===t&&r.h.post("/account/web_title/update",{webTitle:i.title}).then(function(e){a.setState({titleEditable:!1}),o.Z.info(e.data.msg),localStorage.setItem("cem-web-tile",i.title)})})})},t.sloganCancel=function(){this.setState({sloganEditable:!1,form:Object.assign(this.state.form,{slogan:this.state.slogan})})},t.titleCancel=function(){this.setState({titleEditable:!1,form:Object.assign(this.state.form,{title:this.state.title})})},t.startLoginCrop=function(e){var t=this,n=e.target,e=new FileReader;e.readAsDataURL(n.files[0]),e.onload=function(e){e=e.target.result;t.setState({uploadPic:e,loginCropShow:!0})}},t.startNPSCrop=function(e){var t=this,n=e.target,e=new FileReader;e.readAsDataURL(n.files[0]),e.onload=function(e){e=e.target.result;t.setState({uploadPic:e,NPSCropShow:!0})}},t.startSideCrop=function(e){var t=this,n=e.target,e=new FileReader;e.readAsDataURL(n.files[0]),e.onload=function(e){e=e.target.result;t.setState({uploadPic:e,sideCropShow:!0})}},t.sideCropConfirm=function(a){var i=this;this.setState({sideCropLoading:!0},function(e){var t=window.location.hostname+"/-128_45.png",n=new FormData;n.append("base64Code",a),n.append("fileName",t);t={base64Code:a,fileName:t},t=JSON.stringify(t);r.v.post("upload/head",t,{headers:{"Content-Type":"application/json"}}).then(function(e){var t=document.querySelector(".log_img"),n=e.data.result+"?_="+(new Date).getTime();t.setAttribute("src",n);t=l.Z.getUser();t.accountHead=n,l.Z.register(t),o.Z.success(e.data.msg),i.setState({sideCropShow:!1,uploadPic:"",sideCropLoading:!1})})})},t.render=function(){var t=this,e=this.state,n=e.sideLogo,a=e.loginLogo,i=e.sloganEditable,o=e.titleEditable,r=e.form,l=e.sideCropShow,s=e.sideCropLoading,c=e.loginCropShow,p=e.loginCropLoading,d=e.uploadPic,m=e.NPSCropShow,u=e.NPSCropLoading,e=document.documentElement.clientHeight-46-48-24;return f().createElement("div",{className:"flex-col common-wrapper"},f().createElement(E.Z,{title:"自定义设置"}),f().createElement("div",{className:"set-list common-padding-12"},f().createElement("div",{style:{minHeight:e,backgroundColor:"#fff"}},f().createElement(h.Form,{model:this.state.form,rules:this.state.rules,className:"inforForm",ref:"form",labelWidth:"200px",labelPosition:"left"},f().createElement(h.Form.Item,{label:"登录页面标语",prop:i?"slogan":""},f().createElement(N.Z,{id:"editSlogan",value:r.slogan,empty:!0,placeholder:"(无)",name:"slogan",confirm:function(e){return t.handleNameSubmit("slogan",e)}})),f().createElement(h.Form.Item,{label:"网页顶部标题",prop:o?"title":""},f().createElement(N.Z,{id:"editTitle",value:r.title,name:"title",confirm:function(e){return t.handleNameSubmit("title",e)}}))),f().createElement("div",{className:"desc"},f().createElement("p",null,f().createElement("span",{className:"desc-title"},"添加网页顶部图标"),f().createElement("span",null,"仅支持ico格式，文件小于1M")),f().createElement("div",{className:"side-logo logo-upload"},f().createElement("div",{onClick:this.faciconUploadFn,className:"bar"},f().createElement(v.l,{name:"add-to"}),"请上传图标"),f().createElement("div",{className:"example"},f().createElement("span",null,"示例:")," ",f().createElement("img",{src:g(25810)("./"+a+".png"),alt:""}))),f().createElement("p",null,f().createElement("span",{className:"desc-title"},"添加侧边栏标识"),f().createElement("span",null,"仅支持png格式，文件小于1M（矩形图），建议尺寸：186*45")),f().createElement("div",{className:"side-logo logo-upload"},f().createElement("div",{onClick:this.sideLogoUploadFn,className:"bar"},f().createElement(v.l,{name:"add-to"}),"请上传图片"),f().createElement("div",{className:"example"},f().createElement("span",null,"示例:")," ",f().createElement("img",{src:g(25810)("./"+n+".png"),alt:""}))),f().createElement("p",null,f().createElement("span",{className:"desc-title"},"添加登录/激活页面标识"),f().createElement("span",null,"仅支持png格式，文件小于1M（矩形图），建议尺寸：130*130")),f().createElement("div",{className:"login-logo logo-upload"},f().createElement("div",{onClick:this.loginLogoUploadFn,className:"bar"},f().createElement(v.l,{name:"add-to"}),"请上传图片"),f().createElement("div",{className:"example"},f().createElement("span",null,"示例:")," ",f().createElement("img",{src:g(25810)("./"+a+".png"),alt:""}))),f().createElement("p",null,f().createElement("span",{className:"desc-title"},"添加NPS问卷logo"),f().createElement("span",null,"仅支持png格式，文件小于1M（矩形图），建议尺寸：110*110")),f().createElement("div",{className:"login-logo logo-upload"},f().createElement("div",{onClick:this.NPSLogoUploadFn,className:"bar"},f().createElement(v.l,{name:"add-to"}),"请上传图片"),f().createElement("div",{className:"example"},f().createElement("span",null,"示例:")," ",f().createElement("img",{src:g(25810)("./"+a+".png"),alt:""}))),f().createElement("input",{type:"file",hidden:!0,ref:"faciconUpload",accept:"image/x-icon",onChange:function(e){return t.uploadIco(e)}}),f().createElement("input",{type:"file",hidden:!0,ref:"sideLogoUpload",accept:"images/png",onChange:function(e){return t.startSideCrop(e)}}),f().createElement("input",{type:"file",hidden:!0,ref:"loginLogoUpload",accept:"images/png",onChange:function(e){return t.startLoginCrop(e)}}),f().createElement("input",{type:"file",hidden:!0,ref:"NPSLogoUpload",accept:"images/png",onChange:function(e){return t.startNPSCrop(e)}})))),l&&f().createElement(S.Z,{src:d,title:"上传侧边栏图标",loading:s,confirm:this.sideCropConfirm.bind(this),cancel:function(e){t.setState({sideCropShow:!1})},aspectRatio:75/18}),c&&f().createElement(S.Z,{src:d,title:"上传登录/激活页面标识",loading:p,confirm:this.loginCropConfirm.bind(this),cancel:function(e){t.setState({loginCropShow:!1})}}),m&&f().createElement(S.Z,{src:d,title:"上传NPS问卷logo",loading:u,confirm:this.NPSCropConfirm.bind(this),cancel:function(e){t.setState({NPSCropShow:!1})}}))},e}(t.Component)},12234:(e,t,n)=>{"use strict";n.d(t,{l:()=>c});var a=n(67154),i=n.n(a),t=n(37316),o=n.n(t),a=n(85354),r=n.n(a),t=n(67294),l=n.n(t),a=n(94184),s=n.n(a),c=function(e){function t(){return e.apply(this,arguments)||this}return r()(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.name,e=o()(e,["className","name"]),t=s()("icon",["cem-"+n],t);return l().createElement("svg",i()({className:t},e),l().createElement("use",{xlinkHref:"#icon-cem-"+n}))},t}(t.Component)},5747:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var a=n(85354),o=n.n(a),i=n(67294),f=n.n(i),t=n(45697),a=n.n(t),t=n(94184),h=n.n(t),E=n(55761),v=n(92360),r=n(5133),l=function(i){function e(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=i.call.apply(i,[this].concat(n))||this).state={src:e.props.src,preCropPic:"",once:!0,fileName:e.props.fileName},e}o()(e,i);var t=e.prototype;return t.UNSAFE_componentWillReceiveProps=function(e,t){this.setState({uploadPic:e.uploadPic},function(e){})},t._crop=function(){var e=this.props.refName,e=this.refs[e].getCroppedCanvas().toDataURL();this.setState({preCropPic:e})},t.profilePicUpload=function(e){var t=this.props.reUpload,n=this,a=e.target.files[0];if(1024<a.size/1024)return r.Z.error("文件不能大于1M"),!1;e=new FileReader;e.readAsDataURL(a),e.onload=function(e){n.setState({src:e.target.result,fileName:a.name}),t&&t(e.target.result)}},t.render=function(){var e=this.state,t=e.src,n=e.preCropPic,a=this.props,i=a.title,o=a.tip,r=a.style,l=a.className,s=a.loading,c=a.refName,p=a.aspectRatio,d=a.accept,m=a.confirm,u=a.cancel,e=a.borderRadius,g=this.state.fileName,a="cropper-pic-wrap";l&&(a=h()("cropper-pic-wrap",l));l=h()("pre-pic",{"border-radius":e}),e=1;return p&&"[object Number]"===Object.prototype.toString.call(e)&&(e=p),f().createElement("div",{className:a},f().createElement("div",{className:"crop-wrap"},f().createElement(v.Loading,{loading:s},f().createElement("div",{className:"crop-title"},f().createElement("span",null,i),f().createElement("i",{className:"icon-cem_cancel",onClick:function(){return u(n)}})),f().createElement("div",{className:"crop-cont"},f().createElement(E.Z,{ref:c,src:t,style:r,aspectRatio:e,guides:!1,crop:this._crop.bind(this)}),f().createElement("div",{className:"option-cont"},f().createElement("div",{className:"pre-cont"},f().createElement("img",{className:l,src:n})),f().createElement("div",{className:"pre-tip"},"预览"),f().createElement("div",{className:"reupload-cont"},f().createElement(v.Button,{type:"primary",onClick:function(){return document.getElementById("reupload").click()}},"重新上传"),f().createElement("input",{type:"file",id:"reupload",hidden:!0,accept:d,onChange:this.profilePicUpload.bind(this)})))),f().createElement("p",{className:"crop-tip"},o),f().createElement("div",{className:"crop-option"},f().createElement(v.Button,{onClick:function(){u(n)}},"取消"),f().createElement(v.Button,{type:"primary",onClick:function(){m(n,g)}},"确定")))),f().createElement("div",{className:"crop-bg"}))},e}(i.Component);l.propTypes={show:a().bool,title:a().string,tip:a().string,src:a().string,refName:a().string,accept:a().string,confirm:a().func,cancel:a().func,reUpload:a().func,borderRadius:a().bool,loading:a().bool,fileName:a().string},l.defaultProps={show:!1,src:"",title:"上传图片",accept:"images/png",tip:"仅支持png格式，文件小于1M",refName:"cropper"+(new Date).getTime(),style:{height:263,width:263},borderRadius:!1,loading:!1,fileName:""}},88308:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var a=n(85354),i=n.n(a),o=n(67294),c=n.n(o),t=n(45697),a=n.n(t),p=n(5133),d=n(43036),t=n(94184),m=n.n(t),t={value:a().string,id:a().any.isRequired,enter:a().bool,blurFun:a().func,name:a().string,empty:a().bool,placeholder:a().string,type:a().string,confirmNoChange:a().func},a={value:"",enter:!0,name:"名称",empty:!1,placeholder:"",cancel:function(e,t){console.log("取消")},confirm:function(e,t){console.log("确定后的value:"+e)},type:"normal"},o=function(n){function e(e){var t=n.call(this,e)||this;t.enter=function(e){t.props.enter&&13===e.keyCode&&t.confirmEdit()};e=t.props.value;return t.state={isEdit:!1,curValue:e||"",lastVal:e||"",hover:!1,canEdit:!1},t}i()(e,n);var t=e.prototype;return t.UNSAFE_componentWillReceiveProps=function(e){var t=this;e.value!==this.state.lastVal&&e.value&&this.setState({curValue:e.value,lastVal:e.value}),!0!==e.canEdit||this.state.canEdit||this.setState({canEdit:!0},function(e){t.toEdit()})},t.componentDidMount=function(){var a=this;document.body.addEventListener("click",function(e){var t=e.target||window.event.srcElement,n=a.props.className,e="edit-input-wrap";!function(e,t){for(var n=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector;e&&!n.call(e,t);)e=e.parentElement;return e}(t,"."+(e=n?n.split(" ")[0]:e))&&a.cancelEdit()})},t.changeName=function(){var e=this.props.id,e=document.getElementById(e).value;this.setState({curValue:e})},t.toEdit=function(){var e=this.state,t=e.isEdit,n=(e.canEdit,this.props.id);t||this.setState({isEdit:!0,hover:!0},function(e){var t=document.getElementById(n);setTimeout(function(){t.focus()})})},t.checkEdit=function(){"normal"===this.props.type&&this.toEdit()},t.cancelEdit=function(){var e=this.state,t=e.curValue,n=e.lastVal,a=e.isEdit,e=e.canEdit,i=this.props.cancel;a&&(e&&this.setState({canEdit:!1}),this.setState({isEdit:!1,hover:!1,curValue:n},function(e){i&&i(t,n)}))},t.borderShow=function(){var e=this.state.hover;"normal"!==this.props.type||e||this.setState({hover:!0})},t.borderHide=function(){var e=this.state,t=e.hover,e=e.isEdit;"normal"===this.props.type&&t&&!e&&this.setState({hover:!1})},t.confirmEdit=function(){var e=this.state,t=e.curValue,n=e.lastVal,a=e.canEdit,i=this.props,o=i.confirm,r=i.id,l=i.name,s=i.empty,e=i.confirmNoChange,i=i.inputType,c=document.getElementById(r);""!==String(t).replace(/\s/g,"")||s||"remark"===i?(""===String(t).replace(/\s/g,"")&&s||"remark"==i?(this.setState({isEdit:!1,hover:!1,lastVal:t},function(e){c.blur()}),o&&o(t,n)):n===t?this.setState({isEdit:!1,hover:!1},function(e){c.blur()}):(this.setState({isEdit:!1,hover:!1,lastVal:t},function(e){c.blur()}),o&&o(t,n)),a&&(e&&e(t),this.setState({canEdit:!1}))):(p.Z.warning(l+"不能为空"),this.setState({curValue:n},function(e){c.focus()}))},t.render=function(){var e=this.props,t=e.id,n=e.style,a=e.className,i=e.placeholder,o=this.state,r=o.isEdit,l=o.curValue,s=o.hover,e=m()(["edit-input-wrap",a]),o=m()(["edit-input-cont",{hover:s,"is-edit":r}]),a=m()(["edit-input",{disabled:!r}]);return c().createElement("div",{className:e,style:n},c().createElement("div",{className:o,onMouseEnter:this.borderShow.bind(this),onMouseLeave:this.borderHide.bind(this),onClick:this.checkEdit.bind(this)},c().createElement("input",{id:t,className:a,type:"text",value:l,title:l,placeholder:i,style:n,disabled:!r,onInput:this.changeName.bind(this),onKeyDown:this.enter.bind(this)}),s&&!r&&c().createElement(d.Z,{placement:"top",overlay:"编辑"},c().createElement("div",{className:"btn-wrap",title:"编辑"},c().createElement("i",{className:"name-edit edit-btn icon-cem_edit"}))),s&&r&&c().createElement("div",{className:"btn-wrap"},c().createElement(d.Z,{placement:"top",overlay:"取消"},c().createElement("i",{className:"cancel-edit edit-btn icon-cem_delete",onClick:this.cancelEdit.bind(this),title:"取消"})),c().createElement(d.Z,{placement:"top",overlay:"确认"},c().createElement("i",{className:"confirm-edit edit-btn icon-cem_check-out",onClick:this.confirmEdit.bind(this),title:"确认"})))))},e}(o.Component);o.propTypes=t,o.defaultProps=a;const r=o},25810:e=>{function t(e){e=new Error("Cannot find module '"+e+"'");throw e.code="MODULE_NOT_FOUND",e}t.keys=()=>[],(t.resolve=t).id=25810,e.exports=t}}]);