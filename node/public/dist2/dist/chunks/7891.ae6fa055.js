(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[7891],{77891:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>q});var a=n(37316),r=n.n(a),i=n(67154),y=n.n(i),t=n(85354),l=n.n(t),g=n(67294),_=n.n(g),E=n(2329),N=n(55815),h=n(8201),d=n(98191),p=n(60496),f=n(39432),u=n(70715),m=n(87300),s=n(94644);function v(e,t){var n=["日期",t],t=e.map(function(e){return[e.name,e.count]});return{length:e.length,datasets:{dimensions:n,source:t}}}var a=n(45697),i=n.n(a),C=n(50976),t=function(a){function e(){for(var r,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(r=a.call.apply(a,[this].concat(t))||this).renderChart=function(){var e=r.props,t=e.data,n=e.title,a=e.timeType,e=e.onMsgClick;(0,h.P)(t)&&r.chartRef&&(e=function(e,c,s,t,u){t=.8*t/(63*e.map(function(e){return e.name}).length),e=v(e).datasets.source;return{title:{text:c},tooltip:{trigger:"axis",showDelay:200,hideDelay:500,enterable:!0,padding:0,position:function(e,t,n,a,r){var i=r.contentSize,o=r.viewSize,r=e[0]<o[0]/2?0:-1,o=e[1]<o[1]/2?-.5:-1;return[e[0]+r*i[0],e[1]+o*i[1]]},formatter:function(e,t,n){if(e.length){var a=e[0],r=a.marker,i=a.seriesName,o=a.name,l=a.value;return setTimeout(function(){n(t,(0,m.r)(""+(0,f.yV)(s,o),[""+r+i+"："+(0,f.hE)(l)],[{title:"消息",icon:"icon-cem_jump-message",callback:function(){return u(e[0],c,"trend")}}]))},0)}}},grid:{top:56,left:36,right:48,bottom:t<1?40:16,containLabel:!0},dataZoom:{show:t<1,left:55,right:55,bottom:16,height:16,handleSize:"100%",showDetail:!1},xAxis:{type:"category",boundaryGap:!1,axisTick:{show:!0},data:e.map(function(e){return(0,f.yV)(s,e[0])})},yAxis:{type:"value",splitNumber:3,minInterval:1},series:[{type:"line",name:"标签声量",data:e.map(function(e,t){return{name:e[0],value:e[1],symbol:"circle"}})}]}}(t,n,a,r.chartRef.getWidth(),e),r.chartRef.clear(),r.chartRef.setOption(e))},r.getChartRef=function(e){return r.chartRef=e},r}l()(e,a);var t=e.prototype;return t.componentDidMount=function(){var a=this;this.internalId=setInterval(function(){var e,t,n;a.chartRef&&(clearInterval(a.internalId),a.renderChart(),t=(e=a.chartRef._dom.children)[0],n=e[1],t.addEventListener("mouseleave",function(e){a.chartLeaveTimeout=setTimeout(function(){a.chartLeaveTimeout&&(n.style.display="none")},2e3)}),n&&n.addEventListener("mouseenter",function(e){a.chartLeaveTimeout=void 0}))},200)},t.componentDidUpdate=function(e,t){var n=e.data,e=this.props.data;(0,h.P)(e)&&JSON.stringify(n)!==JSON.stringify(e)&&this.renderChart(),!(0,h.P)(e)&&this.chartRef&&(this.chartRef=void 0)},t.render=function(){var r=this,e=this.props,t=e.className,n=e.title,i=void 0===n?"提及声量走势":n,o=e.data,a=e.loading,l=e.timeOptions,n=e.timeType,c=e.onFilterChange;return _().createElement(h.Z,{data:o,loading:a,className:"product_scene_line_chart_wrap "+t,renderTitle:_().createElement(d.Z,{title:i,data:o,onMoreClick:function(e){var t,n,a;t=r.chartRef,n=o,a=i,"image"===(e=e)?(0,s._v)(t,a):"data"===e&&(n=[(n=v(n).datasets).dimensions].concat(n.source),(0,s.aT)([n],a))}},_().createElement(p.Z,{options:l,activeObj:n,onChange:function(e){return c({c1TimeType:e})}}))},_().createElement(C.Z,{theme:"yunting_multi_color",className:"yt_echarts_style",option:{},style:{width:"100%",height:"100%"},onChartReady:this.getChartRef}))},e}(_().Component);const R=t;t.propsType={className:i().string,title:i().string,data:i().any,loading:i().bool,onFilterChange:i().func,timeOptions:i().arrayOf(i().shape({title:i().string,value:i().string})),timeType:i().string,fTimeType:i().string,onFlavorChange:i().func};var a=n(81506),o=n.n(a),t=function(a){function e(){for(var o,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(o=a.call.apply(a,[this].concat(t))||this).dimensions=void 0,o.source=void 0,o.chartRef=void 0,o.margin=0,o.mColor=u.Fq,o.getChartRef=function(e){return o.chartRef=e},o.setValue=function(e){e=e.sort(function(e,t){return t.count-e.count});o.source=[],o.dimensions=["指标","声量","累计声量占比"];var n=(0,f.jD)("100%",12)+30,t=e.reduce(function(e,t){n=Math.max(n,(0,f.jD)(t.count,12)+30);e+=t.count;return o.source.push([t.name,t.count,e]),e},0);o.source.forEach(function(e){e[2]=t?e[2]/t:0}),o.margin=n},o.getOption=function(i){return{title:{text:i},tooltip:{trigger:"axis",showDelay:200,hideDelay:500,enterable:!0,padding:0,position:function(e,t,n,a,r){var i=r.contentSize,o=r.viewSize,r=e[0]<o[0]/2?0:-1,o=e[1]<o[1]/2?-.5:-1;return[e[0]+r*i[0],e[1]+o*i[1]]},formatter:function(n,a,r){return setTimeout(function(){var e=n.find(function(e){return"bar"===e.componentSubType}),t=n.find(function(e){return"line"===e.componentSubType});r(a,(0,m.r)(e.marker+" "+e.name,["标签声量："+(0,f.hE)(e.value),"累计占比："+(100*t.value).toFixed(2)+"%"],[{title:"消息",icon:"icon-cem_jump-message",callback:function(){return o.handleOnMsgClick(e,i)}}]))},0)}},legend:{left:20,top:50,itemWidth:10,itemHeight:10,data:[{name:"声量",icon:u.W4.square},{name:"累计声量占比",icon:u.W4.lineRing}]},grid:{bottom:70,left:o.margin,right:o.margin,top:80},dataZoom:[{show:"slider",bottom:20,xAxisIndex:[0,1],height:15,handleSize:"100%",showDetail:!1}],dataset:[{source:o.source,dimensions:o.dimensions}],xAxis:[0,1].map(function(e){return{type:"category",data:o.source.map(function(e){return e[0]}),position:"bottom",show:!e}}),yAxis:[0,1].map(function(t){return{type:"value",name:t?"":"各商品指标排行",nameTextStyle:{color:"#262626"},axisLabel:{formatter:function(e){return t?(100*e).toFixed(0)+"%":e}}}}),series:[{type:"bar",yAxisIndex:0,barMaxWidth:24,data:o.source.map(function(e){return{value:e[1],itemStyle:{color:"#1574B3"}}}),markLine:{symbolSize:0,data:[{name:"均值",type:"average",lineStyle:{color:"#bfbfbf"},label:{backgroundColor:"rgba(140, 140, 140, 0.3)",textShadowColor:"#1574b3",textShadowBlur:2,padding:[2,4],color:"#fff"}}]}},{type:"line",yAxisIndex:1,data:o.source.map(function(e){return{value:e[2],itemStyle:{color:"#CDB446"}}})}]}},o}return l()(e,a),e.prototype.renderChart=function(e,t){this.setValue(e),this.chartRef.clear(),this.chartRef.setOption(this.getOption(t))},e}(_().PureComponent),c=n(61409),O=n(92360),a=function(a){function e(e){var r=a.call(this,e)||this;return r.handleOnMoreClick=function(e){var t=r.props,n=t.title,t=t.value;"image"===e&&r.chartRef?(0,s._v)(r.chartRef,n):"data"===e&&(0,h.P)(t)&&(0,s.aT)([[r.dimensions].concat(r.source.map(function(e){return[e[0],e[1],(100*e[2]).toFixed(2)+"%"]}))],n)},r.handleOnMsgClick=function(e,t){r.props.onMsgClick(e,t,"allConfig")},r.handleOnChartClick=function(e){var t=e.componentSubType,n=e.componentType,a=e.dataIndex;"series"===n&&"bar"===t&&r.setState({clickedDataIndex:r.state.clickedDataIndex===a?-1:a},function(){var e=r.props,t=e.onChartClick,n=e.value,e=e.topicObj;t&&t("bar",-1===r.state.clickedDataIndex?null:{analysis:{id:e,values:[n[a].id],type:n[a].type}})})},r.handleOnSwitch=function(n){r.setState({showZero:n},function(){var e=r.props,t=e.value,e=e.title;a.prototype.renderChart.call(o()(r),n?t:t.filter(function(e){return e.count}),e)})},r.state={showZero:!1,clickedDataIndex:-1},r}l()(e,a);var t=e.prototype;return t.componentDidMount=function(){var a=this;this.internalId=setInterval(function(){var e,t,n;a.chartRef&&(clearInterval(a.internalId),a.renderChart(),t=(e=a.chartRef._dom.children)[0],n=e[1],t.addEventListener("mouseleave",function(e){a.chartLeaveTimeout=setTimeout(function(){a.chartLeaveTimeout&&(n.style.display="none")},2e3)}),n&&n.addEventListener("mouseenter",function(e){a.chartLeaveTimeout=void 0}))},200)},t.componentDidUpdate=function(e,t){var a=this,n=e.value,e=this.props.value,t=t.clickedDataIndex,r=this.state.clickedDataIndex;(0,h.P)(e)&&JSON.stringify(n)!==JSON.stringify(e)&&this.renderChart(),!(0,h.P)(e)&&this.chartRef&&(this.chartRef=void 0),t!==r&&this.chartRef&&(t=this.chartRef.getOption().series.map(function(e,n){return{data:e.data.map(function(e,t){return{value:e.value,itemStyle:{color:-1===r||r===t?a.mColor[n%a.mColor.length]:"#d8d8d8"}}})}}),this.chartRef.setOption({series:t}))},t.renderChart=function(){var e=this.props,t=e.value,n=e.title,e=this.state.showZero;(0,h.P)(t)&&this.chartRef&&a.prototype.renderChart.call(this,e?t:t.filter(function(e){return e.count}),n)},t.resetChartRender=function(){this.setState({clickedDataIndex:-1})},t.render=function(){var e=this.state.showZero,t=this.props,n=t.value,a=t.loading,r=t.title,i=t.topicOpts,o=t.topicObj,t=t.onFilterChange;return _().createElement(h.Z,{className:"yt_overview_aspect_bar_chart_wrapper",data:n,loading:a,renderTitle:_().createElement(d.Z,{title:r,data:n,onMoreClick:this.handleOnMoreClick,titleOverlay:_().createElement("div",null,_().createElement("div",null,"此图的分析方法是统计分析中常用的柏拉图"),_().createElement("div",{style:{marginTop:14,textAlign:"right"}},_().createElement(c.rU,{className:"yt-feedback-read-more",to:"https://www.yuque.com/docs/share/5cc9676c-e68a-4304-8f36-f2bcdd347edb?#",target:"_blank"},"了解更多")))},_().createElement(p.Z,{options:i,objName:"c2AnalyzeObj",preTitle:"分析对象",sufTitle:"无",activeObj:o,onChange:t}),_().createElement(O.Checkbox,{checked:e,onChange:this.handleOnSwitch,className:"zero_switch"},"显示'0'"))},_().createElement(C.Z,{onChartReady:this.getChartRef,theme:"yunting_multi_color",option:{},style:{height:"100%"},onEvents:{click:this.handleOnChartClick}}))},e}(t);const x=a;a.propTypes={value:i().any,topicOpts:i().array,topicObj:i().string,loading:i().bool,title:i().string,onFilterChange:i().func,onChartClick:i().func};var b=["性别","年龄","关系","使用场合","用途","购买决策"],t=function(a){function e(){for(var s,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(s=a.call.apply(a,[this].concat(t))||this).source=void 0,s.chartRef=void 0,s.clusterData=void 0,s.globalCata=void 0,s.categories=void 0,s.getChartRef=function(e){return s.chartRef=e},s.setValue=function(e){var t=["场景","标签","总提及声量","标签声量","关联标签声量","关联数","置信度","提升度"];s.clusterData=[t];var a=[],e=e.reduce(function(e,t){var n=[t.sceneName,t.key,t.messageCount,t.aspectCount,t.total,t.relTotal,t.trustRate,t.upRate];return e[t.sceneName]||(e[t.sceneName]=[]),e[t.sceneName].push(n),a.push(n),e},{});s.categories=Object.keys(e),Object.values(e).forEach(function(e){e.sort(function(e,t){return t[4]-e[4]}).forEach(function(e){s.clusterData.push(e)})}),s.globalCata=a.sort(function(e,t){return t[4]-e[4]}),s.globalCata.splice(0,0,t)},s.getOptions=function(l,c){var e=s.categories.map(function(e,t){e=b.indexOf(e);return u.Fq[-1<e?e:t]});return{title:{text:l},dataset:[{source:s.source}],grid:{top:86,bottom:50,left:36,right:48,containLabel:!0},visualMap:[{type:"piecewise",top:46,left:20,itemWidth:10,itemHeight:10,orient:"horizontal",dimension:0,categories:s.categories,inRange:{symbol:"rect",color:e},outOfRange:{color:"#bfbfbf"}}],dataZoom:[{show:"slider",bottom:20,xAxisIndex:0,height:15,handleSize:"100%",showDetail:!1}],tooltip:{showDelay:200,hideDelay:500,enterable:!0,padding:0,position:function(e,t,n,a,r){var i=r.contentSize,o=r.viewSize,r=e[0]<o[0]/2?0:-1,o=e[1]<o[1]/2?-.5:-1;return[e[0]+r*i[0],e[1]+o*i[1]]},formatter:function(r,i,o){return setTimeout(function(){var e=r.marker,t=r.data,n="",n=1===t[7]?"无关联":1<t[7]?"关联性强":"关联性不强",a=t[1].split(":")[1];o(i,(0,m.r)(e+" "+a,["标签声量："+(0,f.hE)(t[4]),"提到「"+c+"」的消息中</br>有"+(0,f.bC)(t[6])+"%的概率也会提到「"+a+"」，</br>提升度为"+t[7].toFixed(2)+"，两者"+n],[{title:"消息",icon:"icon-cem_jump-message",callback:function(){return s.handleOnMsgClick(r,l)}}]))},0)}},xAxis:{type:"category",axisLabel:{formatter:function(e){return e.split(":")[1]}}},yAxis:{type:"value"},series:[{type:"bar",barMaxWidth:24,encode:{x:1,y:4}}]}},s}l()(e,a);var t=e.prototype;return t.renderChart=function(e,t,n,a){this.setValue(e),this.updateChart(t,n,a)},t.updateChart=function(e,t,n){"global"===t?this.source=this.globalCata:"cluster"===t&&(this.source=this.clusterData),this.chartRef.clear(),this.chartRef.setOption(this.getOptions(e,n))},e}(_().Component),S=n(33798),D=n(43036),a=function(r){function e(e){var a=r.call(this,e)||this;return a.handleOnMoreClick=function(e){var t=a.props,n=t.title,t=t.data;"image"===e&&a.chartRef?(0,s._v)(a.chartRef,n):"data"===e&&(0,h.P)(t)&&(0,s.aT)([a.source.map(function(e,t){return 0===t?e:[e[0],e[1].split(":")[1],e[2],e[3],e[4],e[5],(100*e[6]).toFixed(2)+"%",""+e[7].toFixed(2)]})],n)},a.handleOnMsgClick=function(e,t){a.props.onMsgClick(e,t,"aspect")},a.state={rangeType:"global"},a}l()(e,r);var t=e.prototype;return t.componentDidMount=function(){var a=this;this.internalId=setInterval(function(){var e,t,n;a.chartRef&&(clearInterval(a.internalId),a.renderChart(),t=(e=a.chartRef._dom.children)[0],n=e[1],t.addEventListener("mouseleave",function(e){a.chartLeaveTimeout=setTimeout(function(){a.chartLeaveTimeout&&(n.style.display="none")},2e3)}),n&&n.addEventListener("mouseenter",function(e){a.chartLeaveTimeout=void 0}))},200)},t.componentDidUpdate=function(e,t){var n=e.data,a=this.props.data,e=t.rangeType,t=this.state.rangeType;(0,h.P)(a)&&JSON.stringify(n)!==JSON.stringify(a)&&this.renderChart(),!(0,h.P)(a)&&this.chartRef&&(this.chartRef=void 0),e!==t&&this.chartRef&&r.prototype.updateChart.call(this,this.props.title,t)},t.renderChart=function(){var e=this.props,t=e.data,n=e.title,a=e.aspectName,e=this.state.rangeType;(0,h.P)(t)&&this.chartRef&&r.prototype.renderChart.call(this,t,n,e,a)},t.render=function(){var e=this,t=this.state.rangeType,n=this.props,a=n.data,r=n.loading,n=n.title;return _().createElement(h.Z,{className:"yt_scene_bar_chart_wrapper",data:a,loading:r,renderTitle:_().createElement(d.Z,{title:n,data:a,onMoreClick:this.handleOnMoreClick,titleOverlay:_().createElement("div",null,_().createElement("div",null,"展示一条消息中共同提及的其他场景标签关联关系"),_().createElement("div",null,"提示：场景类型包含性别、年龄段、关系、用途、购买决策、使用场合，如果分析使用场合标签的关联标签时，只分析不包含使用场合的其他类型标签之间的关系"),_().createElement("div",{style:{marginTop:14,textAlign:"right"}},_().createElement(c.rU,{className:"yt-feedback-read-more",to:"https://www.yuque.com/docs/share/1442b1bd-72da-476d-b42b-db965a8aaeff?# 《关联分析公式说明》",target:"_blank"},"了解更多")))},_().createElement(D.Z,{placement:"top",overlay:"全局排序"},_().createElement("span",{onClick:function(){return e.setState({rangeType:"global"})}},_().createElement(S.Z,{isActive:"global"===t,defaultIcon:"cem_non-sort-within-group",activeIcon:"cem_non-sort-within-group-color"}))),_().createElement(D.Z,{placement:"top",overlay:"分组排序"},_().createElement("span",{onClick:function(){return e.setState({rangeType:"cluster"})}},_().createElement(S.Z,{isActive:"cluster"===t,defaultIcon:"cem_sort-within-group",activeIcon:"cem_sort-within-group-color"}))),_().createElement("div",{className:"v-divider"}))},_().createElement(C.Z,{onChartReady:this.getChartRef,theme:"yunting_multi_color",option:{},style:{height:"100%"},onEvents:{click:this.handleOnChartClick}}))},e}(t);const w=a;a.propTypes={data:i().any,loading:i().bool,title:i().string,aspectName:i().string};var t=function(a){function e(){for(var i,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(i=a.call.apply(a,[this].concat(t))||this).source=void 0,i.chartRef=void 0,i.getChartRef=function(e){return i.chartRef=e},i.setValue=function(e,t){i.source=e.map(function(e){return[e.name,e.count]}),i.source.splice(0,0,[t,"声量"])},i.getOptions=function(r,t){return{title:{text:r},dataset:[{source:i.source}],grid:{top:56,bottom:20,left:36,right:48,containLabel:!0},tooltip:{trigger:"axis",showDelay:200,hideDelay:500,enterable:!0,padding:0,position:function(e,t,n,a,r){var i=r.contentSize,o=r.viewSize,r=e[0]<o[0]/2?0:-1,o=e[1]<o[1]/2?-.5:-1;return[e[0]+r*i[0],e[1]+o*i[1]]},formatter:function(t,n,a){return setTimeout(function(){var e=t[0];a(n,(0,m.r)(e.marker+" "+e.name,["标签声量："+(0,f.hE)(e.value)],[{title:"消息",icon:"icon-cem_jump-message",callback:function(){return i.handleOnMsgClick(e,r)}}]))},0)}},xAxis:{type:"value",show:!1,axisLabel:{show:!1}},yAxis:{type:"category",inverse:!0,data:i.source.slice(1).map(function(e){return e[0]})},series:[{type:"bar",barMaxWidth:24,data:i.source.slice(1).map(function(e){return{value:e[1],name:e[0],itemStyle:{color:t===e[0]?"#CDB446":"#1574B3"}}}),label:{show:!0,position:"right",color:"#262626"}}]}},i}return l()(e,a),e.prototype.renderChart=function(e,t,n,a){this.setValue(e,n,a),this.chartRef.clear(),this.chartRef.setOption(this.getOptions(t,a))},e}(_().Component),a=n(94184),T=n.n(a),k=function(t){function e(e){var a=t.call(this,e)||this;return a.togglePanel=function(e){var t=a.state,n=t.panelShow;t.value,t.filteredOptions;n&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()),setTimeout(function(){return a.setState({panelShow:!n})},0)},a.handleCheckAllStatus=function(){var e=a.state,t=e.tempValue,e=e.filteredOptions;a.setState({allChecked:0<t.length&&t.length===e.length,indeterminate:0<t.length&&t.length<e.length})},a.handleConfirm=function(){var e=a.state.tempValue;a.setState({value:JSON.parse(JSON.stringify(e)),panelShow:!1}),a.props.onChange(e)},a.handleCancel=function(){var e=a.state,t=e.value,e=e.filteredOptions;a.setState({tempValue:JSON.parse(JSON.stringify(t)),panelShow:!1,allChecked:t&&0<t.length&&t.length===e.length,indeterminate:t&&0<t.length&&t.length<e.length},function(){return a.handleClearInput()})},a.handleReset=function(){a.setState({tempValue:[],value:[],panelShow:!1,searchText:""},function(){return a.handleCheckAllStatus()})},a.handleFilter=function(t){var e,n=a.state.options;0<t.trim().length?(e=n.filter(function(e){return e.name.toUpperCase().includes(t.toUpperCase())}),a.setState({searchText:t,filteredOptions:e})):a.setState({filteredOptions:n,searchText:t})},a.handleClearInput=function(){var e=a.state,t=e.searchText,e=e.options;0<t.length&&a.setState({searchText:"",filteredOptions:e},function(){return a.handleCheckAllStatus()})},a.state={type:e.type||2,title:e.title||"",options:[],filteredOptions:[],tempValue:e.defaultValue||[],value:e.defaultValue||[],maxLength:e.maxLength||0,indeterminate:!1,allChecked:!1,panelShow:!1,searchText:""},a}l()(e,t);var n=e.prototype;return n.componentDidMount=function(){window.addEventListener("click",this.handleCancel)},e.getDerivedStateFromProps=function(e,t){var n=e.type,a=e.title,r=e.options,i=e.value;if(n!==t.type)return{type:n};if(a!==t.title)return{title:a};if(Array.isArray(i)&&JSON.stringify(i)!==JSON.stringify(t.value)){r=r?r.reduce(function(e,t){var n=i.indexOf(t.id);return-1<n?e[n]=t:e.splice(e.length,0,t),e},i.slice()):[];return{options:r,filteredOptions:r,value:i||[],tempValue:i||[],allChecked:i&&0<i.length&&i.length===t.filteredOptions.length,indeterminate:i&&0<i.length&&i.length<t.filteredOptions.length}}return null},n.componentWillUnmount=function(){window.removeEventListener("click",this.handleCancel)},n.handleCheckAll=function(){var e=this,t=this.state,n=t.tempValue,t=t.filteredOptions;this.setState({tempValue:n.length===t.length?[]:t.map(function(e){return e.id})},function(){return e.handleCheckAllStatus()})},n.handleCheckOne=function(e){var t=this,n=this.state,a=n.tempValue,n=n.maxLength;(0<n&&(a.length>=n&&a.includes(e)||a.length<n)||0===n)&&(-1<(n=a.indexOf(e))?a.splice(n,1):a.push(e),this.setState({tempValue:a},function(){return t.handleCheckAllStatus()}))},n.render=function(){var n=this,e=this.state,t=e.type,a=e.title,r=e.options,i=e.filteredOptions,o=e.indeterminate,l=e.allChecked,c=e.panelShow,s=e.tempValue,u=e.value,h=e.maxLength,d=e.style,p=e.searchText,f=0<r.length?r.filter(function(e){return u.includes(e.id)}).map(function(e){return e.name}):[],e=T()({"cc_multi-select-wrapper":!0,whiteBg:1===t,sel:c}),t=t&&1===t?"请选择":"全部",m=this.props.note;return _().createElement("div",{className:e,style:y()({backgroundColor:c?"rgb(97,121,155)":""},d),onClick:this.togglePanel},_().createElement("span",null,a&&a+"："),_().createElement("span",{className:"currValue",title:0<f.length?f.length===r.length?"全部":f.join("，"):t},0<f.length?f.length===r.length?"全部":f.join("，"):t),_().createElement("i",{className:"icon-cem_arrow-launches",style:{transform:c?"rotate(-180deg)":"",top:c?"-2px":"3px"}}),_().createElement("div",{className:"multi-select-panel",style:{display:c?"block":"none"},onClick:function(e){return e.stopPropagation()}},_().createElement("div",{className:"multi-select-header"},h&&_().createElement("div",{className:"limit_info"},"添加展示",_().createElement("span",null,"（最多"+h+"个，已添加"+s.length+"个）")),_().createElement(O.Input,{ref:function(e){return n.input=e},value:p,onChange:this.handleFilter,placeholder:"请输入搜索关键词",icon:0<p.length?"close":"search",onIconClick:this.handleClearInput})),_().createElement("ul",{className:"multi-select-panel-body"},0<i.length?_().createElement(g.Fragment,null,0===h&&_().createElement("li",{className:"all_check",onClick:function(){return n.handleCheckAll()}},_().createElement("div",{className:"all_select"},_().createElement(O.Checkbox,{checked:l,indeterminate:o,onChange:function(){return n.handleCheckAll()}}),_().createElement("label",null,"全选"))),i.map(function(e,t){return _().createElement("li",{key:t,className:0<h&&s.length>=h&&!s.includes(e.id)?"disabled":"",onClick:function(){return n.handleCheckOne(e.id)},style:{height:m?"50px":"36px"}},_().createElement(O.Checkbox,{disabled:0<h&&s.length>=h&&!s.includes(e.id),checked:s.includes(e.id),value:e.id,onChange:function(){return n.handleCheckOne(e.id)}}),_().createElement("label",{title:e.name},e.name),m&&_().createElement("p",{className:"note"},m(e)))})):_().createElement("li",null,_().createElement("label",null,"暂无数据"))),_().createElement("div",{className:"multi-select-panel-footer"},_().createElement(O.Button,{type:"primary",onClick:this.handleConfirm},"确认"),_().createElement(O.Button,{onClick:this.handleCancel},"取消"))))},e}(g.Component);k.propTypes={type:i().number,title:i().string.isRequired,options:i().arrayOf(i().shape({id:i().oneOfType([i().string,i().number]),name:i().string})),defaultValue:i().arrayOf(i().string),value:i().arrayOf(i().string),maxLength:i().number,onChange:i().func.isRequired,style:i().object,note:i().func};t=function(r){function e(e){var a=r.call(this,e)||this;return a.handleOnMoreClick=function(e){var t=a.props,n=t.title,t=t.data;"image"===e&&a.chartRef?(0,s._v)(a.chartRef,n):"data"===e&&(0,h.P)(t)&&(0,s.aT)([a.source],n)},a.handleOnChange=function(e){var t=a.props.onChange;t&&t({c4SelectedObjs:e})},a.handleOnMsgClick=function(e,t){a.props.onMsgClick(e,t,"config")},a.state={options:[]},a}l()(e,r),e.getDerivedStateFromProps=function(e,t){return t.options.length?null:{options:e.options.map(function(e){return{id:e.value,name:e.title}})}};var t=e.prototype;return t.componentDidMount=function(){var a=this;this.internalId=setInterval(function(){var e,t,n;a.chartRef&&(clearInterval(a.internalId),a.renderChart(),t=(e=a.chartRef._dom.children)[0],n=e[1],t.addEventListener("mouseleave",function(e){a.chartLeaveTimeout=setTimeout(function(){a.chartLeaveTimeout&&(n.style.display="none")},2e3)}),n&&n.addEventListener("mouseenter",function(e){a.chartLeaveTimeout=void 0}))},200)},t.componentDidUpdate=function(e,t){var n=e.data,e=this.props.data;(0,h.P)(e)&&JSON.stringify(n)!==JSON.stringify(e)&&this.renderChart(),!(0,h.P)(e)&&this.chartRef&&(this.chartRef=void 0)},t.renderChart=function(){var e=this.props,t=e.data,n=e.title,a=e.topicName,e=e.defaultName;(0,h.P)(t)&&this.chartRef&&r.prototype.renderChart.call(this,t,n,a,e)},t.render=function(){var e=this.props,t=e.data,n=e.loading,a=e.title,r=e.selectedObjs,i=e.topicName,e=this.state.options;return _().createElement(h.Z,{className:"yt_scene_bar_chart_wrapper",data:t,loading:n,renderTitle:_().createElement(d.Z,{title:a,data:t,onMoreClick:this.handleOnMoreClick,titleOverlay:"只对比品牌或型号的标签声量，如果筛选了品牌，从品牌角度对比各品牌的标签声量，如果筛选了型号，从型号角度对比各型号的标签声量"},_().createElement(k,{title:i,options:e,maxLength:10,value:r,onChange:this.handleOnChange}),_().createElement("div",{className:"v-divider"}))},_().createElement(C.Z,{onChartReady:this.getChartRef,theme:"yunting_multi_color",option:{},style:{height:"100%"}}))},e}(t);const A=t;t.propTypes={data:i().any,loading:i().bool,title:i().string,topicName:i().string,selectedObjs:i().arrayOf(i().string),defaultName:i().string,options:i().arrayOf(i().shape({title:i().string,value:i().string}))};var t=function(a){function e(){for(var r,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(r=a.call.apply(a,[this].concat(t))||this).source=void 0,r.dimensions=void 0,r.countDimensions=["指标","负面声量","正面声量","总声量"],r.rateDimensions=["指标","负面声量占比","正面声量占比","总声量占比"],r.chartRef=void 0,r.countData=void 0,r.rateData=void 0,r.getChartRef=function(e){return r.chartRef=e},r.setValue=function(e){r.countData=[],r.rateData=[];var t=0;e.forEach(function(e){t+=e.total,r.countData.push([e.name,e.negative,e.positive,e.total]),r.rateData.push([e.name,e.negative?e.negative/e.total:0,e.positive?e.positive/e.total:0,e.total])}),r.rateData.forEach(function(e){e[3]=t?e[3]/t:0})},r.getOptions=function(a,t){return{title:{text:a},dataset:[{dimensions:r.dimensions,source:r.source}],grid:{top:86,bottom:50,left:36,right:48,containLabel:!0},legend:{left:20,top:46,itemWidth:10,itemHeight:10,itemGap:16,icon:u.W4.square,data:["负面","正面"]},dataZoom:[{show:"slider",bottom:20,xAxisIndex:0,height:15,handleSize:"100%",showDetail:!1}],tooltip:{trigger:"axis",showDelay:200,hideDelay:500,enterable:!0,padding:0,position:function(e,t,n,a,r){var i=r.contentSize,o=r.viewSize,r=e[0]<o[0]/2?0:-1,o=e[1]<o[1]/2?-.5:-1;return[e[0]+r*i[0],e[1]+o*i[1]]},formatter:function(e,t,n){return setTimeout(function(){n(t,(0,m.r)(""+e[0].name,e.map(function(t){var e="正面"===t.seriesName?2:1,n=r.countData.find(function(e){return e[0]===t.name})[e],e=r.rateData.find(function(e){return e[0]===t.name})[e];return t.marker+" "+t.seriesName+"： "+(0,f.hE)(n)+" ("+(100*e).toFixed(2)+"%)"}),[{title:"消息",icon:"icon-cem_jump-message",callback:function(){return r.handleOMsgClick(e,a)}}]))},0)}},xAxis:{type:"category",triggerEvent:!0},yAxis:{type:"value",axisLabel:{formatter:function(e){return"count"===t?e:100*e+"%"}}},series:["负面","正面"].map(function(e,t){return{name:e,type:"bar",stack:"stack",barMaxWidth:24,itemStyle:{borderWidth:2,borderColor:"#fff"},encode:{x:0,y:t+1}}})}},r}l()(e,a);var t=e.prototype;return t.renderChart=function(e,t,n,a){this.setValue(e),this.updateChart(t,n,a)},t.updateChart=function(e,t,n){"count"===t?(this.source=this.countData,this.dimensions=this.countDimensions):"rate"===t&&(this.source=this.rateData,this.dimensions=this.rateDimensions),"total"===n?this.source=this.source.sort(function(e,t){return t[3]-e[3]}):"positive"===n?this.source=this.source.sort(function(e,t){return t[1]-e[1]}):"negative"===n&&(this.source=this.source.sort(function(e,t){return t[2]-e[2]})),this.chartRef.clear(),this.chartRef.setOption(this.getOptions(e,t))},e}(_().Component),M=[{title:"一级指标",value:"ASPECT1"},{title:"二级指标",value:"ASPECT2"}],L=[{title:"数量",value:"count"},{title:"比例",value:"rate"}],I=[{title:"指标声量",value:"total"},{title:"指标负面声量",value:"positive"},{title:"指标正面声量",value:"negative"}],t=function(o){function e(e){var r=o.call(this,e)||this;return r.handleOnMoreClick=function(e){var t=r.props,n=t.title,a=t.data,t=r.state.dataType;"image"===e&&r.chartRef?(0,s._v)(r.chartRef,n):"data"===e&&(0,h.P)(a)&&(0,s.aT)([[r.dimensions].concat("count"===t?r.source:r.source.map(function(e){return[e[0],(100*e[1]).toFixed(2)+"%",(100*e[2]).toFixed(2)+"%",(100*e[3]).toFixed(2)+"%"]}))],n)},r.handleOnAspectTypeChange=function(e){var t=r.props.onChange;t&&t({c5AspectLevel:e,c5Aspect1:""})},r.handleOnDataTypeChange=function(e){r.setState({dataType:e})},r.handleOnRangeTypeChange=function(e){r.setState({rangeType:e})},r.handleOMsgClick=function(e,t){r.props.onMsgClick(e,t,"model")},r._handleOnClick=function(e){var t=r.props,n=t.aspectLevel,a=t.onChange,t=e.componentType,e=e.value;"xAxis"===t&&a&&a({c5Aspect1:"ASPECT1"===n?e:"",c5AspectLevel:"ASPECT1"===n?"ASPECT2":"ASPECT1"})},r.state={dataType:"count",rangeType:"total"},r}l()(e,o);var t=e.prototype;return t.componentDidMount=function(){var a=this;this.internalId=setInterval(function(){var e,t,n;a.chartRef&&(clearInterval(a.internalId),a.renderChart(),t=(e=a.chartRef._dom.children)[0],n=e[1],t.addEventListener("mouseleave",function(e){a.chartLeaveTimeout=setTimeout(function(){a.chartLeaveTimeout&&(n.style.display="none")},2e3)}),n&&n.addEventListener("mouseenter",function(e){a.chartLeaveTimeout=void 0}))},200)},t.componentDidUpdate=function(e,t){var n=e.data,a=this.props.data,r=t.rangeType,i=t.dataType,e=this.state,t=e.rangeType,e=e.dataType;(0,h.P)(a)&&JSON.stringify(n)!==JSON.stringify(a)&&this.renderChart(),!(0,h.P)(a)&&this.chartRef&&(this.chartRef=void 0),r===t&&i===e||!this.chartRef||o.prototype.updateChart.call(this,this.props.title,e,t)},t.renderChart=function(){var e=this.props,t=e.data,n=e.title,a=this.state,e=a.rangeType,a=a.dataType;(0,h.P)(t)&&this.chartRef&&o.prototype.renderChart.call(this,t,n,a,e)},t.render=function(){var e=this.props,t=e.data,n=e.loading,a=e.title,r=e.aspectLevel,i=e.className,o=void 0===i?"":i,e=this.state,i=e.dataType,e=e.rangeType;return _().createElement(h.Z,{className:"yt_scene_bar_chart_wrapper "+o,data:t,loading:n,renderTitle:_().createElement(d.Z,{title:a,data:t,onMoreClick:this.handleOnMoreClick,titleOverlay:"提及到相关「场景标签」消息的指标情感分析"},_().createElement(p.Z,{options:M,activeObj:r,onChange:this.handleOnAspectTypeChange}),_().createElement(p.Z,{options:L,activeObj:i,onChange:this.handleOnDataTypeChange}),_().createElement(p.Z,{preTitle:"排序",options:I,activeObj:e,onChange:this.handleOnRangeTypeChange}))},_().createElement(C.Z,{onChartReady:this.getChartRef,theme:"yunting_neg_pos",option:{},onEvents:{click:this._handleOnClick},style:{height:"100%"}}))},e}(t);const F=t;t.propTypes={data:i().any,className:i().string,loading:i().bool,title:i().string,aspectLevel:i().string,onChange:i().func};n(89777);var t=function(a){function e(){for(var r,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(r=a.call.apply(a,[this].concat(t))||this).source=void 0,r.dimensions=void 0,r.chartRef=void 0,r.tableRef=void 0,r.clusterData=void 0,r.globalCata=void 0,r.categories=void 0,r.getChartRef=function(e){return r.chartRef=e},r.getTableRef=function(e){return r.tableRef=e},r.getOptions=function(e,a){return{tooltip:{showDelay:200,hideDelay:500,enterable:!0,padding:0,position:function(e,t,n,a,r){var i=r.contentSize,o=r.viewSize,r=e[0]<o[0]/2?0:-1,o=e[1]<o[1]/2?-.5:-1;return[e[0]+r*i[0],e[1]+o*i[1]]},formatter:function(e,t,n){return setTimeout(function(){n(t,(0,m.r)(e.marker+" "+e.name,["声量："+(0,f.hE)(e.data.oriValue)],[{title:"消息",icon:"icon-cem_jump-message",callback:function(){return r.handleOnMsgClick(e,a)}}]))},0)}},series:{name:"opinionWordCloud",type:"wordCloud",shape:"circle",left:"center",top:"center",sizeRange:[12,60],gridSize:6,rotationRange:[0,0],drawOutOfBound:!1,data:e,textStyle:{emphasis:{color:"#D8D8D8"}}}}},r}return l()(e,a),e.prototype.renderChart=function(e,t){this.chartRef.clear(),this.chartRef.setOption(this.getOptions(e,t))},e}(_().Component),P=n(33905);const Z=function(t){function e(e){var a=t.call(this,e)||this;a.renderWordOverlay=function(t){return _().createElement("div",{onClick:function(e){e.stopPropagation()}},_().createElement("span",null,t),_().createElement("span",{onClick:function(e){return a.handleOnFilter(t)}},"隐藏"))},a.handleOnFilter=function(t){var e=a.state,n=e.page,e=e.data.filter(function(e){return e.name!==t});a.setState({data:e,cluData:e.slice(30*(n-1),30*n)})},a.handleOnClick=function(e){var t=a.props.onClick;t&&t(e)},a.handleOnPageChange=function(e){var t=a.state.data;a.setState({page:e,cluData:t.slice(30*(e-1),30*e)})};e=e.data,e=void 0===e?[]:e;return a.state={data:e,oriData:[],page:1,cluData:e.slice(0,30)},a}return l()(e,t),e.getDerivedStateFromProps=function(e,t){return JSON.stringify(e.data)!==JSON.stringify(t.oriData)?{oriData:e.data,data:e.data,cluData:e.data.slice(0,30),page:1}:null},e.prototype.render=function(){var a=this,e=this.state,t=e.cluData,r=e.page,n=e.data,i=this.props,e=i.style,i=i.getTableRef,o=JSON.parse(JSON.stringify(t));if(o.length<30)for(var l=3-o.length,c=0;c<30-l;c++)o.push(void 0);return _().createElement("div",{className:"yt_wordcloud_opinion_list_wrapper",style:e,ref:i},_().createElement("div",{className:"opinion_list"},o.map(function(t,e){var n=30*(r-1)+e+1;return _().createElement("div",{key:t?t.name:e},t?_().createElement(_().Fragment,null,_().createElement(D.Z,{overlayClassName:"popover-detail-wrodcloud-list-wrapper",placement:"top",overlay:a.renderWordOverlay(t.name)},_().createElement("span",{className:"option-item ",onClick:function(e){return a.handleOnClick(t.name,n)}},_().createElement("span",null,_().createElement("span",{style:{backgroundColor:""+(n<7?P.rf[n%P.rf.length]:"#8c8c8c")}},n)),_().createElement("span",null,t.name),_().createElement("span",null,(0,f.hE)(t.oriValue)),_().createElement("span",null,"("+(100*t.ratio).toFixed(2)+"%)")))):null)})),30<n.length&&_().createElement("div",{style:{textAlign:"right"}},_().createElement(O.Pagination,{className:"oppion-word-pagination",layout:"prev, pager, next",total:n.length,pageSize:30,currentPage:r,small:!0,onCurrentChange:this.handleOnPageChange})))},e}(_().Component);t=function(n){function e(e){var r=n.call(this,e)||this;return r.handleOnMoreClick=function(e){var t=r.props.title,n=r.state,a=n.data,n=n.chartType;"image"===e&&r.chartRef?"chart"===n?(0,s._v)(r.chartRef,t):(0,s.Mx)(r.tableRef,t):"data"===e&&(0,h.P)(a)&&a instanceof Array&&(0,s.aT)([[["关键词","声量","占比"]].concat(a.map(function(e){return[e.name,e.oriValue,(100*e.ratio).toFixed(2)+"%"]}))],t)},r.handleOnChange=function(e){var t=r.props.onChange;t&&t({clusterLevel:e})},r.handleOnMsgClick=function(e,t){r.props.onMsgClick(e,t,"word")},r.state={chartType:"chart",data:void 0},r}l()(e,n),e.getDerivedStateFromProps=function(e,t){if(JSON.stringify(e.data)===JSON.stringify(t.data))return null;var n,e=e.data;return e instanceof Array&&(n=e.reduce(function(e,t){return e+t.value},0),e=e.map(function(e){var t=e.name,e=e.value;return{ratio:n?e/n:0,value:Math.sqrt(e),name:t,oriValue:e}}).sort(function(e,t){return t.oriValue-e.oriValue})),{data:e}};var t=e.prototype;return t.componentDidMount=function(){var a=this;this.internalId=setInterval(function(){var e,t,n;a.chartRef&&(clearInterval(a.internalId),a.renderChart(),t=(e=a.chartRef._dom.children)[0],n=e[1],t.addEventListener("mouseleave",function(e){a.chartLeaveTimeout=setTimeout(function(){a.chartLeaveTimeout&&(n.style.display="none")},2e3)}),n&&n.addEventListener("mouseenter",function(e){a.chartLeaveTimeout=void 0}))},200)},t.componentDidUpdate=function(e,t){var n=t.data,t=this.state.data;(0,h.P)(t)&&JSON.stringify(n)!==JSON.stringify(t)&&this.renderChart(),!(0,h.P)(t)&&this.chartRef&&(this.chartRef=void 0)},t.renderChart=function(){var e=this.props.title,t=this.state.data;(0,h.P)(t)&&t instanceof Array&&this.chartRef&&n.prototype.renderChart.call(this,t,e)},t.render=function(){var e=this,t=this.state,n=t.data,a=t.chartType,r=this.props,i=r.title,o=r.options,l=r.clusterLevel,c=r.className,s=void 0===c?"":c,u=r.wsRunning,t=void 0,c=void 0,r=!1;return(0,h.P)(n)&&"number"==typeof n?1===n?(r=!0,t=n):(t="error",2===n?c="当前消息中少于20个观点，无法启动典型意见":3===n?c="当前少于50条消息，无法启动典型意见":4===n&&(c="当前大于50万条消息，无法启动典型意见")):t=n,_().createElement(h.Z,{className:"yt_scene_bar_chart_wrapper "+(c?"yt_scene_bar_chart_error_wrapper":"")+" "+s+" ",data:t,errorHint:c,loading:r,renderTitle:_().createElement(d.Z,{title:i,data:void 0,onMoreClick:this.handleOnMoreClick,titleOverlay:_().createElement(_().Fragment,null,_().createElement("div",null,"该数据为您显示：由于所选的消息中不光会有与中心指标情感相关的观点，还会有其他相关指标和情感的观点，用户可以自主控制是否展示仅展示中心指标情感相关的观点；同时对于聚类的观点粗细程度也可以由用户选择。"),_().createElement("div",null,"算法说明：典型意见的获得大致经历如下几个步骤：①从消息中抽取观点→②对观点聚类→③选举中心观点。在以上步骤上，用户可以在①之后选择即将聚类的观点是否与中心指标情感相关；在②用户可以选择聚类的粗细程序，参数设置越小，聚类的观点越细；在③可能会选举出与中心指标的情感相关的观点，这是用户可以选择排除该中心观点，系统会自动给出第二备选的观点。"),_().createElement("div",null,"名词辨析：典型意见即观点，是一个聚类出的观点簇中的代表。"))},_().createElement(D.Z,{overlay:"当前图表显示的是前5000条消息的典型意见结算结果，系统正在计算全部消息的典型意见，计算好之后会自动刷新图表",placement:"top",overlayClassName:"alert-log-tips"},_().createElement("i",{className:"icon-cem_refresh "+(u?"refreshing":"")+" ",style:{display:u?"inline-block":"none"}})),_().createElement(p.Z,{preTitle:"聚类颗粒",activeObj:l,options:o,onChange:this.handleOnChange}),_().createElement(D.Z,{placement:"top",overlay:"词云图"},_().createElement("span",{onClick:function(){return e.setState({chartType:"chart"})}},_().createElement(S.Z,{isActive:"chart"===a,defaultIcon:"cem_terms",activeIcon:"cem_terms-color"}))),_().createElement(D.Z,{placement:"top",overlay:"数据表格"},_().createElement("span",{onClick:function(){return e.setState({chartType:"table"})}},_().createElement(S.Z,{isActive:"table"===a,defaultIcon:"cem_word-list",activeIcon:"cem_word-list-color"}))),_().createElement("div",{className:"v-divider"}))},_().createElement(C.Z,{onChartReady:this.getChartRef,theme:"yunting_multi_color",option:{},style:{height:"100%",display:"chart"===a?"block":"none"}}),(0,h.P)(t)&&t instanceof Array&&_().createElement(Z,{data:t,getTableRef:this.getTableRef,onClick:this.handleOnMsgClick,style:{height:"100%",display:"table"===a?"block":"none"}}))},e}(t);const j=t;t.propTypes={className:i().string,data:i().any,loading:i().bool,title:i().string,clusterLevel:i().string,onChange:i().func,onMsgClick:i().func,options:i().arrayOf(i().shape({title:i().string,value:i().string,disabled:i().bool}))};const V=function(e){var t=e.c1Data,n=e.c1TimeType,a=e.fetchingC1Data,r=e.timeOpts,i=e.c2Data,o=e.c2AnalyzeObj,l=e.topicOpts,c=e.fetchingC2Data,s=e.c3Data,u=e.fetchingC3Data,h=e.c4Data,d=e.c4SelectedObjs,p=e.compareOpts,f=e.fetchingC4Data,m=e.c4DefaultName,g=e.c5Data,v=e.c5AspectLevel,C=e.fetchingC5Data,y=e.c6Data,E=e.clusterLevel,O=e.clusterLevelOpts,b=e.wsRunning,S=e.target,D=e.aspectName,T=e.topicName,k=e.onMsgClick,e=e.onFilterChange;return _().createElement("div",{className:"yt_drill_down_scene_wrapper"},_().createElement(N.Z,{title:"详情："+S.name+"，"+D}),_().createElement("div",{className:"content"},_().createElement("div",{className:"chart_group_a"},_().createElement(R,{title:"场景标签「"+D+"」声量走势",data:t,timeType:n,timeOptions:r,loading:a,onMsgClick:k,onFilterChange:e}),_().createElement(x,{title:"场景标签「"+D+"」声量分布",value:i,loading:c,topicObj:o,topicOpts:l,onMsgClick:k,onFilterChange:e})),_().createElement("div",{className:"chart_group_b"},_().createElement(w,{title:"与其他场景标签的关联分析",data:s,loading:u,onMsgClick:k,aspectName:D}),_().createElement(A,{data:h,options:p,loading:f,title:T+"对比",selectedObjs:d,defaultName:m,topicName:T,onMsgClick:k,onChange:e})),_().createElement(F,{className:"chart_group_c",data:g,loading:C,title:"指标情感分析",aspectLevel:v,onMsgClick:k,onChange:e}),_().createElement(j,{className:"chart_group_d",title:"典型意见",data:y,options:O,clusterLevel:E,onMsgClick:k,onChange:e,wsRunning:b})))};var J=n(35239),t=n(64396),i=n(55609),z=n(87219),B=n(97194),W=n(11765),U={SCENE_SEX:"user.gender",SCENE_AGE:"user.age",SCENE_USE_SCENE:"space",SCENE_USE:"usage",SCENE_BUY_DECISION:"buy_decision",SCENE_RELATION:"relation",SCENE_MY_ADVICE:"suggestion"},G=t.Z.drillDown.sceneAnalyze,t=function(t){function e(e){var C=t.call(this,e)||this;return C._handleOnMsgClick=function(e,t,n){var a=C.props,r=a.projectId,i=a.dateFilter,o=a.filterModel,l=a.analysisModel,c=a.oriFilterModel,s=a.c1TimeType,u=a.c1Data,h=a.c2Data,d=a.c2AnalyzeObj,p=a.c4Data,f=a.c5AspectLevel,m=a.taskId,g=e.name,v=e.componentSubType,a=e.data,l=l[0].values[0].id,o="trend"===n?o:"aspect"===n?(0,W.gt)(c,a[1].split(":")[1],a[0]):"config"===n?(0,W.DR)(o,p.find(function(e){return e.name===g}).id,l):"model"===n?(0,W.c6)(o,e[0].name,[f,1<e.length?"total":e[0].seriesName]):"allConfig"===n?(0,W.DR)(o,h.find(function(e){return e.name===g}).id,d):o,m="word"===n?{clusterLevel:20,content:[{contain:[]}],opinion:g,taskId:m}:{},t={projectId:r,dateFilter:u instanceof Array&&0<u.length?(0,E.X_)(v,i,g,u.map(function(e){return e.name}),s):i,filterModel:y()({project:[r],messageType:["MESSAGE_COMMENT"]},m),newFilterModel:o,filterTip:"产品洞察/场景挖掘/分析详情/"+t};window.open("/inbox/public?"+encodeURIComponent(JSON.stringify(t)))},C._handleOnWsMessage=function(e){var t,n,a,r,i,o,l=e.data;l.type&&"ws"===l.type&&(a=(n=l.payload).type,t=n.result,"OPINION_TASK_RESULT"===a&&(e=(r=C.props).clusterLevelOpts,l=r.taskId,n=r.tmpC6Data,a=t.taskId,r=t.clusterLevel,i=t.data,a===l&&(o=String(r),-1===r?C.props.fetchOpinionData({clusterLevel:"20",wsRunning:!1,clusterLevelOpts:(0,z.ZP)(e,function(e){e.forEach(function(e){return e.disabled=!1})})}):(e={clusterLevel:o,tmpC6Data:(0,z.ZP)(n,function(e){e[o]=i}),clusterLevelOpts:(0,z.ZP)(e,function(e){e=e.find(function(e){return e.value===o});e&&(e.disabled=!1)})},20===r&&(e.c6Data=e.tmpC6Data[o]),C.props.save(e)))))},C._handleOnFilterChange=function(e){e.c1TimeType?C.props.fetchC1Data(e):e.c2AnalyzeObj?C.props.fetchC2Data(e):e.c4SelectedObjs?C.props.fetchC4Data(e):e.c5AspectLevel?C.props.fetchC5Data(e):e.clusterLevel&&C.props.fetchOpinionData(e)},C.state={},C.event={onFilterChange:C._handleOnFilterChange,onMsgClick:C._handleOnMsgClick},C}l()(e,t);var n=e.prototype;return n.componentDidMount=function(){var e=JSON.parse(decodeURIComponent(this.props.location.search.substr(1))),t=e.pageType,n=e.name,a=e.aspectObj,r=void 0===a?{id:void 0,name:void 0}:a,i=e.target,o=void 0===i?{id:void 0,name:void 0}:i,l=e.filterModel,c=void 0===l?[]:l,s=e.compareOpts,u=void 0===s?[]:s,h=e.dateFilter,d=void 0===h?{}:h,p=e.analysisModel,a=void 0===p?[]:p,i=e.oriFilterModel,l=[],s=[],h=[],p="",f="",e="";try{s=(0,B.X)(d.numOfDays).dateOptions,p=a[0].values[0].label,f=a[0].values[0].id,e=(l=J.t.get(J.V.configOptions).filter(function(e){return e.value!==f}))[0].value||"",h="全选"===o.name?[]:u.map(function(e){return e.value})}catch(e){console.log(e)}this.props.fetchData({projectId:J.t.get(J.V.curProject).id,pageType:t,sceneName:n,target:o,filterModel:c,analysisModel:a,dateFilter:d,topicOpts:l,timeOpts:s,c4SelectedObjs:h,aspectName:r.name,aspectId:r.id,aspectIdKey:U[r.id],topicName:p,topicId:f,c2AnalyzeObj:e,oriFilterModel:i}),window.addEventListener("message",this._handleOnWsMessage)},n.componentWillUnmount=function(){window.removeEventListener("message",this._handleOnWsMessage)},n.render=function(){return _().createElement(V,y()({},this.props,this.state,this.event))},e}(g.Component);const q=(0,i.connect)(function(e){var t=e.loading,e=r()(e,["loading"]);return y()({},e[[G]],{fetchingC1Data:t.effects[G+"/fetchC1Data"]||!1,fetchingC2Data:t.effects[G+"/fetchC2Data"]||!1,fetchingC3Data:t.effects[G+"/fetchC3Data"]||!1,fetchingC4Data:t.effects[G+"/fetchC4Data"]||!1,fetchingC5Data:t.effects[G+"/fetchC5Data"]||!1,fetchingC6Data:t.effects[G+"/fetchC6Data"]||!1})},function(t){return{save:function(e){return t({type:G+"/save",payload:e})},fetchData:function(e){return t({type:G+"/fetchData",payload:e})},wordcloudReducer:function(e){return t({type:G+"/wordcloudReducer",payload:e})},fetchC1Data:function(e){return t({type:G+"/fetchC1Data",payload:e})},fetchC2Data:function(e){return t({type:G+"/fetchC2Data",payload:e})},fetchC4Data:function(e){return t({type:G+"/fetchC4Data",payload:e})},fetchC5Data:function(e){return t({type:G+"/fetchC5Data",payload:e})},fetchOpinionData:function(e){return t({type:G+"/fetchOpinionData",payload:e})}}})(t)},11765:(e,t,n)=>{"use strict";n.d(t,{gt:()=>a,DR:()=>o,c6:()=>l});var t=n(67154),r=n.n(t),i=(n(2329),{"性别":"SCENE_SEX","年龄段":"SCENE_AGE","年龄":"SCENE_AGE","关系":"SCENE_RELATION","使用场合":"SCENE_USE_SCENE","用途":"SCENE_USE","购买决策":"SCENE_BUY_DECISION","用户建议":"SCENE_MY_ADVICE"}),a=function(e,t,n){var a=e.find(function(e){return"SCENE_ASPECT"===e.id});return[].concat(e.filter(function(e){return"SCENE_ASPECT"!==e.id}).map(function(e){return r()({},e)}),[{id:"SCENE_ASPECT",isSelectAll:a&&a.isSelectAll?a.isSelectAll:null,values:a?[].concat(a.values.map(function(e){return r()({},e)}),[{id:i[n],values:[t]}]):[{id:i[n],values:[t]}]}])},o=function(e,t,n){var a=e.find(function(e){return"CONFIG"===e.id});return[].concat(e.filter(function(e){return"CONFIG"!==e.id}).map(function(e){return r()({},e)}),[{id:"CONFIG",isSelectAll:a&&a.isSelectAll?a.isSelectAll:null,values:[].concat(a.values.filter(function(e){return e.id!==n}).map(function(e){return r()({},e)}),[{id:n,values:[t]}])}])},l=function(e,t,n){var a=e.find(function(e){return"ASPECT_MODEL"===e.id});return[].concat(e.filter(function(e){return"ASPECT_MODEL"!==e.id}).map(function(e){return r()({},e)}),[{id:"ASPECT_MODEL",values:a?[].concat(a.values.filter(function(e){return e.id!==n[0]&&"ASPECT_ESCORE"!==e.id}).map(function(e){return r()({},e)}),[{id:n[0],values:[t]},{id:"ASPECT_ESCORE",values:n[1].includes("负面")?["3"]:n[1].includes("正面")?["8"]:["3","8"]}]):[{id:n[0],values:[t]},{id:"ASPECT_ESCORE",values:n[1].includes("负面")?["3"]:n[1].includes("正面")?["8"]:["3","8"]}]}])}},33905:(e,t,n)=>{"use strict";n.d(t,{kQ:()=>o,ao:()=>s,yc:()=>l,ch:()=>i,rf:()=>a,t7:()=>r,KT:()=>c});var t=n(67154),a=["#1550B3","#CC6A77","#119073","#CDB446","#D969BF","#2684FF","#C8662B","#9369D9","#0E97AD","#1BBF69","#D07B49","#61799B","#1EA082","#A9A557","#D8727F"],r=["#3D85FF","#FFA7B2","#15D4A9","#F7D956","#FF9FE9","#75B1FF","#FF9E63","#C7A6FF","#1AC9E5","#47F79B","#FFA875","#4D6282","#2EE0B7","#D2CE77","#FF9FAC"],i=["#D96969","#15B374"],o={barWidth:21,barGap:"30%",barCategoryGap:20,height:300,marginTop:40,marginBottom:40},l=function(e,t){switch(e){case"s1":return t;case"s2":return"positive"===t?"positiveWeight1":"negativeWeight1";case"s3":return"positive"===t?"positiveA":"negativeA";case"s4":return"positive"===t?"positiveB":"negativeB";case"s5":return"positive"===t?"positiveC":"negativeC"}},c=function(e,n,t,a){if(a.length<1)return a;var r=l(t,e),e=JSON.parse(JSON.stringify(a)).map(function(e){return e.data=[],e});return e.forEach(function(e,t){e.data=JSON.parse(JSON.stringify(a[t])).data.sort(function(e,t){return"asc"===n?e[r]-t[r]:"desc"===n?t[r]-e[r]:null})}),e},s=function(e){return 0<=e&&e<1e3?e:e<1e4?(e/1e3).toFixed(2)+"千":(e/1e4).toFixed(2)+"万"}}}]);