(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[157],{24473:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var a=n(67154),p=n.n(a),i=n(37316),f=n.n(i),t=n(85354),r=n.n(t),a=n(67294),d=n.n(a),i=n(45697),t=n.n(i),i=n(94184),h=n.n(i),a=function(e){function t(){return e.apply(this,arguments)||this}return r()(t,e),t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.children,a=e.className,i=e.block,r=e.indeterminate,l=e.value,s=e.checked,c=e.defaultChecked,o=e.onChange,u=e.disabled,e=f()(e,["prefixCls","children","className","block","indeterminate","value","checked","defaultChecked","onChange","disabled"]),o={value:l,checked:s,defaultChecked:c,onChange:o,disabled:u},a=h()(t,((u={})[t+"-disabled"]=o.disabled,u[t+"-block"]=i,u[t+"-indeterminate"]=r,u),a);return d().createElement("label",p()({tabIndex:o.disabled?-1:0,className:a},e),d().createElement("input",p()({type:"checkbox",className:t+"-input"},o)),d().createElement("span",{className:t+"-status"}),n&&d().createElement("span",{className:t+"-text",title:n},n))},t}(a.Component);a.propTypes={prefixCls:t().string,value:t().oneOfType([t().string,t().number]),checked:t().bool,defaultChecked:t().bool,onChange:t().func,indeterminate:t().bool,disabled:t().bool,block:t().bool},a.defaultProps={prefixCls:"wt-checkbox"};const l=a},85151:(e,t,n)=>{"use strict";n.d(t,{Jg:()=>a.Z,CS:()=>s});var a=n(24473),i=n(67154),c=n.n(i),r=n(37316),o=n.n(r),t=n(85354),l=n.n(t),i=n(67294),u=n.n(i),r=n(45697),t=n.n(r),r=n(94184),p=n.n(r),r=function(i){function e(){for(var n,e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(n=i.call.apply(i,[this].concat(t))||this).handleCheckBoxChange=function(e){var t=n.props.onChange;t&&t(e)},n}return l()(e,i),e.prototype.render=function(){var i=this,e=this.props,t=e.prefixCls,n=e.children,a=e.className,r=(e.onChange,e.values),l=e.checkedList,s=e.block,e=o()(e,["prefixCls","children","className","onChange","values","checkedList","block"]),n=r?r.map(function(e,t){var n=0!==l.length&&-1!==l.indexOf(e);return u().createElement(Checkbox,{key:t,value:e,checked:n,onChange:function(e){return i.handleCheckBoxChange(e)},block:s},e)}):u().Children.map(n,function(e,t){if(e){var n=e.props,a=n.value,a=0!==l.length&&-1!==l.indexOf(a);return u().cloneElement(e,{checked:a,key:t,block:n.block||s,onChange:function(){var e=n.value;i.handleCheckBoxChange(e)}})}});return u().createElement("div",c()({className:p()(t,a)},e),n)},e}(i.Component);r.defaultProps={prefixCls:"wt-checkbox-group"},r.propTypes={onChange:t().func,values:t().array,block:t().bool};const s=r;var f=function(t){var n={};return Object.keys(t).forEach(function(e){/^data\-.+$/.test(e)&&(n[e]=t[e])}),n},i=function(e){function t(){return e.apply(this,arguments)||this}return l()(t,e),t.prototype.render=function(){var e=this.props,t=f(e);return u().createElement("label",{className:e.className,title:e.children},u().createElement("div",{className:"checkbox"},u().createElement("input",c()({checked:e.checked,type:"checkbox",name:e.name,onChange:e.onChange,disabled:e.disabled},t)),u().createElement("div",{className:"checkbox-body"}))," ",u().createElement("span",null,e.children))},t}(i.Component);i.defaultProps={className:"",name:"",checked:!1,disabled:!1,onChange:function(e){return e}}},66161:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var t=n(93913),a=n.n(t),t=n(85354),i=n.n(t),t=n(67294),o=n.n(t),u=n(85151);const r=function(t){function e(e){var n=t.call(this,e)||this;return n.handleClear=function(e){var t=n.state.list;t.forEach(function(e){return e.sel=!1}),n.setState({list:t},function(e){return n.commitUserSel()})},n.hoverDropToggle=function(e){n.state.open&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()),setTimeout(function(){n.setState({open:!n.state.open})},0)},n.closeDrop=function(e){n.state.open&&n.setState({open:!1})},n.initializeList=function(){var e;n.props.value&&((e=JSON.parse(JSON.stringify(n.state.list))).forEach(function(e){e.sel=-1!==n.props.value.indexOf(String(e.id))||-1!==n.props.value.indexOf(Number(e.id))}),n.setState({list:e}))},n.state={list:JSON.parse(JSON.stringify(e.list||[])),searchKeyWords:"",open:!1,timeout:""},n}i()(e,t);var n=e.prototype;return n.search=function(){this.setState({searchKeyWords:this.searchInput.value})},n.handleChecked=function(t){var n=this,e=this.state.list;this.props.singleSel?e.forEach(function(e){e.sel=e.id===t}):e.forEach(function(e){e.id===t&&(e.sel=!e.sel)}),this.setState({list:e},function(e){return n.commitUserSel()})},n.handleCheckedAll=function(){var t=this,n=!this.checkedAll,e=this.state.list;e.forEach(function(e){return e.sel=n}),this.setState({list:e},function(e){return t.commitUserSel()})},n.commitUserSel=function(){this.props.singleSel?this.props.onSel(this.selList[0]?this.selList[0].id||this.selList[0].val:""):this.props.onSel(this.selList)},n.UNSAFE_componentWillReceiveProps=function(t,e){var n;t.list&&((n=JSON.parse(JSON.stringify(t.list))).forEach(function(e){e.sel=-1!==t.value.indexOf(String(e.id))||-1!==t.value.indexOf(Number(e.id))}),this.setState({list:n}))},n.componentDidMount=function(){this.initializeList(),window.addEventListener("click",this.closeDrop)},n.componentWillUnmount=function(){window.removeEventListener("click",this.closeDrop)},n.render=function(){var n=this,e=this.props,t=e.classNames,a=e.style,i=e.title,r=e.selectPosition,l=e.special,s=this.state,c=s.list,e=s.searchKeyWords,s=s.open,c=0<e.length?this.searchList:c;return o().createElement("div",{className:(t||"")+" search-select-wrap",onClick:function(e){n.hoverDropToggle(e)},style:a},o().createElement("div",{className:s?"open sel-wrap":"sel-wrap"},o().createElement("span",{className:"title"},i+(l?"":"：")),!l&&(0<this.selList.length?this.selList.map(function(e,t){return o().createElement("span",{key:t},e.name,t===n.selList.length-1?"":" ,")}):o().createElement("span",null,this.props.singleSel?"请选择":"全部")),o().createElement("i",{className:"icon-cem_pull-down-or-take-up",style:{transform:s?"rotate(-180deg)":""}})),s&&o().createElement("div",{className:r+" allSelContent",style:{left:"left"===r?"0":"",right:"right"===r?"0":""}},o().createElement("div",{className:"search"},o().createElement("p",null,o().createElement("input",{onClick:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},placeholder:"请输入搜索关键词",ref:function(e){return n.searchInput=e},type:"text",onChange:function(e){return n.search()}})),o().createElement("p",null,o().createElement("span",{onClick:function(e){return n.handleClear()}},"清除已选项目"))),0<c.length?o().createElement("div",{className:"all"},!this.props.singleSel&&e.length<1&&o().createElement(u.Jg,{checked:this.checkedAll,indeterminate:this.indeterminate,onChange:function(){return n.handleCheckedAll()},block:!0},"全选"),c.map(function(e){return o().createElement(u.Jg,{key:e.id,value:e.id,checked:e.sel,onChange:function(){return n.handleChecked(e.id)},block:!0},e.name)})):o().createElement("div",{className:"all"},"无选项")))},a()(e,[{key:"selList",get:function(){return this.state.list.filter(function(e,t){return e.sel})}},{key:"checkedAll",get:function(){return this.state.list.every(function(e){return e.sel})}},{key:"indeterminate",get:function(){return!this.checkedAll&&this.state.list.some(function(e){return e.sel})}},{key:"searchList",get:function(){var t=this;return this.state.list.filter(function(e){return e.name.toLocaleLowerCase().includes(t.state.searchKeyWords.trim().toLocaleLowerCase())})}}]),e}(t.Component)},80157:(e,t,n)=>{"use strict";n.d(t,{Z:()=>F});var a=n(67154),p=n.n(a),i=n(85354),r=n.n(i),l=n(67294),f=n.n(l),s=n(36144),u=n(66161),d={project:"项目",topic:"主题",source:"数据来源",escore:"情感",star:"星级",messageType:"消息类型",keyword:"关键词",content:"内容",taskTypes:"任务类型"},t=n(45697),a=n.n(t),o=n(92360),c={opacity:"0",pointEvent:"none"},h=function(t){function e(e){var r=t.call(this,e)||this;r.onSelectChange=function(e){r.setState({data:Object.assign(e)},function(){return r.changeSelectConfig(e)})},r.onInputChange=function(e,t,n){var a=r.state.data;a[e][t].value=n,r.setState({data:a},function(){return r.changeSelectConfig(a)})},r.delContent=function(e,t){var n=r.state.data;n[e].splice(t,1),0===n[e].length&&n.splice(e,1),r.setState({data:n},function(){return r.changeSelectConfig(n)})},r.addAndContent=function(e){var t=r.state.data;t[e].push({name:"",operator:"contains",value:""}),r.setState({data:t})},r.addOrContent=function(){var e=r.state.data;e.push([{name:"",operator:"contains",value:""}]),r.setState({data:e})},r.changeSelectConfig=function(e){var i=[];e.forEach(function(e,t){var n=[],a=[];e.forEach(function(e){"contains"===e.operator&&e.value&&n.push(e.value),"notContains"===e.operator&&e.value&&a.push(e.value)});e={};0<n.length&&(e.contain=n),0<a.length&&(e.notContain=a),i[t]=e}),r.props.changeSelectConfig("content",i)};var e=e.data,a=[[{name:"",operator:"contains",value:""}]];return e&&e.length&&e.forEach(function(e,t){var n=[];e.contain&&e.contain.forEach(function(e){n.push({name:"",operator:"contains",value:e})}),e.notContain&&e.notContain.forEach(function(e){n.push({name:"",operator:"notContains",value:e})}),0!==n.length&&(a[t]=n)}),r.state={data:a},r}r()(e,t);var n=e.prototype;return n.UNSAFE_componentWillReceiveProps=function(e){for(var t in e)e.hasOwnProperty(t)&&(t=e[t],this.setState({prop:t}))},n.render=function(){var a=this,e=this.props,t=e.name,i=e.options,e=e.className,r=this.state.data,e=e?e+" mulcondition-filter-wrap":"mulcondition-filter-wrap";return f().createElement("div",{className:e},f().createElement("div",{className:"mulcondition-filter-name"},t),f().createElement("ul",{className:"filter-cont"},r.map(function(e,n){return f().createElement("li",{className:"filter-state-item",key:n},f().createElement("div",{className:"state-tip"},0===n?"如果":"或"),f().createElement("ul",{className:"state-cont"},e.map(function(e,t){return f().createElement("li",{className:"filter-content-item",key:t},f().createElement("span",{className:"content-title"},"内容"),f().createElement(o.Select,{className:"tagSetSelect height30",value:e.operator,onChange:function(e){r[n][t].operator=e,a.onSelectChange(r)}},i.map(function(e,t){return f().createElement(o.Select.Option,{key:t,label:e.label,value:e.value})})),f().createElement(o.Input,{value:e.value,className:"tagSetInput height30",onChange:function(e){a.onInputChange(n,t,e)}}),f().createElement("i",{onClick:a.delContent.bind(a,n,t),className:"el-icon-close",style:1===r.length&&1===r[0].length?c:{}}))}),f().createElement("div",{className:"and-btn ele-btn"},f().createElement(o.Button,{onClick:a.addAndContent.bind(a,n),className:"tagSetButton height30",type:"info",plain:!0},"且   +"))))}),f().createElement("div",{className:"or-btn ele-btn"},f().createElement(o.Button,{onClick:this.addOrContent.bind(this,r.name),className:"wrapButton height30",type:"info",plain:!0},"或   +"))))},e}(l.Component);h.defaultProps={data:[[{name:"",operator:"contains",value:""}]],name:"内容",options:[{value:"contains",label:"包含"},{value:"notContains",label:"不包含"}]},h.propTypes={className:a().string,data:a().array,name:a().string,options:a().array};var m=function(t){function e(e){var l=t.call(this,e)||this;return l.inputChange=function(e){l.setState({inputVal:e.target.value})},l.keywordChange=function(e){var t=l.state,n=t.inputVal,t=t.inputValMap;"keydown"===e.type&&13===e.keyCode?e.target.blur():"keydown"===e.type&&32===e.keyCode?n.trim()&&(t.push(n.trim()),l.setState({inputValMap:t,inputVal:""})):"keydown"===e.type&&8===e.keyCode?!n&&t&&0<t.length&&(t.splice(t.length-1,1),l.setState({inputValMap:t})):"blur"===e.type&&(n.trim()&&(t.push(n.trim()),l.setState({inputValMap:t,inputVal:""})),l.handleSel("keyword","keyword",t))},l.findShowConfig=function(){var e=l.props,n=e.selectConfig,t=e.allConfig,e=e.type,a=l.state.showList;if(!t)return null;var i=l.dataFormat(),r=[];switch(e){case"dialog":i.filter(function(t){return t.values&&0<t.values.length||0<=a.indexOf(t.id)&&0===r.filter(function(e){return e.id===t.id}).length}).map(function(e){return r.push(e)});break;case"header":default:r=[],a.length?i.filter(function(e){return 0<=a.indexOf(e.id)}).map(function(e){return r.push(e)}):i.forEach(function(t){var e=!1;r.length<4&&(e=!0),n[t.id]&&n[t.id].length&&(e=!0),(e=n[t.type]&&n[t.type].filter(function(e){return e.id===t.id}).length?!0:e)&&r.push(t)})}return{config:r,allConfig:i}},l.getMaxLengthOfFilter=function(e){for(var t=.9*(document.getElementsByClassName("breadcumb-wrapper")[0].clientWidth-48),n=0,a=0,i=0;i<e.length;i++)if(t<=(n+=90+14*e[i].name.length)){a=i;break}return a},l.toggleDisplay=function(){var e=l.state.display;l.setState({display:!e})},l.state={showList:[],inputValMap:[],inputVal:"",showAllConfig:l.props.showAllConfig,maxLength:0,display:!1},l}r()(e,t);var n=e.prototype;return n.addMoreFilter=function(e){var t=this.props,n=t.selectConfig,a=t.changeSelectConfig,i={};e.forEach(function(t){switch(t.type){case"tag":case"connConfig":i[t.type]=i[t.type]||[];var e=n[t.type]?n[t.type].filter(function(e){return e.id===t.id}):[{id:t.id,values:[]}];0<e.length&&i[t.type].push(e[0]);break;default:n[t.type]&&(i[t.type]=n[t.type])}}),this.props.selectConfig.content&&e.some(function(e){return"content"===e.id})&&(i.content=this.props.selectConfig.content),this.setState({showList:e.map(function(e){return e.id})},function(){return JSON.stringify(n)!==JSON.stringify(i)&&a(i)})},n.handleSel=function(t,e,n){var a=this.props,i=a.selectConfig,r=a.changeSelectConfig;a.allConfig;switch(e){case"keyword":i.content=[{contain:n}],delete i.word,r(i);break;case"connConfig":case"tag":var l,s=i[e];s&&s.filter(function(e){return e.id===t}).length?((l=s.filter(function(e){return e.id===t})[0]).values.length!==n.length||0<n.filter(function(e){return l.values.indexOf(e)<0}).length)&&(l.values=n.map(function(e){return e.id}),r(i)):(i[e]=s||[],i[e].push({id:t,values:n.map(function(e){return e.id})}),r(i));break;default:i[e]=n.map(function(e){return e.id}),r(i)}},n.dataFormat=function(){var e=this.props,r=e.selectConfig,l=e.allConfig,e=e.filter;if(!l)return[];var s=[];return e.forEach(function(a){var e=l[a];switch(a){case"source":case"taskTypes":s.push({id:a,type:a,name:d[a],list:e,values:r[a]||[]});break;case"escore":s.push({id:a,type:a,name:d[a],list:[{id:"1",name:"好评"},{id:"0",name:"中评"},{id:"-1",name:"差评"}],values:r[a]});break;case"star":s.push({id:a,type:a,name:d[a],list:[{id:"1",name:"1"},{id:"2",name:"2"},{id:"3",name:"3"},{id:"4",name:"4"},{id:"5",name:"5"}],values:r[a]});break;case"content":s.push({id:a,type:a,name:d[a],values:r[a]});break;case"messageType":s.push({id:a,type:a,name:d[a],list:[{id:"PL",name:"评论"},{id:"ZP",name:"追评"},{id:"TW",name:"提问"},{id:"HD",name:"回答"},{id:"SX",name:"私信"},{id:"YW",name:"原文"},{id:"HF",name:"回复"}],values:r[a]});break;case"connConfig":(l&&l.topics&&l.topics.titles?l.topics.titles.map(function(e){return e.id}):[]).length&&l.topics.titles.forEach(function(t,i){var e=(e=r.connConfig?r.connConfig.filter(function(e){return t.id===e.id}):[]).length?e[0].values:[],n={};l.topics.data&&l.topics.data.length?l.topics.data.filter(function(e){var a=!0;return e.forEach(function(e,t){var n=(n=r.connConfig?r.connConfig.filter(function(e){return l.topics.titles[t].id===e.id}):[]).length?n[0].values:[];t!==i&&n.length&&n.indexOf(e.id)<0&&(a=!1)}),a}).filter(function(e){return e[i].name}).forEach(function(e){n[e[i].id]=e[i]}):t.list&&t.list.filter(function(e){return e.name}).map(function(e){return n[e.id]=e}),l.topics.titles.some(function(e){return e.id===t.id})&&l.topics.titles.some(function(e){return e.id===t.id&&(e.values.some(function(e){return"EMPTY"===e.id})&&(n.EMPTY={id:"EMPTY",name:"(空值)"}),!0)}),s.push({id:t.id,name:t.name,type:"connConfig",list:Object.keys(n).map(function(e){return n[e]}),values:e})});break;case"tag":l.tag&&l.tag.forEach(function(t){var e=JSON.parse(JSON.stringify(t));e.type=a,e.list=t.values.map(function(e){return e});var n=r[a]?r[a].filter(function(e){return e.id===t.id}):[];e.values=0<n.length?n[0].values:[],s.push(e)})}}),s},n.delKeyWords=function(e){var t=this,n=this.state.inputValMap;n.splice(e,1),this.setState({inputValMap:n},function(e){return t.handleSel("keyword","keyword",n)})},n.componentDidMount=function(){this.initData()},n.initData=function(){var e,t=[];this.props.filter.indexOf("keyword")&&this.props.selectConfig&&this.props.selectConfig.word&&(t.push(this.props.selectConfig.word),this.setState({inputValMap:t})),this.props.selectConfig&&this.props.selectConfig.content&&(this.props.selectConfig.content.forEach(function(e){e.contain&&e.contain.forEach(function(e){t.push(e)})}),this.setState({inputValMap:t})),this.state.showAllConfig&&0<this.dataFormat().length&&(e=this.dataFormat().map(function(e){return e.id}),this.setState({showList:e,showAllConfig:!1}))},n.UNSAFE_componentWillReceiveProps=function(e){var t,n,a=this;for(t in e)e.hasOwnProperty(t)&&(n=e[t],"selectConfig"===t?this.setState({prop:n},function(e){a.initData()}):this.setState({prop:n}))},n.buildHeaderFilter=function(){var n=this,e=this.props,t=e.filter,a=e.extraConfig,i=e.onExtraChange,r=this.state,l=r.inputVal,s=r.inputValMap,c=r.display,e=this.findShowConfig();if(!e)return f().createElement("div",null);var r=e.config,e=e.allConfig,o=this.getMaxLengthOfFilter(e);return f().createElement("div",{className:"filter-conditions"},f().createElement("div",{className:"first-line-wrap"},f().createElement("div",{className:"choice-wrapper"},f().createElement("div",null,r.slice(0,"filter"===this.props.type?1/0:4).map(function(e,t){return 0===o||t<o-1?f().createElement(u.Z,{list:e&&e.list,value:e.values||[],onSel:n.handleSel.bind(n,e.id,e.type),title:e.name,key:t}):f().createElement(u.Z,{list:e&&e.list,value:e.values||[],onSel:n.handleSel.bind(n,e.id,e.type),title:e.name,key:t,style:{display:c?"block":"none"}})}),a&&a.map(function(t){return f().createElement(u.Z,{key:t.id,list:t.list,value:t.values||[],title:t.name,onSel:function(e){return i?i[t.id](e):{}}})})),f().createElement("div",{className:"more",onClick:this.toggleDisplay,style:{visibility:r.length>o&&0<o?"visible":"hidden"}},c?"收起":"更多",f().createElement("i",{className:c?"icon-cem_pull-or-take-up":"icon-cem_pull-down-or-take-up"}))),f().createElement("div",{className:"key-word-wrap"},0<=t.indexOf("keyword")&&f().createElement("div",{className:"key-wrap"},s.map(function(e,t){return f().createElement("span",{title:e,className:"key-word",key:e+t},e,f().createElement("i",{onClick:function(){return n.delKeyWords(t)}},"×"))}),s.length<3&&f().createElement("input",{type:"text",className:"keyword-setting",value:l,style:{width:100-33*s.length+"%"},placeholder:0<s.length?"关键词":"关键词(输入空格键以分词)",onChange:this.inputChange,onBlur:this.keywordChange,onKeyDown:this.keywordChange})),"filter"===this.props.type?"":f().createElement(u.Z,{classNames:"search-select-more",list:e,title:"更多",special:!0,style:{width:t.includes("keyword")?"":"97%"},selectPosition:"right",value:r.map(function(e){return e.id}),onSel:function(e){return n.addMoreFilter(e)}}))),0<r.slice("filter"===this.props.type?1/0:4).length&&f().createElement("div",{className:"moreFilter"},r.slice(4).map(function(e,t){return f().createElement("div",{key:"more"+t},f().createElement(u.Z,{list:e&&e.list,value:e.values||[],onSel:n.handleSel.bind(n,e.id,e.type),title:e.name}))})))},n.buildDialogFilter=function(){var a=this,e=this.findShowConfig();if(!e)return f().createElement("div",null);var t=e.config,e=e.allConfig;return f().createElement("div",{className:"filter-conditions border-filters",style:{width:"97%"}},f().createElement(u.Z,{list:e,title:"添加筛选条件",classNames:"dialog",special:!0,style:{width:"130px",float:"right",marginRight:"0"},selectPosition:"right",value:t.map(function(e){return e.id}),onSel:function(e){return a.addMoreFilter(e)}}),f().createElement("div",{className:"moreFilter"},t.map(function(e,t){var n={};return e.values&&e.values.length&&(n.data=e.values),"content"===e.id?f().createElement(h,p()({key:"moreFilter"+t},n,{changeSelectConfig:a.props.changeSelectConfig})):f().createElement(u.Z,{key:"moreFilter"+t,classNames:"dialog",list:e&&e.list,value:e.values||[],onSel:a.handleSel.bind(a,e.id,e.type),title:e.name})})))},n.render=function(){switch(this.props.type){case"header":return this.buildHeaderFilter();case"dialog":return this.buildDialogFilter();default:return this.buildHeaderFilter()}},e}(l.Component),i=n(37316),g=n.n(i),t=n(94184),v=n.n(t),y=n(59776),i={prefixCls:a().string,feature:a().oneOf(["horizontal","vertical","around","bettween"])},t=function(e){function t(){return e.apply(this,arguments)||this}return r()(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.feature,a=e.prefixCls,i=g()(e,["className","feature","prefixCls"]),t=v()(a,((e={})[a+"-"+n]=n,e),t);return f().createElement("div",p()({className:t},i))},t}(l.Component);t.propTypes=i,t.defaultProps={prefixCls:"wt-btn-group",feature:"horizontal"};const C=t;var E=n(85151),S=function(a){function e(){for(var r,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(r=a.call.apply(a,[this].concat(t))||this).handleCheckedAll=function(e){var t=r.props,n=t.ITEMS,a=t.changeState,t=t.checkedList,i=[];e.target.checked?(t.map(function(e){return i.push(e)}),n.filter(function(e){return i.indexOf(e)<0}).map(function(e){return i.push(e)})):t.filter(function(e){return n.indexOf(e)<0}).map(function(e){return i.push(e)}),a&&a(i)},r.handleChange=function(e){Array.prototype.remove=function(e){e=this.indexOf(e);-1<e&&this.splice(e,1)};var t=r.props,n=t.changeState,t=t.checkedList;-1===t.indexOf(e)?t.push(e):t.remove(e),n&&n(t)},r}return r()(e,a),e.prototype.render=function(){var t=this,e=this.props,n=e.ITEMS,a=e.categoryTitle,i=e.titles,r=e.checkedList,l=r.filter(function(e){return 0<=n.indexOf(e)}),e=!!l.length&&l.length===n.length,l=!!l.length&&l.length!==n.length;return f().createElement("div",{className:"checkbox-panel"},f().createElement(E.Jg,{checked:e,indeterminate:l,onChange:this.handleCheckedAll},a||"全选"),f().createElement(E.CS,{checkedList:r,onChange:function(e){return t.handleChange(e)}},n&&n.map(function(e){return f().createElement(E.Jg,{key:e,value:e},i?i[e]:e)})))},e}(l.Component),b=function(a){function e(){for(var c,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(c=a.call.apply(a,[this].concat(t))||this).state={type:"connConfig",labelType:null,label:[],labelList:[]},c.getLabelType=function(){return c.state.labelType},c.selectConfig="",c.updateFilter=function(){var e=c.props,t=e.changeSelectConfig,n=e.selectConfig,a=e.allConfig,e=c.state,i=e.labelType,r=e.label;n.analysis=n.analysis||{},a[i]?n.analysis={type:i.toUpperCase(),values:r}:(a.topics&&a.topics.titles.map(function(e){0<=e.values.map(function(e){return e.id}).indexOf(r[0])&&(n.analysis={type:"CONN_CONFIG",id:e.id,values:r})}),0<a.tag.filter(function(e){return e.id===i}).length&&(n.analysis={type:"TAG",id:i,values:r})),t("analysis",n.analysis)},c.changeState=function(e){c.setState(e,function(){c.updateFilter()})},c.originChange=function(t){var e=c.state.labelList,n=c.props.selectConfig.topic,e=e.filter(function(e){return e.id===t})[0].list.filter(function(t){return!n||!n.length||!t.topicId||0<n.filter(function(e){return 0<=t.topicId.indexOf(e)}).length}).slice(0,1);c.setState({labelType:t,label:e.map(function(e){return e.id})},function(){return c.updateFilter()})},c.getIdNameMapper=function(e,n){var a={},i={},r={},t=c.props.allConfig;return t.project&&t.project.map(function(e){return i[e.id]=e.name}),t.topic&&t.topic.map(function(e){return r[e.id]=e.name}),e.map(function(e){var t=e.parentId||e.parentIds&&e.parentIds[0],t=t?i[t]||r[t]:"";a[e.id]=(t&&!n?t+" - ":"")+e.name}),a},c.buildAspectCheckBoxPanel=function(){var e=c.state,n=e.label,t=e.labelType,a=e.labelList,i=c.props,e=i.allConfig,r=i.selectConfig,a=a.filter(function(e){return e.id===t})[0];if(!a)return f().createElement("div",{style:{padding:"0 0 10px 20px"}},"暂无数据");if("topic"===t)a.list=a.list.filter(function(e){return!r.topic||0===r.topic.length||0<=r.topic.indexOf(e.id)});else if(0<a.list.filter(function(e){return e.topicId}).length){var l={};e.topic.forEach(function(e){return l[e.id]=e.name});var s={};return a.list.map(function(t){t.topicId?t.topicId.forEach(function(e){s[e]=s[e]||[],s[e].push(t)}):(s[""]=s[""]||[],s[""].push(t))}),Object.keys(s).filter(function(e){return!r.topic||0===r.topic.length||0<=r.topic.indexOf(e)}).map(function(e,t){return f().createElement(S,{key:t,changeState:function(e){return c.changeState({label:e})},checkedList:n,ITEMS:s[e].map(function(e){return e.id}),categoryTitle:l[e]||"全部",titles:c.getIdNameMapper(s[e])})})}return f().createElement(S,{changeState:function(e){return c.changeState({label:e})},checkedList:n,ITEMS:a.list.filter(function(e){return""!=e.name}).map(function(e){return e.id}),titles:c.getIdNameMapper(a.list)})},c}r()(e,a);var t=e.prototype;return t.UNSAFE_componentWillReceiveProps=function(){var e=this.props,a=e.selectConfig,n=e.allConfig,e=e.filter;if(n&&JSON.stringify(a)!==this.selectConfig){this.selectConfig=JSON.stringify(a);var t=e[0];if(a&&a.analysis&&a.analysis.type)switch(a.analysis.type){case"CONN_CONFIG":var i,r,l=a.connConfig;r=l&&l.length?l.map(function(e){return e.id}).indexOf(a.analysis.id)<0?(s=a.analysis.id,a.analysis.values.map(function(e){return e})):(i=[],l.map(function(e){return e.values.map(function(e){return i.push(e)})}),a.analysis.values.filter(function(e){return 0<=i.indexOf(e)}).length?(s=a.analysis.id,a.analysis.values.filter(function(e){return 0<=i.indexOf(e)})):l[0].values&&l[0].values.length?(s=l[0].id,[l[0].values[0]]):(s=a.analysis.id,[a.analysis.values[0]])):(t="connConfig",s=a.analysis.id,a.analysis.values);break;case"TAG":var s,c,o,t="tag",l=a.tag;l&&l.length?l.map(function(e){return e.id}).indexOf(a.analysis.id)<0?(s=l[0].id,r=l[0].values&&l[0].values.length?[l[0].values[0]]:[n.tag.filter(function(e){return e.id===s})[0].list[0].id]):(s=a.analysis.id,c=l.filter(function(e){return e.id===s})[0],(r=0<c.values.length?a.analysis.values.filter(function(e){return 0<=c.values.indexOf(e)}):r).length||(l=n.tag.filter(function(e){return e.id===s})[0].values,o=a.tag.filter(function(e){return e.id===s})[0].values,a.analysis&&0<a.analysis.values.length?l.forEach(function(e){if(o.length&&-1<o.indexOf(e.id))return!(r=[e.id])}):r=[])):(s=a.analysis.id,r=a.analysis.values);break;case"MESSAGE_TYPE":(r=a[s=t="messageType"]&&a[s].length?a.analysis.values.filter(function(e){return 0<=a[s].indexOf(e)}).map(function(e){return{id:e}}):a.analysis.values).length||(r=a[s]?[a[s][0]]:[n[s][0].id]);break;default:t=a.analysis.type.toLowerCase(),s=a.analysis.type.toLowerCase(),(r=a[s]&&a[s].length?a.analysis.values.filter(function(e){return 0<=a[s].indexOf(e)}):a.analysis.values).length||(r=a[s]?[a[s][0]]:[n[s][0].id])}else switch(t){case"connConfig":var u=n.topics.titles[0];s=u.id,r=u.values.slice(0,1).map(function(e){return e.id});break;case"tag":u=n.tag[0];s=u.id,r=u.values.slice(0,1).map(function(e){return e.id});break;default:r=n[s=t]?n[t].slice(0,1).map(function(e){return e.id}):[]}var p=[];e.map(function(t){switch(t){case"source":p.push({id:t,name:d[t],list:a[t]&&a[t].length?n[t].filter(function(e){return 0<=a[t].indexOf(e.id)}):n[t]});break;case"connConfig":var e=a.connConfig,i=n.topics.data;e&&n.topics.titles.map(function(t,n){var a=e.filter(function(e){return e.id===t.id&&0<e.values.length});a.length&&0<a[0].values.length&&(i=i.filter(function(e){return 0<=a[0].values.indexOf(e[n].id)}))}),n.topics&&n.topics.titles&&n.topics.titles.map(function(a,n){var e=[];i&&i.map(function(t){0===e.filter(function(e){return e.id===t[n].id}).length&&e.push(t[n])}),p.push({id:a.id,name:a.name,list:e.filter(function(e){return e.name}).sort(function(e,t){var n=a.values.map(function(e){return e.id});return n.indexOf(e.id)-n.indexOf(t.id)})})});break;case"tag":n[t]&&n[t].map(function(e){var n=e.values;a.tag&&a.tag.forEach(function(t){t.id===e.id&&(n=n.filter(function(e){return-1<t.values.indexOf(e.id)}))}),p.push({id:e.id,name:e.name,list:n})})}}),this.changeState({labelList:p,labelType:s,label:r})}},t.render=function(){var t=this,e=this.state,n=e.labelType,e=e.labelList;return this.props.show?"dialog"!==this.props.type?f().createElement("div",null,f().createElement("div",{className:"sub-btn"},f().createElement(C,null,e.map(function(e){return f().createElement(y.Z,{feature:n===e.id?"primary":"minor",key:e.id,onClick:function(){return t.originChange(e.id)}},e.name)}))),f().createElement("div",{style:{borderBottom:"1px solid #ebebeb",marginTop:"12px"}},this.buildAspectCheckBoxPanel())):f().createElement("div",{className:"dialog"},f().createElement("div",{className:"sub-btn"},f().createElement(o.Select,{value:n,onChange:this.originChange,placeholder:""},e&&e.map(function(e,t){return f().createElement(o.Select.Option,{key:t,label:e.name,value:e.id||e.name},e.name)}))),f().createElement("div",null,this.buildAspectCheckBoxPanel())):f().createElement("div",null)},e}(l.Component),k=n(5133),N=n(23939),i={prefixCls:a().string,value:a().oneOfType([a().string,a().number]),defaultValue:a().oneOfType([a().string,a().number]),onChange:a().func,size:a().oneOf(["sm","lg"]),disabled:a().bool,placeholder:a().string},t=function(i){function e(){for(var n,e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(n=i.call.apply(i,[this].concat(t))||this).handleKeyDown=function(e){var t=n.props,t=(t.onKeyDown,t.onPressEnter);t&&13===e.keyCode&&t(e)},n}r()(e,i);var t=e.prototype;return t.focus=function(){this.input.focus()},t.select=function(){this.input.select()},t.render=function(){var t=this,e=this.props,n=e.prefixCls,a=e.className,i=e.size,r=(e.onPressEnter,g()(e,["prefixCls","className","size","onPressEnter"])),a=v()(n,((e={})[n+"-"+i]=i,e),a);return f().createElement("input",p()({ref:function(e){return t.input=e},onKeyDown:this.handleKeyDown,className:a},r))},e}(l.Component);t.propTypes=i,t.defaultProps={prefixCls:"wt-input"};const w=t;t=function(n){function e(e){var t=n.call(this)||this;return t.handleChange=function(e){e=e.target.value;t.setState({value:e}),t.props.onChange&&t.props.onChange(e)},t.handleSearch=function(){t.props.onSearch&&t.props.onSearch(t.state.value)},t.handleKeyDown=function(e){13===e.keyCode&&t.handleSearch()},t.state={value:"value"in e?e.value:e.defaultValue||""},t}r()(e,n);var t=e.prototype;return t.componentWillReceiveProps=function(e){"value"in e&&this.setState({value:e.value})},t.render=function(){var e=this.props,t=e.prefixCls,n=e.text,a=e.className,i=e.mode,r=e.width,l=(e.defaultValue,e.onChange,e.onSearch,e.block),s=e.size,c=e.placeholder,o=g()(e,["prefixCls","text","className","mode","width","defaultValue","onChange","onSearch","block","size","placeholder"]),e=this.state.value;delete o.value;e={width:r,value:e,size:s,placeholder:c},c=v()(t,((c={})[t+"-block"]=l,c[t+"-inner"]="inner"===i,c[t+"-outer"]="outer"===i,c),a),a="inner"===i?"transparent":"primary";return f().createElement("div",p()({className:c},o),f().createElement(w,p()({onChange:this.handleChange,onKeyDown:this.handleKeyDown},e)),f().createElement(y.Z,{tabIndex:"-1",icon:"search",size:s,className:t+"-btn",feature:a,onClick:this.handleSearch},"outer"==i?f().createElement("span",null,n):null))},e}(l.Component);t.defaultProps={prefixCls:"wt-search",placeholder:"请输入关键词",width:"260px",mode:"inner",text:"搜索"},t.propTypes={prefixCls:a().string,value:a().oneOfType([a().string,a().number]),defaultValue:a().oneOfType([a().string,a().number]),onChange:a().func,onSearch:a().func,size:a().oneOf(["sm","lg"]),placeholder:a().string,block:a().bool,mode:a().oneOf(["outer","inner"]),text:a().string};const x=t;var O=n(12234);Array.prototype.remove=function(e){e=this.indexOf(e);-1<e&&this.splice(e,1)};t=function(t){function e(e){var a=t.call(this,e)||this;return a.handleChange=function(e){var t=a.props.changeState,n=a.state.selected;a.setState({selected:n=n===e?"":e,open:!1},function(e){t&&t(n)})},a.dropToggle=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),a.setState({open:!a.state.open},function(e){a.reOneHandler=function(){a.setState({open:!1}),document.removeEventListener("click",a.reOneHandler)},document.addEventListener("click",a.reOneHandler)})},a.stopPop=function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},a.handleSearch=function(t){var e=a.props,n=e.ITEMS;e.titles;a.setState({searchList:n.filter(function(e){return-1!==e.name.indexOf(t)}),showSearchList:!!t})},a.handleEdit=function(e){var t=a.props.handleEdit;t&&t()},a.state={selected:e.selected,searchList:[],showSearchList:!1,open:!1},a}r()(e,t);var n=e.prototype;return n.componentDidMount=function(){var e=this;this.oneHandler=function(){e.setState({open:!1}),document.removeEventListener("click",e.oneHandler)},document.addEventListener("click",this.oneHandler)},n.UNSAFE_componentWillReceiveProps=function(e){e.selected&&this.props.selected!=e.selected&&this.setState({selected:e.selected})},n.componentWillUnmount=function(){document.removeEventListener("click",this.oneHandler),document.removeEventListener("click",this.reOneHandler)},n.render=function(){var n=this,e=this.state,t=e.showSearchList,a=e.searchList,i=e.selected,r=e.open,l=this.props,s=(l.RECENT,l.ITEMS),e=l.title,l=v()("save-drop-select-wrap",((l={})["save-drop-select-open"]=r,l)),a=f().createElement("div",{className:"save-drop-select-over-panel",onClick:this.stopPop},f().createElement(x,{onChange:this.handleSearch,block:!0}),t?f().createElement("div",{className:"search-list"},a.length?a&&a.map(function(t){return f().createElement(N.W,{value:t.id,selected:t.id===i,key:t.id,onClick:function(e){return n.handleChange(t.id)}},t.name)}):f().createElement("div",null,"没有查找的匹配项")):f().createElement("div",{className:"check-list"},s&&s.length?f().createElement("div",{className:"search-checkbox-panel"},f().createElement("div",{className:"sub-title edit-bar"},f().createElement("span",{onClick:this.handleEdit},"编辑")),s&&s.map(function(t){return f().createElement(N.W,{value:t.id,selected:t.id===i,key:t.id,onClick:function(e){return n.handleChange(t.id)}},t.name)})):f().createElement("div",{className:"sub-title",style:{textAlign:"center"}},"没有保存的筛选条件")));return f().createElement("div",{className:l},f().createElement("div",{className:"save-drop-select-box",onClick:this.dropToggle},e||(i&&s&&s.filter(function(e){return e.id===i})[0]?s.filter(function(e){return e.id===i})[0].name:"未选择筛选条件"),f().createElement(O.l,{name:"pull-down-or-take-up"})),r?a:null)},e}(l.Component);t.defaultProps={placeholder:"全部"};const T=t;var L=n(35239),A=function(a){function e(){for(var r,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(r=a.call.apply(a,[this].concat(t))||this).state={saveDialogVisible:!1,dialogVisible:!1,saveFilterId:null,saveConfigList:{all:[],recent:[]},selectConfig:JSON.stringify(r.props.selectConfig),currentName:"",form:{name:""}},r.getList=function(){var e=L.t.get(L.V.curProject).id;return s.h.post("/filter/list",{type:r.props.model,projectId:e}).then(function(e){if(r.setState({saveConfigList:p()({},e.data.result)}),0<e.data.result.all.length&&"#filter"===window.location.hash){e=e.data.result.all[0].id;return r.setState({saveFilterId:e}),r.handleSaveSelect(e)}return Promise.resolve(!1)})},r.handleSaveSelect=function(n){n?s.h.post("/filter/find/save",{id:n}).then(function(e){var t=e.data.result;t&&(window.location.hash="filter",r.setState({saveFilterId:n},function(){r.props.changeSelectConfig(t.filter)}))}):(window.location.hash="",r.setState({saveFilterId:n},function(){var e=r.props;e.selectConfig;(0,e.changeSelectConfig)({})}))},r.handleSaveBtn=function(){var e=r.state,t=e.form,n=e.saveConfigList,a=e.saveFilterId;t.name=a?n.all.filter(function(e){return e.id===a})[0].name:"",r.setState({form:t,saveDialogVisible:!0})},r.handleSaveFilter=function(t){var e=L.t.get(L.V.curProject).id,n=r.state,a=n.form,n=n.saveFilterId,i=r.props.getSelectConfig();a.name?s.h.post("/filter/add",p()({},a,{copy:t,id:n,type:r.props.model,projectId:e,filter:i})).then(function(e){window.location.hash="filter",t?r.setState({saveDialogVisible:!1,selectConfig:JSON.stringify(i),form:{name:""}}):(r.state.saveConfigList,r.setState({saveFilterId:e.data.result.id,selectConfig:JSON.stringify(i),saveDialogVisible:!1,form:{name:""}})),r.getList()}):k.Z.warning("请输入名称")},r.filterNameChange=function(e,t){var n;r.setState({form:Object.assign(r.state.form,((n={})[e]=t,n))})},r.changeSaveConfigName=function(e,t){var n=e.currentTarget,a=n.defaultValue,i=n.value,n=e.currentTarget.value;if(n){if(i!==a){if(20<=n.length)return k.Z.warning("名字须在二十个字符以内"),void(e.currentTarget.value=a);s.h.post("/filter/update",{id:t,name:n,type:r.props.model,menuModel:p()({},r.data)}).then(function(){return r.getList()})}}else e.currentTarget.value=a},r.handleEdit=function(e){r.setState({saveFilterId:e},function(){r.input.select()})},r.closeModal=function(){r.setState({dialogVisible:!1},function(){r.deleteSelected||!r.state.saveConfigList.all.length?window.location.reload():r.queryInit()})},r.deletesSaveConfig=function(e,t){var n=r.state,a=n.saveConfigList,i=n.saveFilterId;o.MessageBox.confirm("删除后无法恢复, 是否继续?","提示",{type:"warning"}).then(function(){s.h.post("/filter/delete",{id:t,menuModel:p()({},r.data)}).then(function(){k.Z.success("操作成功!"),i===t&&(r.deleteSelected=!0),Object.keys(a).forEach(function(e){a[e]=a[e].filter(function(e){return e.id!==t})}),r.setState({saveConfigList:a,saveFilterId:null})})})},r}r()(e,a);var t=e.prototype;return t.componentDidMount=function(){this.getList()},t.render=function(){var n=this,e=this.state,t=e.saveConfigList,a=e.currentName,i=e.saveFilterId,r=e.selectConfig,l=e.saveDialogVisible,s=e.dialogVisible,c=e.form,e=this.props.getSelectConfig,e=r===JSON.stringify(e());return f().createElement("div",{className:"quick-setting"},t&&f().createElement(T,{RECENT:t.recent,ITEMS:t.all,selected:i||"",changeState:this.handleSaveSelect,handleEdit:function(){return n.setState({dialogVisible:!0})},title:a}),f().createElement(y.Z,{className:"setting-save",feature:e?"minor":"primary",disabled:e,onClick:this.handleSaveBtn},"保存"),f().createElement(o.Dialog,{title:"保存筛选条件",visible:l,className:"add-project-modal",onCancel:function(){return n.setState({saveDialogVisible:!1})}},f().createElement(o.Dialog.Body,null,f().createElement(o.Form,{labelPosition:"left",model:c},f().createElement(o.Form.Item,{label:"名称",prop:"name"},f().createElement(o.Input,{value:this.state.form.name,onChange:function(e){return n.filterNameChange("name",e)}}),f().createElement("i",null,"*"),f().createElement("input",{type:"text",style:{display:"none"}})))),f().createElement(o.Dialog.Footer,{className:"dialog-footer"},f().createElement(o.Button,{type:"primary",onClick:function(){return n.handleSaveFilter(!0)},disabled:!i},"另存为"),f().createElement(o.Button,{type:"primary",onClick:function(){return n.handleSaveFilter(!1)}},"保 存"))),f().createElement(o.Dialog,{title:"编辑筛选条件",visible:s,className:"edit-save-modal",onCancel:this.closeModal},f().createElement(o.Dialog.Body,null,f().createElement("div",{className:"saveConfig-list-wrap"},t&&!!t.all.length&&t.all.map(function(t,e){return f().createElement("ul",{className:"saveConfig-list item",key:t.id},f().createElement("li",{className:"saveConfig-name"},f().createElement("input",{type:"text",ref:function(e){i===t.id&&(n.input=e)},defaultValue:t.name,readOnly:i!==t.id,onBlur:function(e){return n.changeSaveConfigName(e,t.id,t.name)},onKeyDown:function(e){return"Enter"===e.key&&n.input.blur()},className:i===t.id?"edit":null}),f().createElement("i",{className:"el-icon-edit",onClick:function(){return n.handleEdit(t.id)}})),f().createElement("li",{className:"operate"},f().createElement("a",{href:"javascript:;",onClick:function(){return n.deletesSaveConfig(t.name,t.id)}},"删除")))})))))},e}(l.Component),I=n(61193),P=function(a){function e(){for(var u,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(u=a.call.apply(a,[this].concat(t))||this).state={aspectShow:!0,aspectType:!0,aspect1:[],aspect2:[],aspectList:[]},u.selectConfig="",u.getAspectType=function(){return u.state.aspectType},u.getAspectList=function(){return u.state.aspectList},u.changeAspectType=function(e,t){var n,a,i,r;u.state.aspectShow&&u.state.aspectType!==e&&(e?(a=u.state.aspectList,u.changeState({aspectType:e,aspect1:t||u.state.aspect1.length?u.state.aspect1:a.map(function(e){return e.name})})):(a=(n=u.state).aspectList,i=n.aspect1,r=[],i&&i[0]?a.filter(function(e){return e.name===i[0]})[0].contain.map(function(e){return r.push(e.name||e)}):a[0]&&a[0].contain.map(function(e){return r.push(e.name||e)}),u.changeState({aspectType:e,aspect2:t||(u.state.aspect2.length?u.state.aspect2:r)})))},u.changeState=function(e){u.setState(e,function(){u.updateFilter()})},u.updateFilter=function(){var n,a,e=u.props,t=e.changeSelectConfig,i=e.selectConfig,r=e.model,l=u.state,s=l.aspectType,e=l.aspect1,c=l.aspect2,o=l.aspectList;i.aspect=i.aspect||{},s&&e&&0<e.length?"BRAND"===r?(n=[],e.map(function(t){o.filter(function(e){return e.name===t}).map(function(e){return e.contain.map(function(e){e.contain?e.contain.map(function(e){return n.push(e)}):n.push(e)})})}),i.aspect.aspect1=[],i.aspect.aspect2=n):(i.aspect.aspect1=e,i.aspect.aspect2=[]):0<c.length&&("BRAND"===r?(a=[],e.map(function(t){o.filter(function(e){return e.name===t}).map(function(e){return e.contain.filter(function(e){return 0<=c.indexOf(e.name||e)}).map(function(e){e.contain?e.contain.map(function(e){return a.push(e)}):a.push(e)})})}),i.aspect.aspect1=[],i.aspect.aspect2=a):(i.aspect.aspect1=[],i.aspect.aspect2=c)),t("aspect",i.aspect)},u}r()(e,a);var t=e.prototype;return t.UNSAFE_componentWillReceiveProps=function(){var t,n,i,a,r,e,l,s=this.props,c=s.selectConfig,o=s.allConfig,u=s.model;o&&JSON.stringify(c)!==this.selectConfig&&(this.selectConfig=JSON.stringify(c),l=o.aspect,c=(s=this.state).aspectShow,o=s.aspectType,t=s.aspect1,n=s.aspect2,i={},"BRAND"===u?(a=l.map(function(e){return e&&JSON.parse(e)}),(u=0)<=(r=I.Z.getAuthority()).indexOf("ANALYZE_PRODUCT")&&u++,0<=r.indexOf("ANALYZE_SERVER")&&u++,0<=r.indexOf("ANALYZE_MARKETING")&&u++,0===u?a.map(function(e){Object.keys(e).map(function(e,t){return i[t]=e})}):1===u?["ANALYZE_PRODUCT","ANALYZE_SERVER","ANALYZE_MARKETING"].map(function(e,t){0<=r.indexOf(e)&&Object.keys(a[t]).map(function(e,t){return i[t]=e})}):1<u&&(0<=r.indexOf("ANALYZE_PRODUCT")&&(1===(u=Object.keys(a[0])).length?i["产品"]=a[0][u[0]]:1<u.length&&(i["产品"]=a[0])),0<=r.indexOf("ANALYZE_SERVER")&&(1===(e=Object.keys(a[1])).length?i["服务"]=a[1][e[0]]:1<e.length&&(i["服务"]=a[1])),0<=r.indexOf("ANALYZE_MARKETING")&&(1===(e=Object.keys(a[2])).length?i["市场"]=a[2][e[0]]:1<e.length&&(i["市场"]=a[2])))):l&&l[0]&&(i=JSON.parse(l[0])),(o=(l=Object.keys(i).map(function(e,t){var a=i[e];return{id:t,name:e,contain:a.length?a:Object.keys(a).map(function(e,t){var n=a[e];return{id:t,name:e,contain:n.length?n:Object.keys(n)}})}})).length<=1?c=!1:o)&&!t.length?l.map(function(e){return t.push(e.name)}):o||n.length||l&&l[0]&&l[0].contain.map(function(e){"object"==typeof e?n.push(e.name):n.push(e)}),this.changeState({aspectList:l,aspectShow:c,aspects:i,aspectType:o,aspect1:t,aspect2:n,refresh:!0}))},t.render=function(){var n=this,e=this.state,t=e.aspectList,a=e.aspectType,i=e.aspect1,r=e.aspect2,e=e.aspectShow;return this.props.show?"dialog"!==this.props.type?f().createElement("div",null,f().createElement("div",{className:"sub-btn"},e&&f().createElement(C,null,f().createElement(y.Z,{feature:a?"primary":"minor",onClick:function(){return n.changeAspectType(!0)}},"一级指标"),f().createElement(y.Z,{feature:a?"minor":"primary",onClick:function(){return n.changeAspectType(!1)}},"二级指标"))),f().createElement("div",{style:{borderBottom:"1px solid #ebebeb",marginTop:"12px"}},t&&!!t.length&&(a?f().createElement(S,{changeState:function(e){return n.changeState({aspect1:e})},checkedList:i,ITEMS:t.map(function(e){return e.name||e})}):t.map(function(e,t){return f().createElement(S,{changeState:function(e){return n.changeState({aspect2:e})},checkedList:r,key:"aspect1-"+t,categoryTitle:e.name,ITEMS:e.contain.map(function(e){return e.name||e})})})))):f().createElement("div",{className:"dialog"},f().createElement("div",{className:"sub-btn"},e&&f().createElement(o.Select,{value:a,onChange:function(e){return n.changeAspectType(e)},placeholder:""},f().createElement(o.Select.Option,{label:"一级指标",value:!0},"一级指标"),f().createElement(o.Select.Option,{label:"二级指标",value:!1},"二级指标"))),f().createElement("div",null,t&&!!t.length&&(a?f().createElement(S,{changeState:function(e){return n.changeState({aspect1:e})},checkedList:i,ITEMS:t.map(function(e){return e.name||e})}):t.map(function(e,t){return f().createElement(S,{changeState:function(e){return n.changeState({aspect2:e})},checkedList:r,key:"aspect1-"+t,categoryTitle:e.name,ITEMS:e.contain.map(function(e){return e.name||e})})})))):f().createElement("div",null)},e}(l.Component),F=function(t){function e(e){var l=t.call(this,e)||this;l.refreshFilter=function(n){s.h.post("filter/find",{type:l.props.model,filterTypes:l.shouldFindTypes(),projectId:n}).then(function(e){var t=l.state.selectConfig;t.project=[n],l.setState({allConfig:e.data.result,selectConfig:t},function(){l.changeSelectConfig()})})},l.handlePanel=function(){var e=l.state.tab;e.show=!e.show,l.setState({tab:e})},l.closePanel=function(){var e=l.state.tab;e.show=!1,l.setState({tab:e})},l.getParams=function(){return JSON.parse(JSON.stringify(l.state.selectConfig))},l.changeTab=function(e,t){t&&t.stopPropagation(),t&&t.nativeEvent.stopImmediatePropagation();t=l.state.tab;e===t.index?l.handlePanel():(t.index=e,t.show=!0,l.setState({tab:t}))},l.changeSelectConfig=function(e,t){var n,a=l.state,i=a.selectConfig,r=a.compare;t?i[e]=t:e&&(i=e),i.connConfig&&(n=i.connConfig.filter(function(e){return 0<e.values.length}).map(function(e){return e}),i.connConfig=n),i.tag&&(n=i.tag.filter(function(e){return 0<e.values.length}).map(function(e){return e}),i.tag=n),l.setState({selectConfig:i},function(){var e=l.props,t=e.confirm,n=e.filter,e=l.state.selectConfig;0<=n.indexOf("aspect")&&(!e.analysis||0===e.analysis.length||!e.aspect||0===e.aspect.length)||r||!t||t(e)})},l.getSelectConfig=function(){return l.state.selectConfig},l.shouldFindTypes=function(){var t=[];return l.props.filter.map(function(e){switch(e){case"topic":case"project":case"escore":case"emotion":case"keyword":case"messageType":case"content":break;case"connConfig":t.push("CONN_CONFIG");break;case"taskTypes":t.push("TASK_TYPE");break;default:t.push(e.toUpperCase())}}),t},l.getAspect=function(){return{labelType:l.refs.analysis?l.refs.analysis.getLabelType():"topic",aspectType:!l.refs.aspect||l.refs.aspect.getAspectType(),aspectList:l.refs.aspect?l.refs.aspect.getAspectList():null}},l.changeAspectType=function(){var e;(e=l.refs.aspect).changeAspectType.apply(e,arguments)};return l.state={projectId:"",allConfig:null,selectConfig:e.selectConfig||{},tab:{show:!1,index:0}},l}r()(e,t);var n=e.prototype;return n.UNSAFE_componentWillReceiveProps=function(e){e.selectConfig&&this.setState({selectConfig:e.selectConfig})},n.componentDidMount=function(){var t=this;this.getProject().then(function(e){t.setState({projects:e,projectId:t.props.projectId||e&&e[0]&&e[0].id},function(e){return t.refreshFilter(t.state.projectId)})})},n.getProject=function(){return s.h.post("/projects/list").then(function(e){return e.data.result.list})},n.selProject=function(e){var t=this;this.setState({projectId:e},function(e){t.refreshFilter(t.state.projectId)})},n.render=function(){var t=this,e=this.state.tab,n=this.props,a=n.type,i=n.aspect,r=n.save,l=n.filter,s=n.model,c=n.showAllConfig,o=n.extraConfig,n=n.onExtraChange,u=p()({model:s,type:a,showAllConfig:c,extraConfig:o,onExtraChange:n,getSelectConfig:this.getSelectConfig,changeSelectConfig:this.changeSelectConfig},this.state);switch(a){case"header":return f().createElement("div",{className:"filter-setting-wrap data-filter "+a+"-filter"},f().createElement("div",{className:"filter-head"},f().createElement("div",{className:"tab-btn"},f().createElement("span",{onClick:function(e){return t.changeTab(0,e)},className:0===e.index&&"active"},f().createElement("i",{className:"icon-cem_product"}),f().createElement("span",null,"筛选条件")),i&&f().createElement("span",{onClick:function(e){return t.changeTab(1,e)},className:1===e.index&&"active"},f().createElement("i",{className:"icon-cem_object-of-analysis"}),f().createElement("span",null,"分析对象")),i&&f().createElement("span",{onClick:function(e){return t.changeTab(2,e)},className:2===e.index&&"active"},f().createElement("i",{className:"icon-cem_analysis-index"}),f().createElement("span",null,"分析指标"))),r&&f().createElement(A,p()({},u,{type:a}))),f().createElement("div",{className:"filter-setting",style:{display:"header"!==a||e.show?"block":"none"}},f().createElement("div",{className:"sub-btn"},0===e.index&&f().createElement(m,p()({ref:"condition"},u,{filter:l})),i&&f().createElement(b,p()({show:1===e.index,ref:"analysis"},u,{filter:l})),i&&f().createElement(P,p()({show:2===e.index,ref:"aspect"},u,{filter:l}))),f().createElement("div",{className:"visibility",onClick:this.closePanel})));case"dialog":return f().createElement("div",{className:"filter-setting-wrap data-filter "+a+"-filter"},f().createElement("div",{className:"filter-setting"},f().createElement("div",{className:"sub-btn"},f().createElement("div",{className:"filter-title"},"筛选条件"),f().createElement(m,p()({ref:"condition"},u,{filter:l})),i&&f().createElement("div",null,f().createElement("div",{className:"filter-title"},"分析对象"),f().createElement(b,p()({show:"header"!==a||1===e.index,ref:"analysis"},u,{filter:l})),f().createElement("div",{className:"filter-title"},"分析指标"),f().createElement(P,p()({show:"header"!==a||2===e.index,ref:"aspect"},u,{filter:l}))))));case"filter":return f().createElement("div",{className:"filter-setting-wrap data-filter "+a+"-filter"},f().createElement("div",{className:"filter-setting"},f().createElement("div",{className:"sub-btn"},f().createElement(m,p()({ref:"condition"},u,{filter:l})))))}return f().createElement("div",{className:"filter-setting-wrap data-filter "+a+"-filter"},"header"===a&&f().createElement("div",{className:"filter-head"},f().createElement("div",{className:"tab-btn"},f().createElement("span",{onClick:function(e){return t.changeTab(0,e)},className:0===e.index&&"active"},f().createElement("i",{className:"icon-cem_product"}),f().createElement("span",null,"筛选条件")),i&&f().createElement("span",{onClick:function(e){return t.changeTab(1,e)},className:1===e.index&&"active"},f().createElement("i",{className:"icon-cem_object-of-analysis"}),f().createElement("span",null,"分析对象")),i&&f().createElement("span",{onClick:function(e){return t.changeTab(2,e)},className:2===e.index&&"active"},f().createElement("i",{className:"icon-cem_analysis-index"}),f().createElement("span",null,"分析指标"))),r&&f().createElement(A,p()({},u,{type:a}))),f().createElement("div",{className:"filter-setting",style:{display:"header"!==a||e.show?"block":"none"}},f().createElement("div",{className:"sub-btn"},("header"!==a||0===e.index)&&f().createElement(m,p()({ref:"condition"},u,{filter:l})),i&&f().createElement(b,p()({show:"header"!==a||1===e.index,ref:"analysis"},u,{filter:l})),i&&f().createElement(P,p()({show:"header"!==a||2===e.index,ref:"aspect"},u,{filter:l}))),"header"===a&&f().createElement("div",{className:"visibility",onClick:this.closePanel})))},e}(l.Component)}}]);