(self.webpackChunkyunting=self.webpackChunkyunting||[]).push([[662],{70662:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a,fuzzyQuery:()=>r});var t=n(85354),l=n.n(t),t=n(67294),f=n.n(t),o=n(36144),t=n(30381),g=n.n(t),i=n(61409),v=n(92360);const w=function(a){function e(){for(var o,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(o=a.call.apply(a,[this].concat(t))||this).onScroll=function(e){var t=e.target,n=o.props,a=n.total,l=n.list,i=n.onScrollLoadMore,s=n.scrollable,e=t.scrollTop,n=t.offsetHeight,t=t.scrollHeight;!s||l.length>=a||30<t-e-n||i&&i()},o}return l()(e,a),e.prototype.render=function(){var e=this.props,t=e.list,n=e.total,a=e.onClick,l=e.loading,i=e.showAll,e=e.onClear;return f().createElement(v.Loading,{loading:l},f().createElement("div",{onScroll:this.onScroll,className:"warning_list_view",style:{height:"calc(100vh - "+(i?"98px":"130px")+")"}},f().createElement("div",{className:"total_tips"},"共 ",n," 条"),t.map(function(e){return f().createElement("div",{className:"list_item",key:e.id,onClick:function(){return a&&a(e.token,e.time)}},f().createElement("div",null,e.name),f().createElement("div",null,f().createElement("span",{className:"time"},g()(e.time).format("YYYY/MM/DD HH:mm")),f().createElement("span",{className:"tag",style:{background:"YES"===e.state?"#15B374":"#D96969"}},"YES"===e.state?"已处理":"待处理")))}),e&&0<t.length&&f().createElement(f().Fragment,null,f().createElement("div",{style:{height:42}}),f().createElement("div",{className:"clear",onClick:e},'全部标记为"已处理"'))))},e}(f().PureComponent);var k=n(61918);function r(e,t){for(var n=new RegExp(t.toLocaleLowerCase()),a=[],l=0;l<e.length;l++)n.test(e[l].name.toLocaleLowerCase())&&a.push(e[l]);return a}const a=function(a){function e(e){var s=a.call(this,e)||this;s.fetchWarningList=function(n,a){var e=s.state,t=e.token,l=e.showAll,i=e.warningType;s.setState({loading:!0},function(){var e={pageIndex:s.state["pageIndex"+n],pageSize:10,token:t,withPage:!0,showAll:l?"YES":"NO",warningType:i};"1"===n?e.state="NO":"2"===n&&(e.state="YES"),o.h.post("/price/warning/token/set/find",e).then(function(e){var t=e.data;2e4===t.code&&s.setState(((e={loading:!1,count:l?0:t.result.count})["total"+n]=t.result.count,e["pageIndex"+n]=s.state["pageIndex"+n]+1,e["list"+n]=a?[].concat(s.state["list"+n],t.result.result):t.result.result,e))})})},s.handleOnClose=function(){s.setState({showAll:!s.state.showAll,pageIndex1:1,pageIndex2:1,pageIndex3:1},function(){return s.fetchWarningList(s.state.activeView)})},s.handleOnTabClick=function(e){s.setState({activeView:e.props.name},function(){0===s.state["list"+e.props.name].length&&s.fetchWarningList(e.props.name)})},s.handleOnListClick=function(e,t){var n=s.state.warningType;i.mW.push("/warningNotice?token="+e+"&sendDate="+t+"&listToken="+s.state.token+"&listTime="+s.state.sendDate+(n&&"&type="+n))},s.handleOnClear=function(){o.h.post("/price/warning/token/set/update",{showAll:"YES",token:s.state.token,warningType:s.state.warningType}).then(function(e){2e4===e.data.code&&s.setState({pageIndex1:1},function(){return s.fetchWarningList("1")})})},s.handleOnSearch=function(e){var t,n=s.state.activeView;s.setState(((t={})["filterList"+n]=e?r(s.state["list"+n],e):void 0,t))};var t=e.location.query,n=t.token,e=t.sendDate,t=t.type;return s.state={pageIndex1:1,pageIndex2:1,pageIndex3:1,list1:[],list2:[],list3:[],total1:0,total2:0,total3:0,filterList1:void 0,filterList2:void 0,filterList3:void 0,showAll:!1,token:n,activeView:"1",loading:!1,sendDate:e,count:0,warningType:t||""},s}l()(e,a);var t=e.prototype;return t.componentDidMount=function(){this.fetchWarningList(this.state.activeView)},t.render=function(){var e=this,t=this.state,n=t.showAll,a=t.count,l=t.list1,i=t.list2,s=t.list3,o=t.loading,r=t.activeView,c=t.sendDate,u=t.total1,h=t.total2,d=t.total3,m=t.filterList1,p=t.filterList2,t=t.filterList3;return f().createElement("div",{className:"warning_notic_list"},!n&&f().createElement("div",{className:"top_tips"},g()(c).format("YYYY年MM月DD日 HH:mm")," 共",a,"个规则触发预警",f().createElement("i",{className:"icon-cem_cancel",onClick:this.handleOnClose})),f().createElement(k.Z,{className:"search_com",placeholder:"请输入关键词",onSearch:this.handleOnSearch,onClear:this.handleOnSearch}),f().createElement("div",{className:"list_view"},f().createElement(v.Tabs,{activeName:r,onTabClick:this.handleOnTabClick},f().createElement(v.Tabs.Pane,{name:"1",label:"待处理"},f().createElement(w,{showAll:n,list:m||l,loading:o,total:u,scrollable:!m,onClick:this.handleOnListClick,onClear:this.handleOnClear,onScrollLoadMore:function(){return e.fetchWarningList("1",!0)}})),f().createElement(v.Tabs.Pane,{name:"2",label:"已处理"},f().createElement(w,{showAll:n,list:p||i,loading:o,total:h,scrollable:!p,onClick:this.handleOnListClick,onScrollLoadMore:function(){return e.fetchWarningList("2",!0)}})),f().createElement(v.Tabs.Pane,{name:"3",label:"全部"},f().createElement(w,{showAll:n,list:t||s,loading:o,total:d,scrollable:!t,onClick:this.handleOnListClick,onScrollLoadMore:function(){return e.fetchWarningList("3",!0)}}))),f().createElement("span",{className:"pop"},99<u?"99+":u)))},e}(f().PureComponent)},61918:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var t=n(67294),u=n.n(t),t=n(45697),n=n.n(t),t=function(e){var t=e.className,n=e.onClear,a=e.onSearch,l=e.placeholder,i=e.style,s=e.defValue,o=e.signal,e=u().useState(s),r=e[0],c=e[1];u().useEffect(function(){c(s)},[s,o]);return u().createElement("div",{style:i,className:"yt_search_input_wrapper "+(t||"")},u().createElement("input",{placeholder:l,value:r,onKeyDown:function(e){13===e.keyCode&&a(r)},onChange:function(e){return c(e.target.value)},autoComplete:"off"}),r&&u().createElement("i",{className:"icon-cem_log-off",onClick:function(){c(""),n&&n("")}}),u().createElement("i",{className:"icon-cem_small-search",onClick:function(){return a(r)}}))};t.propTypes={className:n().string,onSearch:n().func.isRequired,placeholder:n().string,style:n().object,defValue:n().string,signal:n().any,onClear:n().func};const a=t}}]);